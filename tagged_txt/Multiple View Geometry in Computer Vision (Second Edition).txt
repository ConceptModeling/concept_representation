this	O
page	O
intentionally	O
left	O
blank	O
multiple	O
view	O
geometry	O
in	O
computer	O
vision	O
second	O
edition	O
richard	O
hartley	O
australian	O
national	O
university	O
,	O
canberra	O
,	O
australia	O
andrew	O
zisserman	O
university	O
of	O
oxford	O
,	O
uk	O
cambridge	O
university	O
press	O
cambridge	O
,	O
new	O
york	O
,	O
melbourne	O
,	O
madrid	O
,	O
cape	O
town	O
,	O
singapore	O
,	O
são	O
paulo	O
cambridge	O
university	O
press	O
the	O
edinburgh	O
building	O
,	O
cambridge	O
cb2	O
2ru	O
,	O
uk	O
published	O
in	O
the	O
united	O
states	O
of	O
america	O
by	O
cambridge	O
university	O
press	O
,	O
new	O
york	O
www.cambridge.org	O
information	O
on	O
this	O
title	O
:	O
www.cambridge.org/9780521540513	O
©	O
cambridge	O
university	O
press	O
2000	O
,	O
2003	O
this	O
publication	O
is	O
in	O
copyright	O
.	O
subject	O
to	O
statutory	O
exception	O
and	O
to	O
the	O
provision	O
of	O
relevant	O
collective	O
licensing	O
agreements	O
,	O
no	O
reproduction	O
of	O
any	O
part	O
may	O
take	O
place	O
without	O
the	O
written	O
permission	O
of	O
cambridge	O
university	O
press	O
.	O
first	O
published	O
in	O
print	O
format	O
2004	O
isbn-13	O
978-0-511-18618-9	O
isbn-10	O
0-511-18618-5	O
ebook	O
(	O
ebl	O
)	O
ebook	O
(	O
ebl	O
)	O
isbn-13	O
978-0-521-54051-3	O
isbn-10	O
0-521-54051-8	O
paperback	O
paperback	O
cambridge	O
university	O
press	O
has	O
no	O
responsibility	O
for	O
the	O
persistence	O
or	O
accuracy	O
of	O
urls	O
for	O
external	O
or	O
third-party	O
internet	O
websites	O
referred	O
to	O
in	O
this	O
publication	O
,	O
and	O
does	O
not	O
guarantee	O
that	O
any	O
content	O
on	O
such	O
websites	O
is	O
,	O
or	O
will	O
remain	O
,	O
accurate	O
or	O
appropriate	O
.	O
dedication	O
this	O
book	O
is	O
dedicated	O
to	O
joe	O
mundy	O
whose	O
vision	O
and	O
constant	O
search	O
for	O
new	O
ideas	O
led	O
us	O
into	O
this	O
ﬁeld	O
.	O
contents	O
foreword	O
preface	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
introduction	O
–	O
the	O
ubiquitous	O
projective	B
geometry	O
1.1	O
camera	B
projections	O
1.2	O
reconstruction	B
from	O
more	O
than	O
one	O
view	O
1.3	O
three-view	O
geometry	O
1.4	O
four	O
view	O
geometry	O
and	O
n-view	O
reconstruction	B
1.5	O
transfer	B
1.6	O
euclidean	O
reconstruction	O
1.7	O
auto-calibration	B
1.8	O
the	O
reward	O
i	O
:	O
3d	O
graphical	O
models	O
1.9	O
1.10	O
the	O
reward	O
ii	O
:	O
video	O
augmentation	B
page	O
xi	O
xiii	O
1	O
1	O
6	O
10	O
12	O
13	O
14	O
16	O
17	O
18	O
19	O
part	O
0	O
:	O
the	O
background	O
:	O
projective	B
geometry	O
,	O
transformations	O
and	O
esti-	O
mation	O
23	O
24	O
25	O
25	O
26	O
32	O
37	O
44	O
46	O
47	O
58	O
61	O
62	O
65	O
65	O
66	O
2	O
3	O
planar	O
geometry	O
the	O
2d	O
projective	B
plane	I
projective	O
transformations	O
a	O
hierarchy	B
of	I
transformations	O
the	O
projective	B
geometry	O
of	O
1d	O
topology	O
of	O
the	O
projective	B
plane	I
recovery	O
of	O
afﬁne	O
and	O
metric	B
properties	I
from	O
images	O
outline	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
2.1	O
2.2	O
2.3	O
2.4	O
2.5	O
2.6	O
2.7	O
2.8	O
more	B
properties	I
of	O
conics	O
2.9	O
2.10	O
closure	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
3.1	O
3.2	O
points	O
and	O
projective	B
transformations	O
representing	O
and	O
transforming	O
planes	O
,	O
lines	B
and	O
quadrics	B
fixed	O
points	O
and	O
lines	B
v	O
vi	O
4	O
5	O
contents	O
twisted	O
cubics	O
the	O
hierarchy	B
of	I
transformations	O
the	O
plane	O
at	O
inﬁnity	O
the	O
absolute	O
conic	O
the	O
absolute	B
dual	I
quadric	I
closure	O
3.3	O
3.4	O
3.5	O
3.6	O
3.7	O
3.8	O
estimation	B
–	O
2d	O
projective	B
transformations	O
4.1	O
4.2	O
4.3	O
4.4	O
4.5	O
4.6	O
4.7	O
4.8	O
4.9	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
5.1	O
5.2	O
5.3	O
monte	O
carlo	O
estimation	B
of	I
covariance	O
5.4	O
the	O
direct	O
linear	O
transformation	B
(	O
dlt	O
)	O
algorithm	B
different	O
cost	B
functions	I
statistical	O
cost	B
functions	I
and	O
maximum	O
likelihood	O
estimation	B
transformation	O
invariance	O
and	O
normalization	B
iterative	O
minimization	B
methods	O
experimental	O
comparison	O
of	O
the	O
algorithms	O
robust	B
estimation	O
automatic	O
computation	B
of	I
a	O
homography	B
closure	O
bounds	O
on	O
performance	O
covariance	B
of	O
the	O
estimated	O
transformation	B
closure	O
part	O
i	O
:	O
camera	B
geometry	O
and	O
single	B
view	I
geometry	O
6	O
7	O
finite	O
cameras	B
the	O
projective	B
camera	I
cameras	O
at	B
inﬁnity	I
other	O
camera	B
models	O
closure	O
outline	O
camera	B
models	O
6.1	O
6.2	O
6.3	O
6.4	O
6.5	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
7.1	O
7.2	O
7.3	O
7.4	O
7.5	O
basic	O
equations	O
geometric	B
error	I
restricted	O
camera	B
estimation	O
radial	B
distortion	I
closure	O
8	O
more	O
single	O
view	O
geometry	O
8.1	O
8.2	O
8.3	O
8.4	O
8.5	O
action	O
of	O
a	O
projective	B
camera	I
on	O
planes	O
,	O
lines	B
,	O
and	O
conics	O
images	O
of	O
smooth	O
surfaces	O
action	O
of	O
a	O
projective	B
camera	I
on	O
quadrics	B
the	O
importance	O
of	O
the	O
camera	O
centre	B
camera	O
calibration	B
and	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
75	O
77	O
79	O
81	O
83	O
85	O
87	O
88	O
93	O
102	O
104	O
110	O
115	O
116	O
123	O
127	O
132	O
132	O
138	O
149	O
150	O
151	O
152	O
153	O
153	O
158	O
166	O
174	O
176	O
178	O
178	O
180	O
184	O
189	O
193	O
195	O
195	O
200	O
201	O
202	O
208	O
contents	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
afﬁne	O
3d	O
measurements	O
and	O
reconstruction	B
determining	O
camera	B
calibration	I
k	O
from	O
a	O
single	B
view	I
single	O
view	O
reconstruction	B
8.6	O
8.7	O
8.8	O
8.9	O
8.10	O
the	O
calibrating	B
conic	I
8.11	O
closure	O
part	O
ii	O
:	O
two-view	O
geometry	O
9	O
outline	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
9.1	O
9.2	O
9.3	O
9.4	O
9.5	O
9.6	O
9.7	O
epipolar	B
geometry	O
the	O
fundamental	B
matrix	I
f	O
fundamental	O
matrices	O
arising	O
from	O
special	O
motions	O
geometric	B
representation	I
of	O
the	O
fundamental	B
matrix	I
retrieving	O
the	O
camera	B
matrices	I
the	O
essential	B
matrix	I
closure	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
10.1	O
outline	O
of	O
reconstruction	O
method	O
10.2	O
reconstruction	B
ambiguity	O
10.3	O
the	O
projective	B
reconstruction	I
theorem	O
10.4	O
stratiﬁed	B
reconstruction	I
10.5	O
direct	O
reconstruction	O
–	O
using	O
ground	O
truth	O
10.6	O
closure	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
11.1	O
basic	O
equations	O
11.2	O
the	O
normalized	O
8-point	O
algorithm	B
11.3	O
the	O
algebraic	B
minimization	I
algorithm	O
11.4	O
geometric	B
distance	I
11.5	O
experimental	B
evaluation	I
of	O
the	O
algorithms	O
11.6	O
automatic	O
computation	B
of	I
f	O
11.7	O
special	O
cases	O
of	O
f-computation	O
11.8	O
correspondence	B
of	O
other	O
entities	O
11.9	O
degeneracies	B
11.10	O
a	O
geometric	B
interpretation	I
of	O
f-computation	O
11.11	O
the	O
envelope	O
of	B
epipolar	I
lines	I
11.12	O
image	O
rectiﬁcation	O
11.13	O
closure	O
12	O
structure	B
computation	O
12.1	O
problem	O
statement	O
12.2	O
linear	B
triangulation	O
methods	O
12.3	O
geometric	B
error	I
cost	O
function	O
12.4	O
sampson	O
approximation	O
(	O
ﬁrst-order	O
geometric	B
correction	O
)	O
vii	O
213	O
220	O
223	O
229	O
231	O
233	O
237	O
238	O
239	O
239	O
241	O
247	O
250	O
253	O
257	O
259	O
262	O
262	O
264	O
266	O
267	O
275	O
276	O
279	O
279	O
281	O
282	O
284	O
288	O
290	O
293	O
294	O
295	O
297	O
298	O
302	O
308	O
310	O
310	O
312	O
313	O
314	O
viii	O
contents	O
12.5	O
an	O
optimal	O
solution	B
12.6	O
probability	O
distribution	O
of	O
the	O
estimated	O
3d	O
point	B
12.7	O
line	B
reconstruction	I
12.8	O
closure	O
13	O
scene	O
planes	O
and	O
homographies	B
13.1	O
homographies	B
given	O
the	O
plane	B
and	O
vice	O
versa	O
13.2	O
plane	O
induced	O
homographies	O
given	O
f	O
and	O
image	O
correspondences	O
13.3	O
computing	B
f	O
given	O
the	O
homography	B
induced	O
by	O
a	O
plane	B
13.4	O
the	O
inﬁnite	B
homography	I
h∞	O
13.5	O
closure	O
14	O
afﬁne	B
epipolar	O
geometry	O
14.1	O
afﬁne	B
epipolar	O
geometry	O
14.2	O
the	O
afﬁne	B
fundamental	I
matrix	I
14.3	O
estimating	B
fa	O
from	O
image	O
point	B
correspondences	O
14.4	O
triangulation	B
14.5	O
afﬁne	B
reconstruction	I
14.6	O
necker	O
reversal	O
and	O
the	O
bas-relief	B
ambiguity	I
14.7	O
computing	B
the	O
motion	O
14.8	O
closure	O
part	O
iii	O
:	O
three-view	O
geometry	O
outline	O
15	O
the	O
trifocal	B
tensor	I
15.1	O
the	O
geometric	B
basis	O
for	O
the	O
trifocal	B
tensor	I
15.2	O
the	O
trifocal	B
tensor	I
and	O
tensor	B
notation	I
15.3	O
transfer	B
15.4	O
the	O
fundamental	O
matrices	O
for	B
three	I
views	I
15.5	O
closure	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
16.1	O
basic	O
equations	O
16.2	O
the	O
normalized	O
linear	O
algorithm	B
16.3	O
the	O
algebraic	B
minimization	I
algorithm	O
16.4	O
geometric	B
distance	I
16.5	O
experimental	B
evaluation	I
of	O
the	O
algorithms	O
16.6	O
automatic	O
computation	B
of	I
t	O
16.7	O
special	O
cases	O
of	O
t	O
-computation	O
16.8	O
closure	O
part	O
iv	O
:	O
n-view	O
geometry	O
outline	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
17.1	O
bilinear	B
relations	O
17.2	O
trilinear	B
relations	O
315	O
321	O
321	O
323	O
325	O
326	O
329	O
334	O
338	O
340	O
344	O
344	O
345	O
347	O
353	O
353	O
355	O
357	O
360	O
363	O
364	O
365	O
365	O
376	O
379	O
383	O
387	O
391	O
391	O
393	O
395	O
396	O
399	O
400	O
404	O
406	O
409	O
410	O
411	O
411	O
414	O
contents	O
intersections	O
of	O
four	O
planes	O
17.3	O
quadrilinear	B
relations	O
17.4	O
17.5	O
counting	B
arguments	I
17.6	O
number	O
of	O
independent	O
equations	O
17.7	O
choosing	O
equations	O
17.8	O
closure	O
18	O
n-view	O
computational	O
methods	O
18.1	O
projective	B
reconstruction	I
–	O
bundle	B
adjustment	I
18.2	O
afﬁne	B
reconstruction	I
–	O
the	O
factorization	B
algorithm	O
18.3	O
non-rigid	B
factorization	I
18.4	O
projective	B
factorization	I
18.5	O
projective	B
reconstruction	I
using	O
planes	O
18.6	O
reconstruction	B
from	O
sequences	O
18.7	O
closure	O
19	O
auto-calibration	B
introduction	O
19.1	O
19.2	O
algebraic	B
framework	O
and	O
problem	O
statement	O
19.3	O
calibration	B
using	O
the	O
absolute	B
dual	I
quadric	I
19.4	O
the	O
kruppa	O
equations	O
19.5	O
a	O
stratiﬁed	O
solution	O
19.6	O
calibration	B
from	O
rotating	O
cameras	B
19.7	O
auto-calibration	B
from	O
planes	O
19.8	O
planar	B
motion	I
19.9	O
single	O
axis	O
rotation	B
–	O
turntable	O
motion	O
19.10	O
auto-calibration	B
of	O
a	O
stereo	O
rig	O
19.11	O
closure	O
20	O
duality	B
20.1	O
carlsson–weinshall	O
duality	B
20.2	O
reduced	B
reconstruction	O
20.3	O
closure	O
21	O
cheirality	O
21.1	O
quasi-afﬁne	B
transformations	O
21.2	O
front	O
and	O
back	O
of	O
a	O
camera	O
21.3	O
three-dimensional	O
point	B
sets	O
21.4	O
obtaining	O
a	O
quasi-afﬁne	B
reconstruction	I
21.5	O
effect	O
of	O
transformations	O
on	O
cheirality	O
21.6	O
orientation	B
21.7	O
the	O
cheiral	B
inequalities	I
21.8	O
which	O
points	O
are	O
visible	O
in	O
a	O
third	O
view	O
21.9	O
which	O
points	O
are	O
in	O
front	O
of	O
which	O
21.10	O
closure	O
ix	O
418	O
421	O
422	O
428	O
431	O
432	O
434	O
434	O
436	O
440	O
444	O
447	O
452	O
456	O
458	O
458	O
459	O
462	O
469	O
473	O
481	O
485	O
486	O
490	O
493	O
497	O
502	O
502	O
508	O
513	O
515	O
515	O
518	O
519	O
520	O
521	O
523	O
525	O
528	O
530	O
531	O
x	O
contents	O
22	O
degenerate	B
conﬁgurations	I
22.1	O
camera	B
resectioning	I
22.2	O
degeneracies	B
in	O
two	B
views	I
22.3	O
carlsson–weinshall	O
duality	B
22.4	O
three-view	O
critical	B
conﬁgurations	I
22.5	O
closure	O
part	O
v	O
:	O
appendices	O
appendix	O
1	O
tensor	B
notation	I
appendix	O
2	O
gaussian	O
(	O
normal	O
)	O
and	O
χ2	O
distributions	O
appendix	O
3	O
parameter	O
estimation	O
appendix	O
4	O
matrix	B
properties	O
and	O
decompositions	O
appendix	O
5	O
least-squares	O
minimization	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
appendix	O
7	O
some	O
special	O
plane	O
projective	B
transformations	O
bibliography	O
index	O
533	O
533	O
539	O
546	O
553	O
558	O
561	O
562	O
565	O
568	O
578	O
588	O
597	O
628	O
634	O
646	O
foreword	O
by	O
olivier	O
faugeras	O
making	O
a	O
computer	O
see	O
was	O
something	O
that	O
leading	O
experts	O
in	O
the	O
ﬁeld	O
of	O
artiﬁcial	O
intelligence	O
thought	O
to	O
be	O
at	O
the	O
level	O
of	O
difﬁculty	O
of	O
a	O
summer	O
student	O
’	O
s	O
project	O
back	O
in	O
the	O
sixties	O
.	O
forty	O
years	O
later	O
the	O
task	O
is	O
still	O
unsolved	O
and	O
seems	O
formidable	O
.	O
a	O
whole	O
ﬁeld	O
,	O
called	O
computer	O
vision	O
,	O
has	O
emerged	O
as	O
a	O
discipline	O
in	O
itself	O
with	O
strong	O
connections	O
to	O
mathematics	O
and	O
computer	O
science	O
and	O
looser	O
connections	O
to	O
physics	O
,	O
the	O
psychology	O
of	O
perception	O
and	O
the	O
neuro	O
sciences	O
.	O
one	O
of	O
the	O
likely	O
reasons	O
for	O
this	O
half-failure	O
is	O
the	O
fact	O
that	O
researchers	O
had	O
over-	O
looked	O
the	O
fact	O
,	O
perhaps	O
because	O
of	O
this	O
plague	O
called	O
naive	O
introspection	O
,	O
that	O
percep-	O
tion	O
in	O
general	O
and	O
visual	O
perception	O
in	O
particular	O
are	O
far	O
more	O
complex	O
in	O
animals	O
and	O
humans	O
than	O
was	O
initially	O
thought	O
.	O
there	O
is	O
of	O
course	O
no	O
reason	O
why	O
we	O
should	O
pattern	O
computer	O
vision	O
algorithms	O
after	O
biological	O
ones	O
,	O
but	O
the	O
fact	O
of	O
the	O
matter	O
is	O
that	O
(	O
i	O
)	O
the	O
way	O
biological	O
vision	O
works	O
is	O
still	O
largely	O
unknown	O
and	O
therefore	O
hard	O
to	O
emulate	O
on	O
computers	O
,	O
and	O
(	O
ii	O
)	O
attempts	O
to	O
ignore	O
biological	O
vision	O
and	O
reinvent	O
a	O
sort	O
of	O
silicon-based	O
vision	O
have	O
not	O
been	O
so	O
successful	O
as	O
initially	O
expected	O
.	O
despite	O
these	O
negative	O
remarks	O
,	O
computer	O
vision	O
researchers	O
have	O
obtained	O
some	O
outstanding	O
successes	O
,	O
both	O
practical	O
and	O
theoretical	O
.	O
on	O
the	O
side	O
of	O
practice	O
,	O
and	O
to	O
single	O
out	O
one	O
example	O
,	O
the	O
possibility	O
of	O
guiding	O
vehi-	O
cles	O
such	O
as	O
cars	O
and	O
trucks	O
on	O
regular	O
roads	O
or	O
on	O
rough	O
terrain	O
using	O
computer	O
vision	O
technology	O
was	O
demonstrated	O
many	O
years	O
ago	O
in	O
europe	O
,	O
the	O
usa	O
and	O
japan	O
.	O
this	O
requires	O
capabilities	O
for	O
real-time	O
three-dimensional	O
dynamic	O
scene	O
analysis	O
which	O
are	O
quite	O
elaborate	O
.	O
today	O
,	O
car	O
manufacturers	O
are	O
slowly	O
incorporating	O
some	O
of	O
these	O
func-	O
tions	O
in	O
their	O
products	O
.	O
on	O
the	O
theoretical	O
side	O
some	O
remarkable	O
progress	O
has	O
been	O
achieved	O
in	O
the	O
area	O
of	O
what	O
one	O
could	O
call	O
geometric	B
computer	O
vision	O
.	O
this	O
includes	O
the	O
description	O
of	O
the	O
way	O
the	O
appearance	O
of	O
objects	O
changes	O
when	O
viewed	O
from	O
different	O
viewpoints	O
as	O
a	O
function	O
of	O
the	O
objects	O
’	O
shape	O
and	O
the	O
cameras	B
parameters	O
.	O
this	O
endeavour	O
would	O
not	O
have	O
been	O
achieved	O
without	O
the	O
use	O
of	O
fairly	O
sophisticated	O
mathematical	O
techniques	O
en-	O
compassing	O
many	O
areas	O
of	O
geometry	O
,	O
ancient	O
and	O
novel	O
.	O
this	O
book	O
deals	O
in	O
particular	O
with	O
the	O
intricate	O
and	O
beautiful	O
geometric	B
relations	O
that	O
exist	O
between	O
the	O
images	O
of	O
ob-	O
jects	O
in	O
the	O
world	O
.	O
these	O
relations	O
are	O
important	O
to	O
analyze	O
for	O
their	O
own	O
sake	O
because	O
xi	O
xii	O
0	O
foreword	O
this	O
is	O
one	O
of	O
the	O
goals	O
of	O
science	O
to	O
provide	O
explanations	O
for	O
appearances	O
;	O
they	O
are	O
also	O
important	O
to	O
analyze	O
because	O
of	O
the	O
range	O
of	O
applications	O
their	O
understanding	O
opens	O
up	O
.	O
the	O
book	O
has	O
been	O
written	O
by	O
two	O
pioneers	O
and	O
leading	O
experts	O
in	O
geometric	O
com-	O
puter	O
vision	O
.	O
they	O
have	O
succeeded	O
in	O
what	O
was	O
something	O
of	O
a	O
challenge	O
,	O
namely	O
to	O
convey	O
in	O
a	O
simple	O
and	O
easily	O
accessible	O
way	O
the	O
mathematics	O
that	O
is	O
necessary	O
for	O
understanding	O
the	O
underlying	O
geometric	B
concepts	O
,	O
to	O
be	O
quite	O
exhaustive	O
in	O
the	O
cover-	O
age	O
of	O
the	O
results	O
that	O
have	O
been	O
obtained	O
by	O
them	O
and	O
other	O
researchers	O
worldwide	O
,	O
to	O
analyze	O
the	O
interplay	O
between	O
the	O
geometry	O
and	O
the	O
fact	O
that	O
the	O
image	O
measurements	O
are	O
necessarily	O
noisy	O
,	O
to	O
express	O
many	O
of	O
these	O
theoretical	O
results	O
in	O
algorithmic	O
form	O
so	O
that	O
they	O
can	O
readily	O
be	O
transformed	O
into	O
computer	O
code	O
,	O
and	O
to	O
present	O
many	O
real	O
examples	B
that	O
illustrate	O
the	O
concepts	O
and	O
show	O
the	O
range	O
of	O
applicability	O
of	O
the	O
theory	O
.	O
returning	O
to	O
the	O
original	O
holy	O
grail	O
of	O
making	O
a	O
computer	O
see	O
we	O
may	O
wonder	O
whether	O
this	O
kind	O
of	O
work	O
is	O
a	O
step	O
in	O
the	O
right	O
direction	O
.	O
i	O
must	O
leave	O
the	O
readers	O
of	O
the	O
book	O
to	O
answer	O
this	O
question	O
,	O
and	O
be	O
content	O
with	O
saying	O
that	O
no	O
designer	O
of	O
systems	O
using	O
cameras	O
hooked	O
to	O
computers	O
that	O
will	O
be	O
built	O
in	O
the	O
foreseeable	O
future	O
can	O
ignore	O
this	O
work	O
.	O
this	O
is	O
perhaps	O
a	O
step	O
in	O
the	O
direction	O
of	O
deﬁning	O
what	O
it	O
means	O
for	O
a	O
computer	O
to	O
see	O
.	O
preface	O
over	O
the	O
past	O
decade	O
there	O
has	O
been	O
a	O
rapid	O
development	O
in	O
the	O
understanding	O
and	O
mod-	O
elling	O
of	O
the	O
geometry	O
of	O
multiple	O
views	O
in	O
computer	O
vision	O
.	O
the	O
theory	O
and	O
practice	O
have	O
now	O
reached	O
a	O
level	O
of	O
maturity	O
where	O
excellent	O
results	O
can	O
be	O
achieved	O
for	O
prob-	O
lems	O
that	O
were	O
certainly	O
unsolved	O
a	O
decade	O
ago	O
,	O
and	O
often	O
thought	O
unsolvable	O
.	O
these	O
tasks	O
and	O
algorithms	O
include	O
:	O
•	O
given	O
two	O
images	O
,	O
and	O
no	O
other	O
information	O
,	O
compute	O
matches	O
between	O
the	O
images	O
,	O
and	O
the	O
3d	O
position	O
of	O
the	O
points	O
that	O
generate	O
these	O
matches	O
and	O
the	O
cameras	B
that	O
generate	O
the	O
images	O
.	O
•	O
given	O
three	O
images	O
,	O
and	O
no	O
other	O
information	O
,	O
similarly	O
compute	O
the	O
matches	O
be-	O
tween	O
images	O
of	B
points	I
and	O
lines	B
,	O
and	O
the	O
position	O
in	O
3d	O
of	O
these	O
points	O
and	O
lines	B
and	O
the	O
cameras	B
.	O
•	O
compute	O
the	O
epipolar	B
geometry	O
of	B
a	I
stereo	I
rig	I
,	O
and	O
trifocal	B
geometry	O
of	O
a	O
trinocular	O
rig	O
,	O
without	O
requiring	O
a	O
calibration	B
object	O
.	O
•	O
compute	O
the	O
internal	B
calibration	O
of	O
a	O
camera	O
from	O
a	O
sequence	O
of	O
images	O
of	O
natural	O
scenes	O
(	O
i.e	O
.	O
calibration	B
“	O
on	O
the	O
ﬂy	O
”	O
)	O
.	O
the	O
distinctive	O
ﬂavour	O
of	O
these	O
algorithms	O
is	O
that	O
they	O
are	O
uncalibrated	O
—	O
it	O
is	O
not	O
necessary	O
to	O
know	O
or	O
ﬁrst	O
need	O
to	O
compute	O
the	O
camera	B
internal	O
parameters	B
(	O
such	O
as	O
the	O
focal	B
length	I
)	O
.	O
underpinning	O
these	O
algorithms	O
is	O
a	O
new	O
and	O
more	O
complete	O
theoretical	O
understand-	O
ing	O
of	O
the	O
geometry	O
of	O
multiple	O
uncalibrated	O
views	O
:	O
the	O
number	O
of	O
parameters	O
involved	O
,	O
the	O
constraints	B
between	O
points	O
and	O
lines	B
imaged	O
in	O
the	O
views	O
;	O
and	O
the	O
retrieval	O
of	O
cam-	O
eras	O
and	O
3-space	O
points	O
from	O
image	O
correspondences	O
.	O
for	O
example	O
,	O
to	O
determine	O
the	O
epipolar	B
geometry	O
of	B
a	I
stereo	I
rig	I
requires	O
specifying	O
only	O
seven	O
parameters	B
,	O
the	O
camera	B
calibration	I
is	O
not	O
required	O
.	O
these	O
parameters	B
are	O
determined	O
from	O
the	O
correspondence	B
of	O
seven	O
or	O
more	O
image	O
point	B
correspondences	O
.	O
contrast	O
this	O
uncalibrated	O
route	O
,	O
with	O
the	O
previous	O
calibrated	B
route	O
of	O
a	O
decade	O
ago	O
:	O
each	O
camera	B
would	O
ﬁrst	O
be	O
calibrated	B
from	O
the	O
image	O
of	O
a	O
carefully	O
engineered	O
calibration	B
object	O
with	O
known	O
geometry	O
.	O
the	O
calibration	B
involves	O
determining	B
11	O
parameters	B
for	O
each	O
camera	B
.	O
the	O
epipolar	B
geome-	O
try	O
would	O
then	O
have	O
been	O
computed	O
from	O
these	O
two	O
sets	O
of	O
11	O
parameters	B
.	O
this	O
example	O
illustrates	O
the	O
importance	O
of	O
the	O
uncalibrated	O
(	O
projective	B
)	O
approach	O
–	O
using	O
the	O
appropriate	O
representation	B
of	O
the	O
geometry	O
makes	O
explicit	O
the	O
parameters	B
xiii	O
xiv	O
preface	O
that	O
are	O
required	O
at	O
each	O
stage	O
of	O
a	O
computation	O
.	O
this	O
avoids	O
computing	B
parameters	O
that	O
have	O
no	O
effect	O
on	O
the	O
ﬁnal	O
result	O
,	O
and	O
results	O
in	O
simpler	O
algorithms	O
.	O
it	O
is	O
also	O
worth	O
correcting	O
a	O
possible	O
misconception	O
.	O
in	O
the	O
uncalibrated	O
framework	O
,	O
entities	O
(	O
for	O
instance	O
point	B
positions	O
in	O
3-space	O
)	O
are	O
often	O
recovered	O
to	O
within	O
a	O
precisely	O
deﬁned	O
ambiguity	O
.	O
this	O
ambiguity	B
does	O
not	O
mean	O
that	O
the	O
points	O
are	O
poorly	O
estimated	O
.	O
more	O
practically	O
,	O
it	O
is	O
often	O
not	O
possible	O
to	O
calibrate	O
cameras	B
once-and-for-all	O
;	O
for	O
instance	O
where	O
cameras	B
are	O
moved	O
(	O
on	O
a	O
mobile	O
vehicle	O
)	O
or	O
internal	B
parameters	I
are	O
changed	O
(	O
a	O
surveillance	O
camera	B
with	O
zoom	O
)	O
.	O
furthermore	O
,	O
calibration	B
information	O
is	O
simply	O
not	O
available	O
in	O
some	O
circumstances	O
.	O
imagine	O
computing	B
the	O
motion	O
of	O
a	O
cam-	O
era	O
from	O
a	O
video	O
sequence	O
,	O
or	O
building	O
a	O
virtual	O
reality	O
model	B
from	O
archive	O
ﬁlm	O
footage	O
where	O
both	O
motion	O
and	O
internal	B
calibration	O
information	O
are	O
unknown	O
.	O
the	O
achievements	O
in	O
multiple	O
view	O
geometry	O
have	O
been	O
possible	O
because	O
of	O
develop-	O
ments	O
in	O
our	O
theoretical	O
understanding	O
,	O
but	O
also	O
because	O
of	O
improvements	O
in	O
estimating	O
mathematical	O
objects	O
from	O
images	O
.	O
the	O
ﬁrst	O
improvement	O
has	O
been	O
an	O
attention	O
to	O
the	O
error	B
that	O
should	O
be	O
minimized	O
in	O
over-determined	O
systems	O
–	O
whether	O
it	O
be	O
algebraic	B
,	O
geometric	B
or	O
statistical	O
.	O
the	O
second	O
improvement	O
has	O
been	O
the	O
use	O
of	O
robust	B
estimation	O
algorithms	O
(	O
such	O
as	O
ransac	O
)	O
,	O
so	O
that	O
the	O
estimate	O
is	O
unaffected	O
by	O
“	O
outliers	O
”	O
in	O
the	O
data	O
.	O
also	O
these	O
techniques	O
have	O
generated	O
powerful	O
search	O
and	O
matching	B
algorithms	O
.	O
many	O
of	O
the	O
problems	O
of	O
reconstruction	O
have	O
now	O
reached	O
a	O
level	O
where	O
we	O
may	O
claim	O
that	O
they	O
are	O
solved	O
.	O
such	O
problems	O
include	O
:	O
(	O
i	O
)	O
estimation	B
of	I
the	O
multifocal	O
tensors	O
from	O
image	O
point	B
correspondences	O
,	O
par-	O
ticularly	O
the	O
fundamental	B
matrix	I
and	O
trifocal	B
tensors	O
(	O
the	O
quadrifocal	B
tensor	I
having	O
not	O
received	O
so	O
much	O
attention	O
)	O
.	O
(	O
ii	O
)	O
extraction	O
of	O
the	O
camera	B
matrices	I
from	O
these	O
tensors	O
,	O
and	O
subsequent	O
projective	B
reconstruction	I
from	O
two	O
,	O
three	O
and	O
four	O
views	O
.	O
other	O
signiﬁcant	O
successes	O
have	O
been	O
achieved	O
,	O
though	O
there	O
may	O
be	O
more	O
to	O
learn	O
about	O
these	O
problems	O
.	O
examples	B
include	O
:	O
(	O
i	O
)	O
application	O
of	O
bundle	B
adjustment	I
to	O
solve	O
more	O
general	O
reconstruction	B
prob-	O
lems	O
.	O
(	O
ii	O
)	O
metric	B
(	O
euclidean	O
)	O
reconstruction	B
given	O
minimal	O
assumptions	O
on	O
the	O
camera	B
matrices	I
.	O
(	O
iii	O
)	O
automatic	O
detection	O
of	O
correspondences	O
in	O
image	O
sequences	O
,	O
and	O
elimination	O
of	O
outliers	O
and	O
false	O
matches	O
using	O
the	O
multifocal	O
tensor	B
relationships	O
.	O
roadplan	O
.	O
the	O
book	O
is	O
divided	O
into	O
six	O
parts	O
and	O
there	O
are	O
seven	O
short	O
appendices	O
.	O
each	O
part	O
introduces	O
a	O
new	O
geometric	B
relation	O
:	O
the	O
homography	B
for	O
background	O
,	O
the	O
camera	B
matrix	I
for	O
single	B
view	I
,	O
the	O
fundamental	B
matrix	I
for	O
two	B
views	I
,	O
the	O
trifocal	B
tensor	I
for	O
three	O
views	O
,	O
and	O
the	O
quadrifocal	B
tensor	I
for	O
four	O
views	O
.	O
in	O
each	O
case	O
there	O
is	O
a	O
chapter	O
describing	O
the	O
relation	B
,	O
its	O
properties	B
and	O
applications	O
,	O
and	O
a	O
companion	O
chapter	O
describing	O
algorithms	O
for	O
its	O
estimation	B
from	O
image	O
measurements	O
.	O
the	O
estimation	B
algorithms	O
described	O
range	O
from	O
cheap	O
,	O
simple	O
,	O
approaches	O
through	O
to	O
the	O
optimal	O
algorithms	O
which	O
are	O
currently	O
believed	O
to	O
be	O
the	O
best	O
available	O
.	O
preface	O
xv	O
part	O
0	O
:	O
background	O
.	O
this	O
part	O
is	O
more	O
tutorial	O
than	O
the	O
others	O
.	O
it	O
introduces	O
the	O
central	O
ideas	O
in	O
the	O
projective	B
geometry	O
of	O
2-space	O
and	O
3-space	O
(	O
for	O
example	O
ideal	O
points	O
,	O
and	O
the	O
absolute	O
conic	O
)	O
;	O
how	O
this	O
geometry	O
may	O
be	O
represented	O
,	O
manipulated	O
,	O
and	O
estimated	O
;	O
and	O
how	O
the	O
geometry	O
relates	O
to	O
various	O
objectives	O
in	O
computer	O
vision	O
such	O
as	O
rectifying	O
images	O
of	O
planes	O
to	O
remove	O
perspective	O
distortion	B
.	O
part	O
1	O
:	O
single	B
view	I
geometry	O
.	O
here	O
the	O
various	O
cameras	B
that	O
model	B
the	O
perspective	O
projection	B
from	O
3-space	O
to	O
an	O
image	O
are	O
deﬁned	O
and	O
their	O
anatomy	O
explored	O
.	O
their	O
estimation	B
using	O
traditional	O
techniques	O
of	O
calibration	O
objects	O
is	O
described	O
,	O
as	O
well	O
as	O
camera	O
calibration	B
from	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
.	O
part	O
2	O
:	O
two	O
view	O
geometry	O
.	O
this	O
part	O
describes	O
the	O
epipolar	B
geometry	O
of	O
two	O
cameras	B
,	O
projective	B
reconstruction	I
from	O
image	O
point	O
correspondences	B
,	O
methods	O
of	O
resolving	O
the	O
projective	B
ambiguity	I
,	O
optimal	O
triangulation	B
,	O
transfer	B
between	O
views	O
via	O
planes	O
.	O
part	O
3	O
:	O
three	O
view	O
geometry	O
.	O
here	O
the	O
trifocal	B
geometry	O
of	O
three	O
cameras	B
is	O
de-	O
scribed	O
,	O
including	O
transfer	B
of	O
a	O
point	B
correspondence	O
from	O
two	O
views	O
to	O
a	O
third	O
,	O
and	O
similarly	O
transfer	B
for	O
a	O
line	B
correspondence	O
;	O
computation	B
of	I
the	O
geometry	O
from	O
point	O
and	O
line	O
correspondences	O
,	O
retrieval	O
of	O
the	O
camera	B
matrices	I
.	O
part	O
4	O
:	O
n-views	O
.	O
this	O
part	O
has	O
two	O
purposes	O
.	O
first	O
,	O
it	O
extends	O
three	O
view	O
geometry	O
to	O
four	O
views	O
(	O
a	O
minor	O
extension	O
)	O
and	O
describes	O
estimation	B
methods	O
applica-	O
ble	O
to	O
n-views	O
,	O
such	O
as	O
the	O
factorization	B
algorithm	O
of	O
tomasi	O
and	O
kanade	O
for	O
computing	O
structure	B
and	O
motion	O
simultaneously	O
from	O
multiple	O
images	O
.	O
sec-	O
ond	O
,	O
it	O
covers	O
themes	O
that	O
have	O
been	O
touched	O
on	O
in	O
earlier	O
chapters	O
,	O
but	O
can	O
be	O
understood	O
more	O
fully	O
and	O
uniformly	O
by	O
emphasising	O
their	O
commonality	O
.	O
examples	B
include	O
deriving	O
multi-linear	O
view	O
constraints	B
on	O
correspondences	B
,	O
auto-calibration	B
,	O
and	O
ambiguous	O
solutions	O
.	O
appendices	O
.	O
these	O
describe	O
further	O
background	O
material	O
on	O
tensors	O
,	O
statistics	O
,	O
pa-	O
rameter	O
estimation	B
,	O
linear	B
and	O
matrix	B
algebra	O
,	O
iterative	B
estimation	I
,	O
the	O
solution	B
of	O
sparse	B
matrix	O
systems	O
,	O
and	O
special	O
projective	O
transformations	O
.	O
acknowledgements	O
.	O
we	O
have	O
beneﬁted	O
enormously	O
from	O
ideas	O
and	O
discussions	O
with	O
our	O
colleagues	O
:	O
paul	O
beardsley	O
,	O
stefan	O
carlsson	O
,	O
olivier	O
faugeras	O
,	O
andrew	O
fitzgibbon	O
,	O
jitendra	O
malik	O
,	O
steve	O
maybank	O
,	O
amnon	O
shashua	O
,	O
phil	O
torr	O
,	O
bill	O
triggs	O
.	O
if	O
there	O
are	O
only	O
a	O
countable	O
number	O
of	O
errors	O
in	O
this	O
book	O
then	O
it	O
is	O
due	O
to	O
antonio	O
criminisi	O
,	O
david	O
liebowitz	O
and	O
frederik	O
schaffalitzky	O
who	O
have	O
with	O
great	O
energy	O
and	O
devotion	O
read	O
most	O
of	O
it	O
,	O
and	O
made	O
numerous	O
suggestions	O
for	O
improvements	O
.	O
similarly	O
both	O
peter	O
sturm	O
and	O
bill	O
triggs	O
have	O
suggested	O
many	O
improvements	O
to	O
various	O
chap-	O
ters	O
.	O
we	O
are	O
grateful	O
to	O
other	O
colleagues	O
who	O
have	O
read	O
individual	O
chapters	O
:	O
david	O
capel	O
,	O
lourdes	O
de	O
agapito	O
vicente	O
,	O
bob	O
kaucic	O
,	O
steve	O
maybank	O
,	O
peter	O
tu	O
.	O
we	O
are	O
particularly	O
grateful	O
to	O
those	O
who	O
have	O
provided	O
multiple	O
ﬁgures	O
:	O
paul	O
beard-	O
sley	O
,	O
antonio	O
criminisi	O
,	O
andrew	O
fitzgibbon	O
,	O
david	O
liebowitz	O
,	O
and	O
larry	O
shapiro	O
;	O
and	O
for	O
individual	O
ﬁgures	O
from	O
:	O
martin	O
armstrong	O
,	O
david	O
capel	O
,	O
lourdes	O
de	O
agapito	O
vi-	O
cente	O
,	O
eric	O
hayman	O
,	O
phil	O
pritchett	O
,	O
luc	O
robert	O
,	O
cordelia	O
schmid	O
,	O
and	O
others	O
who	O
are	O
explicitly	O
acknowledged	O
in	O
ﬁgure	O
captions	O
.	O
xvi	O
preface	O
at	O
cambridge	O
university	O
press	O
we	O
thank	O
david	O
tranah	O
for	O
his	O
constant	O
source	O
of	O
advice	O
and	O
patience	O
,	O
and	O
michael	O
behrend	O
for	O
excellent	O
copy	O
editing	O
.	O
a	O
small	O
number	O
of	O
minor	O
errors	O
have	O
been	O
corrected	O
in	O
the	O
reprinted	O
editions	O
,	O
and	O
we	O
thank	O
the	O
following	O
readers	O
for	O
pointing	O
these	O
out	O
:	O
luis	O
baumela	O
,	O
niclas	O
borlin	O
,	O
mike	O
brooks	O
,	O
jun	O
ho	O
.	O
choi	O
,	O
wojciech	O
chojnacki	O
,	O
carlo	O
colombo	O
,	O
nicolas	O
dano	O
,	O
an-	O
drew	O
fitzgibbon	O
,	O
bogdan	O
georgescu	O
,	O
fredrik	O
kahl	O
,	O
bob	O
kaucic	O
,	O
jae-hak	O
kim	O
,	O
han-	O
sung	O
lee	O
,	O
dennis	O
maier	O
,	O
karsten	O
muelhmann	O
,	O
david	O
nister	O
,	O
andreas	O
olsson	O
,	O
st´ephane	O
paris	O
,	O
frederik	O
schaffalitzky	O
,	O
bill	O
severson	O
,	O
pedro	O
lopez	O
de	O
teruel	O
alcolea	O
,	O
bernard	O
thiesse	O
,	O
ken	O
thornton	O
,	O
magdalena	O
urbanek	O
,	O
gergely	O
vass	O
,	O
eugene	O
vendrovsky	O
,	O
sui	O
wei	O
,	O
and	O
tom´aˇs	O
werner	O
.	O
the	O
second	O
edition	O
.	O
this	O
new	O
paperback	O
edition	O
has	O
been	O
expanded	O
to	O
include	O
some	O
of	O
the	O
developments	O
since	O
the	O
original	O
version	O
of	O
july	O
2000.	O
for	O
example	O
,	O
the	O
book	O
now	O
covers	O
the	O
discovery	O
of	O
a	O
closed	O
form	O
factorization	O
solution	B
in	O
the	O
projective	B
case	O
when	O
a	O
plane	B
is	O
visible	O
in	O
the	O
scene	O
,	O
and	O
the	O
extension	O
of	O
afﬁne	O
factorization	B
to	O
non-	O
rigid	O
scenes	O
.	O
we	O
have	O
also	O
extended	O
the	O
discussion	O
of	O
single	O
view	O
geometry	O
(	O
chapter	O
8	O
)	O
and	O
three	O
view	O
geometry	O
(	O
chapter	O
15	O
)	O
,	O
and	O
added	O
an	O
appendix	O
on	O
parameter	O
estimation	B
.	O
in	O
preparing	O
this	O
second	O
edition	O
we	O
are	O
very	O
grateful	O
to	O
colleagues	O
who	O
have	O
made	O
suggestion	O
for	O
improvements	O
and	O
additions	O
.	O
these	O
include	O
marc	O
pollefeys	O
,	O
bill	O
triggs	O
and	O
in	O
particular	O
tom´aˇs	O
werner	O
who	O
provided	O
excellent	O
and	O
comprehensive	O
comments	O
.	O
we	O
also	O
thank	O
antonio	O
criminisi	O
,	O
andrew	O
fitzgibbon	O
,	O
rob	O
fergus	O
,	O
david	O
liebowitz	O
,	O
and	O
particularly	O
josef	O
ˇsivic	O
,	O
for	O
proof	O
reading	O
and	O
very	O
helpful	O
comments	O
on	O
parts	O
of	O
the	O
new	O
material	O
.	O
as	O
always	O
we	O
are	O
grateful	O
to	O
david	O
tranah	O
of	O
cup	O
.	O
the	O
ﬁgures	O
appearing	O
in	O
this	O
book	O
can	O
be	O
downloaded	O
from	O
http	O
:	O
//www.robots.ox.ac.uk/∼vgg/hzbook.html	O
this	O
site	O
also	O
includes	O
matlab	O
code	O
for	O
several	O
of	O
the	O
algorithms	O
,	O
and	O
lists	O
the	O
errata	O
of	O
earlier	O
printings	O
.	O
i	O
am	O
never	O
forget	O
the	O
day	O
my	O
ﬁrst	O
book	O
is	O
published	O
.	O
every	O
chapter	O
i	O
stole	O
from	O
somewhere	O
else	O
.	O
index	O
i	O
copy	O
from	O
old	O
vladivostok	O
telephone	O
directory	O
.	O
this	O
book	O
,	O
this	O
book	O
was	O
sensational	O
!	O
excerpts	O
from	O
“	O
nikolai	O
ivanovich	O
lobachevsky	O
”	O
by	O
tom	O
lehrer	O
.	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
this	O
chapter	O
is	O
an	O
introduction	O
to	O
the	O
principal	O
ideas	O
covered	O
in	O
this	O
book	O
.	O
it	O
gives	O
an	O
informal	O
treatment	O
of	O
these	O
topics	O
.	O
precise	O
,	O
unambiguous	O
deﬁnitions	O
,	O
careful	O
algebra	O
,	O
and	O
the	O
description	O
of	O
well	O
honed	O
estimation	B
algorithms	O
is	O
postponed	O
until	O
chapter	O
2	O
and	O
the	O
following	O
chapters	O
in	O
the	O
book	O
.	O
throughout	O
this	O
introduction	O
we	O
will	O
generally	O
not	O
give	O
speciﬁc	O
forward	O
pointers	O
to	O
these	O
later	O
chapters	O
.	O
the	O
material	O
referred	O
to	O
can	O
be	O
located	O
by	O
use	O
of	O
the	O
index	O
or	O
table	O
of	O
contents	O
.	O
1.1	O
introduction	O
–	O
the	O
ubiquitous	O
projective	B
geometry	O
we	O
are	O
all	O
familiar	O
with	O
projective	O
transformations.when	O
we	O
look	O
at	O
a	O
picture	B
,	O
we	O
see	O
squares	O
that	O
are	O
not	O
squares	O
,	O
or	O
circles	O
that	O
are	O
not	O
circles	O
.	O
the	O
transformation	B
that	O
maps	O
these	O
planar	O
objects	O
onto	O
the	O
picture	B
is	O
an	O
example	O
of	O
a	O
projective	O
transformation	B
.	O
so	O
what	O
properties	O
of	O
geometry	O
are	O
preserved	O
by	O
projective	B
transformations	O
?	O
cer-	O
tainly	O
,	O
shape	O
is	O
not	O
,	O
since	O
a	O
circle	O
may	O
appear	O
as	O
an	O
ellipse	O
.	O
neither	O
are	O
lengths	O
since	O
two	O
perpendicular	O
radii	O
of	O
a	O
circle	O
are	O
stretched	O
by	O
different	O
amounts	O
by	O
the	O
projective	B
transformation	I
.	O
angles	O
,	O
distance	B
,	O
ratios	O
of	O
distances	O
–	O
none	O
of	O
these	O
are	O
preserved	O
,	O
and	O
it	O
may	O
appear	O
that	O
very	O
little	O
geometry	O
is	O
preserved	O
by	O
a	O
projective	B
transformation	I
.	O
however	O
,	O
a	O
property	O
that	O
is	O
preserved	O
is	O
that	O
of	O
straightness	O
.	O
it	O
turns	O
out	O
that	O
this	O
is	O
the	O
most	O
general	O
requirement	O
on	O
the	O
mapping	O
,	O
and	O
we	O
may	O
deﬁne	O
a	O
projective	B
trans-	O
formation	O
of	O
a	O
plane	O
as	O
any	O
mapping	O
of	O
the	O
points	O
on	O
the	O
plane	B
that	O
preserves	O
straight	O
lines	B
.	O
to	O
see	O
why	O
we	O
will	O
require	O
projective	B
geometry	O
we	O
start	O
from	O
the	O
familiar	O
euclidean	B
geometry	I
.	O
this	O
is	O
the	O
geometry	O
that	O
describes	O
angles	O
and	O
shapes	O
of	O
objects	O
.	O
euclidean	B
geometry	I
is	O
troublesome	O
in	O
one	O
major	O
respect	O
–	O
we	O
need	O
to	O
keep	O
making	O
an	O
exception	O
to	O
reason	O
about	O
some	O
of	O
the	O
basic	O
concepts	O
of	O
the	O
geometry	O
–	O
such	O
as	O
intersection	O
of	B
lines	I
.	O
two	O
lines	O
(	O
we	O
are	O
thinking	O
here	O
of	O
2-dimensional	O
geometry	O
)	O
almost	O
always	O
meet	O
in	O
a	O
point	B
,	O
but	O
there	O
are	O
some	O
pairs	O
of	B
lines	I
that	O
do	O
not	O
do	O
so	O
–	O
those	O
that	O
we	O
call	O
parallel	B
.	O
a	O
common	O
linguistic	O
device	O
for	O
getting	O
around	O
this	O
is	O
to	O
say	O
that	O
parallel	B
lines	I
meet	O
“	O
at	B
inﬁnity	I
”	O
.	O
however	O
this	O
is	O
not	O
altogether	O
convincing	O
,	O
and	O
conﬂicts	O
with	O
another	O
dictum	O
,	O
that	O
inﬁnity	O
does	O
not	O
exist	O
,	O
and	O
is	O
only	O
a	O
convenient	O
ﬁction	O
.	O
we	O
can	O
get	O
around	O
this	O
by	O
1	O
2	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
enhancing	O
the	O
euclidean	O
plane	O
by	O
the	O
addition	O
of	O
these	O
points	O
at	O
inﬁnity	O
where	O
parallel	B
lines	I
meet	O
,	O
and	O
resolving	O
the	O
difﬁculty	O
with	O
inﬁnity	O
by	O
calling	O
them	O
“	O
ideal	O
points.	O
”	O
by	O
adding	O
these	O
points	O
at	O
inﬁnity	O
,	O
the	O
familiar	O
euclidean	O
space	O
is	O
transformed	O
into	O
a	O
new	O
type	O
of	O
geometric	O
object	O
,	O
projective	B
space	O
.	O
this	O
is	O
a	O
very	O
useful	O
way	O
of	O
thinking	O
,	O
since	O
we	O
are	O
familiar	O
with	O
the	O
properties	B
of	O
euclidean	O
space	O
,	O
involving	O
concepts	O
such	O
as	O
distances	O
,	O
angles	O
,	O
points	O
,	O
lines	B
and	O
incidence	O
.	O
there	O
is	O
nothing	O
very	O
mysterious	O
about	O
projective	B
space	O
–	O
it	O
is	O
just	O
an	O
extension	O
of	O
euclidean	O
space	O
in	O
which	O
two	O
lines	O
always	O
meet	O
in	O
a	O
point	B
,	O
though	O
sometimes	O
at	O
mysterious	O
points	O
at	O
inﬁnity	O
.	O
coordinates	B
.	O
a	O
point	B
in	O
euclidean	O
2-space	O
is	O
represented	O
by	O
an	O
ordered	O
pair	O
of	O
real	O
numbers	O
,	O
(	O
x	O
,	O
y	O
)	O
.	O
we	O
may	O
add	O
an	O
extra	O
coordinate	O
to	O
this	O
pair	O
,	O
giving	O
a	O
triple	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
,	O
that	O
we	O
declare	O
to	O
represent	O
the	O
same	O
point	O
.	O
this	O
seems	O
harmless	O
enough	O
,	O
since	O
we	O
can	O
go	O
back	O
and	O
forward	O
from	O
one	O
representation	B
of	O
the	O
point	B
to	O
the	O
other	O
,	O
simply	O
by	O
adding	O
or	O
removing	O
the	O
last	O
coordinate	O
.	O
we	O
now	O
take	O
the	O
important	O
conceptual	O
step	O
of	O
asking	O
why	O
the	O
last	O
coordinate	O
needs	O
to	O
be	O
1	O
–	O
after	O
all	O
,	O
the	O
others	O
two	O
coordinates	O
are	O
not	O
so	O
constrained	O
.	O
what	O
about	O
a	O
coordinate	O
triple	O
(	O
x	O
,	O
y	O
,	O
2	O
)	O
.	O
it	O
is	O
here	O
that	O
we	O
make	O
a	O
deﬁnition	B
and	O
say	O
that	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
and	O
(	O
2x	O
,	O
2y	O
,	O
2	O
)	O
represent	O
the	O
same	O
point	O
,	O
and	O
furthermore	O
,	O
(	O
kx	O
,	O
ky	O
,	O
k	O
)	O
represents	O
the	O
same	O
point	O
as	O
well	O
,	O
for	O
any	O
non-zero	O
value	O
k.	O
formally	O
,	O
points	O
are	O
represented	O
by	O
equivalence	O
classes	O
of	O
coordinate	O
triples	O
,	O
where	O
two	O
triples	O
are	O
equivalent	B
when	O
they	O
differ	O
by	O
a	O
common	O
multiple	O
.	O
these	O
are	O
called	O
the	O
homogeneous	O
coordinates	O
of	O
the	O
point	O
.	O
given	O
a	O
coordinate	O
triple	O
(	O
kx	O
,	O
ky	O
,	O
k	O
)	O
,	O
we	O
can	O
get	O
the	O
original	O
coordinates	B
back	O
by	O
dividing	O
by	O
k	O
to	O
get	O
(	O
x	O
,	O
y	O
)	O
.	O
the	O
reader	O
will	O
observe	O
that	O
although	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
represents	O
the	O
same	O
point	O
as	O
the	O
co-	O
ordinate	O
pair	O
(	O
x	O
,	O
y	O
)	O
,	O
there	O
is	O
no	O
point	O
that	O
corresponds	O
to	O
the	O
triple	O
(	O
x	O
,	O
y	O
,	O
0	O
)	O
.	O
if	O
we	O
try	O
to	O
divide	O
by	O
the	O
last	O
coordinate	O
,	O
we	O
get	O
the	O
point	B
(	O
x/0	O
,	O
y/0	O
)	O
which	O
is	O
inﬁnite	O
.	O
this	O
is	O
how	O
the	O
points	O
at	O
inﬁnity	O
arise	O
then	O
.	O
they	O
are	O
the	O
points	O
represented	O
by	O
homogeneous	O
coordinates	O
in	O
which	O
the	O
last	O
coordinate	O
is	O
zero	O
.	O
once	O
we	O
have	O
seen	O
how	O
to	O
do	O
this	O
for	O
2-dimensional	O
euclidean	O
space	O
,	O
extending	O
it	O
to	O
a	O
projective	B
space	O
by	O
representing	O
points	O
as	O
homogeneous	O
vectors	O
,	O
it	O
is	O
clear	O
that	O
we	O
can	O
do	O
the	O
same	O
thing	O
in	O
any	O
dimension	O
.	O
the	O
euclidean	O
space	O
irn	O
can	O
be	O
extended	O
to	O
a	O
projective	B
space	O
ipn	O
by	O
representing	O
points	O
as	O
homogeneous	O
vectors	O
.	O
it	O
turns	O
out	O
that	O
the	O
points	O
at	O
inﬁnity	O
in	O
the	O
two-dimensional	B
projective	O
space	O
form	O
a	O
line	B
,	O
usually	O
called	O
the	O
line	B
at	I
inﬁnity	I
.	O
in	O
three-dimensions	O
they	O
form	O
the	O
plane	O
at	O
inﬁnity	O
.	O
homogeneity	O
.	O
in	O
classical	O
euclidean	B
geometry	I
all	O
points	O
are	O
the	O
same	O
.	O
there	O
is	O
no	O
distinguished	O
point	B
.	O
the	O
whole	O
of	O
the	O
space	O
is	O
homogeneous	O
.	O
when	O
coordinates	B
are	O
added	O
,	O
one	O
point	B
is	O
seemingly	O
picked	O
out	O
as	O
the	O
origin	O
.	O
however	O
,	O
it	O
is	O
important	O
to	O
realize	O
that	O
this	O
is	O
just	O
an	O
accident	O
of	O
the	O
particular	O
coordinate	O
frame	O
chosen	O
.	O
we	O
could	O
just	O
as	O
well	O
ﬁnd	O
a	O
different	O
way	O
of	O
coordinatizing	O
the	O
plane	B
in	O
which	O
a	O
different	O
point	B
is	O
considered	O
to	O
be	O
the	O
origin	O
.	O
in	O
fact	O
,	O
we	O
can	O
consider	O
a	O
change	B
of	I
coordinates	I
for	O
the	O
euclidean	O
space	O
in	O
which	O
the	O
axes	O
are	O
shifted	O
and	O
rotated	O
to	O
a	O
different	O
position	O
.	O
we	O
may	O
think	O
of	O
this	O
in	O
another	O
way	O
as	O
the	O
space	O
itself	O
translating	O
and	O
rotating	O
to	O
a	O
different	O
position	O
.	O
the	O
resulting	O
operation	O
is	O
known	O
as	O
a	O
euclidean	O
transform	O
.	O
a	O
more	O
general	O
type	O
of	O
transformation	O
is	O
that	O
of	O
applying	O
a	O
linear	B
transformation	O
1.1	O
introduction	O
–	O
the	O
ubiquitous	O
projective	B
geometry	O
3	O
to	O
irn	O
,	O
followed	O
by	O
a	O
euclidean	O
transformation	O
moving	B
the	O
origin	O
of	O
the	O
space	O
.	O
we	O
may	O
think	O
of	O
this	O
as	O
the	O
space	O
moving	O
,	O
rotating	O
and	O
ﬁnally	O
stretching	O
linearly	O
possibly	O
by	O
different	O
ratios	O
in	O
different	O
directions	O
.	O
the	O
resulting	O
transformation	B
is	O
known	O
as	O
an	O
afﬁne	B
transformation	I
.	O
the	O
result	O
of	O
either	O
a	O
euclidean	O
or	O
an	O
afﬁne	B
transformation	I
is	O
that	O
points	O
at	O
inﬁn-	O
ity	O
remain	O
at	B
inﬁnity	I
.	O
such	O
points	O
are	O
in	O
some	O
way	O
preserved	O
,	O
at	O
least	O
as	O
a	O
set	O
,	O
by	O
such	O
transformations	O
.	O
they	O
are	O
in	O
some	O
way	O
distinguished	O
,	O
or	O
special	O
in	O
the	O
context	O
of	O
euclidean	O
or	O
afﬁne	B
geometry	I
.	O
from	O
the	O
point	B
of	O
view	O
of	O
projective	O
geometry	O
,	O
points	O
at	O
inﬁnity	O
are	O
not	O
any	O
dif-	O
ferent	O
from	O
other	O
points	O
.	O
just	O
as	O
euclidean	O
space	O
is	O
uniform	O
,	O
so	O
is	O
projective	B
space	O
.	O
the	O
property	O
that	O
points	O
at	O
inﬁnity	O
have	O
ﬁnal	O
coordinate	O
zero	O
in	O
a	O
homogeneous	O
co-	O
ordinate	O
representation	B
is	O
nothing	O
other	O
than	O
an	O
accident	O
of	O
the	O
choice	O
of	O
coordinate	O
frame	O
.	O
by	O
analogy	O
with	O
euclidean	O
or	O
afﬁne	B
transformations	O
,	O
we	O
may	O
deﬁne	O
a	O
projec-	O
tive	O
transformation	B
of	O
projective	B
space	O
.	O
a	O
linear	B
transformation	O
of	O
euclidean	O
space	O
irn	O
is	O
represented	O
by	O
matrix	B
multiplication	O
applied	O
to	O
the	O
coordinates	B
of	O
the	O
point	B
.	O
in	O
just	O
the	O
same	O
way	O
a	O
projective	B
transformation	I
of	O
projective	B
space	O
ipn	O
is	O
a	O
mapping	O
of	O
the	O
homogeneous	O
coordinates	O
representing	O
a	O
point	B
(	O
an	O
(	O
n	O
+	O
1	O
)	O
-vector	O
)	O
,	O
in	O
which	O
the	O
coor-	O
dinate	O
vector	O
is	O
multiplied	O
by	O
a	O
non-singular	O
matrix	B
.	O
under	O
such	O
a	O
mapping	O
,	O
points	O
at	O
inﬁnity	O
(	O
with	O
ﬁnal	O
coordinate	O
zero	O
)	O
are	O
mapped	O
to	O
arbitrary	O
other	O
points	O
.	O
the	O
points	O
at	O
inﬁnity	O
are	O
not	O
preserved	O
.	O
thus	O
,	O
a	O
projective	B
transformation	I
of	O
projective	B
space	O
ipn	O
is	O
represented	O
by	O
a	O
linear	B
transformation	O
of	O
homogeneous	O
coordinates	O
x	O
(	O
cid:2	O
)	O
=	O
h	O
(	O
n+1	O
)	O
×	O
(	O
n+1	O
)	O
x.	O
in	O
computer	O
vision	O
problems	O
,	O
projective	B
space	O
is	O
used	O
as	O
a	O
convenient	O
way	O
of	O
repre-	O
senting	O
the	O
real	O
3d	O
world	O
,	O
by	O
extending	O
it	O
to	O
the	O
3-dimensional	O
(	O
3d	O
)	O
projective	B
space	O
.	O
similarly	O
images	O
,	O
usually	O
formed	O
by	O
projecting	O
the	O
world	O
onto	O
a	O
2-dimensional	O
repre-	O
sentation	O
,	O
are	O
for	O
convenience	O
extended	O
to	O
be	O
thought	O
of	O
as	O
lying	O
in	O
the	O
2-dimensional	O
projective	B
space	O
.	O
in	O
reality	O
,	O
the	O
real	O
world	O
,	O
and	O
images	O
of	O
it	O
do	O
not	O
contain	O
points	O
at	O
inﬁnity	O
,	O
and	O
we	O
need	O
to	O
keep	O
our	O
ﬁnger	O
on	O
which	O
are	O
the	O
ﬁctitious	O
points	O
,	O
namely	O
the	O
line	B
at	I
inﬁnity	I
in	O
the	O
image	O
and	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
world	O
.	O
for	O
this	O
reason	O
,	O
al-	O
though	O
we	O
usually	O
work	O
with	O
the	O
projective	B
spaces	O
,	O
we	O
are	O
aware	O
that	O
the	O
line	B
and	O
plane	O
at	O
inﬁnity	O
are	O
in	O
some	O
way	O
special	O
.	O
this	O
goes	O
against	O
the	O
spirit	O
of	O
pure	O
projective	B
ge-	O
ometry	O
,	O
but	O
makes	O
it	O
useful	O
for	O
our	O
practical	O
problems	O
.	O
generally	O
we	O
try	O
to	O
have	O
it	O
both	O
ways	O
by	O
treating	O
all	O
points	O
in	O
projective	B
space	O
as	O
equals	O
when	O
it	O
suits	O
us	O
,	O
and	O
singling	O
out	O
the	O
line	B
at	I
inﬁnity	I
in	O
space	O
or	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
image	O
when	O
that	O
becomes	O
necessary	O
.	O
1.1.1	O
afﬁne	B
and	O
euclidean	B
geometry	I
we	O
have	O
seen	O
that	O
projective	B
space	O
can	O
be	O
obtained	O
from	O
euclidean	O
space	O
by	O
adding	O
a	O
line	B
(	O
or	O
plane	B
)	O
at	B
inﬁnity	I
.	O
we	O
now	O
consider	O
the	O
reverse	O
process	O
of	O
going	O
backwards	O
.	O
this	O
discussion	O
is	O
mainly	O
concerned	O
with	O
two	O
and	O
three-dimensional	O
projective	B
space	O
.	O
afﬁne	B
geometry	I
.	O
we	O
will	O
take	O
the	O
point	B
of	O
view	O
that	O
the	O
projective	B
space	O
is	O
initially	O
homogeneous	O
,	O
with	O
no	O
particular	O
coordinate	O
frame	O
being	O
preferred	O
.	O
in	O
such	O
a	O
space	O
,	O
4	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
there	O
is	O
no	O
concept	O
of	O
parallelism	O
of	B
lines	I
,	O
since	O
parallel	B
lines	I
(	O
or	O
planes	O
in	O
the	O
three-	O
dimensional	O
case	O
)	O
are	O
ones	O
that	O
meet	O
at	B
inﬁnity	I
.	O
however	O
,	O
in	B
projective	I
space	I
,	O
there	O
is	O
no	O
concept	O
of	O
which	O
points	O
are	O
at	B
inﬁnity	I
–	O
all	O
points	O
are	O
created	O
equal	O
.	O
we	O
say	O
that	O
parallelism	O
is	O
not	O
a	O
concept	O
of	O
projective	O
geometry	O
.	O
it	O
is	O
simply	O
meaningless	O
to	O
talk	O
about	O
it	O
.	O
in	O
order	O
for	O
such	O
a	O
concept	O
to	O
make	O
sense	O
,	O
we	O
need	O
to	O
pick	O
out	O
some	O
particular	O
line	B
,	O
and	O
decide	O
that	O
this	O
is	O
the	O
line	B
at	I
inﬁnity	I
.	O
this	O
results	O
in	O
a	O
situation	O
where	O
although	O
all	O
points	O
are	O
created	O
equal	O
,	O
some	O
are	O
more	O
equal	O
than	O
others	O
.	O
thus	O
,	O
start	O
with	O
a	O
blank	O
sheet	O
of	O
paper	O
,	O
and	O
imagine	O
that	O
it	O
extends	O
to	O
inﬁnity	O
and	O
forms	O
a	O
projective	B
space	O
ip2	O
.	O
what	O
we	O
see	O
is	O
just	O
a	O
small	O
part	O
of	O
the	O
space	O
,	O
that	O
looks	O
a	O
lot	O
like	O
a	O
piece	O
of	O
the	O
ordinary	O
euclidean	O
plane	O
.	O
now	O
,	O
let	O
us	O
draw	O
a	O
straight	O
line	B
on	O
the	O
paper	O
,	O
and	O
declare	O
that	O
this	O
is	O
the	O
line	B
at	I
inﬁnity	I
.	O
next	O
,	O
we	O
draw	O
two	O
other	O
lines	B
that	O
intersect	O
at	O
this	O
distinguished	O
line	B
.	O
since	O
they	O
meet	O
at	O
the	O
“	O
line	B
at	I
inﬁnity	I
”	O
we	O
deﬁne	O
them	O
as	O
being	O
parallel	B
.	O
the	O
situation	O
is	O
similar	O
to	O
what	O
one	O
sees	O
by	O
looking	O
at	O
an	O
inﬁnite	O
plane	O
.	O
think	O
of	O
a	O
photograph	O
taken	O
in	O
a	O
very	O
ﬂat	O
region	O
of	O
the	O
earth	O
.	O
the	O
points	O
at	O
inﬁnity	O
in	O
the	O
plane	B
show	O
up	O
in	O
the	O
image	O
as	O
the	O
horizon	O
line	B
.	O
lines	B
,	O
such	O
as	O
railway	O
tracks	O
show	O
up	O
in	O
the	O
image	O
as	O
lines	B
meeting	O
at	O
the	O
horizon	O
.	O
points	O
in	O
the	O
image	O
lying	O
above	O
the	O
horizon	O
(	O
the	O
image	O
of	O
the	O
sky	O
)	O
apparently	O
do	O
not	O
correspond	O
to	O
points	O
on	O
the	O
world	O
plane	B
.	O
however	O
,	O
if	O
we	O
think	O
of	O
extending	O
the	O
corresponding	O
ray	O
backwards	O
behind	O
the	O
camera	B
,	O
it	O
will	O
meet	O
the	O
plane	O
at	O
a	O
point	B
behind	O
the	O
camera	B
.	O
thus	O
there	O
is	O
a	O
one-to-one	O
relationship	O
between	O
points	O
in	O
the	O
image	O
and	O
points	O
in	O
the	O
world	O
plane	B
.	O
the	O
points	O
at	O
inﬁnity	O
in	O
the	O
world	O
plane	B
correspond	O
to	O
a	O
real	O
horizon	O
line	B
in	O
the	O
image	O
,	O
and	O
parallel	B
lines	I
in	O
the	O
world	O
correspond	O
to	O
lines	O
meeting	O
at	O
the	O
horizon	O
.	O
from	O
our	O
point	B
of	O
view	O
,	O
the	O
world	O
plane	B
and	O
its	O
image	O
are	O
just	O
alternative	O
ways	O
of	O
viewing	O
the	O
geometry	O
of	O
a	O
projective	O
plane	B
,	O
plus	O
a	O
distinguished	O
line	B
.	O
the	O
geometry	O
of	O
the	O
projective	O
plane	B
and	O
a	O
distinguished	O
line	B
is	O
known	O
as	O
afﬁne	B
geometry	I
and	O
any	O
projective	B
transformation	I
that	O
maps	O
the	O
distinguished	O
line	B
in	O
one	O
space	O
to	O
the	O
distinguished	O
line	B
of	O
the	O
other	O
space	O
is	O
known	O
as	O
an	O
afﬁne	B
transformation	I
.	O
by	O
identifying	O
a	O
special	O
line	O
as	O
the	O
“	O
line	B
at	I
inﬁnity	I
”	O
we	O
are	O
able	O
to	O
deﬁne	O
parallelism	O
of	O
straight	O
lines	B
in	O
the	O
plane	B
.	O
however	O
,	O
certain	O
other	O
concepts	O
make	O
sense	O
as	O
well	O
,	O
as	O
soon	O
as	O
we	O
can	O
deﬁne	O
parallelism	O
.	O
for	O
instance	O
,	O
we	O
may	O
deﬁne	O
equalities	O
of	O
intervals	O
between	O
two	O
points	O
on	O
parallel	O
lines	B
.	O
for	O
instance	O
,	O
if	O
a	O
,	O
b	O
,	O
c	O
and	O
d	O
are	O
points	O
,	O
and	O
the	O
lines	B
ab	O
and	O
cd	O
are	O
parallel	B
,	O
then	O
we	O
deﬁne	O
the	O
two	O
intervals	O
ab	O
and	O
cd	O
to	O
have	O
equal	O
length	O
if	O
the	O
lines	B
ac	O
and	O
bd	O
are	O
also	O
parallel	B
.	O
similarly	O
,	O
two	O
intervals	O
on	O
the	O
same	O
line	O
are	O
equal	O
if	O
there	O
exists	O
another	O
interval	O
on	O
a	O
parallel	O
line	B
that	O
is	O
equal	O
to	O
both	O
.	O
euclidean	B
geometry	I
.	O
by	O
distinguishing	O
a	O
special	O
line	O
in	O
a	O
projective	B
plane	I
,	O
we	O
gain	O
the	O
concept	O
of	O
parallelism	O
and	O
with	O
it	O
afﬁne	B
geometry	I
.	O
afﬁne	B
geometry	I
is	O
seen	O
as	O
specialization	O
of	O
projective	O
geometry	O
,	O
in	O
which	O
we	O
single	O
out	O
a	O
particular	O
line	B
(	O
or	O
plane	B
–	O
according	O
to	O
the	O
dimension	O
)	O
and	O
call	O
it	O
the	O
line	B
at	I
inﬁnity	I
.	O
next	O
,	O
we	O
turn	O
to	O
euclidean	O
geometry	O
and	O
show	O
that	O
by	O
singling	O
out	O
some	O
special	O
feature	O
of	O
the	O
line	O
or	O
plane	O
at	O
inﬁnity	O
afﬁne	O
geometry	O
becomes	O
euclidean	B
geometry	I
.	O
in	O
1.1	O
introduction	O
–	O
the	O
ubiquitous	O
projective	B
geometry	O
5	O
doing	O
so	O
,	O
we	O
introduce	O
one	O
of	O
the	O
most	O
important	O
concepts	O
of	O
this	O
book	O
,	O
the	O
absolute	O
conic	O
.	O
we	O
begin	O
by	O
considering	O
two-dimensional	B
geometry	O
,	O
and	O
start	O
with	O
circles	O
.	O
note	O
that	O
a	O
circle	O
is	O
not	O
a	O
concept	O
of	O
afﬁne	O
geometry	O
,	O
since	O
arbitrary	O
stretching	O
of	O
the	O
plane	O
,	O
which	O
preserves	O
the	O
line	B
at	I
inﬁnity	I
,	O
turns	O
the	O
circle	O
into	O
an	O
ellipse	O
.	O
thus	O
,	O
afﬁne	B
geometry	I
does	O
not	O
distinguish	O
between	O
circles	O
and	O
ellipses	O
.	O
in	O
euclidean	O
geometry	O
however	O
,	O
they	O
are	O
distinct	O
,	O
and	O
have	O
an	O
important	O
difference	O
.	O
algebraically	O
,	O
an	O
ellipse	O
is	O
described	O
by	O
a	O
second-degree	O
equation	O
.	O
it	O
is	O
therefore	O
ex-	O
pected	O
,	O
and	O
true	O
that	O
two	O
ellipses	O
will	O
most	O
generally	O
intersect	O
in	O
four	O
points	O
.	O
however	O
,	O
it	O
is	O
geometrically	O
evident	O
that	O
two	O
distinct	O
circles	O
can	O
not	O
intersect	O
in	O
more	O
than	O
two	O
points	O
.	O
algebraically	O
,	O
we	O
are	O
intersecting	O
two	O
second-degree	O
curves	O
here	O
,	O
or	O
equiva-	O
lently	O
solving	B
two	O
quadratic	O
equations	O
.	O
we	O
should	O
expect	O
to	O
get	O
four	B
solutions	I
.	O
the	O
question	O
is	O
,	O
what	O
is	O
special	O
about	O
circles	O
that	O
they	O
only	O
intersect	O
in	O
two	O
points	O
.	O
the	O
answer	O
to	O
this	O
question	O
is	O
of	O
course	O
that	O
there	O
exist	O
two	O
other	O
solutions	O
,	O
the	O
two	O
circles	O
meeting	O
in	O
two	O
other	O
complex	O
points	O
.	O
we	O
do	O
not	O
have	O
to	O
look	O
very	O
far	O
to	O
ﬁnd	O
these	O
two	O
points	O
.	O
the	O
equation	O
for	O
a	O
circle	O
in	O
homogeneous	O
coordinates	B
(	O
x	O
,	O
y	O
,	O
w	O
)	O
is	O
of	O
the	O
form	O
(	O
x	O
−	O
aw	O
)	O
2	O
+	O
(	O
y	O
−	O
bw	O
)	O
2	O
=	O
r2w2	O
this	O
represents	O
the	O
circle	O
with	O
centre	O
represented	O
in	O
homogeneous	O
coordinates	B
as	O
(	O
x0	O
,	O
y0	O
,	O
w0	O
)	O
t	O
=	O
(	O
a	O
,	O
b	O
,	O
1	O
)	O
t.	O
it	O
is	O
quickly	O
veriﬁed	O
that	O
the	O
points	O
(	O
x	O
,	O
y	O
,	O
w	O
)	O
t	O
=	O
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
t	O
lie	O
on	O
every	O
such	O
circle	O
.	O
to	O
repeat	O
this	O
interesting	O
fact	O
,	O
every	O
circle	O
passes	O
through	O
the	O
points	O
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
t	O
,	O
and	O
therefore	O
they	O
lie	O
in	O
the	O
intersection	B
of	O
any	O
two	O
circles	O
.	O
since	O
their	O
ﬁnal	O
coordinate	O
is	O
zero	O
,	O
these	O
two	O
points	O
lie	O
on	O
the	O
line	B
at	I
inﬁnity	I
.	O
for	O
obvious	O
reasons	O
,	O
they	O
are	O
called	O
the	O
circular	B
points	I
of	O
the	O
plane	B
.	O
note	O
that	O
although	O
the	O
two	O
circular	O
points	O
are	O
complex	O
,	O
they	O
satisfy	O
a	O
pair	O
of	O
real	O
equations	O
:	O
x2	O
+	O
y2	O
=	O
0	O
;	O
w	O
=	O
0.	O
this	O
observation	O
gives	O
the	O
clue	O
of	O
how	O
we	O
may	O
deﬁne	O
euclidean	B
geometry	I
.	O
euclidean	B
geometry	I
arises	O
from	O
projective	O
geometry	O
by	O
singling	O
out	O
ﬁrst	O
a	O
line	B
at	I
inﬁnity	I
and	O
subsequently	O
,	O
two	O
points	O
called	O
circular	B
points	I
lying	O
on	O
this	O
line	B
.	O
of	O
course	O
the	O
circular	B
points	I
are	O
complex	O
points	O
,	O
but	O
for	O
the	O
most	O
part	O
we	O
do	O
not	O
worry	O
too	O
much	O
about	O
this	O
.	O
now	O
,	O
we	O
may	O
deﬁne	O
a	O
circle	O
as	O
being	O
any	O
conic	B
(	O
a	O
curve	O
deﬁned	O
by	O
a	O
second-	O
degree	O
equation	O
)	O
that	O
passes	O
through	O
the	O
two	O
circular	O
points	O
.	O
note	O
that	O
in	O
the	O
standard	O
euclidean	O
coordinate	O
system	O
,	O
the	O
circular	B
points	I
have	O
the	O
coordinates	B
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
t.	O
in	O
assigning	O
a	O
euclidean	O
structure	O
to	O
a	O
projective	B
plane	I
,	O
however	O
,	O
we	O
may	O
designate	O
any	O
line	B
and	O
any	O
two	O
(	O
complex	O
)	O
points	O
on	O
that	O
line	B
as	O
being	O
the	O
line	B
at	I
inﬁnity	I
and	O
the	O
circular	B
points	I
.	O
as	O
an	O
example	O
of	O
applying	O
this	O
viewpoint	O
,	O
we	O
note	O
that	O
a	O
general	O
conic	O
may	O
be	O
found	O
passing	O
through	O
ﬁve	O
arbitrary	O
points	O
in	O
the	O
plane	B
,	O
as	O
may	O
be	O
seen	O
by	O
counting	O
the	O
number	O
of	O
coefﬁcients	O
of	O
a	O
general	O
quadratic	O
equation	O
ax2	O
+	O
by2	O
+	O
.	O
.	O
.	O
+	O
f	O
w2	O
=	O
0.	O
a	O
circle	O
on	O
the	O
other	O
hand	O
is	O
deﬁned	O
by	O
only	O
three	O
points	O
.	O
another	O
way	O
of	O
looking	O
at	O
this	O
is	O
that	O
it	O
is	O
a	O
conic	B
passing	O
through	O
two	O
special	O
points	O
,	O
the	O
circular	B
points	I
,	O
as	O
well	O
as	O
three	O
other	O
points	O
,	O
and	O
hence	O
as	O
any	O
other	O
conic	B
,	O
it	O
requires	O
ﬁve	O
points	O
to	O
specify	O
it	O
uniquely	O
.	O
it	O
should	O
not	O
be	O
a	O
surprise	O
that	O
as	O
a	O
result	O
of	O
singling	O
out	O
two	O
circular	O
points	O
one	O
6	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
obtains	O
the	O
whole	O
of	O
the	O
familiar	O
euclidean	B
geometry	I
.	O
in	O
particular	O
,	O
concepts	O
such	O
as	O
angle	O
and	O
length	O
ratios	O
may	O
be	O
deﬁned	O
in	O
terms	O
of	O
the	O
circular	O
points	O
.	O
however	O
,	O
these	O
concepts	O
are	O
most	O
easily	O
deﬁned	O
in	O
terms	O
of	O
some	O
coordinate	O
system	O
for	O
the	O
euclidean	O
plane	O
,	O
as	O
will	O
be	O
seen	O
in	O
later	O
chapters	O
.	O
3d	O
euclidean	B
geometry	I
.	O
we	O
saw	O
how	O
the	O
euclidean	O
plane	O
is	O
deﬁned	O
in	O
terms	O
of	O
the	O
projective	O
plane	B
by	O
specifying	O
a	O
line	B
at	I
inﬁnity	I
and	O
a	O
pair	O
of	B
circular	I
points	I
.	O
the	O
same	O
idea	O
may	O
be	O
applied	O
to	O
3d	O
geometry	O
.	O
as	O
in	O
the	O
two-dimensional	B
case	O
,	O
one	O
may	O
look	O
carefully	O
at	O
spheres	O
,	O
and	O
how	O
they	O
intersect	O
.	O
two	O
spheres	O
intersect	O
in	O
a	O
circle	O
,	O
and	O
not	O
in	O
a	O
general	O
fourth-degree	O
curve	O
,	O
as	O
the	O
algebra	O
suggests	O
,	O
and	O
as	O
two	O
general	O
ellipsoids	O
(	O
or	O
other	O
quadric	O
surfaces	O
)	O
do	O
.	O
this	O
line	B
of	O
thought	O
leads	O
to	O
the	O
discovery	O
that	O
in	O
homogeneous	O
coordinates	B
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
all	O
spheres	O
intersect	O
the	O
plane	O
at	O
inﬁnity	O
in	O
a	O
curve	O
with	O
the	O
equations	O
:	O
x2	O
+	O
y2	O
+	O
z2	O
=	O
0	O
;	O
t	O
=	O
0.	O
this	O
is	O
a	O
second-degree	O
curve	O
(	O
a	O
conic	B
)	O
lying	O
on	O
the	O
plane	O
at	O
inﬁnity	O
,	O
and	O
consisting	O
only	O
of	O
complex	O
points	O
.	O
it	O
is	O
known	O
as	O
the	O
absolute	O
conic	O
and	O
is	O
one	O
of	O
the	O
key	O
geometric	B
entities	O
in	O
this	O
book	O
,	O
most	O
particularly	O
because	O
of	O
its	O
connection	O
to	O
camera	O
calibration	B
,	O
as	O
will	O
be	O
seen	O
later	O
.	O
the	O
absolute	O
conic	O
is	O
deﬁned	O
by	O
the	O
above	O
equations	O
only	O
in	O
the	O
euclidean	O
coor-	O
dinate	O
system	O
.	O
in	O
general	O
we	O
may	O
consider	O
3d	O
euclidean	O
space	O
to	O
be	O
derived	O
from	O
projective	O
space	O
by	O
singling	O
out	O
a	O
particular	O
plane	B
as	O
the	O
plane	O
at	O
inﬁnity	O
and	O
specify-	O
ing	O
a	O
particular	O
conic	B
lying	O
in	O
this	O
plane	B
to	O
be	O
the	O
absolute	O
conic	O
.	O
these	O
entities	O
may	O
have	O
quite	O
general	O
descriptions	O
in	O
terms	O
of	O
a	O
coordinate	O
system	O
for	O
the	O
projective	B
space	O
.	O
we	O
will	O
not	O
here	O
go	O
into	O
details	O
of	O
how	O
the	O
absolute	O
conic	O
determines	O
the	O
complete	O
euclidean	O
3d	O
geometry	O
.	O
a	O
single	O
example	O
will	O
serve	O
.	O
perpendicularity	O
of	B
lines	I
in	O
space	O
is	O
not	O
a	O
valid	O
concept	O
in	O
afﬁne	O
geometry	O
,	O
but	O
belongs	O
to	O
euclidean	O
geometry	O
.	O
the	O
perpendicularity	O
of	B
lines	I
may	O
be	O
deﬁned	O
in	O
terms	O
of	O
the	O
absolute	O
conic	B
,	O
as	O
follows	O
.	O
by	O
extending	O
the	O
lines	O
until	O
they	O
meet	O
the	O
plane	O
at	O
inﬁnity	O
,	O
we	O
obtain	O
two	O
points	O
called	O
the	O
directions	O
of	O
the	O
two	O
lines	B
.	O
perpendicularity	O
of	O
the	O
lines	O
is	O
deﬁned	O
in	O
terms	O
of	O
the	O
relationship	O
of	O
the	O
two	O
directions	O
to	O
the	O
absolute	O
conic	O
.	O
the	O
lines	B
are	O
perpendicular	O
if	O
the	O
two	O
directions	O
are	O
conjugate	O
points	O
with	O
respect	O
to	O
the	O
absolute	O
conic	O
(	O
see	O
ﬁgure	O
3.8	O
(	O
p83	O
)	O
)	O
.	O
the	O
geometry	O
and	O
algebraic	B
representation	O
of	O
conjugate	O
points	O
are	O
deﬁned	O
in	O
section	O
2.8.1	O
(	O
p58	O
)	O
.	O
brieﬂy	O
,	O
if	O
the	O
absolute	O
conic	O
is	O
represented	O
by	O
a	O
3×	O
3	O
symmetric	B
matrix	O
ω∞	O
,	O
and	O
the	O
directions	O
are	O
the	O
points	O
d1	O
and	O
d2	O
,	O
then	O
they	O
are	O
conjugate	O
with	O
respect	O
to	O
ω∞	O
if	O
dt	O
ω∞d2	O
=	O
0.	O
more	O
generally	O
,	O
angles	O
may	O
be	O
deﬁned	O
in	O
terms	O
of	O
the	O
1	O
absolute	O
conic	O
in	O
any	O
arbitrary	O
coordinate	O
system	O
,	O
as	O
expressed	O
by	O
(	O
3.23–p82	O
)	O
.	O
1.2	O
camera	B
projections	O
one	O
of	O
the	O
principal	O
topics	O
of	O
this	O
book	O
is	O
the	O
process	O
of	O
image	O
formation	O
,	O
namely	O
the	O
formation	O
of	O
a	O
two-dimensional	O
representation	B
of	O
a	O
three-dimensional	O
world	O
,	O
and	O
what	O
we	O
may	O
deduce	O
about	O
the	O
3d	O
structure	B
of	O
what	O
appears	O
in	O
the	O
images	O
.	O
the	O
drop	O
from	O
three-dimensional	O
world	O
to	O
a	O
two-dimensional	B
image	O
is	O
a	O
projection	B
process	O
in	O
which	O
we	O
lose	O
one	O
dimension	O
.	O
the	O
usual	O
way	O
of	O
modelling	O
this	O
process	O
is	O
by	O
central	B
projection	I
in	O
which	O
a	O
ray	O
from	O
a	O
point	B
in	O
space	O
is	O
drawn	O
from	O
a	O
3d	O
world	O
point	B
through	O
a	O
ﬁxed	O
point	O
in	O
space	O
,	O
the	O
centre	B
of	O
projection	B
.	O
this	O
ray	O
will	O
intersect	O
a	O
speciﬁc	O
plane	B
in	O
space	O
chosen	O
as	O
the	O
image	B
plane	I
.	O
the	O
intersection	B
of	O
the	O
ray	O
with	O
the	O
1.2	O
camera	B
projections	O
7	O
image	B
plane	I
represents	O
the	O
image	O
of	O
the	O
point	O
.	O
if	O
the	O
3d	O
structure	B
lies	O
on	O
a	O
plane	O
then	O
there	O
is	O
no	O
drop	O
in	O
dimension	O
.	O
this	O
model	B
is	O
in	O
accord	O
with	O
a	O
simple	O
model	O
of	O
a	O
camera	O
,	O
in	O
which	O
a	O
ray	O
of	O
light	O
from	O
a	O
point	B
in	O
the	O
world	O
passes	O
through	O
the	O
lens	O
of	O
a	O
camera	O
and	O
impinges	O
on	O
a	O
ﬁlm	O
or	O
digital	O
device	O
,	O
producing	O
an	O
image	O
of	O
the	O
point	O
.	O
ignoring	O
such	O
effects	O
as	O
focus	O
and	O
lens	O
thickness	O
,	O
a	O
reasonable	O
approximation	O
is	O
that	O
all	O
the	O
rays	O
pass	O
through	O
a	O
single	O
point	O
,	O
the	O
centre	B
of	O
the	O
lens	O
.	O
in	O
applying	O
projective	B
geometry	O
to	O
the	O
imaging	O
process	O
,	O
it	O
is	O
customary	O
to	O
model	O
the	O
world	O
as	O
a	O
3d	O
projective	B
space	O
,	O
equal	O
to	O
ir3	O
along	O
with	O
points	O
at	O
inﬁnity	O
.	O
similarly	O
the	O
model	B
for	O
the	O
image	O
is	O
the	O
2d	O
projective	B
plane	I
ip2	O
.	O
central	B
projection	I
is	O
simply	O
a	O
map	O
from	O
ip3	O
to	O
ip2	O
.	O
if	O
we	O
consider	O
points	O
in	O
ip3	O
written	O
in	O
terms	O
of	O
homogeneous	O
coordinates	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
and	O
let	O
the	O
centre	B
of	O
projection	B
be	O
the	O
origin	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
then	O
we	O
see	O
that	O
the	O
set	O
of	O
all	O
points	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
for	O
ﬁxed	O
x	O
,	O
y	O
and	O
z	O
,	O
but	O
varying	O
t	O
form	O
a	O
single	O
ray	O
passing	O
through	O
the	O
point	B
centre	O
of	O
projection	O
,	O
and	O
hence	O
all	O
mapping	O
to	O
the	O
same	O
point	O
.	O
thus	O
,	O
the	O
ﬁnal	O
coordinate	O
of	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
is	O
irrelevant	O
to	O
where	O
the	O
point	B
is	O
imaged	O
.	O
in	O
fact	O
,	O
the	O
image	O
point	O
is	O
the	O
point	B
in	O
ip2	O
with	O
homogeneous	O
coordinates	B
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t.	O
thus	O
,	O
the	O
mapping	O
may	O
be	O
represented	O
by	O
a	O
mapping	O
of	O
3d	O
homogeneous	O
coordinates	O
,	O
represented	O
by	O
a	O
3	O
×	O
4	O
matrix	B
p	O
with	O
the	O
block	O
structure	B
p	O
=	O
[	O
i3×3|03	O
]	O
,	O
where	O
i3×3	O
is	O
the	O
3	O
×	O
3	O
identity	O
matrix	B
and	O
03	O
a	O
zero	O
3-vector	O
.	O
making	O
allowance	O
for	O
a	O
different	O
centre	B
of	O
projection	B
,	O
and	O
a	O
different	O
projective	B
coordinate	O
frame	O
in	O
the	O
image	O
,	O
it	O
turns	O
out	O
that	O
the	O
most	O
general	O
imaging	O
projection	B
is	O
represented	O
by	O
an	O
arbitrary	O
3×	O
4	O
matrix	B
of	O
rank	O
3	O
,	O
acting	O
on	O
the	O
homogeneous	O
coordinates	O
of	O
the	O
point	O
in	O
ip3	O
mapping	O
it	O
to	O
the	O
imaged	O
point	B
in	O
ip2	O
.	O
this	O
matrix	B
p	O
is	O
known	O
as	O
the	O
camera	B
matrix	I
.	O
in	O
summary	O
,	O
the	O
action	O
of	O
a	O
projective	B
camera	I
on	O
a	O
point	B
in	O
space	O
may	O
be	O
expressed	O
in	O
terms	O
of	O
a	O
linear	O
mapping	O
of	O
homogeneous	O
coordinates	O
as	O
	O
x	O
y	O
w	O
y	O
w	O
	O
=	O
p3×4	O
	O
=	O
h3×3	O
	O
	O
y	O
z	O
t	O
	O
x	O
	O
x	O
y	O
t	O
furthermore	O
,	O
if	O
all	O
the	O
points	O
lie	O
on	O
a	O
plane	O
(	O
we	O
may	O
choose	O
this	O
as	O
the	O
plane	B
z	O
=	O
0	O
)	O
then	O
the	O
linear	B
mapping	O
reduces	O
to	O
x	O
which	O
is	O
a	O
projective	B
transformation	I
.	O
cameras	B
as	O
points	O
.	O
in	O
a	O
central	B
projection	I
,	O
points	O
in	O
ip3	O
are	O
mapped	O
to	O
points	O
in	O
ip2	O
,	O
all	O
points	O
in	O
a	O
ray	O
passing	O
through	O
the	O
centre	B
of	O
projection	B
projecting	O
to	O
the	O
same	O
point	O
in	O
an	O
image	O
.	O
for	O
the	O
purposes	O
of	O
image	O
projection	B
,	O
it	O
is	O
possible	O
to	O
consider	O
all	O
points	O
along	O
such	O
a	O
ray	O
as	O
being	O
equal	O
.	O
we	O
can	O
go	O
one	O
step	O
further	O
,	O
and	O
think	O
of	O
the	O
ray	O
through	O
the	O
projection	B
centre	O
as	O
representing	O
the	O
image	O
point	O
.	O
thus	O
,	O
the	O
set	O
of	O
all	O
image	O
points	O
is	O
the	O
same	O
as	O
the	O
set	O
of	O
rays	O
through	O
the	O
camera	B
centre	I
.	O
if	O
we	O
represent	O
8	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
x	O
3	O
image	B
plane	I
x	O
2	O
x	O
1	O
x	O
4	O
c	O
x	O
1	O
x	O
2	O
x	O
3	O
x4	O
/	O
x3	O
x	O
3	O
x	O
/	O
2	O
/	O
x1	O
x	O
2	O
x	O
1	O
x	O
3	O
x	O
4	O
x	O
2	O
x	O
1	O
c	O
x	O
3	O
x4	O
x	O
3	O
x	O
4	O
x	O
2	O
x	O
1	O
a	O
x	O
4	O
c	O
c	O
x	O
3	O
x4	O
c	O
x3	O
x4	O
x	O
/	O
4	O
x	O
/	O
3	O
π	O
x	O
/	O
1	O
/	O
x2	O
/	O
c	O
x1	O
x	O
1	O
x	O
2	O
x	O
3	O
x	O
4	O
x	O
2	O
x	O
1	O
c	O
x3	O
x4	O
x2	O
e	O
x1	O
π	O
x	O
/	O
2	O
x	O
/	O
3	O
x	O
/	O
4	O
x	O
/	O
1	O
/	O
c	O
x1	O
x2	O
b	O
x2	O
d	O
fig	O
.	O
1.1.	O
the	O
camera	B
centre	I
is	O
the	O
essence	O
.	O
(	O
a	O
)	O
image	O
formation	O
:	O
the	O
image	O
points	O
xi	O
are	O
the	O
inter-	O
section	O
of	O
a	O
plane	O
with	O
rays	O
from	O
the	O
space	O
points	O
xi	O
through	O
the	O
camera	B
centre	I
c.	O
(	O
b	O
)	O
if	O
the	O
space	O
points	O
are	O
coplanar	O
then	O
there	O
is	O
a	O
projective	B
transformation	I
between	O
the	O
world	O
and	O
image	O
planes	O
,	O
xi	O
=	O
h3×3xi	O
.	O
(	O
c	O
)	O
all	O
images	O
with	O
the	O
same	O
camera	O
centre	O
are	O
related	O
by	O
a	O
projective	B
transformation	I
,	O
x	O
(	O
cid:1	O
)	O
i	O
=	O
h	O
(	O
cid:1	O
)	O
3×3xi	O
.	O
compare	O
(	O
b	O
)	O
and	O
(	O
c	O
)	O
–	O
in	O
both	O
cases	O
planes	O
are	O
mapped	O
to	O
one	O
another	O
by	O
rays	O
through	O
a	O
centre	B
.	O
in	O
(	O
b	O
)	O
the	O
mapping	O
is	O
between	O
a	O
scene	O
and	O
image	B
plane	I
,	O
in	O
(	O
c	O
)	O
between	O
two	O
image	O
planes	O
.	O
(	O
d	O
)	O
if	O
the	O
camera	B
centre	I
moves	O
,	O
then	O
the	O
images	O
are	O
in	O
general	O
not	O
related	O
by	O
a	O
projective	B
transformation	I
,	O
unless	O
(	O
e	O
)	O
all	O
the	O
space	O
points	O
are	O
coplanar	O
.	O
the	O
ray	O
from	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
through	O
the	O
point	B
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
by	O
its	O
ﬁrst	O
three	O
coordinates	B
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
,	O
it	O
is	O
easily	O
seen	O
that	O
for	O
any	O
constant	O
k	O
,	O
the	O
ray	O
k	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
represents	O
the	O
same	O
ray	O
.	O
thus	O
the	O
rays	O
themselves	O
are	O
represented	O
by	O
homogeneous	O
coordinates	O
.	O
in	O
1.2	O
camera	B
projections	O
9	O
fact	O
they	O
make	O
up	O
a	O
2-dimensional	O
space	O
of	O
rays	O
.	O
the	O
set	O
of	O
rays	O
themselves	O
may	O
be	O
thought	O
of	O
as	O
a	O
representation	B
of	O
the	O
image	O
space	O
ip2	O
.	O
in	O
this	O
representation	B
of	O
the	O
image	O
,	O
all	O
that	O
is	O
important	O
is	O
the	O
camera	B
centre	I
,	O
for	O
this	O
alone	O
determines	O
the	O
set	O
of	O
rays	O
forming	O
the	O
image	O
.	O
different	O
camera	B
matrices	I
representing	O
the	O
image	O
formation	O
from	O
the	O
same	O
centre	O
of	O
projection	O
reﬂect	O
only	O
different	O
coordinate	O
frames	O
for	O
the	O
set	O
of	O
rays	O
forming	O
the	O
image	O
.	O
thus	O
two	O
images	O
taken	O
from	O
the	O
same	O
point	O
in	O
space	O
are	O
projectively	O
equivalent	B
.	O
it	O
is	O
only	O
when	O
we	O
start	O
to	O
measure	O
points	O
in	O
an	O
image	O
,	O
that	O
a	O
particular	O
coordinate	O
frame	O
for	O
the	O
image	O
needs	O
to	O
be	O
speciﬁed	O
.	O
only	O
then	O
does	O
it	O
become	O
necessary	O
to	O
specify	O
a	O
particular	O
camera	B
matrix	I
.	O
in	O
short	O
,	O
modulo	O
ﬁeld-of-	O
view	O
which	O
we	O
ignore	O
for	O
now	O
,	O
all	O
images	O
acquired	O
with	O
the	O
same	O
camera	O
centre	O
are	O
equivalent	B
–	O
they	O
can	O
be	O
mapped	O
onto	O
each	O
other	O
by	O
a	O
projective	B
transformation	I
without	O
any	O
information	O
about	O
the	O
3d	O
points	O
or	O
position	O
of	O
the	O
camera	O
centre	B
.	O
these	O
issues	O
are	O
illustrated	O
in	O
ﬁgure	O
1.1.	O
calibrated	B
cameras	O
.	O
to	O
understand	O
fully	O
the	O
euclidean	O
relationship	O
between	O
the	O
im-	O
age	O
and	O
the	O
world	O
,	O
it	O
is	O
necessary	O
to	O
express	O
their	O
relative	O
euclidean	B
geometry	I
.	O
as	O
we	O
have	O
seen	O
,	O
the	O
euclidean	B
geometry	I
of	O
the	O
3d	O
world	O
is	O
determined	O
by	O
specifying	O
a	O
particular	O
plane	B
in	O
ip3	O
as	O
being	O
the	O
plane	O
at	O
inﬁnity	O
,	O
and	O
a	O
speciﬁc	O
conic	B
ω	O
in	O
that	O
plane	B
as	O
being	O
the	O
absolute	O
conic	O
.	O
for	O
a	O
camera	O
not	O
located	O
on	O
the	O
plane	O
at	O
inﬁnity	O
,	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
world	O
maps	O
one-to-one	O
onto	O
the	O
image	B
plane	I
.	O
this	O
is	O
because	O
any	O
point	B
in	O
the	O
image	O
deﬁnes	O
a	O
ray	O
in	O
space	O
that	O
meets	O
the	O
plane	O
at	O
inﬁnity	O
in	O
a	O
single	O
point	O
.	O
thus	O
,	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
world	O
does	O
not	O
tell	O
us	O
anything	O
new	O
about	O
the	O
image	O
.	O
the	O
absolute	O
conic	O
,	O
however	O
being	O
a	O
conic	B
in	O
the	O
plane	O
at	O
inﬁnity	O
must	O
project	O
to	O
a	O
conic	B
in	O
the	O
image	O
.	O
the	O
resulting	O
image	O
curve	O
is	O
called	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
or	O
iac	O
.	O
if	O
the	O
location	O
of	O
the	O
iac	O
is	O
known	O
in	O
an	O
image	O
,	O
then	O
we	O
say	O
that	O
the	O
camera	B
is	O
calibrated	B
.	O
in	O
a	O
calibrated	B
camera	O
,	O
it	O
is	O
possible	O
to	O
determine	O
the	O
angle	B
between	O
the	O
two	O
rays	O
back-projected	O
from	O
two	O
points	O
in	O
the	O
image	O
.	O
we	O
have	O
seen	O
that	O
the	O
angle	B
between	O
two	O
lines	O
in	O
space	O
is	O
determined	O
by	O
where	O
they	O
meet	O
the	O
plane	O
at	O
inﬁnity	O
,	O
relative	O
to	O
the	O
absolute	O
conic	O
.	O
in	O
a	O
calibrated	B
camera	O
,	O
the	O
plane	O
at	O
inﬁnity	O
and	O
the	O
absolute	O
conic	O
ω∞	O
are	O
projected	O
one-to-one	O
onto	O
the	O
image	B
plane	I
and	O
the	O
iac	O
,	O
denoted	O
ω.	O
the	O
projective	B
relationship	O
between	O
the	O
two	O
image	O
points	O
and	O
ω	O
is	O
exactly	O
equal	O
to	O
the	O
relationship	O
between	O
the	O
intersections	O
of	O
the	O
back-projected	O
rays	O
with	O
the	O
plane	O
at	O
inﬁnity	O
,	O
and	O
ω∞	O
.	O
consequently	O
,	O
knowing	O
the	O
iac	O
,	O
one	O
can	O
measure	O
the	O
angle	B
between	O
rays	O
by	O
direct	O
measurements	O
in	O
the	O
image	O
.	O
thus	O
,	O
for	O
a	O
calibrated	O
camera	B
,	O
one	O
can	O
measure	O
angles	O
between	O
rays	O
,	O
compute	O
the	O
ﬁeld	O
of	O
view	O
represented	O
by	O
an	O
image	O
patch	O
or	O
determine	O
whether	O
an	O
ellipse	O
in	O
the	O
image	O
back-projects	O
to	O
a	O
circular	O
cone	O
.	O
later	O
on	O
,	O
we	O
will	O
see	O
that	O
it	O
helps	O
us	O
to	O
determine	O
the	O
euclidean	O
structure	O
of	O
a	O
reconstructed	O
scene	O
.	O
example	O
1.1	O
.	O
3d	O
reconstructions	O
from	O
paintings	O
using	O
techniques	O
of	O
projective	O
geometry	O
,	O
it	O
is	O
possible	O
in	O
many	O
instances	O
to	O
reconstruct	O
scenes	O
from	O
a	O
single	O
image	O
.	O
this	O
can	O
not	O
be	O
done	O
without	O
some	O
assumptions	O
being	O
made	O
about	O
the	O
imaged	O
scene	O
.	O
typical	O
techniques	O
involve	O
the	O
analysis	O
of	O
features	O
such	O
as	O
parallel	O
lines	B
and	O
vanishing	B
points	I
to	O
determine	O
the	O
afﬁne	B
structure	O
of	O
the	O
scene	O
,	O
for	O
10	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
a	O
c	O
b	O
d	O
fig	O
.	O
1.2.	O
single	B
view	I
reconstruction	O
.	O
(	O
a	O
)	O
original	O
painting	O
–	O
st.	O
jerome	O
in	O
his	O
study	O
,	O
1630	O
,	O
hendrick	O
van	O
steenwijck	O
(	O
1580-1649	O
)	O
,	O
joseph	O
r.	O
ritman	O
private	O
collection	O
,	O
amsterdam	O
,	O
the	O
netherlands	O
.	O
(	O
b	O
)	O
(	O
c	O
)	O
(	O
d	O
)	O
views	O
of	O
the	O
3d	O
model	B
created	O
from	O
the	O
painting	O
.	O
figures	O
courtesy	O
of	O
antonio	O
criminisi	O
.	O
example	O
by	O
determining	O
the	O
line	O
at	B
inﬁnity	I
for	O
observed	O
planes	O
in	O
the	O
image	O
.	O
knowl-	O
edge	O
(	O
or	O
assumptions	O
)	O
about	O
angles	O
observed	O
in	O
the	O
scene	O
,	O
most	O
particularly	O
orthogonal	B
lines	O
or	O
planes	O
,	O
can	O
be	O
used	O
to	O
upgrade	O
the	O
afﬁne	B
reconstruction	I
to	O
euclidean	O
.	O
it	O
is	O
not	O
yet	O
possible	O
for	O
such	O
techniques	O
to	O
be	O
fully	O
automatic	O
.	O
however	O
,	O
projective	B
geometric	O
knowledge	O
may	O
be	O
built	O
into	O
a	O
system	O
that	O
allows	O
user-guided	O
single-view	O
reconstruction	B
of	O
the	O
scene	O
.	O
such	O
techniques	O
have	O
been	O
used	O
to	O
reconstruct	O
3d	O
texture	O
mapped	O
graphical	O
models	O
derived	O
from	O
old-master	O
paintings	O
.	O
starting	O
in	O
the	O
renaissance	O
,	O
paintings	O
with	O
ex-	O
tremely	O
accurate	O
perspective	O
were	O
produced	O
.	O
in	O
ﬁgure	O
1.2	O
a	O
reconstruction	B
carried	O
out	O
(	O
cid:2	O
)	O
from	O
such	O
a	O
painting	O
is	O
shown	O
.	O
1.3	O
reconstruction	B
from	O
more	O
than	O
one	O
view	O
we	O
now	O
turn	O
to	O
one	O
of	O
the	O
major	O
topics	O
in	O
the	O
book	O
–	O
that	O
of	O
reconstructing	O
a	O
scene	O
from	O
several	O
images	O
.	O
the	O
simplest	O
case	O
is	O
that	O
of	O
two	O
images	O
,	O
which	O
we	O
will	O
consider	O
ﬁrst	O
.	O
as	O
a	O
mathematical	O
abstraction	O
,	O
we	O
restrict	O
the	O
discussion	O
to	O
“	O
scenes	O
”	O
consisting	O
of	B
points	I
only	O
.	O
the	O
usual	O
input	O
to	O
many	O
of	O
the	O
algorithms	O
given	O
in	O
this	O
book	O
is	O
a	O
set	O
of	O
point	O
cor-	O
respondences	O
.	O
in	O
the	O
two-view	O
case	O
,	O
therefore	O
,	O
we	O
consider	O
a	O
set	O
of	O
correspondences	O
1.3	O
reconstruction	B
from	O
more	O
than	O
one	O
view	O
11	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
in	O
two	O
images	O
.	O
it	O
is	O
assumed	O
that	O
there	O
exist	O
some	O
camera	B
matrices	I
,	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
and	O
a	O
set	O
of	O
3d	O
points	O
xi	O
that	O
give	O
rise	O
to	O
these	O
image	O
correspondences	O
in	O
the	O
sense	O
that	O
pxi	O
=	O
xi	O
and	O
p	O
(	O
cid:2	O
)	O
xi	O
=	O
x	O
(	O
cid:2	O
)	O
i.	O
thus	O
,	O
the	O
point	B
xi	O
projects	O
to	O
the	O
two	O
given	O
data	O
points	O
.	O
however	O
,	O
neither	O
the	O
cameras	B
(	O
represented	O
by	O
projection	B
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
)	O
,	O
nor	O
the	O
points	O
xi	O
are	O
known	O
.	O
it	O
is	O
our	O
task	O
to	O
determine	O
them	O
.	O
it	O
is	O
clear	O
from	O
the	O
outset	O
that	O
it	O
is	O
impossible	O
to	O
determine	O
the	O
positions	O
of	O
the	O
points	O
uniquely	O
.	O
this	O
is	O
a	O
general	O
ambiguity	O
that	O
holds	O
however	O
many	O
images	O
we	O
are	O
given	O
,	O
and	O
even	O
if	O
we	O
have	O
more	O
than	O
just	O
point	B
correspondence	O
data	O
.	O
for	O
instance	O
,	O
given	O
several	O
images	O
of	O
a	O
cube	O
,	O
it	O
is	O
impossible	O
to	O
tell	O
its	O
absolute	O
position	O
(	O
is	O
it	O
located	O
in	O
a	O
night-club	O
in	O
addis	O
ababa	O
,	O
or	O
the	O
british	O
museum	O
)	O
,	O
its	O
orientation	B
(	O
which	O
face	O
is	O
facing	O
north	O
)	O
or	O
its	O
scale	O
.	O
we	O
express	O
this	O
by	O
saying	O
that	O
the	O
reconstruction	B
is	O
possible	O
at	O
best	O
up	O
to	O
a	O
similarity	B
transformation	I
of	O
the	O
world	O
.	O
however	O
,	O
it	O
turns	O
out	O
that	O
unless	O
something	O
is	O
known	O
about	O
the	O
calibration	B
of	O
the	O
two	O
cameras	O
,	O
the	O
ambiguity	B
in	O
the	O
reconstruction	B
is	O
expressed	O
by	O
a	O
more	O
general	O
class	O
of	O
transformations	O
–	O
projective	B
transformations	O
.	O
this	O
ambiguity	B
arises	O
because	O
it	O
is	O
possible	O
to	O
apply	O
a	O
projective	B
transformation	I
(	O
rep-	O
resented	O
by	O
a	O
4	O
×	O
4	O
matrix	B
h	O
)	O
to	O
each	O
point	B
xi	O
,	O
and	O
on	O
the	O
right	O
of	O
each	O
camera	B
matrix	I
pj	O
,	O
without	O
changing	O
the	O
projected	O
image	O
points	O
,	O
thus	O
:	O
pjxi	O
=	O
(	O
pjh−1	O
)	O
(	O
hxi	O
)	O
.	O
(	O
1.1	O
)	O
there	O
is	O
no	O
compelling	O
reason	O
to	O
choose	O
one	O
set	O
of	B
points	I
and	O
camera	B
matrices	I
over	O
the	O
other	O
.	O
the	O
choice	B
of	O
h	O
is	O
essentially	O
arbitrary	O
,	O
and	O
we	O
say	O
that	O
the	O
reconstruction	B
has	O
a	O
projective	B
ambiguity	I
,	O
or	O
is	O
a	O
projective	B
reconstruction	I
.	O
however	O
,	O
the	O
good	O
news	O
is	O
that	O
this	O
is	O
the	O
worst	O
that	O
can	O
happen	O
.	O
it	O
is	O
possible	O
to	O
reconstruct	O
a	O
set	O
of	B
points	I
from	O
two	B
views	I
,	O
up	O
to	O
an	O
unavoidable	O
projective	B
ambiguity	I
.	O
well	O
,	O
to	O
be	O
able	O
to	O
say	O
this	O
,	O
we	O
need	O
to	O
make	O
a	O
few	O
qualiﬁcations	O
;	O
there	O
must	O
be	O
sufﬁ-	O
ciently	O
many	O
points	O
,	O
at	O
least	O
seven	O
,	O
and	O
they	O
must	O
not	O
lie	O
in	O
one	O
of	O
various	O
well-deﬁned	O
critical	B
conﬁgurations	I
.	O
the	O
basic	O
tool	O
in	O
the	O
reconstruction	B
of	O
point	B
sets	O
from	O
two	O
views	O
is	O
the	O
fundamental	B
matrix	I
,	O
which	O
represents	O
the	O
constraint	O
obeyed	O
by	O
image	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
if	O
they	O
are	O
to	O
be	O
images	O
of	O
the	O
same	O
3d	O
point	B
.	O
this	O
constraint	O
arises	O
from	O
the	O
coplanarity	O
of	O
the	O
camera	B
centres	O
of	O
the	O
two	O
views	O
,	O
the	O
images	O
points	O
and	O
the	O
space	O
point	O
.	O
given	O
the	O
fundamental	B
matrix	I
f	O
,	O
a	O
pair	O
of	O
matching	O
points	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
must	O
satisfy	O
x	O
(	O
cid:2	O
)	O
i	O
tfxi	O
=	O
0	O
where	O
f	O
is	O
a	O
3	O
×	O
3	O
matrix	B
of	O
rank	O
2.	O
these	O
equations	O
are	O
linear	B
in	O
the	O
entries	O
of	O
the	O
matrix	O
f	O
,	O
which	O
means	O
that	O
if	O
f	O
is	O
unknown	O
,	O
then	O
it	O
can	O
be	O
computed	O
from	O
a	O
set	O
of	O
point	O
correspondences	B
.	O
a	O
pair	O
of	B
camera	I
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
uniquely	O
determine	O
a	O
fundamental	B
matrix	I
f	O
,	O
and	O
conversely	O
,	O
the	O
fundamental	B
matrix	I
determines	O
the	O
pair	O
of	B
camera	I
matrices	O
,	O
up	O
to	O
a	O
3d	O
projective	B
ambiguity	I
.	O
thus	O
,	O
the	O
fundamental	B
matrix	I
encapsulates	O
the	O
complete	O
projec-	O
tive	O
geometry	O
of	O
the	O
pair	O
of	O
cameras	O
,	O
and	O
is	O
unchanged	O
by	O
projective	B
transformation	I
of	O
3d	O
.	O
12	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
the	O
fundamental-matrix	O
method	O
for	O
reconstructing	O
the	O
scene	O
is	O
very	O
simple	O
,	O
consist-	O
ing	O
of	O
the	O
following	O
steps	O
:	O
(	O
i	O
)	O
given	O
several	O
point	B
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
equations	O
in	O
the	O
entries	O
of	O
f	O
based	O
on	O
the	O
coplanarity	O
equations	O
x	O
(	O
cid:2	O
)	O
i	O
across	O
two	B
views	I
,	O
form	O
linear	O
tfxi	O
=	O
0.	O
i	O
(	O
ii	O
)	O
find	O
f	O
as	O
the	O
solution	B
to	O
a	O
set	O
of	O
linear	O
equations	O
.	O
(	O
iii	O
)	O
compute	O
a	O
pair	O
of	B
camera	I
matrices	O
from	O
f	O
according	O
to	O
the	O
simple	O
formula	O
given	O
in	O
section	O
9.5	O
(	O
p253	O
)	O
.	O
)	O
and	O
the	O
corresponding	O
image	O
point	O
pairs	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
iv	O
)	O
given	O
the	O
two	O
cameras	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
i	O
,	O
ﬁnd	O
the	O
3d	O
point	B
xi	O
that	O
projects	O
to	O
the	O
given	O
image	O
points	O
.	O
solving	O
for	O
x	O
in	O
this	O
way	O
is	O
known	O
as	O
triangulation	B
.	O
the	O
algorithm	B
given	O
here	O
is	O
an	O
outline	O
only	O
,	O
and	O
each	O
part	O
of	O
it	O
is	O
examined	O
in	O
de-	O
tail	O
in	O
this	O
book	O
.	O
the	O
algorithm	B
should	O
not	O
be	O
implemented	O
directly	O
from	O
this	O
brief	O
description	O
.	O
1.4	O
three-view	O
geometry	O
in	O
the	O
last	O
section	O
it	O
was	O
discussed	O
how	O
reconstruction	B
of	O
a	O
set	O
of	B
points	I
,	O
and	O
the	O
relative	O
placement	O
of	O
the	O
cameras	O
,	O
is	O
possible	O
from	O
two	O
views	O
of	O
a	O
set	O
of	B
points	I
.	O
the	O
reconstruc-	O
tion	O
is	O
possible	O
only	O
up	O
to	O
a	O
projective	B
transformation	I
of	O
space	O
,	O
and	O
the	O
corresponding	O
adjustment	O
to	O
the	O
camera	B
matrices	I
.	O
in	O
this	O
section	O
,	O
we	O
consider	O
the	O
case	O
of	O
three	O
views	O
.	O
whereas	O
for	O
two	O
views	O
,	O
the	O
basic	O
algebraic	O
entity	O
is	O
the	O
fundamental	B
matrix	I
,	O
for	B
three	I
views	I
this	O
role	O
is	O
played	O
by	O
the	O
trifocal	B
tensor	I
.	O
the	O
trifocal	B
tensor	I
is	O
a	O
3	O
×	O
3	O
×	O
3	O
array	O
of	O
numbers	O
that	O
relate	O
the	O
coordinates	B
of	O
corresponding	O
points	O
or	O
lines	B
in	O
three	O
views	O
.	O
just	O
as	O
the	O
fundamental	B
matrix	I
is	O
determined	O
by	O
the	O
two	O
camera	O
matrices	O
,	O
and	O
determines	O
them	O
up	O
to	O
projective	O
transformation	B
,	O
so	O
in	O
three	O
views	O
,	O
the	O
trifocal	B
tensor	I
is	O
determined	O
by	O
the	O
three	O
camera	B
matrices	I
,	O
and	O
in	O
turn	O
determines	O
them	O
,	O
again	O
up	O
to	O
projective	O
transformation	B
.	O
thus	O
,	O
the	O
trifocal	B
tensor	I
encapsulates	O
the	O
relative	O
projective	B
geometry	O
of	O
the	O
three	O
cameras	B
.	O
for	O
reasons	O
that	O
will	O
be	O
explained	O
in	O
chapter	O
15	O
it	O
is	O
usual	O
to	O
write	O
some	O
of	O
the	O
indices	O
of	O
a	O
tensor	O
as	O
lower	O
and	O
some	O
as	O
upper	O
indices	O
.	O
these	O
are	O
referred	O
to	O
as	O
the	O
covariant	O
and	O
contravariant	O
indices	O
.	O
the	O
trifocal	B
tensor	I
is	O
of	O
the	O
form	O
t	O
jk	O
,	O
having	O
two	O
upper	O
and	O
one	O
lower	O
index	O
.	O
the	O
most	O
basic	O
relationship	O
between	O
image	O
entities	O
in	O
three	O
views	O
concerns	O
a	O
corre-	O
spondence	O
between	O
two	O
lines	O
and	O
a	O
point	B
.	O
we	O
consider	O
a	O
correspondence	B
x	O
↔	O
l	O
(	O
cid:2	O
)	O
↔	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
between	O
a	O
point	B
x	O
in	B
one	I
image	I
and	O
two	O
lines	O
l	O
(	O
cid:2	O
)	O
in	O
the	O
other	O
two	O
images	O
.	O
this	O
relationship	O
means	O
that	O
there	O
is	O
a	O
point	B
x	O
in	O
space	O
that	O
maps	O
to	O
x	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
to	O
points	O
x	O
(	O
cid:2	O
)	O
in	O
the	O
other	O
two	O
images	O
.	O
the	O
coordinates	B
of	O
these	O
three	O
images	O
are	O
then	O
related	O
via	O
the	O
trifocal	O
tensor	B
relationship	O
:	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
lying	O
on	O
the	O
lines	B
l	O
(	O
cid:2	O
)	O
(	O
cid:7	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
t	O
jk	O
i	O
=	O
0	O
.	O
(	O
1.2	O
)	O
xil	O
this	O
relationship	O
gives	O
a	O
single	O
linear	O
relationship	O
between	O
the	O
elements	O
of	O
the	O
tensor	O
.	O
with	O
sufﬁciently	O
many	O
such	O
correspondences	B
,	O
it	O
is	O
possible	O
to	O
solve	O
linearly	O
for	O
the	O
ijk	O
1.5	O
four	O
view	O
geometry	O
and	O
n-view	O
reconstruction	B
13	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
in	O
fact	O
,	O
in	O
this	O
situation	O
,	O
one	O
can	O
choose	O
any	O
lines	B
l	O
(	O
cid:2	O
)	O
elements	O
of	O
the	O
tensor	O
.	O
fortunately	O
,	O
one	O
can	O
obtain	O
more	O
equations	O
from	O
a	O
point	B
corre-	O
spondence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
passing	O
through	O
the	O
points	O
x	O
(	O
cid:2	O
)	O
and	O
generate	O
a	O
relation	B
of	O
the	O
sort	O
(	O
1.2	O
)	O
.	O
since	O
it	O
is	O
possible	O
to	O
choose	O
two	O
independent	O
lines	B
passing	O
through	O
x	O
(	O
cid:2	O
)	O
,	O
and	O
two	O
others	O
passing	O
through	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
one	O
can	O
obtain	O
four	O
independent	O
equations	O
in	O
this	O
way	O
.	O
a	O
total	O
of	O
seven	O
point	B
correspondences	O
are	O
sufﬁcient	O
to	O
compute	O
the	O
trifocal	B
tensor	I
linearly	O
in	O
this	O
way	O
.	O
it	O
can	O
be	O
computed	O
from	O
a	O
minimum	O
of	O
six	O
point	B
correspondences	O
using	O
a	O
non-linear	B
method	O
.	O
the	O
27	O
elements	O
of	O
the	O
tensor	O
are	O
not	O
independent	O
,	O
however	O
,	O
but	O
are	O
related	O
by	O
a	O
set	O
of	O
so	O
called	O
internal	B
constraints	O
.	O
these	O
constraints	B
are	O
quite	O
complicated	O
,	O
but	O
tensors	O
satisfying	O
the	O
constraints	B
can	O
be	O
computed	O
in	O
various	O
ways	O
,	O
for	O
instance	O
by	O
using	O
the	O
6	O
point	B
non-linear	O
method	O
.	O
the	O
fundamental	B
matrix	I
(	O
which	O
is	O
a	O
2-view	O
tensor	B
)	O
also	O
satisﬁes	O
an	O
internal	B
constraint	O
but	O
a	O
relatively	O
simple	O
one	O
:	O
the	O
elements	O
obey	O
det	O
f	O
=	O
0.	O
as	O
with	O
the	O
fundamental	B
matrix	I
,	O
once	O
the	O
trifocal	B
tensor	I
is	O
known	O
,	O
it	O
is	O
possible	O
to	O
extract	O
the	O
three	O
camera	B
matrices	I
from	O
it	O
,	O
and	O
thereby	O
obtain	O
a	O
reconstruction	B
of	O
the	O
scene	O
points	O
and	O
lines	B
.	O
as	O
ever	O
,	O
this	O
reconstruction	B
is	O
unique	O
only	O
up	O
to	O
a	O
3d	O
projective	B
transformation	I
;	O
it	O
is	O
a	O
projective	B
reconstruction	I
.	O
thus	O
,	O
we	O
are	O
able	O
to	O
generalize	O
the	O
method	O
for	O
two	O
views	O
to	O
three	O
views	O
.	O
there	O
are	O
several	O
advantages	O
to	O
using	O
such	O
a	O
three-view	O
method	O
for	O
reconstruction	O
.	O
(	O
i	O
)	O
it	O
is	O
possible	O
to	O
use	O
a	O
mixture	O
of	O
line	O
and	O
point	B
correspondences	O
to	O
compute	O
the	O
projective	B
reconstruction	I
.	O
with	O
two	O
views	O
,	O
only	O
point	B
correspondences	O
can	O
be	O
used	O
.	O
(	O
ii	O
)	O
using	O
three	O
views	O
gives	O
greater	O
stability	B
to	O
the	O
reconstruction	B
,	O
and	O
avoids	O
unsta-	O
ble	O
conﬁgurations	O
that	O
may	O
occur	O
using	O
only	O
two	B
views	I
for	O
the	O
reconstruction	B
.	O
1.5	O
four	O
view	O
geometry	O
and	O
n-view	O
reconstruction	B
it	O
is	O
possible	O
to	O
go	O
one	O
more	O
step	O
with	O
tensor-based	O
methods	O
and	O
deﬁne	O
a	O
quadrifocal	B
tensor	I
relating	O
entities	O
visible	O
in	O
four	O
views	O
.	O
this	O
method	O
is	O
seldom	O
used	O
,	O
however	O
,	O
be-	O
cause	O
of	O
the	O
relative	O
difﬁculty	O
of	O
computing	O
a	O
quadrifocal	B
tensor	I
that	O
obey	O
its	O
internal	B
constraints	O
.	O
nevertheless	O
,	O
it	O
does	O
provide	O
a	O
non-iterative	O
method	O
for	O
computing	O
a	O
pro-	O
jective	O
reconstruction	B
based	O
on	O
four	O
views	O
.	O
the	O
tensor	B
method	O
does	O
not	O
extend	O
to	O
more	O
than	O
four	O
views	O
,	O
however	O
,	O
and	O
so	O
reconstruction	B
from	O
more	O
than	O
four	O
views	O
becomes	O
more	O
difﬁcult	O
.	O
many	O
methods	O
have	O
been	O
considered	O
for	O
reconstruction	O
from	O
several	O
views	O
,	O
and	O
we	O
consider	O
a	O
few	O
of	O
these	O
in	O
the	O
book	O
.	O
one	O
way	O
to	O
proceed	O
is	O
to	O
reconstruct	O
the	O
scene	O
bit	O
by	O
bit	O
,	O
using	O
three-view	O
or	O
two-view	O
techniques	O
.	O
such	O
a	O
method	O
may	O
be	O
applied	O
to	O
any	O
image	O
sequence	O
,	O
and	O
with	O
care	O
in	O
selecting	O
the	O
right	O
triples	O
to	O
use	O
,	O
it	O
will	O
generally	O
succeed	O
.	O
there	O
are	O
methods	O
that	O
can	O
be	O
used	O
in	O
speciﬁc	O
circumstances	O
.	O
the	O
task	O
of	O
reconstruc-	O
tion	O
becomes	O
easier	O
if	O
we	O
are	O
able	O
to	O
apply	O
a	O
simpler	O
camera	B
model	O
,	O
known	O
as	O
the	O
afﬁne	B
camera	I
.	O
this	O
camera	B
model	O
is	O
a	O
fair	O
approximation	O
to	O
perspective	O
projection	B
whenever	O
the	O
distance	B
to	O
the	O
scene	O
is	O
large	O
compared	O
with	O
the	O
difference	O
in	O
depth	O
between	O
the	O
back	O
and	O
front	O
of	O
the	O
scene	O
.	O
if	O
a	O
set	O
of	B
points	I
are	O
visible	O
in	O
all	O
of	O
a	O
set	O
of	O
n	O
views	O
14	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
involving	O
an	O
afﬁne	B
camera	I
,	O
then	O
a	O
well-known	O
algorithm	B
,	O
the	O
factorization	B
algorithm	O
,	O
can	O
be	O
used	O
to	O
compute	O
both	O
the	O
structure	B
of	O
the	O
scene	O
,	O
and	O
the	O
speciﬁc	O
camera	B
models	O
in	O
one	O
step	O
using	O
the	O
singular	O
value	O
decomposition	B
.	O
this	O
algorithm	B
is	O
very	O
reliable	O
and	O
simple	O
to	O
implement	O
.	O
its	O
main	O
difﬁculties	O
are	O
the	O
use	O
of	O
the	O
afﬁne	B
camera	I
model	O
,	O
rather	O
than	O
a	O
full	O
projective	O
model	B
,	O
and	O
the	O
requirement	O
that	O
all	O
the	O
points	O
be	O
visible	O
in	O
all	O
views	O
.	O
this	O
method	O
has	O
been	O
extended	O
to	O
projective	O
cameras	B
in	O
a	O
method	O
known	O
as	O
projec-	O
tive	O
factorization	B
.	O
although	O
this	O
method	O
is	O
generally	O
satisfactory	O
,	O
it	O
can	O
not	O
be	O
proven	O
to	O
converge	O
to	O
the	O
correct	O
solution	B
in	O
all	O
cases	O
.	O
besides	O
,	O
it	O
also	O
requires	O
all	O
points	O
to	O
be	O
visible	O
in	O
all	O
images	O
.	O
other	O
methods	O
for	O
n-view	O
reconstruction	B
involve	O
various	O
assumptions	O
,	O
such	O
as	O
knowledge	O
of	O
four	O
coplanar	O
points	O
in	O
the	O
world	O
visible	O
in	O
all	O
views	O
,	O
or	O
six	O
or	O
seven	O
points	O
that	O
are	O
visible	O
in	O
all	O
images	O
in	O
the	O
sequence	O
.	O
methods	O
that	O
apply	O
to	O
speciﬁc	O
mo-	O
tion	O
sequences	O
,	O
such	O
as	O
linear	O
motion	O
,	O
planar	B
motion	I
or	O
single	O
axis	O
(	O
turntable	O
)	O
motion	O
have	O
also	O
been	O
developed	O
.	O
the	O
dominant	O
methodology	O
for	O
the	O
general	O
reconstruction	O
problem	O
is	O
bundle	O
adjust-	O
ment	O
.	O
this	O
is	O
an	O
iterative	B
method	O
,	O
in	O
which	O
one	O
attempts	O
to	O
ﬁt	O
a	O
non-linear	B
model	O
to	O
the	O
measured	O
data	O
(	O
the	O
point	B
correspondences	O
)	O
.	O
the	O
advantage	O
of	O
bundle-adjustment	O
is	O
that	O
it	O
is	O
a	O
very	O
general	O
method	O
that	O
may	O
be	O
applied	O
to	O
a	O
wide	O
range	O
of	O
reconstruction	O
and	O
optimization	O
problems	O
.	O
it	O
may	O
be	O
implemented	O
in	O
such	O
a	O
way	O
that	O
the	O
discovered	O
solution	B
is	O
the	O
maximum	O
likelihood	O
solution	B
to	O
the	O
problem	O
,	O
that	O
is	O
a	O
solution	B
that	O
is	O
in	O
some	O
sense	O
optimal	O
in	O
terms	O
of	O
a	O
model	O
for	O
the	O
inaccuracies	O
of	O
image	O
measurements	O
.	O
unfortunately	O
,	O
bundle	B
adjustment	I
is	O
an	O
iterative	B
process	O
,	O
which	O
can	O
not	O
be	O
guaran-	O
teed	O
to	O
converge	O
to	O
the	O
optimal	O
solution	B
from	O
an	O
arbitrary	O
starting	O
point	B
.	O
much	O
research	O
in	O
reconstruction	O
methods	O
seeks	O
easily	O
computable	O
non-optimal	O
solutions	O
that	O
can	O
be	O
used	O
as	O
a	O
starting	O
point	B
for	O
bundle	B
adjustment	I
.	O
an	O
initialization	B
step	O
followed	O
by	O
bundle	B
adjustment	I
is	O
the	O
generally	O
preferred	O
technique	O
for	O
reconstruction	O
.	O
a	O
common	O
impres-	O
sion	O
is	O
that	O
bundle-adjustment	O
is	O
necessarily	O
a	O
slow	O
technique	O
.	O
the	O
truth	O
is	O
that	O
it	O
is	O
quite	O
efﬁcient	O
when	O
implemented	O
carefully	O
.	O
a	O
lengthy	O
appendix	O
in	O
this	O
book	O
deals	O
with	O
efﬁcient	O
methods	O
of	O
bundle	O
adjustment	O
.	O
using	O
n-view	O
reconstruction	B
techniques	O
,	O
it	O
is	O
possible	O
to	O
carry	O
out	O
reconstructions	O
automatically	O
from	O
quite	O
long	O
sequences	O
of	O
images	O
.	O
an	O
example	O
is	O
given	O
in	O
ﬁgure	O
1.3	O
,	O
showing	O
a	O
reconstruction	B
from	O
700	O
frames	O
.	O
1.6	O
transfer	B
we	O
have	O
discussed	O
3d	O
reconstruction	B
from	O
a	O
set	O
of	O
images	O
.	O
another	O
useful	O
application	O
of	O
projective	B
geometry	O
is	O
that	O
of	O
transfer	O
:	O
given	O
the	O
position	O
of	O
a	O
point	O
in	O
one	O
(	O
or	O
more	O
)	O
image	O
(	O
s	O
)	O
,	O
determine	O
where	O
it	O
will	O
appear	O
in	O
all	O
other	O
images	O
of	O
the	O
set	O
.	O
to	O
do	O
this	O
,	O
we	O
must	O
ﬁrst	O
establish	O
the	O
relationship	O
between	O
the	O
cameras	B
using	O
(	O
for	O
instance	O
)	O
a	O
set	O
of	O
auxiliary	O
point	B
correspondences	O
.	O
conceptually	O
transfer	B
is	O
straightforward	O
given	O
that	O
a	O
reconstruction	B
is	O
possible	O
.	O
for	O
instance	O
,	O
suppose	O
the	O
point	B
is	O
identiﬁed	O
in	O
two	O
views	O
(	O
at	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
in	O
a	O
third	O
,	O
then	O
this	O
may	O
be	O
computed	O
by	O
the	O
following	O
steps	O
:	O
)	O
and	O
we	O
wish	O
to	O
know	O
its	O
position	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1.6	O
transfer	B
15	O
(	O
b	O
)	O
(	O
c	O
)	O
(	O
a	O
)	O
fig	O
.	O
1.3.	O
reconstruction	B
.	O
(	O
a	O
)	O
seven	O
frames	O
of	O
a	O
700	O
frame	O
sequence	O
acquired	O
by	O
a	O
hand	O
held	O
camera	B
whilst	O
walking	O
down	O
a	O
street	O
in	O
oxford	O
.	O
(	O
b	O
)	O
(	O
c	O
)	O
two	B
views	I
of	O
the	O
reconstructed	O
point	B
cloud	O
and	O
camera	B
path	O
(	O
the	O
red	O
curve	O
)	O
.	O
figures	O
courtesy	O
of	O
david	O
capel	O
and	O
2d3	O
(	O
www.2d3.com	O
)	O
.	O
16	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
fig	O
.	O
1.4.	O
projective	B
ambiguity	I
:	O
reconstructions	O
of	O
a	O
mug	O
(	O
shown	O
with	O
the	O
true	O
shape	O
in	O
the	O
centre	B
)	O
under	O
3d	O
projective	B
transformations	O
in	O
the	O
z	O
direction	O
.	O
five	O
examples	B
of	O
the	O
cup	O
with	O
different	O
degrees	O
of	O
projective	O
distortion	B
are	O
shown	O
.	O
the	O
shapes	O
are	O
quite	O
different	O
from	O
the	O
original	O
.	O
respondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
i	O
)	O
compute	O
the	O
camera	B
matrices	I
of	O
the	O
three	O
views	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
triangulate	O
the	O
3d	O
point	B
x	O
from	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
iii	O
)	O
project	O
the	O
3d	O
point	B
into	O
the	O
third	O
view	O
as	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
.	O
i	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
using	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
.	O
=	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
x.	O
from	O
other	O
point	B
cor-	O
this	O
procedure	O
only	O
requires	O
projective	B
information	O
.	O
an	O
alternative	O
procedure	O
is	O
to	O
use	O
the	O
multi-view	O
tensors	O
(	O
the	O
fundamental	B
matrix	I
and	O
trifocal	B
tensor	I
)	O
to	O
transfer	O
the	O
point	B
directly	O
without	O
an	O
explicit	O
3d	O
reconstruction	B
.	O
both	O
methods	O
have	O
their	O
advantages	O
.	O
suppose	O
the	O
camera	B
rotates	O
about	O
its	O
centre	B
or	O
that	O
all	O
the	O
scene	O
points	O
of	O
interest	O
lie	O
on	O
a	O
plane	O
.	O
then	O
the	O
appropriate	O
multiple	O
view	O
relations	O
are	O
the	O
planar	O
projective	O
transformations	O
between	O
the	O
images	O
.	O
in	O
this	O
case	O
,	O
a	O
point	B
seen	O
in	O
just	O
one	O
image	O
can	O
be	O
transferred	O
to	O
any	O
other	O
image	O
.	O
1.7	O
euclidean	O
reconstruction	O
so	O
far	O
we	O
have	O
considered	O
the	O
reconstruction	B
of	O
a	O
scene	O
,	O
or	O
transfer	B
,	O
for	O
images	O
taken	O
with	O
a	O
set	O
of	O
uncalibrated	O
cameras	B
.	O
for	O
such	O
cameras	B
,	O
important	O
parameters	B
such	O
as	O
the	O
focal	B
length	I
,	O
the	O
geometric	B
centre	O
of	O
the	O
image	O
(	O
the	O
principal	B
point	I
)	O
and	O
possibly	O
the	O
aspect	O
ratio	O
of	O
the	O
pixels	O
in	O
the	O
image	O
are	O
unknown	O
.	O
if	O
a	O
complete	O
calibration	B
of	O
each	O
of	O
the	O
cameras	O
is	O
known	O
then	O
it	O
is	O
possible	O
to	O
remove	O
some	O
of	O
the	O
ambiguity	O
of	O
the	O
reconstructed	O
scene	O
.	O
so	O
far	O
,	O
we	O
have	O
discussed	O
projective	B
reconstruction	I
,	O
which	O
is	O
all	O
that	O
is	O
possible	O
with-	O
out	O
knowing	O
something	O
about	O
the	O
calibration	B
of	O
the	O
cameras	B
or	O
the	O
scene	O
.	O
projective	B
reconstruction	I
is	O
insufﬁcient	O
for	O
many	O
purposes	O
,	O
such	O
as	O
application	O
to	O
computer	O
graph-	O
ics	O
,	O
since	O
it	O
involves	O
distortions	O
of	O
the	O
model	O
that	O
appear	O
strange	O
to	O
a	O
human	O
used	O
to	O
viewing	O
a	O
euclidean	O
world	O
.	O
for	O
instance	O
,	O
the	O
distortions	O
that	O
projective	B
transformations	O
induce	O
in	O
a	O
simple	O
object	O
are	O
shown	O
in	O
ﬁgure	O
1.4.	O
using	O
the	O
technique	O
of	O
projective	O
re-	O
construction	O
,	O
there	O
is	O
no	O
way	O
to	O
choose	O
between	O
any	O
of	O
the	O
possible	O
shapes	O
of	O
the	O
mug	O
in	O
ﬁgure	O
1.4	O
,	O
and	O
a	O
projective	B
reconstruction	I
algorithm	O
is	O
as	O
likely	O
to	O
come	O
up	O
with	O
any	O
one	O
of	O
the	O
reconstructions	O
shown	O
there	O
as	O
any	O
other	O
.	O
even	O
more	O
severely	O
distorted	O
models	O
may	O
arise	O
from	O
projective	O
reconstruction	B
.	O
in	O
order	O
to	O
obtain	O
a	O
reconstruction	B
of	O
the	O
model	B
in	O
which	O
objects	O
have	O
their	O
correct	O
(	O
euclidean	O
)	O
shape	O
,	O
it	O
is	O
necessary	O
to	O
determine	O
the	O
calibration	B
of	O
the	O
cameras	B
.	O
it	O
is	O
easy	O
to	O
see	O
that	O
this	O
is	O
sufﬁcient	O
to	O
determine	O
the	O
euclidean	O
structure	O
of	O
the	O
scene	O
.	O
as	O
we	O
have	O
seen	O
,	O
determining	O
the	O
euclidean	O
structure	B
of	O
the	O
world	O
is	O
equivalent	B
to	O
specifying	O
the	O
plane	O
at	O
inﬁnity	O
and	O
the	O
absolute	O
conic	O
.	O
in	O
fact	O
,	O
since	O
the	O
absolute	O
conic	O
1.8	O
auto-calibration	B
17	O
lies	O
in	O
a	O
plane	B
,	O
the	O
plane	O
at	O
inﬁnity	O
,	O
it	O
is	O
enough	O
to	O
ﬁnd	O
the	O
absolute	O
conic	O
in	O
space	O
.	O
now	O
,	O
suppose	O
that	O
we	O
have	O
computed	O
a	O
projective	B
reconstruction	I
of	O
the	O
world	O
,	O
using	O
calibrated	O
cameras	B
.	O
by	O
deﬁnition	B
,	O
this	O
means	O
that	O
the	O
iac	O
is	O
known	O
in	O
each	O
of	O
the	O
images	O
;	O
let	O
it	O
be	O
denoted	O
by	O
ωi	O
in	O
the	O
i-th	O
image	O
.	O
the	O
back-projection	B
of	O
each	O
ωi	O
is	O
a	O
cone	O
in	O
space	O
,	O
and	O
the	O
absolute	O
conic	O
must	O
lie	O
in	O
the	O
intersection	B
of	O
all	O
the	O
cones	O
.	O
two	O
cones	O
in	O
general	O
intersect	O
in	O
a	O
fourth-degree	O
curve	O
,	O
but	O
given	O
that	O
they	O
must	O
intersect	O
in	O
a	O
conic	B
,	O
this	O
curve	O
must	O
split	O
into	O
two	O
conics	O
.	O
thus	O
,	O
reconstruction	B
of	O
the	O
absolute	O
conic	O
from	O
two	O
images	O
is	O
not	O
unique	O
–	O
rather	O
,	O
there	O
are	O
two	O
possible	O
solutions	O
in	O
general	O
.	O
however	O
,	O
from	O
three	O
or	O
more	O
images	O
,	O
the	O
intersection	B
of	O
the	O
cones	O
is	O
unique	O
in	O
general	O
.	O
thus	O
the	O
absolute	O
conic	O
is	O
determined	O
and	O
with	O
it	O
the	O
euclidean	O
structure	O
of	O
the	O
scene	O
.	O
of	O
course	O
,	O
if	O
the	O
euclidean	O
structure	O
of	O
the	O
scene	O
is	O
known	O
,	O
then	O
so	O
is	O
the	O
position	O
of	O
the	O
absolute	O
conic	B
.	O
in	O
this	O
case	O
we	O
may	O
project	O
it	O
back	O
into	O
each	O
of	O
the	O
images	O
,	O
produc-	O
ing	O
the	O
iac	O
in	O
each	O
image	O
,	O
and	O
hence	O
calibrating	O
the	O
cameras	B
.	O
thus	O
knowledge	O
of	O
the	O
camera	O
calibration	B
is	O
equivalent	B
to	O
being	O
able	O
to	O
determine	O
the	O
euclidean	O
structure	O
of	O
the	O
scene	O
.	O
1.8	O
auto-calibration	B
without	O
any	O
knowledge	O
of	O
the	O
calibration	O
of	O
the	O
cameras	O
,	O
it	O
is	O
impossible	O
to	O
do	O
better	O
than	O
projective	B
reconstruction	I
.	O
there	O
is	O
no	O
information	O
in	O
a	O
set	O
of	O
feature	O
correspon-	O
dences	O
across	O
any	O
number	O
of	O
views	O
that	O
can	O
help	O
us	O
ﬁnd	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
or	O
equivalently	O
the	O
calibration	B
of	O
the	O
cameras	B
.	O
however	O
,	O
if	O
we	O
know	O
just	O
a	O
little	O
about	O
the	O
calibration	B
of	O
the	O
cameras	B
then	O
we	O
may	O
be	O
able	O
to	O
determine	O
the	O
position	O
of	O
the	O
absolute	O
conic	B
.	O
suppose	O
,	O
for	O
instance	O
that	O
it	O
is	O
known	O
that	O
the	O
calibration	B
is	O
the	O
same	O
for	O
each	O
of	O
the	O
cameras	O
used	O
in	O
reconstructing	O
a	O
scene	O
from	O
an	O
image	O
sequence	O
.	O
by	O
this	O
we	O
mean	O
the	O
following	O
.	O
in	O
each	O
image	O
a	O
coordinate	O
system	O
is	O
deﬁned	O
,	O
in	O
which	O
we	O
have	O
measured	O
the	O
image	O
coordinates	O
of	O
corresponding	O
features	O
used	O
to	O
do	O
projective	B
reconstruction	I
.	O
suppose	O
that	O
in	O
all	O
these	O
image	O
coordinate	O
systems	O
,	O
the	O
iac	O
is	O
the	O
same	O
,	O
but	O
just	O
where	O
it	O
is	O
located	O
is	O
unknown	O
.	O
from	O
this	O
knowledge	O
,	O
we	O
wish	O
to	O
compute	O
the	O
position	O
of	O
the	O
absolute	O
conic	B
.	O
one	O
way	O
to	O
ﬁnd	O
the	O
absolute	O
conic	O
is	O
to	O
hypothesize	O
the	O
position	O
of	O
the	O
iac	O
in	B
one	I
image	I
;	O
by	O
hypothesis	O
,	O
its	O
position	O
in	O
the	O
other	O
images	O
will	O
be	O
the	O
same	O
.	O
the	O
back-	O
projection	B
of	O
each	O
of	O
the	O
conics	O
will	O
be	O
a	O
cone	O
in	O
space	O
.	O
if	O
the	O
three	O
cones	O
all	O
meet	O
in	O
a	O
single	O
conic	O
,	O
then	O
this	O
must	O
be	O
a	O
possible	O
solution	B
for	O
the	O
position	O
of	O
the	O
absolute	O
conic	B
,	O
consistent	O
with	O
the	O
reconstruction	B
.	O
note	O
that	O
this	O
is	O
a	O
conceptual	O
description	O
only	O
.	O
the	O
iac	O
is	O
of	O
course	O
a	O
conic	B
con-	O
taining	O
only	O
complex	O
points	O
,	O
and	O
its	O
back-projection	B
will	O
be	O
a	O
complex	O
cone	O
.	O
however	O
,	O
algebraically	O
,	O
the	O
problem	O
is	O
more	O
tractable	O
.	O
although	O
it	O
is	O
complex	O
,	O
the	O
iac	O
may	O
be	O
described	O
by	O
a	O
real	O
quadratic	O
form	O
(	O
represented	O
by	O
a	O
real	O
symmetric	B
matrix	O
)	O
.	O
the	O
back-	O
projected	O
cone	O
is	O
also	O
represented	O
by	O
a	O
real	O
quadratic	O
form	O
.	O
for	O
some	O
value	O
of	O
the	O
iac	O
,	O
the	O
three	O
back-projected	O
cones	O
will	O
meet	O
in	O
a	O
conic	B
curve	O
in	O
space	O
.	O
generally	O
given	O
three	O
cameras	B
known	O
to	O
have	O
the	O
same	O
calibration	O
,	O
it	O
is	O
possible	O
to	O
determine	O
the	O
absolute	O
conic	O
,	O
and	O
hence	O
the	O
calibration	B
of	O
the	O
cameras	B
.	O
however	O
,	O
18	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
although	O
various	O
methods	O
have	O
been	O
proposed	O
for	O
this	O
,	O
it	O
remains	O
quite	O
a	O
difﬁcult	O
prob-	O
lem	O
.	O
knowing	O
the	O
plane	O
at	O
inﬁnity	O
.	O
one	O
method	O
of	B
auto-calibration	I
is	O
to	O
proceed	O
in	O
steps	O
by	O
ﬁrst	O
determining	O
the	O
plane	O
on	O
which	O
it	O
lies	O
.	O
this	O
is	O
equivalent	B
to	O
identifying	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
world	O
,	O
and	O
hence	O
to	O
determining	O
the	O
afﬁne	B
geometry	I
of	O
the	O
world	O
.	O
in	O
a	O
second	O
step	O
,	O
one	O
locates	O
the	O
position	O
of	O
the	O
absolute	O
conic	B
on	O
the	O
plane	B
to	O
determine	O
the	O
euclidean	B
geometry	I
of	O
space	O
.	O
assuming	O
one	O
knows	O
the	O
plane	O
at	O
inﬁnity	O
,	O
one	O
can	O
back-project	O
a	O
hypothesised	O
iac	O
from	O
each	O
of	O
a	O
sequence	O
of	O
images	O
and	O
intersect	O
the	O
resulting	O
cones	O
with	O
the	O
plane	O
at	O
inﬁnity	O
.	O
if	O
the	O
iac	O
is	O
chosen	O
correctly	O
,	O
the	O
intersection	B
curve	O
is	O
the	O
absolute	O
conic	O
.	O
thus	O
,	O
from	O
each	O
pair	O
of	O
images	O
one	O
has	O
a	O
condition	O
that	O
the	O
back-projected	O
cones	O
meet	O
in	O
the	O
same	O
conic	O
curve	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
it	O
turns	O
out	O
that	O
this	O
gives	O
a	O
linear	B
constraint	O
on	O
the	O
entries	O
of	O
the	O
matrix	O
representing	O
the	O
iac	O
.	O
from	O
a	O
set	O
of	O
linear	O
equations	O
,	O
one	O
can	O
determine	O
the	O
iac	O
,	O
and	O
hence	O
the	O
absolute	O
conic	O
.	O
thus	O
,	O
auto-calibration	B
is	O
relatively	O
simple	O
,	O
once	O
the	O
plane	O
at	O
inﬁnity	O
has	O
been	O
identiﬁed	O
.	O
the	O
identiﬁcation	O
of	O
the	O
plane	O
at	B
inﬁnity	I
itself	O
is	O
substantially	O
more	O
difﬁcult	O
.	O
auto-calibration	B
given	O
square	O
pixels	O
in	O
the	O
image	O
.	O
if	O
the	O
cameras	B
are	O
partially	O
calibrated	B
,	O
then	O
it	O
is	O
possible	O
to	O
complete	O
the	O
calibration	B
starting	O
from	O
a	O
projective	B
reconstruction	I
.	O
one	O
can	O
make	O
do	O
with	O
quite	O
minimal	O
conditions	O
on	O
the	O
calibration	B
of	O
the	O
cameras	B
,	O
represented	O
by	O
the	O
iac	O
.	O
one	O
interesting	O
example	O
is	O
the	O
square-pixel	O
constraint	O
on	O
the	O
cameras	B
.	O
what	O
this	O
means	O
is	O
that	O
a	O
euclidean	O
coordinate	O
system	O
is	O
known	O
in	O
each	O
image	O
.	O
in	O
this	O
case	O
,	O
the	O
absolute	O
conic	O
,	O
lying	O
in	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
world	O
must	O
meet	O
the	O
image	B
plane	I
in	O
its	O
two	O
circular	O
points	O
.	O
the	O
circular	B
points	I
in	O
a	O
plane	B
are	O
the	O
two	O
points	O
where	O
the	O
absolute	O
conic	O
meets	O
that	O
plane	B
.	O
the	O
back-projected	O
rays	O
through	O
the	O
circular	B
points	I
of	O
the	O
image	B
plane	I
must	O
intersect	O
the	O
absolute	O
conic	O
.	O
thus	O
,	O
each	O
image	O
with	O
square	O
pixels	O
determines	O
two	O
rays	O
that	O
must	O
meet	O
the	O
absolute	O
conic	O
.	O
given	O
n	O
images	O
,	O
the	O
autocalibration	O
task	O
then	O
becomes	O
that	O
of	O
determining	O
a	O
space	O
conic	O
(	O
the	O
absolute	O
conic	O
)	O
that	O
meets	O
a	O
set	O
of	O
2n	O
rays	O
in	O
space	O
.	O
an	O
equivalent	B
geometric	O
picture	B
is	O
to	O
intersect	O
the	O
set	O
of	O
rays	O
with	O
a	O
plane	B
and	O
require	O
that	O
the	O
set	O
of	O
intersection	O
points	O
lie	O
on	O
a	O
conic	O
.	O
by	O
a	O
simple	O
counting	O
argument	O
one	O
may	O
see	O
that	O
there	O
are	O
only	O
a	O
ﬁnite	B
number	O
of	B
conics	I
that	O
meet	O
eight	O
prescribed	O
rays	O
in	O
space	O
.	O
therefore	O
,	O
from	O
four	O
images	O
one	O
may	O
determine	O
the	O
calibration	B
,	O
albeit	O
up	O
to	O
a	O
ﬁnite	B
number	O
of	O
possibilities	O
.	O
1.9	O
the	O
reward	O
i	O
:	O
3d	O
graphical	O
models	O
we	O
have	O
now	O
described	O
all	O
the	O
ingredients	O
necessary	O
to	O
compute	O
realistic	O
graphics	O
mod-	O
els	O
from	O
image	O
sequences	O
.	O
from	O
point	O
matches	O
between	O
images	O
,	O
it	O
is	O
possible	O
to	O
carry	O
out	O
ﬁrst	O
a	O
projective	B
reconstruction	I
of	O
the	O
point	B
set	O
,	O
and	O
determine	O
the	O
motion	O
of	O
the	O
camera	O
in	O
the	O
chosen	O
projective	B
coordinate	O
frame	O
.	O
using	O
auto-calibration	O
techniques	O
,	O
assuming	O
some	O
restrictions	O
on	O
the	O
calibration	B
of	O
the	O
camera	B
that	O
captured	O
the	O
image	O
sequence	O
,	O
the	O
camera	B
may	O
be	O
calibrated	B
,	O
and	O
the	O
scene	O
subsequently	O
transformed	O
to	O
its	O
true	O
euclidean	O
structure	O
.	O
1.10	O
the	O
reward	O
ii	O
:	O
video	O
augmentation	B
19	O
a	O
b	O
fig	O
.	O
1.5	O
.	O
(	O
a	O
)	O
three	O
high	O
resolution	O
images	O
(	O
3000	O
×	O
2000	O
pixels	O
)	O
from	O
a	O
set	O
of	O
eleven	O
of	O
the	O
cityhall	O
in	O
leuven	O
,	O
belgium	O
.	O
(	O
b	O
)	O
three	O
views	O
of	O
a	O
euclidean	O
reconstruction	B
computed	O
from	O
the	O
image	O
set	O
showing	O
the	O
11	O
camera	B
positions	O
and	O
point	B
cloud	O
.	O
knowing	O
the	O
projective	B
structure	O
of	O
the	O
scene	O
,	O
it	O
is	O
possible	O
to	O
ﬁnd	O
the	O
epipolar	B
ge-	O
ometry	O
relating	O
pairs	O
of	O
images	O
and	O
this	O
restricts	O
the	O
correspondence	B
search	O
for	O
further	O
matches	O
to	O
a	O
line	B
–	O
a	O
point	B
in	O
one	O
image	O
deﬁnes	O
a	O
line	B
in	O
the	O
other	O
image	O
on	O
which	O
the	O
(	O
as	O
yet	O
unknown	O
)	O
corresponding	O
point	B
must	O
lie	O
.	O
in	O
fact	O
for	O
suitable	O
scenes	O
,	O
it	O
is	O
possible	O
to	O
carry	O
out	O
a	O
dense	O
point	B
match	O
between	O
images	O
and	O
create	O
a	O
dense	O
3d	O
model	B
of	O
the	O
imaged	O
scene	O
.	O
this	O
takes	O
the	O
form	B
of	I
a	O
triangulated	O
shape	O
model	B
that	O
is	O
subsequently	O
shaded	O
or	O
texture-mapped	O
from	O
the	O
supplied	O
images	O
and	O
used	O
to	O
generate	O
novel	O
views	O
.	O
the	O
steps	O
of	O
this	O
process	O
are	O
illustrated	O
in	O
ﬁgure	O
1.5	O
and	O
ﬁgure	O
1.6	O
.	O
1.10	O
the	O
reward	O
ii	O
:	O
video	O
augmentation	B
we	O
ﬁnish	O
this	O
introduction	O
with	O
a	O
further	O
application	O
of	O
reconstruction	B
methods	O
to	O
com-	O
puter	O
graphics	O
.	O
automatic	O
reconstruction	B
techniques	O
have	O
recently	O
become	O
widely	O
used	O
in	O
the	O
ﬁlm	O
industry	O
as	O
a	O
means	O
for	O
adding	O
artiﬁcial	O
graphics	O
objects	O
in	O
real	O
video	O
se-	O
quences	O
.	O
computer	O
analysis	O
of	O
the	O
motion	O
of	O
the	O
camera	O
is	O
replacing	O
the	O
previously	O
used	O
manual	O
methods	O
for	O
correctly	O
aligning	O
the	O
artiﬁcial	O
inserted	O
object	O
.	O
the	O
most	O
important	O
requirement	O
for	O
realistic	O
insertion	O
of	O
an	O
artiﬁcial	O
object	O
in	O
a	O
video	O
20	O
1	O
introduction	O
–	O
a	O
tour	O
of	O
multiple	O
view	O
geometry	O
a	O
c	O
e	O
b	O
d	O
f	O
fig	O
.	O
1.6.	O
dense	O
reconstructions	O
.	O
these	O
are	O
computed	O
from	O
the	O
cameras	B
and	O
image	O
of	O
ﬁgure	O
1.5	O
.	O
(	O
a	O
)	O
untextured	O
and	O
(	O
b	O
)	O
textured	O
reconstruction	B
of	O
the	O
full	O
scene	O
.	O
(	O
c	O
)	O
untextured	O
and	O
(	O
d	O
)	O
textured	O
close	O
up	O
of	O
the	O
area	O
shown	O
in	O
the	O
white	O
rectangle	O
of	O
(	O
b	O
)	O
.	O
(	O
e	O
)	O
untextured	O
and	O
(	O
f	O
)	O
textured	O
close	O
up	O
of	O
the	O
area	O
shown	O
in	O
the	O
white	O
rectangle	O
of	O
(	O
d	O
)	O
.	O
the	O
dense	O
surface	O
is	O
computed	O
using	O
the	O
three-view	O
stereo	O
algorithm	O
described	O
in	O
[	O
strecha-02	O
]	O
.	O
figures	O
courtesy	O
of	O
christoph	O
strecha	O
,	O
frank	O
verbiest	O
,	O
and	O
luc	O
van	O
gool	O
.	O
1.10	O
the	O
reward	O
ii	O
:	O
video	O
augmentation	B
21	O
a	O
d	O
b	O
e	O
c	O
f	O
fig	O
.	O
1.7.	O
augmented	O
video	O
.	O
the	O
animated	O
robot	O
is	O
inserted	O
into	O
the	O
scene	O
and	O
rendered	O
using	O
the	O
computed	O
cameras	O
of	O
ﬁgure	O
1.3	O
.	O
(	O
d	O
)	O
-	O
(	O
f	O
)	O
the	O
augmented	O
frames	O
.	O
figures	O
courtesy	O
of	O
2d3	O
(	O
www.2d3.com	O
)	O
.	O
(	O
a	O
)	O
-	O
(	O
c	O
)	O
original	O
frames	O
from	O
the	O
sequence	O
.	O
sequence	O
is	O
to	O
compute	O
the	O
correct	O
motion	O
of	O
the	O
camera	O
.	O
unless	O
the	O
camera	B
motion	I
is	O
correctly	O
determined	O
,	O
it	O
is	O
impossible	O
to	O
generate	O
the	O
correct	O
sequences	O
of	O
views	O
of	O
the	O
graphics	O
model	B
in	O
a	O
way	O
that	O
will	O
appear	O
consistent	O
with	O
the	O
background	O
video	O
.	O
generally	O
,	O
it	O
is	O
only	O
the	O
motion	O
of	O
the	O
camera	O
that	O
is	O
important	O
here	O
;	O
we	O
do	O
not	O
need	O
to	O
reconstruct	O
the	O
scene	O
,	O
since	O
it	O
is	O
already	O
present	O
in	O
the	O
existing	O
video	O
,	O
and	O
novel	O
views	O
of	O
the	O
scene	O
visible	O
in	O
the	O
video	O
are	O
not	O
required	O
.	O
the	O
only	O
requirement	O
is	O
to	O
be	O
able	O
to	O
generate	O
correct	O
perspective	O
views	O
of	O
the	O
graphics	O
model	B
.	O
it	O
is	O
essential	O
to	O
compute	O
the	O
motion	O
of	O
the	O
camera	O
in	O
a	O
euclidean	O
frame	O
.	O
it	O
is	O
not	O
enough	O
merely	O
to	O
know	O
the	O
projective	B
motion	O
of	O
the	O
camera	O
.	O
this	O
is	O
because	O
a	O
eu-	O
clidean	O
object	O
is	O
to	O
be	O
placed	O
in	O
the	O
scene	O
.	O
unless	O
this	O
graphics	O
object	O
and	O
the	O
cameras	B
are	O
known	O
in	O
the	O
same	O
coordinate	O
frame	O
,	O
then	O
generated	O
views	O
of	O
the	O
inserted	O
object	O
will	O
be	O
seen	O
to	O
distort	O
with	O
respect	O
to	O
the	O
perceived	O
structure	B
of	O
the	O
scene	O
seen	O
in	O
the	O
existing	O
video	O
.	O
once	O
the	O
correct	O
motion	O
of	O
the	O
camera	O
,	O
and	O
its	O
calibration	B
are	O
known	O
the	O
inserted	O
object	O
may	O
be	O
rendered	O
into	O
the	O
scene	O
in	O
a	O
realistic	O
manner	O
.	O
if	O
the	O
change	O
of	O
the	O
camera	B
calibration	I
from	O
frame	O
to	O
frame	O
is	O
correctly	O
determined	O
,	O
then	O
the	O
camera	B
may	O
change	O
focal	O
length	O
(	O
zoom	O
)	O
during	O
the	O
sequence	O
.	O
it	O
is	O
even	O
possible	O
for	O
the	O
principal	B
point	I
to	O
vary	O
during	O
the	O
sequence	O
through	O
cropping	O
.	O
in	O
inserting	O
the	O
rendered	O
model	B
into	O
the	O
video	O
,	O
the	O
task	O
is	O
relatively	O
straight-forward	O
if	O
it	O
lies	O
in	O
front	O
of	O
all	O
the	O
existing	O
scene	O
.	O
otherwise	O
the	O
possibility	O
of	O
occlusions	O
arises	O
,	O
in	O
which	O
the	O
scene	O
may	O
obscure	O
parts	O
of	O
the	O
model	O
.	O
an	O
example	O
of	O
video	O
augmentation	B
is	O
shown	O
in	O
ﬁgure	O
1.7.	O
part	O
0	O
the	O
background	O
:	O
projective	B
geometry	O
,	O
transformations	O
and	O
estimation	B
la	O
reproduction	B
interdite	O
(	O
the	O
forbidden	O
reproduction	B
)	O
,	O
1937	O
,	O
ren´e	O
magritte	O
.	O
courtesy	O
of	O
museum	O
boijmans	O
van	O
beuningen	O
,	O
rotterdam	O
.	O
c	O
(	O
cid:4	O
)	O
adagp	O
,	O
paris	O
,	O
and	O
dacs	O
,	O
london	O
2000.	O
outline	O
the	O
four	O
chapters	O
in	O
this	O
part	O
lay	O
the	O
foundation	O
for	O
the	O
representations	O
,	O
terminology	B
,	O
and	O
notation	O
that	O
will	O
be	O
used	O
in	O
the	O
subsequent	O
parts	O
of	O
the	O
book	O
.	O
the	O
ideas	O
and	O
notation	O
of	O
projective	O
geometry	O
are	O
central	O
to	O
an	O
analysis	O
of	O
multiple	O
view	O
geometry	O
.	O
for	O
example	O
,	O
the	O
use	O
of	O
homogeneous	O
coordinates	O
enables	O
non-linear	B
mappings	O
(	O
such	O
as	O
perspective	O
projection	B
)	O
to	O
be	O
represented	O
by	O
linear	B
matrix	O
equations	O
,	O
and	O
points	O
at	O
inﬁnity	O
to	O
be	O
represented	O
quite	O
naturally	O
avoiding	O
the	O
awkward	O
necessity	O
of	O
taking	O
limits	O
.	O
chapter	O
2	O
introduces	O
projective	B
transformations	O
of	O
2-space	O
.	O
these	O
are	O
the	O
transfor-	O
mations	O
that	O
arise	O
when	O
a	O
plane	B
is	O
imaged	O
by	O
a	O
perspective	O
camera	B
.	O
this	O
chapter	O
is	O
more	O
introductory	O
and	O
sets	O
the	O
scene	O
for	O
the	O
geometry	O
of	O
3-space	O
.	O
most	O
of	O
the	O
concepts	O
can	O
be	O
more	O
easily	O
understood	O
and	O
visualized	O
in	O
2d	O
than	O
in	O
3d	O
.	O
specializations	O
of	O
pro-	O
jective	O
transformations	O
are	O
introduced	O
,	O
including	O
afﬁne	B
and	O
similarity	B
transformations	O
.	O
particular	O
attention	O
is	O
focussed	O
on	O
the	O
recovery	O
of	O
afﬁne	B
properties	I
(	O
e.g	O
.	O
parallel	B
lines	I
)	O
and	O
metric	B
properties	I
(	O
e.g	O
.	O
angles	O
between	O
lines	O
)	O
from	O
a	O
perspective	O
image	O
.	O
chapter	O
3	O
covers	O
the	O
projective	B
geometry	O
of	O
3-space	O
.	O
this	O
geometry	O
develops	O
in	O
much	O
the	O
same	O
manner	O
as	O
that	O
of	O
2-space	O
,	O
though	O
of	O
course	O
there	O
are	O
extra	O
properties	B
arising	O
from	O
the	O
additional	O
dimension	O
.	O
the	O
main	O
new	O
geometry	O
here	O
is	O
the	O
plane	O
at	O
inﬁnity	O
and	O
the	O
absolute	O
conic	O
.	O
chapter	O
4	O
introduces	O
estimation	B
of	I
geometry	O
from	O
image	O
measurements	O
,	O
which	O
is	O
one	O
of	O
the	O
main	O
topics	O
of	O
this	O
book	O
.	O
the	O
example	O
of	O
estimating	O
a	O
projective	B
transfor-	O
mation	O
from	O
point	O
correspondences	O
is	O
used	O
to	O
illustrate	O
the	O
basis	O
and	O
motivation	O
for	O
the	O
algorithms	O
that	O
will	O
be	O
used	O
throughout	O
the	O
book	O
.	O
the	O
important	O
issue	O
of	O
what	O
should	O
be	O
minimized	O
in	O
a	O
cost	B
function	I
,	O
e.g	O
.	O
algebraic	B
or	O
geometric	B
or	O
statistical	O
measures	O
,	O
is	O
described	O
at	O
length	O
.	O
the	O
chapter	O
also	O
introduces	O
the	O
idea	O
of	O
robust	O
estimation	B
,	O
and	O
the	O
use	O
of	O
such	O
techniques	O
in	O
the	O
automatic	O
estimation	B
of	I
transformations	O
.	O
chapter	O
5	O
describes	O
how	O
the	O
results	O
of	O
estimation	B
algorithms	O
may	O
be	O
evaluated	O
.	O
in	O
particular	O
how	O
the	O
covariance	B
of	O
an	O
estimation	B
may	O
be	O
computed	O
.	O
24	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
this	O
chapter	O
introduces	O
the	O
main	O
geometric	B
ideas	O
and	O
notation	O
that	O
are	O
required	O
to	O
un-	O
derstand	O
the	O
material	O
covered	O
in	O
this	O
book	O
.	O
some	O
of	O
these	O
ideas	O
are	O
relatively	O
familiar	O
,	O
such	O
as	O
vanishing	O
point	B
formation	O
or	O
representing	O
conics	O
,	O
whilst	O
others	O
are	O
more	O
es-	O
oteric	O
,	O
such	O
as	O
using	O
circular	B
points	I
to	O
remove	O
perspective	O
distortion	B
from	O
an	O
image	O
.	O
these	O
ideas	O
can	O
be	O
understood	O
more	O
easily	O
in	O
the	O
planar	O
(	O
2d	O
)	O
case	O
because	O
they	O
are	O
more	O
easily	O
visualized	O
here	O
.	O
the	O
geometry	O
of	O
3-space	O
,	O
which	O
is	O
the	O
subject	O
of	O
the	O
later	O
parts	O
of	O
this	O
book	O
,	O
is	O
only	O
a	O
simple	O
generalization	O
of	O
this	O
planar	O
case	O
.	O
in	O
particular	O
,	O
the	O
chapter	O
covers	O
the	O
geometry	O
of	O
projective	O
transformations	B
of	I
the	O
plane	B
.	O
these	O
transformations	O
model	O
the	O
geometric	B
distortion	O
which	O
arises	O
when	O
a	O
plane	B
is	O
imaged	O
by	O
a	O
perspective	O
camera	B
.	O
under	O
perspective	O
imaging	O
certain	O
geometric	B
prop-	O
erties	O
are	O
preserved	O
,	O
such	O
as	O
collinearity	O
(	O
a	O
straight	O
line	B
is	O
imaged	O
as	O
a	O
straight	O
line	B
)	O
,	O
whilst	O
others	O
are	O
not	O
,	O
for	O
example	O
parallel	B
lines	I
are	O
not	O
imaged	O
as	O
parallel	O
lines	B
in	O
general	O
.	O
projective	B
geometry	O
models	O
this	O
imaging	O
and	O
also	O
provides	O
a	O
mathematical	O
representation	B
appropriate	O
for	O
computations	O
.	O
we	O
begin	O
by	O
describing	O
the	O
representation	B
of	O
points	O
,	O
lines	B
and	O
conics	O
in	O
homoge-	O
neous	O
notation	O
,	O
and	O
how	O
these	O
entities	O
map	O
under	O
projective	B
transformations	O
.	O
the	O
line	B
at	I
inﬁnity	I
and	O
the	O
circular	B
points	I
are	O
introduced	O
,	O
and	O
it	O
is	O
shown	O
that	O
these	O
capture	O
the	O
afﬁne	B
and	O
metric	O
properties	O
of	O
the	O
plane	B
.	O
algorithms	O
for	O
rectifying	O
planes	O
are	O
then	O
given	O
which	O
enable	O
afﬁne	B
and	O
metric	B
properties	I
to	O
be	O
computed	O
from	O
images	O
.	O
we	O
end	O
with	O
a	O
description	O
of	O
ﬁxed	O
points	O
under	O
projective	B
transformations	O
.	O
2.1	O
planar	O
geometry	O
the	O
basic	O
concepts	O
of	O
planar	O
geometry	O
are	O
familiar	O
to	O
anyone	O
who	O
has	O
studied	O
math-	O
ematics	O
even	O
at	O
an	O
elementary	O
level	O
.	O
in	O
fact	O
,	O
they	O
are	O
so	O
much	O
a	O
part	O
of	O
our	O
everyday	O
experience	O
that	O
we	O
take	O
them	O
for	O
granted	O
.	O
at	O
an	O
elementary	O
level	O
,	O
geometry	O
is	O
the	O
study	O
of	B
points	I
and	O
lines	B
and	O
their	O
relationships	O
.	O
to	O
the	O
purist	O
,	O
the	O
study	O
of	O
geometry	O
ought	O
properly	O
to	O
be	O
carried	O
out	O
from	O
a	O
“	O
geomet-	O
ric	O
”	O
or	O
coordinate-free	O
viewpoint	O
.	O
in	O
this	O
approach	O
,	O
theorems	O
are	O
stated	O
and	O
proved	O
in	O
terms	O
of	O
geometric	O
primitives	O
only	O
,	O
without	O
the	O
use	O
of	O
algebra	O
.	O
the	O
classical	O
approach	O
of	O
euclid	O
is	O
an	O
example	O
of	O
this	O
method	O
.	O
since	O
descartes	O
,	O
however	O
,	O
it	O
has	O
been	O
seen	O
that	O
geometry	O
may	O
be	O
algebraicized	O
,	O
and	O
indeed	O
the	O
theory	O
of	O
geometry	O
may	O
be	O
developed	O
25	O
26	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
from	O
an	O
algebraic	B
viewpoint	O
.	O
our	O
approach	O
in	O
this	O
book	O
will	O
be	O
a	O
hybrid	O
approach	O
,	O
sometimes	O
using	O
geometric	O
,	O
and	O
sometimes	O
algebraic	B
methods	O
.	O
in	O
the	O
algebraic	B
ap-	O
proach	O
,	O
geometric	B
entities	O
are	O
described	O
in	O
terms	O
of	O
coordinates	O
and	O
algebraic	B
entities	O
.	O
thus	O
,	O
for	O
instance	O
a	O
point	B
is	O
identiﬁed	O
with	O
a	O
vector	O
in	O
terms	O
of	O
some	O
coordinate	O
basis	O
.	O
a	O
line	B
is	O
also	O
identiﬁed	O
with	O
a	O
vector	O
,	O
and	O
a	O
conic	B
section	O
(	O
more	O
brieﬂy	O
,	O
a	O
conic	B
)	O
is	O
represented	O
by	O
a	O
symmetric	B
matrix	O
.	O
in	O
fact	O
,	O
we	O
often	O
carry	O
this	O
identiﬁcation	O
so	O
far	O
as	O
to	O
consider	O
that	O
the	O
vector	O
actually	O
is	O
a	O
point	B
,	O
or	O
the	O
symmetric	B
matrix	O
is	O
a	O
conic	B
,	O
at	O
least	O
for	O
convenience	O
of	O
language	O
.	O
a	O
signiﬁcant	O
advantage	O
of	O
the	O
algebraic	B
approach	O
to	O
geometry	O
is	O
that	O
results	O
derived	O
in	O
this	O
way	O
may	O
more	O
easily	O
be	O
used	O
to	O
derive	O
algo-	O
rithms	O
and	O
practical	O
computational	O
methods	O
.	O
computation	B
and	O
algorithms	O
are	O
a	O
major	O
concern	O
in	O
this	O
book	O
,	O
which	O
justiﬁes	O
the	O
use	O
of	O
the	O
algebraic	B
method	O
.	O
2.2	O
the	O
2d	O
projective	B
plane	I
as	O
we	O
all	O
know	O
,	O
a	O
point	B
in	O
the	O
plane	B
may	O
be	O
represented	O
by	O
the	O
pair	O
of	O
coordinates	O
(	O
x	O
,	O
y	O
)	O
in	O
ir2	O
.	O
thus	O
,	O
it	O
is	O
common	O
to	O
identify	O
the	O
plane	B
with	O
ir2	O
.	O
considering	O
ir2	O
as	O
a	O
vector	O
space	O
,	O
the	O
coordinate	O
pair	O
(	O
x	O
,	O
y	O
)	O
is	O
a	O
vector	O
–	O
a	O
point	B
is	O
identiﬁed	O
as	O
a	O
vector	O
.	O
in	O
this	O
section	O
we	O
introduce	O
the	O
homogeneous	O
notation	O
for	O
points	O
and	O
lines	B
on	O
a	O
plane	B
.	O
row	O
and	O
column	O
vectors	O
.	O
later	O
on	O
,	O
we	O
will	O
want	O
to	O
consider	O
linear	B
mappings	O
be-	O
tween	O
vector	O
spaces	O
,	O
and	O
represent	O
such	O
mappings	O
as	O
matrices	O
.	O
in	O
the	O
usual	O
manner	O
,	O
the	O
product	O
of	O
a	O
matrix	O
and	O
a	O
vector	O
is	O
another	O
vector	O
,	O
the	O
image	O
under	O
the	O
mapping	O
.	O
this	O
brings	O
up	O
the	O
distinction	O
between	O
“	O
column	O
”	O
and	O
“	O
row	O
”	O
vectors	O
,	O
since	O
a	O
matrix	B
may	O
be	O
multiplied	O
on	O
the	O
right	O
by	O
a	O
column	O
and	O
on	O
the	O
left	O
by	O
a	O
row	B
vector	I
.	O
geometric	B
entities	O
will	O
by	O
default	O
be	O
represented	O
by	O
column	O
vectors	O
.	O
a	O
bold-face	O
symbol	O
such	O
as	O
x	O
always	O
represents	O
a	O
column	B
vector	I
,	O
and	O
its	O
transpose	O
is	O
the	O
row	B
vector	I
xt	O
.	O
in	O
accordance	O
with	O
this	O
convention	O
,	O
a	O
point	B
in	O
the	O
plane	B
will	O
be	O
represented	O
by	O
the	O
column	B
vector	I
(	O
x	O
,	O
y	O
)	O
t	O
,	O
rather	O
than	O
its	O
transpose	O
,	O
the	O
row	B
vector	I
(	O
x	O
,	O
y	O
)	O
.	O
we	O
write	O
x	O
=	O
(	O
x	O
,	O
y	O
)	O
t	O
,	O
both	O
sides	O
of	O
this	O
equation	O
representing	O
column	O
vectors	O
.	O
2.2.1	O
points	O
and	O
lines	B
homogeneous	O
representation	B
of	O
lines	B
.	O
a	O
line	B
in	O
the	O
plane	B
is	O
represented	O
by	O
an	O
equa-	O
tion	O
such	O
as	O
ax	O
+by	O
+c	O
=	O
0	O
,	O
different	O
choices	O
of	O
a	O
,	O
b	O
and	O
c	O
giving	O
rise	O
to	O
different	O
lines	B
.	O
thus	O
,	O
a	O
line	B
may	O
naturally	O
be	O
represented	O
by	O
the	O
vector	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t.	O
the	O
correspondence	B
between	O
lines	B
and	O
vectors	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
is	O
not	O
one-to-one	O
,	O
since	O
the	O
lines	B
ax	O
+	O
by	O
+	O
c	O
=	O
0	O
and	O
(	O
ka	O
)	O
x	O
+	O
(	O
kb	O
)	O
y	O
+	O
(	O
kc	O
)	O
=	O
0	O
are	O
the	O
same	O
,	O
for	O
any	O
non-zero	O
constant	O
k.	O
thus	O
,	O
the	O
vectors	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
and	O
k	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
represent	O
the	O
same	O
line	O
,	O
for	O
any	O
non-zero	O
k.	O
in	O
fact	O
,	O
two	O
such	O
vectors	O
related	O
by	O
an	O
overall	O
scaling	B
are	O
considered	O
as	O
being	O
equivalent	B
.	O
an	O
equivalence	O
class	O
of	O
vectors	O
under	O
this	O
equivalence	O
relationship	O
is	O
known	O
as	O
a	O
homo-	O
geneous	O
vector	O
.	O
any	O
particular	O
vector	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
is	O
a	O
representative	O
of	O
the	O
equivalence	O
class	O
.	O
the	O
set	O
of	O
equivalence	O
classes	O
of	O
vectors	O
in	O
ir3	O
−	O
(	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
forms	O
the	O
projective	B
space	O
ip2	O
.	O
the	O
notation	O
−	O
(	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
indicates	O
that	O
the	O
vector	O
(	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
which	O
does	O
not	O
correspond	O
to	O
any	O
line	B
,	O
is	O
excluded	O
.	O
2.2	O
the	O
2d	O
projective	B
plane	I
27	O
homogeneous	B
representation	I
of	O
points	O
.	O
a	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
)	O
t	O
lies	O
on	O
the	O
line	B
l	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
if	O
and	O
only	O
if	O
ax	O
+	O
by	O
+	O
c	O
=	O
0.	O
this	O
may	O
be	O
written	O
in	O
terms	O
of	O
an	O
inner	O
product	O
of	O
vectors	O
representing	O
the	O
point	B
as	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
l	O
=	O
0	O
;	O
that	O
is	O
the	O
point	B
(	O
x	O
,	O
y	O
)	O
t	O
in	O
ir2	O
is	O
represented	O
as	O
a	O
3-vector	O
by	O
adding	O
a	O
ﬁnal	O
coordinate	O
of	O
1.	O
note	O
that	O
for	O
any	O
non-zero	O
constant	O
k	O
and	O
line	B
l	O
the	O
equation	O
(	O
kx	O
,	O
ky	O
,	O
k	O
)	O
l	O
=	O
0	O
if	O
and	O
only	O
if	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
l	O
=	O
0.	O
it	O
is	O
natural	O
,	O
therefore	O
,	O
to	O
consider	O
the	O
set	O
of	O
vectors	O
(	O
kx	O
,	O
ky	O
,	O
k	O
)	O
t	O
for	O
varying	O
values	O
of	O
k	O
to	O
be	O
a	O
representation	B
of	O
the	O
point	B
(	O
x	O
,	O
y	O
)	O
t	O
in	O
ir2	O
.	O
thus	O
,	O
just	O
as	O
with	O
lines	B
,	O
points	O
are	O
represented	O
by	O
homogeneous	O
vectors	O
.	O
an	O
arbitrary	O
homogeneous	O
vector	O
representative	O
of	O
a	O
point	O
is	O
of	O
the	O
form	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
,	O
representing	O
the	O
point	B
(	O
x1/x3	O
,	O
x2/x3	O
)	O
t	O
in	O
ir2	O
.	O
points	O
,	O
then	O
,	O
as	O
homogeneous	O
vectors	O
are	O
also	O
elements	O
of	O
ip2	O
.	O
one	O
has	O
a	O
simple	O
equation	O
to	O
determine	O
when	O
a	O
point	B
lies	O
on	B
a	I
line	I
,	O
namely	O
result	O
2.1.	O
the	O
point	B
x	O
lies	O
on	O
the	O
line	B
l	O
if	O
and	O
only	O
if	O
xtl	O
=	O
0.	O
note	O
that	O
the	O
expression	O
xtl	O
is	O
just	O
the	O
inner	O
or	O
scalar	O
product	O
of	O
the	O
two	O
vectors	O
l	O
and	O
x.	O
the	O
scalar	O
product	O
xtl	O
=	O
ltx	O
=	O
x.l	O
.	O
in	O
general	O
,	O
the	O
transpose	O
notation	O
ltx	O
will	O
be	O
preferred	O
,	O
but	O
occasionally	O
,	O
we	O
will	O
use	O
a	O
.	O
to	O
denote	O
the	O
inner	O
product	O
.	O
we	O
distinguish	O
between	O
the	O
homogeneous	O
coordinates	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
of	O
a	O
point	O
,	O
which	O
is	O
a	O
3-vector	O
,	O
and	O
the	O
inhomogeneous	O
coordinates	O
(	O
x	O
,	O
y	O
)	O
t	O
,	O
which	O
is	O
a	O
2-vector	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
degrees	B
of	I
freedom	I
(	O
dof	O
)	O
.	O
it	O
is	O
clear	O
that	O
in	O
order	O
to	O
specify	O
a	O
point	B
two	O
values	O
must	O
be	O
provided	O
,	O
namely	O
its	O
x-	O
and	O
y-coordinates	O
.	O
in	O
a	O
similar	O
manner	O
a	O
line	B
is	O
speciﬁed	O
by	O
two	O
parameters	O
(	O
the	O
two	O
independent	O
ratios	O
{	O
a	O
:	O
b	O
:	O
c	O
}	O
)	O
and	O
so	O
has	O
two	O
degrees	O
of	O
freedom	O
.	O
for	O
example	O
,	O
in	O
an	O
inhomogeneous	O
representation	O
,	O
these	O
two	O
parameters	O
could	O
be	O
chosen	O
as	O
the	O
gradient	O
and	O
y	O
intercept	O
of	O
the	O
line	O
.	O
intersection	B
of	O
lines	B
.	O
given	O
two	O
lines	O
l	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
and	O
l	O
(	O
cid:2	O
)	O
)	O
t	O
,	O
we	O
wish	O
to	O
ﬁnd	O
their	O
intersection	B
.	O
deﬁne	O
the	O
vector	O
x	O
=	O
l	O
×	O
l	O
(	O
cid:2	O
)	O
,	O
where	O
×	O
represents	O
the	O
vector	O
or	O
cross	B
product	I
.	O
from	O
the	O
triple	O
scalar	O
product	O
identity	O
l.	O
(	O
l	O
×	O
l	O
(	O
cid:2	O
)	O
)	O
=	O
0	O
,	O
we	O
see	O
that	O
ltx	O
=	O
l	O
(	O
cid:2	O
)	O
tx	O
=	O
0.	O
thus	O
,	O
if	O
x	O
is	O
thought	O
of	O
as	O
representing	O
a	O
point	B
,	O
then	O
x	O
lies	O
on	O
both	O
lines	B
l	O
and	O
l	O
(	O
cid:2	O
)	O
result	O
2.2.	O
the	O
intersection	B
of	O
two	O
lines	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
note	O
that	O
the	O
simplicity	O
of	O
this	O
expression	O
for	O
the	O
intersection	B
of	O
the	O
two	O
lines	O
is	O
a	O
direct	O
consequence	O
of	O
the	O
use	O
of	O
homogeneous	O
vector	O
representations	O
of	B
lines	I
and	O
points	O
.	O
example	O
2.3.	O
consider	O
the	O
simple	O
problem	O
of	O
determining	O
the	O
intersection	B
of	O
the	O
lines	B
x	O
=	O
1	O
and	O
y	O
=	O
1.	O
the	O
line	B
x	O
=	O
1	O
is	O
equivalent	B
to	O
−1x	O
+	O
1	O
=	O
0	O
,	O
and	O
thus	O
has	O
homogeneous	B
representation	I
l	O
=	O
(	O
−1	O
,	O
0	O
,	O
1	O
)	O
t.	O
the	O
line	B
y	O
=	O
1	O
is	O
equivalent	B
to	O
−1y+1	O
=	O
=	O
(	O
0	O
,	O
−1	O
,	O
1	O
)	O
t.	O
from	O
result	O
2.2	O
the	O
0	O
,	O
and	O
thus	O
has	O
homogeneous	B
representation	I
l	O
(	O
cid:2	O
)	O
intersection	B
point	O
is	O
,	O
and	O
hence	O
is	O
the	O
intersection	B
of	O
the	O
two	O
lines	O
.	O
this	O
shows	O
:	O
is	O
the	O
point	B
x	O
=	O
l	O
×	O
l	O
(	O
cid:2	O
)	O
=	O
(	O
a	O
,	O
b	O
)	O
=	O
l	O
(	O
cid:2	O
)	O
,	O
c	O
.	O
(	O
l	O
×	O
l	O
(	O
cid:2	O
)	O
.	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
x	O
=	O
l	O
×	O
l	O
(	O
cid:2	O
)	O
=	O
j	O
0	O
i	O
k	O
−1	O
1	O
0	O
−1	O
1	O
	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
=	O
	O
1	O
1	O
1	O
which	O
is	O
the	O
inhomogeneous	O
point	O
(	O
1	O
,	O
1	O
)	O
t	O
as	O
required	O
.	O
(	O
cid:2	O
)	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
28	O
line	B
joining	O
points	O
.	O
an	O
expression	O
for	O
the	O
line	B
passing	O
through	O
two	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
may	O
be	O
derived	O
by	O
an	O
entirely	O
analogous	O
argument	O
.	O
deﬁning	O
a	O
line	B
l	O
by	O
l	O
=	O
x	O
×	O
x	O
(	O
cid:2	O
)	O
,	O
it	O
may	O
be	O
veriﬁed	O
that	O
both	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
result	O
2.4.	O
the	O
line	B
through	O
two	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
is	O
l	O
=	O
x	O
×	O
x	O
(	O
cid:2	O
)	O
lie	O
on	O
l.	O
thus	O
.	O
2.2.2	O
ideal	O
points	O
and	O
the	O
line	B
at	I
inﬁnity	I
intersection	O
of	B
parallel	I
lines	I
.	O
consider	O
two	O
lines	O
ax+by+c	O
=	O
0	O
and	O
ax+by+c	O
=	O
0.	O
these	O
are	O
represented	O
by	O
vectors	O
l	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
and	O
l	O
(	O
cid:2	O
)	O
)	O
t	O
for	O
which	O
the	O
ﬁrst	O
two	O
coordinates	O
are	O
the	O
same	O
.	O
computing	B
the	O
intersection	B
of	O
these	O
lines	B
gives	O
no	O
difﬁculty	O
,	O
using	O
result	O
2.2.	O
the	O
intersection	B
is	O
l	O
×	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
−	O
c	O
)	O
(	O
b	O
,	O
−a	O
,	O
0	O
)	O
t	O
,	O
and	O
ignoring	O
the	O
scale	O
(	O
cid:2	O
)	O
−	O
c	O
)	O
,	O
this	O
is	O
the	O
point	B
(	O
b	O
,	O
−a	O
,	O
0	O
)	O
t.	O
factor	O
(	O
c	O
now	O
if	O
we	O
attempt	O
to	O
ﬁnd	O
the	O
inhomogeneous	O
representation	O
of	O
this	O
point	B
,	O
we	O
ob-	O
tain	O
(	O
b/0	O
,	O
−a/0	O
)	O
t	O
,	O
which	O
makes	O
no	O
sense	O
,	O
except	O
to	O
suggest	O
that	O
the	O
point	B
of	O
intersec-	O
tion	O
has	O
inﬁnitely	O
large	O
coordinates	B
.	O
in	O
general	O
,	O
points	O
with	O
homogeneous	O
coordinates	O
(	O
x	O
,	O
y	O
,	O
0	O
)	O
t	O
do	O
not	O
correspond	O
to	O
any	O
ﬁnite	B
point	O
in	O
ir2	O
.	O
this	O
observation	O
agrees	O
with	O
the	O
usual	O
idea	O
that	O
parallel	B
lines	I
meet	O
at	B
inﬁnity	I
.	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
=	O
(	O
c	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
example	O
2.5.	O
consider	O
the	O
two	O
lines	O
x	O
=	O
1	O
and	O
x	O
=	O
2.	O
here	O
the	O
two	O
lines	O
are	O
parallel	B
,	O
and	O
consequently	O
intersect	O
“	O
at	B
inﬁnity	I
”	O
.	O
in	O
homogeneous	O
notation	O
the	O
lines	B
are	O
l	O
=	O
(	O
−1	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
l	O
(	O
cid:2	O
)	O
=	O
(	O
−1	O
,	O
0	O
,	O
2	O
)	O
t	O
,	O
and	O
from	O
result	O
2.2	O
their	O
intersection	B
point	O
is	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
x	O
=	O
l	O
×	O
l	O
(	O
cid:2	O
)	O
=	O
i	O
j	O
k	O
−1	O
0	O
1	O
−1	O
0	O
2	O
	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
=	O
	O
0	O
1	O
0	O
which	O
is	O
the	O
point	B
at	O
inﬁnity	O
in	O
the	O
direction	O
of	O
the	O
y-axis	O
.	O
(	O
cid:2	O
)	O
ideal	O
points	O
and	O
the	O
line	B
at	I
inﬁnity	I
.	O
homogeneous	O
vectors	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
such	O
that	O
x3	O
(	O
cid:5	O
)	O
=	O
0	O
correspond	O
to	O
ﬁnite	O
points	O
in	O
ir2	O
.	O
one	O
may	O
augment	O
ir2	O
by	O
adding	O
points	O
with	O
last	O
coordinate	O
x3	O
=	O
0.	O
the	O
resulting	O
space	O
is	O
the	O
set	O
of	O
all	O
homogeneous	O
3-	O
vectors	O
,	O
namely	O
the	O
projective	B
space	O
ip2	O
.	O
the	O
points	O
with	O
last	O
coordinate	O
x3	O
=	O
0	O
are	O
known	O
as	O
ideal	O
points	O
,	O
or	O
points	O
at	O
inﬁnity	O
.	O
the	O
set	O
of	O
all	O
ideal	O
points	O
may	O
be	O
written	O
(	O
x1	O
,	O
x2	O
,	O
0	O
)	O
t	O
,	O
with	O
a	O
particular	O
point	B
speciﬁed	O
by	O
the	O
ratio	O
x1	O
:	O
x2	O
.	O
note	O
that	O
this	O
set	O
lies	O
on	O
a	O
single	O
line	B
,	O
the	O
line	B
at	I
inﬁnity	I
,	O
denoted	O
by	O
the	O
vector	O
l∞	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
indeed	O
,	O
one	O
veriﬁes	O
that	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
(	O
x1	O
,	O
x2	O
,	O
0	O
)	O
t	O
=	O
0.	O
using	O
result	O
2.2	O
one	O
ﬁnds	O
that	O
a	O
line	B
l	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
t	O
intersects	O
l∞	O
in	O
the	O
ideal	B
point	I
(	O
b	O
,	O
−a	O
,	O
0	O
)	O
t	O
(	O
since	O
(	O
b	O
,	O
−a	O
,	O
0	O
)	O
l	O
=	O
0	O
)	O
.	O
a	O
line	B
l	O
(	O
cid:2	O
)	O
)	O
t	O
parallel	B
to	O
l	O
intersects	O
l∞	O
in	O
the	O
same	O
ideal	O
point	B
(	O
b	O
,	O
−a	O
,	O
0	O
)	O
t	O
irrespective	O
of	O
the	O
value	O
of	O
c	O
.	O
in	O
inhomogeneous	O
notation	O
(	O
b	O
,	O
−a	O
)	O
t	O
is	O
a	O
vector	O
tangent	O
to	O
the	O
line	B
,	O
and	O
orthogonal	B
to	O
the	O
line	B
normal	O
(	O
a	O
,	O
b	O
)	O
,	O
and	O
so	O
represents	O
the	O
line	B
’	O
s	O
direction	O
.	O
as	O
the	O
line	B
’	O
s	O
direction	O
varies	O
the	O
ideal	B
point	I
(	O
b	O
,	O
−a	O
,	O
0	O
)	O
t	O
varies	O
over	O
l∞	O
.	O
for	O
these	O
reasons	O
the	O
line	B
at	I
inﬁnity	I
can	O
be	O
thought	O
of	O
as	O
the	O
set	O
of	O
directions	O
of	B
lines	I
in	O
the	O
plane	B
.	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
note	O
how	O
the	O
introduction	O
of	O
the	O
concept	O
of	B
points	I
at	O
inﬁnity	O
serves	O
to	O
simplify	O
the	O
intersection	B
properties	O
of	B
points	I
and	O
lines	B
.	O
in	O
the	O
projective	B
plane	I
ip2	O
,	O
one	O
may	O
state	O
without	O
qualiﬁcation	O
that	O
two	O
distinct	O
lines	B
meet	O
in	O
a	O
single	O
point	O
and	O
two	O
distinct	O
2.2	O
the	O
2d	O
projective	B
plane	I
29	O
x	O
2	O
ideal	B
point	I
x	O
1	O
l	O
x	O
o	O
π	O
x	O
3	O
fig	O
.	O
2.1.	O
a	O
model	B
of	O
the	O
projective	B
plane	I
.	O
points	O
and	O
lines	B
of	O
ip2	O
are	O
represented	O
by	O
rays	O
and	O
planes	O
,	O
respectively	O
,	O
through	O
the	O
origin	O
in	O
ir3	O
.	O
lines	B
lying	O
in	O
the	O
x1x2-plane	O
represent	O
ideal	O
points	O
,	O
and	O
the	O
x1x2-plane	O
represents	O
l∞	O
.	O
points	O
lie	O
on	O
a	O
single	O
line	B
.	O
this	O
is	O
not	O
true	O
in	O
the	O
standard	O
euclidean	B
geometry	I
of	O
ir2	O
,	O
in	O
which	O
parallel	B
lines	I
form	O
a	O
special	O
case	O
.	O
the	O
study	O
of	O
the	O
geometry	O
of	O
ip2	O
is	O
known	O
as	O
projective	B
geometry	O
.	O
in	O
a	O
coordinate-	O
free	O
purely	O
geometric	B
study	O
of	O
projective	O
geometry	O
,	O
one	O
does	O
not	O
make	O
any	O
distinction	O
between	O
points	O
at	B
inﬁnity	I
(	O
ideal	O
points	O
)	O
and	O
ordinary	O
points	O
.	O
it	O
will	O
,	O
however	O
,	O
serve	O
our	O
purposes	O
in	O
this	O
book	O
sometimes	O
to	O
distinguish	O
between	O
ideal	O
points	O
and	O
non-ideal	O
points	O
.	O
thus	O
,	O
the	O
line	B
at	I
inﬁnity	I
will	O
at	O
times	O
be	O
considered	O
as	O
a	O
special	O
line	O
in	B
projective	I
space	I
.	O
a	O
model	B
for	O
the	O
projective	B
plane	I
.	O
a	O
fruitful	O
way	O
of	O
thinking	O
of	O
ip2	O
is	O
as	O
a	O
set	O
of	O
rays	O
in	O
ir3	O
.	O
the	O
set	O
of	O
all	O
vectors	O
k	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
as	O
k	O
varies	O
forms	O
a	O
ray	O
through	O
the	O
origin	O
.	O
such	O
a	O
ray	O
may	O
be	O
thought	O
of	O
as	O
representing	O
a	O
single	O
point	O
in	O
ip2	O
.	O
in	O
this	O
model	B
,	O
the	O
lines	B
in	O
ip2	O
are	O
planes	O
passing	O
through	O
the	O
origin	O
.	O
one	O
veriﬁes	O
that	O
two	O
non-	O
identical	O
rays	O
lie	O
on	O
exactly	O
one	O
plane	B
,	O
and	O
any	O
two	O
planes	O
intersect	O
in	O
one	O
ray	O
.	O
this	O
is	O
the	O
analogue	O
of	O
two	O
distinct	O
points	O
uniquely	O
deﬁning	O
a	O
line	B
,	O
and	O
two	O
lines	O
always	O
intersecting	O
in	O
a	O
point	B
.	O
points	O
and	O
lines	B
may	O
be	O
obtained	O
by	O
intersecting	O
this	O
set	O
of	O
rays	O
and	O
planes	O
by	O
the	O
plane	B
x3	O
=	O
1.	O
as	O
illustrated	O
in	O
ﬁgure	O
2.1	O
the	O
rays	O
representing	O
ideal	O
points	O
and	O
the	O
plane	B
representing	O
l∞	O
are	O
parallel	B
to	O
the	O
plane	B
x3	O
=	O
1.	O
duality	B
.	O
the	O
reader	O
has	O
probably	O
noticed	O
how	O
the	O
role	O
of	B
points	I
and	O
lines	B
may	O
be	O
interchanged	O
in	O
statements	O
concerning	O
the	O
properties	B
of	O
lines	B
and	O
points	O
.	O
in	O
particular	O
,	O
the	O
basic	O
incidence	O
equation	O
ltx	O
=	O
0	O
for	O
line	O
and	O
point	B
is	O
symmetric	B
,	O
since	O
ltx	O
=	O
0	O
implies	O
xtl	O
=	O
0	O
,	O
in	O
which	O
the	O
positions	O
of	O
line	O
and	O
point	B
are	O
swapped	O
.	O
similarly	O
,	O
result	O
2.2	O
and	O
result	O
2.4	O
giving	O
the	O
intersection	B
of	O
two	O
lines	O
and	O
the	O
line	B
through	O
two	O
points	O
are	O
essentially	O
the	O
same	O
,	O
with	O
the	O
roles	O
of	B
points	I
and	O
lines	B
swapped	O
.	O
one	O
may	O
enunciate	O
a	O
general	O
principle	O
,	O
the	O
duality	B
principle	I
as	O
follows	O
:	O
30	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
result	O
2.6.	O
duality	B
principle	I
.	O
to	O
any	O
theorem	O
of	O
2-dimensional	O
projective	B
geometry	O
there	O
corresponds	O
a	O
dual	B
theorem	O
,	O
which	O
may	O
be	O
derived	O
by	O
interchanging	O
the	O
roles	O
of	B
points	I
and	O
lines	B
in	O
the	O
original	O
theorem	O
.	O
in	O
applying	O
this	O
principle	O
,	O
concepts	O
of	O
incidence	O
must	O
be	O
appropriately	O
translated	O
as	O
well	O
.	O
for	O
instance	O
,	O
the	O
line	B
through	O
two	O
points	O
is	O
dual	O
to	O
the	O
point	B
through	O
(	O
that	O
is	O
the	O
point	B
of	O
intersection	B
of	O
)	O
two	O
lines	O
.	O
note	O
that	O
is	O
it	O
not	O
necessary	O
to	O
prove	O
the	O
dual	B
of	O
a	O
given	O
theorem	O
once	O
the	O
original	O
theorem	O
has	O
been	O
proved	O
.	O
the	O
proof	O
of	O
the	O
dual	O
theorem	O
will	O
be	O
the	O
dual	B
of	O
the	O
proof	O
of	O
the	O
original	O
theorem	O
.	O
2.2.3	O
conics	O
and	O
dual	B
conics	O
a	O
conic	B
is	O
a	O
curve	O
described	O
by	O
a	O
second-degree	O
equation	O
in	O
the	O
plane	B
.	O
in	O
euclidean	O
geometry	O
conics	O
are	O
of	O
three	O
main	O
types	O
:	O
hyperbola	O
,	O
ellipse	O
,	O
and	O
parabola	O
(	O
apart	O
from	O
so-called	O
degenerate	B
conics	O
,	O
to	O
be	O
deﬁned	O
later	O
)	O
.	O
classically	O
these	O
three	O
types	O
of	B
conic	I
arise	O
as	O
conic	O
sections	O
generated	O
by	O
planes	O
of	O
differing	O
orientation	B
(	O
the	O
degenerate	B
con-	O
ics	O
arise	O
from	O
planes	O
which	O
contain	O
the	O
cone	O
vertex	O
)	O
.	O
however	O
,	O
it	O
will	O
be	O
seen	O
that	O
in	O
2d	O
projective	B
geometry	O
all	O
non-degenerate	O
conics	O
are	O
equivalent	B
under	O
projective	B
transformations	O
.	O
the	O
equation	O
of	O
a	O
conic	O
in	O
inhomogeneous	O
coordinates	B
is	O
ax2	O
+	O
bxy	O
+	O
cy2	O
+	O
dx	O
+	O
ey	O
+	O
f	O
=	O
0	O
i.e	O
.	O
a	O
polynomial	O
of	O
degree	O
2	O
.	O
“	O
homogenizing	O
”	O
this	O
by	O
the	O
replacements	O
:	O
x	O
(	O
cid:6	O
)	O
→	O
x1/x3	O
,	O
y	O
(	O
cid:6	O
)	O
→	O
x2/x3	O
gives	O
ax1	O
2	O
+	O
bx1x2	O
+	O
cx2	O
2	O
+	O
dx1x3	O
+	O
ex2x3	O
+	O
f	O
x3	O
2	O
=	O
0	O
or	O
in	O
matrix	O
form	O
(	O
2.1	O
)	O
(	O
2.2	O
)	O
(	O
2.3	O
)	O
where	O
the	O
conic	B
coefﬁcient	O
matrix	B
c	O
is	O
given	O
by	O
xtcx	O
=	O
0	O
	O
a	O
c	O
=	O
	O
.	O
b/2	O
d/2	O
e/2	O
c	O
f	O
b/2	O
d/2	O
e/2	O
note	O
that	O
the	O
conic	B
coefﬁcient	O
matrix	B
is	O
symmetric	B
.	O
as	O
in	O
the	O
case	O
of	O
the	O
homogeneous	O
representation	B
of	O
points	O
and	O
lines	B
,	O
only	O
the	O
ratios	O
of	O
the	O
matrix	O
elements	O
are	O
important	O
,	O
since	O
multiplying	O
c	O
by	O
a	O
non-zero	O
scalar	O
does	O
not	O
affect	O
the	O
above	O
equations	O
.	O
thus	O
c	O
is	O
a	O
homogeneous	B
representation	I
of	O
a	O
conic	B
.	O
the	O
conic	B
has	O
ﬁve	O
degrees	B
of	I
freedom	I
which	O
can	O
be	O
thought	O
of	O
as	O
the	O
ratios	O
{	O
a	O
:	O
b	O
:	O
c	O
:	O
d	O
:	O
e	O
:	O
f	O
}	O
or	O
equivalently	O
the	O
six	O
elements	O
of	O
a	O
symmetric	O
matrix	B
less	O
one	O
for	O
scale	O
.	O
five	O
points	O
deﬁne	O
a	O
conic	B
.	O
suppose	O
we	O
wish	O
to	O
compute	O
the	O
conic	B
which	O
passes	O
through	O
a	O
set	O
of	B
points	I
,	O
xi	O
.	O
how	O
many	O
points	O
are	O
we	O
free	O
to	O
specify	O
before	O
the	O
conic	B
is	O
determined	O
uniquely	O
?	O
the	O
question	O
can	O
be	O
answered	O
constructively	O
by	O
providing	O
an	O
(	O
cid:15	O
)	O
	O
(	O
cid:16	O
)	O
	O
c	O
=	O
0	O
2.2	O
the	O
2d	O
projective	B
plane	I
31	O
algorithm	B
to	O
determine	O
the	O
conic	B
.	O
from	O
(	O
2.1	O
)	O
each	O
point	B
xi	O
places	O
one	O
constraint	O
on	O
the	O
conic	B
coefﬁcients	O
,	O
since	O
if	O
the	O
conic	B
passes	O
through	O
(	O
xi	O
,	O
yi	O
)	O
then	O
2	O
+	O
dxi	O
+	O
eyi	O
+	O
f	O
=	O
0	O
.	O
2	O
+	O
bxiyi	O
+	O
cyi	O
axi	O
this	O
constraint	O
can	O
be	O
written	O
as	O
x2	O
i	O
xiyi	O
y2	O
i	O
xi	O
yi	O
1	O
c	O
=	O
0	O
where	O
c	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
,	O
e	O
,	O
f	O
)	O
t	O
is	O
the	O
conic	B
c	O
represented	O
as	O
a	O
6-vector	O
.	O
stacking	O
the	O
constraints	B
from	O
ﬁve	O
points	O
we	O
obtain	O
x2	O
1	O
x1y1	O
y2	O
x2	O
2	O
x2y2	O
y2	O
x2	O
3	O
x3y3	O
y2	O
x2	O
4	O
x4y4	O
y2	O
x2	O
5	O
x5y5	O
y2	O
1	O
x1	O
y1	O
1	O
2	O
x2	O
y2	O
1	O
3	O
x3	O
y3	O
1	O
4	O
x4	O
y4	O
1	O
5	O
x5	O
y5	O
1	O
(	O
2.4	O
)	O
and	O
the	O
conic	B
is	O
the	O
null	O
vector	O
of	O
this	O
5	O
×	O
6	O
matrix	B
.	O
this	O
shows	O
that	O
a	O
conic	B
is	O
deter-	O
mined	O
uniquely	O
(	O
up	O
to	O
scale	O
)	O
by	O
ﬁve	O
points	O
in	O
general	B
position	I
.	O
the	O
method	O
of	O
ﬁtting	O
a	O
geometric	B
entity	O
(	O
or	O
relation	B
)	O
by	O
determining	B
a	O
null	O
space	O
will	O
be	O
used	O
frequently	O
in	O
the	O
computation	B
chapters	O
throughout	O
this	O
book	O
.	O
tangent	B
lines	I
to	O
conics	O
.	O
the	O
line	B
l	O
tangent	O
to	O
a	O
conic	B
at	O
a	O
point	B
x	O
has	O
a	O
particularly	O
simple	O
form	O
in	O
homogeneous	O
coordinates	B
:	O
result	O
2.7.	O
the	O
line	B
l	O
tangent	O
to	O
c	O
at	O
a	O
point	B
x	O
on	O
c	O
is	O
given	O
by	O
l	O
=	O
cx	O
.	O
proof	O
.	O
the	O
line	B
l	O
=	O
cx	O
passes	O
through	O
x	O
,	O
since	O
ltx	O
=	O
xtcx	O
=	O
0.	O
if	O
l	O
has	O
one-point	O
contact	O
with	O
the	O
conic	B
,	O
then	O
it	O
is	O
a	O
tangent	O
,	O
and	O
we	O
are	O
done	O
.	O
otherwise	O
suppose	O
that	O
l	O
meets	O
the	O
conic	B
in	O
another	O
point	B
y.	O
then	O
ytcy	O
=	O
0	O
and	O
xtcy	O
=	O
lty	O
=	O
0.	O
from	O
this	O
it	O
follows	O
that	O
(	O
x	O
+	O
αy	O
)	O
tc	O
(	O
x	O
+	O
αy	O
)	O
=	O
0	O
for	O
all	O
α	O
,	O
which	O
means	O
that	O
the	O
whole	O
line	B
l	O
=	O
cx	O
joining	O
x	O
and	O
y	O
lies	O
on	O
the	O
conic	B
c	O
,	O
which	O
is	O
therefore	O
degenerate	B
(	O
see	O
below	O
)	O
.	O
dual	B
conics	O
.	O
the	O
conic	B
c	O
deﬁned	O
above	O
is	O
more	O
properly	O
termed	O
a	O
point	B
conic	O
,	O
as	O
it	O
deﬁnes	O
an	O
equation	O
on	O
points	O
.	O
given	O
the	O
duality	B
result	O
2.6	O
of	O
ip2	O
it	O
is	O
not	O
surprising	O
that	O
there	O
is	O
also	O
a	O
conic	B
which	O
deﬁnes	O
an	O
equation	O
on	O
lines	O
.	O
this	O
dual	B
(	O
or	O
line	B
)	O
conic	B
is	O
also	O
represented	O
by	O
a	O
3	O
×	O
3	O
matrix	B
,	O
which	O
we	O
denote	O
as	O
c∗	O
.	O
a	O
line	B
l	O
tangent	O
to	O
the	O
conic	B
c	O
satisﬁes	O
ltc∗l	O
=	O
0.	O
the	O
notation	O
c∗	O
indicates	O
that	O
c∗	O
is	O
the	O
adjoint	B
matrix	I
of	O
c	O
(	O
the	O
adjoint	O
is	O
deﬁned	O
in	O
section	O
a4.2	O
(	O
p580	O
)	O
of	O
appendix	O
4	O
(	O
p578	O
)	O
)	O
.	O
for	O
a	O
non-singular	O
symmetric	B
matrix	O
c∗	O
=	O
c−1	O
(	O
up	O
to	O
scale	O
)	O
.	O
the	O
equation	O
for	O
a	O
dual	O
conic	B
is	O
straightforward	O
to	O
derive	O
in	O
the	O
case	O
that	O
c	O
has	O
full	O
rank	O
:	O
from	O
result	O
2.7	O
,	O
at	O
a	O
point	B
x	O
on	O
c	O
the	O
tangent	O
is	O
l	O
=	O
cx	O
.	O
inverting	O
,	O
we	O
ﬁnd	O
the	O
point	B
x	O
at	O
which	O
the	O
line	B
l	O
is	O
tangent	O
to	O
c	O
is	O
x	O
=	O
c−1l	O
.	O
since	O
x	O
satisﬁes	O
xtcx	O
=	O
0	O
we	O
obtain	O
(	O
c−1l	O
)	O
tc	O
(	O
c−1l	O
)	O
=l	O
tc−1l	O
=	O
0	O
,	O
the	O
last	O
step	O
following	O
from	O
c−t	O
=	O
c−1	O
because	O
c	O
is	O
symmetric	B
.	O
dual	B
conics	O
are	O
also	O
known	O
as	O
conic	B
envelopes	O
,	O
and	O
the	O
reason	O
for	O
this	O
is	O
illustrated	O
32	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
a	O
b	O
fig	O
.	O
2.2	O
.	O
(	O
a	O
)	O
points	O
x	O
satisfying	O
xtcx	O
=	O
0	O
lie	O
on	O
a	O
point	O
conic	B
.	O
(	O
b	O
)	O
lines	B
l	O
satisfying	O
ltc∗l	O
=	O
0	O
are	O
tangent	O
to	O
the	O
point	B
conic	O
c.	O
the	O
conic	B
c	O
is	O
the	O
envelope	O
of	O
the	O
lines	O
l.	O
in	O
ﬁgure	O
2.2.	O
a	O
dual	B
conic	I
has	O
ﬁve	O
degrees	B
of	I
freedom	I
.	O
in	O
a	O
similar	O
manner	O
to	O
points	O
deﬁning	O
a	O
point	B
conic	O
,	O
it	O
follows	O
that	O
ﬁve	O
lines	B
in	O
general	B
position	I
deﬁne	O
a	O
dual	B
conic	I
.	O
degenerate	B
conics	O
.	O
if	O
the	O
matrix	B
c	O
is	O
not	O
of	O
full	O
rank	O
,	O
then	O
the	O
conic	B
is	O
termed	O
degen-	O
erate	O
.	O
degenerate	B
point	O
conics	O
include	O
two	O
lines	O
(	O
rank	O
2	O
)	O
,	O
and	O
a	O
repeated	O
line	B
(	O
rank	O
1	O
)	O
.	O
example	O
2.8.	O
the	O
conic	B
c	O
=	O
l	O
mt	O
+	O
m	O
lt	O
is	O
composed	O
of	O
two	O
lines	B
l	O
and	O
m.	O
points	O
on	O
l	O
satisfy	O
ltx	O
=	O
0	O
,	O
and	O
are	O
on	O
the	O
conic	B
since	O
xtcx	O
=	O
(	O
xtl	O
)	O
(	O
mtx	O
)	O
+	O
(	O
xtm	O
)	O
(	O
ltx	O
)	O
=	O
0.	O
similarly	O
,	O
points	O
satisfying	O
mtx	O
=	O
0	O
also	O
satisfy	O
xtcx	O
=	O
0.	O
the	O
matrix	B
c	O
is	O
symmetric	B
and	O
has	O
rank	O
2.	O
the	O
null	O
vector	O
is	O
x	O
=	O
l	O
×	O
m	O
which	O
is	O
the	O
intersection	B
point	O
of	O
l	O
and	O
m.	O
(	O
cid:2	O
)	O
degenerate	B
line	O
conics	O
include	O
two	O
points	O
(	O
rank	O
2	O
)	O
,	O
and	O
a	O
repeated	O
point	B
(	O
rank	O
1	O
)	O
.	O
for	O
example	O
,	O
the	O
line	B
conic	O
c∗	O
=	O
xyt	O
+	O
yxt	O
has	O
rank	O
2	O
and	O
consists	O
of	B
lines	I
passing	O
through	O
either	O
of	O
the	O
two	O
points	O
x	O
and	O
y.	O
note	O
that	O
for	O
matrices	O
that	O
are	O
not	O
invertible	O
(	O
c∗	O
∗	O
(	O
cid:5	O
)	O
=	O
c.	O
)	O
2.3	O
projective	B
transformations	O
in	O
the	O
view	O
of	O
geometry	O
set	O
forth	O
by	O
felix	O
klein	O
in	O
his	O
famous	O
“	O
erlangen	O
program	O
”	O
,	O
[	O
klein-39	O
]	O
,	O
geometry	O
is	O
the	O
study	O
of	O
properties	O
invariant	O
under	O
groups	O
of	O
transforma-	O
tions	O
.	O
from	O
this	O
point	B
of	O
view	O
,	O
2d	O
projective	B
geometry	O
is	O
the	O
study	O
of	O
properties	O
of	O
the	O
projective	O
plane	B
ip2	O
that	O
are	O
invariant	O
under	O
a	O
group	O
of	O
transformations	O
known	O
as	O
projectivities	O
.	O
a	O
projectivity	B
is	O
an	O
invertible	O
mapping	O
from	O
points	O
in	O
ip2	O
(	O
that	O
is	O
homogeneous	O
3-	O
vectors	O
)	O
to	O
points	O
in	O
ip2	O
that	O
maps	O
lines	B
to	O
lines	B
.	O
more	O
precisely	O
,	O
deﬁnition	B
2.9.	O
a	O
projectivity	B
is	O
an	O
invertible	O
mapping	O
h	O
from	O
ip2	O
to	O
itself	O
such	O
that	O
three	O
points	O
x1	O
,	O
x2	O
and	O
x3	O
lie	O
on	O
the	O
same	O
line	O
if	O
and	O
only	O
if	O
h	O
(	O
x1	O
)	O
,	O
h	O
(	O
x2	O
)	O
and	O
h	O
(	O
x3	O
)	O
do	O
.	O
projectivities	O
form	O
a	O
group	O
since	O
the	O
inverse	O
of	O
a	O
projectivity	O
is	O
also	O
a	O
projectivity	B
,	O
and	O
so	O
is	O
the	O
composition	O
of	O
two	O
projectivities	O
.	O
a	O
projectivity	B
is	O
also	O
called	O
a	O
collineation	B
2.3	O
projective	B
transformations	O
33	O
(	O
a	O
helpful	O
name	O
)	O
,	O
a	O
projective	B
transformation	I
or	O
a	O
homography	B
:	O
the	O
terms	O
are	O
synony-	O
mous	O
.	O
in	O
deﬁnition	O
2.9	O
,	O
a	O
projectivity	B
is	O
deﬁned	O
in	O
terms	O
of	O
a	O
coordinate-free	O
geometric	B
concept	O
of	O
point	O
line	B
incidence	O
.	O
an	O
equivalent	B
algebraic	O
deﬁnition	B
of	O
a	O
projectivity	B
is	O
possible	O
,	O
based	O
on	O
the	O
following	O
result	O
.	O
theorem	O
2.10.	O
a	O
mapping	O
h	O
:	O
ip2	O
→	O
ip2	O
is	O
a	O
projectivity	B
if	O
and	O
only	O
if	O
there	O
exists	O
a	O
non-singular	O
3	O
×	O
3	O
matrix	B
h	O
such	O
that	O
for	O
any	O
point	B
in	O
ip2	O
represented	O
by	O
a	O
vector	O
x	O
it	O
is	O
true	O
that	O
h	O
(	O
x	O
)	O
=	O
hx	O
.	O
to	O
interpret	O
this	O
theorem	O
,	O
any	O
point	B
in	O
ip2	O
is	O
represented	O
as	O
a	O
homogeneous	O
3-vector	O
,	O
x	O
,	O
and	O
hx	O
is	O
a	O
linear	B
mapping	O
of	O
homogeneous	O
coordinates	O
.	O
the	O
theorem	O
asserts	O
that	O
any	O
projectivity	B
arises	O
as	O
such	O
a	O
linear	B
transformation	O
in	O
homogeneous	O
coordinates	B
,	O
and	O
that	O
conversely	O
any	O
such	O
mapping	O
is	O
a	O
projectivity	B
.	O
the	O
theorem	O
will	O
not	O
be	O
proved	O
in	O
full	O
here	O
.	O
it	O
will	O
only	O
be	O
shown	O
that	O
any	O
invertible	O
linear	B
transformation	O
of	O
homoge-	O
neous	O
coordinates	B
is	O
a	O
projectivity	B
.	O
proof	O
.	O
let	O
x1	O
,	O
x2	O
and	O
x3	O
lie	O
on	B
a	I
line	I
l.	O
thus	O
ltxi	O
=	O
0	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
let	O
h	O
be	O
a	O
non-singular	O
3	O
×	O
3	O
matrix	B
.	O
one	O
veriﬁes	O
that	O
lth−1hxi	O
=	O
0.	O
thus	O
,	O
the	O
points	O
hxi	O
all	O
lie	O
on	O
the	O
line	B
h−tl	O
,	O
and	O
collinearity	O
is	O
preserved	O
by	O
the	O
transformation	B
.	O
the	O
converse	O
is	O
considerably	O
harder	O
to	O
prove	O
,	O
namely	O
that	O
each	O
projectivity	B
arises	O
in	O
this	O
way	O
.	O
as	O
a	O
result	O
of	O
this	O
theorem	O
,	O
one	O
may	O
give	O
an	O
alternative	O
deﬁnition	B
of	O
a	O
projective	B
transformation	I
(	O
or	O
collineation	B
)	O
as	O
follows	O
.	O
deﬁnition	B
2.11.	O
projective	B
transformation	I
.	O
a	O
planar	B
projective	I
transformation	I
is	O
a	O
linear	B
transformation	O
on	O
homogeneous	O
3-vectors	O
represented	O
by	O
a	O
non-singular	O
3	O
×	O
3	O
matrix	B
:	O
	O
=	O
	O
x	O
x	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1	O
(	O
cid:2	O
)	O
2	O
3	O
	O
h11	O
h12	O
h13	O
h21	O
h22	O
h23	O
h31	O
h32	O
h33	O
	O
	O
x1	O
x2	O
x3	O
	O
,	O
(	O
2.5	O
)	O
or	O
more	O
brieﬂy	O
,	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
.	O
note	O
that	O
the	O
matrix	B
h	O
occurring	O
in	O
this	O
equation	O
may	O
be	O
changed	O
by	O
multiplication	O
by	O
an	O
arbitrary	O
non-zero	O
scale	O
factor	O
without	O
altering	O
the	O
projective	B
transformation	I
.	O
consequently	O
we	O
say	O
that	O
h	O
is	O
a	O
homogeneous	O
matrix	O
,	O
since	O
as	O
in	O
the	O
homogeneous	B
representation	I
of	O
a	O
point	B
,	O
only	O
the	O
ratio	O
of	O
the	O
matrix	O
elements	O
is	O
signiﬁcant	O
.	O
there	O
are	O
eight	O
independent	O
ratios	O
amongst	O
the	O
nine	O
elements	O
of	O
h	O
,	O
and	O
it	O
follows	O
that	O
a	O
projective	B
transformation	I
has	O
eight	O
degrees	B
of	I
freedom	I
.	O
a	O
projective	B
transformation	I
projects	O
every	O
ﬁgure	O
into	O
a	O
projectively	O
equivalent	B
ﬁgure	O
,	O
leaving	O
all	O
its	O
projective	B
properties	O
invariant	O
.	O
in	O
the	O
ray	O
model	B
of	O
ﬁgure	O
2.1	O
a	O
projective	B
transformation	I
is	O
simply	O
a	O
linear	B
transformation	O
of	O
ir3	O
.	O
34	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
o	O
x	O
/	O
π	O
/	O
/	O
y	O
/	O
x	O
x	O
π	O
y	O
x	O
fig	O
.	O
2.3.	O
central	B
projection	I
maps	O
points	O
on	O
one	O
plane	B
to	O
points	O
on	O
another	O
plane	B
.	O
the	O
projection	B
also	O
maps	O
lines	B
to	O
lines	B
as	O
may	O
be	O
seen	O
by	O
considering	O
a	O
plane	B
through	O
the	O
projection	B
centre	O
which	O
inter-	O
sects	O
with	O
the	O
two	O
planes	O
π	O
and	O
π	O
(	O
cid:1	O
)	O
.	O
since	O
lines	B
are	O
mapped	O
to	O
lines	O
,	O
central	B
projection	I
is	O
a	O
projectivity	B
and	O
may	O
be	O
represented	O
by	O
a	O
linear	B
mapping	O
of	O
homogeneous	O
coordinates	O
x	O
(	O
cid:1	O
)	O
=	O
hx	O
.	O
mappings	O
between	O
planes	O
.	O
as	O
an	O
example	O
of	O
how	O
theorem	O
2.10	O
may	O
be	O
applied	O
,	O
consider	O
ﬁgure	O
2.3.	O
projection	B
along	O
rays	O
through	O
a	O
common	O
point	B
(	O
the	O
centre	B
of	O
pro-	O
jection	O
)	O
deﬁnes	O
a	O
mapping	O
from	O
one	O
plane	B
to	O
another	O
.	O
it	O
is	O
evident	O
that	O
this	O
point-to-	O
point	B
mapping	O
preserves	O
lines	B
in	O
that	O
a	O
line	B
in	O
one	O
plane	B
is	O
mapped	O
to	O
a	O
line	B
in	O
the	O
other	O
.	O
if	O
a	O
coordinate	O
system	O
is	O
deﬁned	O
in	O
each	O
plane	B
and	O
points	O
are	O
represented	O
in	O
homoge-	O
neous	O
coordinates	B
,	O
then	O
the	O
central	B
projection	I
mapping	O
may	O
be	O
expressed	O
by	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
where	O
h	O
is	O
a	O
non-singular	O
3×	O
3	O
matrix	B
.	O
actually	O
,	O
if	O
the	O
two	O
coordinate	O
systems	O
deﬁned	O
in	O
the	O
two	O
planes	O
are	O
both	O
euclidean	O
(	O
rectilinear	O
)	O
coordinate	O
systems	O
then	O
the	O
mapping	O
deﬁned	O
by	O
central	B
projection	I
is	O
more	O
restricted	O
than	O
an	O
arbitrary	O
projective	B
transforma-	O
tion	O
.	O
it	O
is	O
called	O
a	O
perspectivity	O
rather	O
than	O
a	O
full	O
projectivity	O
,	O
and	O
may	O
be	O
represented	O
by	O
a	O
transformation	B
with	O
six	O
degrees	B
of	I
freedom	I
.	O
we	O
return	O
to	O
perspectivities	O
in	O
section	O
a7.4	O
(	O
p632	O
)	O
.	O
example	O
2.12.	O
removing	O
the	O
projective	O
distortion	B
from	O
a	O
perspective	O
image	O
of	O
a	O
plane	B
.	O
shape	O
is	O
distorted	O
under	O
perspective	O
imaging	O
.	O
for	O
instance	O
,	O
in	O
ﬁgure	O
2.4a	O
the	O
win-	O
dows	O
are	O
not	O
rectangular	O
in	O
the	O
image	O
,	O
although	O
the	O
originals	O
are	O
.	O
in	O
general	O
parallel	B
lines	I
on	O
a	O
scene	O
plane	O
are	O
not	O
parallel	B
in	O
the	O
image	O
but	O
instead	O
converge	O
to	O
a	O
ﬁnite	B
point	O
.	O
we	O
have	O
seen	O
that	O
a	O
central	B
projection	I
image	O
of	O
a	O
plane	O
(	O
or	O
section	O
of	O
a	O
plane	O
)	O
is	O
related	O
to	O
the	O
original	O
plane	B
via	O
a	O
projective	B
transformation	I
,	O
and	O
so	O
the	O
image	O
is	O
a	O
projective	B
distortion	O
of	O
the	O
original	O
.	O
it	O
is	O
possible	O
to	O
“	O
undo	O
”	O
this	O
projective	B
transforma-	O
tion	O
by	O
computing	B
the	O
inverse	O
transformation	B
and	O
applying	O
it	O
to	O
the	O
image	O
.	O
the	O
result	O
will	O
be	O
a	O
new	O
synthesized	O
image	O
in	O
which	O
the	O
objects	O
in	O
the	O
plane	B
are	O
shown	O
with	O
their	O
correct	O
geometric	B
shape	O
.	O
this	O
will	O
be	O
illustrated	O
here	O
for	O
the	O
front	O
of	O
the	O
building	O
of	O
ﬁgure	O
2.4a	O
.	O
note	O
that	O
since	O
the	O
ground	O
and	O
the	O
front	O
are	O
not	O
in	O
the	O
same	O
plane	O
,	O
the	O
projective	B
transformation	I
that	O
must	O
be	O
applied	O
to	O
rectify	O
the	O
front	O
is	O
not	O
the	O
same	O
as	O
the	O
one	O
used	O
for	O
the	O
ground	O
.	O
computation	B
of	I
a	O
projective	B
transformation	I
from	O
point-to-point	O
correspondences	B
will	O
be	O
considered	O
in	O
great	O
detail	O
in	O
chapter	O
4.	O
for	O
now	O
,	O
a	O
method	O
for	O
computing	O
the	O
trans-	O
2.3	O
projective	B
transformations	O
35	O
a	O
b	O
fig	O
.	O
2.4.	O
removing	O
perspective	O
distortion	B
.	O
(	O
a	O
)	O
the	O
original	O
image	O
with	O
perspective	O
distortion	B
–	O
the	O
lines	B
of	O
the	O
windows	O
clearly	O
converge	O
at	O
a	O
ﬁnite	B
point	O
.	O
(	O
b	O
)	O
synthesized	O
frontal	O
orthogonal	B
view	O
of	O
the	O
front	O
wall	O
.	O
the	O
image	O
(	O
a	O
)	O
of	O
the	O
wall	O
is	O
related	O
via	O
a	O
projective	B
transformation	I
to	O
the	O
true	O
geometry	O
of	O
the	O
wall	O
.	O
the	O
inverse	O
transformation	B
is	O
computed	O
by	O
mapping	O
the	O
four	O
imaged	O
window	O
corners	O
to	O
corners	O
of	O
an	O
appropriately	O
sized	O
rectangle	O
.	O
the	O
four	O
point	O
correspondences	B
determine	O
the	O
transformation	B
.	O
the	O
transformation	B
is	O
then	O
applied	O
to	O
the	O
whole	O
image	O
.	O
note	O
that	O
sections	O
of	O
the	O
image	O
of	O
the	O
ground	O
are	O
subject	O
to	O
a	O
further	O
projective	B
distortion	O
.	O
this	O
can	O
also	O
be	O
removed	O
by	O
a	O
projective	B
transformation	I
.	O
formation	O
is	O
brieﬂy	O
indicated	O
.	O
one	O
begins	O
by	O
selecting	O
a	O
section	O
of	O
the	O
image	O
corre-	O
sponding	O
to	O
a	O
planar	O
section	O
of	O
the	O
world	O
.	O
local	O
2d	O
image	O
and	O
world	O
coordinates	B
are	O
selected	O
as	O
shown	O
in	O
ﬁgure	O
2.3.	O
let	O
the	O
inhomogeneous	O
coordinates	O
of	O
a	O
pair	O
of	O
match-	O
ing	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
)	O
respectively	O
.	O
we	O
use	O
inhomogeneous	O
coordinates	B
here	O
instead	O
of	O
the	O
homogeneous	O
coordinates	B
of	O
the	O
points	O
,	O
because	O
it	O
is	O
these	O
inhomogeneous	O
coordinates	O
that	O
are	O
measured	O
directly	O
from	O
the	O
image	O
and	O
from	O
the	O
world	O
plane	B
.	O
the	O
projective	B
transformation	I
of	O
(	O
2.5	O
)	O
can	O
be	O
written	O
in	O
inhomogeneous	O
form	O
as	O
in	O
the	O
world	O
and	O
image	B
plane	I
be	O
(	O
x	O
,	O
y	O
)	O
and	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
(	O
cid:2	O
)	O
x	O
=	O
x	O
x	O
(	O
cid:2	O
)	O
1	O
(	O
cid:2	O
)	O
3	O
(	O
cid:2	O
)	O
2	O
(	O
cid:2	O
)	O
3	O
=	O
h11x	O
+	O
h12y	O
+	O
h13	O
h31x	O
+	O
h32y	O
+	O
h33	O
,	O
(	O
cid:2	O
)	O
y	O
=	O
x	O
x	O
=	O
h21x	O
+	O
h22y	O
+	O
h23	O
h31x	O
+	O
h32y	O
+	O
h33	O
.	O
each	O
point	B
correspondence	O
generates	O
two	O
equations	O
for	O
the	O
elements	O
of	O
h	O
,	O
which	O
after	O
multiplying	O
out	O
are	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
y	O
(	O
h31x	O
+	O
h32y	O
+	O
h33	O
)	O
=h	O
11x	O
+	O
h12y	O
+	O
h13	O
(	O
h31x	O
+	O
h32y	O
+	O
h33	O
)	O
=h	O
21x	O
+	O
h22y	O
+	O
h23	O
.	O
these	O
equations	O
are	O
linear	B
in	O
the	O
elements	O
of	O
h.	O
four	O
point	O
correspondences	B
lead	O
to	O
eight	O
such	O
linear	B
equations	I
in	O
the	O
entries	O
of	O
h	O
,	O
which	O
are	O
sufﬁcient	O
to	O
solve	O
for	O
h	O
up	O
to	O
an	O
insigniﬁcant	O
multiplicative	O
factor	O
.	O
the	O
only	O
restriction	O
is	O
that	O
the	O
four	O
points	O
must	O
be	O
in	O
“	O
general	B
position	I
”	O
,	O
which	O
means	O
that	O
no	O
three	O
points	O
are	O
collinear	O
.	O
the	O
inverse	O
of	O
the	O
transformation	O
h	O
computed	O
in	O
this	O
way	O
is	O
then	O
applied	O
to	O
the	O
whole	O
image	O
to	O
undo	O
the	O
effect	O
of	O
perspective	O
distortion	B
on	O
the	O
selected	O
plane	B
.	O
the	O
results	O
are	O
shown	O
(	O
cid:2	O
)	O
in	O
ﬁgure	O
2.4b	O
.	O
three	O
remarks	O
concerning	O
this	O
example	O
are	O
appropriate	O
:	O
ﬁrst	O
,	O
the	O
computation	B
of	I
the	O
rectifying	O
transformation	O
h	O
in	O
this	O
way	O
does	O
not	O
require	O
knowledge	O
of	O
any	O
of	O
the	O
camera	O
’	O
s	O
parameters	B
or	O
the	O
pose	O
of	O
the	O
plane	O
;	O
second	O
,	O
it	O
is	O
not	O
always	O
necessary	O
to	O
36	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
image	O
1	O
 	O
 	O
	O
	O
 	O
 	O
	O
 	O
	O
x	O
 	O
	O
 	O
	O
image	O
2	O
  	O
 	O
r	O
,	O
t	O
x	O
 	O
 	O
	O
 	O
	O
 	O
	O
 	O
	O
 	O
	O
 	O
	O
 	O
	O
x	O
 	O
	O
x	O
 	O
  	O
 	O
	O
 	O
x	O
 	O
	O
  	O
  	O
	O
  	O
	O
image	O
2	O
image	O
1	O
  	O
  	O
x	O
/	O
x	O
 	O
	O
 	O
	O
 	O
x	O
a	O
 	O
	O
 	O
	O
planar	O
surface	O
b	O
c	O
fig	O
.	O
2.5.	O
examples	B
of	O
a	O
projective	B
transformation	I
,	O
x	O
(	O
cid:1	O
)	O
=	O
hx	O
,	O
arising	O
in	O
perspective	O
images	O
.	O
(	O
a	O
)	O
the	O
projective	B
transformation	I
between	O
two	O
images	O
induced	O
by	O
a	O
world	O
plane	B
(	O
the	O
concatenation	O
of	O
two	O
projective	B
transformations	O
is	O
a	O
projective	B
transformation	I
)	O
;	O
(	O
b	O
)	O
the	O
projective	B
transformation	I
between	O
two	O
images	O
with	O
the	O
same	O
camera	O
centre	O
(	O
e.g	O
.	O
a	O
camera	B
rotating	O
about	O
its	O
centre	B
or	O
a	O
camera	B
varying	O
its	O
focal	B
length	I
)	O
;	O
(	O
c	O
)	O
the	O
projective	B
transformation	I
between	O
the	O
image	O
of	O
a	O
plane	B
(	O
the	O
end	O
of	O
the	O
building	O
)	O
and	O
the	O
image	O
of	O
its	O
shadow	O
onto	O
another	O
plane	B
(	O
the	O
ground	O
plane	O
)	O
.	O
figure	O
(	O
c	O
)	O
courtesy	O
of	O
luc	O
van	O
gool	O
.	O
know	O
coordinates	B
for	O
four	O
points	O
in	O
order	O
to	O
remove	O
projective	B
distortion	O
:	O
alternative	O
approaches	O
,	O
which	O
are	O
described	O
in	O
section	O
2.7	O
,	O
require	O
less	O
,	O
and	O
different	O
types	O
of	O
,	O
information	O
;	O
third	O
,	O
superior	O
(	O
and	O
preferred	O
)	O
methods	O
for	O
computing	B
projective	O
transfor-	O
mations	O
are	O
described	O
in	O
chapter	O
4.	O
projective	B
transformations	O
are	O
important	O
mappings	O
representing	O
many	O
more	O
situa-	O
tions	O
than	O
the	O
perspective	O
imaging	O
of	O
a	O
world	O
plane	B
.	O
a	O
number	O
of	O
other	O
examples	B
are	O
illustrated	O
in	O
ﬁgure	O
2.5.	O
each	O
of	O
these	O
situations	O
is	O
covered	O
in	O
more	O
detail	O
later	O
in	O
the	O
book	O
.	O
2.3.1	O
transformations	B
of	I
lines	O
and	O
conics	O
transformation	B
of	O
lines	B
.	O
lie	O
on	B
a	I
line	I
l	O
,	O
then	O
the	O
transformed	O
points	O
x	O
(	O
cid:2	O
)	O
lie	O
on	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
tx	O
(	O
cid:2	O
)	O
under	O
the	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
lth−1hxi	O
=	O
0.	O
this	O
gives	O
the	O
transformation	B
rule	I
for	O
lines	B
:	O
=	O
hx	O
,	O
a	O
line	B
transforms	O
as	O
it	O
was	O
shown	O
in	O
the	O
proof	O
of	O
theorem	O
2.10	O
that	O
if	O
points	O
xi	O
i	O
=	O
hxi	O
under	O
a	O
projective	B
transformation	I
=	O
h−tl	O
.	O
in	O
this	O
way	O
,	O
incidence	O
of	O
points	O
on	O
lines	O
is	O
preserved	O
,	O
since	O
l	O
(	O
cid:2	O
)	O
=	O
h−tl	O
.	O
(	O
2.6	O
)	O
one	O
may	O
alternatively	O
write	O
l	O
(	O
cid:2	O
)	O
t	O
=	O
lth−1	O
.	O
note	O
the	O
fundamentally	O
different	O
way	O
in	O
which	O
lines	B
and	O
points	O
transform	O
.	O
points	O
transform	O
according	O
to	O
h	O
,	O
whereas	O
lines	B
(	O
as	O
rows	O
)	O
transform	O
according	O
to	O
h−1	O
.	O
this	O
may	O
be	O
explained	O
in	O
terms	O
of	O
“	O
covariant	O
”	O
or	O
“	O
contravariant	O
”	O
behaviour	O
.	O
one	O
says	O
that	O
points	O
transform	O
contravariantly	O
and	O
lines	B
transform	O
covariantly	O
.	O
this	O
distinction	O
will	O
be	O
taken	O
up	O
again	O
,	O
when	O
we	O
discuss	O
tensors	O
in	O
chapter	O
15	O
and	O
is	O
fully	O
explained	O
in	O
appendix	O
1	O
(	O
p562	O
)	O
.	O
transformation	B
of	O
conics	O
.	O
under	O
a	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
,	O
(	O
2.2	O
)	O
becomes	O
xtcx	O
=	O
x	O
(	O
cid:2	O
)	O
t	O
[	O
h−1	O
]	O
tch−1x	O
(	O
cid:2	O
)	O
=	O
x	O
(	O
cid:2	O
)	O
th−tch−1x	O
(	O
cid:2	O
)	O
2.4	O
a	O
hierarchy	B
of	I
transformations	O
37	O
a	O
b	O
c	O
fig	O
.	O
2.6.	O
distortions	O
arising	O
under	O
central	B
projection	I
.	O
images	O
of	O
a	O
tiled	O
ﬂoor	O
.	O
(	O
a	O
)	O
similarity	B
:	O
the	O
circular	O
pattern	O
is	O
imaged	O
as	O
a	O
circle	O
.	O
a	O
square	O
tile	O
is	O
imaged	O
as	O
a	O
square	O
.	O
lines	B
which	O
are	O
parallel	B
or	O
perpendicular	O
have	O
the	O
same	O
relative	O
orientation	B
in	O
the	O
image	O
.	O
(	O
b	O
)	O
afﬁne	B
:	O
the	O
circle	O
is	O
imaged	O
as	O
an	O
ellipse	O
.	O
orthogonal	B
world	O
lines	B
are	O
not	O
imaged	O
as	O
orthogonal	O
lines	B
.	O
however	O
,	O
the	O
sides	O
of	O
the	O
square	O
tiles	O
,	O
which	O
are	O
parallel	B
in	O
the	O
world	O
are	O
parallel	B
in	O
the	O
image	O
.	O
(	O
c	O
)	O
projective	B
:	O
parallel	B
world	O
lines	B
are	O
imaged	O
as	O
converging	O
lines	B
.	O
tiles	O
closer	O
to	O
the	O
camera	B
have	O
a	O
larger	O
image	O
than	O
those	O
further	O
away	O
.	O
which	O
is	O
a	O
quadratic	O
form	O
x	O
(	O
cid:2	O
)	O
tc	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
rule	O
for	O
a	O
conic	O
:	O
with	O
c	O
(	O
cid:2	O
)	O
=	O
h−tch−1	O
.	O
this	O
gives	O
the	O
transformation	B
transformation	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
,	O
a	O
conic	B
c	O
transforms	O
to	O
=	O
h−tch−1	O
.	O
result	O
2.13.	O
under	O
a	O
point	B
c	O
(	O
cid:2	O
)	O
the	O
presence	O
of	O
h−1	O
in	O
this	O
equation	O
may	O
be	O
expressed	O
by	O
saying	O
that	O
a	O
conic	B
transforms	O
covariantly	O
.	O
the	O
transformation	B
rule	I
for	O
a	O
dual	B
conic	I
is	O
derived	O
in	O
a	O
similar	O
manner	O
.	O
this	O
gives	O
:	O
result	O
2.14.	O
under	O
a	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
c∗	O
(	O
cid:2	O
)	O
=	O
hx	O
,	O
a	O
dual	B
conic	I
c∗	O
transforms	O
to	O
=	O
hc∗ht	O
.	O
2.4	O
a	O
hierarchy	B
of	I
transformations	O
in	O
this	O
section	O
we	O
describe	O
the	O
important	O
specializations	O
of	O
a	O
projective	O
transformation	B
and	O
their	O
geometric	B
properties	O
.	O
it	O
was	O
shown	O
in	O
section	O
2.3	O
that	O
projective	B
transforma-	O
tions	O
form	O
a	O
group	O
.	O
this	O
group	O
is	O
called	O
the	O
projective	B
linear	O
group	O
,	O
and	O
it	O
will	O
be	O
seen	O
that	O
these	O
specializations	O
are	O
subgroups	O
of	O
this	O
group	O
.	O
the	O
group	O
of	O
invertible	O
n	O
×	O
n	O
matrices	O
with	O
real	O
elements	O
is	O
the	O
(	O
real	O
)	O
general	O
linear	O
group	O
on	O
n	O
dimensions	O
,	O
or	O
gl	O
(	O
n	O
)	O
.	O
to	O
obtain	O
the	O
projective	B
linear	O
group	O
the	O
matrices	O
related	O
by	O
a	O
scalar	O
multiplier	O
are	O
identiﬁed	O
,	O
giving	O
p	O
l	O
(	O
n	O
)	O
(	O
this	O
is	O
a	O
quotient	O
group	O
of	O
gl	O
(	O
n	O
)	O
)	O
.	O
in	O
the	O
case	O
of	O
projective	O
transformations	B
of	I
the	O
plane	B
n	O
=	O
3.	O
the	O
important	O
subgroups	O
of	O
p	O
l	O
(	O
3	O
)	O
include	O
the	O
afﬁne	B
group	O
,	O
which	O
is	O
the	O
subgroup	O
of	O
p	O
l	O
(	O
3	O
)	O
consisting	O
of	O
matrices	O
for	O
which	O
the	O
last	O
row	O
is	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
,	O
and	O
the	O
euclidean	O
group	O
,	O
which	O
is	O
a	O
subgroup	O
of	O
the	O
afﬁne	O
group	O
for	O
which	O
in	O
addition	O
the	O
upper	O
left	O
hand	O
2	O
×	O
2	O
matrix	B
is	O
orthogonal	B
.	O
one	O
may	O
also	O
identify	O
the	O
oriented	O
euclidean	O
group	O
in	O
which	O
the	O
upper	O
left	O
hand	O
2	O
×	O
2	O
matrix	B
has	O
determinant	O
1.	O
we	O
will	O
introduce	O
these	O
transformations	O
starting	O
from	O
the	O
most	O
specialized	O
,	O
the	O
isometries	B
,	O
and	O
progressively	O
generalizing	O
until	O
projective	B
transformations	O
are	O
reached	O
.	O
38	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
this	O
deﬁnes	O
a	O
hierarchy	B
of	I
transformations	O
.	O
the	O
distortion	B
effects	O
of	O
various	O
transfor-	O
mations	O
in	O
this	O
hierarchy	O
are	O
shown	O
in	O
ﬁgure	O
2.6.	O
some	O
transformations	B
of	I
interest	O
are	O
not	O
groups	O
,	O
for	O
example	O
,	O
perspectivities	O
(	O
be-	O
cause	O
the	O
composition	O
of	O
two	O
perspectivities	O
is	O
a	O
projectivity	B
,	O
not	O
a	O
perspectivity	O
)	O
.	O
this	O
point	B
is	O
covered	O
in	O
section	O
a7.4	O
(	O
p632	O
)	O
.	O
invariants	B
.	O
an	O
alternative	O
to	O
describing	O
the	O
transformation	B
algebraically	O
,	O
i.e	O
.	O
as	O
a	O
ma-	O
trix	O
acting	O
on	O
coordinates	O
of	O
a	O
point	O
or	O
curve	O
,	O
is	O
to	O
describe	O
the	O
transformation	B
in	O
terms	O
of	O
those	O
elements	O
or	O
quantities	O
that	O
are	O
preserved	O
or	O
invariant	O
.	O
a	O
(	O
scalar	O
)	O
invariant	O
of	O
a	O
geometric	O
conﬁguration	O
is	O
a	O
function	O
of	O
the	O
conﬁguration	O
whose	O
value	O
is	O
unchanged	O
by	O
a	O
particular	O
transformation	B
.	O
for	O
example	O
,	O
the	O
separation	O
of	O
two	O
points	O
is	O
unchanged	O
by	O
a	O
euclidean	O
transformation	O
(	O
translation	O
and	O
rotation	B
)	O
,	O
but	O
not	O
by	O
a	O
similarity	B
(	O
e.g	O
.	O
trans-	O
lation	O
,	O
rotation	O
and	O
isotropic	O
scaling	B
)	O
.	O
distance	B
is	O
thus	O
a	O
euclidean	O
,	O
but	O
not	O
similarity	B
invariant	O
.	O
the	O
angle	B
between	O
two	O
lines	O
is	O
both	O
a	O
euclidean	O
and	O
a	O
similarity	B
invariant	O
.	O
2.4.1	O
class	O
i	O
:	O
isometries	B
isometries	O
are	O
transformations	B
of	I
the	O
plane	B
ir2	O
that	O
preserve	O
euclidean	O
distance	B
(	O
from	O
iso	O
=	O
same	O
,	O
metric	B
=	O
measure	O
)	O
.	O
an	O
isometry	O
is	O
represented	O
as	O
	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
1	O
	O
=	O
	O
	O
cos	O
θ	O
−	O
sin	O
θ	O
tx	O
	O
sin	O
θ	O
cos	O
θ	O
	O
	O
x	O
	O
0	O
0	O
ty	O
1	O
y	O
1	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
t	O
r	O
0t	O
1	O
where	O
	O
=	O
±1	O
.	O
if	O
	O
=	O
1	O
then	O
the	O
isometry	O
is	O
orientation-preserving	O
and	O
is	O
a	O
euclidean	O
transformation	O
(	O
a	O
composition	O
of	O
a	O
translation	O
and	O
rotation	B
)	O
.	O
if	O
	O
=	O
−1	O
then	O
the	O
isome-	O
try	O
reverses	O
orientation	B
.	O
an	O
example	O
is	O
the	O
composition	O
of	O
a	O
reﬂection	O
,	O
represented	O
by	O
the	O
matrix	B
diag	O
(	O
−1	O
,	O
1	O
,	O
1	O
)	O
,	O
with	O
a	O
euclidean	O
transformation	O
.	O
euclidean	O
transformations	O
model	B
the	O
motion	O
of	O
a	O
rigid	O
object	O
.	O
they	O
are	O
by	O
far	O
the	O
most	O
important	O
isometries	B
in	O
practice	O
,	O
and	O
we	O
will	O
concentrate	O
on	O
these	O
.	O
however	O
,	O
the	O
orientation	B
reversing	O
isometries	B
often	O
arise	O
as	O
ambiguities	O
in	O
structure	O
recovery	O
.	O
a	O
planar	O
euclidean	O
transformation	B
can	O
be	O
written	O
more	O
concisely	O
in	O
block	O
form	O
as	O
x	O
(	O
cid:2	O
)	O
=	O
hex	O
=	O
(	O
2.7	O
)	O
where	O
r	O
is	O
a	O
2	O
×	O
2	O
rotation	B
matrix	O
(	O
an	O
orthogonal	B
matrix	O
such	O
that	O
rtr	O
=	O
rrt	O
=	O
i	O
)	O
,	O
t	O
a	O
translation	O
2-vector	O
,	O
and	O
0	O
a	O
null	O
2-vector	O
.	O
special	O
cases	O
are	O
a	O
pure	O
rotation	B
(	O
when	O
t	O
=	O
0	O
)	O
and	O
a	O
pure	O
translation	O
(	O
when	O
r	O
=	O
i	O
)	O
.	O
a	O
euclidean	O
transformation	O
is	O
also	O
known	O
as	O
a	O
displacement	O
.	O
x	O
a	O
planar	O
euclidean	O
transformation	B
has	O
three	O
degrees	B
of	I
freedom	I
,	O
one	O
for	O
the	O
rotation	O
and	O
two	O
for	O
the	O
translation	O
.	O
thus	O
three	O
parameters	B
must	O
be	O
speciﬁed	O
in	O
order	O
to	O
deﬁne	O
the	O
transformation	B
.	O
the	O
transformation	B
can	O
be	O
computed	O
from	O
two	O
point	B
correspon-	O
dences	O
.	O
invariants	B
.	O
the	O
invariants	B
are	O
very	O
familiar	O
,	O
for	O
instance	O
:	O
length	O
(	O
the	O
distance	B
be-	O
tween	O
two	O
points	O
)	O
,	O
angle	B
(	O
the	O
angle	B
between	O
two	O
lines	O
)	O
,	O
and	O
area	O
.	O
2.4	O
a	O
hierarchy	B
of	I
transformations	O
39	O
groups	O
and	O
orientation	B
.	O
an	O
isometry	O
is	O
orientation-preserving	O
if	O
the	O
upper	O
left	O
hand	O
2	O
×	O
2	O
matrix	B
has	O
determinant	O
1.	O
orientation-preserving	O
isometries	B
form	O
a	O
group	O
,	O
orientation-reversing	O
ones	O
do	O
not	O
.	O
this	O
distinction	O
applies	O
also	O
in	O
the	O
case	O
of	O
similarity	O
and	O
afﬁne	B
transformations	O
which	O
now	O
follow	O
.	O
2.4.2	O
class	O
ii	O
:	O
similarity	B
transformations	O
a	O
similarity	B
transformation	I
(	O
or	O
more	O
simply	O
a	O
similarity	B
)	O
is	O
an	O
isometry	O
composed	O
with	O
an	O
isotropic	B
scaling	O
.	O
in	O
the	O
case	O
of	O
a	O
euclidean	O
transformation	B
composed	O
with	O
a	O
scaling	B
(	O
i.e	O
.	O
no	O
reﬂection	O
)	O
the	O
similarity	B
has	O
matrix	B
representation	O
	O
.	O
	O
	O
x	O
y	O
1	O
	O
=	O
	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
1	O
	O
s	O
cos	O
θ	O
−s	O
sin	O
θ	O
tx	O
(	O
cid:18	O
)	O
s	O
cos	O
θ	O
s	O
sin	O
θ	O
ty	O
1	O
(	O
cid:17	O
)	O
0	O
0	O
x	O
(	O
cid:2	O
)	O
=	O
hsx	O
=	O
sr	O
t	O
0t	O
1	O
x	O
this	O
can	O
be	O
written	O
more	O
concisely	O
in	O
block	O
form	O
as	O
(	O
2.8	O
)	O
(	O
2.9	O
)	O
where	O
the	O
scalar	O
s	O
represents	O
the	O
isotropic	B
scaling	O
.	O
a	O
similarity	B
transformation	I
is	O
also	O
known	O
as	O
an	O
equi-form	O
transformation	B
,	O
because	O
it	O
preserves	O
“	O
shape	O
”	O
(	O
form	O
)	O
.	O
a	O
planar	O
similarity	O
transformation	B
has	O
four	O
degrees	O
of	O
freedom	O
,	O
the	O
scaling	B
accounting	O
for	O
one	O
more	O
degree	O
of	O
freedom	O
than	O
a	O
euclidean	O
transformation	O
.	O
a	O
similarity	B
can	O
be	O
computed	O
from	O
two	O
point	B
correspondences	O
.	O
invariants	B
.	O
the	O
invariants	B
can	O
be	O
constructed	O
from	O
euclidean	O
invariants	B
with	O
suitable	O
provision	O
being	O
made	O
for	O
the	O
additional	O
scaling	B
degree	O
of	O
freedom	O
.	O
angles	O
between	O
lines	O
are	O
not	O
affected	O
by	O
rotation	B
,	O
translation	O
or	O
isotropic	B
scaling	O
,	O
and	O
so	O
are	O
similarity	B
invariants	O
.	O
in	O
particular	O
parallel	B
lines	I
are	O
mapped	O
to	O
parallel	O
lines	B
.	O
the	O
length	O
between	O
two	O
points	O
is	O
not	O
a	O
similarity	B
invariant	O
,	O
but	O
the	O
ratio	O
of	O
two	O
lengths	O
is	O
an	O
invariant	O
,	O
because	O
the	O
scaling	B
of	O
the	O
lengths	O
cancels	O
out	O
.	O
similarly	O
a	O
ratio	O
of	O
areas	O
is	O
an	O
invariant	O
because	O
the	O
scaling	B
(	O
squared	O
)	O
cancels	O
out	O
.	O
metric	B
structure	I
.	O
a	O
term	O
that	O
will	O
be	O
used	O
frequently	O
in	O
the	O
discussion	O
on	O
reconstruc-	O
tion	O
(	O
chapter	O
10	O
)	O
is	O
metric	B
.	O
the	O
description	O
metric	B
structure	I
implies	O
that	O
the	O
structure	B
is	O
deﬁned	O
up	O
to	O
a	O
similarity	B
.	O
2.4.3	O
class	O
iii	O
:	O
afﬁne	B
transformations	O
an	O
afﬁne	B
transformation	I
(	O
or	O
more	O
simply	O
an	O
afﬁnity	O
)	O
is	O
a	O
non-singular	O
linear	B
transfor-	O
mation	O
followed	O
by	O
a	O
translation	O
.	O
it	O
has	O
the	O
matrix	B
representation	O
	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
1	O
	O
=	O
	O
a11	O
a12	O
a21	O
a22	O
0	O
0	O
	O
	O
x	O
	O
y	O
1	O
tx	O
ty	O
1	O
(	O
2.10	O
)	O
40	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
θ	O
rotation	B
a	O
φ	O
deformation	O
b	O
fig	O
.	O
2.7.	O
distortions	O
arising	O
from	O
a	O
planar	O
afﬁne	O
transformation	B
.	O
(	O
a	O
)	O
rotation	B
by	O
r	O
(	O
θ	O
)	O
.	O
(	O
b	O
)	O
a	O
defor-	O
mation	O
r	O
(	O
−φ	O
)	O
d	O
r	O
(	O
φ	O
)	O
.	O
note	O
,	O
the	O
scaling	B
directions	O
in	O
the	O
deformation	O
are	O
orthogonal	B
.	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
t	O
a	O
0t	O
1	O
x	O
or	O
in	O
block	O
form	O
x	O
(	O
cid:2	O
)	O
=	O
hax	O
=	O
(	O
2.11	O
)	O
with	O
a	O
a	O
2	O
×	O
2	O
non-singular	O
matrix	B
.	O
a	O
planar	O
afﬁne	O
transformation	B
has	O
six	O
degrees	B
of	I
freedom	I
corresponding	O
to	O
the	O
six	O
matrix	B
elements	O
.	O
the	O
transformation	B
can	O
be	O
com-	O
puted	O
from	B
three	I
point	I
correspondences	I
.	O
a	O
helpful	O
way	O
to	O
understand	O
the	O
geometric	B
effects	O
of	O
the	O
linear	O
component	O
a	O
of	O
an	O
afﬁne	B
transformation	I
is	O
as	O
the	O
composition	O
of	O
two	O
fundamental	O
transformations	O
,	O
namely	O
rotations	B
and	O
non-isotropic	B
scalings	O
.	O
the	O
afﬁne	B
matrix	I
a	O
can	O
always	O
be	O
decom-	O
posed	O
as	O
(	O
2.12	O
)	O
a	O
=	O
r	O
(	O
θ	O
)	O
r	O
(	O
−φ	O
)	O
d	O
r	O
(	O
φ	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
where	O
r	O
(	O
θ	O
)	O
and	O
r	O
(	O
φ	O
)	O
are	O
rotations	B
by	O
θ	O
and	O
φ	O
respectively	O
,	O
and	O
d	O
is	O
a	O
diagonal	O
matrix	B
:	O
d	O
=	O
0	O
λ1	O
0	O
λ2	O
.	O
this	O
decomposition	B
follows	O
directly	O
from	O
the	O
svd	O
(	O
section	O
a4.4	O
(	O
p585	O
)	O
)	O
:	O
writing	O
a	O
=	O
udvt	O
=	O
(	O
uvt	O
)	O
(	O
vdvt	O
)	O
=	O
r	O
(	O
θ	O
)	O
(	O
r	O
(	O
−φ	O
)	O
d	O
r	O
(	O
φ	O
)	O
)	O
,	O
since	O
u	O
and	O
v	O
are	O
orthogonal	B
matrices	I
.	O
the	O
afﬁne	B
matrix	I
a	O
is	O
hence	O
seen	O
to	O
be	O
the	O
concatenation	O
of	O
a	O
rotation	O
(	O
by	O
φ	O
)	O
;	O
a	O
scaling	B
by	O
λ1	O
and	O
λ2	O
respectively	O
in	O
the	O
(	O
rotated	O
)	O
x	O
and	O
y	O
directions	O
;	O
a	O
rotation	B
back	O
(	O
by	O
−φ	O
)	O
;	O
and	O
ﬁnally	O
another	O
rotation	B
(	O
by	O
θ	O
)	O
.	O
the	O
only	O
“	O
new	O
”	O
geometry	O
,	O
compared	O
to	O
a	O
similarity	B
,	O
is	O
the	O
non-isotropic	B
scaling	I
.	O
this	O
accounts	O
for	O
the	O
two	O
extra	O
degrees	B
of	I
freedom	I
possessed	O
by	O
an	O
afﬁnity	O
over	O
a	O
similarity	B
.	O
they	O
are	O
the	O
angle	B
φ	O
specifying	O
the	O
scaling	B
direction	O
,	O
and	O
the	O
ratio	O
of	O
the	O
scaling	O
parameters	B
λ1	O
:	O
λ2	O
.	O
the	O
essence	O
of	O
an	O
afﬁnity	O
is	O
this	O
scaling	B
in	O
orthogonal	B
directions	O
,	O
oriented	O
at	O
a	O
particular	O
angle	B
.	O
schematic	O
examples	B
are	O
given	O
in	O
ﬁgure	O
2.7	O
.	O
2.4	O
a	O
hierarchy	B
of	I
transformations	O
41	O
invariants	B
.	O
because	O
an	O
afﬁne	B
transformation	I
includes	O
non-isotropic	B
scaling	I
,	O
the	O
sim-	O
ilarity	O
invariants	B
of	O
length	O
ratios	O
and	O
angles	O
between	O
lines	O
are	O
not	O
preserved	O
under	O
an	O
afﬁnity	O
.	O
three	O
important	O
invariants	B
are	O
:	O
(	O
i	O
)	O
parallel	B
lines	I
.	O
consider	O
two	O
parallel	O
lines	B
.	O
these	O
intersect	O
at	O
a	O
point	B
(	O
x1	O
,	O
x2	O
,	O
0	O
)	O
t	O
at	B
inﬁnity	I
.	O
under	O
an	O
afﬁne	B
transformation	I
this	O
point	B
is	O
mapped	O
to	O
another	O
point	B
at	O
inﬁnity	O
.	O
consequently	O
,	O
the	O
parallel	B
lines	I
are	O
mapped	O
to	O
lines	O
which	O
still	O
intersect	O
at	B
inﬁnity	I
,	O
and	O
so	O
are	O
parallel	B
after	O
the	O
transformation	B
.	O
(	O
ii	O
)	O
ratio	O
of	O
lengths	O
of	O
parallel	O
line	O
segments	O
.	O
the	O
length	O
scaling	O
of	O
a	O
line	O
seg-	O
ment	O
depends	O
only	O
on	O
the	O
angle	B
between	O
the	O
line	B
direction	O
and	O
scaling	B
direc-	O
tions	O
.	O
suppose	O
the	O
line	B
is	O
at	O
angle	O
α	O
to	O
the	O
x-axis	O
of	O
the	O
orthogonal	O
scaling	B
2	O
sin2	O
α.	O
this	O
scaling	B
is	O
direction	O
,	O
then	O
the	O
scaling	B
magnitude	O
is	O
common	O
to	O
all	O
lines	B
with	O
the	O
same	O
direction	O
,	O
and	O
so	O
cancels	O
out	O
in	O
a	O
ratio	O
of	O
parallel	O
segment	O
lengths	O
.	O
λ2	O
1	O
cos2	O
α	O
+	O
λ2	O
(	O
cid:19	O
)	O
(	O
iii	O
)	O
ratio	O
of	O
areas	O
.	O
this	O
invariance	O
can	O
be	O
deduced	O
directly	O
from	O
the	O
decomposi-	O
tion	O
(	O
2.12	O
)	O
.	O
rotations	B
and	O
translations	O
do	O
not	O
affect	O
area	O
,	O
so	O
only	O
the	O
scalings	O
by	O
λ1	O
and	O
λ2	O
matter	O
here	O
.	O
the	O
effect	O
is	O
that	O
area	O
is	O
scaled	O
by	O
λ1λ2	O
which	O
is	O
equal	O
to	O
det	O
a.	O
thus	O
the	O
area	O
of	O
any	O
shape	O
is	O
scaled	O
by	O
det	O
a	O
,	O
and	O
so	O
the	O
scaling	B
cancels	O
out	O
for	O
a	O
ratio	O
of	O
areas	O
.	O
it	O
will	O
be	O
seen	O
that	O
this	O
does	O
not	O
hold	O
for	O
a	O
projective	O
transformation	B
.	O
an	O
afﬁnity	O
is	O
orientation-preserving	O
or	O
-reversing	O
according	O
to	O
whether	O
det	O
a	O
is	O
positive	O
or	O
negative	O
respectively	O
.	O
since	O
det	O
a	O
=	O
λ1λ2	O
the	O
property	O
depends	O
only	O
on	O
the	O
sign	O
of	O
the	O
scalings	O
.	O
2.4.4	O
class	O
iv	O
:	O
projective	B
transformations	O
a	O
projective	B
transformation	I
was	O
deﬁned	O
in	O
(	O
2.5	O
)	O
.	O
it	O
is	O
a	O
general	O
non-singular	O
linear	B
transformation	O
of	O
homogeneous	O
coordinates	O
.	O
this	O
generalizes	O
an	O
afﬁne	B
transformation	I
,	O
which	O
is	O
the	O
composition	O
of	O
a	O
general	O
non-singular	O
linear	B
transformation	O
of	O
inhomoge-	O
neous	O
coordinates	B
and	O
a	O
translation	O
.	O
we	O
have	O
earlier	O
seen	O
the	O
action	O
of	O
a	O
projective	B
transformation	I
(	O
in	O
section	O
2.3	O
)	O
.	O
here	O
we	O
examine	O
its	O
block	O
form	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
x	O
(	O
cid:2	O
)	O
=	O
hpx	O
=	O
t	O
a	O
vt	O
v	O
x	O
(	O
2.13	O
)	O
where	O
the	O
vector	O
v	O
=	O
(	O
v1	O
,	O
v2	O
)	O
t.	O
the	O
matrix	B
has	O
nine	O
elements	O
with	O
only	O
their	O
ratio	O
signiﬁcant	O
,	O
so	O
the	O
transformation	B
is	O
speciﬁed	O
by	O
eight	O
parameters	B
.	O
note	O
,	O
it	O
is	O
not	O
always	O
possible	O
to	O
scale	O
the	O
matrix	B
such	O
that	O
v	O
is	O
unity	O
since	O
v	O
might	O
be	O
zero	O
.	O
a	O
projective	B
transformation	I
between	O
two	O
planes	O
can	O
be	O
computed	O
from	O
four	O
point	B
correspondences	O
,	O
with	O
no	O
three	O
collinear	O
on	O
either	O
plane	B
.	O
see	O
ﬁgure	O
2.4.	O
unlike	O
the	O
case	O
of	O
afﬁnities	O
,	O
it	O
is	O
not	O
possible	O
to	O
distinguish	O
between	O
orientation	O
preserving	O
and	O
orientation	B
reversing	O
projectivities	O
in	O
ip2	O
.	O
we	O
will	O
return	O
to	O
this	O
point	B
in	O
section	O
2.6	O
.	O
42	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
invariants	B
.	O
the	O
most	O
fundamental	O
projective	O
invariant	O
is	O
the	O
cross	B
ratio	I
of	O
four	O
collinear	O
points	O
:	O
a	O
ratio	O
of	O
lengths	O
on	B
a	I
line	I
is	O
invariant	O
under	O
afﬁnities	O
,	O
but	O
not	O
un-	O
der	O
projectivities	O
.	O
however	O
,	O
a	O
ratio	O
of	O
ratios	O
or	O
cross	B
ratio	I
of	O
lengths	O
on	B
a	I
line	I
is	O
a	O
projective	B
invariant	O
.	O
we	O
return	O
to	O
properties	O
of	O
this	O
invariant	O
in	O
section	O
2.5	O
.	O
2.4.5	O
summary	B
and	O
comparison	O
afﬁnities	O
(	O
6	O
dof	O
)	O
occupy	O
the	O
middle	O
ground	O
between	O
similarities	O
(	O
4	O
dof	O
)	O
and	O
projectivi-	O
ties	O
(	O
8	O
dof	O
)	O
.	O
they	O
generalize	O
similarities	O
in	O
that	O
angles	O
are	O
not	O
preserved	O
,	O
so	O
that	O
shapes	O
are	O
skewed	O
under	O
the	O
transformation	B
.	O
on	O
the	O
other	O
hand	O
their	O
action	O
is	O
homogeneous	O
over	O
the	O
plane	B
:	O
for	O
a	O
given	O
afﬁnity	O
the	O
det	O
a	O
scaling	B
in	O
area	O
of	O
an	O
object	O
(	O
e.g	O
.	O
a	O
square	O
)	O
is	O
the	O
same	O
anywhere	O
on	O
the	O
plane	B
;	O
and	O
the	O
orientation	B
of	O
a	O
transformed	O
line	B
depends	O
only	O
on	O
its	O
initial	O
orientation	O
,	O
not	O
on	O
its	O
position	O
on	O
the	O
plane	B
.	O
in	O
contrast	O
,	O
for	O
a	O
given	O
projective	B
transformation	I
,	O
area	O
scaling	B
varies	O
with	O
position	O
(	O
e.g	O
.	O
under	O
perspective	O
a	O
more	O
distant	O
square	O
on	O
the	O
plane	B
has	O
a	O
smaller	O
image	O
than	O
one	O
that	O
is	O
nearer	O
,	O
as	O
in	O
ﬁgure	O
2.6	O
)	O
;	O
and	O
the	O
orientation	B
of	O
a	O
transformed	O
line	B
depends	O
on	O
both	O
the	O
orientation	B
and	O
position	O
of	O
the	O
source	O
line	B
(	O
however	O
,	O
it	O
will	O
be	O
seen	O
later	O
in	O
section	O
8.6	O
(	O
p213	O
)	O
that	O
a	O
line	B
’	O
s	O
vanishing	O
point	O
depends	O
only	O
on	O
line	O
orientation	B
,	O
not	O
position	O
)	O
.	O
the	O
key	O
difference	O
between	O
a	O
projective	B
and	O
afﬁne	B
transformation	I
is	O
that	O
the	O
vector	O
v	O
is	O
not	O
null	O
for	O
a	O
projectivity	O
.	O
this	O
is	O
responsible	O
for	O
the	O
non-linear	B
effects	O
of	O
the	O
projectivity	O
.	O
compare	O
the	O
mapping	O
of	O
an	O
ideal	B
point	I
(	O
x1	O
,	O
x2	O
,	O
0	O
)	O
t	O
under	O
an	O
afﬁnity	O
and	O
projectivity	B
:	O
first	O
the	O
afﬁne	B
transformation	I
	O
=	O
	O
a	O
(	O
cid:18	O
)	O
	O
x1	O
	O
a	O
	O
=	O
(	O
cid:18	O
)	O
	O
x1	O
x2	O
0	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
x1	O
x2	O
0	O
x1	O
x2	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
	O
.	O
	O
.	O
v1x1	O
+	O
v2x2	O
t	O
a	O
vt	O
v	O
x2	O
0	O
(	O
2.14	O
)	O
(	O
2.15	O
)	O
t	O
a	O
0t	O
1	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
second	O
the	O
projective	B
transformation	I
in	O
the	O
ﬁrst	O
case	O
the	O
ideal	B
point	I
remains	O
ideal	O
(	O
i.e	O
.	O
at	B
inﬁnity	I
)	O
.	O
in	O
the	O
second	O
it	O
is	O
mapped	O
to	O
a	O
ﬁnite	B
point	O
.	O
it	O
is	O
this	O
ability	O
which	O
allows	O
a	O
projective	B
transformation	I
to	O
model	B
vanishing	O
points	O
.	O
2.4.6	O
decomposition	B
of	I
a	O
projective	B
transformation	I
a	O
projective	B
transformation	I
can	O
be	O
decomposed	O
into	O
a	O
chain	O
of	O
transformations	O
,	O
where	O
each	O
matrix	B
in	O
the	O
chain	O
represents	O
a	O
transformation	B
higher	O
in	O
the	O
hierarchy	O
than	O
the	O
previous	O
one	O
.	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
h	O
=	O
hs	O
ha	O
hp	O
=	O
sr	O
t	O
0t	O
1	O
k	O
0	O
0t	O
1	O
0	O
i	O
vt	O
v	O
=	O
t	O
a	O
vt	O
v	O
(	O
2.16	O
)	O
with	O
a	O
a	O
non-singular	O
matrix	B
given	O
by	O
a	O
=	O
srk	O
+	O
tvt	O
,	O
and	O
k	O
an	O
upper-triangular	O
matrix	B
normalized	O
as	O
det	O
k	O
=	O
1.	O
this	O
decomposition	B
is	O
valid	O
provided	O
v	O
(	O
cid:5	O
)	O
=	O
0	O
,	O
and	O
is	O
unique	O
if	O
s	O
is	O
chosen	O
positive	O
.	O
2.4	O
a	O
hierarchy	B
of	I
transformations	O
43	O
each	O
of	O
the	O
matrices	O
hs	O
,	O
ha	O
,	O
hp	O
is	O
the	O
“	O
essence	O
”	O
of	B
a	I
transformation	I
of	O
that	O
type	O
(	O
as	O
indicated	O
by	O
the	O
subscripts	O
s	O
,	O
a	O
,	O
p	O
)	O
.	O
consider	O
the	O
process	O
of	O
rectifying	O
the	O
perspective	O
image	O
of	O
a	O
plane	B
as	O
in	O
example	O
2.12	O
:	O
hp	O
(	O
2	O
dof	O
)	O
moves	O
the	O
line	B
at	I
inﬁnity	I
;	O
ha	O
(	O
2	O
dof	O
)	O
affects	O
the	O
afﬁne	B
properties	I
,	O
but	O
does	O
not	O
move	O
the	O
line	B
at	I
inﬁnity	I
;	O
and	O
ﬁnally	O
,	O
hs	O
is	O
a	O
general	O
similarity	O
transformation	B
(	O
4	O
dof	O
)	O
which	O
does	O
not	O
affect	O
the	O
afﬁne	B
or	O
projective	B
properties	O
.	O
the	O
transformation	B
hp	O
is	O
an	O
elation	B
,	O
described	O
in	O
section	O
a7.3	O
(	O
p631	O
)	O
.	O
example	O
2.15.	O
the	O
projective	B
transformation	I
h	O
=	O
2.707	O
8.242	O
2.0	O
1.0	O
1.0	O
	O
1.707	O
0.586	O
1.0	O
	O
	O
0.5	O
1	O
0	O
	O
2.0	O
0	O
0	O
2	O
0	O
0	O
1	O
1	O
2	O
1	O
may	O
be	O
decomposed	O
as	O
	O
2	O
cos	O
45	O
◦	O
−2	O
sin	O
45	O
◦	O
◦	O
◦	O
2	O
sin	O
45	O
2	O
cos	O
45	O
0	O
0	O
h	O
=	O
	O
	O
1	O
0	O
0	O
0	O
1	O
0	O
1	O
2	O
1	O
	O
.	O
(	O
cid:2	O
)	O
this	O
decomposition	B
can	O
be	O
employed	O
when	O
the	O
objective	O
is	O
to	O
only	O
partially	O
deter-	O
mine	O
the	O
transformation	B
.	O
for	O
example	O
,	O
if	O
one	O
wants	O
to	O
measure	O
length	O
ratios	O
from	O
the	O
perspective	O
image	O
of	O
a	O
plane	B
,	O
then	O
it	O
is	O
only	O
necessary	O
to	O
determine	O
(	O
rectify	O
)	O
the	O
trans-	O
formation	O
up	O
to	O
a	O
similarity	B
.	O
we	O
return	O
to	O
this	O
approach	O
in	O
section	O
2.7.	O
s	O
.	O
since	O
h−1	O
a	O
h−1	O
p	O
,	O
h−1	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
s	O
are	O
still	O
projective	B
,	O
afﬁne	B
and	O
similarity	B
transformations	O
respectively	O
,	O
a	O
general	B
projective	I
transformation	O
may	O
also	O
be	O
decomposed	O
in	O
the	O
form	O
taking	O
the	O
inverse	O
of	O
h	O
in	O
(	O
2.16	O
)	O
gives	O
h−1	O
=	O
h−1	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
a	O
and	O
h−1	O
p	O
h−1	O
(	O
cid:17	O
)	O
h	O
=	O
hp	O
ha	O
hs	O
=	O
0	O
i	O
vt	O
1	O
k	O
0	O
0t	O
1	O
sr	O
t	O
0t	O
1	O
(	O
2.17	O
)	O
note	O
that	O
the	O
actual	O
values	O
of	O
k	O
,	O
r	O
,	O
t	O
and	O
v	O
will	O
be	O
different	O
from	O
those	O
of	O
(	O
2.16	O
)	O
.	O
2.4.7	O
the	O
number	O
of	O
invariants	O
the	O
question	O
naturally	O
arises	O
as	O
to	O
how	O
many	O
invariants	B
there	O
are	O
for	O
a	O
given	O
geometric	B
conﬁguration	O
under	O
a	O
particular	O
transformation	B
.	O
first	O
the	O
term	O
“	O
number	O
”	O
needs	O
to	O
be	O
made	O
more	O
precise	O
,	O
for	O
if	O
a	O
quantity	O
is	O
invariant	O
,	O
such	O
as	O
length	O
under	O
euclidean	O
trans-	O
formations	O
,	O
then	O
any	O
function	O
of	O
that	O
quantity	O
is	O
invariant	O
.	O
consequently	O
,	O
we	O
seek	O
a	O
counting	B
argument	I
for	O
the	O
number	O
of	O
functionally	O
independent	O
invariants	B
.	O
by	O
consid-	O
ering	O
the	O
number	O
of	O
transformation	O
parameters	B
that	O
must	O
be	O
eliminated	O
in	O
order	O
to	O
form	O
an	O
invariant	O
,	O
it	O
can	O
be	O
seen	O
that	O
:	O
result	O
2.16.	O
the	O
number	O
of	O
functionally	O
independent	O
invariants	B
is	O
equal	O
to	O
,	O
or	O
greater	O
than	O
,	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
conﬁguration	O
less	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
transformation	O
.	O
44	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
group	O
projective	B
8	O
dof	O
afﬁne	B
6	O
dof	O
similarity	B
4	O
dof	O
euclidean	O
3	O
dof	O
matrix	B
h11	O
h12	O
h13	O
h21	O
h22	O
h23	O
h31	O
h32	O
h33	O
a11	O
a12	O
a21	O
a22	O
0	O
0	O
tx	O
ty	O
1	O
sr11	O
sr21	O
0	O
r11	O
r21	O
0	O
sr12	O
sr22	O
0	O
r12	O
r22	O
0	O
tx	O
ty	O
1	O
tx	O
ty	O
1	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
distortion	B
invariant	O
properties	B
concurrency	O
,	O
collinearity	O
,	O
order	O
of	O
contact	O
:	O
intersection	B
(	O
1	O
pt	O
contact	O
)	O
;	O
tangency	O
(	O
2	O
pt	O
con-	O
tact	O
)	O
;	O
inﬂections	O
(	O
3	O
pt	O
contact	O
with	O
line	O
)	O
;	O
tangent	O
discontinuities	O
and	O
cusps	O
.	O
cross	B
ratio	I
(	O
ratio	O
of	O
ratio	O
of	O
lengths	O
)	O
.	O
parallelism	O
,	O
ratio	O
of	O
areas	O
,	O
ratio	O
of	O
lengths	O
on	O
collinear	O
or	O
parallel	B
lines	I
(	O
e.g	O
.	O
midpoints	O
)	O
,	O
lin-	O
ear	O
combinations	O
of	O
vectors	O
(	O
e.g	O
.	O
centroids	O
)	O
.	O
the	O
line	B
at	I
inﬁnity	I
,	O
l∞	O
.	O
ratio	O
of	O
lengths	O
,	O
angle	B
.	O
the	O
circular	B
points	I
,	O
i	O
,	O
j	O
(	O
see	O
section	O
2.7.3	O
)	O
.	O
length	O
,	O
area	O
table	O
2.1.	O
geometric	B
properties	O
invariant	O
to	O
commonly	O
occurring	O
planar	O
transformations	O
.	O
the	O
matrix	B
a	O
=	O
[	O
aij	O
]	O
is	O
an	O
invertible	O
2	O
×	O
2	O
matrix	B
,	O
r	O
=	O
[	O
rij	O
]	O
is	O
a	O
2d	O
rotation	B
matrix	O
,	O
and	O
(	O
tx	O
,	O
ty	O
)	O
a	O
2d	O
trans-	O
lation	O
.	O
the	O
distortion	B
column	O
shows	O
typical	O
effects	O
of	O
the	O
transformations	O
on	O
a	O
square	O
.	O
transformations	O
higher	O
in	O
the	O
table	O
can	O
produce	O
all	O
the	O
actions	O
of	O
the	O
ones	O
below	O
.	O
these	O
range	O
from	O
euclidean	O
,	O
where	O
only	O
translations	O
and	O
rotations	B
occur	O
,	O
to	O
projective	O
where	O
the	O
square	O
can	O
be	O
transformed	O
to	O
any	O
arbitrary	O
quadrilateral	O
(	O
provided	O
no	O
three	O
points	O
are	O
collinear	O
)	O
.	O
for	O
example	O
,	O
a	O
conﬁguration	O
of	O
four	O
points	O
in	O
general	B
position	I
has	O
8	O
degrees	B
of	I
freedom	I
(	O
2	O
for	O
each	O
point	B
)	O
,	O
and	O
so	O
4	O
similarity	B
,	O
2	O
afﬁnity	O
and	O
zero	O
projective	O
invariants	B
since	O
these	O
transformations	O
have	O
respectively	O
4	O
,	O
6	O
and	O
8	O
degrees	B
of	I
freedom	I
.	O
table	O
2.1	O
summarizes	O
the	O
2d	O
transformation	B
groups	O
and	O
their	O
invariant	O
properties	B
.	O
transformations	O
lower	O
in	O
the	O
table	O
are	O
specializations	O
of	O
those	O
above	O
.	O
a	O
transformation	B
lower	O
in	O
the	O
table	O
inherits	O
the	O
invariants	B
of	O
those	O
above	O
.	O
2.5	O
the	O
projective	B
geometry	O
of	O
1d	O
the	O
development	O
of	O
the	O
projective	O
geometry	O
of	O
a	O
line	O
,	O
ip1	O
,	O
proceeds	O
in	O
much	O
the	O
same	O
way	O
as	O
that	O
of	O
the	O
plane	O
.	O
a	O
point	B
x	O
on	O
the	O
line	B
is	O
represented	O
by	O
homogeneous	O
coordi-	O
nates	O
(	O
x1	O
,	O
x2	O
)	O
t	O
,	O
and	O
a	O
point	B
for	O
which	O
x2	O
=	O
0	O
is	O
an	O
ideal	B
point	I
of	O
the	O
line	B
.	O
we	O
will	O
use	O
the	O
notation	O
¯x	O
to	O
represent	O
the	O
2-vector	O
(	O
x1	O
,	O
x2	O
)	O
t.	O
a	O
projective	B
transformation	I
of	O
a	O
line	B
is	O
represented	O
by	O
a	O
2	O
×	O
2	O
homogeneous	O
matrix	O
,	O
=	O
h2×2¯x	O
¯x	O
(	O
cid:2	O
)	O
and	O
has	O
3	O
degrees	B
of	I
freedom	I
corresponding	O
to	O
the	O
four	O
elements	O
of	O
the	O
matrix	O
less	O
one	O
for	O
overall	O
scaling	B
.	O
a	O
projective	B
transformation	I
of	O
a	O
line	B
may	O
be	O
determined	O
from	O
three	O
corresponding	O
points	O
.	O
2.5	O
the	O
projective	B
geometry	O
of	O
1d	O
45	O
fig	O
.	O
2.8.	O
projective	B
transformations	O
between	O
lines	O
.	O
there	O
are	O
four	O
sets	O
of	O
four	O
collinear	O
points	O
in	O
this	O
ﬁgure	O
.	O
each	O
set	O
is	O
related	O
to	O
the	O
others	O
by	O
a	O
line-to-line	O
projectivity	B
.	O
since	O
the	O
cross	B
ratio	I
is	O
an	O
invariant	O
under	O
a	O
projectivity	B
,	O
the	O
cross	B
ratio	I
has	O
the	O
same	O
value	O
for	O
all	O
the	O
sets	O
shown	O
.	O
the	O
cross	B
ratio	I
.	O
the	O
cross	B
ratio	I
is	O
the	O
basic	O
projective	O
invariant	O
of	O
ip1	O
.	O
given	O
4	O
points	O
¯xi	O
the	O
cross	B
ratio	I
is	O
deﬁned	O
as	O
cross	O
(	O
¯x1	O
,	O
¯x2	O
,	O
¯x3	O
,	O
¯x4	O
)	O
=	O
|¯x1¯x2||¯x3¯x4|	O
|¯x1¯x3||¯x2¯x4|	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
xi1	O
xj1	O
xi2	O
xj2	O
.	O
where	O
|¯xi¯xj|	O
=	O
det	O
a	O
few	O
comments	O
on	O
the	O
cross	B
ratio	I
:	O
(	O
i	O
)	O
the	O
value	O
of	O
the	O
cross	O
ratio	O
is	O
not	O
dependent	O
on	O
which	O
particular	O
homogeneous	O
representative	O
of	O
a	O
point	O
¯xi	O
is	O
used	O
,	O
since	O
the	O
scale	O
cancels	O
between	O
numerator	O
and	O
denominator	O
.	O
such	O
that	O
x2	O
=	O
1	O
,	O
then	O
|¯xi¯xj|	O
represents	O
the	O
signed	O
distance	B
from	O
¯xi	O
to	O
¯xj	O
.	O
(	O
ii	O
)	O
if	O
each	O
point	B
¯xi	O
is	O
a	O
ﬁnite	B
point	O
and	O
the	O
homogeneous	O
representative	O
is	O
chosen	O
(	O
iii	O
)	O
the	O
deﬁnition	B
of	O
the	O
cross	B
ratio	I
is	O
also	O
valid	O
if	O
one	O
of	O
the	O
points	O
¯xi	O
is	O
an	O
ideal	B
point	I
.	O
the	O
line	B
:	O
if	O
¯x	O
(	O
cid:2	O
)	O
(	O
iv	O
)	O
the	O
value	O
of	O
the	O
cross	O
ratio	O
is	O
invariant	O
under	O
any	O
projective	B
transformation	I
of	O
=	O
h2×2¯x	O
then	O
1	O
,	O
¯x	O
(	O
cid:2	O
)	O
cross	O
(	O
¯x	O
(	O
cid:2	O
)	O
2	O
,	O
¯x	O
(	O
cid:2	O
)	O
3	O
,	O
¯x	O
(	O
cid:2	O
)	O
4	O
)	O
=	O
cross	O
(	O
¯x1	O
,	O
¯x2	O
,	O
¯x3	O
,	O
¯x4	O
)	O
.	O
(	O
2.18	O
)	O
the	O
proof	O
is	O
left	O
as	O
an	O
exercise	O
.	O
equivalently	O
stated	O
,	O
the	O
cross	B
ratio	I
is	O
invariant	O
to	O
the	O
projective	B
coordinate	O
frame	O
chosen	O
for	O
the	O
line	B
.	O
figure	O
2.8	O
illustrates	O
a	O
number	O
of	O
projective	O
transformations	O
between	O
lines	B
with	O
equiv-	O
alent	O
cross	O
ratios	O
.	O
under	O
a	O
projective	B
transformation	I
of	O
the	O
plane	B
,	O
a	O
1d	O
projective	B
transformation	I
is	O
induced	O
on	O
any	O
line	B
in	O
the	O
plane	B
.	O
concurrent	B
lines	I
.	O
a	O
conﬁguration	O
of	O
concurrent	O
lines	B
is	O
dual	O
to	O
collinear	O
points	O
on	O
a	O
line	O
.	O
this	O
means	O
that	O
concurrent	B
lines	I
on	O
a	O
plane	B
also	O
have	O
the	O
geometry	O
ip1	O
.	O
in	O
particular	O
four	O
concurrent	O
lines	B
have	O
a	O
cross	B
ratio	I
as	O
illustrated	O
in	O
ﬁgure	O
2.9a	O
.	O
46	O
l	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
x	O
1	O
x	O
2	O
l	O
1	O
l	O
2	O
x	O
3	O
x	O
4	O
a	O
l	O
3	O
l	O
4	O
l	O
x	O
1	O
x	O
1	O
x	O
2	O
c	O
x2	O
x	O
3	O
x	O
4	O
x	O
3	O
x	O
4	O
b	O
fig	O
.	O
2.9.	O
concurrent	B
lines	I
.	O
(	O
a	O
)	O
four	O
concurrent	O
lines	B
li	O
intersect	O
the	O
line	B
l	O
in	O
the	O
four	O
points	O
¯xi	O
.	O
the	O
cross	B
ratio	I
of	O
these	O
lines	B
is	O
an	O
invariant	O
to	O
projective	O
transformations	B
of	I
the	O
plane	B
.	O
its	O
value	O
is	O
given	O
by	O
the	O
cross	B
ratio	I
of	O
the	O
points	O
,	O
cross	O
(	O
¯x1	O
,	O
¯x2	O
,	O
¯x3	O
,	O
¯x4	O
)	O
.	O
(	O
b	O
)	O
coplanar	O
points	O
xi	O
are	O
imaged	O
onto	O
a	O
line	B
l	O
(	O
also	O
in	O
the	O
plane	B
)	O
by	O
a	O
projection	B
with	O
centre	B
c.	O
the	O
cross	B
ratio	I
of	O
the	O
image	O
points	O
¯xi	O
is	O
invariant	O
to	O
the	O
position	O
of	O
the	O
image	O
line	B
l.	O
note	O
how	O
ﬁgure	O
2.9b	O
may	O
be	O
thought	O
of	O
as	O
representing	O
projection	B
of	O
points	O
in	O
ip2	O
into	O
a	O
1-dimensional	O
image	O
.	O
in	O
particular	O
,	O
if	O
c	O
represents	O
a	O
camera	B
centre	I
,	O
and	O
the	O
line	B
l	O
represents	O
an	O
image	O
line	O
(	O
1d	O
analogue	O
of	O
the	O
image	O
plane	B
)	O
,	O
then	O
the	O
points	O
¯xi	O
are	O
the	O
projections	O
of	B
points	I
xi	O
into	O
the	O
image	O
.	O
the	O
cross	B
ratio	I
of	O
the	O
points	O
¯xi	O
characterizes	O
the	O
projective	B
conﬁguration	O
of	O
the	O
four	O
image	O
points	O
.	O
note	O
that	O
the	O
actual	O
position	O
of	O
the	O
image	O
line	B
is	O
irrelevant	O
as	O
far	O
as	O
the	O
projective	B
conﬁguration	O
of	O
the	O
four	O
image	O
points	O
is	O
concerned	O
–	O
different	O
choices	O
of	O
image	O
line	B
give	O
rise	O
to	O
projectively	O
equivalent	B
conﬁgurations	O
of	O
image	O
points	O
.	O
the	O
projective	B
geometry	O
of	O
concurrent	O
lines	B
is	O
important	O
to	O
the	O
understanding	O
of	O
the	O
projective	O
geometry	O
of	B
epipolar	I
lines	I
in	O
chapter	O
9	O
.	O
2.6	O
topology	O
of	O
the	O
projective	B
plane	I
we	O
make	O
brief	O
mention	O
of	O
the	O
topology	O
of	O
ip2	O
.	O
understanding	O
of	O
this	O
section	O
is	O
not	O
required	O
for	O
following	O
the	O
rest	O
of	O
the	O
book	O
.	O
2	O
+	O
x2	O
1	O
+	O
x2	O
we	O
have	O
seen	O
that	O
the	O
projective	B
plane	I
ip2	O
may	O
be	O
thought	O
of	O
as	O
the	O
set	O
of	O
all	O
ho-	O
mogeneous	O
3-vectors	O
.	O
a	O
vector	O
of	O
this	O
type	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
may	O
be	O
normalized	O
by	O
multiplication	O
by	O
a	O
non-zero	O
factor	O
so	O
that	O
x2	O
3	O
=	O
1.	O
such	O
a	O
point	B
lies	O
on	O
the	O
unit	O
sphere	O
in	O
ir3	O
.	O
however	O
,	O
any	O
vector	O
x	O
and	O
−x	O
represent	O
the	O
same	O
point	O
in	O
ip2	O
,	O
since	O
they	O
differ	O
by	O
a	O
multiplicative	O
factor	O
,	O
−1	O
.	O
thus	O
,	O
there	O
is	O
a	O
two-to-one	O
correspondence	B
between	O
the	O
unit	O
sphere	O
s2	O
in	O
ir3	O
and	O
the	O
projective	B
plane	I
ip2	O
.	O
the	O
projective	B
plane	I
may	O
be	O
pictured	O
as	O
the	O
unit	O
sphere	O
with	O
opposite	O
points	O
identiﬁed	O
.	O
in	O
this	O
representa-	O
tion	O
,	O
a	O
line	B
in	O
ip2	O
is	O
modelled	O
as	O
a	O
great	O
circle	O
on	O
the	O
unit	O
sphere	O
(	O
as	O
ever	O
,	O
with	O
opposite	O
points	O
identiﬁed	O
)	O
.	O
one	O
may	O
verify	O
that	O
any	O
two	O
distinct	O
(	O
non-antipodal	O
)	O
points	O
on	O
the	O
sphere	O
lie	O
on	O
exactly	O
one	O
great	O
circle	O
,	O
and	O
any	O
two	O
great	O
circles	O
intersect	O
in	O
one	O
point	O
(	O
since	O
antipodal	O
points	O
are	O
identiﬁed	O
)	O
.	O
in	O
the	O
language	O
of	O
topology	O
,	O
the	O
sphere	O
s2	O
is	O
a	O
2-sheeted	O
covering	O
space	O
of	O
ip2	O
.	O
this	O
implies	O
that	O
ip2	O
is	O
not	O
simply-connected	O
,	O
which	O
means	O
that	O
there	O
are	O
loops	O
in	O
ip2	O
which	O
can	O
not	O
be	O
contracted	O
to	O
a	O
point	B
inside	O
ip2	O
.	O
to	O
be	O
technical	O
,	O
the	O
fundamental	O
group	O
of	O
ip2	O
is	O
the	O
cyclic	O
group	O
of	O
order	O
2	O
.	O
2.7	O
recovery	O
of	O
afﬁne	B
and	O
metric	B
properties	I
from	O
images	O
47	O
a	O
b	O
c	O
d	O
fig	O
.	O
2.10.	O
topology	O
of	O
surfaces	O
.	O
common	O
surfaces	O
may	O
be	O
constructed	O
from	O
a	O
paper	O
square	O
(	O
topo-	O
logically	O
a	O
disk	O
)	O
with	O
edges	O
glued	O
together	O
.	O
in	O
each	O
case	O
,	O
the	O
matching	B
arrow	O
edges	O
of	O
the	O
square	O
are	O
to	O
be	O
glued	O
together	O
in	O
such	O
a	O
way	O
that	O
the	O
directions	O
of	O
the	O
arrows	O
match	O
.	O
one	O
obtains	O
(	O
a	O
)	O
a	O
sphere	O
,	O
(	O
b	O
)	O
a	O
torus	O
,	O
(	O
c	O
)	O
a	O
klein	O
bottle	O
and	O
(	O
d	O
)	O
a	O
projective	B
plane	I
.	O
only	O
the	O
sphere	O
and	O
torus	O
are	O
actually	O
realizable	O
with	O
a	O
real	O
sheet	O
of	O
paper	O
.	O
the	O
sphere	O
and	O
torus	O
are	O
orientable	O
but	O
the	O
projective	B
plane	I
and	O
klein	O
bottle	O
are	O
not	O
.	O
in	O
the	O
model	B
for	O
the	O
projective	B
plane	I
as	O
a	O
sphere	O
with	O
opposite	O
points	O
identiﬁed	O
one	O
may	O
dispense	O
with	O
the	O
lower	O
hemisphere	O
of	O
s2	O
,	O
since	O
points	O
in	O
this	O
hemisphere	O
are	O
the	O
same	O
as	O
the	O
opposite	O
points	O
in	O
the	O
upper	O
hemisphere	O
.	O
in	O
this	O
case	O
,	O
ip2	O
may	O
be	O
constructed	O
from	O
the	O
upper	O
hemisphere	O
by	O
identifying	O
opposite	O
points	O
on	O
the	O
equator	O
.	O
since	O
the	O
upper	O
hemisphere	O
of	O
s2	O
is	O
topologically	O
the	O
same	O
as	O
a	O
disk	O
,	O
ip2	O
is	O
simply	O
a	O
disk	O
with	O
opposite	O
points	O
on	O
its	O
boundary	O
identiﬁed	O
,	O
or	O
glued	O
together	O
.	O
this	O
is	O
not	O
physically	O
possible	O
.	O
constructing	O
topological	O
spaces	O
by	O
gluing	O
the	O
boundary	O
of	O
a	O
disk	O
is	O
a	O
common	O
method	O
in	O
topology	O
,	O
and	O
in	O
fact	O
any	O
2-manifold	O
may	O
be	O
constructed	O
in	O
this	O
way	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
2.10.	O
a	O
notable	O
feature	O
of	O
the	O
projective	B
plane	I
ip2	O
is	O
that	O
it	O
is	O
non-orientable	O
.	O
this	O
means	O
that	O
it	O
is	O
impossible	O
to	O
deﬁne	O
a	O
local	O
orientation	O
(	O
represented	O
for	O
instance	O
by	O
a	O
pair	O
of	O
oriented	O
coordinate	O
axes	O
)	O
that	O
is	O
consistent	O
over	O
the	O
whole	O
surface	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
2.11	O
in	O
which	O
it	O
is	O
shown	O
that	O
the	O
projective	B
plane	I
contains	O
an	O
orientation-	O
reversing	O
path	O
.	O
the	O
topology	O
of	O
ip1	O
.	O
in	O
a	O
similar	O
manner	O
,	O
the	O
1-dimensional	O
projective	B
line	O
may	O
be	O
identiﬁed	O
as	O
a	O
1-sphere	O
s1	O
(	O
that	O
is	O
,	O
a	O
circle	O
)	O
with	O
opposite	O
points	O
identiﬁed	O
.	O
if	O
we	O
omit	O
the	O
lower	O
half	O
of	O
the	O
circle	O
,	O
as	O
being	O
duplicated	O
by	O
the	O
top	O
half	O
,	O
then	O
the	O
top	O
half	O
of	O
a	O
circle	O
is	O
topologically	O
equivalent	B
to	O
a	O
line	B
segment	O
.	O
thus	O
ip1	O
is	O
topologically	O
equivalent	B
to	O
a	O
line	B
segment	O
with	O
the	O
two	O
endpoints	O
identiﬁed	O
–	O
namely	O
a	O
circle	O
,	O
s1	O
.	O
2.7	O
recovery	O
of	O
afﬁne	B
and	O
metric	B
properties	I
from	O
images	O
we	O
return	O
to	O
the	O
example	O
of	O
projective	O
rectiﬁcation	O
of	O
example	O
2.12	O
(	O
p34	O
)	O
where	O
the	O
aim	O
was	O
to	O
remove	O
the	O
projective	B
distortion	O
in	O
the	O
perspective	O
image	O
of	O
a	O
plane	B
to	O
the	O
extent	O
that	O
similarity	B
properties	O
(	O
angles	O
,	O
ratios	O
of	O
lengths	O
)	O
could	O
be	O
measured	O
on	O
the	O
original	O
plane	B
.	O
in	O
that	O
example	O
the	O
projective	B
distortion	O
was	O
completely	O
removed	O
by	O
specifying	O
the	O
position	O
of	O
four	O
reference	O
points	O
on	O
the	O
plane	B
(	O
a	O
total	O
of	O
8	O
degrees	B
of	I
freedom	I
)	O
,	O
and	O
explicitly	O
computing	B
the	O
transformation	B
mapping	O
the	O
reference	O
points	O
to	O
their	O
images	O
.	O
in	O
fact	O
this	O
overspeciﬁes	O
the	O
geometry	O
–	O
a	O
projective	B
transformation	I
has	O
only	O
4	O
degrees	B
of	I
freedom	I
more	O
than	O
a	O
similarity	B
,	O
so	O
it	O
is	O
only	O
necessary	O
to	O
specify	O
4	O
48	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
a	O
b	O
fig	O
.	O
2.11.	O
orientation	B
of	O
surfaces	O
.	O
a	O
coordinate	O
frame	O
(	O
represented	O
by	O
an	O
l	O
in	O
the	O
diagram	O
)	O
may	O
be	O
transported	O
along	O
a	O
path	O
in	O
the	O
surface	O
eventually	O
coming	O
back	O
to	O
the	O
point	B
where	O
it	O
started	O
.	O
(	O
a	O
)	O
represents	O
a	O
projective	B
plane	I
.	O
in	O
the	O
path	O
shown	O
,	O
the	O
coordinate	O
frame	O
(	O
represented	O
by	O
a	O
pair	O
of	O
axes	O
)	O
is	O
reversed	O
when	O
it	O
returns	O
to	O
the	O
same	O
point	O
,	O
since	O
the	O
identiﬁcation	O
at	O
the	O
boundary	O
of	O
the	O
square	O
swaps	O
the	O
direction	O
of	O
one	O
of	O
the	O
axes	O
.	O
such	O
a	O
path	O
is	O
called	O
an	O
orientation-reversing	O
path	O
,	O
and	O
a	O
surface	O
that	O
contains	O
such	O
a	O
path	O
is	O
called	O
non-orientable	O
.	O
(	O
b	O
)	O
shows	O
the	O
well	O
known	O
example	O
of	O
a	O
m¨obius	O
strip	O
obtained	O
by	O
joining	O
two	O
opposite	O
edges	O
of	O
a	O
rectangle	O
(	O
m.c	O
.	O
escher	O
’	O
s	O
“	O
moebius	O
strip	O
ii	O
[	O
red	O
ants	O
]	O
”	O
,	O
1963.	O
c	O
(	O
cid:4	O
)	O
2000	O
cordon	O
art	O
b.v.	O
–	O
baarn-holland	O
.	O
all	O
rights	O
reserved	O
)	O
.	O
as	O
can	O
be	O
veriﬁed	O
,	O
a	O
path	O
once	O
around	O
the	O
strip	O
is	O
orientation-reversing	O
.	O
degrees	B
of	I
freedom	I
(	O
not	O
8	O
)	O
in	O
order	O
to	O
determine	O
metric	B
properties	I
.	O
in	O
projective	O
geom-	O
etry	O
these	O
4	O
degrees	B
of	I
freedom	I
are	O
given	O
“	O
physical	O
substance	O
”	O
by	O
being	O
associated	O
with	O
geometric	O
objects	O
:	O
the	O
line	B
at	I
inﬁnity	I
l∞	O
(	O
2	O
dof	O
)	O
,	O
and	O
the	O
two	O
circular	O
points	O
(	O
2	O
dof	O
)	O
on	O
l∞	O
.	O
this	O
association	O
is	O
often	O
a	O
more	O
intuitive	O
way	O
of	O
reasoning	O
about	O
the	O
problem	O
than	O
the	O
equivalent	B
description	O
in	O
terms	O
of	O
specifying	O
matrices	O
in	O
the	O
decomposition	B
chain	O
(	O
2.16	O
)	O
.	O
in	O
the	O
following	O
it	O
is	O
shown	O
that	O
the	O
projective	B
distortion	O
may	O
be	O
removed	O
once	O
the	O
image	O
of	O
l∞	O
is	O
speciﬁed	O
,	O
and	O
the	O
afﬁne	B
distortion	O
removed	O
once	O
the	O
image	O
of	O
the	O
circu-	O
lar	O
points	O
is	O
speciﬁed	O
.	O
then	O
the	O
only	O
remaining	O
distortion	B
is	O
a	O
similarity	B
.	O
2.7.1	O
the	O
line	B
at	I
inﬁnity	I
under	O
a	O
projective	B
transformation	I
ideal	O
points	O
may	O
be	O
mapped	O
to	O
ﬁnite	O
points	O
(	O
2.15	O
)	O
,	O
and	O
consequently	O
l∞	O
is	O
mapped	O
to	O
a	O
ﬁnite	B
line	O
.	O
however	O
,	O
if	O
the	O
transformation	B
is	O
an	O
afﬁnity	O
,	O
then	O
l∞	O
is	O
not	O
mapped	O
to	O
a	O
ﬁnite	B
line	O
,	O
but	O
remains	O
at	B
inﬁnity	I
.	O
this	O
is	O
evident	O
directly	O
from	O
the	O
line	B
transformation	O
(	O
2.6–p36	O
)	O
:	O
(	O
cid:17	O
)	O
l	O
(	O
cid:2	O
)	O
∞	O
=	O
h−t	O
a	O
l∞	O
=	O
a−t	O
0	O
−tta−t	O
1	O
(	O
cid:18	O
)	O
	O
0	O
0	O
1	O
	O
=	O
	O
0	O
0	O
1	O
	O
=	O
l∞	O
.	O
the	O
converse	O
is	O
also	O
true	O
,	O
i.e	O
.	O
an	O
afﬁne	B
transformation	I
is	O
the	O
most	O
general	O
linear	O
trans-	O
formation	O
that	O
ﬁxes	O
l∞	O
,	O
and	O
may	O
be	O
seen	O
as	O
follows	O
.	O
we	O
require	O
that	O
a	O
point	B
at	O
inﬁnity	O
,	O
say	O
x	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
be	O
mapped	O
to	O
a	O
point	B
at	O
inﬁnity	O
.	O
this	O
requires	O
that	O
h31	O
=	O
0.	O
simi-	O
larly	O
,	O
h32	O
=	O
0	O
,	O
so	O
the	O
transformation	B
is	O
an	O
afﬁnity	O
.	O
to	O
summarize	O
,	O
result	O
2.17.	O
the	O
line	B
at	I
inﬁnity	I
,	O
l∞	O
,	O
is	O
a	O
ﬁxed	O
line	O
under	O
the	O
projective	B
transformation	I
h	O
if	O
and	O
only	O
if	O
h	O
is	O
an	O
afﬁnity	O
.	O
however	O
,	O
l∞	O
is	O
not	O
ﬁxed	O
pointwise	O
under	O
an	O
afﬁne	B
transformation	I
:	O
(	O
2.14	O
)	O
showed	O
that	O
under	O
an	O
afﬁnity	O
a	O
point	B
on	O
l∞	O
(	O
an	O
ideal	B
point	I
)	O
is	O
mapped	O
to	O
a	O
point	B
on	O
l∞	O
,	O
but	O
2.7	O
recovery	O
of	O
afﬁne	B
and	O
metric	B
properties	I
from	O
images	O
49	O
h	O
p	O
/	O
h	O
p	O
l	O
=	O
h	O
(	O
)	O
l	O
p	O
π	O
1	O
π	O
2	O
π	O
3	O
h	O
a	O
fig	O
.	O
2.12.	O
afﬁne	B
rectiﬁcation	O
.	O
a	O
projective	B
transformation	I
maps	O
l∞	O
from	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
on	O
a	O
euclidean	O
plane	B
π1	O
to	O
a	O
ﬁnite	B
line	O
l	O
on	O
the	O
plane	B
π2	O
.	O
if	O
a	O
projective	B
transformation	I
is	O
constructed	O
such	O
that	O
l	O
is	O
mapped	O
back	O
to	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
then	O
from	O
result	O
2.17	O
the	O
transformation	B
between	O
the	O
ﬁrst	O
and	O
third	O
planes	O
must	O
be	O
an	O
afﬁne	B
transformation	I
since	O
the	O
canonical	O
position	O
of	O
l∞	O
is	O
preserved	O
.	O
this	O
means	O
that	O
afﬁne	O
properties	O
of	O
the	O
ﬁrst	O
plane	B
can	O
be	O
measured	O
from	O
the	O
third	O
,	O
i.e	O
.	O
the	O
third	O
plane	B
is	O
within	O
an	O
afﬁnity	O
of	O
the	O
ﬁrst	O
.	O
it	O
is	O
not	O
the	O
same	O
point	O
unless	O
a	O
(	O
x1	O
,	O
x2	O
)	O
t	O
=	O
k	O
(	O
x1	O
,	O
x2	O
)	O
t.	O
it	O
will	O
now	O
be	O
shown	O
that	O
identifying	O
l∞	O
allows	O
the	O
recovery	O
of	O
afﬁne	B
properties	I
(	O
parallelism	O
,	O
ratio	O
of	O
areas	O
)	O
.	O
2.7.2	O
recovery	O
of	O
afﬁne	B
properties	I
from	O
images	O
once	O
the	O
imaged	O
line	B
at	I
inﬁnity	I
is	O
identiﬁed	O
in	O
an	O
image	O
of	O
a	O
plane	B
,	O
it	O
is	O
then	O
possible	O
to	O
make	O
afﬁne	B
measurements	O
on	O
the	O
original	O
plane	B
.	O
for	O
example	O
,	O
lines	B
may	O
be	O
identiﬁed	O
as	O
parallel	O
on	O
the	O
original	O
plane	B
if	O
the	O
imaged	O
lines	B
intersect	O
on	O
the	O
imaged	O
l∞	O
.	O
this	O
follows	O
because	O
parallel	B
lines	I
on	O
the	O
euclidean	O
plane	O
intersect	O
on	O
l∞	O
,	O
and	O
after	O
a	O
pro-	O
jective	O
transformation	B
the	O
lines	B
still	O
intersect	O
on	O
the	O
imaged	O
l∞	O
since	O
intersections	O
are	O
preserved	O
by	O
projectivities	O
.	O
similarly	O
,	O
once	O
l∞	O
is	O
identiﬁed	O
a	O
length	O
ratio	O
on	B
a	I
line	I
may	O
be	O
computed	O
from	O
the	O
cross	B
ratio	I
of	O
the	O
three	O
points	O
specifying	O
the	O
lengths	O
together	O
with	O
the	O
intersection	B
of	O
the	O
line	B
with	O
l∞	O
(	O
which	O
provides	O
the	O
fourth	O
point	B
for	O
the	O
cross	B
ratio	I
)	O
,	O
and	O
so	O
forth	O
.	O
however	O
,	O
a	O
less	O
tortuous	O
path	O
which	O
is	O
better	O
suited	O
to	O
computational	O
algorithms	O
is	O
simply	O
to	O
transform	O
the	O
identiﬁed	O
l∞	O
to	O
its	O
canonical	O
position	O
of	O
l∞	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
the	O
(	O
projective	B
)	O
matrix	B
which	O
achieves	O
this	O
transformation	B
can	O
be	O
applied	O
to	O
every	O
point	B
in	O
the	O
image	O
in	O
order	O
to	O
afﬁnely	O
rectify	O
the	O
image	O
,	O
i.e	O
.	O
after	O
the	O
transformation	B
,	O
afﬁne	B
measurements	O
can	O
be	O
made	O
directly	O
from	O
the	O
rectiﬁed	O
image	O
.	O
the	O
key	O
idea	O
here	O
is	O
illustrated	O
in	O
ﬁgure	O
2.12.	O
if	O
the	O
imaged	O
line	B
at	I
inﬁnity	I
is	O
the	O
line	B
l	O
=	O
(	O
l1	O
,	O
l2	O
,	O
l3	O
)	O
t	O
,	O
then	O
provided	O
l3	O
(	O
cid:5	O
)	O
=	O
0	O
a	O
suitable	O
projective	B
point	O
transformation	B
which	O
will	O
map	O
l	O
back	O
to	O
l∞	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
is	O
	O
1	O
0	O
l1	O
h	O
=	O
ha	O
	O
0	O
1	O
l2	O
0	O
0	O
l3	O
(	O
2.19	O
)	O
50	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
a	O
b	O
c	O
fig	O
.	O
2.13.	O
afﬁne	B
rectiﬁcation	O
via	O
the	O
vanishing	O
line	B
.	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
imaged	O
in	O
(	O
a	O
)	O
is	O
computed	O
(	O
c	O
)	O
from	O
the	O
intersection	B
of	O
two	O
sets	O
of	O
imaged	O
parallel	B
lines	I
.	O
the	O
image	O
is	O
then	O
projectively	O
warped	O
to	O
produce	O
the	O
afﬁnely	O
rectiﬁed	O
image	O
(	O
b	O
)	O
.	O
in	O
the	O
afﬁnely	O
rectiﬁed	O
image	O
parallel	O
lines	B
are	O
now	O
parallel	B
.	O
however	O
,	O
angles	O
do	O
not	O
have	O
their	O
veridical	O
world	O
value	O
since	O
they	O
are	O
afﬁnely	O
distorted	O
.	O
see	O
also	O
ﬁgure	O
2.17.	O
where	O
ha	O
is	O
any	O
afﬁne	B
transformation	I
(	O
the	O
last	O
row	O
of	O
h	O
is	O
lt	O
)	O
.	O
one	O
can	O
verify	O
that	O
under	O
the	O
line	B
transformation	O
(	O
2.6–p36	O
)	O
h−t	O
(	O
l1	O
,	O
l2	O
,	O
l3	O
)	O
t	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
=	O
l∞	O
.	O
example	O
2.18.	O
afﬁne	B
rectiﬁcation	O
in	O
a	O
perspective	O
image	O
of	O
a	O
plane	B
,	O
the	O
line	B
at	I
inﬁnity	I
on	O
the	O
world	O
plane	B
is	O
imaged	O
as	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
.	O
this	O
is	O
discussed	O
in	O
more	O
detail	O
in	O
chapter	O
8.	O
as	O
illustrated	O
in	O
ﬁgure	O
2.13	O
the	O
vanishing	O
line	O
l	O
may	O
be	O
computed	O
by	O
intersecting	O
imaged	O
parallel	B
lines	I
.	O
the	O
image	O
is	O
then	O
rectiﬁed	O
by	O
applying	O
a	O
projective	B
warping	O
(	O
2.19	O
)	O
such	O
that	O
l	O
is	O
(	O
cid:2	O
)	O
mapped	O
to	O
its	O
canonical	O
position	O
l∞	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
this	O
example	O
shows	O
that	O
afﬁne	B
properties	I
may	O
be	O
recovered	O
by	O
simply	O
specifying	O
a	O
line	B
(	O
2	O
dof	O
)	O
.	O
it	O
is	O
equivalent	B
to	O
specifying	O
only	O
the	O
projective	B
component	O
of	O
the	O
trans-	O
formation	O
decomposition	B
chain	O
(	O
2.16	O
)	O
.	O
conversely	O
if	O
afﬁne	B
properties	I
are	O
known	O
,	O
these	O
may	O
be	O
used	O
to	O
determine	O
points	O
and	O
the	O
line	B
at	I
inﬁnity	I
.	O
this	O
is	O
illustrated	O
in	O
the	O
fol-	O
lowing	O
example	O
.	O
example	O
2.19.	O
computing	O
a	O
vanishing	O
point	B
from	O
a	O
length	O
ratio	O
.	O
given	O
two	O
in-	O
tervals	O
on	B
a	I
line	I
with	O
a	O
known	O
length	O
ratio	O
,	O
the	O
point	B
at	O
inﬁnity	O
on	O
the	O
line	B
may	O
be	O
determined	O
.	O
a	O
typical	O
case	O
is	O
where	O
three	O
points	O
a	O
(	O
cid:2	O
)	O
are	O
identiﬁed	O
on	B
a	I
line	I
in	O
an	O
image	O
.	O
suppose	O
a	O
,	O
b	O
and	O
c	O
are	O
the	O
corresponding	O
collinear	O
points	O
on	O
the	O
world	O
line	B
,	O
and	O
the	O
length	O
ratio	O
d	O
(	O
a	O
,	O
b	O
)	O
:	O
d	O
(	O
b	O
,	O
c	O
)	O
=a	O
:	O
b	O
is	O
known	O
(	O
where	O
d	O
(	O
x	O
,	O
y	O
)	O
is	O
the	O
euclidean	O
and	O
c	O
(	O
cid:2	O
)	O
,	O
b	O
(	O
cid:2	O
)	O
2.7	O
recovery	O
of	O
afﬁne	B
and	O
metric	B
properties	I
from	O
images	O
51	O
fig	O
.	O
2.14.	O
two	O
examples	O
of	O
using	O
equal	O
length	O
ratios	O
on	O
a	O
line	B
to	O
determine	O
the	O
point	B
at	O
inﬁnity	O
.	O
the	O
line	B
intervals	O
used	O
are	O
shown	O
as	O
the	O
thin	O
and	O
thick	O
white	O
lines	B
delineated	O
by	O
points	O
.	O
this	O
construction	O
determines	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
.	O
compare	O
with	O
ﬁgure	O
2.13c	O
.	O
distance	B
between	O
the	O
points	O
x	O
and	O
y	O
)	O
.	O
it	O
is	O
possible	O
to	O
ﬁnd	O
the	O
vanishing	O
point	O
using	O
the	O
cross	B
ratio	I
.	O
equivalently	O
,	O
one	O
may	O
proceed	O
as	O
follows	O
:	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
,	O
c	O
(	O
cid:2	O
)	O
)	O
=	O
a	O
:	O
b	O
,	O
b	O
(	O
cid:2	O
)	O
)	O
:	O
d	O
(	O
b	O
(	O
cid:2	O
)	O
(	O
i	O
)	O
measure	O
the	O
distance	B
ratio	I
in	O
the	O
image	O
,	O
d	O
(	O
a	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
points	O
a	O
,	O
b	O
and	O
c	O
may	O
be	O
represented	O
as	O
coordinates	O
0	O
,	O
a	O
and	O
a+b	O
in	O
a	O
coordinate	O
frame	O
on	O
the	O
line	B
(	O
cid:8	O
)	O
a	O
,	O
b	O
,	O
c	O
(	O
cid:9	O
)	O
.	O
for	O
computational	O
purposes	O
,	O
these	O
points	O
are	O
rep-	O
resented	O
by	O
homogeneous	O
2-vectors	O
(	O
0	O
,	O
1	O
)	O
t	O
,	O
(	O
a	O
,	O
1	O
)	O
t	O
and	O
(	O
a	O
+	O
b	O
,	O
1	O
)	O
t.	O
similarly	O
,	O
a	O
(	O
cid:2	O
)	O
,	O
b	O
(	O
cid:2	O
)	O
,	O
which	O
may	O
also	O
be	O
expressed	O
as	O
homogeneous	O
vectors	O
.	O
h2×2	O
mapping	O
a	O
(	O
cid:6	O
)	O
→	O
a	O
(	O
cid:2	O
)	O
,	O
b	O
(	O
cid:6	O
)	O
→	O
b	O
(	O
cid:2	O
)	O
vanishing	O
point	O
on	O
the	O
line	B
(	O
cid:8	O
)	O
a	O
(	O
cid:2	O
)	O
(	O
iv	O
)	O
the	O
image	O
of	O
the	O
point	O
at	B
inﬁnity	I
(	O
with	O
coordinates	O
(	O
1	O
,	O
0	O
)	O
t	O
)	O
under	O
h2×2	O
is	O
the	O
(	O
iii	O
)	O
relative	O
to	O
these	O
coordinate	O
frames	O
,	O
compute	O
the	O
1d	O
projective	B
transformation	I
and	O
c	O
(	O
cid:6	O
)	O
→	O
c	O
(	O
cid:2	O
)	O
,	O
c	O
(	O
cid:2	O
)	O
(	O
cid:9	O
)	O
.	O
,	O
b	O
(	O
cid:2	O
)	O
have	O
coordinates	B
0	O
,	O
a	O
(	O
cid:2	O
)	O
and	O
a	O
and	O
c	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
+	O
b	O
(	O
cid:2	O
)	O
.	O
an	O
example	O
of	O
vanishing	O
points	O
computed	O
in	O
this	O
manner	O
is	O
shown	O
in	O
ﬁgure	O
2.14	O
.	O
(	O
cid:2	O
)	O
example	O
2.20.	O
geometric	B
construction	O
of	O
vanishing	O
points	O
from	O
a	O
length	O
ratio	O
.	O
the	O
vanishing	B
points	I
shown	O
in	O
ﬁgure	O
2.14	O
may	O
also	O
be	O
computed	O
by	O
a	O
purely	O
geometric	B
construction	O
consisting	O
of	O
the	O
following	O
steps	O
:	O
,	O
b	O
(	O
cid:2	O
)	O
three	O
collinear	O
points	O
,	O
a	O
(	O
cid:2	O
)	O
,	O
in	O
an	O
image	O
corresponding	O
to	O
(	O
i	O
)	O
given	O
:	O
(	O
ii	O
)	O
draw	O
any	O
line	B
l	O
through	O
a	O
(	O
cid:2	O
)	O
and	O
c	O
(	O
cid:2	O
)	O
collinear	O
world	O
points	O
with	O
interval	O
ratio	O
a	O
:	O
b.	O
points	O
a	O
=	O
a	O
(	O
cid:2	O
)	O
a	O
:	O
b	O
.	O
(	O
iii	O
)	O
join	O
bb	O
(	O
cid:2	O
)	O
(	O
iv	O
)	O
the	O
line	B
through	O
o	O
parallel	B
to	O
l	O
meets	O
the	O
line	B
a	O
(	O
cid:2	O
)	O
c	O
(	O
cid:2	O
)	O
and	O
intersect	O
in	O
o.	O
and	O
cc	O
(	O
cid:2	O
)	O
)	O
,	O
and	O
mark	O
off	O
,	O
b	O
and	O
c	O
such	O
that	O
the	O
line	B
segments	O
(	O
cid:8	O
)	O
ab	O
(	O
cid:9	O
)	O
,	O
(	O
cid:8	O
)	O
bc	O
(	O
cid:9	O
)	O
have	O
length	O
ratio	O
(	O
not	O
coincident	O
with	O
the	O
line	B
a	O
(	O
cid:2	O
)	O
c	O
(	O
cid:2	O
)	O
this	O
construction	O
is	O
illustrated	O
in	O
ﬁgure	O
2.15.	O
in	O
the	O
vanishing	O
point	O
v	O
(	O
cid:2	O
)	O
.	O
(	O
cid:2	O
)	O
52	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
o	O
c	O
/	O
b/	O
v/	O
a/	O
a	O
a	O
b	O
b	O
c	O
l	O
fig	O
.	O
2.15.	O
a	O
geometric	B
construction	O
to	O
determine	O
the	O
image	O
of	O
the	O
point	O
at	B
inﬁnity	I
on	O
a	O
line	B
given	O
a	O
known	O
length	O
ratio	O
.	O
the	O
details	O
are	O
given	O
in	O
the	O
text	O
.	O
2.7.3	O
the	O
circular	B
points	I
and	O
their	O
dual	B
under	O
any	O
similarity	B
transformation	I
there	O
are	O
two	O
points	O
on	O
l∞	O
which	O
are	O
ﬁxed	O
.	O
these	O
are	O
the	O
circular	B
points	I
(	O
also	O
called	O
the	O
absolute	O
points	O
)	O
i	O
,	O
j	O
,	O
with	O
canonical	O
coordinates	B
	O
	O
1	O
i	O
0	O
i	O
=	O
j	O
=	O
	O
1−i	O
	O
.	O
0	O
the	O
circular	B
points	I
are	O
a	O
pair	O
of	O
complex	O
conjugate	O
ideal	O
points	O
.	O
to	O
see	O
that	O
they	O
are	O
ﬁxed	O
under	O
an	O
orientation-preserving	O
similarity	B
:	O
i	O
(	O
cid:2	O
)	O
=	O
hsi	O
=	O
	O
s	O
cos	O
θ	O
−s	O
sin	O
θ	O
tx	O
	O
=	O
i	O
	O
1	O
s	O
cos	O
θ	O
s	O
sin	O
θ	O
ty	O
1	O
−iθ	O
0	O
0	O
	O
	O
1	O
	O
i	O
0	O
=	O
se	O
i	O
0	O
with	O
an	O
analogous	O
proof	O
for	O
j.	O
a	O
reﬂection	O
swaps	O
i	O
and	O
j.	O
the	O
converse	O
is	O
also	O
true	O
,	O
i.e	O
.	O
if	O
the	O
circular	B
points	I
are	O
ﬁxed	O
then	O
the	O
linear	B
transformation	O
is	O
a	O
similarity	B
.	O
the	O
proof	O
is	O
left	O
as	O
an	O
exercise	O
.	O
to	O
summarize	O
,	O
result	O
2.21.	O
the	O
circular	B
points	I
,	O
i	O
,	O
j	O
,	O
areﬁxed	O
points	O
under	O
the	O
projective	B
transforma-	O
tion	O
h	O
if	O
and	O
only	O
if	O
h	O
is	O
a	O
similarity	B
.	O
the	O
name	O
“	O
circular	B
points	I
”	O
arises	O
because	O
every	O
circle	O
intersects	O
l∞	O
at	O
the	O
circular	B
points	I
.	O
to	O
see	O
this	O
,	O
start	O
from	O
equation	O
(	O
2.1–p30	O
)	O
for	O
a	O
conic	O
.	O
in	O
the	O
case	O
that	O
the	O
conic	B
is	O
a	O
circle	O
:	O
a	O
=	O
c	O
and	O
b	O
=	O
0.	O
then	O
x2	O
1	O
+	O
x2	O
2	O
+	O
dx1x3	O
+	O
ex2x3	O
+	O
f	O
x2	O
3	O
=	O
0	O
2.7	O
recovery	O
of	O
afﬁne	B
and	O
metric	B
properties	I
from	O
images	O
53	O
where	O
a	O
has	O
been	O
set	O
to	O
unity	O
.	O
this	O
conic	B
intersects	O
l∞	O
in	O
the	O
(	O
ideal	O
)	O
points	O
for	O
which	O
x3	O
=	O
0	O
,	O
namely	O
x2	O
1	O
+	O
x2	O
2	O
=	O
0	O
with	O
solution	O
i	O
=	O
(	O
1	O
,	O
i,0	O
)	O
t	O
,	O
j	O
=	O
(	O
1	O
,	O
−i	O
,	O
0	O
)	O
t	O
,	O
i.e	O
.	O
any	O
circle	O
intersects	O
l∞	O
in	O
the	O
circular	B
points	I
.	O
in	O
euclidean	O
geometry	O
it	O
is	O
well	O
known	O
that	O
a	O
circle	O
is	O
speciﬁed	O
by	O
three	O
points	O
.	O
the	O
circular	B
points	I
enable	O
an	O
alternative	O
computation	B
.	O
a	O
circle	O
can	O
be	O
computed	O
using	O
the	O
general	O
formula	O
for	O
a	O
conic	O
deﬁned	O
by	O
ﬁve	O
points	O
(	O
2.4–p31	O
)	O
,	O
where	O
the	O
ﬁve	O
points	O
are	O
the	O
three	O
points	O
augmented	O
with	O
the	O
two	O
circular	O
points	O
.	O
in	O
section	O
2.7.5	O
it	O
will	O
be	O
shown	O
that	O
identifying	O
the	O
circular	B
points	I
(	O
or	O
equivalently	O
their	O
dual	B
,	O
see	O
below	O
)	O
allows	O
the	O
recovery	O
of	O
similarity	B
properties	O
(	O
angles	O
,	O
ratios	O
of	O
lengths	O
)	O
.	O
algebraically	O
,	O
the	O
circular	B
points	I
are	O
the	O
orthogonal	B
directions	O
of	O
euclidean	O
geometry	O
,	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
and	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
,	O
packaged	O
into	O
a	O
single	O
complex	O
conjugate	O
entity	O
,	O
e.g	O
.	O
i	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
+	O
i	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t.	O
consequently	O
,	O
it	O
is	O
not	O
so	O
surprising	O
that	O
once	O
the	O
circular	B
points	I
are	O
identiﬁed	O
,	O
orthog-	O
onality	O
,	O
and	O
other	O
metric	B
properties	I
,	O
are	O
then	O
determined	O
.	O
the	O
conic	B
dual	O
to	O
the	O
circular	B
points	I
.	O
the	O
conic	B
c∗	O
∞	O
=	O
ijt	O
+	O
jit	O
(	O
2.20	O
)	O
is	O
dual	O
to	O
the	O
circular	B
points	I
.	O
the	O
conic	B
c∗	O
∞	O
is	O
a	O
degenerate	B
(	O
rank	O
2	O
)	O
line	B
conic	O
(	O
see	O
section	O
2.2.3	O
)	O
,	O
which	O
consists	O
of	O
the	O
two	O
circular	B
points	I
.	O
in	O
a	O
euclidean	O
coordinate	O
system	O
it	O
is	O
given	O
by	O
c∗	O
∞	O
=	O
1	O
−i	O
0	O
+	O
1	O
i	O
0	O
=	O
	O
(	O
cid:15	O
)	O
	O
1	O
i	O
0	O
(	O
cid:16	O
)	O
	O
(	O
cid:15	O
)	O
	O
1−i	O
0	O
(	O
cid:16	O
)	O
	O
1	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
	O
.	O
the	O
conic	B
c∗	O
∞	O
is	O
ﬁxed	O
under	O
similarity	B
transformations	O
in	O
an	O
analogous	O
fashion	O
to	O
the	O
ﬁxed	O
properties	O
of	B
circular	I
points	I
.	O
a	O
conic	B
is	O
ﬁxed	O
if	O
the	O
same	O
matrix	O
results	O
(	O
up	O
to	O
scale	O
)	O
under	O
the	O
transformation	B
rule	I
.	O
since	O
c∗	O
∞	O
is	O
a	O
dual	B
conic	I
it	O
transforms	O
according	O
to	O
result	O
2.14	O
(	O
p37	O
)	O
(	O
c∗	O
(	O
cid:2	O
)	O
=	O
hc∗ht	O
)	O
,	O
and	O
one	O
can	O
verify	O
that	O
under	O
the	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
=	O
hsx	O
,	O
(	O
cid:2	O
)	O
c∗	O
∞	O
=	O
hsc∗	O
s	O
=	O
c∗	O
∞	O
.	O
∞ht	O
the	O
converse	O
is	O
also	O
true	O
,	O
and	O
we	O
have	O
result	O
2.22.	O
the	O
dual	B
conic	I
c∗	O
only	O
if	O
h	O
is	O
a	O
similarity	B
.	O
some	O
properties	B
of	O
c∗	O
∞	O
in	O
any	O
projective	B
frame	O
:	O
∞	O
is	O
ﬁxed	O
under	O
the	O
projective	B
transformation	I
h	O
if	O
and	O
(	O
i	O
)	O
c∗	O
∞	O
has	O
4	O
degrees	B
of	I
freedom	I
:	O
a	O
3	O
×	O
3	O
homogeneous	O
symmetric	O
matrix	B
has	O
5	O
degrees	B
of	I
freedom	I
,	O
but	O
the	O
constraint	O
det	O
c∗	O
∞	O
=	O
0	O
reduces	O
the	O
degrees	B
of	I
freedom	I
by	O
1	O
.	O
54	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
(	O
ii	O
)	O
l∞	O
is	O
the	O
null	O
vector	O
of	O
c∗	O
lie	O
on	O
l∞	O
,	O
so	O
that	O
itl∞	O
=	O
jtl∞	O
=	O
0	O
;	O
then	O
∞	O
.	O
this	O
is	O
clear	O
from	O
the	O
deﬁnition	B
:	O
the	O
circular	B
points	I
c∗	O
∞l∞	O
=	O
(	O
ijt	O
+	O
jit	O
)	O
l∞	O
=	O
i	O
(	O
jtl∞	O
)	O
+	O
j	O
(	O
itl∞	O
)	O
=	O
0	O
.	O
2.7.4	O
angles	O
on	O
the	O
projective	B
plane	I
in	O
euclidean	B
geometry	I
the	O
angle	B
between	O
two	O
lines	O
is	O
computed	O
from	O
the	O
dot	O
product	O
of	O
their	O
normals	O
.	O
for	O
the	O
lines	B
l	O
=	O
(	O
l1	O
,	O
l2	O
,	O
l3	O
)	O
t	O
and	O
m	O
=	O
(	O
m1	O
,	O
m2	O
,	O
m3	O
)	O
t	O
with	O
normals	O
parallel	B
to	O
(	O
l1	O
,	O
l2	O
)	O
t	O
,	O
(	O
m1	O
,	O
m2	O
)	O
t	O
respectively	O
,	O
the	O
angle	B
is	O
(	O
cid:19	O
)	O
cos	O
θ	O
=	O
l1m1	O
+	O
l2m2	O
1	O
+	O
l2	O
2	O
)	O
(	O
m2	O
(	O
l2	O
1	O
+	O
m2	O
2	O
)	O
.	O
(	O
2.21	O
)	O
the	O
problem	O
with	O
this	O
expression	O
is	O
that	O
the	O
ﬁrst	O
two	O
components	O
of	O
l	O
and	O
m	O
do	O
not	O
have	O
well	O
deﬁned	O
transformation	O
properties	B
under	O
projective	B
transformations	O
(	O
they	O
are	O
not	O
tensors	O
)	O
,	O
and	O
so	O
(	O
2.21	O
)	O
can	O
not	O
be	O
applied	O
after	O
an	O
afﬁne	B
or	O
projective	B
transforma-	O
tion	O
of	O
the	O
plane	O
.	O
however	O
,	O
an	O
analogous	O
expression	O
to	O
(	O
2.21	O
)	O
which	O
is	O
invariant	O
to	O
projective	O
transformations	O
is	O
ltc∗	O
(	O
cid:19	O
)	O
(	O
ltc∗∞l	O
)	O
(	O
mtc∗∞m	O
)	O
∞m	O
cos	O
θ	O
=	O
(	O
2.22	O
)	O
where	O
c∗	O
∞	O
is	O
the	O
conic	B
dual	O
to	O
the	O
circular	B
points	I
.	O
it	O
is	O
clear	O
that	O
in	O
a	O
euclidean	O
co-	O
it	O
may	O
be	O
veriﬁed	O
that	O
(	O
2.22	O
)	O
is	O
invariant	O
ordinate	O
system	O
(	O
2.22	O
)	O
reduces	O
to	O
(	O
2.21	O
)	O
.	O
to	O
projective	O
transformations	O
by	O
using	O
the	O
transformation	B
rules	O
for	B
lines	I
(	O
2.6–p36	O
)	O
(	O
l	O
(	O
cid:2	O
)	O
=	O
hc∗ht	O
)	O
under	O
the	O
point	B
trans-	O
formation	O
x	O
(	O
cid:2	O
)	O
=	O
h−tl	O
)	O
and	O
dual	B
conics	O
(	O
result	O
2.14	O
(	O
p37	O
)	O
)	O
(	O
c∗	O
(	O
cid:2	O
)	O
=	O
hx	O
.	O
for	O
example	O
,	O
the	O
numerator	O
transforms	O
as	O
∞hth−tm	O
=	O
ltc∗	O
∞m	O
(	O
cid:6	O
)	O
→	O
lth−1hc∗	O
ltc∗	O
∞m	O
.	O
it	O
may	O
also	O
be	O
veriﬁed	O
that	O
the	O
scale	O
of	O
the	O
homogeneous	O
objects	O
cancels	O
between	O
the	O
numerator	O
and	O
denominator	O
.	O
thus	O
(	O
2.22	O
)	O
is	O
indeed	O
invariant	O
to	O
the	O
projective	B
frame	O
.	O
to	O
summarize	O
,	O
we	O
have	O
shown	O
result	O
2.23.	O
once	O
the	O
conic	B
c∗	O
angles	O
may	O
be	O
measured	O
by	O
(	O
2.22	O
)	O
.	O
∞	O
is	O
identiﬁed	O
on	O
the	O
projective	B
plane	I
then	O
euclidean	O
∞m	O
=	O
0.	O
if	O
l	O
and	O
m	O
satisfy	O
ltc∗	O
note	O
,	O
as	O
a	O
corollary	O
,	O
result	O
2.24.	O
lines	B
l	O
and	O
m	O
are	O
orthogonal	B
if	O
ltc∗	O
geometrically	O
,	O
(	O
see	O
section	O
2.8.1	O
)	O
with	O
respect	O
to	O
the	O
conic	B
c∗	O
∞	O
.	O
length	O
ratios	O
may	O
also	O
be	O
measured	O
once	O
c∗	O
∞	O
is	O
identiﬁed	O
.	O
consider	O
the	O
triangle	O
shown	O
in	O
ﬁgure	O
2.16	O
with	O
vertices	O
a	O
,	O
b	O
,	O
c.	O
from	O
the	O
standard	O
trigonometric	O
sine	O
rule	O
the	O
ratio	O
of	O
lengths	O
d	O
(	O
b	O
,	O
c	O
)	O
:	O
d	O
(	O
a	O
,	O
c	O
)	O
=	O
sin	O
α	O
:	O
sin	O
β	O
,	O
where	O
d	O
(	O
x	O
,	O
y	O
)	O
denotes	O
the	O
eu-	O
clidean	O
distance	B
between	O
the	O
points	O
x	O
and	O
y.	O
using	O
(	O
2.22	O
)	O
,	O
both	O
cos	O
α	O
and	O
cos	O
β	O
may	O
be	O
computed	O
from	O
the	O
lines	B
l	O
(	O
cid:2	O
)	O
for	O
any	O
then	O
the	O
lines	B
are	O
conjugate	O
=	O
a	O
(	O
cid:2	O
)	O
×	O
b	O
(	O
cid:2	O
)	O
=	O
b	O
(	O
cid:2	O
)	O
×	O
c	O
(	O
cid:2	O
)	O
=	O
c	O
(	O
cid:2	O
)	O
×	O
a	O
(	O
cid:2	O
)	O
∞m	O
=	O
0	O
,	O
and	O
n	O
(	O
cid:2	O
)	O
,	O
m	O
(	O
cid:2	O
)	O
2.7	O
recovery	O
of	O
afﬁne	B
and	O
metric	B
properties	I
from	O
images	O
55	O
c	O
α	O
a	O
β	O
/	O
c	O
/	O
m	O
/	O
n	O
b	O
/	O
a	O
l	O
/	O
/	O
b	O
fig	O
.	O
2.16.	O
length	O
ratios	O
.	O
once	O
c∗	O
measured	O
from	O
the	O
projectively	O
distorted	O
ﬁgure	O
.	O
see	O
text	O
for	O
details	O
.	O
∞	O
is	O
identiﬁed	O
the	O
euclidean	O
length	O
ratio	O
d	O
(	O
b	O
,	O
c	O
)	O
:	O
d	O
(	O
a	O
,	O
c	O
)	O
may	O
be	O
projective	B
frame	O
in	O
which	O
c∗	O
the	O
ratio	O
d	O
(	O
a	O
,	O
b	O
)	O
:	O
d	O
(	O
c	O
,	O
a	O
)	O
,	O
may	O
be	O
determined	O
from	O
the	O
projectively	O
mapped	O
points	O
.	O
∞	O
is	O
speciﬁed	O
.	O
consequently	O
both	O
sin	O
α	O
,	O
sin	O
β	O
,	O
and	O
thence	O
2.7.5	O
recovery	O
of	O
metric	B
properties	I
from	O
images	O
a	O
completely	O
analogous	O
approach	O
to	O
that	O
of	O
section	O
2.7.2	O
and	O
ﬁgure	O
2.12	O
,	O
where	O
afﬁne	B
properties	I
are	O
recovered	O
by	O
specifying	O
l∞	O
,	O
enables	O
metric	B
properties	I
to	O
be	O
recovered	O
from	O
an	O
image	O
of	O
a	O
plane	B
by	O
transforming	O
the	O
circular	B
points	I
to	O
their	O
canonical	O
position	O
.	O
suppose	O
the	O
circular	B
points	I
are	O
identiﬁed	O
in	O
an	O
image	O
,	O
and	O
the	O
image	O
is	O
then	O
rectiﬁed	O
by	O
a	O
projective	B
transformation	I
h	O
that	O
maps	O
the	O
imaged	O
circular	B
points	I
to	O
their	O
canonical	O
position	O
(	O
at	O
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
t	O
)	O
on	O
l∞	O
.	O
from	O
result	O
2.21	O
the	O
transformation	B
between	O
the	O
world	O
plane	B
and	O
the	O
rectiﬁed	O
image	O
is	O
then	O
a	O
similarity	B
since	O
it	O
is	O
projective	B
and	O
the	O
circular	B
points	I
are	O
ﬁxed	O
.	O
metric	B
rectiﬁcation	I
using	O
c∗	O
∞	O
neatly	O
packages	O
all	O
the	O
information	O
required	O
for	O
a	O
metric	O
rectiﬁcation	O
.	O
it	O
enables	O
both	O
the	O
projective	B
and	O
afﬁne	B
components	O
of	O
a	O
projective	O
transformation	B
to	O
be	O
determined	O
,	O
leaving	O
only	O
similarity	B
distortions	O
.	O
this	O
is	O
evident	O
from	O
its	O
transformation	B
under	O
a	O
projectivity	B
.	O
if	O
the	O
point	B
transformation	O
is	O
x	O
(	O
cid:2	O
)	O
∞	O
transforms	O
according	O
to	O
result	O
2.14	O
(	O
p37	O
)	O
(	O
c∗	O
(	O
cid:2	O
)	O
=	O
hc∗ht	O
)	O
.	O
using	O
the	O
decomposition	B
chain	O
(	O
2.17–	O
p43	O
)	O
for	O
h	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
=	O
(	O
hp	O
ha	O
hs	O
)	O
c∗	O
=	O
(	O
hp	O
ha	O
)	O
c∗	O
∞	O
=	O
hx	O
,	O
where	O
the	O
x-coordinate	O
frame	O
is	O
euclidean	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
cid:15	O
)	O
hs	O
c∗	O
∞	O
.	O
the	O
dual	B
conic	I
c∗	O
projective	B
,	O
c∗	O
=	O
(	O
hp	O
ha	O
)	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
ht	O
a	O
ht	O
p	O
c∗	O
∞	O
∞ht	O
s	O
(	O
cid:16	O
)	O
(	O
cid:2	O
)	O
(	O
cid:17	O
)	O
t	O
∞	O
(	O
hp	O
ha	O
hs	O
)	O
a	O
ht	O
ht	O
kktv	O
(	O
cid:18	O
)	O
p	O
kkt	O
=	O
vtkkt	O
vtkktv	O
.	O
(	O
2.23	O
)	O
∞	O
,	O
but	O
(	O
since	O
c∗	O
it	O
is	O
clear	O
that	O
the	O
projective	B
(	O
v	O
)	O
and	O
afﬁne	B
(	O
k	O
)	O
components	O
are	O
determined	O
directly	O
from	O
the	O
image	O
of	O
c∗	O
∞	O
is	O
invariant	O
to	O
similarity	O
transformation	B
by	O
result	O
2.22	O
)	O
the	O
similarity	B
component	O
is	O
undetermined	O
.	O
consequently	O
,	O
result	O
2.25.	O
once	O
the	O
conic	B
c∗	O
distortion	B
may	O
be	O
rectiﬁed	O
up	O
to	O
a	O
similarity	B
.	O
∞	O
is	O
identiﬁed	O
on	O
the	O
projective	B
plane	I
then	O
projective	B
actually	O
,	O
a	O
suitable	O
rectifying	B
homography	I
may	O
be	O
obtained	O
directly	O
from	O
the	O
iden-	O
(	O
cid:2	O
)	O
in	O
an	O
image	O
using	O
the	O
svd	O
(	O
section	O
a4.4	O
(	O
p585	O
)	O
)	O
:	O
writing	O
the	O
svd	O
of	O
c∗	O
∞	O
tiﬁed	O
c∗	O
∞	O
(	O
cid:2	O
)	O
,	O
m	O
(	O
cid:2	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:17	O
)	O
(	O
cid:2	O
)	O
l	O
1	O
(	O
cid:2	O
)	O
l	O
2	O
(	O
cid:2	O
)	O
l	O
3	O
kkt	O
0	O
0t	O
0	O
	O
=	O
0	O
(	O
cid:18	O
)	O
	O
m	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1	O
m	O
(	O
cid:2	O
)	O
2	O
m	O
3	O
56	O
as	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
	O
1	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
	O
ut	O
(	O
cid:2	O
)	O
c∗	O
∞	O
=	O
u	O
then	O
by	O
inspection	O
from	O
(	O
2.23	O
)	O
the	O
rectifying	O
projectivity	O
is	O
h	O
=	O
u	O
up	O
to	O
a	O
similarity	B
.	O
the	O
following	O
two	O
examples	O
show	O
typical	O
situations	O
where	O
c∗	O
∞	O
may	O
be	O
identiﬁed	O
in	O
an	O
image	O
,	O
and	O
thence	O
a	O
metric	B
rectiﬁcation	I
obtained	O
.	O
example	O
2.26.	O
metric	B
rectiﬁcation	I
i	O
suppose	O
an	O
image	O
has	O
been	O
afﬁnely	O
rectiﬁed	O
(	O
as	O
in	O
example	O
2.18	O
above	O
)	O
,	O
then	O
we	O
re-	O
quire	O
two	O
constraints	O
to	O
specify	O
the	O
2	O
degrees	B
of	I
freedom	I
of	O
the	O
circular	B
points	I
in	O
order	O
to	O
determine	O
a	O
metric	B
rectiﬁcation	I
.	O
these	O
two	O
constraints	O
may	O
be	O
obtained	O
from	O
two	O
imaged	O
right	O
angles	O
on	O
the	O
world	O
plane	B
.	O
line	B
pair	O
l	O
,	O
m	O
on	O
the	O
world	O
plane	B
.	O
from	O
result	O
2.24	O
l	O
(	O
cid:2	O
)	O
tc∗	O
∞	O
with	O
v	O
=	O
0	O
in	O
the	O
afﬁnely	O
rectiﬁed	O
image	O
correspond	O
to	O
an	O
orthogonal	B
=	O
0	O
,	O
and	O
using	O
(	O
2.23	O
)	O
suppose	O
the	O
lines	B
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
m	O
(	O
cid:2	O
)	O
which	O
is	O
a	O
linear	B
constraint	O
on	O
the	O
2	O
×	O
2	O
matrix	B
s	O
=	O
kkt	O
.	O
the	O
matrix	B
s	O
=	O
kkt	O
is	O
symmetric	B
with	O
three	O
independent	O
elements	O
,	O
and	O
thus	O
2	O
degrees	B
of	I
freedom	I
(	O
as	O
the	O
overall	O
scaling	B
is	O
unimportant	O
)	O
.	O
the	O
orthogonality	B
condition	O
reduces	O
to	O
the	O
equation	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
2	O
)	O
t	O
=	O
0	O
which	O
may	O
be	O
written	O
as	O
2	O
)	O
s	O
(	O
m	O
1	O
,	O
m	O
(	O
cid:2	O
)	O
1	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1m	O
1	O
,	O
l	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1m	O
2	O
+	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
2m	O
1	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
2	O
)	O
s	O
=	O
0	O
,	O
2m	O
where	O
s	O
=	O
(	O
s11	O
,	O
s12	O
,	O
s22	O
)	O
t	O
is	O
s	O
written	O
as	O
a	O
3-vector	O
.	O
two	O
such	O
orthogonal	B
line	O
pairs	O
provide	O
two	O
constraints	O
which	O
may	O
be	O
stacked	O
to	O
give	O
a	O
2	O
×	O
3	O
matrix	B
with	O
s	O
deter-	O
mined	O
as	O
the	O
null	O
vector	O
.	O
thus	O
s	O
,	O
and	O
hence	O
k	O
,	O
is	O
obtained	O
up	O
to	O
scale	O
(	O
by	O
cholesky	O
decomposition	B
,	O
section	O
a4.2.1	O
(	O
p582	O
)	O
)	O
.	O
figure	O
2.17	O
shows	O
an	O
example	O
of	O
two	O
orthog-	O
onal	O
line	B
pairs	O
being	O
used	O
to	O
metrically	O
rectify	O
the	O
afﬁnely	O
rectiﬁed	O
image	O
computed	O
(	O
cid:2	O
)	O
in	O
ﬁgure	O
2.13.	O
alternatively	O
,	O
the	O
two	O
constraints	O
required	O
for	O
metric	O
rectiﬁcation	O
may	O
be	O
obtained	O
from	O
an	O
imaged	O
circle	O
or	O
two	O
known	O
length	O
ratios	O
.	O
in	O
the	O
case	O
of	O
a	O
circle	O
,	O
the	O
image	O
conic	O
is	O
an	O
ellipse	O
in	O
the	O
afﬁnely	O
rectiﬁed	O
image	O
,	O
and	O
the	O
intersection	B
of	O
this	O
ellipse	O
with	O
the	O
(	O
known	O
)	O
l∞	O
directly	O
determines	O
the	O
imaged	O
circular	B
points	I
.	O
∞	O
can	O
alternatively	O
be	O
identiﬁed	O
directly	O
in	O
a	O
perspective	O
image	O
,	O
without	O
the	O
conic	B
c∗	O
ﬁrst	O
identifying	O
l∞	O
,	O
as	O
is	O
illustrated	O
in	O
the	O
following	O
example	O
.	O
example	O
2.27.	O
metric	B
rectiﬁcation	I
ii	O
we	O
start	O
here	O
from	O
the	O
original	O
perspective	O
image	O
of	O
the	O
plane	O
(	O
not	O
the	O
afﬁnely	O
rectiﬁed	O
image	O
of	O
example	O
2.26	O
)	O
.	O
suppose	O
lines	B
l	O
and	O
m	O
are	O
images	O
of	O
orthogonal	O
lines	B
on	O
the	O
world	O
plane	B
;	O
then	O
from	O
result	O
2.24	O
ltc∗	O
∞m	O
=	O
0	O
,	O
and	O
in	O
a	O
similar	O
manner	O
to	O
constraining	O
2.7	O
recovery	O
of	O
afﬁne	B
and	O
metric	B
properties	I
from	O
images	O
57	O
a	O
b	O
fig	O
.	O
2.17.	O
metric	B
rectiﬁcation	I
via	O
orthogonal	B
lines	O
i.	O
the	O
afﬁne	B
transformation	I
required	O
to	O
metrically	O
rectify	O
an	O
afﬁne	B
image	O
may	O
be	O
computed	O
from	O
imaged	O
orthogonal	B
lines	O
.	O
(	O
a	O
)	O
two	O
(	O
non-parallel	O
)	O
line	B
pairs	O
identiﬁed	O
on	O
the	O
afﬁnely	O
rectiﬁed	O
image	O
(	O
ﬁgure	O
2.13	O
)	O
correspond	O
to	O
orthogonal	O
lines	B
on	O
the	O
world	O
plane	B
.	O
(	O
b	O
)	O
the	O
metrically	O
rectiﬁed	O
image	O
.	O
note	O
that	O
in	O
the	O
metrically	O
rectiﬁed	O
image	O
all	O
lines	B
orthogonal	O
in	O
the	O
world	O
are	O
orthogonal	B
,	O
world	O
squares	O
have	O
unit	O
aspect	O
ratio	O
,	O
and	O
world	O
circles	O
are	O
circular	O
.	O
a	O
b	O
fig	O
.	O
2.18.	O
metric	B
rectiﬁcation	I
via	O
orthogonal	B
lines	O
ii	O
.	O
(	O
a	O
)	O
the	O
conic	B
c∗	O
∞	O
is	O
determined	O
on	O
the	O
per-	O
spectively	O
imaged	O
plane	B
(	O
the	O
front	O
wall	O
of	O
the	O
building	O
)	O
using	O
the	O
ﬁve	O
orthogonal	B
line	O
pairs	O
shown	O
.	O
the	O
conic	B
c∗	O
∞	O
determines	O
the	O
circular	B
points	I
,	O
and	O
equivalently	O
the	O
projective	B
transformation	I
necessary	O
to	O
metrically	O
rectify	O
the	O
image	O
(	O
b	O
)	O
.	O
the	O
image	O
shown	O
in	O
(	O
a	O
)	O
is	O
the	O
same	O
perspective	O
image	O
as	O
that	O
of	O
ﬁgure	O
2.4	O
(	O
p35	O
)	O
,	O
where	O
the	O
perspective	O
distortion	B
was	O
removed	O
by	O
specifying	O
the	O
world	O
position	O
of	O
four	O
image	O
points	O
.	O
a	O
conic	B
to	O
contain	O
a	O
point	B
(	O
2.4–p31	O
)	O
,	O
this	O
provides	O
a	O
linear	B
constraint	O
on	O
the	O
elements	O
of	O
c∗	O
∞	O
,	O
namely	O
(	O
l1m1	O
,	O
(	O
l1m2	O
+	O
l2m1	O
)	O
/2	O
,	O
l2m2	O
,	O
(	O
l1m3	O
+	O
l3m1	O
)	O
/2	O
,	O
(	O
l2m3	O
+	O
l3m2	O
)	O
/2	O
,	O
l3m3	O
)	O
c	O
=	O
0	O
where	O
c	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
,	O
e	O
,	O
f	O
)	O
t	O
is	O
the	O
conic	B
matrix	O
(	O
2.3–p30	O
)	O
of	O
c∗	O
∞	O
written	O
as	O
a	O
6-vector	O
.	O
five	O
such	O
constraints	B
can	O
be	O
stacked	O
to	O
form	O
a	O
5	O
×	O
6	O
matrix	B
,	O
and	O
c	O
,	O
and	O
hence	O
c∗	O
∞	O
,	O
is	O
obtained	O
as	O
the	O
null	O
vector	O
.	O
this	O
shows	O
that	O
c∗	O
∞	O
can	O
be	O
determined	O
linearly	O
from	O
the	O
images	O
of	O
ﬁve	O
line	B
pairs	O
which	O
are	O
orthogonal	B
on	O
the	O
world	O
plane	B
.	O
an	O
example	O
of	O
(	O
cid:2	O
)	O
metric	B
rectiﬁcation	I
using	O
such	O
line	B
pair	O
constraints	B
is	O
shown	O
in	O
ﬁgure	O
2.18.	O
stratiﬁcation	B
.	O
note	O
,	O
in	O
example	O
2.27	O
the	O
afﬁne	B
and	O
projective	B
distortions	O
are	O
deter-	O
mined	O
in	O
one	O
step	O
by	O
specifying	O
c∗	O
∞	O
.	O
in	O
the	O
previous	O
example	O
2.26	O
ﬁrst	O
the	O
projec-	O
tive	O
and	O
subsequently	O
the	O
afﬁne	B
distortions	O
were	O
removed	O
.	O
this	O
two-step	O
approach	O
is	O
termed	O
stratiﬁed	O
.	O
analogous	O
approaches	O
apply	O
in	O
3d	O
,	O
and	O
are	O
employed	O
in	O
chapter	O
10	O
58	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
c	O
y	O
l	O
x	O
fig	O
.	O
2.19.	O
the	O
pole–polar	B
relationship	I
.	O
the	O
line	B
l	O
=	O
cx	O
is	O
the	O
polar	O
of	O
the	O
point	O
x	O
with	O
respect	O
to	O
the	O
conic	B
c	O
,	O
and	O
the	O
point	B
x	O
=	O
c−1l	O
is	O
the	O
pole	O
of	O
l	O
with	O
respect	O
to	O
c.	O
the	O
polar	O
of	O
x	O
intersects	O
the	O
conic	B
at	O
the	O
points	O
of	O
tangency	O
of	B
lines	I
from	O
x.	O
if	O
y	O
is	O
on	O
l	O
then	O
ytl	O
=	O
ytcx	O
=	O
0.	O
points	O
x	O
and	O
y	O
which	O
satisfy	O
ytcx	O
=	O
0	O
are	O
conjugate	O
.	O
on	O
3d	O
reconstruction	B
and	O
chapter	O
19	O
on	O
auto-calibration	O
,	O
when	O
obtaining	O
a	O
metric	O
from	O
a	O
3d	O
projective	B
reconstruction	I
.	O
2.8	O
more	B
properties	I
of	O
conics	O
we	O
now	O
introduce	O
an	O
important	O
geometric	B
relation	O
between	O
a	O
point	B
,	O
line	B
and	O
conic	B
,	O
which	O
is	O
termed	O
polarity	B
.	O
applications	O
of	O
this	O
relation	B
(	O
to	O
the	O
representation	B
of	O
orthog-	O
onality	O
)	O
are	O
given	O
in	O
chapter	O
8	O
.	O
2.8.1	O
the	O
pole–polar	B
relationship	I
a	O
point	B
x	O
and	O
conic	B
c	O
deﬁne	O
a	O
line	B
l	O
=	O
cx	O
.	O
the	O
line	B
l	O
is	O
called	O
the	O
polar	O
of	O
x	O
with	O
respect	O
to	O
c	O
,	O
and	O
the	O
point	B
x	O
is	O
the	O
pole	O
of	O
l	O
with	O
respect	O
to	O
c.	O
•	O
the	O
polar	O
line	B
l	O
=	O
cx	O
of	O
the	O
point	O
x	O
with	O
respect	O
to	O
a	O
conic	B
c	O
intersects	O
the	O
conic	B
in	O
two	O
points	O
.	O
the	O
two	O
lines	O
tangent	O
to	O
c	O
at	O
these	O
points	O
intersect	O
at	O
x.	O
this	O
relationship	O
is	O
illustrated	O
in	O
ﬁgure	O
2.19.	O
proof	O
.	O
consider	O
a	O
point	B
y	O
on	O
c.	O
the	O
tangent	B
line	I
at	O
y	O
is	O
cy	O
,	O
and	O
this	O
line	B
contains	O
x	O
if	O
xtcy	O
=	O
0.	O
using	O
the	O
symmetry	O
of	O
c	O
,	O
the	O
condition	O
xtcy	O
=	O
(	O
cx	O
)	O
ty	O
=	O
0	O
is	O
that	O
the	O
point	B
y	O
lies	O
on	O
the	O
line	B
cx	O
.	O
thus	O
the	O
polar	O
line	B
cx	O
intersects	O
the	O
conic	B
in	O
the	O
point	B
y	O
at	O
which	O
the	O
tangent	B
line	I
contains	O
x.	O
as	O
the	O
point	B
x	O
approaches	O
the	O
conic	B
the	O
tangent	B
lines	I
become	O
closer	O
to	O
collinear	O
,	O
and	O
their	O
contact	O
points	O
on	O
the	O
conic	B
also	O
become	O
closer	O
.	O
in	O
the	O
limit	O
that	O
x	O
lies	O
on	O
c	O
,	O
the	O
polar	O
line	B
has	O
two-point	O
contact	O
at	O
x	O
,	O
and	O
we	O
have	O
:	O
•	O
if	O
the	O
point	B
x	O
is	O
on	O
c	O
then	O
the	O
polar	O
is	O
the	O
tangent	B
line	I
to	O
the	O
conic	B
at	O
x.	O
see	O
result	O
2.7	O
(	O
p31	O
)	O
.	O
2.8	O
more	B
properties	I
of	O
conics	O
59	O
example	O
2.28.	O
a	O
circle	O
of	O
radius	O
r	O
centred	O
on	O
the	O
x-axis	O
at	O
x	O
=	O
a	O
has	O
the	O
equation	O
(	O
x	O
−	O
a	O
)	O
2	O
+	O
y2	O
=	O
r2	O
,	O
and	O
is	O
represented	O
by	O
the	O
conic	B
matrix	O
	O
1	O
c	O
=	O
	O
.	O
−a	O
0	O
0	O
−a	O
0	O
a2	O
−	O
r2	O
0	O
1	O
the	O
polar	O
line	B
of	O
the	O
origin	O
is	O
given	O
by	O
l	O
=	O
c	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
=	O
(	O
−a	O
,	O
0	O
,	O
a2	O
−	O
r2	O
)	O
t.	O
this	O
is	O
a	O
vertical	O
line	O
at	O
x	O
=	O
(	O
a2	O
−	O
r2	O
)	O
/a	O
.	O
if	O
r	O
=	O
a	O
the	O
origin	O
lies	O
on	O
the	O
circle	O
.	O
in	O
this	O
case	O
the	O
(	O
cid:2	O
)	O
polar	O
line	B
is	O
the	O
y-axis	O
and	O
is	O
tangent	O
to	O
the	O
circle	O
.	O
it	O
is	O
evident	O
that	O
the	O
conic	B
induces	O
a	O
map	O
between	O
points	O
and	O
lines	B
of	O
ip2	O
.	O
this	O
map	O
is	O
a	O
projective	B
construction	O
since	O
it	O
involves	O
only	O
intersections	O
and	O
tangency	O
,	O
both	O
prop-	O
erties	O
that	O
are	O
preserved	O
under	O
projective	B
transformations	O
.	O
a	O
projective	B
map	O
between	O
points	O
and	O
lines	B
is	O
termed	O
a	O
correlation	B
(	O
an	O
unfortunate	O
name	O
,	O
given	O
its	O
more	O
common	O
usage	O
)	O
.	O
deﬁnition	B
2.29.	O
a	O
correlation	B
is	O
an	O
invertible	O
mapping	O
from	O
points	O
of	O
ip2	O
to	O
lines	O
of	O
ip2	O
.	O
it	O
is	O
represented	O
by	O
a	O
3	O
×	O
3	O
non-singular	O
matrix	B
a	O
as	O
l	O
=	O
ax	O
.	O
a	O
correlation	B
provides	O
a	O
systematic	O
way	O
to	O
dualize	O
relations	O
involving	O
points	O
and	O
lines	B
.	O
it	O
need	O
not	O
be	O
represented	O
by	O
a	O
symmetric	B
matrix	O
,	O
but	O
we	O
will	O
only	O
consider	O
symmetric	B
correlations	O
here	O
,	O
because	O
of	O
the	O
association	O
with	O
conics	O
.	O
•	O
conjugate	O
points	O
.	O
if	O
the	O
point	B
y	O
is	O
on	O
the	O
line	B
l	O
=	O
cx	O
then	O
ytl	O
=	O
ytcx	O
=	O
0.	O
any	O
two	O
points	O
x	O
,	O
y	O
satisfying	O
ytcx	O
=	O
0	O
are	O
conjugate	O
with	O
respect	O
to	O
the	O
conic	B
c.	O
the	O
conjugacy	B
relation	I
is	O
symmetric	B
:	O
•	O
if	O
x	O
is	O
on	O
the	O
polar	O
of	O
y	O
then	O
y	O
is	O
on	O
the	O
polar	O
of	O
x.	O
this	O
follows	O
simply	O
because	O
of	O
the	O
symmetry	O
of	O
the	O
conic	O
matrix	B
–	O
the	O
point	B
x	O
is	O
on	O
the	O
polar	O
of	O
y	O
if	O
xtcy	O
=	O
0	O
,	O
and	O
the	O
point	B
y	O
is	O
on	O
the	O
polar	O
of	O
x	O
if	O
ytcx	O
=	O
0.	O
since	O
xtcy	O
=	O
ytcx	O
,	O
if	O
one	O
form	O
is	O
zero	O
,	O
then	O
so	O
is	O
the	O
other	O
.	O
there	O
is	O
a	O
dual	B
conjugacy	O
relationship	O
for	O
lines	B
:	O
two	O
lines	O
l	O
and	O
m	O
are	O
conjugate	O
if	O
ltc∗m	O
=	O
0	O
.	O
2.8.2	O
classiﬁcation	B
of	I
conics	O
this	O
section	O
describes	O
the	O
projective	B
and	O
afﬁne	B
classiﬁcation	I
of	O
conics	O
.	O
projective	B
normal	I
form	I
for	O
a	O
conic	B
.	O
since	O
c	O
is	O
a	O
symmetric	B
matrix	O
it	O
has	O
real	O
eigen-	O
values	O
,	O
and	O
may	O
be	O
decomposed	O
as	O
a	O
product	O
c	O
=	O
utdu	O
(	O
see	O
section	O
a4.2	O
(	O
p580	O
)	O
)	O
,	O
where	O
u	O
is	O
an	O
orthogonal	B
matrix	O
,	O
and	O
d	O
is	O
diagonal	O
.	O
applying	O
the	O
projective	B
trans-	O
formation	O
represented	O
by	O
u	O
,	O
conic	B
c	O
is	O
transformed	O
to	O
another	O
conic	B
c	O
(	O
cid:2	O
)	O
=	O
u−tcu−1	O
=	O
u−tutduu−1	O
=	O
d.	O
this	O
shows	O
that	O
any	O
conic	B
is	O
equivalent	B
under	O
projective	B
transforma-	O
tion	O
to	O
one	O
with	O
a	O
diagonal	O
matrix	B
.	O
let	O
d	O
=	O
diag	O
(	O
1d1	O
,	O
2d2	O
,	O
3d3	O
)	O
where	O
i	O
=	O
±1	O
or	O
0	O
and	O
each	O
di	O
>	O
0.	O
thus	O
,	O
d	O
may	O
be	O
written	O
in	O
the	O
form	O
d	O
=	O
diag	O
(	O
s1	O
,	O
s2	O
,	O
s3	O
)	O
tdiag	O
(	O
1	O
,	O
2	O
,	O
3	O
)	O
diag	O
(	O
s1	O
,	O
s2	O
,	O
s3	O
)	O
60	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
a	O
l	O
l	O
b	O
l	O
c	O
fig	O
.	O
2.20.	O
afﬁne	B
classiﬁcation	I
of	O
point	B
conics	O
.	O
a	O
conic	B
is	O
an	O
(	O
a	O
)	O
ellipse	O
,	O
(	O
b	O
)	O
parabola	O
,	O
or	O
(	O
c	O
)	O
hyperbola	O
;	O
according	O
to	O
whether	O
it	O
(	O
a	O
)	O
has	O
no	O
real	O
intersection	B
,	O
(	O
b	O
)	O
is	O
tangent	O
to	O
(	O
2-point	O
contact	O
)	O
,	O
or	O
(	O
c	O
)	O
has	O
2	O
real	O
intersections	O
with	O
l∞	O
.	O
under	O
an	O
afﬁne	B
transformation	I
l∞	O
is	O
a	O
ﬁxed	O
line	O
,	O
and	O
intersections	O
are	O
preserved	O
.	O
thus	O
this	O
classiﬁcation	B
is	O
unaltered	O
by	O
an	O
afﬁnity	O
.	O
i	O
=	O
di	O
.	O
note	O
that	O
diag	O
(	O
s1	O
,	O
s2	O
,	O
s3	O
)	O
t	O
=	O
diag	O
(	O
s1	O
,	O
s2	O
,	O
s3	O
)	O
.	O
now	O
,	O
transforming	O
once	O
where	O
s2	O
more	O
by	O
the	O
transformation	B
diag	O
(	O
s1	O
,	O
s2	O
,	O
s3	O
)	O
,	O
the	O
conic	B
d	O
is	O
transformed	O
to	O
a	O
conic	B
with	O
matrix	B
diag	O
(	O
1	O
,	O
2	O
,	O
3	O
)	O
,	O
with	O
each	O
i	O
=	O
±1	O
or	O
0.	O
further	O
transformation	B
by	O
permutation	O
matrices	O
may	O
be	O
carried	O
out	O
to	O
ensure	O
that	O
values	O
i	O
=	O
1	O
occur	O
before	O
values	O
i	O
=	O
−1	O
which	O
in	O
turn	O
precede	O
values	O
i	O
=	O
0.	O
finally	O
,	O
by	O
multiplying	O
by	O
−1	O
if	O
necessary	O
,	O
one	O
may	O
ensure	O
that	O
there	O
are	O
at	O
least	O
as	O
many	O
+1	O
entries	O
as	O
−1	O
.	O
the	O
various	O
types	O
of	B
conics	I
may	O
now	O
be	O
enumerated	O
,	O
and	O
are	O
shown	O
in	O
table	O
2.2.	O
diagonal	O
(	O
1	O
,	O
1	O
,	O
1	O
)	O
(	O
1	O
,	O
1	O
,	O
−1	O
)	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
(	O
1	O
,	O
−1	O
,	O
0	O
)	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
equation	O
x2	O
+	O
y2	O
+	O
w2	O
=	O
0	O
x2	O
+	O
y2	O
−	O
w2	O
=	O
0	O
conic	B
type	O
improper	O
conic	B
–	O
no	O
real	O
points	O
.	O
circle	O
x2	O
+	O
y2	O
=	O
0	O
x2	O
−	O
y2	O
=	O
0	O
single	O
real	O
point	B
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
two	O
lines	O
x	O
=	O
±y	O
x2	O
=	O
0	O
single	O
line	O
x	O
=	O
0	O
counted	O
twice	O
.	O
table	O
2.2.	O
projective	B
classiﬁcation	O
of	O
point	O
conics	O
.	O
any	O
plane	B
conic	O
is	O
projectively	O
equivalent	B
to	O
one	O
of	O
the	O
types	O
shown	O
in	O
this	O
table	O
.	O
those	O
conics	O
for	O
which	O
i	O
=	O
0	O
for	O
some	O
i	O
are	O
known	O
as	O
degenerate	B
conics	O
,	O
and	O
are	O
represented	O
by	O
a	O
matrix	B
of	O
rank	O
less	O
than	O
3.	O
the	O
conic	B
type	O
column	O
only	O
describes	O
the	O
real	O
points	O
of	O
the	O
conics	O
–	O
for	O
example	O
as	O
a	O
complex	O
conic	B
x2	O
+	O
y2	O
=	O
0	O
consists	O
of	O
the	O
line	O
pair	O
x	O
=	O
±iy	O
.	O
afﬁne	B
classiﬁcation	I
of	O
conics	O
.	O
the	O
classiﬁcation	B
of	I
(	O
non-degenerate	O
,	O
proper	O
)	O
conics	O
in	O
euclidean	O
geometry	O
into	O
hyperbola	O
,	O
ellipse	O
and	O
parabola	O
is	O
well	O
known	O
.	O
as	O
shown	O
above	O
in	O
projective	O
geometry	O
these	O
three	O
types	O
of	B
conic	I
are	O
projectively	O
equivalent	B
to	O
a	O
circle	O
.	O
however	O
,	O
in	O
afﬁne	O
geometry	O
the	O
euclidean	O
classiﬁcation	O
is	O
still	O
valid	O
because	O
it	O
depends	O
only	O
on	O
the	O
relation	B
of	O
l∞	O
to	O
the	O
conic	B
.	O
the	O
relation	B
for	O
the	O
three	O
types	O
of	B
conic	I
is	O
illustrated	O
in	O
ﬁgure	O
2.20	O
.	O
2.9	O
fixed	O
points	O
and	O
lines	B
61	O
e	O
1	O
h	O
e	O
1	O
e	O
2	O
e	O
3	O
x	O
e	O
2	O
e	O
3	O
x	O
/	O
fig	O
.	O
2.21.	O
fixed	O
points	O
and	O
lines	B
of	O
a	O
plane	B
projective	O
transformation	B
.	O
there	O
are	O
three	O
ﬁxed	B
points	I
,	O
and	O
three	O
ﬁxed	O
lines	O
through	O
these	O
points	O
.	O
the	O
ﬁxed	O
lines	O
and	O
points	O
may	O
be	O
complex	O
.	O
algebraically	O
,	O
the	O
ﬁxed	B
points	I
are	O
the	O
eigenvectors	O
,	O
ei	O
,	O
of	O
the	O
point	O
transformation	B
(	O
x	O
(	O
cid:1	O
)	O
=	O
hx	O
)	O
,	O
and	O
the	O
ﬁxed	O
lines	O
eigenvectors	O
of	O
the	O
line	O
transformation	B
(	O
l	O
(	O
cid:1	O
)	O
=	O
h−tl	O
)	O
.	O
note	O
,	O
the	O
ﬁxed	O
line	O
is	O
not	O
ﬁxed	O
pointwise	O
:	O
under	O
the	O
transformation	B
,	O
points	O
on	O
the	O
line	B
are	O
mapped	O
to	O
other	O
points	O
on	O
the	O
line	B
;	O
only	O
the	O
ﬁxed	B
points	I
are	O
mapped	O
to	O
themselves	O
.	O
2.9	O
fixed	O
points	O
and	O
lines	B
we	O
have	O
seen	O
,	O
by	O
the	O
examples	B
of	O
l∞	O
and	O
the	O
circular	B
points	I
,	O
that	O
points	O
and	O
lines	B
may	O
be	O
ﬁxed	O
under	O
a	O
projective	B
transformation	I
.	O
in	O
this	O
section	O
the	O
idea	O
is	O
investigated	O
more	O
thoroughly	O
.	O
here	O
,	O
the	O
source	O
and	O
destination	O
planes	O
are	O
identiﬁed	O
(	O
the	O
same	O
)	O
so	O
that	O
the	O
trans-	O
formation	O
maps	O
points	O
x	O
to	O
points	O
x	O
(	O
cid:2	O
)	O
in	O
the	O
same	O
coordinate	O
system	O
.	O
the	O
key	O
idea	O
is	O
that	O
an	O
eigenvector	O
corresponds	O
to	O
a	O
ﬁxed	O
point	O
of	O
the	O
transformation	O
,	O
since	O
for	O
an	O
eigenvector	O
e	O
with	O
eigenvalue	O
λ	O
,	O
he	O
=	O
λe	O
and	O
e	O
and	O
λe	O
represent	O
the	O
same	O
point	O
.	O
often	O
the	O
eigenvector	O
and	O
eigenvalue	O
have	O
physical	O
or	O
geometric	B
signiﬁcance	O
in	O
computer	O
vision	O
applications	O
.	O
a	O
3×3	O
matrix	B
has	O
three	O
eigenvalues	O
and	O
consequently	O
a	O
plane	B
projective	O
transforma-	O
tion	O
has	O
up	O
to	O
three	O
ﬁxed	B
points	I
,	O
if	O
the	O
eigenvalues	O
are	O
distinct	O
.	O
since	O
the	O
characteristic	O
equation	O
is	O
a	O
cubic	O
in	O
this	O
case	O
,	O
one	O
or	O
three	O
of	O
the	O
eigenvalues	O
,	O
and	O
corresponding	O
eigenvectors	O
,	O
is	O
real	O
.	O
a	O
similar	O
development	O
can	O
be	O
given	O
for	O
ﬁxed	O
lines	B
,	O
which	O
,	O
since	O
lines	B
transform	O
as	O
(	O
2.6–p36	O
)	O
l	O
(	O
cid:2	O
)	O
=	O
h−tl	O
,	O
correspond	O
to	O
the	O
eigenvectors	O
of	O
ht	O
.	O
the	O
relationship	O
between	O
the	O
ﬁxed	B
points	I
and	O
ﬁxed	O
lines	O
is	O
shown	O
in	O
ﬁgure	O
2.21.	O
note	O
the	O
lines	B
are	O
ﬁxed	O
as	O
a	O
set	O
,	O
not	O
ﬁxed	O
pointwise	O
,	O
i.e	O
.	O
a	O
point	B
on	O
the	O
line	B
is	O
mapped	O
to	O
another	O
point	B
on	O
the	O
line	B
,	O
but	O
in	O
general	O
the	O
source	O
and	O
destination	O
points	O
will	O
differ	O
.	O
there	O
is	O
nothing	O
mysterious	O
here	O
:	O
the	O
projective	B
transformation	I
of	O
the	O
plane	B
induces	O
a	O
1d	O
projective	B
transformation	I
on	O
the	O
line	B
.	O
a	O
1d	O
projective	B
transformation	I
is	O
represented	O
by	O
a	O
2×	O
2	O
homogeneous	O
matrix	O
(	O
section	O
2.5	O
)	O
.	O
this	O
1d	O
projectivity	B
has	O
two	O
ﬁxed	O
points	O
corresponding	O
to	O
the	O
two	O
eigenvectors	O
of	O
the	O
2×	O
2	O
matrix	B
.	O
these	O
ﬁxed	B
points	I
are	O
those	O
of	O
the	O
2d	O
projective	B
transformation	I
.	O
a	O
further	O
specialization	O
concerns	O
repeated	O
eigenvalues	O
.	O
suppose	O
two	O
of	O
the	O
eigen-	O
values	O
(	O
λ2	O
,	O
λ3	O
say	O
)	O
are	O
identical	O
,	O
and	O
that	O
there	O
are	O
two	O
distinct	O
eigenvectors	O
(	O
e2	O
,	O
e3	O
)	O
,	O
corresponding	O
to	O
λ2	O
=	O
λ3	O
.	O
then	O
the	O
line	B
containing	O
the	O
eigenvectors	O
e2	O
,	O
e3	O
will	O
be	O
ﬁxed	O
pointwise	O
,	O
i.e	O
.	O
it	O
is	O
a	O
line	B
of	O
ﬁxed	B
points	I
.	O
for	O
suppose	O
x	O
=	O
αe2	O
+	O
βe3	O
;	O
then	O
hx	O
=	O
λ2αe2	O
+	O
λ2βe3	O
=	O
λ2x	O
62	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
i.e	O
.	O
a	O
point	B
on	O
the	O
line	B
through	O
two	O
degenerate	O
eigenvectors	O
is	O
mapped	O
to	O
itself	O
(	O
only	O
differing	O
by	O
scale	O
)	O
.	O
another	O
possibility	O
is	O
that	O
λ2	O
=	O
λ3	O
,	O
but	O
that	O
there	O
is	O
only	O
one	O
corresponding	O
eigenvector	O
.	O
in	O
this	O
case	O
,	O
the	O
eigenvector	O
has	O
algebraic	B
dimension	O
equal	O
to	O
two	O
,	O
but	O
geometric	B
dimension	O
equal	O
to	O
one	O
.	O
then	O
there	O
is	O
one	O
fewer	O
ﬁxed	O
point	O
(	O
2	O
instead	O
of	O
3	O
)	O
.	O
various	O
cases	O
of	O
repeated	O
eigenvalues	O
are	O
discussed	O
further	O
in	O
appendix	O
7	O
(	O
p628	O
)	O
.	O
we	O
now	O
examine	O
the	O
ﬁxed	B
points	I
and	O
lines	B
of	O
the	O
hierarchy	B
of	I
projective	O
transforma-	O
tion	O
subgroups	O
of	O
section	O
2.4.	O
afﬁne	B
transformations	O
,	O
and	O
the	O
more	O
specialized	O
forms	O
,	O
have	O
two	O
eigenvectors	O
which	O
are	O
ideal	O
points	O
(	O
x3	O
=	O
0	O
)	O
,	O
and	O
which	O
correspond	O
to	O
the	O
eigenvectors	O
of	O
the	O
upper	O
left	O
2	O
×	O
2	O
matrix	B
.	O
the	O
third	O
eigenvector	O
is	O
ﬁnite	B
in	O
general	O
.	O
a	O
euclidean	O
matrix	O
.	O
the	O
two	O
ideal	O
ﬁxed	B
points	I
are	O
the	O
complex	O
conjugate	O
pair	O
of	O
cir-	O
cular	O
points	O
i	O
,	O
j	O
,	O
with	O
corresponding	O
eigenvalues	O
{	O
eiθ	O
,	O
e	O
−iθ	O
}	O
,	O
where	O
θ	O
is	O
the	O
rotation	B
an-	O
gle	O
.	O
the	O
third	O
eigenvector	O
,	O
which	O
has	O
unit	O
eigenvalue	O
,	O
is	O
called	O
the	O
pole	O
.	O
the	O
euclidean	O
transformation	O
is	O
equal	O
to	O
a	O
pure	O
rotation	B
by	O
θ	O
about	O
this	O
point	B
with	O
no	B
translation	I
.	O
a	O
special	O
case	O
is	O
that	O
of	O
a	O
pure	O
translation	O
(	O
i.e	O
.	O
where	O
θ	O
=	O
0	O
)	O
.	O
here	O
the	O
eigenvalues	O
are	O
triply	O
degenerate	B
.	O
the	O
line	B
at	I
inﬁnity	I
is	O
ﬁxed	O
pointwise	O
,	O
and	O
there	O
is	O
a	O
pencil	O
of	O
ﬁxed	O
lines	B
through	O
the	O
point	B
(	O
tx	O
,	O
ty	O
,	O
0	O
)	O
t	O
which	O
corresponds	O
to	O
the	O
translation	O
direction	O
.	O
consequently	O
lines	B
parallel	O
to	O
t	O
are	O
ﬁxed	O
.	O
this	O
is	O
an	O
example	O
of	O
an	O
elation	B
(	O
see	O
section	O
a7.3	O
(	O
p631	O
)	O
)	O
.	O
a	O
similarity	B
matrix	I
.	O
the	O
two	O
ideal	O
ﬁxed	B
points	I
are	O
again	O
the	O
circular	B
points	I
.	O
the	O
eigenvalues	O
are	O
{	O
1	O
,	O
seiθ	O
,	O
se	O
−iθ	O
}	O
.	O
the	O
action	O
can	O
be	O
understood	O
as	O
a	O
rotation	O
and	O
isotropic	O
scaling	B
by	O
s	O
about	O
the	O
ﬁnite	B
ﬁxed	O
point	B
.	O
note	O
that	O
the	O
eigenvalues	O
of	O
the	O
circular	O
points	O
again	O
encode	O
the	O
angle	B
of	O
rotation	B
.	O
an	O
afﬁne	B
matrix	I
.	O
the	O
two	O
ideal	O
ﬁxed	B
points	I
can	O
be	O
real	O
or	O
complex	O
conjugates	O
,	O
but	O
the	O
ﬁxed	O
line	O
l∞	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
through	O
these	O
points	O
is	O
real	O
in	O
either	O
case	O
.	O
2.10	O
closure	O
2.10.1	O
the	O
literature	O
a	O
gentle	O
introduction	O
to	O
plane	O
projective	B
geometry	O
,	O
written	O
for	O
computer	O
vision	O
re-	O
searchers	O
,	O
is	O
given	O
in	O
the	O
appendix	O
of	O
mundy	O
and	O
zisserman	O
[	O
mundy-92	O
]	O
.	O
a	O
more	O
formal	O
approach	O
is	O
that	O
of	O
semple	O
and	O
kneebone	O
[	O
semple-79	O
]	O
,	O
but	O
[	O
springer-64	O
]	O
is	O
more	O
readable	O
.	O
on	O
the	O
recovery	O
of	O
afﬁne	B
and	O
metric	B
scene	O
properties	B
for	O
an	O
imaged	O
plane	B
,	O
collins	O
and	O
beveridge	O
[	O
collins-93	O
]	O
use	O
the	O
vanishing	O
line	O
to	O
recover	O
afﬁne	B
properties	I
from	O
satellite	O
images	O
,	O
and	O
liebowitz	O
and	O
zisserman	O
[	O
liebowitz-98	O
]	O
use	O
metric	O
information	O
on	O
the	O
plane	B
,	O
such	O
as	O
right	O
angles	O
,	O
to	O
recover	O
the	O
metric	B
geometry	O
.	O
2.10.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
afﬁne	B
transformations	O
.	O
2.10	O
closure	O
63	O
(	O
a	O
)	O
show	O
that	O
an	O
afﬁne	B
transformation	I
can	O
map	O
a	O
circle	O
to	O
an	O
ellipse	O
,	O
but	O
can	O
not	O
map	O
an	O
ellipse	O
to	O
a	O
hyperbola	O
or	O
parabola	O
.	O
(	O
b	O
)	O
prove	O
that	O
under	O
an	O
afﬁne	B
transformation	I
the	O
ratio	O
of	O
lengths	O
on	O
parallel	O
line	B
segments	O
is	O
an	O
invariant	O
,	O
but	O
that	O
the	O
ratio	O
of	O
two	O
lengths	O
that	O
are	O
not	O
parallel	B
is	O
not	O
.	O
(	O
ii	O
)	O
projective	B
transformations	O
.	O
show	O
that	O
there	O
is	O
a	O
three-parameter	O
family	O
of	O
projective	O
transformations	O
which	O
ﬁx	O
(	O
as	O
a	O
set	O
)	O
a	O
unit	O
circle	O
at	O
the	O
origin	O
,	O
i.e	O
.	O
a	O
unit	O
circle	O
at	O
the	O
origin	O
is	O
mapped	O
to	O
a	O
unit	O
circle	O
at	O
the	O
origin	O
(	O
hint	O
,	O
use	O
result	O
2.13	O
(	O
p37	O
)	O
to	O
compute	O
the	O
transformation	B
)	O
.	O
what	O
is	O
the	O
geometric	B
interpretation	I
of	O
this	O
family	O
?	O
(	O
iii	O
)	O
isotropies	O
.	O
show	O
that	O
two	O
lines	O
have	O
an	O
invariant	O
under	O
a	O
similarity	B
transfor-	O
mation	O
;	O
and	O
that	O
two	O
lines	O
and	O
two	O
points	O
have	O
an	O
invariant	O
under	O
a	O
projective	B
transformation	I
.	O
in	O
both	O
cases	O
the	O
equality	O
case	O
of	O
the	O
counting	O
argument	O
(	O
result	O
2.16	O
(	O
p43	O
)	O
)	O
is	O
violated	O
.	O
show	O
that	O
for	O
these	O
two	O
cases	O
the	O
respective	O
transforma-	O
tion	O
can	O
not	O
be	O
fully	O
determined	O
,	O
although	O
it	O
is	O
partially	O
determined	O
.	O
(	O
iv	O
)	O
invariants	B
.	O
using	O
the	O
transformation	B
rules	O
for	O
points	O
,	O
lines	B
and	O
conics	O
show	O
:	O
(	O
a	O
)	O
two	O
lines	O
,	O
l1	O
,	O
l2	O
,	O
and	O
two	O
points	O
,	O
x1	O
,	O
x2	O
,	O
not	O
lying	O
on	O
the	O
lines	B
have	O
the	O
invariant	O
i	O
=	O
(	O
lt	O
1	O
(	O
lt	O
1	O
x1	O
)	O
(	O
lt	O
2	O
x2	O
)	O
(	O
lt	O
2	O
x2	O
)	O
x1	O
)	O
(	O
see	O
the	O
previous	O
question	O
)	O
.	O
(	O
b	O
)	O
a	O
conic	B
c	O
and	O
two	O
points	O
,	O
x1	O
and	O
x2	O
,	O
in	O
general	O
position	O
have	O
the	O
invari-	O
ant	O
i	O
=	O
(	O
xt	O
cx2	O
)	O
2	O
1	O
cx1	O
)	O
(	O
xt	O
2	O
cx2	O
)	O
.	O
(	O
xt	O
1	O
(	O
c	O
)	O
show	O
that	O
the	O
projectively	O
invariant	O
expression	O
for	O
measuring	O
an-	O
gles	O
(	O
2.22	O
)	O
is	O
equivalent	B
to	O
laguerre	O
’	O
s	O
projectively	O
invariant	O
expression	O
involving	O
a	O
cross	B
ratio	I
with	O
the	O
circular	B
points	I
(	O
see	O
[	O
springer-64	O
]	O
)	O
.	O
(	O
v	O
)	O
the	O
cross	B
ratio	I
.	O
prove	O
the	O
invariance	O
of	O
the	O
cross	B
ratio	I
of	O
four	O
collinear	O
points	O
under	O
projective	B
transformations	O
of	O
the	O
line	O
(	O
2.18–p45	O
)	O
.	O
hint	O
,	O
start	O
with	O
the	O
transformation	B
of	O
two	O
points	O
on	O
the	O
line	B
written	O
as	O
¯x	O
(	O
cid:2	O
)	O
i	O
=	O
λih2×2¯xi	O
and	O
¯x	O
(	O
cid:2	O
)	O
j	O
=	O
λjh2×2¯xj	O
,	O
where	O
equality	O
is	O
not	O
up	O
to	O
scale	O
,	O
then	O
from	O
the	O
properties	B
of	O
determinants	O
show	O
that	O
|¯x	O
(	O
cid:2	O
)	O
|	O
=	O
λiλj	O
det	O
h2×2|¯xi¯xj|	O
and	O
continue	O
from	O
here	O
.	O
i¯x	O
(	O
cid:2	O
)	O
an	O
alternative	O
derivation	B
method	O
is	O
given	O
in	O
[	O
semple-79	O
]	O
.	O
j	O
(	O
vi	O
)	O
polarity	B
.	O
figure	O
2.19	O
shows	O
the	O
geometric	B
construction	O
of	O
the	O
polar	O
line	B
for	O
a	O
point	B
x	O
outside	O
an	O
ellipse	O
.	O
give	O
a	O
geometric	B
construction	O
for	O
the	O
polar	O
when	O
the	O
point	B
is	O
inside	O
.	O
hint	O
,	O
start	O
by	O
choosing	O
any	O
line	B
through	O
x.	O
the	O
pole	O
of	O
this	O
line	B
is	O
a	O
point	B
on	O
the	O
polar	O
of	O
x	O
.	O
(	O
vii	O
)	O
conics	O
.	O
if	O
the	O
sign	O
of	O
the	O
conic	O
matrix	B
c	O
is	O
chosen	O
such	O
that	O
two	O
eigenvalues	O
are	O
positive	O
and	O
one	O
negative	O
,	O
then	O
internal	B
and	O
external	O
points	O
may	O
be	O
distin-	O
guished	O
according	O
to	O
the	O
sign	O
of	O
xtcx	O
:	O
the	O
point	B
x	O
is	O
inside/on/outside	O
the	O
conic	B
64	O
2	O
projective	B
geometry	O
and	O
transformations	B
of	I
2d	O
c	O
if	O
xtcx	O
is	O
negative/zero/positive	O
respectively	O
.	O
this	O
can	O
seen	O
by	O
example	O
from	O
a	O
circle	O
c	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
−1	O
)	O
.	O
under	O
projective	B
transformations	O
internality	O
is	O
in-	O
variant	O
,	O
though	O
its	O
interpretation	O
requires	O
care	O
in	O
the	O
case	O
of	O
an	O
ellipse	O
being	O
transformed	O
to	O
a	O
hyperbola	O
(	O
see	O
ﬁgure	O
2.20	O
)	O
.	O
(	O
viii	O
)	O
dual	B
conics	O
.	O
show	O
that	O
the	O
matrix	B
[	O
l	O
]	O
×c	O
[	O
l	O
]	O
×	O
represents	O
a	O
rank	O
2	O
dual	B
conic	I
which	O
consists	O
of	O
the	O
two	O
points	O
at	O
which	O
the	O
line	B
l	O
intersects	O
the	O
(	O
point	B
)	O
conic	B
c	O
(	O
the	O
notation	O
[	O
l	O
]	O
×	O
is	O
deﬁned	O
in	O
(	O
a4.5–p581	O
)	O
)	O
.	O
(	O
ix	O
)	O
special	O
projective	O
transformations	O
.	O
suppose	O
points	O
on	O
a	O
scene	O
plane	B
are	O
re-	O
lated	O
by	O
reﬂection	O
in	O
a	O
line	B
:	O
for	O
example	O
,	O
a	O
plane	B
object	O
with	O
bilateral	O
symmetry	O
.	O
show	O
that	O
in	O
a	O
perspective	O
image	O
of	O
the	O
plane	O
the	O
points	O
are	O
related	O
by	O
a	O
pro-	O
jectivity	O
h	O
satisfying	O
h2	O
=	O
i.	O
furthermore	O
,	O
show	O
that	O
under	O
h	O
there	O
is	O
a	O
line	B
of	O
ﬁxed	B
points	I
corresponding	O
to	O
the	O
imaged	O
reﬂection	O
line	B
,	O
and	O
that	O
h	O
has	O
an	O
eigenvector	O
,	O
not	O
lying	O
on	O
this	O
line	B
,	O
which	O
is	O
the	O
vanishing	O
point	O
of	O
the	O
reﬂection	O
direction	O
(	O
h	O
is	O
a	O
planar	B
harmonic	I
homology	I
,	O
see	O
section	O
a7.2	O
(	O
p629	O
)	O
)	O
.	O
now	O
suppose	O
that	O
the	O
points	O
are	O
related	O
by	O
a	O
ﬁnite	B
rotational	O
symmetry	O
:	O
for	O
example	O
,	O
points	O
on	O
a	O
hexagonal	O
bolt	O
head	O
.	O
show	O
in	O
this	O
case	O
that	O
hn	O
=	O
i	O
,	O
where	O
n	O
is	O
the	O
order	O
of	O
rotational	O
symmetry	O
(	O
6	O
for	O
a	O
hexagonal	O
symmetry	O
)	O
,	O
that	O
the	O
eigenvalues	O
of	O
h	O
determine	O
the	O
rotation	B
angle	O
,	O
and	O
that	O
the	O
eigenvector	O
corresponding	O
to	O
the	O
real	O
eigenvalue	O
is	O
the	O
image	O
of	O
the	O
centre	O
of	O
the	O
rotational	O
symmetry	O
.	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
this	O
chapter	O
describes	O
the	O
properties	B
and	O
entities	O
of	O
projective	O
3-space	O
,	O
or	O
ip3	O
.	O
many	O
of	O
these	O
are	O
straightforward	O
generalizations	O
of	O
those	O
of	O
the	O
projective	O
plane	B
,	O
described	O
in	O
chapter	O
2.	O
for	O
example	O
,	O
in	O
ip3	O
euclidean	O
3-space	O
is	O
augmented	O
with	O
a	O
set	O
of	O
ideal	O
points	O
which	O
are	O
on	O
a	O
plane	O
at	B
inﬁnity	I
,	O
π∞	O
.	O
this	O
is	O
the	O
analogue	O
of	O
l∞	O
in	O
ip2	O
.	O
par-	O
allel	O
lines	B
,	O
and	O
now	O
parallel	B
planes	O
,	O
intersect	O
on	O
π∞	O
.	O
not	O
surprisingly	O
,	O
homogeneous	O
coordinates	O
again	O
play	O
an	O
important	O
role	O
,	O
here	O
with	O
all	O
dimensions	O
increased	O
by	O
one	O
.	O
however	O
,	O
additional	O
properties	B
appear	O
by	O
virtue	O
of	O
the	O
extra	O
dimension	O
.	O
for	O
example	O
,	O
two	O
lines	O
always	O
intersect	O
on	O
the	O
projective	B
plane	I
,	O
but	O
they	O
need	O
not	O
intersect	O
in	O
3-space	O
.	O
the	O
reader	O
should	O
be	O
familiar	O
with	O
the	O
ideas	O
and	O
notation	O
of	O
chapter	O
2	O
before	O
read-	O
ing	O
this	O
chapter	O
.	O
we	O
will	O
concentrate	O
here	O
on	O
the	O
differences	O
and	O
additional	O
geometry	O
introduced	O
by	O
adding	O
the	O
extra	O
dimension	O
,	O
and	O
will	O
not	O
repeat	O
the	O
bulk	O
of	O
the	O
material	O
of	O
the	O
previous	O
chapter	O
.	O
3.1	O
points	O
and	O
projective	B
transformations	O
a	O
point	B
x	O
in	O
3-space	O
is	O
represented	O
in	O
homogeneous	O
coordinates	B
as	O
a	O
4-vector	O
.	O
specif-	O
ically	O
,	O
the	O
homogeneous	O
vector	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
,	O
x4	O
)	O
t	O
with	O
x4	O
(	O
cid:5	O
)	O
=	O
0	O
represents	O
the	O
point	B
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
of	O
ir3	O
with	O
inhomogeneous	O
coordinates	B
x	O
=	O
x1/x4	O
,	O
y	O
=	O
x2/x4	O
,	O
z	O
=	O
x3/x4	O
.	O
for	O
example	O
,	O
a	O
homogeneous	B
representation	I
of	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
is	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t.	O
homo-	O
geneous	O
points	O
with	O
x4	O
=	O
0	O
represent	O
points	O
at	O
inﬁnity	O
.	O
a	O
projective	B
transformation	I
acting	O
on	O
ip3	O
is	O
a	O
linear	B
transformation	O
on	O
homogeneous	O
4-vectors	O
represented	O
by	O
a	O
non-singular	O
4×4	O
matrix	B
:	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
.	O
the	O
matrix	B
h	O
represent-	O
ing	O
the	O
transformation	B
is	O
homogeneous	O
and	O
has	O
15	O
degrees	B
of	I
freedom	I
.	O
the	O
degrees	B
of	I
freedom	I
follow	O
from	O
the	O
16	O
elements	O
of	O
the	O
matrix	O
less	O
one	O
for	O
overall	O
scaling	B
.	O
as	O
in	O
the	O
case	O
of	O
planar	O
projective	B
transformations	O
,	O
the	O
map	O
is	O
a	O
collineation	B
(	O
lines	B
are	O
mapped	O
to	O
lines	O
)	O
,	O
which	O
preserves	O
incidence	B
relations	I
such	O
as	O
the	O
intersection	B
point	O
of	O
a	O
line	O
with	O
a	O
plane	B
,	O
and	O
order	O
of	O
contact	O
.	O
65	O
66	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
3.2	O
representing	O
and	O
transforming	O
planes	O
,	O
lines	B
and	O
quadrics	B
in	O
ip3	O
points	O
and	O
planes	O
are	O
dual	B
,	O
and	O
their	O
representation	B
and	O
development	O
is	O
analogous	O
to	O
the	O
point–line	O
duality	B
in	O
ip2	O
.	O
lines	B
are	O
self-dual	O
in	O
ip3	O
.	O
3.2.1	O
planes	O
a	O
plane	B
in	O
3-space	O
may	O
be	O
written	O
as	O
π1x	O
+	O
π2y	O
+	O
π3z	O
+	O
π4	O
=	O
0	O
.	O
(	O
3.1	O
)	O
clearly	O
this	O
equation	O
is	O
unaffected	O
by	O
multiplication	O
by	O
a	O
non-zero	O
scalar	O
,	O
so	O
only	O
the	O
three	O
independent	O
ratios	O
{	O
π1	O
:	O
π2	O
:	O
π3	O
:	O
π4	O
}	O
of	O
the	O
plane	O
coefﬁcients	O
are	O
signiﬁcant	O
.	O
it	O
follows	O
that	O
a	O
plane	B
has	O
3	O
degrees	B
of	I
freedom	I
in	O
3-space	O
.	O
the	O
homogeneous	O
represen-	O
tation	O
of	O
the	O
plane	O
is	O
the	O
4-vector	O
π	O
=	O
(	O
π1	O
,	O
π2	O
,	O
π3	O
,	O
π4	O
)	O
t.	O
homogenizing	O
(	O
3.1	O
)	O
by	O
the	O
replacements	O
x	O
(	O
cid:6	O
)	O
→	O
x1/x4	O
,	O
y	O
(	O
cid:6	O
)	O
→	O
x2/x4	O
,	O
z	O
(	O
cid:6	O
)	O
→	O
x3/x4	O
gives	O
π1x1	O
+	O
π2x2	O
+	O
π3x3	O
+	O
π4x4	O
=	O
0	O
or	O
more	O
concisely	O
πtx	O
=	O
0	O
(	O
3.2	O
)	O
which	O
expresses	O
that	O
the	O
point	B
x	O
is	O
on	O
the	O
plane	B
π.	O
the	O
ﬁrst	O
3	O
components	O
of	O
π	O
correspond	O
to	O
the	O
plane	B
normal	O
of	O
euclidean	O
geometry	O
3-vector	O
notation	O
as	O
n.	O
(	O
cid:22	O
)	O
x	O
+	O
d	O
=	O
0	O
,	O
where	O
n	O
=	O
(	O
π1	O
,	O
π2	O
,	O
π3	O
)	O
t	O
,	O
(	O
cid:22	O
)	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
,	O
x4	O
=	O
1	O
–	O
using	O
inhomogeneous	O
notation	O
(	O
3.2	O
)	O
becomes	O
the	O
familiar	O
plane	B
equation	O
written	O
in	O
and	O
d	O
=	O
π4	O
.	O
in	O
this	O
form	O
d/	O
(	O
cid:10	O
)	O
n	O
(	O
cid:10	O
)	O
is	O
the	O
distance	B
of	O
the	O
plane	B
from	O
the	O
origin	O
.	O
join	O
and	O
incidence	B
relations	I
.	O
planes	O
and	O
points	O
and	O
lines	B
.	O
for	O
example	O
,	O
in	O
ip3	O
there	O
are	O
numerous	O
geometric	B
relations	O
between	O
(	O
i	O
)	O
a	O
plane	B
is	O
deﬁned	O
uniquely	O
by	O
the	O
join	O
of	O
three	O
points	O
,	O
or	O
the	O
join	O
of	O
a	O
line	O
and	O
point	B
,	O
in	O
general	O
position	O
(	O
i.e	O
.	O
the	O
points	O
are	O
not	O
collinear	O
or	O
incident	O
with	O
the	O
line	B
in	O
the	O
latter	O
case	O
)	O
.	O
(	O
ii	O
)	O
two	O
distinct	O
planes	O
intersect	O
in	O
a	O
unique	O
line	B
.	O
(	O
iii	O
)	O
three	O
distinct	O
planes	O
intersect	O
in	O
a	O
unique	O
point	B
.	O
these	O
relations	O
have	O
algebraic	B
representations	O
which	O
will	O
now	O
be	O
developed	O
in	O
the	O
case	O
of	B
points	I
and	O
planes	O
.	O
the	O
representations	O
of	O
the	O
relations	O
involving	O
lines	B
are	O
not	O
as	O
simple	O
as	O
those	O
arising	O
from	O
3d	O
vector	O
algebra	O
of	O
ip2	O
(	O
e.g	O
.	O
l	O
=	O
x	O
×	O
y	O
)	O
,	O
and	O
are	O
postponed	O
until	O
line	B
representations	O
are	O
introduced	O
in	O
section	O
3.2.2.	O
three	O
points	O
deﬁne	O
a	O
plane	B
.	O
suppose	O
three	O
points	O
xi	O
are	O
incident	O
with	O
the	O
plane	B
π.	O
then	O
each	O
point	B
satisﬁes	O
(	O
3.2	O
)	O
and	O
thus	O
πtxi	O
=	O
0	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
stacking	O
these	O
equations	O
into	O
a	O
matrix	B
gives	O
(	O
3.3	O
)	O
	O
π	O
=	O
0	O
.	O
	O
xt	O
1	O
xt	O
2	O
xt	O
3	O
3.2	O
representing	O
and	O
transforming	O
planes	O
,	O
lines	B
and	O
quadrics	B
67	O
since	O
three	O
points	O
x1	O
,	O
x2	O
and	O
x3	O
in	O
general	O
position	O
are	O
linearly	O
independent	O
,	O
it	O
fol-	O
lows	O
that	O
the	O
3	O
×	O
4	O
matrix	B
composed	O
of	O
the	O
points	O
as	O
rows	O
has	O
rank	O
3.	O
the	O
plane	B
π	O
deﬁned	O
by	O
the	O
points	O
is	O
thus	O
obtained	O
uniquely	O
(	O
up	O
to	O
scale	O
)	O
as	O
the	O
1-dimensional	O
(	O
right	O
)	O
null-space	B
.	O
if	O
the	O
matrix	B
has	O
only	O
a	O
rank	O
of	O
2	O
,	O
and	O
consequently	O
the	O
null-space	B
is	O
2-dimensional	O
,	O
then	O
the	O
points	O
are	O
collinear	O
,	O
and	O
deﬁne	O
a	O
pencil	O
of	O
planes	O
with	O
the	O
line	B
of	O
collinear	O
points	O
as	O
axis	O
.	O
in	O
ip2	O
,	O
where	O
points	O
are	O
dual	O
to	O
lines	O
,	O
a	O
line	B
l	O
through	O
two	O
points	O
x	O
,	O
y	O
can	O
similarly	O
be	O
obtained	O
as	O
the	O
null-space	B
of	O
the	O
2	O
×	O
3	O
matrix	B
with	O
xt	O
and	O
yt	O
as	O
rows	O
.	O
however	O
,	O
a	O
more	O
convenient	O
direct	O
formula	O
l	O
=	O
x	O
×	O
y	O
is	O
also	O
available	O
from	O
vector	O
algebra	O
.	O
in	O
ip3	O
the	O
analogous	O
expression	O
is	O
obtained	O
from	O
properties	O
of	O
determinants	O
and	O
minors	O
.	O
we	O
start	O
from	O
the	O
matrix	B
m	O
=	O
[	O
x	O
,	O
x1	O
,	O
x2	O
,	O
x3	O
]	O
which	O
is	O
composed	O
of	O
a	O
general	O
point	B
x	O
and	O
the	O
three	O
points	O
xi	O
which	O
deﬁne	O
the	O
plane	B
π.	O
the	O
determinant	O
det	O
m	O
=	O
0	O
when	O
x	O
lies	O
on	O
π	O
since	O
the	O
point	B
x	O
is	O
then	O
expressible	O
as	O
a	O
linear	B
combination	O
of	O
the	O
points	O
xi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
expanding	O
the	O
determinant	O
about	O
the	O
column	O
x	O
we	O
obtain	O
det	O
m	O
=	O
x1d234	O
−	O
x2d134	O
+	O
x3d124	O
−	O
x4d123	O
where	O
djkl	O
is	O
the	O
determinant	O
formed	O
from	O
the	O
jkl	O
rows	O
of	O
the	O
4×3	O
matrix	B
[	O
x1	O
,	O
x2	O
,	O
x3	O
]	O
.	O
since	O
det	O
m	O
=	O
0	O
for	O
points	O
on	O
π	O
we	O
can	O
then	O
read	O
off	O
the	O
plane	B
coefﬁcients	O
as	O
t	O
.	O
1	O
1	O
x3	O
=	O
x2	O
=	O
x1	O
=	O
π	O
=	O
(	O
d234	O
,	O
−d134	O
,	O
d124	O
,	O
−d123	O
)	O
this	O
is	O
the	O
solution	B
vector	O
(	O
the	O
null-space	B
)	O
of	O
(	O
3.3	O
)	O
above	O
.	O
example	O
3.1.	O
suppose	O
the	O
three	O
points	O
deﬁning	O
the	O
plane	B
are	O
(	O
cid:20	O
)	O
(	O
cid:22	O
)	O
x1	O
(	O
cid:20	O
)	O
(	O
cid:22	O
)	O
x2	O
(	O
cid:21	O
)	O
(	O
cid:21	O
)	O
where	O
(	O
cid:22	O
)	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t.	O
then	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
=	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
y1	O
−	O
y3	O
y2	O
−	O
y3	O
y3	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
=	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
y1	O
y2	O
y3	O
z1	O
−	O
z3	O
(	O
cid:20	O
)	O
(	O
(	O
cid:22	O
)	O
x1	O
−	O
(	O
cid:22	O
)	O
x3	O
)	O
×	O
(	O
(	O
cid:22	O
)	O
x2	O
−	O
(	O
cid:22	O
)	O
x3	O
)	O
−	O
(	O
cid:22	O
)	O
xt	O
3	O
(	O
(	O
cid:22	O
)	O
x1	O
×	O
(	O
cid:22	O
)	O
x2	O
)	O
plane	B
normal	O
is	O
computed	O
as	O
(	O
(	O
cid:22	O
)	O
x1	O
−	O
(	O
cid:22	O
)	O
x3	O
)	O
×	O
(	O
(	O
cid:22	O
)	O
x2	O
−	O
(	O
cid:22	O
)	O
x3	O
)	O
.	O
and	O
similarly	O
for	O
the	O
other	O
components	O
,	O
giving	O
z2	O
−	O
z3	O
d234	O
=	O
π	O
=	O
z3	O
1	O
z1	O
1	O
z2	O
1	O
z3	O
1	O
0	O
0	O
(	O
3.4	O
)	O
1	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
(	O
cid:22	O
)	O
x3	O
(	O
cid:15	O
)	O
(	O
(	O
cid:22	O
)	O
x1	O
−	O
(	O
cid:22	O
)	O
x3	O
)	O
×	O
(	O
(	O
cid:22	O
)	O
x2	O
−	O
(	O
cid:22	O
)	O
x3	O
)	O
(	O
cid:21	O
)	O
(	O
cid:16	O
)	O
1	O
.	O
	O
x	O
=	O
0	O
.	O
	O
πt	O
1	O
πt	O
2	O
πt	O
3	O
this	O
is	O
the	O
familiar	O
result	O
from	O
euclidean	O
vector	B
geometry	I
where	O
,	O
for	O
example	O
,	O
the	O
(	O
cid:2	O
)	O
three	O
planes	O
deﬁne	O
a	O
point	B
.	O
the	O
development	O
here	O
is	O
dual	O
to	O
the	O
case	O
of	O
three	O
points	O
deﬁning	O
a	O
plane	B
.	O
the	O
intersection	B
point	O
x	O
of	O
three	O
planes	O
πi	O
can	O
be	O
computed	O
straightforwardly	O
as	O
the	O
(	O
right	O
)	O
null-space	B
of	O
the	O
3	O
×	O
4	O
matrix	B
composed	O
of	O
the	O
planes	O
as	O
rows	O
:	O
(	O
3.5	O
)	O
68	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
fig	O
.	O
3.1.	O
a	O
line	B
may	O
be	O
speciﬁed	O
by	O
its	O
points	O
of	O
intersection	B
with	O
two	O
orthogonal	O
planes	O
.	O
each	O
inter-	O
section	O
point	B
has	O
2	O
degrees	B
of	I
freedom	I
,	O
which	O
demonstrates	O
that	O
a	O
line	B
in	O
ip3	O
has	O
a	O
total	O
of	O
4	O
degrees	B
of	I
freedom	I
.	O
a	O
direct	O
solution	O
for	O
x	O
,	O
in	O
terms	O
of	O
determinants	O
of	O
3	O
×	O
3	O
submatrices	O
,	O
is	O
obtained	O
as	O
an	O
analogue	O
of	O
(	O
3.4	O
)	O
,	O
though	O
computationally	O
a	O
numerical	O
solution	B
would	O
be	O
obtained	O
by	O
algorithm	B
a5.1	O
(	O
p589	O
)	O
.	O
the	O
two	O
following	O
results	O
are	O
direct	O
analogues	O
of	O
their	O
2d	O
counterparts	O
.	O
projective	B
transformation	I
.	O
under	O
the	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
forms	O
as	O
=	O
hx	O
,	O
a	O
plane	B
trans-	O
π	O
(	O
cid:2	O
)	O
=	O
h−tπ	O
.	O
(	O
3.6	O
)	O
parametrized	O
points	B
on	I
a	I
plane	I
.	O
the	O
points	O
x	O
on	O
the	O
plane	B
π	O
may	O
be	O
written	O
as	O
x	O
=	O
mx	O
(	O
3.7	O
)	O
where	O
the	O
columns	O
of	O
the	O
4×3	O
matrix	B
m	O
generate	O
the	O
rank	O
3	O
null-space	B
of	O
πt	O
,	O
i.e	O
.	O
πtm	O
=	O
0	O
,	O
and	O
the	O
3-vector	O
x	O
(	O
which	O
is	O
a	O
point	B
on	O
the	O
projective	B
plane	I
ip2	O
)	O
parametrizes	O
points	O
on	O
the	O
plane	B
π.	O
m	O
is	O
not	O
unique	O
,	O
of	O
course	O
.	O
suppose	O
the	O
plane	B
is	O
π	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
t	O
and	O
a	O
is	O
non-zero	O
,	O
then	O
mt	O
can	O
be	O
written	O
as	O
mt	O
=	O
[	O
p|	O
i3×3	O
]	O
,	O
where	O
p	O
=	O
(	O
−b/a	O
,	O
−c/a	O
,	O
−d/a	O
)	O
t.	O
this	O
parametrized	O
representation	B
is	O
simply	O
the	O
analogue	O
in	O
3d	O
of	O
a	O
line	O
l	O
in	O
ip2	O
deﬁned	O
as	O
a	O
linear	B
combination	O
of	O
its	O
2d	O
null-space	B
as	O
x	O
=	O
µa	O
+	O
λb	O
,	O
where	O
lta	O
=	O
ltb	O
=	O
0	O
.	O
3.2.2	O
lines	B
a	O
line	B
is	O
deﬁned	O
by	O
the	O
join	O
of	O
two	O
points	O
or	O
the	O
intersection	B
of	O
two	O
planes	O
.	O
lines	B
have	O
4	O
degrees	B
of	I
freedom	I
in	O
3-space	O
.	O
a	O
convincing	O
way	O
to	O
count	O
these	O
degrees	B
of	I
freedom	I
is	O
to	O
think	O
of	O
a	O
line	O
as	O
deﬁned	O
by	O
its	O
intersection	B
with	O
two	O
orthogonal	O
planes	O
,	O
as	O
in	O
ﬁgure	O
3.1.	O
the	O
point	B
of	O
intersection	B
on	O
each	O
plane	B
is	O
speciﬁed	O
by	O
two	O
parameters	O
,	O
producing	O
a	O
total	O
of	O
4	O
degrees	B
of	I
freedom	I
for	O
the	O
line	B
.	O
lines	B
are	O
very	O
awkward	O
to	O
represent	O
in	O
3-space	O
since	O
a	O
natural	O
representation	B
for	O
an	O
object	O
with	O
4	O
degrees	B
of	I
freedom	I
would	O
be	O
a	O
homogeneous	O
5-vector	O
.	O
the	O
problem	O
is	O
that	O
a	O
homogeneous	O
5	O
vector	O
can	O
not	O
easily	O
be	O
used	O
in	O
mathematical	O
expressions	O
to-	O
gether	O
with	O
the	O
4-vectors	O
representing	O
points	O
and	O
planes	O
.	O
to	O
overcome	O
this	O
problem	O
3.2	O
representing	O
and	O
transforming	O
planes	O
,	O
lines	B
and	O
quadrics	B
69	O
a	O
number	O
of	O
line	O
representations	O
have	O
been	O
proposed	O
,	O
and	O
these	O
differ	O
in	O
their	O
math-	O
ematical	O
complexity	O
.	O
we	O
survey	O
three	O
of	O
these	O
representations	O
.	O
in	O
each	O
case	O
the	O
rep-	O
resentation	O
provides	O
mechanisms	O
for	O
a	O
line	O
to	O
be	O
deﬁned	O
by	O
:	O
the	O
join	O
of	O
two	O
points	O
,	O
a	O
dual	B
version	O
where	O
the	O
line	B
is	O
deﬁned	O
by	O
the	O
intersection	B
of	O
two	O
planes	O
,	O
and	O
also	O
a	O
map	O
between	O
the	O
two	O
deﬁnitions	O
.	O
the	O
representations	O
also	O
enable	O
join	O
and	O
incidence	B
relations	I
to	O
be	O
computed	O
,	O
for	O
example	O
the	O
point	B
at	O
which	O
a	O
line	B
intersects	O
a	O
plane	B
.	O
i.	O
null-space	B
and	O
span	B
representation	I
.	O
this	O
representation	B
builds	O
on	O
the	O
intuitive	O
geometric	B
notion	O
that	O
a	O
line	B
is	O
a	O
pencil	O
(	O
one-parameter	O
family	O
)	O
of	O
collinear	O
points	O
,	O
and	O
is	O
deﬁned	O
by	O
any	O
two	O
of	O
these	O
points	O
.	O
similarly	O
,	O
a	O
line	B
is	O
the	O
axis	O
of	O
a	O
pencil	O
of	O
planes	O
,	O
and	O
is	O
deﬁned	O
by	O
the	O
intersection	B
of	O
any	O
two	O
planes	O
from	O
the	O
pencil	O
.	O
in	O
both	O
cases	O
the	O
actual	O
points	O
or	O
planes	O
are	O
not	O
important	O
(	O
in	O
fact	O
two	O
points	O
have	O
6	O
degrees	B
of	I
freedom	I
and	O
are	O
represented	O
by	O
two	O
4-vectors	O
–	O
far	O
too	O
many	O
parameters	B
)	O
.	O
this	O
notion	O
is	O
captured	O
mathematically	O
by	O
representing	O
a	O
line	B
as	O
the	O
span	O
of	O
two	O
vectors	O
.	O
suppose	O
a	O
,	O
b	O
are	O
two	O
(	O
non-coincident	O
)	O
space	O
points	O
.	O
then	O
the	O
line	B
joining	O
these	O
points	O
is	O
represented	O
by	O
the	O
span	O
of	O
the	O
row	O
space	O
of	O
the	O
2	O
×	O
4	O
matrix	B
w	O
composed	O
of	O
at	O
and	O
bt	O
as	O
rows	O
:	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
.	O
at	O
bt	O
w	O
=	O
then	O
:	O
(	O
i	O
)	O
the	O
span	O
of	O
wt	O
is	O
the	O
pencil	O
of	B
points	I
λa	O
+	O
µb	O
on	O
the	O
line	B
.	O
(	O
ii	O
)	O
the	O
span	O
of	O
the	O
2-dimensional	O
right	O
null-space	B
of	O
w	O
is	O
the	O
pencil	O
of	O
planes	O
with	O
the	O
line	B
as	O
axis	O
.	O
it	O
is	O
evident	O
that	O
two	O
other	O
points	O
,	O
a	O
(	O
cid:2	O
)	O
t	O
and	O
b	O
(	O
cid:2	O
)	O
t	O
,	O
on	O
the	O
line	B
will	O
generate	O
a	O
matrix	B
w	O
(	O
cid:2	O
)	O
with	O
the	O
same	O
span	O
as	O
w	O
,	O
so	O
that	O
the	O
span	O
,	O
and	O
hence	O
the	O
representation	B
,	O
is	O
independent	O
of	O
the	O
particular	O
points	O
used	O
to	O
deﬁne	O
it	O
.	O
to	O
prove	O
the	O
null-space	B
property	O
,	O
suppose	O
that	O
p	O
and	O
q	O
are	O
a	O
basis	O
for	O
the	O
null-space	B
.	O
then	O
wp	O
=	O
0	O
and	O
consequently	O
atp	O
=	O
btp	O
=	O
0	O
,	O
so	O
that	O
p	O
is	O
a	O
plane	B
containing	O
the	O
points	O
a	O
and	O
b.	O
similarly	O
,	O
q	O
is	O
a	O
distinct	O
plane	B
also	O
containing	O
the	O
points	O
a	O
and	O
b.	O
thus	O
a	O
and	O
b	O
lie	O
on	O
both	O
the	O
(	O
linearly	O
independent	O
)	O
planes	O
p	O
and	O
q	O
,	O
so	O
the	O
line	B
deﬁned	O
by	O
w	O
is	O
the	O
plane	B
intersection	O
.	O
any	O
plane	B
of	O
the	O
pencil	O
,	O
with	O
the	O
line	B
as	O
axis	O
,	O
is	O
given	O
by	O
the	O
span	O
λ	O
the	O
dual	B
representation	O
of	O
a	O
line	O
as	O
the	O
intersection	B
of	O
two	O
planes	O
,	O
p	O
,	O
q	O
,	O
follows	O
in	O
a	O
similar	O
manner	O
.	O
the	O
line	B
is	O
represented	O
as	O
the	O
span	O
(	O
of	O
the	O
row	O
space	O
)	O
of	O
the	O
2	O
×	O
4	O
matrix	B
w∗	O
composed	O
of	O
pt	O
and	O
qt	O
as	O
rows	O
:	O
(	O
cid:2	O
)	O
p	O
+	O
µ	O
(	O
cid:2	O
)	O
q	O
.	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
w∗	O
=	O
pt	O
qt	O
with	O
the	O
properties	B
(	O
i	O
)	O
the	O
span	O
of	O
w∗t	O
is	O
the	O
pencil	O
of	O
planes	O
λ	O
(	O
cid:2	O
)	O
p	O
+	O
µ	O
(	O
ii	O
)	O
the	O
span	O
of	O
the	O
2-dimensional	O
null-space	B
of	O
w∗	O
(	O
cid:2	O
)	O
q	O
with	O
the	O
line	B
as	O
axis	O
.	O
is	O
the	O
pencil	O
of	B
points	I
on	O
the	O
line	B
.	O
70	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
the	O
two	O
representations	O
are	O
related	O
by	O
w∗	O
wt	O
=	O
w	O
w∗t	O
=	O
02×2	O
,	O
where	O
02×2	O
is	O
a	O
2	O
×	O
2	O
null	O
matrix	B
.	O
example	O
3.2.	O
the	O
x-axis	O
is	O
represented	O
as	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
w	O
=	O
0	O
0	O
0	O
1	O
1	O
0	O
0	O
0	O
w∗	O
=	O
0	O
0	O
1	O
0	O
0	O
1	O
0	O
0	O
where	O
the	O
points	O
a	O
and	O
b	O
are	O
here	O
the	O
origin	O
and	O
ideal	B
point	I
in	O
the	O
x-direction	O
,	O
and	O
the	O
(	O
cid:2	O
)	O
planes	O
p	O
and	O
q	O
are	O
the	O
xy-	O
and	O
xz-planes	O
respectively	O
.	O
join	O
and	O
incidence	B
relations	I
are	O
also	O
computed	O
from	O
null-spaces	O
.	O
(	O
i	O
)	O
the	O
plane	B
π	O
deﬁned	O
by	O
the	O
join	O
of	O
the	O
point	O
x	O
and	O
line	B
w	O
is	O
obtained	O
from	O
the	O
null-space	B
of	O
m	O
=	O
from	O
the	O
null-space	B
of	O
m	O
=	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
.	O
.	O
w	O
xt	O
w∗	O
πt	O
if	O
the	O
null-space	B
of	O
m	O
is	O
2-dimensional	O
then	O
x	O
is	O
on	O
w	O
,	O
otherwise	O
mπ	O
=	O
0	O
.	O
(	O
ii	O
)	O
the	O
point	B
x	O
deﬁned	O
by	O
the	O
intersection	B
of	O
the	O
line	B
w	O
with	O
the	O
plane	B
π	O
is	O
obtained	O
if	O
the	O
null-space	B
of	O
m	O
is	O
2-dimensional	O
then	O
the	O
line	B
w	O
is	O
on	O
π	O
,	O
otherwise	O
mx	O
=	O
0.	O
these	O
properties	B
can	O
be	O
derived	O
almost	O
by	O
inspection	O
.	O
for	O
example	O
,	O
the	O
ﬁrst	O
is	O
equiva-	O
lent	O
to	O
three	O
points	O
deﬁning	O
a	O
plane	B
(	O
3.3	O
)	O
.	O
the	O
span	B
representation	I
is	O
very	O
useful	O
in	O
practical	O
numerical	O
implementations	O
where	O
null-spaces	O
can	O
be	O
computed	O
simply	O
by	O
using	O
the	O
svd	O
algorithm	B
(	O
see	O
section	O
a4.4-	O
(	O
p585	O
)	O
)	O
available	O
with	O
most	O
matrix	B
packages	O
.	O
the	O
representation	B
is	O
also	O
useful	O
in	O
es-	O
timation	O
problems	O
,	O
where	O
it	O
is	O
often	O
not	O
a	O
problem	O
that	O
the	O
entity	O
being	O
estimated	O
is	O
over-parametrized	O
(	O
see	O
the	O
discussion	O
of	O
section	O
4.5	O
(	O
p110	O
)	O
)	O
.	O
ii	O
.	O
pl¨ucker	O
matrices	O
.	O
here	O
a	O
line	B
is	O
represented	O
by	O
a	O
4	O
×	O
4	O
skew-symmetric	O
homo-	O
geneous	O
matrix	B
.	O
in	O
particular	O
,	O
the	O
line	B
joining	O
the	O
two	O
points	O
a	O
,	O
b	O
is	O
represented	O
by	O
the	O
matrix	B
l	O
with	O
elements	O
lij	O
=	O
aibj	O
−	O
biaj	O
or	O
equivalently	O
in	O
vector	O
notation	O
as	O
l	O
=	O
abt	O
−	O
bat	O
(	O
3.8	O
)	O
first	O
a	O
few	O
properties	B
of	O
l	O
:	O
(	O
i	O
)	O
l	O
has	O
rank	O
2.	O
its	O
2-dimensional	O
null-space	B
is	O
spanned	O
by	O
the	O
pencil	O
of	O
planes	O
with	O
the	O
line	B
as	O
axis	O
(	O
in	O
fact	O
lw∗t	O
=	O
0	O
,	O
with	O
0	O
a	O
4	O
×	O
2	O
null-matrix	O
)	O
.	O
3.2	O
representing	O
and	O
transforming	O
planes	O
,	O
lines	B
and	O
quadrics	B
71	O
(	O
ii	O
)	O
the	O
representation	B
has	O
the	O
required	O
4	O
degrees	B
of	I
freedom	I
for	O
a	O
line	B
.	O
this	O
is	O
ac-	O
counted	O
as	O
follows	O
:	O
the	O
skew-symmetric	O
matrix	O
has	O
6	O
independent	O
non-zero	O
ele-	O
ments	O
,	O
but	O
only	O
their	O
5	O
ratios	O
are	O
signiﬁcant	O
,	O
and	O
furthermore	O
because	O
det	O
l	O
=	O
0	O
the	O
elements	O
satisfy	O
a	O
(	O
quadratic	O
)	O
constraint	O
(	O
see	O
below	O
)	O
.	O
the	O
net	O
number	O
of	O
de-	O
grees	O
of	O
freedom	O
is	O
then	O
4	O
.	O
(	O
iii	O
)	O
the	O
relation	B
l	O
=	O
abt	O
−	O
bat	O
is	O
the	O
generalization	O
to	O
4-space	O
of	O
the	O
vector	O
product	O
formula	O
l	O
=	O
x	O
×	O
y	O
of	O
ip2	O
for	O
a	O
line	O
l	O
deﬁned	O
by	O
two	O
points	O
x	O
,	O
y	O
all	O
represented	O
by	O
3-vectors	O
.	O
(	O
iv	O
)	O
the	O
matrix	B
l	O
is	O
independent	O
of	O
the	O
points	O
a	O
,	O
b	O
used	O
to	O
deﬁne	O
it	O
,	O
since	O
if	O
a	O
different	O
point	B
c	O
on	O
the	O
line	B
is	O
used	O
,	O
with	O
c	O
=	O
a	O
+	O
µb	O
,	O
then	O
the	O
resulting	O
matrix	B
is	O
ˆl	O
=	O
act	O
−	O
cat	O
=	O
a	O
(	O
at	O
+	O
µbt	O
)	O
−	O
(	O
a	O
+	O
µb	O
)	O
at	O
=	O
abt	O
−	O
bat	O
=	O
l.	O
(	O
v	O
)	O
under	O
the	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
,	O
the	O
matrix	B
transforms	O
as	O
l	O
(	O
cid:2	O
)	O
=	O
hlht	O
,	O
i.e	O
.	O
it	O
is	O
a	O
valency-2	O
tensor	B
(	O
see	O
appendix	O
1	O
(	O
p562	O
)	O
)	O
.	O
example	O
3.3.	O
from	O
(	O
3.8	O
)	O
the	O
x-axis	O
is	O
represented	O
as	O
(	O
cid:16	O
)	O
	O
0	O
0	O
0	O
−1	O
0	O
0	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
	O
	O
(	O
cid:15	O
)	O
	O
0	O
0	O
0	O
1	O
(	O
cid:16	O
)	O
−	O
	O
(	O
cid:15	O
)	O
	O
1	O
0	O
0	O
0	O
l	O
=	O
1	O
0	O
0	O
0	O
0	O
0	O
0	O
1	O
=	O
where	O
the	O
points	O
a	O
and	O
b	O
are	O
(	O
as	O
in	O
the	O
previous	O
example	O
)	O
the	O
origin	O
and	O
ideal	B
point	I
in	O
(	O
cid:2	O
)	O
the	O
x-direction	O
respectively	O
.	O
a	O
dual	B
pl¨ucker	O
representation	B
l∗	O
two	O
planes	O
p	O
,	O
q	O
,	O
is	O
obtained	O
for	O
a	O
line	O
formed	O
by	O
the	O
intersection	B
of	O
l∗	O
=	O
pqt	O
−	O
qpt	O
(	O
3.9	O
)	O
and	O
has	O
similar	O
properties	B
to	O
l.	O
under	O
the	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
transforms	O
as	O
l∗	O
(	O
cid:2	O
)	O
l∗	O
simple	O
rewrite	O
rule	O
:	O
=	O
h−tlh−1	O
.	O
the	O
matrix	B
l∗	O
=	O
hx	O
,	O
the	O
matrix	B
can	O
be	O
obtained	O
directly	O
from	O
l	O
by	O
a	O
l12	O
:	O
l13	O
:	O
l14	O
:	O
l23	O
:	O
l42	O
:	O
l34	O
=	O
l	O
∗	O
34	O
:	O
l	O
∗	O
42	O
:	O
l	O
∗	O
23	O
:	O
l	O
∗	O
14	O
:	O
l	O
∗	O
13	O
:	O
l	O
∗	O
12	O
.	O
(	O
3.10	O
)	O
the	O
correspondence	B
rule	O
is	O
very	O
simple	O
:	O
the	O
indices	O
of	O
the	O
dual	O
and	O
original	O
component	O
always	O
include	O
all	O
the	O
numbers	O
{	O
1	O
,	O
2	O
,	O
3	O
,	O
4	O
}	O
,	O
so	O
if	O
the	O
original	O
is	O
ij	O
then	O
the	O
dual	B
is	O
those	O
numbers	O
of	O
{	O
1	O
,	O
2	O
,	O
3	O
,	O
4	O
}	O
which	O
are	O
not	O
ij	O
.	O
for	O
example	O
12	O
(	O
cid:6	O
)	O
→	O
34.	O
join	O
and	O
incidence	O
properties	O
are	O
very	O
nicely	O
represented	O
in	O
this	O
notation	O
:	O
(	O
i	O
)	O
the	O
plane	B
deﬁned	O
by	O
the	O
join	O
of	O
the	O
point	O
x	O
and	O
line	B
l	O
is	O
and	O
l∗x	O
=	O
0	O
if	O
,	O
and	O
only	O
if	O
,	O
x	O
is	O
on	O
l.	O
π	O
=	O
l∗x	O
72	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
(	O
ii	O
)	O
the	O
point	B
deﬁned	O
by	O
the	O
intersection	B
of	O
the	O
line	B
l	O
with	O
the	O
plane	B
π	O
is	O
and	O
lπ	O
=	O
0	O
if	O
,	O
and	O
only	O
if	O
,	O
l	O
is	O
on	O
π.	O
x	O
=	O
lπ	O
the	O
properties	B
of	O
two	O
(	O
or	O
more	O
)	O
lines	B
l1	O
,	O
l2	O
,	O
.	O
.	O
.	O
can	O
be	O
obtained	O
from	O
the	O
null-space	B
of	O
the	O
matrix	B
m	O
=	O
[	O
l1	O
,	O
l2	O
,	O
.	O
.	O
.	O
]	O
.	O
for	O
example	O
if	O
the	O
lines	B
are	O
coplanar	O
then	O
mt	O
has	O
a	O
1-dimensional	O
null-space	B
corresponding	O
to	O
the	O
plane	B
π	O
of	O
the	O
lines	O
.	O
example	O
3.4.	O
the	O
intersection	B
of	O
the	O
x-axis	O
with	O
the	O
plane	B
x	O
=	O
1	O
is	O
given	O
by	O
x	O
=	O
lπ	O
as	O
	O
0	O
0	O
0	O
−1	O
0	O
0	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
	O
	O
1	O
0	O
0−1	O
	O
=	O
	O
	O
1	O
0	O
0	O
1	O
x	O
=	O
(	O
cid:2	O
)	O
(	O
3.11	O
)	O
which	O
is	O
the	O
inhomogeneous	O
point	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t.	O
iii	O
.	O
pl¨ucker	O
line	B
coordinates	I
.	O
elements	O
of	O
the	O
4	O
×	O
4	O
skew-symmetric	O
pl¨ucker	O
matrix	B
(	O
3.8	O
)	O
l	O
,	O
namely1	O
the	O
pl¨ucker	O
line	B
coordinates	I
are	O
the	O
six	O
non-zero	O
l	O
=	O
{	O
l12	O
,	O
l13	O
,	O
l14	O
,	O
l23	O
,	O
l42	O
,	O
l34	O
}	O
.	O
this	O
is	O
a	O
homogeneous	O
6-vector	O
,	O
and	O
thus	O
is	O
an	O
element	O
of	O
ip5	O
.	O
it	O
follows	O
from	O
evaluat-	O
ing	O
det	O
l	O
=	O
0	O
that	O
the	O
coordinates	B
satisfy	O
the	O
equation	O
l12l34	O
+	O
l13l42	O
+	O
l14l23	O
=	O
0	O
.	O
(	O
3.12	O
)	O
a	O
6-vector	O
l	O
only	O
corresponds	O
to	O
a	O
line	B
in	O
3-space	O
if	O
it	O
satisﬁes	O
(	O
3.12	O
)	O
.	O
the	O
geometric	B
interpretation	I
of	O
this	O
constraint	O
is	O
that	O
the	O
lines	B
of	O
ip3	O
deﬁne	O
a	O
(	O
co-dimension	O
1	O
)	O
surface	O
in	O
ip5	O
which	O
is	O
known	O
as	O
the	O
klein	O
quadric	O
,	O
a	O
quadric	O
because	O
the	O
terms	O
of	O
(	O
3.12	O
)	O
are	O
suppose	O
two	O
lines	O
l	O
,	O
ˆl	O
are	O
the	O
joins	O
of	O
the	O
points	O
a	O
,	O
b	O
and	O
(	O
cid:23	O
)	O
a	O
,	O
(	O
cid:23	O
)	O
b	O
respectively	O
.	O
the	O
quadratic	O
in	O
the	O
pl¨ucker	O
line	B
coordinates	I
.	O
condition	O
for	O
this	O
is	O
that	O
det	O
[	O
a	O
,	O
b	O
,	O
(	O
cid:23	O
)	O
a	O
,	O
(	O
cid:23	O
)	O
b	O
]	O
=	O
0.	O
it	O
can	O
be	O
shown	O
that	O
the	O
determinant	O
lines	B
intersect	O
if	O
and	O
only	O
if	O
the	O
four	O
points	O
are	O
coplanar	O
.	O
a	O
necessary	O
and	O
sufﬁcient	O
expands	O
as	O
det	O
[	O
a	O
,	O
b	O
,	O
(	O
cid:23	O
)	O
a	O
,	O
(	O
cid:23	O
)	O
b	O
]	O
=	O
l12	O
=	O
(	O
l|	O
ˆl	O
)	O
.	O
ˆl34	O
+	O
ˆl12l34	O
+	O
l13	O
ˆl42	O
+	O
ˆl13l42	O
+	O
l14	O
ˆl23	O
+	O
ˆl14l23	O
(	O
3.13	O
)	O
since	O
the	O
pl¨ucker	O
coordinates	B
are	O
independent	O
of	O
the	O
particular	O
points	O
used	O
to	O
deﬁne	O
them	O
,	O
the	O
bilinear	B
product	O
(	O
l|	O
ˆl	O
)	O
is	O
independent	O
of	O
the	O
points	O
used	O
in	O
the	O
derivation	B
and	O
only	O
depends	O
on	O
the	O
lines	B
l	O
and	O
ˆl	O
.	O
then	O
we	O
have	O
result	O
3.5.	O
two	O
lines	O
l	O
and	O
ˆl	O
are	O
coplanar	O
(	O
and	O
thus	O
intersect	O
)	O
if	O
and	O
only	O
if	O
(	O
l|	O
ˆl	O
)	O
=	O
0.	O
this	O
product	O
appears	O
in	O
a	O
number	O
of	O
useful	O
formulae	O
:	O
1	O
the	O
element	O
l42	O
is	O
conventionally	O
used	O
instead	O
of	O
l24	O
as	O
it	O
eliminates	O
negatives	O
in	O
many	O
of	O
the	O
subsequent	O
formulae	O
.	O
3.2	O
representing	O
and	O
transforming	O
planes	O
,	O
lines	B
and	O
quadrics	B
(	O
i	O
)	O
a	O
6-vector	O
l	O
only	O
represents	O
a	O
line	B
in	O
ip3	O
if	O
(	O
l|l	O
)	O
=	O
0.	O
this	O
is	O
simply	O
repeating	O
(	O
ii	O
)	O
suppose	O
two	O
lines	O
l	O
,	O
ˆl	O
are	O
the	O
intersections	O
of	O
the	O
planes	O
p	O
,	O
q	O
and	O
(	O
cid:23	O
)	O
p	O
,	O
(	O
cid:23	O
)	O
q	O
respec-	O
the	O
klein	O
quadric	O
constraint	O
(	O
3.12	O
)	O
above	O
.	O
73	O
tively	O
.	O
then	O
(	O
l|	O
ˆl	O
)	O
=	O
det	O
[	O
p	O
,	O
q	O
,	O
(	O
cid:23	O
)	O
p	O
,	O
(	O
cid:23	O
)	O
q	O
]	O
and	O
again	O
the	O
lines	B
intersect	O
if	O
and	O
only	O
if	O
(	O
l|	O
ˆl	O
)	O
=	O
0	O
.	O
(	O
iii	O
)	O
if	O
l	O
is	O
the	O
intersection	B
of	O
two	O
planes	O
p	O
and	O
q	O
and	O
ˆl	O
is	O
the	O
join	O
of	O
two	O
points	O
a	O
and	O
b	O
,	O
then	O
(	O
l|	O
ˆl	O
)	O
=	O
(	O
pta	O
)	O
(	O
qtb	O
)	O
−	O
(	O
qta	O
)	O
(	O
ptb	O
)	O
.	O
(	O
3.14	O
)	O
pl¨ucker	O
coordinates	B
are	O
useful	O
in	O
algebraic	O
derivations	O
.	O
they	O
will	O
be	O
used	O
in	O
deﬁning	O
the	O
map	O
from	O
a	O
line	B
in	O
3-space	O
to	O
its	O
image	O
in	O
chapter	O
8	O
.	O
3.2.3	O
quadrics	B
and	O
dual	B
quadrics	O
a	O
quadric	O
is	O
a	O
surface	O
in	O
ip3	O
deﬁned	O
by	O
the	O
equation	O
(	O
3.15	O
)	O
where	O
q	O
is	O
a	O
symmetric	B
4	O
×	O
4	O
matrix	B
.	O
often	O
the	O
matrix	B
q	O
and	O
the	O
quadric	O
surface	O
it	O
deﬁnes	O
are	O
not	O
distinguished	O
,	O
and	O
we	O
will	O
simply	O
refer	O
to	O
the	O
quadric	O
q.	O
xtqx	O
=	O
0	O
many	O
of	O
the	O
properties	O
of	B
quadrics	I
follow	O
directly	O
from	O
those	O
of	B
conics	I
in	O
section	O
2.2.3	O
(	O
p30	O
)	O
.	O
to	O
highlight	O
a	O
few	O
:	O
(	O
i	O
)	O
a	O
quadric	O
has	O
9	O
degrees	B
of	I
freedom	I
.	O
these	O
correspond	O
to	O
the	O
ten	O
independent	O
elements	O
of	O
a	O
4	O
×	O
4	O
symmetric	B
matrix	O
less	O
one	O
for	O
scale	O
.	O
(	O
ii	O
)	O
nine	O
points	O
in	O
general	B
position	I
deﬁne	O
a	O
quadric	O
.	O
(	O
iii	O
)	O
if	O
the	O
matrix	B
q	O
is	O
singular	O
,	O
then	O
the	O
quadric	O
is	O
degenerate	B
,	O
and	O
may	O
be	O
deﬁned	O
by	O
fewer	O
points	O
.	O
(	O
iv	O
)	O
a	O
quadric	O
deﬁnes	O
a	O
polarity	B
between	O
a	O
point	O
and	O
a	O
plane	B
,	O
in	O
a	O
similar	O
manner	O
to	O
the	O
polarity	B
deﬁned	O
by	O
a	O
conic	B
between	O
a	O
point	O
and	O
a	O
line	B
(	O
section	O
2.8.1	O
)	O
.	O
the	O
plane	B
π	O
=	O
qx	O
is	O
the	O
polar	O
plane	B
of	O
x	O
with	O
respect	O
to	O
q.	O
in	O
the	O
case	O
that	O
q	O
is	O
non-singular	O
and	O
x	O
is	O
outside	O
the	O
quadric	O
,	O
the	O
polar	O
plane	B
is	O
deﬁned	O
by	O
the	O
points	O
of	O
contact	O
with	O
q	O
of	O
the	O
cone	O
of	O
rays	O
through	O
x	O
tangent	O
to	O
q.	O
if	O
x	O
lies	O
on	O
q	O
,	O
then	O
qx	O
is	O
the	O
tangent	O
plane	O
to	O
q	O
at	O
x	O
.	O
(	O
v	O
)	O
the	O
intersection	B
of	O
a	O
plane	B
π	O
with	O
a	O
quadric	O
q	O
is	O
a	O
conic	B
c.	O
computing	B
the	O
conic	B
can	O
be	O
tricky	O
because	O
it	O
requires	O
a	O
coordinate	O
system	O
for	O
the	O
plane	B
.	O
recall	O
from	O
(	O
3.7	O
)	O
that	O
a	O
coordinate	O
system	O
for	O
the	O
plane	B
can	O
be	O
deﬁned	O
by	O
the	O
comple-	O
ment	O
space	O
to	O
π	O
as	O
x	O
=	O
mx	O
.	O
points	O
on	O
π	O
are	O
on	O
q	O
if	O
xtqx	O
=	O
xtmtqmx	O
=	O
0.	O
these	O
points	O
lie	O
on	O
a	O
conic	O
c	O
,	O
since	O
xtcx	O
=	O
0	O
,	O
with	O
c	O
=	O
mtqm	O
.	O
(	O
vi	O
)	O
under	O
the	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
q	O
(	O
cid:2	O
)	O
=	O
hx	O
,	O
a	O
(	O
point	B
)	O
quadric	O
transforms	O
as	O
=	O
h−tqh−1	O
.	O
(	O
3.16	O
)	O
the	O
dual	B
of	O
a	O
quadric	O
is	O
also	O
a	O
quadric	O
.	O
dual	B
quadrics	O
are	O
equations	O
on	O
planes	O
:	O
the	O
=	O
adjoint	O
q	O
,	O
tangent	O
planes	O
π	O
to	O
the	O
point	B
quadric	O
q	O
satisfy	O
πtq∗π	O
=	O
0	O
,	O
where	O
q∗	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
74	O
or	O
q−1	O
if	O
q	O
is	O
invertible	O
.	O
under	O
the	O
point	B
transformation	O
x	O
(	O
cid:2	O
)	O
transforms	O
as	O
=	O
hx	O
,	O
a	O
dual	B
quadric	I
q∗	O
(	O
cid:2	O
)	O
=	O
hq∗ht	O
.	O
(	O
3.17	O
)	O
the	O
algebra	O
of	O
imaging	O
a	O
quadric	O
is	O
far	O
simpler	O
for	O
a	O
dual	O
quadric	O
than	O
a	O
point	B
quadric	O
.	O
this	O
is	O
detailed	O
in	O
chapter	O
8	O
.	O
3.2.4	O
classiﬁcation	B
of	I
quadrics	O
since	O
the	O
matrix	B
,	O
q	O
,	O
representing	O
a	O
quadric	O
is	O
symmetric	B
,	O
it	O
may	O
be	O
decomposed	O
as	O
q	O
=	O
utdu	O
where	O
u	O
is	O
a	O
real	O
orthogonal	B
matrix	O
and	O
d	O
is	O
a	O
real	O
diagonal	O
matrix	B
.	O
further	O
,	O
by	O
appropriate	O
scaling	B
of	O
the	O
rows	O
of	O
u	O
,	O
one	O
may	O
write	O
q	O
=	O
htdh	O
where	O
d	O
is	O
diagonal	O
with	O
entries	O
equal	O
to	O
0	O
,	O
1	O
,	O
or	O
−1	O
.	O
we	O
may	O
further	O
ensure	O
that	O
the	O
zero	O
entries	O
of	O
d	O
appear	O
last	O
along	O
the	O
diagonal	O
,	O
and	O
that	O
the	O
+1	O
entries	O
appear	O
ﬁrst	O
.	O
now	O
,	O
replacement	O
of	O
q	O
=	O
htdh	O
by	O
d	O
is	O
equivalent	B
to	O
a	O
projective	B
transformation	I
effected	O
by	O
the	O
matrix	B
h	O
(	O
see	O
(	O
3.16	O
)	O
)	O
.	O
thus	O
,	O
up	O
to	O
projective	O
equivalence	O
,	O
we	O
may	O
assume	O
that	O
the	O
quadric	O
is	O
represented	O
by	O
a	O
matrix	B
d	O
of	O
the	O
given	O
simple	O
form	O
.	O
the	O
signature	O
of	O
a	O
diagonal	O
matrix	B
d	O
,	O
denoted	O
σ	O
(	O
d	O
)	O
,	O
is	O
deﬁned	O
to	O
be	O
the	O
number	O
of	O
+1	O
entries	O
minus	O
the	O
number	O
of	O
−1	O
entries	O
.	O
this	O
deﬁnition	B
is	O
extended	O
to	O
arbitrary	O
real	O
symmetric	B
matrices	I
q	O
by	O
deﬁning	O
σ	O
(	O
q	O
)	O
=σ	O
(	O
d	O
)	O
such	O
that	O
q	O
=	O
htdh	O
,	O
where	O
h	O
is	O
a	O
real	O
matrix	B
.	O
it	O
may	O
be	O
proved	O
that	O
the	O
signature	O
is	O
well	O
deﬁned	O
,	O
being	O
independent	O
of	O
the	O
particular	O
choice	B
of	O
h.	O
since	O
the	O
matrix	B
representing	O
a	O
quadric	O
is	O
deﬁned	O
only	O
up	O
to	O
sign	O
,	O
we	O
may	O
assume	O
that	O
its	O
signature	O
is	O
non-negative	O
.	O
then	O
,	O
the	O
projective	B
type	O
of	O
a	O
quadric	O
is	O
uniquely	O
determined	O
by	O
its	O
rank	O
and	O
signature	O
.	O
this	O
will	O
allow	O
us	O
to	O
enumerate	O
the	O
different	O
projective	B
equivalence	O
classes	O
of	B
quadrics	I
.	O
a	O
quadric	O
represented	O
by	O
a	O
diagonal	O
matrix	B
diag	O
(	O
d1	O
,	O
d2	O
,	O
d3	O
,	O
d4	O
)	O
corresponds	O
to	O
a	O
set	O
of	B
points	I
satisfying	O
an	O
equation	O
d1x2	O
+	O
d2y2	O
+	O
d3z2	O
+	O
d4t2	O
=	O
0.	O
one	O
may	O
set	O
t	O
=	O
1	O
to	O
get	O
an	O
equation	O
for	O
the	O
non-inﬁnite	O
points	O
on	O
the	O
quadric	O
.	O
see	O
table	O
3.1.	O
examples	B
of	O
quadric	O
surfaces	O
are	O
shown	O
in	O
ﬁgure	O
3.2	O
–	O
ﬁgure	O
3.4.	O
rank	O
4	O
3	O
2	O
1	O
σ	O
4	O
2	O
0	O
3	O
1	O
2	O
0	O
1	O
diagonal	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
1	O
)	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
−1	O
)	O
(	O
1	O
,	O
1	O
,	O
−1	O
,	O
−1	O
)	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
0	O
)	O
(	O
1	O
,	O
1	O
,	O
−1	O
,	O
0	O
)	O
(	O
1	O
,	O
1	O
,	O
0	O
,	O
0	O
)	O
(	O
1	O
,	O
−1	O
,	O
0	O
,	O
0	O
)	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
equation	O
x2	O
+	O
y2	O
+	O
z2	O
+	O
1	O
=	O
0	O
x2	O
+	O
y2	O
+	O
z2	O
=	O
1	O
x2	O
+	O
y2	O
=	O
z2	O
+	O
1	O
x2	O
+	O
y2	O
+	O
z2	O
=	O
0	O
x2	O
+	O
y2	O
=	O
z2	O
x2	O
+	O
y2	O
=	O
0	O
x2	O
=	O
y2	O
x2	O
=	O
0	O
realization	B
no	O
real	O
points	O
sphere	O
hyperboloid	B
of	O
one	O
sheet	O
one	O
point	B
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
cone	O
at	O
the	O
origin	O
single	O
line	O
(	O
z-axis	O
)	O
two	O
planes	O
x	O
=	O
±y	O
the	O
plane	B
x	O
=	O
0	O
table	O
3.1.	O
categorization	O
of	O
point	O
quadrics	B
.	O
3.3	O
twisted	O
cubics	O
75	O
fig	O
.	O
3.2.	O
non-ruled	O
quadrics	B
.	O
this	O
shows	O
plots	O
of	O
a	O
sphere	O
,	O
ellipsoid	O
,	O
hyperboloid	B
of	O
two	O
sheets	O
and	O
paraboloid	O
.	O
they	O
are	O
all	O
projectively	O
equivalent	B
.	O
fig	O
.	O
3.3.	O
ruled	B
quadrics	O
.	O
two	O
examples	O
of	O
a	O
hyperboloid	O
of	O
one	O
sheet	O
are	O
given	O
.	O
these	O
surfaces	O
are	O
given	O
by	O
equations	O
x2	O
+	O
y2	O
=	O
z2	O
+	O
1	O
and	O
xy	O
=	O
z	O
respectively	O
,	O
and	O
are	O
projectively	O
equivalent	B
.	O
note	O
that	O
these	O
two	O
surfaces	O
are	O
made	O
up	O
of	O
two	O
sets	O
of	O
disjoint	O
straight	O
lines	B
,	O
and	O
that	O
each	O
line	B
from	O
one	O
set	O
meets	O
each	O
line	B
from	O
the	O
other	O
set	O
.	O
the	O
two	O
quadrics	O
shown	O
here	O
are	O
projectively	O
(	O
though	O
not	O
afﬁnely	O
)	O
equivalent	B
.	O
ruled	B
quadrics	O
.	O
quadrics	B
fall	O
into	O
two	O
classes	O
–	O
ruled	B
and	O
unruled	O
quadrics	B
.	O
a	O
ruled	B
quadric	O
is	O
one	O
that	O
contains	O
a	O
straight	O
line	B
.	O
more	O
particularly	O
,	O
as	O
shown	O
in	O
ﬁgure	O
3.3	O
,	O
the	O
non-degenerate	O
ruled	B
quadric	O
(	O
hyperboloid	B
of	O
one	O
sheet	O
)	O
contains	O
two	O
families	O
of	O
straight	O
lines	B
called	O
generators	O
.	O
for	O
more	O
properties	B
of	O
ruled	B
quadrics	O
,	O
refer	O
to	O
[	O
semple-79	O
]	O
.	O
the	O
most	O
interesting	O
of	O
the	O
quadrics	O
are	O
the	O
two	O
quadrics	O
of	O
rank	O
4.	O
note	O
that	O
these	O
two	O
quadrics	O
differ	O
even	O
in	O
their	O
topological	O
type	O
.	O
the	O
quadric	O
of	O
signature	O
2	O
(	O
the	O
sphere	O
)	O
is	O
(	O
obviously	O
enough	O
)	O
topologically	O
a	O
sphere	O
.	O
on	O
the	O
other	O
hand	O
,	O
the	O
hyper-	O
boloid	O
of	O
1	O
sheet	O
is	O
not	O
topologically	O
equivalent	B
(	O
homeomorphic	O
)	O
to	O
a	O
sphere	O
.	O
in	O
fact	O
,	O
it	O
is	O
topologically	O
a	O
torus	O
(	O
topologically	O
equivalent	B
to	O
s1	O
×	O
s1	O
)	O
.	O
this	O
gives	O
the	O
clearest	O
indication	O
that	O
they	O
are	O
not	O
projectively	O
equivalent	B
.	O
3.3	O
twisted	O
cubics	O
the	O
twisted	B
cubic	I
may	O
be	O
considered	O
to	O
be	O
a	O
3-dimensional	O
analogue	O
of	O
a	O
2d	O
conic	B
(	O
although	O
in	O
other	O
ways	O
it	O
is	O
a	O
quadric	O
surface	O
which	O
is	O
the	O
3-dimensional	O
analogue	O
of	O
a	O
2d	O
conic	B
.	O
)	O
76	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
fig	O
.	O
3.4.	O
degenerate	B
quadrics	O
.	O
the	O
two	O
most	O
important	O
degenerate	B
quadrics	O
are	O
shown	O
,	O
the	O
cone	O
and	O
two	O
planes	O
.	O
both	O
these	O
quadrics	B
are	O
ruled	B
.	O
the	O
matrix	B
representing	O
the	O
cone	O
has	O
rank	O
3	O
,	O
and	O
the	O
null-	O
vector	O
represents	O
the	O
nodal	O
point	B
of	O
the	O
cone	O
.	O
the	O
matrix	B
representing	O
the	O
two	O
(	O
non-coincident	O
)	O
planes	O
has	O
rank	O
2	O
,	O
and	O
the	O
two	O
generators	O
of	O
the	O
rank	O
2	O
null-space	B
are	O
two	O
points	O
on	O
the	O
intersection	B
line	O
of	O
the	O
planes	O
.	O
a	O
conic	B
in	O
the	O
2-dimensional	O
projective	B
plane	I
may	O
be	O
described	O
as	O
a	O
parametrized	O
curve	O
given	O
by	O
the	O
equation	O
	O
x1	O
x2	O
x3	O
	O
=	O
a	O
	O
1	O
	O
=	O
θ	O
θ2	O
	O
a11	O
+	O
a12θ	O
+	O
a13θ2	O
a21	O
+	O
a22θ	O
+	O
a23θ2	O
a31	O
+	O
a32θ	O
+	O
a33θ2	O
	O
(	O
3.18	O
)	O
(	O
3.19	O
)	O
where	O
a	O
is	O
a	O
non-singular	O
3	O
×	O
3	O
matrix	B
.	O
in	O
an	O
analogous	O
manner	O
,	O
a	O
twisted	B
cubic	I
is	O
deﬁned	O
to	O
be	O
a	O
curve	O
in	O
ip3	O
given	O
in	O
parametric	O
form	O
as	O
x1	O
	O
=	O
a	O
	O
1	O
	O
=	O
x2	O
x3	O
x4	O
θ	O
θ2	O
θ3	O
where	O
a	O
is	O
a	O
non-singular	O
4	O
×	O
4	O
matrix	B
.	O
	O
a11	O
+	O
a12θ	O
+	O
a13θ2	O
+	O
a14θ3	O
a21	O
+	O
a22θ	O
+	O
a23θ2	O
+	O
a24θ3	O
a31	O
+	O
a32θ	O
+	O
a33θ2	O
+	O
a34θ3	O
a41	O
+	O
a42θ	O
+	O
a43θ2	O
+	O
a44θ3	O
	O
since	O
a	O
twisted	B
cubic	I
is	O
perhaps	O
an	O
unfamiliar	O
object	O
,	O
various	O
views	O
of	O
the	O
curve	O
are	O
shown	O
in	O
ﬁgure	O
3.5.	O
in	O
fact	O
,	O
a	O
twisted	B
cubic	I
is	O
a	O
quite	O
benign	O
space	B
curve	I
.	O
properties	B
of	O
a	O
twisted	B
cubic	I
.	O
let	O
c	O
be	O
a	O
non-singular	O
twisted	B
cubic	I
.	O
then	O
c	O
is	O
not	O
contained	O
within	O
any	O
plane	B
of	O
ip3	O
;	O
it	O
intersects	O
a	O
general	O
plane	O
at	O
three	O
distinct	O
points	O
.	O
a	O
twisted	B
cubic	I
has	O
12	O
degrees	B
of	I
freedom	I
(	O
counted	O
as	O
15	O
for	O
the	O
matrix	B
a	O
,	O
less	O
3	O
for	O
a	O
1d	O
projectivity	B
on	O
the	O
parametrization	B
θ	O
,	O
which	O
leaves	O
the	O
curve	O
unaltered	O
)	O
.	O
requiring	O
the	O
curve	O
to	O
pass	O
through	O
a	O
point	B
x	O
places	O
two	O
constraints	O
on	O
c	O
,	O
since	O
x	O
=	O
a	O
(	O
1	O
,	O
θ	O
,	O
θ2	O
,	O
θ3	O
)	O
t	O
is	O
three	O
independent	O
ratios	O
,	O
but	O
only	O
two	O
constraints	O
once	O
θ	O
is	O
eliminated	O
.	O
thus	O
,	O
there	O
is	O
a	O
unique	O
c	O
through	O
six	O
points	O
in	O
general	B
position	I
.	O
finally	O
,	O
all	O
non-degenerate	O
twisted	O
cubics	O
are	O
projectively	O
equivalent	B
.	O
this	O
is	O
clear	O
from	O
the	O
deﬁnition	B
(	O
3.19	O
)	O
:	O
a	O
projective	B
transformation	I
a−1	O
maps	O
c	O
to	O
the	O
standard	O
form	O
c	O
(	O
θ	O
(	O
cid:2	O
)	O
3	O
)	O
t	O
,	O
and	O
since	O
)	O
=	O
(	O
1	O
,	O
θ	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
2	O
,	O
θ	O
,	O
θ	O
3.4	O
the	O
hierarchy	B
of	I
transformations	O
77	O
fig	O
.	O
3.5.	O
various	O
views	O
of	O
the	O
twisted	O
cubic	O
(	O
t3	O
,	O
t2	O
,	O
t	O
,	O
)	O
t.	O
the	O
curve	O
is	O
thickened	O
to	O
a	O
tube	O
to	O
aid	O
in	O
visualization	O
.	O
all	O
twisted	O
cubics	O
can	O
be	O
mapped	O
to	O
this	O
curve	O
,	O
it	O
follows	O
that	O
all	O
twisted	O
cubics	O
are	O
projectively	O
equivalent	B
.	O
a	O
classiﬁcation	B
of	I
the	O
various	O
special	O
cases	O
of	O
a	O
twisted	O
cubic	O
,	O
such	O
as	O
a	O
conic	B
and	O
coincident	O
line	B
,	O
are	O
given	O
in	O
[	O
semple-79	O
]	O
.	O
the	O
twisted	B
cubic	I
makes	O
an	O
appearance	O
as	O
the	O
horopter	B
for	O
two-view	O
geometry	O
(	O
chapter	O
9	O
)	O
,	O
and	O
plays	O
the	O
central	O
role	O
in	O
deﬁning	O
the	O
degenerate	B
set	O
for	B
camera	I
resectioning	I
(	O
chapter	O
22	O
)	O
.	O
3.4	O
the	O
hierarchy	B
of	I
transformations	O
there	O
are	O
a	O
number	O
of	O
specializations	O
of	O
a	O
projective	O
transformation	B
of	O
3-space	O
which	O
will	O
appear	O
frequently	O
throughout	O
this	O
book	O
.	O
the	O
specializations	O
are	O
analogous	O
to	O
the	O
strata	O
of	O
section	O
2.4	O
(	O
p37	O
)	O
for	O
planar	O
transformations	O
.	O
each	O
specialization	O
is	O
a	O
sub-	O
group	O
,	O
and	O
is	O
identiﬁed	O
by	O
its	O
matrix	B
form	O
,	O
or	O
equivalently	O
by	O
its	O
invariants	B
.	O
these	O
are	O
summarized	O
in	O
table	O
3.2.	O
this	O
table	O
lists	O
only	O
the	O
additional	O
properties	B
of	O
the	O
3-space	O
transformations	O
over	O
their	O
2-space	O
counterparts	O
–	O
the	O
transformations	B
of	I
3-space	O
also	O
have	O
the	O
invariants	B
listed	O
in	O
table	O
2.1	O
(	O
p44	O
)	O
for	O
the	O
corresponding	O
2-space	O
transforma-	O
tions	O
.	O
the	O
15	O
degrees	B
of	I
freedom	I
of	O
a	O
projective	B
transformation	I
are	O
accounted	O
for	O
as	O
seven	O
for	O
a	O
similarity	O
(	O
three	O
for	O
rotation	O
,	O
three	O
for	B
translation	I
,	O
one	O
for	O
isotropic	O
scaling	B
)	O
,	O
ﬁve	O
for	O
afﬁne	O
scalings	O
,	O
and	O
three	O
for	O
the	O
projective	B
part	O
of	O
the	O
transformation	O
.	O
two	O
of	O
the	O
most	O
important	O
characterizations	O
of	O
these	O
transformations	O
are	O
parallelism	O
and	O
angles	O
.	O
for	O
example	O
,	O
after	O
an	O
afﬁne	B
transformation	I
lines	O
which	O
were	O
originally	O
parallel	B
remain	O
parallel	B
,	O
but	O
angles	O
are	O
skewed	O
;	O
and	O
after	O
a	O
projective	B
transformation	I
parallelism	O
is	O
lost	O
.	O
in	O
the	O
following	O
we	O
brieﬂy	O
describe	O
a	O
decomposition	B
of	I
a	O
euclidean	O
transformation	O
that	O
will	O
be	O
useful	O
when	O
discussing	O
special	O
motions	O
later	O
in	O
this	O
book	O
.	O
3.4.1	O
the	O
screw	O
decomposition	O
a	O
euclidean	O
transformation	O
on	O
the	O
plane	B
may	O
be	O
considered	O
as	O
a	O
specialization	O
of	O
a	O
euclidean	O
transformation	B
of	O
3-space	O
with	O
the	O
restrictions	O
that	O
the	O
translation	O
vector	O
t	O
lies	O
in	O
the	O
plane	B
,	O
and	O
the	O
rotation	B
axis	O
is	O
perpendicular	O
to	O
the	O
plane	B
.	O
however	O
,	O
euclidean	O
actions	O
on	O
3-space	O
are	O
more	O
general	O
than	O
this	O
because	O
the	O
rotation	B
axis	O
and	O
translation	O
are	O
not	O
perpendicular	O
in	O
general	O
.	O
the	O
screw	O
decomposition	O
enables	O
any	O
euclidean	O
78	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
group	O
projective	B
15	O
dof	O
(	O
cid:25	O
)	O
(	O
cid:24	O
)	O
matrix	B
a	O
vt	O
t	O
v	O
(	O
cid:24	O
)	O
(	O
cid:24	O
)	O
(	O
cid:24	O
)	O
a	O
0t	O
sr	O
0t	O
r	O
0t	O
(	O
cid:25	O
)	O
(	O
cid:25	O
)	O
(	O
cid:25	O
)	O
t	O
1	O
t	O
1	O
t	O
1	O
afﬁne	B
12	O
dof	O
similarity	B
7	O
dof	O
euclidean	O
6	O
dof	O
distortion	B
invariant	O
properties	B
intersection	O
and	O
tangency	O
of	O
sur-	O
faces	O
in	O
contact	O
.	O
sign	O
of	O
gaussian	O
curvature	O
.	O
parallelism	O
of	O
planes	O
,	O
volume	O
ra-	O
tios	O
,	O
centroids	O
.	O
the	O
plane	O
at	O
inﬁn-	O
ity	O
,	O
π∞	O
,	O
(	O
see	O
section	O
3.5	O
)	O
.	O
the	O
absolute	O
conic	O
,	O
ω∞	O
,	O
(	O
see	O
section	O
3.6	O
)	O
.	O
volume	O
.	O
table	O
3.2.	O
geometric	B
properties	O
invariant	O
to	O
commonly	O
occurring	O
transformations	B
of	I
3-space	O
.	O
the	O
matrix	B
a	O
is	O
an	O
invertible	O
3	O
×	O
3	O
matrix	B
,	O
r	O
is	O
a	O
3d	O
rotation	B
matrix	O
,	O
t	O
=	O
(	O
tx	O
,	O
ty	O
,	O
tz	O
)	O
t	O
a	O
3d	O
translation	O
,	O
v	O
a	O
general	O
3-vector	O
,	O
v	O
a	O
scalar	O
,	O
and	O
0	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
a	O
null	O
3-vector	O
.	O
the	O
distortion	B
column	O
shows	O
typical	O
effects	O
of	O
the	O
transformations	O
on	O
a	O
cube	O
.	O
transformations	O
higher	O
in	O
the	O
table	O
can	O
produce	O
all	O
the	O
actions	O
of	O
the	O
ones	O
below	O
.	O
these	O
range	O
from	O
euclidean	O
,	O
where	O
only	O
translations	O
and	O
rotations	B
occur	O
,	O
to	O
projective	O
where	O
ﬁve	O
points	O
can	O
be	O
transformed	O
to	O
any	O
other	O
ﬁve	O
points	O
(	O
provided	O
no	O
three	O
points	O
are	O
collinear	O
,	O
or	O
four	O
coplanar	O
)	O
.	O
action	O
(	O
a	O
rotation	B
composed	O
with	O
a	O
translation	O
)	O
to	O
be	O
reduced	B
to	O
a	O
situation	O
almost	O
as	O
simple	O
as	O
the	O
2d	O
case	O
.	O
the	O
screw	O
decomposition	O
is	O
that	O
result	O
3.6.	O
any	O
particular	O
translation	O
and	O
rotation	B
is	O
equivalent	B
to	O
a	O
rotation	B
about	O
a	O
screw	B
axis	I
together	O
with	O
a	O
translation	O
along	O
the	O
screw	B
axis	I
.	O
the	O
screw	B
axis	I
is	O
parallel	B
to	O
the	O
rotation	B
axis	O
.	O
in	O
the	O
case	O
of	O
a	O
translation	O
and	O
an	O
orthogonal	B
rotation	O
axis	O
(	O
termed	O
planar	B
motion	I
)	O
,	O
the	O
motion	O
is	O
equivalent	B
to	O
a	O
rotation	B
alone	O
about	O
the	O
screw	B
axis	I
.	O
proof	O
.	O
we	O
will	O
sketch	O
a	O
constructive	O
geometric	B
proof	O
that	O
can	O
easily	O
be	O
visualized	O
.	O
consider	O
ﬁrst	O
the	O
2d	O
case	O
–	O
a	O
euclidean	O
transformation	O
on	O
the	O
plane	B
.	O
it	O
is	O
evident	O
from	O
ﬁgure	O
3.6	O
that	O
a	O
screw	B
axis	I
exists	O
for	O
such	O
2d	O
transformations	O
.	O
for	O
the	O
3d	O
case	O
,	O
decompose	O
the	O
translation	O
t	O
into	O
two	O
components	O
t	O
=	O
t	O
(	O
cid:5	O
)	O
+	O
t⊥	O
,	O
parallel	B
and	O
orthogonal	B
respectively	O
to	O
the	O
rotation	B
axis	O
direction	O
(	O
t	O
(	O
cid:5	O
)	O
=	O
(	O
t.a	O
)	O
a	O
,	O
t⊥	O
=	O
t	O
−	O
(	O
t.a	O
)	O
a	O
)	O
.	O
then	O
the	O
euclidean	O
motion	O
is	O
partitioned	O
into	O
two	O
parts	O
:	O
ﬁrst	O
a	O
rotation	B
about	O
the	O
screw	O
3.5	O
the	O
plane	O
at	O
inﬁnity	O
79	O
/	O
y	O
r	O
(	O
)	O
θ	O
/	O
x	O
o	O
/	O
t	O
y	O
o	O
a	O
x	O
/	O
y	O
s	O
θ	O
/	O
x	O
o	O
/	O
y	O
o	O
b	O
x	O
fig	O
.	O
3.6	O
.	O
2d	O
euclidean	O
motion	O
and	O
a	O
“	O
screw	O
”	O
axis	O
.	O
(	O
a	O
)	O
the	O
frame	O
{	O
x	O
,	O
y	O
}	O
undergoes	O
a	O
translation	O
t⊥	O
and	O
a	O
rotation	B
by	O
θ	O
to	O
reach	O
the	O
frame	O
{	O
x	O
(	O
cid:1	O
)	O
}	O
.	O
the	O
motion	O
is	O
in	O
the	O
plane	B
orthogonal	O
to	O
the	O
rotation	B
(	O
cid:1	O
)	O
axis	O
.	O
(	O
b	O
)	O
this	O
motion	O
is	O
equivalent	B
to	O
a	O
single	O
rotation	O
about	O
the	O
screw	B
axis	I
s.	O
the	O
screw	B
axis	I
lies	O
on	O
the	O
perpendicular	O
bisector	O
of	O
the	O
line	O
joining	O
corresponding	O
points	O
,	O
such	O
that	O
the	O
angle	B
between	O
the	O
lines	B
joining	O
s	O
to	O
the	O
corresponding	O
points	O
is	O
θ.	O
in	O
the	O
ﬁgure	O
the	O
corresponding	O
points	O
are	O
the	O
two	O
frame	O
origins	O
and	O
θ	O
has	O
the	O
value	O
90◦	O
,	O
y	O
.	O
screw	B
axis	I
o	O
t	O
a	O
s	O
θ	O
a	O
o	O
/	O
screw	B
axis	I
o	O
a	O
s	O
/	O
o	O
/	O
t	O
s	O
o	O
/	O
b	O
fig	O
.	O
3.7	O
.	O
3d	O
euclidean	O
motion	O
and	O
the	O
screw	O
decomposition	O
.	O
any	O
euclidean	O
rotation	O
r	O
and	O
trans-	O
lation	O
t	O
may	O
be	O
achieved	O
by	O
(	O
a	O
)	O
a	O
rotation	B
about	O
the	O
screw	B
axis	I
,	O
followed	O
by	O
(	O
b	O
)	O
a	O
translation	O
along	O
the	O
screw	B
axis	I
by	O
t	O
(	O
cid:6	O
)	O
.	O
here	O
a	O
is	O
the	O
(	O
unit	O
)	O
direction	O
of	O
the	O
rotation	O
axis	O
(	O
so	O
that	O
ra	O
=	O
a	O
)	O
,	O
and	O
t	O
is	O
decomposed	O
as	O
t	O
=	O
t	O
(	O
cid:6	O
)	O
+	O
t⊥	O
,	O
which	O
are	O
vector	O
components	O
parallel	B
and	O
orthogonal	B
respectively	O
to	O
the	O
rotation	B
axis	O
direction	O
the	O
point	B
s	O
is	O
closest	O
to	O
o	O
on	O
the	O
screw	B
axis	I
(	O
so	O
that	O
the	O
line	B
from	O
s	O
to	O
o	O
is	O
perpendicular	O
to	O
the	O
direction	O
of	O
a	O
)	O
.	O
similarly	O
s	O
(	O
cid:1	O
)	O
is	O
the	O
point	B
on	O
the	O
screw	B
axis	I
closest	O
to	O
o	O
(	O
cid:1	O
)	O
.	O
axis	O
,	O
which	O
covers	O
the	O
rotation	O
and	O
t⊥	O
;	O
second	O
a	O
translation	O
by	O
t	O
(	O
cid:5	O
)	O
along	O
the	O
screw	B
axis	I
.	O
the	O
complete	O
motion	O
is	O
illustrated	O
in	O
ﬁgure	O
3.7.	O
the	O
screw	O
decomposition	O
can	O
be	O
determined	O
from	O
the	O
ﬁxed	O
points	O
of	O
the	O
4×4	O
matrix	B
representing	O
the	O
euclidean	O
transformation	O
.	O
this	O
idea	O
is	O
examined	O
in	O
the	O
exercises	O
at	O
the	O
end	O
of	O
the	O
chapter	O
.	O
3.5	O
the	O
plane	O
at	O
inﬁnity	O
in	O
planar	O
projective	O
geometry	O
identifying	O
the	O
line	B
at	I
inﬁnity	I
,	O
l∞	O
,	O
allowed	O
afﬁne	B
prop-	O
erties	O
of	O
the	O
plane	O
to	O
be	O
measured	O
.	O
identifying	O
the	O
circular	B
points	I
on	O
l∞	O
then	O
allowed	O
80	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
the	O
measurement	O
of	O
metric	B
properties	I
.	O
in	O
the	O
projective	B
geometry	O
of	O
3-space	O
the	O
corre-	O
sponding	O
geometric	B
entities	O
are	O
the	O
plane	O
at	O
inﬁnity	O
,	O
π∞	O
,	O
and	O
the	O
absolute	O
conic	O
,	O
ω∞	O
.	O
the	O
plane	O
at	O
inﬁnity	O
has	O
the	O
canonical	O
position	O
π∞	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
in	O
afﬁne	O
3-space	O
.	O
it	O
contains	O
the	O
directions	O
d	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
,	O
0	O
)	O
t	O
,	O
and	O
enables	O
the	O
identiﬁcation	O
of	O
afﬁne	O
properties	B
such	O
as	O
parallelism	O
.	O
in	O
particular	O
:	O
•	O
two	O
planes	O
are	O
parallel	B
if	O
,	O
and	O
only	O
if	O
,	O
their	O
line	B
of	O
intersection	B
is	O
on	O
π∞	O
.	O
•	O
a	O
line	B
is	O
parallel	B
to	O
another	O
line	B
,	O
or	O
to	O
a	O
plane	B
,	O
if	O
the	O
point	B
of	O
intersection	B
is	O
on	O
π∞	O
.	O
we	O
then	O
have	O
in	O
ip3	O
that	O
any	O
pair	O
of	O
planes	O
intersect	O
in	O
a	O
line	B
,	O
with	O
parallel	O
planes	O
intersecting	O
in	O
a	O
line	B
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
the	O
plane	B
π∞	O
is	O
a	O
geometric	B
representation	I
of	O
the	O
3	O
degrees	B
of	I
freedom	I
required	O
to	O
specify	O
afﬁne	B
properties	I
in	O
a	O
projective	B
coordinate	O
frame	O
.	O
in	O
loose	O
terms	O
,	O
the	O
plane	O
at	O
inﬁnity	O
is	O
a	O
ﬁxed	O
plane	O
under	O
any	O
afﬁne	B
transformation	I
,	O
but	O
“	O
sees	O
”	O
(	O
is	O
moved	O
by	O
)	O
a	O
projective	B
transformation	I
.	O
the	O
3	O
degrees	B
of	I
freedom	I
of	O
π∞	O
thus	O
measure	O
the	O
projective	B
component	O
of	O
a	O
general	O
homography	B
–	O
they	O
account	O
for	O
the	O
15	O
degrees	B
of	I
freedom	I
of	O
this	O
general	O
transformation	O
compared	O
to	O
an	O
afﬁnity	O
(	O
12	O
dof	O
)	O
.	O
more	O
formally	O
:	O
result	O
3.7.	O
the	O
plane	O
at	O
inﬁnity	O
,	O
π∞	O
,	O
is	O
a	O
ﬁxed	O
plane	O
under	O
the	O
projective	B
transforma-	O
tion	O
h	O
if	O
,	O
and	O
only	O
if	O
,	O
h	O
is	O
an	O
afﬁnity	O
.	O
the	O
proof	O
is	O
the	O
analogue	O
of	O
the	O
derivation	O
of	O
result	O
2.17	O
(	O
p48	O
)	O
.	O
it	O
is	O
worth	O
clarifying	O
two	O
points	O
:	O
(	O
i	O
)	O
the	O
plane	B
π∞	O
is	O
,	O
in	O
general	O
,	O
only	O
ﬁxed	O
as	O
a	O
set	O
under	O
an	O
afﬁnity	O
;	O
it	O
is	O
not	O
ﬁxed	O
pointwise	O
.	O
(	O
ii	O
)	O
under	O
a	O
particular	O
afﬁnity	O
(	O
for	O
example	O
a	O
euclidean	O
motion	O
)	O
there	O
may	O
be	O
planes	O
in	O
addition	O
to	O
π∞	O
which	O
are	O
ﬁxed	O
.	O
however	O
,	O
only	O
π∞	O
is	O
ﬁxed	O
under	O
any	O
afﬁnity	O
.	O
these	O
points	O
are	O
illustrated	O
in	O
more	O
detail	O
by	O
the	O
following	O
example	O
.	O
example	O
3.8.	O
consider	O
the	O
euclidean	O
transformation	O
represented	O
by	O
the	O
matrix	B
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
he	O
=	O
r	O
0	O
0t	O
1	O
=	O
	O
cos	O
θ	O
−	O
sin	O
θ	O
0	O
0	O
cos	O
θ	O
	O
.	O
0	O
0	O
1	O
0	O
0	O
1	O
0	O
0	O
sin	O
θ	O
0	O
0	O
(	O
3.20	O
)	O
this	O
is	O
a	O
rotation	B
by	O
θ	O
about	O
the	O
z-axis	O
with	O
a	O
zero	O
translation	O
(	O
it	O
is	O
a	O
planar	O
screw	O
motion	O
,	O
see	O
section	O
3.4.1	O
)	O
.	O
geometrically	O
it	O
is	O
evident	O
that	O
the	O
family	O
of	O
xy-planes	O
or-	O
thogonal	O
to	O
the	O
rotation	B
axis	O
are	O
simply	O
rotated	O
about	O
the	O
z-axis	O
by	O
this	O
transformation	B
.	O
this	O
means	O
that	O
there	O
is	O
a	O
pencil	O
of	O
ﬁxed	O
planes	O
orthogonal	B
to	O
the	O
z-axis	O
.	O
the	O
planes	O
are	O
ﬁxed	O
as	O
sets	O
,	O
but	O
not	O
pointwise	O
as	O
any	O
(	O
ﬁnite	B
)	O
point	B
(	O
not	O
on	O
the	O
axis	O
)	O
is	O
rotated	O
in	O
horizontal	O
circles	O
by	O
this	O
euclidean	O
action	O
.	O
algebraically	O
,	O
the	O
ﬁxed	O
planes	O
of	O
h	O
are	O
the	O
eigenvectors	O
of	O
ht	O
(	O
refer	O
to	O
section	O
2.9	O
)	O
.	O
in	O
this	O
case	O
the	O
eigenvalues	O
are	O
{	O
eiθ	O
,	O
e	O
−iθ	O
,	O
1	O
,	O
1	O
}	O
and	O
the	O
corresponding	O
eigenvectors	O
of	O
ht	O
	O
1	O
i	O
0	O
0	O
e1	O
=	O
3.6	O
the	O
absolute	O
conic	O
	O
e2	O
=	O
	O
1−i	O
e	O
are	O
	O
e3	O
=	O
	O
0	O
0	O
1	O
0	O
81	O
	O
e4	O
=	O
	O
.	O
	O
0	O
0	O
0	O
1	O
0	O
0	O
the	O
eigenvectors	O
e1	O
and	O
e2	O
do	O
not	O
correspond	O
to	O
real	O
planes	O
,	O
and	O
will	O
not	O
be	O
discussed	O
further	O
here	O
.	O
the	O
eigenvectors	O
e3	O
and	O
e4	O
are	O
degenerate	B
.	O
thus	O
there	O
is	O
a	O
pencil	O
of	O
ﬁxed	O
planes	O
which	O
is	O
spanned	O
by	O
these	O
eigenvectors	O
.	O
the	O
axis	O
of	O
this	O
pencil	O
is	O
the	O
line	B
of	O
intersection	B
of	O
the	O
the	O
planes	O
(	O
perpendicular	O
to	O
the	O
z-axis	O
)	O
with	O
π∞	O
,	O
and	O
the	O
pencil	O
(	O
cid:2	O
)	O
includes	O
π∞	O
.	O
the	O
example	O
also	O
illustrates	O
the	O
connection	O
between	O
the	O
geometry	O
of	O
the	O
projective	O
plane	B
,	O
ip2	O
,	O
and	O
projective	B
3-space	O
,	O
ip3	O
.	O
a	O
plane	B
π	O
intersects	O
π∞	O
in	O
a	O
line	B
which	O
is	O
the	O
line	B
at	I
inﬁnity	I
,	O
l∞	O
,	O
of	O
the	O
plane	O
π.	O
a	O
projective	B
transformation	I
of	O
ip3	O
induces	O
a	O
subordinate	O
plane	B
projective	O
transformation	B
on	O
π.	O
afﬁne	O
properties	O
of	O
a	O
reconstruction	B
.	O
in	O
later	O
chapters	O
on	O
reconstruction	O
,	O
for	O
exam-	O
ple	O
chapter	O
10	O
,	O
it	O
will	O
be	O
seen	O
that	O
the	O
projective	B
coordinates	O
of	O
the	O
(	O
euclidean	O
)	O
scene	O
can	O
be	O
reconstructed	O
from	O
multiple	O
views	O
.	O
once	O
π∞	O
is	O
identiﬁed	O
in	O
projective	O
3-space	O
,	O
i.e	O
.	O
its	O
projective	B
coordinates	O
are	O
known	O
,	O
it	O
is	O
then	O
possible	O
to	O
determine	O
afﬁne	B
prop-	O
erties	O
of	O
the	O
reconstruction	O
such	O
as	O
whether	O
geometric	B
entities	O
are	O
parallel	B
–	O
they	O
are	O
parallel	B
if	O
they	O
intersect	O
on	O
π∞	O
.	O
a	O
more	O
algorithmic	O
approach	O
is	O
to	O
transform	O
ip3	O
so	O
that	O
the	O
identiﬁed	O
π∞	O
is	O
moved	O
to	O
its	O
canonical	O
position	O
at	O
π∞	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
after	O
this	O
mapping	O
we	O
then	O
have	O
the	O
situation	O
that	O
the	O
euclidean	O
scene	O
,	O
where	O
π∞	O
has	O
the	O
coordinates	B
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
and	O
our	O
reconstruction	B
are	O
related	O
by	O
a	O
projective	B
transformation	I
that	O
ﬁxes	O
π∞	O
at	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
it	O
follows	O
from	O
result	O
3.7	O
that	O
the	O
scene	O
and	O
reconstruction	B
are	O
related	O
by	O
an	O
afﬁne	B
trans-	O
formation	O
.	O
thus	O
afﬁne	B
properties	I
can	O
now	O
be	O
measured	O
directly	O
from	O
the	O
coordinates	B
of	O
the	O
entities	O
.	O
3.6	O
the	O
absolute	O
conic	O
the	O
absolute	O
conic	O
,	O
ω∞	O
,	O
is	O
a	O
(	O
point	B
)	O
conic	B
on	O
π∞	O
.	O
in	O
a	O
metric	B
frame	O
π∞	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
and	O
points	O
on	O
ω∞	O
satisfy	O
=	O
0	O
.	O
(	O
3.21	O
)	O
note	O
that	O
two	O
equations	O
are	O
required	O
to	O
deﬁne	O
ω∞	O
.	O
for	O
directions	O
on	O
π∞	O
(	O
i.e	O
.	O
points	O
with	O
x4	O
=	O
0	O
)	O
the	O
deﬁning	O
equation	O
can	O
be	O
written	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
i	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
=	O
0	O
so	O
that	O
ω∞	O
corresponds	O
to	O
a	O
conic	B
c	O
with	O
matrix	O
c	O
=	O
i.	O
it	O
is	O
thus	O
a	O
conic	B
of	O
purely	O
imaginary	O
points	O
on	O
π∞	O
.	O
(	O
cid:26	O
)	O
x2	O
1	O
+	O
x2	O
2	O
+	O
x2	O
3	O
x4	O
82	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
the	O
conic	B
ω∞	O
is	O
a	O
geometric	B
representation	I
of	O
the	O
5	O
additional	O
degrees	B
of	I
freedom	I
that	O
are	O
required	O
to	O
specify	O
metric	B
properties	I
in	O
an	O
afﬁne	B
coordinate	O
frame	O
.	O
a	O
key	O
property	O
of	O
ω∞	O
is	O
that	O
it	O
is	O
a	O
ﬁxed	O
conic	O
under	O
any	O
similarity	B
transformation	I
.	O
more	O
formally	O
:	O
result	O
3.9.	O
the	O
absolute	O
conic	O
,	O
ω∞	O
,	O
is	O
a	O
ﬁxed	O
conic	O
under	O
the	O
projective	B
transformation	I
h	O
if	O
,	O
and	O
only	O
if	O
,	O
h	O
is	O
a	O
similarity	B
transformation	I
.	O
proof	O
.	O
since	O
the	O
absolute	O
conic	O
lies	O
in	O
the	O
plane	O
at	O
inﬁnity	O
,	O
a	O
transformation	B
ﬁxing	O
it	O
must	O
ﬁx	O
the	O
plane	O
at	O
inﬁnity	O
,	O
and	O
hence	O
must	O
be	O
afﬁne	B
.	O
such	O
a	O
transformation	B
is	O
of	O
the	O
form	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
.	O
ha	O
=	O
t	O
a	O
0t	O
1	O
restricting	O
to	O
the	O
plane	O
at	O
inﬁnity	O
,	O
the	O
absolute	O
conic	O
is	O
represented	O
by	O
the	O
matrix	B
i3×3	O
,	O
and	O
since	O
it	O
is	O
ﬁxed	O
by	O
ha	O
,	O
one	O
has	O
a−tia−1	O
=	O
i	O
(	O
up	O
to	O
scale	O
)	O
,	O
and	O
taking	O
inverses	O
gives	O
aat	O
=	O
i.	O
this	O
means	O
that	O
a	O
is	O
orthogonal	B
,	O
hence	O
a	O
scaled	O
rotation	O
,	O
or	O
scaled	O
rotation	O
with	O
reﬂection	O
.	O
this	O
completes	O
the	O
proof	O
.	O
even	O
though	O
ω∞	O
does	O
not	O
have	O
any	O
real	O
points	O
,	O
it	O
shares	O
the	O
properties	B
of	O
any	O
conic	B
–	O
such	O
as	O
that	O
a	O
line	B
intersects	O
a	O
conic	B
in	O
two	O
points	O
;	O
the	O
pole–polar	B
relationship	I
etc	O
.	O
here	O
are	O
a	O
few	O
particular	O
properties	B
of	O
ω∞	O
:	O
(	O
i	O
)	O
ω∞	O
is	O
only	O
ﬁxed	O
as	O
a	O
set	O
by	O
a	O
general	O
similarity	O
;	O
it	O
is	O
not	O
ﬁxed	O
pointwise	O
.	O
this	O
means	O
that	O
under	O
a	O
similarity	B
a	O
point	B
on	O
ω∞	O
may	O
travel	O
to	O
another	O
point	B
on	O
ω∞	O
,	O
but	O
it	O
is	O
not	O
mapped	O
to	O
a	O
point	B
off	O
the	O
conic	B
.	O
(	O
ii	O
)	O
all	O
circles	O
intersect	O
ω∞	O
in	O
two	O
points	O
.	O
suppose	O
the	O
support	O
plane	B
of	O
the	O
circle	O
is	O
π.	O
then	O
π	O
intersects	O
π∞	O
in	O
a	O
line	B
,	O
and	O
this	O
line	B
intersects	O
ω∞	O
in	O
two	O
points	O
.	O
these	O
two	O
points	O
are	O
the	O
circular	B
points	I
of	O
π	O
.	O
(	O
iii	O
)	O
all	O
spheres	O
intersect	O
π∞	O
in	O
ω∞	O
.	O
metric	B
properties	I
.	O
once	O
ω∞	O
(	O
and	O
its	O
support	O
plane	B
π∞	O
)	O
have	O
been	O
identiﬁed	O
in	O
projective	O
3-space	O
then	O
metric	B
properties	I
,	O
such	O
as	O
angles	O
and	O
relative	O
lengths	O
,	O
can	O
be	O
measured	O
.	O
consider	O
two	O
lines	O
with	O
directions	O
(	O
3-vectors	O
)	O
d1	O
and	O
d2	O
.	O
the	O
angle	B
between	O
these	O
directions	O
in	O
a	O
euclidean	O
world	O
frame	O
is	O
given	O
by	O
(	O
dt	O
d2	O
)	O
1	O
d1	O
)	O
(	O
dt	O
2	O
cos	O
θ	O
=	O
(	O
cid:19	O
)	O
(	O
dt	O
1	O
.	O
d2	O
)	O
this	O
may	O
be	O
written	O
as	O
(	O
cid:19	O
)	O
(	O
dt	O
1	O
(	O
dt	O
ω∞d2	O
)	O
1	O
ω∞d1	O
)	O
(	O
dt	O
2	O
ω∞d2	O
)	O
cos	O
θ	O
=	O
(	O
3.22	O
)	O
(	O
3.23	O
)	O
where	O
d1	O
and	O
d2	O
are	O
the	O
points	O
of	O
intersection	B
of	O
the	O
lines	B
with	O
the	O
plane	B
π∞	O
containing	O
the	O
conic	B
ω∞	O
,	O
and	O
ω∞	O
is	O
the	O
matrix	B
representation	O
of	O
the	O
absolute	O
conic	B
in	O
that	O
plane	B
.	O
3.7	O
the	O
absolute	B
dual	I
quadric	I
83	O
d	O
1	O
a	O
ω	O
d	O
2	O
π	O
ω	O
d	O
b	O
l	O
π	O
fig	O
.	O
3.8.	O
orthogonality	O
and	O
ω∞	O
.	O
(	O
a	O
)	O
on	O
π∞	O
orthogonal	B
directions	O
d1	O
,	O
d2	O
are	O
conjugate	O
with	O
respect	O
to	O
ω∞	O
.	O
(	O
b	O
)	O
a	O
plane	B
normal	O
direction	O
d	O
and	O
the	O
intersection	B
line	O
l	O
of	O
the	O
plane	O
with	O
π∞	O
are	O
in	O
pole–polar	O
relation	B
with	O
respect	O
to	O
ω∞	O
.	O
the	O
expression	O
(	O
3.23	O
)	O
reduces	O
to	O
(	O
3.22	O
)	O
in	O
a	O
euclidean	O
world	O
frame	O
where	O
ω∞	O
=	O
i.	O
however	O
,	O
the	O
expression	O
is	O
valid	O
in	O
any	O
projective	B
coordinate	O
frame	O
as	O
may	O
be	O
veriﬁed	O
from	O
the	O
transformation	B
properties	O
of	B
points	I
and	O
conics	O
(	O
see	O
(	O
iv	O
)	O
(	O
b	O
)	O
on	O
page	O
63	O
)	O
.	O
there	O
is	O
no	O
simple	O
formula	O
for	O
the	O
angle	B
between	O
two	O
planes	O
computed	O
from	O
the	O
directions	O
of	O
their	O
surface	O
normals	O
.	O
orthogonality	O
and	O
polarity	O
.	O
we	O
now	O
give	O
a	O
geometric	B
representation	I
of	O
orthogo-	O
nality	O
in	O
a	O
projective	B
space	O
based	O
on	O
the	O
absolute	O
conic	O
.	O
the	O
main	O
device	O
will	O
be	O
the	O
pole–polar	B
relationship	I
between	O
a	O
point	O
and	O
line	O
induced	O
by	O
a	O
conic	B
.	O
an	O
immediate	O
consequence	O
of	O
(	O
3.23	O
)	O
is	O
that	O
two	O
directions	O
d1	O
and	O
d2	O
are	O
orthogonal	B
if	O
dt	O
ω∞d2	O
=	O
0.	O
thus	O
orthogonality	B
is	O
encoded	O
by	O
conjugacy	B
with	O
respect	O
to	O
ω∞	O
.	O
the	O
1	O
great	O
advantage	O
of	O
this	O
is	O
that	O
conjugacy	B
is	O
a	O
projective	B
relation	O
,	O
so	O
that	O
in	O
a	O
projective	B
frame	O
(	O
obtained	O
by	O
a	O
projective	B
transformation	I
of	O
euclidean	O
3-space	O
)	O
directions	O
can	O
be	O
identiﬁed	O
as	O
orthogonal	O
if	O
they	O
are	O
conjugate	O
with	O
respect	O
to	O
ω∞	O
in	O
that	O
frame	O
(	O
in	O
general	O
the	O
matrix	B
of	O
ω∞	O
is	O
not	O
i	O
in	O
a	O
projective	B
frame	O
)	O
.	O
the	O
geometric	B
representation	I
of	O
orthogonality	B
is	O
shown	O
in	O
ﬁgure	O
3.8.	O
this	O
representation	B
is	O
helpful	O
when	O
considering	O
orthogonality	B
between	O
rays	O
in	O
a	O
camera	B
,	O
for	O
example	O
in	O
determining	O
the	O
normal	O
to	O
a	O
plane	B
through	O
the	O
camera	B
cen-	O
tre	O
(	O
see	O
section	O
8.6	O
(	O
p213	O
)	O
)	O
.	O
if	O
image	O
points	O
are	O
conjugate	O
with	O
respect	O
to	O
the	O
image	O
of	O
ω∞	O
then	O
the	O
corresponding	O
rays	O
are	O
orthogonal	B
.	O
again	O
,	O
a	O
more	O
algorithmic	O
approach	O
is	O
to	O
projectively	O
transform	O
the	O
coordinates	B
so	O
that	O
ω∞	O
is	O
mapped	O
to	O
its	O
canonical	O
position	O
(	O
3.21	O
)	O
,	O
and	O
then	O
metric	B
properties	I
can	O
be	O
determined	O
directly	O
from	O
coordinates	O
.	O
3.7	O
the	O
absolute	B
dual	I
quadric	I
recall	O
that	O
ω∞	O
is	O
deﬁned	O
by	O
two	O
equations	O
–	O
it	O
is	O
a	O
conic	B
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
the	O
dual	B
of	O
the	O
absolute	O
conic	O
ω∞	O
is	O
a	O
degenerate	B
dual	O
quadric	O
in	O
3-space	O
called	O
the	O
absolute	B
dual	I
quadric	I
,	O
and	O
denoted	O
q∗	O
∞	O
.	O
geometrically	O
q∗	O
∞	O
consists	O
of	O
the	O
planes	O
tangent	O
to	O
ω∞	O
,	O
so	O
that	O
ω∞	O
is	O
the	O
“	O
rim	O
”	O
of	O
q∗	O
∞	O
.	O
this	O
is	O
called	O
a	O
rim	O
quadric	O
.	O
think	O
of	O
the	O
set	O
of	O
planes	O
tangent	O
to	O
an	O
ellipsoid	O
,	O
and	O
then	O
squash	O
the	O
ellipsoid	O
to	O
a	O
pancake	O
.	O
∞	O
is	O
represented	O
by	O
a	O
4	O
×	O
4	O
homogeneous	O
matrix	O
of	O
rank	O
3	O
,	O
which	O
in	O
algebraically	O
q∗	O
84	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
metric	B
3-space	O
has	O
the	O
canonical	B
form	I
q∗	O
∞	O
=	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
i	O
0	O
0t	O
0	O
.	O
(	O
3.24	O
)	O
we	O
will	O
show	O
that	O
any	O
plane	B
in	O
the	O
dual	B
absolute	I
quadric	I
envelope	O
is	O
indeed	O
tangent	O
to	O
ω∞	O
,	O
so	O
the	O
q∗	O
∞	O
is	O
truly	O
a	O
dual	B
of	O
ω∞	O
.	O
consider	O
a	O
plane	B
represented	O
by	O
π	O
=	O
(	O
vt	O
,	O
k	O
)	O
t.	O
this	O
plane	B
is	O
in	O
the	O
envelope	O
deﬁned	O
by	O
q∗	O
∞π	O
=	O
0	O
,	O
which	O
given	O
the	O
form	O
(	O
3.24	O
)	O
is	O
equivalent	B
to	O
vtv	O
=	O
0.	O
now	O
,	O
(	O
see	O
section	O
8.6	O
(	O
p213	O
)	O
)	O
v	O
represents	O
the	O
line	B
in	O
which	O
the	O
plane	B
(	O
vt	O
,	O
k	O
)	O
t	O
meets	O
the	O
plane	O
at	O
inﬁnity	O
.	O
this	O
line	B
is	O
tangent	O
to	O
the	O
absolute	O
conic	O
if	O
and	O
only	O
if	O
vtiv	O
=	O
0.	O
thus	O
,	O
the	O
envelope	O
of	O
q∗	O
∞	O
is	O
made	O
up	O
of	O
just	O
those	O
planes	O
tangent	O
to	O
the	O
absolute	O
conic	O
.	O
∞	O
if	O
and	O
only	O
if	O
πtq∗	O
since	O
this	O
is	O
an	O
important	O
fact	O
,	O
we	O
consider	O
it	O
from	O
another	O
angle	B
.	O
consider	O
the	O
ab-	O
solute	O
conic	B
as	O
the	O
limit	O
of	O
a	O
series	O
of	O
squashed	O
ellipsoids	O
,	O
namely	O
quadrics	B
represented	O
by	O
the	O
matrix	B
q	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
k	O
)	O
.	O
as	O
k	O
→	O
∞	O
,	O
these	O
quadrics	B
become	O
increasingly	O
close	O
to	O
the	O
plane	O
at	O
inﬁnity	O
,	O
and	O
in	O
the	O
limit	O
the	O
only	O
points	O
they	O
contain	O
are	O
the	O
points	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
,	O
0	O
)	O
t	O
with	O
x2	O
3	O
=	O
0	O
,	O
that	O
is	O
points	O
on	O
the	O
absolute	O
conic	O
.	O
however	O
,	O
1	O
+	O
x2	O
the	O
dual	B
of	O
q	O
is	O
the	O
quadric	O
q∗	O
−1	O
)	O
,	O
which	O
in	O
the	O
limit	O
becomes	O
the	O
absolute	B
dual	I
quadric	I
q∗	O
=	O
q−1	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
k	O
∞	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
0	O
)	O
.	O
2	O
+	O
x2	O
∞	O
is	O
a	O
degenerate	B
quadric	O
and	O
has	O
8	O
degrees	B
of	I
freedom	I
(	O
a	O
symmet-	O
ric	O
matrix	B
has	O
10	O
independent	O
elements	O
,	O
but	O
the	O
irrelevant	O
scale	O
and	O
zero	O
determinant	O
condition	O
each	O
reduce	O
the	O
degrees	B
of	I
freedom	I
by	O
1	O
)	O
.	O
it	O
is	O
a	O
geometric	B
representation	I
of	O
the	O
8	O
degrees	B
of	I
freedom	I
that	O
are	O
required	O
to	O
specify	O
metric	B
properties	I
in	O
a	O
projective	B
coordinate	O
frame	O
.	O
q∗	O
∞	O
has	O
a	O
signiﬁcant	O
advantage	O
over	O
ω∞	O
in	O
algebraic	O
manipulations	O
because	O
both	O
π∞	O
and	O
ω∞	O
are	O
contained	O
in	O
a	O
single	O
geometric	O
object	O
(	O
unlike	O
ω∞	O
which	O
requires	O
two	O
equations	O
(	O
3.21	O
)	O
in	O
order	O
to	O
specify	O
it	O
)	O
.	O
in	O
the	O
following	O
we	O
give	O
its	O
three	O
most	O
important	O
properties	B
.	O
result	O
3.10.	O
the	O
absolute	B
dual	I
quadric	I
,	O
q∗	O
tion	O
h	O
if	O
,	O
and	O
only	O
if	O
,	O
h	O
is	O
a	O
similarity	B
.	O
∞	O
,	O
is	O
ﬁxed	O
under	O
the	O
projective	B
transforma-	O
the	O
dual	B
quadric	I
q∗	O
proof	O
.	O
this	O
follows	O
directly	O
from	O
the	O
invariance	O
of	O
the	O
absolute	O
conic	O
under	O
a	O
simi-	O
larity	O
transform	O
,	O
since	O
the	O
planar	O
tangency	O
relationship	O
between	O
q∗	O
∞	O
and	O
ω∞	O
is	O
transfor-	O
mation	O
invariant	O
.	O
nevertheless	O
,	O
we	O
give	O
an	O
independent	O
direct	O
proof	O
.	O
since	O
q∗	O
if	O
and	O
only	O
if	O
q∗	O
∞	O
is	O
a	O
dual	B
quadric	I
,	O
it	O
transforms	O
according	O
to	O
(	O
3.17–p74	O
)	O
,	O
so	O
it	O
is	O
ﬁxed	O
under	O
h	O
∞ht	O
.	O
applying	O
this	O
with	O
an	O
arbitrary	O
transform	O
∞	O
=	O
hq∗	O
we	O
ﬁnd	O
(	O
cid:17	O
)	O
i	O
0	O
0t	O
0	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
=	O
=	O
(	O
cid:17	O
)	O
h	O
=	O
(	O
cid:18	O
)	O
t	O
a	O
vt	O
k	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
i	O
0	O
0t	O
0	O
(	O
cid:18	O
)	O
t	O
a	O
vt	O
k	O
aat	O
av	O
vtat	O
vtv	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
at	O
v	O
tt	O
k	O
3.8	O
closure	O
85	O
which	O
must	O
be	O
true	O
up	O
to	O
scale	O
.	O
by	O
inspection	O
,	O
this	O
equation	O
holds	O
if	O
and	O
only	O
if	O
v	O
=	O
0	O
and	O
a	O
is	O
a	O
scaled	O
orthogonal	O
matrix	B
(	O
scaling	B
,	O
rotation	O
and	O
possible	O
reﬂection	O
)	O
.	O
in	O
other	O
words	O
,	O
h	O
is	O
a	O
similarity	B
transform	O
.	O
result	O
3.11.	O
the	O
plane	O
at	O
inﬁnity	O
π∞	O
is	O
the	O
null-vector	O
of	O
q∗	O
∞	O
.	O
this	O
is	O
easily	O
veriﬁed	O
when	O
q∗	O
∞	O
has	O
its	O
canonical	B
form	I
(	O
3.24	O
)	O
in	O
a	O
metric	B
frame	O
since	O
then	O
,	O
with	O
π∞	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
q∗	O
∞π∞	O
=	O
0.	O
this	O
property	O
holds	O
in	O
any	O
frame	O
as	O
may	O
be	O
readily	O
seen	O
algebraically	O
from	O
the	O
transformation	B
properties	O
of	O
planes	O
and	O
dual	B
=	O
hx	O
,	O
then	O
q∗	O
=	O
h	O
q∗	O
quadrics	B
:	O
if	O
x	O
(	O
cid:2	O
)	O
∞	O
ht	O
,	O
π	O
(	O
cid:2	O
)	O
∞	O
∞	O
=	O
(	O
h	O
q∗	O
∞	O
ht	O
)	O
h−tπ∞	O
=	O
hq∗	O
(	O
cid:19	O
)	O
∞π∞	O
=	O
0.	O
result	O
3.12.	O
the	O
angle	B
between	O
two	O
planes	O
π1	O
and	O
π2	O
is	O
given	O
by	O
∞	O
=	O
h−tπ∞	O
,	O
and	O
q∗	O
∞	O
(	O
cid:2	O
)	O
π	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
cos	O
θ	O
=	O
(	O
3.25	O
)	O
q∗	O
πt	O
∞π2	O
1	O
q∗∞π1	O
)	O
(	O
πt	O
2	O
(	O
πt	O
1	O
.	O
q∗∞π2	O
)	O
proof	O
.	O
π2	O
=	O
(	O
nt	O
to	O
consider	O
two	O
planes	O
with	O
euclidean	O
coordinates	B
π1	O
=	O
(	O
nt	O
1	O
,	O
d1	O
)	O
t	O
,	O
∞	O
has	O
the	O
form	O
(	O
3.24	O
)	O
,	O
and	O
(	O
3.25	O
)	O
reduces	O
2	O
,	O
d2	O
)	O
t.	O
in	O
a	O
euclidean	O
frame	O
,	O
q∗	O
(	O
cid:19	O
)	O
cos	O
θ	O
=	O
n2	O
nt	O
1	O
n1	O
)	O
(	O
nt	O
2	O
n2	O
)	O
(	O
nt	O
1	O
which	O
is	O
the	O
angle	B
between	O
the	O
planes	O
expressed	O
in	O
terms	O
of	O
a	O
scalar	O
product	O
of	O
their	O
normals	O
.	O
if	O
the	O
planes	O
and	O
q∗	O
∞	O
are	O
projectively	O
transformed	O
,	O
(	O
3.25	O
)	O
will	O
still	O
determine	O
the	O
angle	B
between	O
planes	O
due	O
to	O
the	O
(	O
covariant	O
)	O
transformation	B
properties	O
of	O
planes	O
and	O
dual	B
quadrics	O
.	O
the	O
details	O
of	O
the	O
last	O
part	O
of	O
the	O
proof	O
are	O
left	O
as	O
an	O
exercise	O
,	O
but	O
are	O
a	O
direct	O
3d	O
analogue	O
of	O
the	O
derivation	O
of	O
result	O
2.23	O
(	O
p54	O
)	O
on	O
the	O
angle	B
between	O
two	O
lines	O
in	O
ip2	O
computed	O
using	O
the	O
dual	B
of	O
the	O
circular	B
points	I
.	O
planes	O
in	O
ip3	O
are	O
the	O
analogue	O
of	B
lines	I
in	O
ip2	O
,	O
and	O
the	O
absolute	B
dual	I
quadric	I
is	O
the	O
analogue	O
of	O
the	O
dual	O
of	O
the	O
circular	O
points	O
.	O
3.8	O
closure	O
3.8.1	O
the	O
literature	O
the	O
textbooks	O
cited	O
in	O
chapter	O
2	O
are	O
also	O
relevant	O
here	O
.	O
see	O
also	O
[	O
boehm-94	O
]	O
for	O
a	O
gen-	O
eral	O
background	O
from	O
the	O
perspective	O
of	O
descriptive	O
geometry	O
,	O
and	O
hilbert	O
and	O
cohn-	O
vossen	O
[	O
hilbert-56	O
]	O
for	O
many	O
clearly	O
explained	O
properties	B
of	O
curves	O
and	O
surfaces	O
.	O
an	O
important	O
representation	B
for	O
points	O
,	O
lines	B
and	O
planes	O
in	O
ip3	O
,	O
which	O
is	O
omitted	O
in	O
this	O
chapter	O
,	O
is	O
the	O
grassmann–cayley	O
algebra	O
.	O
in	O
this	O
representation	B
geometric	O
operations	O
such	O
as	O
incidence	O
and	O
joins	O
are	O
represented	O
by	O
a	O
“	O
bracket	O
algebra	O
”	O
based	O
on	O
matrix	O
determinants	O
.	O
a	O
good	O
introduction	O
to	O
this	O
area	O
is	O
given	O
by	O
[	O
carlsson-94	O
]	O
,	O
and	O
its	O
application	O
to	O
multiple	O
view	O
tensors	O
is	O
illustrated	O
in	O
[	O
triggs-95	O
]	O
.	O
86	O
3	O
projective	B
geometry	O
and	O
transformations	B
of	I
3d	O
faugeras	O
and	O
maybank	O
[	O
faugeras-90	O
]	O
introduced	O
ω∞	O
into	O
the	O
computer	O
vision	O
liter-	O
ature	O
(	O
in	O
order	O
to	O
determine	O
the	O
multiplicity	O
of	O
solutions	O
for	O
relative	O
orientation	B
)	O
,	O
and	O
triggs	O
introduced	O
q∗	O
∞	O
in	O
[	O
triggs-97	O
]	O
for	O
use	O
in	O
auto-calibration	O
.	O
3.8.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
pl¨ucker	O
coordinates	B
.	O
(	O
a	O
)	O
using	O
pl¨ucker	O
line	B
coordinates	I
,	O
l	O
,	O
write	O
an	O
expression	O
for	O
the	O
point	B
of	O
intersection	B
of	O
a	O
line	B
with	O
a	O
plane	B
,	O
and	O
the	O
plane	B
deﬁned	O
by	O
a	O
point	O
and	O
a	O
line	B
.	O
(	O
b	O
)	O
now	O
derive	O
the	O
condition	O
for	O
a	O
point	B
to	O
be	O
on	B
a	I
line	I
,	O
and	O
a	O
line	B
to	O
be	O
on	O
(	O
c	O
)	O
show	O
that	O
parallel	B
planes	O
intersect	O
in	O
a	O
line	B
on	O
π∞	O
.	O
hint	O
,	O
start	O
from	O
(	O
3.9–	O
a	O
plane	B
.	O
p71	O
)	O
to	O
determine	O
the	O
line	B
of	O
intersection	B
of	O
two	O
parallel	O
planes	O
l∗	O
.	O
(	O
d	O
)	O
show	O
that	O
parallel	B
lines	I
intersect	O
on	O
π∞	O
.	O
(	O
ii	O
)	O
projective	B
transformations	O
.	O
show	O
that	O
a	O
(	O
real	O
)	O
projective	B
transformation	I
of	O
3-space	O
can	O
map	O
an	O
ellipsoid	O
to	O
a	O
paraboloid	O
or	O
hyperboloid	B
of	O
two	O
sheets	O
,	O
but	O
can	O
not	O
map	O
an	O
ellipsoid	O
to	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
(	O
i.e	O
.	O
a	O
surface	O
with	O
real	O
rulings	O
)	O
.	O
(	O
iii	O
)	O
screw	O
decomposition	O
.	O
show	O
that	O
the	O
4	O
×	O
4	O
matrix	B
representing	O
the	O
euclidean	O
transformation	O
{	O
r	O
,	O
t	O
}	O
(	O
with	O
a	O
the	O
direction	O
of	O
the	O
rotation	O
axis	O
,	O
i.e	O
.	O
ra	O
=	O
a	O
)	O
has	O
two	O
complex	O
conjugate	O
eigenvalues	O
,	O
and	O
two	O
equal	O
real	O
eigenvalues	O
,	O
and	O
the	O
following	O
eigenvector	O
structure	B
:	O
(	O
a	O
)	O
if	O
a	O
is	O
perpendicular	O
to	O
t	O
,	O
then	O
the	O
eigenvectors	O
corresponding	O
to	O
the	O
real	O
eigenvalues	O
are	O
distinct	O
;	O
(	O
b	O
)	O
otherwise	O
,	O
the	O
eigenvectors	O
corresponding	O
to	O
the	O
real	O
eigenvalues	O
are	O
coincident	O
,	O
and	O
on	O
π∞	O
.	O
(	O
e.g	O
.	O
choose	O
simple	O
cases	O
such	O
as	O
(	O
3.20	O
)	O
,	O
another	O
case	O
is	O
given	O
on	O
page	O
495	O
)	O
.	O
in	O
the	O
ﬁrst	O
case	O
the	O
two	O
real	O
points	O
corresponding	O
to	O
the	O
real	O
eigenvalues	O
deﬁne	O
a	O
line	B
of	O
ﬁxed	B
points	I
.	O
this	O
is	O
the	O
screw	B
axis	I
for	O
planar	B
motion	I
.	O
in	O
the	O
second	O
case	O
,	O
the	O
direction	O
of	O
the	O
screw	O
axis	O
is	O
deﬁned	O
,	O
but	O
it	O
is	O
not	O
a	O
line	B
of	O
ﬁxed	B
points	I
.	O
what	O
do	O
the	O
eigenvectors	O
corresponding	O
to	O
the	O
complex	O
eigenvalues	O
represent	O
?	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
in	O
this	O
chapter	O
,	O
we	O
consider	O
the	O
problem	O
of	O
estimation	B
.	O
in	O
the	O
present	O
context	O
this	O
will	O
be	O
taken	O
to	O
mean	O
the	O
computation	B
of	I
some	O
transformation	B
or	O
other	O
mathematical	O
quantity	O
,	O
based	O
on	O
measurements	O
of	O
some	O
nature	O
.	O
this	O
deﬁnition	B
is	O
somewhat	O
vague	O
,	O
so	O
to	O
make	O
it	O
more	O
concrete	O
,	O
here	O
are	O
a	O
number	O
of	O
estimation	O
problems	O
of	O
the	O
type	O
that	O
we	O
would	O
like	O
to	O
consider	O
.	O
(	O
i	O
)	O
2d	O
homography	B
.	O
given	O
a	O
set	O
of	B
points	I
xi	O
in	O
ip2	O
and	O
a	O
corresponding	O
set	O
of	O
i	O
likewise	O
in	O
ip2	O
,	O
compute	O
the	O
projective	B
transformation	I
that	O
takes	O
each	O
i.	O
in	O
a	O
practical	O
situation	O
,	O
the	O
points	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
points	O
in	O
two	O
images	O
points	O
x	O
(	O
cid:2	O
)	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
(	O
or	O
the	O
same	O
image	O
)	O
,	O
each	O
image	O
being	O
considered	O
as	O
a	O
projective	B
plane	I
ip2	O
.	O
(	O
ii	O
)	O
3d	O
to	O
2d	O
camera	B
projection	O
.	O
given	O
a	O
set	O
of	B
points	I
xi	O
in	O
3d	O
space	O
,	O
and	O
a	O
set	O
of	O
corresponding	O
points	O
xi	O
in	O
an	O
image	O
,	O
ﬁnd	O
the	O
3d	O
to	O
2d	O
projective	B
mapping	O
that	O
maps	O
xi	O
to	O
xi	O
.	O
such	O
a	O
3d	O
to	O
2d	O
projection	B
is	O
the	O
mapping	O
carried	O
out	O
by	O
a	O
projective	B
camera	I
,	O
as	O
discussed	O
in	O
chapter	O
6	O
.	O
(	O
iii	O
)	O
fundamental	B
matrix	I
computation	O
.	O
given	O
a	O
set	O
of	B
points	I
xi	O
in	B
one	I
image	I
,	O
and	O
corresponding	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
in	O
another	O
image	O
,	O
compute	O
the	O
fundamental	B
matrix	I
f	O
consistent	O
with	O
these	O
correspondences	B
.	O
the	O
fundamental	B
matrix	I
,	O
discussed	O
in	O
chapter	O
9	O
,	O
is	O
a	O
singular	O
3	O
×	O
3	O
matrix	B
f	O
satisfying	O
x	O
(	O
cid:2	O
)	O
(	O
iv	O
)	O
trifocal	B
tensor	I
computation	O
.	O
given	O
a	O
set	O
of	O
point	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
across	O
three	O
images	O
,	O
compute	O
the	O
trifocal	B
tensor	I
.	O
the	O
trifocal	B
tensor	I
,	O
discussed	O
in	O
chapter	O
15	O
,	O
is	O
a	O
tensor	B
t	O
jk	O
relating	O
points	O
or	O
lines	B
in	O
three	O
views	O
.	O
tfxi	O
=	O
0	O
for	O
all	O
i.	O
i	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
i	O
these	O
problems	O
have	O
many	O
features	O
in	O
common	O
,	O
and	O
the	O
considerations	O
that	O
relate	O
to	O
one	O
of	O
the	O
problems	O
are	O
also	O
relevant	O
to	O
each	O
of	O
the	O
others	O
.	O
therefore	O
,	O
in	O
this	O
chapter	O
,	O
the	O
ﬁrst	O
of	O
these	O
problems	O
will	O
be	O
considered	O
in	O
detail	O
.	O
what	O
we	O
learn	O
about	O
ways	O
of	O
solving	O
this	O
problem	O
will	O
teach	O
us	O
how	O
to	O
proceed	O
in	O
solving	O
each	O
of	O
the	O
other	O
problems	O
as	O
well	O
.	O
apart	O
from	O
being	O
important	O
for	O
illustrative	O
purposes	O
,	O
the	O
problem	O
of	O
estimating	B
2d	O
projective	B
transformations	O
is	O
of	O
importance	O
in	O
its	O
own	O
right	O
.	O
we	O
consider	O
a	O
set	O
of	O
point	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
between	O
two	O
images	O
.	O
our	O
problem	O
is	O
to	O
compute	O
a	O
3	O
×	O
3	O
matrix	B
h	O
such	O
that	O
hxi	O
=	O
x	O
(	O
cid:2	O
)	O
i	O
for	O
each	O
i	O
.	O
87	O
88	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
number	O
of	O
measurements	O
required	O
.	O
the	O
ﬁrst	O
question	O
to	O
consider	O
is	O
how	O
many	O
corresponding	O
points	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
required	O
to	O
compute	O
the	O
projective	B
transformation	I
h.	O
a	O
lower	O
bound	O
is	O
available	O
by	O
a	O
consideration	O
of	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
and	O
number	O
of	O
constraints	O
.	O
on	O
the	O
one	O
hand	O
,	O
the	O
matrix	B
h	O
contains	O
9	O
entries	O
,	O
but	O
is	O
deﬁned	O
only	O
up	O
to	O
scale	O
.	O
thus	O
,	O
the	O
total	O
number	O
of	O
degrees	O
of	O
freedom	O
in	O
a	O
2d	O
projective	B
trans-	O
formation	O
is	O
8.	O
on	O
the	O
other	O
hand	O
,	O
each	O
point-to-point	O
correspondence	B
accounts	O
for	O
two	O
constraints	B
,	O
since	O
for	O
each	O
point	B
xi	O
in	O
the	O
ﬁrst	O
image	O
the	O
two	O
degrees	O
of	O
freedom	O
of	O
the	O
point	O
in	O
the	O
second	O
image	O
must	O
correspond	O
to	O
the	O
mapped	O
point	B
hxi	O
.	O
a	O
2d	O
point	B
has	O
two	O
degrees	O
of	O
freedom	O
corresponding	O
to	O
the	O
x	O
and	O
y	O
components	O
,	O
each	O
of	O
which	O
may	O
be	O
speciﬁed	O
separately	O
.	O
alternatively	O
,	O
the	O
point	B
is	O
speciﬁed	O
as	O
a	O
homogeneous	O
3-vector	O
,	O
which	O
also	O
has	O
two	O
degrees	O
of	O
freedom	O
since	O
scale	O
is	O
arbitrary	O
.	O
as	O
a	O
consequence	O
,	O
it	O
is	O
necessary	O
to	O
specify	O
four	O
point	O
correspondences	B
in	O
order	O
to	O
constrain	O
h	O
fully	O
.	O
approximate	O
solutions	O
.	O
it	O
will	O
be	O
seen	O
that	O
if	O
exactly	O
four	O
correspondences	O
are	O
given	O
,	O
then	O
an	O
exact	O
solution	B
for	O
the	O
matrix	B
h	O
is	O
possible	O
.	O
this	O
is	O
the	O
minimal	B
solution	I
.	O
such	O
solutions	O
are	O
important	O
as	O
they	O
deﬁne	O
the	O
size	O
of	O
the	O
subsets	O
required	O
in	O
robust	O
estima-	O
tion	O
algorithms	O
,	O
such	O
as	O
ransac	O
,	O
described	O
in	O
section	O
4.7.	O
however	O
,	O
since	O
points	O
are	O
measured	O
inexactly	O
(	O
“	O
noise	B
”	O
)	O
,	O
if	O
more	O
than	O
four	O
such	O
correspondences	B
are	O
given	O
,	O
then	O
these	O
correspondences	B
may	O
not	O
be	O
fully	O
compatible	O
with	O
any	O
projective	B
transformation	I
,	O
and	O
one	O
will	O
be	O
faced	O
with	O
the	O
task	O
of	O
determining	O
the	O
“	O
best	O
”	O
transformation	B
given	O
the	O
data	O
.	O
this	O
will	O
generally	O
be	O
done	O
by	O
ﬁnding	O
the	O
transformation	B
h	O
that	O
minimizes	O
some	O
cost	B
function	I
.	O
different	O
cost	B
functions	I
will	O
be	O
discussed	O
during	O
this	O
chapter	O
,	O
together	O
with	O
methods	O
for	O
minimizing	O
them	O
.	O
there	O
are	O
two	O
main	O
categories	O
of	O
cost	O
function	O
:	O
those	O
based	O
on	O
minimizing	O
an	O
algebraic	B
error	I
;	O
and	O
those	O
based	O
on	O
minimizing	O
a	O
geo-	O
metric	B
or	O
statistical	O
image	O
distance	O
.	O
these	O
two	O
categories	O
are	O
described	O
in	O
section	O
4.2.	O
the	O
gold	O
standard	O
algorithm	B
.	O
there	O
will	O
usually	O
be	O
one	O
cost	B
function	I
which	O
is	O
optimal	O
in	O
the	O
sense	O
that	O
the	O
h	O
that	O
minimizes	O
it	O
gives	O
the	O
best	O
possible	O
estimate	O
of	O
the	O
transformation	O
under	O
certain	O
assumptions	O
.	O
the	O
computational	O
algorithm	O
that	O
enables	O
this	O
cost	B
function	I
to	O
be	O
minimized	O
is	O
called	O
the	O
“	O
gold	O
standard	O
”	O
algorithm	B
.	O
the	O
results	O
of	O
other	O
algorithms	O
are	O
assessed	O
by	O
how	O
well	O
they	O
compare	O
to	O
this	O
gold	O
standard	O
.	O
in	O
the	O
case	O
of	O
estimating	O
a	O
homography	B
between	O
two	B
views	I
the	O
cost	B
function	I
is	O
(	O
4.8	O
)	O
,	O
the	O
assumptions	O
for	O
optimality	O
are	O
given	O
in	O
section	O
4.3	O
,	O
and	O
the	O
gold	O
standard	O
is	O
algorithm	B
4.3	O
(	O
p114	O
)	O
.	O
4.1	O
the	O
direct	O
linear	O
transformation	B
(	O
dlt	O
)	O
algorithm	B
i.	O
the	O
transformation	B
is	O
given	O
by	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
we	O
begin	O
with	O
a	O
simple	O
linear	O
algorithm	B
for	O
determining	B
h	O
given	O
a	O
set	O
of	O
four	O
2d	O
to	O
2d	O
point	B
correspondences	O
,	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
hxi	O
.	O
note	O
that	O
this	O
is	O
an	O
equation	O
involving	O
homogeneous	O
vectors	O
;	O
thus	O
the	O
3-vectors	O
x	O
(	O
cid:2	O
)	O
i	O
and	O
hxi	O
are	O
not	O
equal	O
,	O
they	O
have	O
the	O
same	O
direction	O
but	O
may	O
differ	O
in	O
magnitude	O
by	O
a	O
non-	O
zero	O
scale	O
factor	O
.	O
the	O
equation	O
may	O
be	O
expressed	O
in	O
terms	O
of	O
the	O
vector	O
cross	B
product	I
as	O
x	O
(	O
cid:2	O
)	O
×	O
hxi	O
=	O
0.	O
this	O
form	O
will	O
enable	O
a	O
simple	O
linear	O
solution	B
for	O
h	O
to	O
be	O
derived	O
.	O
i	O
4.1	O
the	O
direct	O
linear	O
transformation	B
(	O
dlt	O
)	O
algorithm	B
89	O
if	O
the	O
j-th	O
row	O
of	O
the	O
matrix	B
h	O
is	O
denoted	O
by	O
hj	O
t	O
,	O
then	O
we	O
may	O
write	O
writing	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
(	O
cid:2	O
)	O
i	O
,	O
w	O
(	O
cid:2	O
)	O
i	O
)	O
t	O
,	O
the	O
cross	B
product	I
may	O
then	O
be	O
given	O
explicitly	O
as	O
	O
h1txi	O
h2txi	O
h3txi	O
	O
.	O
hxi	O
=	O
	O
y	O
x	O
(	O
cid:2	O
)	O
i	O
×	O
hxi	O
=	O
h3txi	O
−	O
w	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
h2txi	O
h1txi	O
−	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
i	O
h3txi	O
w	O
h2txi	O
−	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
i	O
h1txi	O
x	O
i	O
i	O
	O
.	O
	O
	O
h1	O
	O
=	O
0	O
.	O
	O
	O
h1	O
h2	O
h3	O
h2	O
h3	O
h4	O
h5	O
h6	O
h7	O
h8	O
h9	O
hj	O
for	O
j	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
,	O
this	O
gives	O
a	O
set	O
of	O
three	O
equations	O
in	O
the	O
entries	O
since	O
hj	O
txi	O
=	O
xt	O
i	O
of	O
h	O
,	O
which	O
may	O
be	O
written	O
in	O
the	O
form	O
xt	O
i	O
	O
0t	O
(	O
cid:2	O
)	O
xt	O
w	O
−y	O
(	O
cid:2	O
)	O
i	O
i	O
xt	O
i	O
i	O
−w	O
(	O
cid:2	O
)	O
i	O
0t	O
(	O
cid:2	O
)	O
xt	O
x	O
i	O
i	O
(	O
cid:2	O
)	O
xt	O
y	O
−x	O
(	O
cid:2	O
)	O
i	O
i	O
xt	O
i	O
i	O
0t	O
these	O
equations	O
have	O
the	O
form	O
aih	O
=	O
0	O
,	O
where	O
ai	O
is	O
a	O
3	O
×	O
9	O
matrix	B
,	O
and	O
h	O
is	O
a	O
9-vector	O
made	O
up	O
of	O
the	O
entries	O
of	O
the	O
matrix	O
h	O
,	O
	O
,	O
	O
h1	O
h2	O
h3	O
h	O
=	O
h	O
=	O
with	O
hi	O
the	O
i−th	O
element	O
of	O
h.	O
three	O
remarks	O
regarding	O
these	O
equations	O
are	O
in	O
order	O
here	O
.	O
(	O
i	O
)	O
the	O
equation	O
aih	O
=	O
0	O
is	O
an	O
equation	O
linear	B
in	O
the	O
unknown	O
h.	O
the	O
matrix	B
elements	O
of	O
ai	O
are	O
quadratic	O
in	O
the	O
known	O
coordinates	O
of	O
the	O
points	O
.	O
(	O
ii	O
)	O
although	O
there	O
are	O
three	O
equations	O
in	O
(	O
4.1	O
)	O
,	O
only	O
two	O
of	O
them	O
are	O
linearly	O
inde-	O
(	O
cid:2	O
)	O
pendent	O
(	O
since	O
the	O
third	O
row	O
is	O
obtained	O
,	O
up	O
to	O
scale	O
,	O
from	O
the	O
sum	O
of	O
x	O
i	O
times	O
(	O
cid:2	O
)	O
the	O
ﬁrst	O
row	O
and	O
y	O
i	O
times	O
the	O
second	O
)	O
.	O
thus	O
each	O
point	B
correspondence	O
gives	O
two	O
equations	O
in	O
the	O
entries	O
of	O
h.	O
it	O
is	O
usual	O
to	O
omit	O
the	O
third	O
equation	O
in	O
solv-	O
ing	O
for	O
h	O
(	O
[	O
sutherland-63	O
]	O
)	O
.	O
then	O
(	O
for	O
future	O
reference	O
)	O
the	O
set	O
of	O
equations	O
becomes	O
(	O
cid:17	O
)	O
0t	O
−w	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
xt	O
0t	O
w	O
i	O
i	O
xt	O
i	O
(	O
cid:2	O
)	O
xt	O
y	O
−x	O
(	O
cid:2	O
)	O
i	O
i	O
xt	O
i	O
i	O
(	O
cid:18	O
)	O
	O
h1	O
h2	O
h3	O
	O
=	O
0.	O
this	O
will	O
be	O
written	O
aih	O
=	O
0	O
where	O
ai	O
is	O
now	O
the	O
2	O
×	O
9	O
matrix	B
of	O
(	O
4.3	O
)	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
)	O
t	O
i	O
,	O
y	O
of	O
the	O
point	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
)	O
are	O
the	O
coordinates	B
measured	O
in	O
the	O
image	O
.	O
other	O
choices	O
are	O
possible	O
,	O
however	O
,	O
as	O
will	O
be	O
seen	O
later	O
.	O
(	O
iii	O
)	O
the	O
equations	O
hold	O
for	O
any	O
homogeneous	O
coordinate	O
representation	B
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
(	O
cid:2	O
)	O
i	O
=	O
1	O
,	O
which	O
means	O
that	O
(	O
x	O
i.	O
one	O
may	O
choose	O
w	O
(	O
cid:2	O
)	O
i	O
,	O
w	O
(	O
4.1	O
)	O
(	O
4.2	O
)	O
(	O
4.3	O
)	O
90	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
solving	O
for	O
h	O
each	O
point	B
correspondence	O
gives	O
rise	O
to	O
two	O
independent	O
equations	O
in	O
the	O
entries	O
of	O
h.	O
given	O
a	O
set	O
of	O
four	O
such	O
point	B
correspondences	O
,	O
we	O
obtain	O
a	O
set	O
of	O
equations	O
ah	O
=	O
0	O
,	O
where	O
a	O
is	O
the	O
matrix	B
of	O
equation	O
coefﬁcients	O
built	O
from	O
the	O
matrix	B
rows	O
ai	O
contributed	O
from	O
each	O
correspondence	B
,	O
and	O
h	O
is	O
the	O
vector	O
of	O
unknown	O
entries	O
of	O
h.	O
we	O
seek	O
a	O
non-zero	O
solution	O
h	O
,	O
since	O
the	O
obvious	O
solution	B
h	O
=	O
0	O
is	O
of	O
no	O
interest	O
to	O
us	O
.	O
if	O
(	O
4.1	O
)	O
is	O
used	O
then	O
a	O
has	O
dimension	O
12	O
×	O
9	O
,	O
and	O
if	O
(	O
4.3	O
)	O
the	O
dimension	O
is	O
8	O
×	O
9.	O
in	O
either	O
case	O
a	O
has	O
rank	O
8	O
,	O
and	O
thus	O
has	O
a	O
1-dimensional	O
null-space	B
which	O
provides	O
a	O
solution	B
for	O
h.	O
such	O
a	O
solution	B
h	O
can	O
only	O
be	O
determined	O
up	O
to	O
a	O
non-zero	O
scale	O
factor	O
.	O
however	O
,	O
h	O
is	O
in	O
general	O
only	O
determined	O
up	O
to	O
scale	O
,	O
so	O
the	O
solution	B
h	O
gives	O
the	O
required	O
h.	O
a	O
scale	O
may	O
be	O
arbitrarily	O
chosen	O
for	O
h	O
by	O
a	O
requirement	O
on	O
its	O
norm	B
such	O
as	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1	O
.	O
4.1.1	O
over-determined	B
solution	I
if	O
more	O
than	O
four	O
point	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
given	O
,	O
then	O
the	O
set	O
of	O
equations	O
ah	O
=	O
0	O
derived	O
from	O
(	O
4.3	O
)	O
is	O
over-determined	B
.	O
if	O
the	O
position	O
of	O
the	O
points	O
is	O
exact	O
then	O
the	O
matrix	B
a	O
will	O
still	O
have	O
rank	O
8	O
,	O
a	O
one	O
dimensional	O
null-space	B
,	O
and	O
there	O
is	O
an	O
exact	O
solution	B
for	O
h.	O
this	O
will	O
not	O
be	O
the	O
case	O
if	O
the	O
measurement	O
of	O
image	O
coordinates	O
is	O
inexact	O
(	O
generally	O
termed	O
noise	B
)	O
–	O
there	O
will	O
not	O
be	O
an	O
exact	O
solution	B
to	O
the	O
over-	O
determined	O
system	O
ah	O
=	O
0	O
apart	O
from	O
the	O
zero	O
solution	O
.	O
instead	O
of	O
demanding	O
an	O
exact	O
solution	B
,	O
one	O
attempts	O
to	O
ﬁnd	O
an	O
approximate	B
solution	I
,	O
namely	O
a	O
vector	O
h	O
that	O
minimizes	O
a	O
suitable	O
cost	B
function	I
.	O
the	O
question	O
that	O
naturally	O
arises	O
then	O
is	O
:	O
what	O
should	O
be	O
minimized	O
?	O
clearly	O
,	O
to	O
avoid	O
the	O
solution	B
h	O
=	O
0	O
an	O
additional	O
constraint	O
is	O
required	O
.	O
generally	O
,	O
a	O
condition	O
on	O
the	O
norm	B
is	O
used	O
,	O
such	O
as	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1.	O
the	O
value	O
of	O
the	O
norm	O
is	O
unimportant	O
since	O
h	O
is	O
only	O
deﬁned	O
up	O
to	O
scale	O
.	O
given	O
that	O
there	O
is	O
no	O
exact	O
solution	B
to	O
ah	O
=	O
0	O
,	O
it	O
seems	O
natural	O
to	O
attempt	O
to	O
minimize	O
the	O
norm	B
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
instead	O
,	O
subject	O
to	O
the	O
usual	O
constraint	O
,	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1.	O
this	O
is	O
identical	O
to	O
the	O
problem	O
of	O
ﬁnding	O
the	O
minimum	O
of	O
the	O
quotient	O
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
/	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
.	O
as	O
shown	O
in	O
section	O
a5.3	O
(	O
p592	O
)	O
the	O
solution	B
is	O
the	O
(	O
unit	O
)	O
eigenvector	O
of	O
ata	O
with	O
least	O
eigenvalue	O
.	O
equivalently	O
,	O
the	O
solution	B
is	O
the	O
unit	O
singular	O
vector	O
corresponding	O
to	O
the	O
smallest	O
singular	O
value	O
of	O
a.	O
the	O
resulting	O
algorithm	B
,	O
known	O
as	O
the	O
basic	O
dlt	O
algorithm	B
,	O
is	O
summarized	O
in	O
algorithm	O
4.1	O
.	O
4.1.2	O
inhomogeneous	B
solution	I
an	O
alternative	O
to	O
solving	O
for	O
h	O
directly	O
as	O
a	O
homogeneous	O
vector	O
is	O
to	O
turn	O
the	O
set	O
of	O
equations	O
(	O
4.3	O
)	O
into	O
a	O
inhomogeneous	O
set	O
of	O
linear	O
equations	O
by	O
imposing	O
a	O
condition	O
hj	O
=	O
1	O
for	O
some	O
entry	O
of	O
the	O
vector	O
h.	O
imposing	O
the	O
condition	O
hj	O
=	O
1	O
is	O
justiﬁed	O
by	O
the	O
observation	O
that	O
the	O
solution	B
is	O
determined	O
only	O
up	O
to	O
scale	O
,	O
and	O
this	O
scale	O
can	O
be	O
chosen	O
such	O
that	O
hj	O
=	O
1.	O
for	O
example	O
,	O
if	O
the	O
last	O
element	O
of	O
h	O
,	O
which	O
corresponds	O
to	O
h33	O
,	O
is	O
chosen	O
as	O
unity	O
then	O
the	O
resulting	O
equations	O
derived	O
from	O
(	O
4.3	O
)	O
are	O
(	O
cid:17	O
)	O
0	O
xiw	O
0	O
(	O
cid:2	O
)	O
i	O
yiw	O
0	O
(	O
cid:2	O
)	O
i	O
wiw	O
(	O
cid:2	O
)	O
i	O
−xiw	O
(	O
cid:2	O
)	O
i	O
−yiw	O
(	O
cid:2	O
)	O
i	O
−wiw	O
0	O
0	O
0	O
(	O
cid:2	O
)	O
i	O
(	O
cid:2	O
)	O
xiy	O
−xix	O
i	O
(	O
cid:2	O
)	O
i	O
(	O
cid:2	O
)	O
yiy	O
−yix	O
i	O
(	O
cid:2	O
)	O
i	O
˜h	O
=	O
(	O
cid:18	O
)	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
−wiy	O
(	O
cid:2	O
)	O
i	O
(	O
cid:2	O
)	O
i	O
wix	O
where	O
˜h	O
is	O
an	O
8-vector	O
consisting	O
of	O
the	O
ﬁrst	O
8	O
components	O
of	O
h.	O
concatenating	O
the	O
equations	O
from	O
four	O
correspondences	B
then	O
generates	O
a	O
matrix	B
equation	O
of	O
the	O
form	O
4.1	O
the	O
direct	O
linear	O
transformation	B
(	O
dlt	O
)	O
algorithm	B
91	O
objective	O
given	O
n	O
≥	O
4	O
2d	O
to	O
2d	O
point	B
correspondences	O
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
matrix	B
h	O
such	O
that	O
x	O
(	O
cid:1	O
)	O
algorithm	B
i	O
=	O
hxi	O
.	O
i	O
}	O
,	O
determine	O
the	O
2d	O
homography	B
rows	O
need	O
be	O
used	O
in	O
general	O
.	O
i	O
compute	O
the	O
matrix	B
ai	O
from	O
(	O
4.1	O
)	O
.	O
only	O
the	O
ﬁrst	O
two	O
(	O
i	O
)	O
for	O
each	O
correspondence	B
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
ii	O
)	O
assemble	O
the	O
n	O
2	O
×	O
9	O
matrices	O
ai	O
into	O
a	O
single	O
2n	O
×	O
9	O
matrix	B
a	O
.	O
(	O
iii	O
)	O
obtain	O
the	O
svd	O
of	O
a	O
(	O
section	O
a4.4	O
(	O
p585	O
)	O
)	O
.	O
the	O
unit	O
singular	O
vector	O
corresponding	O
to	O
the	O
smallest	O
singular	O
value	O
is	O
the	O
solution	B
h.	O
speciﬁcally	O
,	O
if	O
a	O
=	O
udvt	O
with	O
d	O
diagonal	O
with	O
positive	O
diagonal	O
entries	O
,	O
arranged	O
in	O
descending	O
order	O
down	O
the	O
diagonal	O
,	O
then	O
h	O
is	O
the	O
last	O
column	O
of	O
v.	O
(	O
iv	O
)	O
the	O
matrix	B
h	O
is	O
determined	O
from	O
h	O
as	O
in	O
(	O
4.2	O
)	O
.	O
algorithm	B
4.1.	O
the	O
basic	O
dlt	O
for	O
h	O
(	O
but	O
see	O
algorithm	B
4.2	O
(	O
p109	O
)	O
which	O
includes	O
normalization	B
)	O
.	O
m˜h	O
=	O
b	O
,	O
where	O
m	O
has	O
8	O
columns	O
and	O
b	O
is	O
an	O
8-vector	O
.	O
such	O
an	O
equation	O
may	O
be	O
solved	O
for	O
˜h	O
using	O
standard	O
techniques	O
for	O
solving	O
linear	B
equations	I
(	O
such	O
as	O
gaussian	O
elimina-	O
tion	O
)	O
in	O
the	O
case	O
where	O
m	O
contains	O
just	O
8	O
rows	O
(	O
the	O
minimum	O
case	O
)	O
,	O
or	O
by	O
least-squares	O
techniques	O
(	O
section	O
a5.1	O
(	O
p588	O
)	O
)	O
in	O
the	O
case	O
of	O
an	O
over-determined	B
set	O
of	O
equations	O
.	O
however	O
,	O
if	O
in	O
fact	O
hj	O
=	O
0	O
is	O
the	O
true	O
solution	B
,	O
then	O
no	O
multiplicative	O
scale	O
k	O
can	O
exist	O
such	O
that	O
khj	O
=	O
1.	O
this	O
means	O
that	O
the	O
true	O
solution	B
can	O
not	O
be	O
reached	O
.	O
for	O
this	O
reason	O
,	O
this	O
method	O
can	O
be	O
expected	O
to	O
lead	O
to	O
unstable	O
results	O
in	O
the	O
case	O
where	O
the	O
chosen	O
hj	O
is	O
close	O
to	O
zero	O
.	O
consequently	O
,	O
this	O
method	O
is	O
not	O
recommended	O
in	O
general	O
.	O
example	O
4.1.	O
it	O
will	O
be	O
shown	O
that	O
h9	O
=	O
h33	O
is	O
zero	O
if	O
the	O
coordinate	O
origin	O
is	O
mapped	O
to	O
a	O
point	B
at	O
inﬁnity	O
by	O
h.	O
since	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
represents	O
the	O
coordinate	O
origin	O
x0	O
,	O
and	O
also	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
represents	O
the	O
line	B
at	I
inﬁnity	I
l	O
,	O
this	O
condition	O
may	O
be	O
written	O
as	O
lthx0	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
h	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
=	O
0	O
,	O
thus	O
h33	O
=	O
0.	O
in	O
a	O
perspective	O
image	O
of	O
a	O
scene	O
plane	O
the	O
line	B
at	I
inﬁnity	I
is	O
imaged	O
as	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
(	O
see	O
chapter	O
8	O
)	O
,	O
for	O
example	O
the	O
horizon	O
is	O
the	O
vanishing	O
line	O
of	O
the	O
ground	O
plane	B
.	O
it	O
is	O
not	O
uncommon	O
for	O
the	O
horizon	O
to	O
pass	O
through	O
the	O
image	O
centre	O
,	O
and	O
for	O
the	O
coordinate	O
origin	O
to	O
coincide	O
with	O
the	O
image	O
centre	O
.	O
in	O
this	O
case	O
the	O
mapping	O
that	O
takes	O
the	O
image	O
to	O
the	O
world	O
plane	B
maps	O
the	O
origin	O
to	O
the	O
line	B
at	I
inﬁnity	I
,	O
so	O
that	O
the	O
true	O
solution	B
has	O
h33	O
=	O
h9	O
=	O
0.	O
consequently	O
,	O
an	O
(	O
cid:2	O
)	O
h9	O
=	O
1	O
normalization	B
can	O
be	O
a	O
serious	O
failing	O
in	O
practical	O
situations	O
.	O
4.1.3	O
degenerate	B
conﬁgurations	I
consider	O
a	O
minimal	B
solution	I
in	O
which	O
a	O
homography	B
is	O
computed	O
using	O
four	O
point	O
cor-	O
respondences	O
,	O
and	O
suppose	O
that	O
three	O
of	O
the	O
points	O
x1	O
,	O
x2	O
,	O
x3	O
are	O
collinear	O
.	O
the	O
question	O
is	O
whether	O
this	O
is	O
signiﬁcant	O
.	O
if	O
the	O
corresponding	O
points	O
x	O
(	O
cid:2	O
)	O
3	O
are	O
also	O
collinear	O
then	O
one	O
might	O
suspect	O
that	O
the	O
homography	B
is	O
not	O
sufﬁciently	O
constrained	O
,	O
and	O
there	O
will	O
exist	O
a	O
family	O
of	O
homographies	O
mapping	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
i.	O
on	O
the	O
other	O
hand	O
,	O
if	O
the	O
corre-	O
sponding	O
points	O
x	O
(	O
cid:2	O
)	O
1	O
,	O
x	O
(	O
cid:2	O
)	O
3	O
are	O
not	O
collinear	O
then	O
clearly	O
there	O
can	O
be	O
no	O
transformation	O
h	O
taking	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
since	O
a	O
projective	B
transformation	I
must	O
preserve	O
collinearity	O
.	O
never-	O
1	O
,	O
x	O
(	O
cid:2	O
)	O
2	O
,	O
x	O
(	O
cid:2	O
)	O
2	O
,	O
x	O
(	O
cid:2	O
)	O
92	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
=	O
x	O
(	O
cid:2	O
)	O
4	O
is	O
that	O
h∗	O
the	O
equations	O
(	O
4.3	O
)	O
express	O
the	O
condition	O
that	O
x	O
(	O
cid:2	O
)	O
4.	O
therefore	O
the	O
condition	O
x	O
(	O
cid:2	O
)	O
corresponding	O
to	O
h∗	O
i	O
theless	O
the	O
set	O
of	O
eight	O
homogeneous	O
equations	O
derived	O
from	O
(	O
4.3	O
)	O
must	O
have	O
a	O
non-zero	O
solution	O
,	O
giving	O
rise	O
to	O
a	O
matrix	B
h.	O
how	O
is	O
this	O
apparent	B
contradiction	O
to	O
be	O
resolved	O
?	O
×	O
hxi	O
=	O
0	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
,	O
and	O
so	O
the	O
matrix	B
h	O
found	O
by	O
solving	B
the	O
system	O
of	O
8	O
equations	O
will	O
satisfy	O
this	O
condition	O
.	O
suppose	O
that	O
x1	O
,	O
.	O
.	O
.	O
,	O
x	O
3	O
are	O
collinear	O
and	O
let	O
l	O
be	O
the	O
line	B
that	O
they	O
lie	O
on	O
,	O
so	O
that	O
ltxi	O
=	O
lt	O
,	O
which	O
is	O
a	O
3×3	O
matrix	B
of	O
rank	O
1.	O
in	O
this	O
case	O
,	O
0	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
now	O
deﬁne	O
h∗	O
one	O
veriﬁes	O
that	O
h∗xi	O
=	O
x	O
(	O
cid:2	O
)	O
4	O
(	O
ltxi	O
)	O
=0	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
,	O
since	O
ltxi	O
=	O
0.	O
on	O
the	O
other	O
×	O
h∗xi	O
=	O
0	O
is	O
satisﬁed	O
for	O
hand	O
,	O
h∗x4	O
=	O
x	O
(	O
cid:2	O
)	O
4	O
(	O
ltx4	O
)	O
=	O
kx	O
(	O
cid:2	O
)	O
all	O
i.	O
note	O
that	O
the	O
vector	O
h∗	O
is	O
given	O
by	O
h∗t	O
=	O
(	O
x4lt	O
,	O
y4lt	O
,	O
w4lt	O
)	O
,	O
and	O
one	O
easily	O
veriﬁes	O
that	O
this	O
vector	O
satisﬁes	O
(	O
4.3	O
)	O
for	O
all	O
i.	O
the	O
problem	O
with	O
this	O
solution	B
for	O
h∗	O
is	O
a	O
rank	O
1	O
matrix	B
and	O
hence	O
does	O
not	O
represent	O
a	O
projective	B
transformation	I
.	O
as	O
a	O
consequence	O
the	O
points	O
h∗xi	O
=	O
0	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
are	O
not	O
well	O
deﬁned	O
.	O
lt	O
is	O
a	O
solution	B
to	O
(	O
4.1	O
)	O
.	O
there	O
are	O
two	O
cases	O
:	O
either	O
h∗	O
is	O
the	O
unique	O
solution	B
(	O
up	O
to	O
scale	O
)	O
or	O
there	O
is	O
a	O
further	O
solution	B
h.	O
in	O
the	O
ﬁrst	O
case	O
,	O
since	O
h∗	O
is	O
a	O
singular	O
matrix	O
,	O
there	O
exists	O
no	O
transformation	O
taking	O
each	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
3	O
are	O
not	O
.	O
in	O
the	O
second	O
case	O
,	O
where	O
a	O
further	O
solution	B
h	O
exists	O
,	O
then	O
any	O
matrix	B
of	O
the	O
form	O
α	O
h∗	O
+	O
β	O
h	O
is	O
a	O
solution	B
.	O
thus	O
a	O
2-dimensional	O
family	O
of	O
transformations	O
exist	O
,	O
and	O
it	O
follows	O
that	O
the	O
8	O
equations	O
derived	O
from	O
(	O
4.3	O
)	O
are	O
not	O
independent	O
.	O
i.	O
this	O
occurs	O
when	O
x1	O
,	O
.	O
.	O
.	O
,	O
x	O
3	O
are	O
collinear	O
but	O
x	O
(	O
cid:2	O
)	O
we	O
showed	O
that	O
if	O
x1	O
,	O
x2	O
,	O
x3	O
are	O
collinear	O
then	O
h∗	O
1	O
,	O
.	O
.	O
.	O
,	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
x	O
(	O
cid:2	O
)	O
4	O
a	O
situation	O
where	O
a	O
conﬁguration	O
does	O
not	O
determine	O
a	O
unique	O
solution	B
for	O
a	O
particu-	O
lar	O
class	O
of	O
transformation	O
is	O
termed	O
degenerate	B
.	O
note	O
that	O
the	O
deﬁnition	B
of	O
degeneracy	B
involves	O
both	O
the	O
conﬁguration	O
and	O
the	O
type	O
of	O
transformation	O
.	O
the	O
degeneracy	B
prob-	O
lem	O
is	O
not	O
limited	O
to	O
a	O
minimal	B
solution	I
,	O
however	O
.	O
if	O
additional	O
(	O
perfect	O
,	O
i.e	O
.	O
error-free	O
)	O
correspondences	B
are	O
supplied	O
which	O
are	O
also	O
collinear	O
(	O
lie	O
on	O
l	O
)	O
,	O
then	O
the	O
degeneracy	B
is	O
not	O
resolved	O
.	O
4.1.4	O
solutions	O
from	O
lines	O
and	O
other	O
entities	O
the	O
development	O
to	O
this	O
point	B
,	O
and	O
for	O
the	O
rest	O
of	O
the	O
chapter	O
,	O
is	O
exclusively	O
in	O
terms	O
of	O
computing	O
homographies	B
from	O
point	B
correspondences	O
.	O
however	O
,	O
an	O
identical	O
develop-	O
ment	O
can	O
be	O
given	O
for	O
computing	O
homographies	B
from	O
line	B
correspondences	I
.	O
starting	O
from	O
the	O
line	B
transformation	O
li	O
=	O
htl	O
(	O
cid:2	O
)	O
i	O
,	O
a	O
matrix	B
equation	O
of	O
the	O
form	O
ah	O
=	O
0	O
can	O
be	O
derived	O
,	O
with	O
a	O
minimal	B
solution	I
requiring	O
four	O
lines	O
in	O
general	O
position	O
.	O
similarly	O
,	O
a	O
homography	B
may	O
be	O
computed	O
from	O
conic	O
correspondences	B
and	O
so	O
forth	O
.	O
there	O
is	O
the	O
question	O
then	O
of	O
how	O
many	O
correspondences	B
are	O
required	O
to	O
compute	O
the	O
homography	B
(	O
or	O
any	O
other	O
relation	B
)	O
.	O
the	O
general	O
rule	O
is	O
that	O
the	O
number	O
of	O
constraints	O
must	O
equal	O
or	O
exceed	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
transformation	O
.	O
for	O
example	O
,	O
in	O
2d	O
each	O
corresponding	O
point	B
or	O
line	B
generates	O
two	O
constraints	O
on	O
h	O
,	O
in	O
3d	O
each	O
corresponding	O
point	B
or	O
plane	B
generates	O
three	O
constraints	B
.	O
thus	O
in	O
2d	O
the	O
correspondence	B
of	O
four	O
points	O
or	O
four	O
lines	O
is	O
sufﬁcient	O
to	O
compute	O
h	O
,	O
since	O
4	O
×	O
2	O
=	O
8	O
,	O
with	O
8	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
homography	O
.	O
in	O
3d	O
a	O
homography	B
has	O
15	O
degrees	B
of	I
freedom	I
,	O
and	O
ﬁve	O
points	O
or	O
ﬁve	O
planes	O
are	O
required	O
.	O
for	O
a	O
planar	O
afﬁne	B
transformation	I
(	O
6	O
dof	O
)	O
only	O
three	O
corresponding	O
points	O
or	O
lines	B
are	O
required	O
,	O
and	O
so	O
on	O
.	O
a	O
conic	B
provides	O
ﬁve	O
constraints	B
on	O
a	O
2d	O
homography	B
.	O
4.2	O
different	O
cost	B
functions	I
93	O
=	O
=	O
fig	O
.	O
4.1.	O
geometric	B
equivalence	O
of	O
point–line	O
conﬁgurations	O
.	O
a	O
conﬁguration	O
of	O
two	O
points	O
and	O
two	O
lines	O
is	O
equivalent	B
to	O
ﬁve	O
lines	B
with	O
four	O
concurrent	O
,	O
or	O
ﬁve	O
points	O
with	O
four	O
collinear	O
.	O
care	O
has	O
to	O
be	O
taken	O
when	O
computing	B
h	O
from	O
correspondences	O
of	O
mixed	O
type	O
.	O
for	O
example	O
,	O
a	O
2d	O
homography	B
can	O
not	O
be	O
determined	O
uniquely	O
from	O
the	O
correspondences	B
of	O
two	O
points	O
and	O
two	O
lines	O
,	O
but	O
can	O
from	O
three	O
points	O
and	O
one	O
line	B
or	O
one	O
point	O
and	O
three	O
lines	B
,	O
even	O
though	O
in	O
each	O
case	O
the	O
conﬁguration	O
has	O
8	O
degrees	B
of	I
freedom	I
.	O
the	O
case	O
of	O
three	O
lines	B
and	O
one	O
point	B
is	O
geometrically	O
equivalent	O
to	O
four	O
points	O
,	O
since	O
the	O
three	O
lines	B
deﬁne	O
a	O
triangle	O
and	O
the	O
vertices	O
of	O
the	O
triangle	O
uniquely	O
deﬁne	O
three	O
points	O
.	O
we	O
have	O
seen	O
that	O
the	O
correspondence	B
of	O
four	O
points	O
in	O
general	O
position	O
uniquely	O
determines	O
a	O
homography	B
,	O
which	O
means	O
that	O
the	O
correspondence	B
of	O
three	O
lines	B
and	O
one	O
point	B
also	O
uniquely	O
determines	O
a	O
homography	B
.	O
similarly	O
the	O
case	O
of	O
three	O
points	O
and	O
a	O
line	B
is	O
equivalent	B
to	O
four	O
lines	O
,	O
and	O
again	O
the	O
correspondence	B
of	O
four	O
lines	O
in	O
general	O
position	O
(	O
i.e	O
.	O
no	O
three	O
concurrent	B
)	O
uniquely	O
determines	O
a	O
homography	B
.	O
however	O
,	O
as	O
a	O
quick	O
sketch	O
shows	O
(	O
ﬁgure	O
4.1	O
)	O
,	O
the	O
case	O
of	O
two	O
points	O
and	O
two	O
lines	O
is	O
equivalent	B
to	O
ﬁve	O
lines	B
with	O
four	O
concurrent	O
,	O
or	O
ﬁve	O
points	O
with	O
four	O
collinear	O
.	O
as	O
shown	O
in	O
the	O
previous	O
section	O
,	O
this	O
conﬁguration	O
is	O
degenerate	B
and	O
a	O
one-parameter	O
family	O
of	O
homographies	O
map	O
the	O
two-point	O
and	O
two-line	O
conﬁguration	O
to	O
the	O
corresponding	O
conﬁguration	O
.	O
4.2	O
different	O
cost	B
functions	I
we	O
will	O
now	O
describe	O
a	O
number	O
of	O
cost	O
functions	O
which	O
may	O
be	O
minimized	O
in	O
order	O
to	O
determine	O
h	O
for	O
over-determined	O
solutions	O
.	O
methods	O
of	O
minimizing	O
these	O
functions	O
are	O
described	O
later	O
in	O
the	O
chapter	O
.	O
4.2.1	O
algebraic	B
distance	I
the	O
dlt	O
algorithm	B
minimizes	O
the	O
norm	B
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
.	O
the	O
vector	O
	O
=	O
ah	O
is	O
called	O
the	O
residual	B
vector	O
and	O
it	O
is	O
the	O
norm	B
of	O
this	O
error	B
vector	O
that	O
is	O
minimized	O
.	O
the	O
components	O
of	O
this	O
vector	O
arise	O
from	O
the	O
individual	O
correspondences	B
that	O
generate	O
each	O
row	O
of	O
the	O
matrix	B
a.	O
each	O
correspondence	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
contributes	O
a	O
partial	O
error	B
vector	O
i	O
from	O
(	O
4.1	O
)	O
or	O
(	O
4.3	O
)	O
towards	O
the	O
full	O
error	O
vector	O
	O
.	O
this	O
vector	O
i	O
is	O
the	O
algebraic	B
error	I
vector	O
associated	O
with	O
the	O
point	B
correspondence	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
and	O
the	O
homography	B
h.	O
the	O
norm	B
of	O
this	O
vector	O
is	O
a	O
scalar	O
which	O
is	O
called	O
the	O
algebraic	B
distance	I
:	O
dalg	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
hxi	O
)	O
2	O
=	O
(	O
cid:10	O
)	O
i	O
(	O
cid:10	O
)	O
2	O
=	O
0t	O
−w	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
xt	O
0t	O
w	O
i	O
i	O
xt	O
i	O
(	O
cid:2	O
)	O
xt	O
y	O
−x	O
(	O
cid:2	O
)	O
i	O
i	O
xt	O
i	O
i	O
(	O
cid:17	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:18	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
h	O
.	O
(	O
4.4	O
)	O
more	O
generally	O
,	O
and	O
brieﬂy	O
,	O
for	O
any	O
two	O
vectors	O
x1	O
and	O
x2	O
we	O
may	O
write	O
2	O
where	O
a	O
=	O
(	O
a1	O
,	O
a2	O
,	O
a3	O
)	O
t	O
=	O
x1	O
×	O
x2	O
.	O
dalg	O
(	O
x1	O
,	O
x2	O
)	O
2	O
=	O
a2	O
1	O
+	O
a2	O
94	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
the	O
relation	B
of	O
this	O
distance	B
to	O
a	O
geometric	B
distance	I
is	O
described	O
in	O
section	O
4.2.4.	O
given	O
a	O
set	O
of	O
correspondences	O
,	O
the	O
quantity	O
	O
=	O
ah	O
is	O
the	O
algebraic	B
error	I
vector	O
for	O
the	O
complete	O
set	O
,	O
and	O
one	O
sees	O
that	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
dalg	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
hxi	O
)	O
2	O
=	O
(	O
cid:10	O
)	O
i	O
(	O
cid:10	O
)	O
2	O
=	O
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
2	O
=	O
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
2	O
.	O
(	O
4.5	O
)	O
i	O
i	O
the	O
concept	O
of	O
algebraic	O
distance	B
originated	O
in	O
the	O
conic-ﬁtting	O
work	O
of	O
book-	O
stein	O
[	O
bookstein-79	O
]	O
.	O
its	O
disadvantage	O
is	O
that	O
the	O
quantity	O
that	O
is	O
minimized	O
is	O
not	O
geometrically	O
or	O
statistically	O
meaningful	O
.	O
as	O
bookstein	O
demonstrated	O
,	O
the	O
solutions	O
that	O
minimize	O
algebraic	B
distance	I
may	O
not	O
be	O
those	O
expected	O
intuitively	O
.	O
nevertheless	O
,	O
with	O
a	O
good	O
choice	B
of	O
normalization	B
(	O
as	O
will	O
be	O
discussed	O
in	O
section	O
4.4	O
)	O
methods	O
which	O
minimize	O
algebraic	B
distance	I
do	O
give	O
very	O
good	O
results	O
.	O
their	O
particular	O
advantages	O
are	O
a	O
linear	B
(	O
and	O
thus	O
a	O
unique	O
)	O
solution	B
,	O
and	O
computational	O
cheapness	O
.	O
often	O
solutions	O
based	O
on	O
algebraic	O
distance	B
are	O
used	O
as	O
a	O
starting	O
point	B
for	O
a	O
non-linear	B
minimization	O
of	O
a	O
geometric	O
or	O
statistical	O
cost	B
function	I
.	O
the	O
non-linear	B
minimization	O
gives	O
the	O
solu-	O
tion	O
a	O
ﬁnal	O
“	O
polish	O
”	O
.	O
4.2.2	O
geometric	B
distance	I
next	O
we	O
discuss	O
alternative	O
error	B
functions	O
based	O
on	O
the	O
measurement	O
of	O
geometric	B
distance	I
in	O
the	O
image	O
,	O
and	O
minimization	B
of	O
the	O
difference	O
between	O
the	O
measured	O
and	O
estimated	O
image	O
coordinates	O
.	O
notation	O
.	O
vectors	O
x	O
represent	O
the	O
measured	O
image	O
coordinates	O
;	O
ˆx	O
represent	O
estimated	O
values	O
of	O
the	O
points	O
and	O
¯x	O
represent	O
true	O
values	O
of	O
the	O
points	O
.	O
error	B
in	I
one	I
image	I
.	O
we	O
start	O
by	O
considering	O
error	B
only	O
in	O
the	O
second	O
image	O
,	O
with	O
points	O
in	O
the	O
ﬁrst	O
measured	O
perfectly	O
.	O
clearly	O
,	O
this	O
will	O
not	O
be	O
true	O
in	O
most	O
practical	O
situations	O
with	O
images	O
.	O
an	O
example	O
where	O
the	O
assumption	O
is	O
more	O
reasonable	O
is	O
in	O
estimating	O
the	O
projective	B
transformation	I
between	O
a	O
calibration	B
pattern	O
or	O
a	O
world	O
plane	B
,	O
where	O
points	O
are	O
measured	O
to	O
a	O
very	O
high	O
accuracy	O
,	O
and	O
its	O
image	O
.	O
the	O
appropriate	O
quantity	O
to	O
be	O
minimized	O
is	O
the	O
transfer	B
error	O
.	O
this	O
is	O
the	O
euclidean	O
image	O
distance	B
in	O
the	O
second	O
image	O
between	O
the	O
measured	O
point	B
x	O
(	O
cid:2	O
)	O
and	O
the	O
point	B
h¯x	O
at	O
which	O
the	O
corresponding	O
point	B
¯x	O
is	O
mapped	O
from	O
the	O
ﬁrst	O
image	O
.	O
we	O
use	O
the	O
notation	O
d	O
(	O
x	O
,	O
y	O
)	O
to	O
represent	O
the	O
euclidean	O
distance	O
between	O
the	O
inhomogeneous	O
points	O
represented	O
by	O
x	O
and	O
y.	O
then	O
the	O
transfer	B
error	O
for	O
the	O
set	O
of	O
correspondences	O
is	O
(	O
cid:7	O
)	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
h¯xi	O
)	O
2	O
.	O
(	O
4.6	O
)	O
the	O
estimated	O
homography	B
ˆh	O
is	O
the	O
one	O
for	O
which	O
the	O
error	B
(	O
4.6	O
)	O
is	O
minimized	O
.	O
i	O
symmetric	B
transfer	I
error	I
.	O
in	O
the	O
more	O
realistic	O
case	O
where	O
image	O
measurement	O
errors	O
occur	O
in	O
both	O
the	O
images	O
,	O
it	O
is	O
preferable	O
that	O
errors	O
be	O
minimized	O
in	B
both	I
images	I
,	O
and	O
not	O
solely	O
in	O
the	O
one	O
.	O
one	O
way	O
of	O
constructing	O
a	O
more	O
satisfactory	O
error	B
function	O
is	O
to	O
95	O
consider	O
the	O
forward	O
(	O
h	O
)	O
and	O
backward	O
(	O
h−1	O
)	O
transformation	B
,	O
and	O
sum	O
the	O
geometric	B
errors	O
corresponding	O
to	O
each	O
of	O
these	O
two	O
transformations	O
.	O
thus	O
,	O
the	O
error	B
is	O
4.2	O
different	O
cost	B
functions	I
(	O
cid:7	O
)	O
d	O
(	O
xi	O
,	O
h−1x	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
hxi	O
)	O
2	O
.	O
(	O
4.7	O
)	O
i	O
the	O
ﬁrst	O
term	O
in	O
this	O
sum	O
is	O
the	O
transfer	B
error	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
the	O
second	O
term	O
is	O
the	O
transfer	B
error	O
in	O
the	O
second	O
image	O
.	O
again	O
the	O
estimated	O
homography	B
ˆh	O
is	O
the	O
one	O
for	O
which	O
(	O
4.7	O
)	O
is	O
minimized	O
.	O
4.2.3	O
reprojection	B
error	I
–	O
both	B
images	I
an	O
alternative	O
method	O
of	O
quantifying	O
error	O
in	O
each	O
of	O
the	O
two	O
images	O
involves	O
esti-	O
mating	O
a	O
“	O
correction	B
”	O
for	O
each	O
correspondence	B
.	O
one	O
asks	O
how	O
much	O
it	O
is	O
necessary	O
to	O
correct	O
the	O
measurements	O
in	O
each	O
of	O
the	O
two	O
images	O
in	O
order	O
to	O
obtain	O
a	O
perfectly	O
matched	O
set	O
of	O
image	O
points	O
.	O
one	O
should	O
compare	O
this	O
with	O
the	O
geometric	B
one-image	O
transfer	B
error	O
(	O
4.6	O
)	O
which	O
measures	O
the	O
correction	B
that	O
it	O
is	O
necessary	O
to	O
make	O
to	O
the	O
measurements	O
in	B
one	I
image	I
(	O
the	O
second	O
image	O
)	O
in	O
order	O
to	O
get	O
a	O
set	O
of	O
perfectly	O
match-	O
ing	O
points	O
.	O
in	O
the	O
present	O
case	O
,	O
we	O
are	O
seeking	O
a	O
homography	B
ˆh	O
and	O
pairs	O
of	O
perfectly	O
matched	O
points	O
ˆxi	O
and	O
ˆx	O
(	O
cid:2	O
)	O
i	O
that	O
minimize	O
the	O
total	O
error	O
function	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
subject	O
to	O
ˆx	O
(	O
cid:2	O
)	O
i	O
=	O
ˆhˆxi	O
∀i	O
.	O
(	O
4.8	O
)	O
(	O
cid:7	O
)	O
i	O
i	O
minimizing	B
this	O
cost	B
function	I
involves	O
determining	B
both	O
ˆh	O
and	O
a	O
set	O
of	O
subsidiary	O
cor-	O
respondences	O
{	O
ˆxi	O
}	O
and	O
{	O
ˆx	O
(	O
cid:2	O
)	O
}	O
.	O
this	O
estimation	B
models	O
,	O
for	O
example	O
,	O
the	O
situation	O
that	O
wish	O
to	O
estimate	O
a	O
point	B
on	O
the	O
world	O
plane	B
(	O
cid:23	O
)	O
xi	O
from	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
measured	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
arise	O
from	O
images	O
of	B
points	I
on	O
a	O
world	O
plane	B
.	O
we	O
i	O
which	O
is	O
then	O
reprojected	O
to	O
the	O
estimated	O
perfectly	O
matched	O
correspondence	B
ˆxi	O
↔	O
ˆx	O
(	O
cid:2	O
)	O
i.	O
this	O
reprojection	B
error	I
function	O
is	O
compared	O
with	O
the	O
symmetric	B
error	O
function	O
in	O
ﬁgure	O
4.2.	O
it	O
will	O
be	O
seen	O
in	O
section	O
4.3	O
that	O
(	O
4.8	O
)	O
is	O
related	O
to	O
the	O
maximum	O
likeli-	O
hood	O
estimation	B
of	I
the	O
homography	B
and	O
correspondences	B
.	O
4.2.4	O
comparison	O
of	O
geometric	B
and	O
algebraic	B
distance	I
we	O
return	O
to	O
the	O
case	O
of	O
errors	O
only	O
in	O
the	O
second	O
image	O
.	O
let	O
x	O
(	O
cid:2	O
)	O
deﬁne	O
a	O
vector	O
(	O
ˆx	O
becomes	O
(	O
cid:2	O
)	O
i	O
)	O
t	O
and	O
i	O
=	O
h¯xi	O
.	O
using	O
this	O
notation	O
,	O
the	O
left	O
hand	O
side	O
of	O
(	O
4.3	O
)	O
i	O
)	O
t	O
=	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
ˆy	O
i	O
,	O
ˆw	O
i	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
w	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
(	O
cid:20	O
)	O
aih	O
=	O
i	O
=	O
(	O
cid:2	O
)	O
i	O
ˆw	O
y	O
(	O
cid:2	O
)	O
w	O
iˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
i	O
−	O
w	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
ˆy	O
−	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
i	O
ˆw	O
i	O
(	O
cid:21	O
)	O
.	O
this	O
vector	O
is	O
the	O
algebraic	B
error	I
vector	O
associated	O
with	O
the	O
point	B
correspondence	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
and	O
the	O
camera	B
mapping	O
h.	O
thus	O
,	O
i	O
)	O
2	O
=	O
(	O
y	O
dalg	O
(	O
x	O
(	O
cid:2	O
)	O
−	O
w	O
−	O
x	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
.	O
(	O
cid:2	O
)	O
i	O
ˆw	O
(	O
cid:2	O
)	O
iˆx	O
(	O
cid:2	O
)	O
i	O
for	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
and	O
ˆx	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
+	O
(	O
w	O
i	O
ˆy	O
i	O
the	O
geometric	B
distance	I
is	O
(	O
cid:2	O
)	O
i	O
ˆw	O
(	O
cid:2	O
)	O
i	O
(	O
cid:15	O
)	O
i	O
)	O
=	O
(	O
cid:2	O
)	O
i/w	O
(	O
cid:2	O
)	O
i	O
(	O
x	O
−	O
ˆx	O
(	O
cid:2	O
)	O
i/	O
ˆw	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
+	O
(	O
y	O
(	O
cid:2	O
)	O
i/w	O
(	O
cid:2	O
)	O
i	O
−	O
ˆy	O
(	O
cid:2	O
)	O
i/	O
ˆw	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
1/2	O
(	O
cid:16	O
)	O
96	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
x	O
d	O
x	O
x	O
d	O
image	O
1	O
image	O
1	O
h	O
h	O
-1	O
h	O
h	O
-1	O
d/	O
x	O
/	O
x	O
/	O
/d	O
/x	O
image	O
2	O
image	O
2	O
fig	O
.	O
4.2.	O
a	O
comparison	O
between	O
symmetric	B
transfer	I
error	I
(	O
upper	O
)	O
and	O
reprojection	B
error	I
(	O
lower	O
)	O
when	O
estimating	B
a	O
homography	B
.	O
the	O
points	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
are	O
the	O
measured	O
(	O
noisy	O
)	O
points	O
.	O
under	O
the	O
estimated	O
homography	B
the	O
points	O
x	O
(	O
cid:1	O
)	O
and	O
hx	O
do	O
not	O
correspond	O
perfectly	O
(	O
and	O
neither	O
do	O
the	O
points	O
x	O
and	O
h−1x	O
(	O
cid:1	O
)	O
)	O
.	O
however	O
,	O
the	O
estimated	O
points	O
,	O
ˆx	O
and	O
ˆx	O
(	O
cid:1	O
)	O
=	O
hˆx	O
.	O
using	O
the	O
notation	O
d	O
(	O
x	O
,	O
y	O
)	O
for	O
the	O
euclidean	O
image	O
distance	B
between	O
x	O
and	O
y	O
,	O
the	O
symmetric	B
transfer	I
error	I
is	O
d	O
(	O
x	O
,	O
h−1x	O
(	O
cid:1	O
)	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
,	O
do	O
correspond	O
perfectly	O
by	O
the	O
homography	B
ˆx	O
(	O
cid:1	O
)	O
,	O
hx	O
)	O
2	O
;	O
the	O
reprojection	B
error	I
is	O
d	O
(	O
x	O
,	O
ˆx	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
,	O
ˆx	O
(	O
cid:1	O
)	O
)	O
2	O
.	O
=	O
dalg	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
/	O
ˆw	O
(	O
cid:2	O
)	O
iw	O
(	O
cid:2	O
)	O
i	O
.	O
(	O
cid:2	O
)	O
i	O
=	O
w	O
thus	O
,	O
geometric	B
distance	I
is	O
related	O
to	O
,	O
but	O
not	O
quite	O
the	O
same	O
as	O
,	O
algebraic	B
distance	I
.	O
note	O
,	O
though	O
,	O
that	O
if	O
ˆw	O
(	O
cid:2	O
)	O
i	O
=	O
1	O
,	O
then	O
the	O
two	O
distances	O
are	O
identical	O
.	O
one	O
can	O
always	O
assume	O
that	O
wi	O
=	O
1	O
,	O
thus	O
expressing	O
the	O
points	O
xi	O
in	O
the	O
usual	O
form	O
(	O
cid:2	O
)	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
t.	O
for	O
one	O
important	O
class	O
of	O
2d	O
homographies	B
,	O
the	O
values	O
of	O
ˆw	O
i	O
will	O
always	O
be	O
1	O
as	O
well	O
.	O
a	O
2d	O
afﬁne	B
transformation	I
is	O
represented	O
by	O
a	O
matrix	B
of	O
the	O
form	O
(	O
2.10–p39	O
)	O
	O
h11	O
h12	O
h13	O
h21	O
h22	O
h23	O
1	O
0	O
0	O
	O
.	O
ha	O
=	O
(	O
4.9	O
)	O
i	O
=	O
ha¯xi	O
that	O
ˆw	O
one	O
veriﬁes	O
immediately	O
from	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
=	O
1	O
if	O
wi	O
=	O
1.	O
this	O
demonstrates	O
that	O
in	O
the	O
case	O
of	O
an	O
afﬁne	B
transformation	I
geometric	O
distance	B
and	O
algebraic	B
distance	I
are	O
identical	O
.	O
the	O
dlt	O
algorithm	B
is	O
easily	O
adapted	O
to	O
enforce	O
the	O
condition	O
that	O
the	O
last	O
row	O
of	O
h	O
has	O
the	O
form	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
by	O
setting	O
h7	O
=	O
h8	O
=	O
0.	O
hence	O
,	O
for	O
afﬁne	O
transformations	O
,	O
geometric	B
distance	I
can	O
be	O
minimized	O
by	O
the	O
linear	B
dlt	O
algorithm	B
based	O
on	O
algebraic	O
distance	B
.	O
4.2.5	O
geometric	B
interpretation	I
of	O
reprojection	B
error	I
the	O
estimation	B
of	I
a	O
homography	B
between	O
two	O
planes	O
can	O
be	O
thought	O
of	O
as	O
ﬁtting	O
a	O
“	O
sur-	O
face	O
”	O
to	O
points	O
in	O
a	O
4d	O
space	O
,	O
ir4	O
.	O
each	O
pair	O
of	O
image	O
points	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
deﬁnes	O
a	O
single	O
point	O
denoted	O
x	O
in	O
a	O
measurement	O
space	O
ir4	O
,	O
formed	O
by	O
concatenating	O
the	O
inhomogeneous	O
coordinates	O
of	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
.	O
for	O
a	O
given	O
speciﬁc	O
homography	B
h	O
,	O
the	O
image	O
correspondences	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
that	O
satisfy	O
x	O
(	O
cid:2	O
)	O
×	O
(	O
hx	O
)	O
=	O
0	O
deﬁne	O
an	O
algebraic	B
variety1	O
vh	O
in	O
ir4	O
which	O
is	O
the	O
1	O
a	O
variety	O
is	O
the	O
simultaneous	O
zero-set	O
of	O
one	O
or	O
more	O
multivariate	O
polynomials	O
deﬁned	O
in	O
irn	O
.	O
4.2	O
different	O
cost	B
functions	I
97	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
intersection	B
of	O
two	O
quadric	O
hypersurfaces	O
.	O
the	O
surface	O
is	O
a	O
quadric	O
in	O
ir4	O
because	O
each	O
.	O
the	O
elements	O
of	O
h	O
determine	O
the	O
row	O
of	O
(	O
4.1	O
)	O
is	O
a	O
degree	O
2	O
polynomial	O
in	O
x	O
,	O
y	O
,	O
x	O
coefﬁcient	O
of	O
each	O
term	O
of	O
the	O
polynomial	O
,	O
and	O
so	O
h	O
speciﬁes	O
the	O
particular	O
quadric	O
.	O
the	O
two	O
independent	O
equations	O
of	O
(	O
4.1	O
)	O
deﬁne	O
two	O
such	O
quadrics	B
.	O
(	O
cid:2	O
)	O
i	O
)	O
t	O
in	O
ir4	O
,	O
the	O
task	O
of	O
estimating	O
a	O
homography	B
be-	O
given	O
points	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
x	O
comes	O
the	O
task	O
of	O
ﬁnding	O
a	O
variety	O
vh	O
that	O
passes	O
(	O
or	O
most	O
nearly	O
passes	O
)	O
through	O
the	O
points	O
xi	O
.	O
in	O
general	O
,	O
of	O
course	O
,	O
it	O
will	O
not	O
be	O
possible	O
to	O
ﬁt	O
a	O
variety	O
precisely	O
.	O
in	O
this	O
xi	O
,	O
let	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
ˆxi	O
,	O
ˆyi	O
,	O
ˆx	O
case	O
,	O
let	O
vh	O
be	O
some	O
variety	O
corresponding	O
to	O
a	O
transformation	B
h	O
,	O
and	O
for	O
each	O
point	B
i	O
)	O
t	O
be	O
the	O
closest	O
point	B
to	O
xi	O
lying	O
on	O
the	O
variety	O
vh	O
.	O
one	O
sees	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
ˆy	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
immediately	O
that	O
(	O
cid:10	O
)	O
xi	O
−	O
(	O
cid:23	O
)	O
xi	O
(	O
cid:10	O
)	O
2	O
=	O
(	O
xi	O
−	O
ˆxi	O
)	O
2	O
+	O
(	O
yi	O
−	O
ˆyi	O
)	O
2	O
+	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
−	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
+	O
(	O
y	O
i	O
−	O
ˆy	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
=	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2.	O
thus	O
geometric	B
distance	I
in	O
ir4	O
is	O
equivalent	B
to	O
the	O
reprojection	B
error	I
measured	O
in	O
both	O
the	O
images	O
,	O
and	O
ﬁnding	O
the	O
variety	O
vh	O
and	O
points	O
(	O
cid:23	O
)	O
xi	O
on	O
vh	O
that	O
minimize	O
the	O
squared	O
sum	O
of	O
distances	O
to	O
the	O
measured	O
points	O
xi	O
is	O
equivalent	B
to	O
ﬁnding	O
the	O
homography	B
ˆh	O
the	O
point	B
(	O
cid:23	O
)	O
x	O
on	O
vh	O
that	O
lies	O
closest	O
to	O
a	O
measured	O
point	B
x	O
is	O
a	O
point	B
where	O
the	O
line	B
and	O
the	O
estimated	O
points	O
ˆxi	O
and	O
ˆx	O
(	O
cid:2	O
)	O
i	O
that	O
minimize	O
the	O
reprojection	B
error	I
function	O
(	O
4.8	O
)	O
.	O
between	O
x	O
and	O
(	O
cid:23	O
)	O
x	O
is	O
perpendicular	O
to	O
the	O
tangent	O
plane	O
to	O
vh	O
at	O
(	O
cid:23	O
)	O
x.	O
thus	O
where	O
d⊥	O
(	O
x	O
,	O
vh	O
)	O
is	O
the	O
perpendicular	O
distance	B
of	O
the	O
point	B
x	O
to	O
the	O
variety	O
vh	O
.	O
as	O
may	O
be	O
seen	O
from	O
the	O
conic-ﬁtting	O
analogue	O
discussed	O
below	O
,	O
there	O
may	O
be	O
more	O
than	O
one	O
such	O
perpendicular	O
from	O
x	O
to	O
vh	O
.	O
the	O
distance	B
d⊥	O
(	O
x	O
,	O
vh	O
)	O
is	O
invariant	O
to	O
rigid	O
transformations	B
of	I
ir4	O
,	O
and	O
this	O
includes	O
as	O
a	O
special	O
case	O
rigid	O
transformations	B
of	I
the	O
coordinates	B
(	O
x	O
,	O
y	O
)	O
,	O
(	O
x	O
)	O
of	O
each	O
image	O
individually	O
.	O
this	O
point	B
is	O
returned	O
to	O
in	O
section	O
4.4.3.	O
i	O
)	O
2	O
=	O
d⊥	O
(	O
xi	O
,	O
vh	O
)	O
2	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
conic	B
analogue	I
.	O
before	O
proceeding	O
further	O
we	O
will	O
ﬁrst	O
sketch	O
an	O
analogous	O
estima-	O
tion	O
problem	O
that	O
can	O
be	O
visualized	O
more	O
easily	O
.	O
the	O
problem	O
is	O
ﬁtting	O
a	O
conic	B
to	O
2d	O
points	O
,	O
which	O
occupies	O
a	O
useful	O
intermediate	O
position	O
between	O
ﬁtting	O
a	O
straight	O
line	B
(	O
no	O
curvature	O
,	O
too	O
simple	O
)	O
and	O
ﬁtting	O
a	O
homography	B
(	O
four	O
dimensions	O
,	O
with	O
non-zero	O
curvature	O
)	O
.	O
consider	O
the	O
problem	O
of	O
ﬁtting	O
a	O
conic	B
to	O
a	O
set	O
of	O
n	O
>	O
5	O
points	O
(	O
xi	O
,	O
yi	O
)	O
t	O
on	O
the	O
plane	B
such	O
that	O
an	O
error	B
based	O
on	O
geometric	O
distance	B
is	O
minimized	O
.	O
the	O
points	O
may	O
be	O
thought	O
of	O
as	O
“	O
correspondences	B
”	O
xi	O
↔	O
yi	O
.	O
the	O
transfer	B
distance	O
and	O
reprojection	B
(	O
perpendicular	O
)	O
distance	B
are	O
illustrated	O
in	O
ﬁgure	O
4.3.	O
it	O
is	O
clear	O
from	O
this	O
ﬁgure	O
that	O
d⊥	O
is	O
less	O
than	O
or	O
equal	O
to	O
the	O
transfer	B
error	O
.	O
the	O
algebraic	B
distance	I
of	O
a	O
point	B
x	O
from	O
a	O
conic	B
c	O
is	O
deﬁned	O
as	O
dalg	O
(	O
x	O
,	O
c	O
)	O
2	O
=	O
xtcx	O
.	O
i	O
dalg	O
(	O
xi	O
,	O
c	O
)	O
2	O
with	O
a	O
suitable	O
a	O
linear	B
solution	I
for	O
c	O
can	O
be	O
obtained	O
by	O
minimizing	B
normalization	O
on	O
c.	O
there	O
is	O
no	O
linear	O
expression	O
for	O
the	O
perpendicular	O
distance	B
of	O
a	O
point	B
(	O
x	O
,	O
y	O
)	O
to	O
a	O
conic	B
c	O
,	O
since	O
through	O
each	O
point	B
in	O
ir2	O
there	O
are	O
up	O
to	O
4	O
lines	B
perpendicular	O
to	O
c.	O
the	O
solution	B
can	O
be	O
obtained	O
from	O
the	O
roots	O
of	O
a	O
quartic	O
.	O
however	O
,	O
a	O
function	O
d⊥	O
(	O
x	O
,	O
c	O
)	O
may	O
be	O
deﬁned	O
which	O
returns	O
the	O
shortest	O
distance	B
between	O
a	O
conic	B
(	O
cid:27	O
)	O
98	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
y	O
d	O
x	O
d	O
a	O
a	O
d	O
y	O
c	O
b	O
d	O
dy	O
b	O
x	O
fig	O
.	O
4.3.	O
a	O
conic	B
may	O
be	O
estimated	O
from	O
a	O
set	O
of	O
2d	O
points	O
by	O
minimizing	B
“	O
symmetric	B
transfer	I
error	I
”	O
d2	O
y	O
or	O
the	O
sum	O
of	O
squared	O
perpendicular	O
distances	O
d2⊥	O
.	O
the	O
analogue	O
of	O
transfer	O
error	B
is	O
to	O
consider	O
x	O
+	O
d2	O
x	O
as	O
perfect	O
and	O
measure	O
the	O
distance	B
dy	O
to	O
the	O
conic	B
in	O
the	O
y	O
direction	O
,	O
and	O
similarly	O
for	O
dx	O
.	O
for	O
point	O
a	O
it	O
is	O
clear	O
that	O
d⊥	O
≤	O
dx	O
and	O
d⊥	O
≤	O
dy	O
.	O
also	O
d⊥	O
is	O
more	O
stable	O
than	O
dx	O
or	O
dy	O
as	O
illustrated	O
by	O
point	B
b	O
where	O
dx	O
can	O
not	O
be	O
deﬁned	O
.	O
i	O
d⊥	O
(	O
xi	O
,	O
c	O
)	O
2	O
over	O
the	O
ﬁve	O
and	O
a	O
point	B
.	O
a	O
conic	B
can	O
then	O
be	O
estimated	O
by	O
minimizing	B
parameters	O
of	O
c	O
,	O
though	O
this	O
can	O
not	O
be	O
achieved	O
by	O
a	O
linear	B
solution	I
.	O
given	O
a	O
conic	B
c	O
and	O
a	O
measured	O
point	B
x	O
,	O
a	O
corrected	O
point	B
ˆx	O
is	O
obtained	O
simply	O
by	O
choosing	O
the	O
closest	O
point	B
on	O
c.	O
(	O
cid:27	O
)	O
we	O
return	O
now	O
to	O
estimating	O
a	O
homography	B
.	O
in	O
the	O
case	O
of	O
an	O
afﬁne	B
transformation	I
the	O
variety	O
is	O
the	O
intersection	B
of	O
two	O
hyperplanes	O
,	O
i.e	O
.	O
it	O
is	O
a	O
linear	B
subspace	O
of	O
dimen-	O
sion	O
2.	O
this	O
follows	O
from	O
the	O
form	O
(	O
4.9	O
)	O
of	O
the	O
afﬁne	O
matrix	B
which	O
for	O
x	O
(	O
cid:2	O
)	O
=	O
hax	O
yields	O
one	O
linear	B
constraint	O
between	O
x	O
,	O
x	O
,	O
each	O
of	O
which	O
de-	O
ﬁnes	O
a	O
hyperplane	O
in	O
ir4	O
.	O
an	O
analogue	O
of	O
this	O
situation	O
is	O
line	B
ﬁtting	O
to	O
points	O
on	O
the	O
plane	B
.	O
in	O
both	O
cases	O
the	O
relation	B
(	O
afﬁne	B
transformation	I
or	O
line	B
)	O
may	O
be	O
estimated	O
by	O
minimizing	O
the	O
perpendicular	O
distance	B
of	O
points	O
to	O
the	O
variety	O
.	O
in	O
both	O
cases	O
there	O
is	O
a	O
closed	O
form	O
solution	O
as	O
discussed	O
in	O
the	O
following	O
section	O
.	O
,	O
y	O
and	O
another	O
between	O
x	O
,	O
y	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
4.2.6	O
sampson	O
error	B
the	O
geometric	B
error	I
(	O
4.8	O
)	O
is	O
quite	O
complex	O
in	O
nature	O
,	O
and	O
minimizing	B
it	O
requires	O
the	O
simultaneous	O
estimation	B
of	I
both	O
the	O
homography	B
matrix	O
and	O
the	O
points	O
ˆxi	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i.	O
this	O
non-linear	B
estimation	O
problem	O
will	O
be	O
discussed	O
further	O
in	O
section	O
4.5.	O
its	O
complexity	O
contrasts	O
with	O
the	O
simplicity	O
of	O
minimizing	O
the	O
algebraic	B
error	I
(	O
4.4	O
)	O
.	O
the	O
geometric	B
interpretation	I
of	O
geometric	B
error	I
given	O
in	O
section	O
4.2.5	O
leads	O
to	O
a	O
further	O
cost	B
function	I
that	O
lies	O
between	O
the	O
algebraic	B
and	O
geometric	B
cost	O
functions	O
in	O
terms	O
of	O
complexity	O
,	O
but	O
gives	O
a	O
close	O
approximation	O
to	O
geometric	O
error	B
.	O
we	O
will	O
refer	O
to	O
this	O
cost	B
function	I
as	O
sampson	O
error	B
since	O
sampson	O
[	O
sampson-82	O
]	O
used	O
this	O
approximation	O
for	O
conic	O
ﬁtting	O
.	O
as	O
described	O
in	O
section	O
4.2.5	O
,	O
the	O
vector	O
(	O
cid:23	O
)	O
x	O
that	O
minimizes	O
the	O
geometric	B
error	I
(	O
cid:10	O
)	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
(	O
cid:10	O
)	O
2	O
is	O
the	O
closest	O
point	B
on	O
the	O
variety	O
vh	O
to	O
the	O
measurement	O
x.	O
this	O
point	B
can	O
not	O
be	O
estimated	O
directly	O
except	O
via	O
iteration	O
,	O
because	O
of	O
the	O
non-linear	O
nature	O
of	O
the	O
variety	O
to	O
the	O
point	B
(	O
cid:23	O
)	O
x	O
,	O
assuming	O
that	O
the	O
cost	B
function	I
is	O
well	O
approximated	O
linearly	O
in	O
the	O
vh	O
.	O
the	O
idea	O
of	O
the	O
sampson	O
error	B
function	O
is	O
to	O
estimate	O
a	O
ﬁrst-order	O
approximation	O
neighbourhood	O
of	O
the	O
estimated	O
point	B
.	O
the	O
discussion	O
to	O
follow	O
is	O
related	O
directly	O
to	O
4.2	O
different	O
cost	B
functions	I
99	O
the	O
2d	O
homography	B
estimation	I
problem	O
,	O
but	O
applies	O
substantially	O
unchanged	O
to	O
the	O
other	O
estimation	B
problems	O
discussed	O
in	O
this	O
book	O
.	O
)	O
t	O
that	O
lies	O
on	O
vh	O
will	O
satisfy	O
(	O
cid:2	O
)	O
for	O
a	O
given	O
homography	B
h	O
,	O
any	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
x	O
the	O
equation	O
(	O
4.3–p89	O
)	O
,	O
or	O
ah	O
=	O
0.	O
to	O
emphasize	O
the	O
dependency	O
on	O
x	O
we	O
will	O
write	O
this	O
instead	O
as	O
ch	O
(	O
x	O
)	O
=	O
0	O
,	O
where	O
ch	O
(	O
x	O
)	O
is	O
in	O
this	O
case	O
a	O
2-vector	O
.	O
to	O
ﬁrst	O
order	O
,	O
this	O
cost	B
function	I
may	O
be	O
approximated	O
by	O
a	O
taylor	O
expansion	O
,	O
y	O
(	O
cid:2	O
)	O
ch	O
(	O
x	O
+	O
δx	O
)	O
=	O
ch	O
(	O
x	O
)	O
+	O
δx	O
.	O
(	O
4.10	O
)	O
if	O
we	O
write	O
δx	O
=	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
and	O
desire	O
(	O
cid:23	O
)	O
x	O
to	O
lie	O
on	O
the	O
variety	O
vh	O
so	O
that	O
ch	O
(	O
(	O
cid:23	O
)	O
x	O
)	O
=0	O
,	O
then	O
the	O
result	O
is	O
ch	O
(	O
x	O
)	O
+	O
(	O
∂ch/∂x	O
)	O
δx	O
=	O
0	O
,	O
which	O
we	O
will	O
henceforth	O
write	O
as	O
jδx	O
=	O
−	O
where	O
j	O
is	O
the	O
partial-derivative	O
matrix	B
,	O
and	O
	O
is	O
the	O
cost	O
ch	O
(	O
x	O
)	O
associated	O
with	O
x.	O
the	O
minimization	B
problem	O
that	O
we	O
now	O
face	O
is	O
to	O
ﬁnd	O
the	O
smallest	O
δx	O
that	O
satisﬁes	O
this	O
equation	O
,	O
namely	O
:	O
•	O
find	O
the	O
vector	O
δx	O
that	O
minimizes	O
(	O
cid:10	O
)	O
δx	O
(	O
cid:10	O
)	O
subject	O
to	O
jδx	O
=	O
−	O
.	O
the	O
standard	O
way	O
to	O
solve	O
problems	O
of	O
this	O
type	O
is	O
to	O
use	O
lagrange	O
multipliers	O
.	O
a	O
vector	O
λ	O
of	O
lagrange	O
multipliers	O
is	O
introduced	O
,	O
and	O
the	O
problem	O
reduces	O
to	O
that	O
of	O
xδx	O
−	O
2λt	O
(	O
jδx	O
+	O
	O
)	O
,	O
where	O
the	O
factor	O
2	O
is	O
simply	O
introduced	O
ﬁnding	O
the	O
extrema	O
of	O
δt	O
for	O
convenience	O
.	O
taking	O
derivatives	O
with	O
respect	O
to	O
δx	O
and	O
equating	O
to	O
zero	O
gives	O
∂ch	O
∂x	O
x	O
−	O
2λtj	O
=	O
0t	O
2δt	O
from	O
which	O
we	O
obtain	O
δx	O
=	O
jtλ	O
.	O
the	O
derivative	O
with	O
respect	O
to	O
λ	O
gives	O
jδx	O
+	O
	O
=	O
0	O
,	O
the	O
original	O
constraint	O
.	O
substituting	O
for	O
δx	O
leads	O
to	O
jjtλ	O
=	O
−	O
which	O
may	O
be	O
solved	O
for	O
λ	O
giving	O
λ	O
=	O
−	O
(	O
jjt	O
)	O
−1	O
,	O
and	O
so	O
ﬁnally	O
δx	O
=	O
−jt	O
(	O
jjt	O
)	O
−1	O
,	O
and	O
(	O
cid:23	O
)	O
x	O
=	O
x	O
+	O
δx	O
.	O
the	O
norm	B
(	O
cid:10	O
)	O
δx	O
(	O
cid:10	O
)	O
2	O
is	O
the	O
sampson	O
error	B
:	O
−1	O
.	O
(	O
cid:10	O
)	O
δx	O
(	O
cid:10	O
)	O
2	O
=	O
δt	O
xδx	O
=	O
t	O
(	O
jjt	O
)	O
(	O
4.12	O
)	O
(	O
4.11	O
)	O
example	O
4.2.	O
sampson	O
approximation	O
for	O
a	O
conic	O
we	O
will	O
compute	O
the	O
sampson	O
approximation	O
to	O
the	O
geometric	B
distance	I
d⊥	O
(	O
x	O
,	O
c	O
)	O
be-	O
tween	O
a	O
point	B
x	O
and	O
conic	B
c	O
shown	O
in	O
ﬁgure	O
4.3.	O
in	O
this	O
case	O
the	O
conic	B
variety	O
vc	O
is	O
deﬁned	O
by	O
the	O
equation	O
xtcx	O
=	O
0	O
,	O
so	O
that	O
x	O
=	O
(	O
x	O
,	O
y	O
)	O
t	O
is	O
a	O
2-vector	O
,	O
	O
=	O
xtcx	O
is	O
a	O
scalar	O
,	O
and	O
j	O
is	O
the	O
1	O
×	O
2	O
matrix	B
given	O
by	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
j	O
=	O
∂	O
(	O
xtcx	O
)	O
∂x	O
,	O
∂	O
(	O
xtcx	O
)	O
∂y	O
.	O
this	O
means	O
that	O
jjt	O
is	O
a	O
scalar	O
.	O
the	O
elements	O
of	O
j	O
may	O
be	O
computed	O
by	O
the	O
chain	O
rule	O
as	O
∂	O
(	O
xtcx	O
)	O
∂x	O
=	O
∂	O
(	O
xtcx	O
)	O
∂x	O
∂x	O
∂x	O
=	O
2xtc	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
=	O
2	O
(	O
cx	O
)	O
1	O
100	O
where	O
(	O
cx	O
)	O
i	O
denotes	O
the	O
i-th	O
component	O
of	O
the	O
3-vector	O
cx	O
.	O
then	O
from	O
(	O
4.12	O
)	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
d2⊥	O
=	O
(	O
cid:10	O
)	O
δx	O
(	O
cid:10	O
)	O
2	O
=	O
t	O
(	O
jjt	O
)	O
−1	O
=	O
t	O
jjt	O
=	O
(	O
xtcx	O
)	O
2	O
4	O
(	O
(	O
cx	O
)	O
2	O
1	O
+	O
(	O
cx	O
)	O
2	O
2	O
)	O
(	O
cid:2	O
)	O
a	O
few	O
points	O
to	O
note	O
:	O
measurements	O
are	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
and	O
x	O
(	O
cid:2	O
)	O
)	O
t	O
where	O
the	O
2d	O
(	O
i	O
)	O
for	O
the	O
2d	O
homography	B
estimation	I
problem	O
,	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
x	O
(	O
ii	O
)	O
	O
=	O
ch	O
(	O
x	O
)	O
is	O
the	O
algebraic	B
error	I
vector	O
aih	O
–	O
a	O
2-vector	O
–	O
and	O
ai	O
is	O
deﬁned	O
in	O
(	O
iii	O
)	O
j	O
=	O
∂ch	O
(	O
x	O
)	O
/∂x	O
is	O
a	O
2	O
×	O
4	O
matrix	B
.	O
for	O
example	O
(	O
4.3–p89	O
)	O
.	O
,	O
1	O
)	O
t.	O
=	O
(	O
x	O
,	O
y	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
j11	O
=	O
∂	O
(	O
−w	O
(	O
cid:2	O
)	O
i	O
(	O
cid:2	O
)	O
h2	O
+	O
y	O
i	O
xt	O
i	O
xt	O
i	O
h3	O
)	O
/∂x	O
=	O
−w	O
(	O
cid:2	O
)	O
ih21	O
+	O
y	O
(	O
cid:2	O
)	O
ih31	O
.	O
(	O
iv	O
)	O
note	O
the	O
similarity	B
of	O
(	O
4.12	O
)	O
to	O
the	O
algebraic	B
error	I
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
=	O
t	O
.	O
the	O
sampson	O
error	B
may	O
be	O
interpreted	O
as	O
being	O
the	O
mahalanobis	O
norm	B
(	O
see	O
section	O
a2.1-	O
(	O
p565	O
)	O
)	O
,	O
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
jjt	O
.	O
(	O
v	O
)	O
one	O
could	O
alternatively	O
use	O
a	O
deﬁned	O
by	O
(	O
4.1–p89	O
)	O
,	O
in	O
which	O
case	O
j	O
has	O
di-	O
mension	O
3	O
×	O
4	O
and	O
	O
is	O
a	O
3-vector	O
.	O
however	O
,	O
in	O
general	O
the	O
sampson	O
error	B
,	O
and	O
consequently	O
the	O
solution	B
δx	O
,	O
will	O
be	O
independent	O
of	O
whether	O
(	O
4.1–p89	O
)	O
or	O
(	O
4.3–p89	O
)	O
is	O
used	O
.	O
the	O
sampson	O
error	B
(	O
4.12	O
)	O
is	O
derived	O
here	O
for	O
a	O
single	O
point	B
pair	O
.	O
in	O
applying	O
this	O
to	O
the	O
estimation	B
of	I
a	O
2d	O
homography	B
h	O
from	O
several	O
point	B
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
the	O
errors	O
corresponding	O
to	O
all	O
the	O
point	B
correspondences	O
must	O
be	O
summed	O
,	O
giving	O
d⊥	O
=	O
i	O
(	O
jijt	O
t	O
i	O
)	O
−1i	O
(	O
4.13	O
)	O
(	O
cid:7	O
)	O
i	O
where	O
	O
and	O
j	O
both	O
depend	O
on	O
h.	O
to	O
estimate	O
h	O
,	O
this	O
expression	O
must	O
be	O
minimized	O
over	O
all	O
values	O
of	O
h.	O
this	O
is	O
a	O
simple	O
minimization	O
problem	O
in	O
which	O
the	O
set	O
of	O
variable	O
parameters	B
consists	O
only	O
of	O
the	O
entries	O
(	O
or	O
some	O
other	O
parametrization	B
)	O
of	O
h.	O
this	O
derivation	B
of	O
the	O
sampson	O
error	B
assumed	O
that	O
each	O
point	B
had	O
isotropic	B
(	O
circular	O
)	O
error	B
distribution	O
,	O
the	O
same	O
in	O
each	O
image	O
.	O
the	O
appropriate	O
formulae	O
for	O
more	O
general	O
gaussian	O
error	B
distributions	O
are	O
given	O
in	O
the	O
exercises	O
at	O
the	O
end	O
of	O
this	O
chapter	O
.	O
linear	B
cost	I
function	I
the	O
algebraic	B
error	I
vector	O
ch	O
(	O
x	O
)	O
=	O
a	O
(	O
x	O
)	O
h	O
is	O
typically	O
multilinear	O
in	O
the	O
entries	O
of	O
x.	O
the	O
case	O
where	O
a	O
(	O
x	O
)	O
h	O
is	O
linear	B
is	O
,	O
however	O
,	O
important	O
in	O
its	O
own	O
right	O
.	O
the	O
ﬁrst	O
point	B
to	O
note	O
is	O
that	O
in	O
this	O
case	O
,	O
the	O
ﬁrst-order	O
approximation	O
to	O
geometric	O
error	B
given	O
by	O
the	O
taylor	O
expansion	O
in	O
(	O
4.10	O
)	O
is	O
exact	O
(	O
the	O
higher	O
order	O
terms	O
are	O
zero	O
)	O
,	O
which	O
means	O
that	O
the	O
sampson	O
error	B
is	O
identical	O
to	O
geometric	O
error	B
.	O
in	O
addition	O
,	O
the	O
variety	O
vh	O
deﬁned	O
by	O
the	O
equation	O
ch	O
(	O
x	O
)	O
=0	O
,	O
a	O
set	O
of	O
linear	O
equa-	O
tions	O
,	O
is	O
a	O
hyperplane	O
depending	O
on	O
h.	O
the	O
problem	O
of	O
ﬁnding	O
h	O
now	O
becomes	O
a	O
hyperplane	O
ﬁtting	O
problem	O
–	O
ﬁnd	O
the	O
best	O
ﬁt	O
to	O
the	O
data	O
xi	O
among	O
the	O
hyperplanes	O
parametrized	O
by	O
h.	O
4.2	O
different	O
cost	B
functions	I
101	O
as	O
an	O
example	O
of	O
this	O
idea	O
a	O
linear	B
algorithm	I
which	O
minimizes	O
geometric	B
error	I
(	O
4.8	O
)	O
for	O
an	O
afﬁne	B
transformation	I
is	O
developed	O
in	O
the	O
exercises	O
at	O
the	O
end	O
of	O
this	O
chapter	O
.	O
4.2.7	O
another	O
geometric	B
interpretation	I
it	O
was	O
shown	O
in	O
section	O
4.2.5	O
that	O
ﬁnding	O
a	O
homography	B
that	O
takes	O
a	O
set	O
of	B
points	I
xi	O
to	O
another	O
set	O
x	O
(	O
cid:2	O
)	O
i	O
is	O
equivalent	B
to	O
the	O
problem	O
of	O
ﬁtting	O
a	O
variety	O
of	O
a	O
given	O
type	O
to	O
a	O
set	O
of	B
points	I
in	O
ir4	O
.	O
we	O
now	O
consider	O
a	O
different	O
interpretation	O
in	O
which	O
the	O
set	O
of	O
all	O
measurements	O
is	O
represented	O
by	O
a	O
single	O
point	O
in	O
a	O
measurement	O
space	O
irn	O
.	O
the	O
estimation	B
problems	O
we	O
consider	O
may	O
all	O
be	O
ﬁtted	O
into	O
a	O
common	O
framework	O
.	O
in	O
abstract	O
terms	O
the	O
estimation	B
problem	I
has	O
two	O
components	O
,	O
•	O
a	O
measurement	O
space	O
irn	O
consisting	O
of	O
measurement	O
vectors	O
x	O
,	O
and	O
•	O
a	O
model	B
,	O
which	O
in	O
abstract	O
terms	O
may	O
be	O
thought	O
of	O
simply	O
as	O
a	O
subset	O
s	O
of	B
points	I
in	O
irn	O
.	O
a	O
measurement	O
vector	O
x	O
that	O
lies	O
inside	O
this	O
subset	O
is	O
said	O
to	O
satisfy	O
the	O
model	B
.	O
typically	O
the	O
subspace	O
that	O
satisﬁes	O
the	O
model	B
is	O
a	O
submanifold	O
,	O
or	O
variety	O
in	O
irn	O
.	O
now	O
,	O
given	O
a	O
measurement	O
vector	O
x	O
in	O
irn	O
,	O
the	O
estimation	B
problem	I
is	O
to	O
ﬁnd	O
the	O
vector	O
(	O
cid:23	O
)	O
x	O
,	O
closest	O
to	O
x	O
,	O
that	O
satisﬁes	O
the	O
model	B
.	O
it	O
will	O
now	O
be	O
pointed	O
out	O
how	O
the	O
2d	O
homography	B
estimation	I
problem	O
ﬁts	O
into	O
this	O
i	O
i	O
framework	O
.	O
error	B
in	I
both	I
images	I
.	O
let	O
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
be	O
a	O
set	O
of	O
measured	O
matched	O
points	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n.	O
in	O
all	O
,	O
there	O
are	O
4n	O
measurements	O
,	O
namely	O
two	O
coordinates	O
in	O
each	O
of	O
two	O
images	O
for	O
n	O
points	O
.	O
thus	O
,	O
the	O
set	O
of	O
matched	O
points	O
represents	O
a	O
point	B
in	O
irn	O
,	O
where	O
n	O
=	O
4n	O
.	O
the	O
vector	O
made	O
up	O
of	O
the	O
coordinates	O
of	O
all	O
the	O
matched	O
points	O
in	O
both	B
images	I
will	O
be	O
denoted	O
x.	O
of	O
course	O
,	O
not	O
all	O
sets	O
of	O
point	O
pairs	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
related	O
via	O
a	O
homography	B
h.	O
a	O
set	O
of	O
point	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
for	O
which	O
there	O
exists	O
a	O
projective	B
transformation	I
h	O
satisfying	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
hxi	O
for	O
all	O
i	O
constitutes	O
the	O
subset	O
of	O
irn	O
satisfying	O
the	O
model	B
.	O
in	O
general	O
,	O
this	O
set	O
of	B
points	I
will	O
form	O
a	O
submanifold	O
s	O
in	O
irn	O
(	O
in	O
fact	O
a	O
variety	O
)	O
of	O
some	O
dimension	O
.	O
the	O
dimension	O
of	O
this	O
submanifold	O
is	O
equal	O
to	O
the	O
minimal	O
number	O
of	O
parameters	O
that	O
may	O
be	O
used	O
to	O
parametrize	O
the	O
submanifold	O
.	O
one	O
may	O
arbitrarily	O
choose	O
n	O
points	O
ˆxi	O
in	O
the	O
ﬁrst	O
image	O
.	O
in	O
addition	O
,	O
a	O
homography	B
h	O
may	O
be	O
chosen	O
arbitrarily	O
.	O
once	O
these	O
choices	O
have	O
been	O
made	O
,	O
the	O
points	O
ˆx	O
(	O
cid:2	O
)	O
i	O
in	O
the	O
second	O
image	O
are	O
determined	O
by	O
ˆx	O
(	O
cid:2	O
)	O
i	O
=	O
hˆxi	O
.	O
thus	O
,	O
a	O
feasible	O
choice	B
of	O
points	O
is	O
determined	O
by	O
a	O
set	O
of	O
2n	O
+	O
8	O
parameters	B
:	O
the	O
2n	O
coordinates	B
of	O
the	O
points	O
ˆxi	O
,	O
plus	O
the	O
8	O
independent	O
parameters	B
(	O
degrees	B
of	I
freedom	I
)	O
of	O
the	O
transformation	O
h.	O
thus	O
,	O
the	O
submanifold	O
s	O
⊂	O
irn	O
has	O
dimension	O
2n	O
+	O
8	O
,	O
and	O
hence	O
codimension	O
2n	O
−	O
8.	O
and	O
an	O
estimated	O
point	B
(	O
cid:23	O
)	O
x	O
∈	O
irn	O
lying	O
on	O
s	O
,	O
one	O
easily	O
veriﬁes	O
that	O
given	O
a	O
set	O
of	O
measured	O
point	B
pairs	O
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
,	O
corresponding	O
to	O
a	O
point	B
x	O
in	O
irn	O
,	O
thus	O
,	O
ﬁnding	O
the	O
point	B
(	O
cid:23	O
)	O
x	O
on	O
s	O
lying	O
closest	O
to	O
x	O
in	O
irn	O
is	O
equivalent	B
to	O
minimizing	B
the	I
cost	I
function	I
given	O
by	O
(	O
4.8	O
)	O
.	O
the	O
estimated	O
correct	O
correspondences	B
ˆxi	O
↔	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
(	O
cid:10	O
)	O
2	O
=	O
(	O
cid:7	O
)	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2.	O
i	O
i	O
i	O
are	O
102	O
those	O
corresponding	O
to	O
the	O
closest	O
surface	O
point	B
(	O
cid:23	O
)	O
x	O
in	O
irn	O
.	O
once	O
(	O
cid:23	O
)	O
x	O
is	O
known	O
h	O
may	O
be	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
computed	O
.	O
i	O
error	B
in	I
one	I
image	I
only	O
.	O
in	O
the	O
case	O
of	O
error	O
in	B
one	I
image	I
,	O
one	O
has	O
a	O
set	O
of	O
correspon-	O
dences	O
{	O
¯xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
.	O
the	O
points	O
¯xi	O
are	O
assumed	O
perfect	O
.	O
the	O
inhomogeneous	O
coordinates	O
space	O
has	O
dimension	O
n	O
=	O
2n	O
.	O
the	O
vector	O
(	O
cid:23	O
)	O
x	O
consists	O
of	O
the	O
inhomogeneous	O
coor-	O
of	O
the	O
x	O
(	O
cid:2	O
)	O
i	O
constitute	O
the	O
measurement	O
vector	O
x.	O
hence	O
,	O
in	O
this	O
case	O
the	O
measurement	O
vectors	O
satisfying	O
the	O
model	B
is	O
the	O
set	O
(	O
cid:23	O
)	O
x	O
as	O
h	O
varies	O
over	O
the	O
set	O
of	O
all	O
homography	B
dinates	O
of	O
the	O
mapped	O
perfect	O
points	O
{	O
h¯x1	O
,	O
h¯x2	O
,	O
.	O
.	O
.	O
,	O
h	O
¯xn	O
}	O
.	O
the	O
set	O
of	O
measurement	O
matrices	O
.	O
once	O
again	O
this	O
subspace	O
is	O
a	O
variety	O
.	O
its	O
dimension	O
is	O
8	O
,	O
since	O
this	O
is	O
the	O
total	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
homography	O
matrix	B
h.	O
as	O
with	O
the	O
previous	O
case	O
,	O
(	O
cid:7	O
)	O
the	O
codimension	O
is	O
2n	O
−	O
8.	O
one	O
veriﬁes	O
that	O
(	O
cid:10	O
)	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
(	O
cid:10	O
)	O
2	O
=	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
h¯xi	O
)	O
2.	O
thus	O
,	O
ﬁnding	O
the	O
closest	O
point	B
on	O
s	O
to	O
the	O
measurement	O
vector	O
x	O
is	O
equivalent	B
to	O
min-	O
imizing	O
the	O
cost	B
function	I
(	O
4.6	O
)	O
.	O
i	O
4.3	O
statistical	O
cost	B
functions	I
and	O
maximum	O
likelihood	O
estimation	B
in	O
section	O
4.2	O
,	O
various	O
cost	B
functions	I
were	O
considered	O
that	O
were	O
related	O
to	O
geometric	O
distance	B
between	O
estimated	O
and	O
measured	O
points	O
in	O
an	O
image	O
.	O
the	O
use	O
of	O
such	O
cost	B
functions	I
is	O
now	O
justiﬁed	O
and	O
then	O
generalized	O
by	O
a	O
consideration	O
of	O
error	O
statistics	O
of	O
the	O
point	O
measurements	O
in	O
an	O
image	O
.	O
in	O
order	O
to	O
obtain	O
a	O
best	O
(	O
optimal	O
)	O
estimate	O
of	O
h	O
it	O
is	O
necessary	O
to	O
have	O
a	O
model	B
for	O
the	O
measurement	O
error	O
(	O
the	O
“	O
noise	B
”	O
)	O
.	O
we	O
are	O
assuming	O
here	O
that	O
in	O
the	O
absence	O
of	O
mea-	O
surement	O
error	B
the	O
true	O
points	O
exactly	O
satisfy	O
a	O
homography	B
,	O
i.e	O
.	O
¯x	O
(	O
cid:2	O
)	O
i	O
=	O
h¯xi	O
.	O
a	O
common	O
assumption	O
is	O
that	O
image	O
coordinate	O
measurement	O
errors	O
obey	O
a	O
gaussian	O
(	O
or	O
normal	O
)	O
probability	O
distribution	O
.	O
this	O
assumption	O
is	O
surely	O
not	O
justiﬁed	O
in	O
general	O
,	O
and	O
takes	O
no	O
account	O
of	O
the	O
presence	O
of	O
outliers	O
(	O
grossly	O
erroneous	O
measurements	O
)	O
in	O
the	O
measured	O
data	O
.	O
methods	O
for	O
detecting	O
and	O
removing	O
outliers	O
will	O
be	O
discussed	O
later	O
in	O
section	O
4.7.	O
once	O
outliers	O
have	O
been	O
removed	O
,	O
the	O
assumption	O
of	O
a	O
gaussian	O
error	B
model	O
,	O
if	O
still	O
not	O
strictly	O
justiﬁed	O
,	O
becomes	O
more	O
tenable	O
.	O
therefore	O
,	O
for	O
the	O
present	O
,	O
we	O
assume	O
that	O
image	O
measurement	O
errors	O
obey	O
a	O
zero-mean	O
isotropic	B
gaussian	O
distribution	B
.	O
this	O
dis-	O
tribution	O
is	O
described	O
in	O
section	O
a2.1	O
(	O
p565	O
)	O
.	O
speciﬁcally	O
we	O
assume	O
that	O
the	O
noise	B
is	O
gaussian	O
on	O
each	O
image	O
coordinate	O
with	O
zero	O
mean	O
and	O
uniform	O
standard	O
deviation	O
σ.	O
this	O
means	O
that	O
x	O
=	O
¯x	O
+	O
∆x	O
,	O
with	O
∆x	O
obeying	O
a	O
gaussian	O
distribution	B
with	O
variance	B
σ2	O
.	O
if	O
it	O
is	O
further	O
assumed	O
that	O
the	O
noise	B
on	O
each	O
measurement	O
is	O
independent	O
,	O
then	O
,	O
if	O
the	O
true	O
point	B
is	O
¯x	O
,	O
the	O
probability	B
density	I
function	I
(	O
pdf	O
)	O
of	O
each	O
measured	O
point	B
x	O
is	O
(	O
cid:28	O
)	O
(	O
cid:29	O
)	O
pr	O
(	O
x	O
)	O
=	O
1	O
2πσ2	O
−d	O
(	O
x	O
,	O
¯x	O
)	O
2/	O
(	O
2σ2	O
)	O
.	O
e	O
(	O
4.14	O
)	O
error	B
in	I
one	I
image	I
.	O
second	O
image	O
.	O
the	O
probability	O
of	O
obtaining	O
the	O
set	O
of	O
correspondences	O
{	O
¯xi	O
↔	O
x	O
(	O
cid:2	O
)	O
first	O
we	O
consider	O
the	O
case	O
where	O
the	O
errors	O
are	O
only	O
in	O
the	O
}	O
is	O
i	O
log	O
pr	O
(	O
{	O
x	O
(	O
cid:2	O
)	O
i	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
h¯xi	O
)	O
2	O
+	O
constant	O
.	O
(	O
cid:7	O
)	O
i	O
}	O
|h	O
)	O
=−	O
1	O
2σ2	O
(	O
cid:7	O
)	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
h¯xi	O
)	O
2	O
.	O
4.3	O
statistical	O
cost	B
functions	I
and	O
maximum	O
likelihood	O
estimation	B
103	O
simply	O
the	O
product	O
of	O
their	O
individual	O
pdfs	O
,	O
since	O
the	O
errors	O
on	O
each	O
point	B
are	O
assumed	O
independent	O
.	O
then	O
the	O
pdf	O
of	O
the	O
noise-perturbed	O
data	O
is	O
(	O
cid:28	O
)	O
(	O
cid:30	O
)	O
(	O
cid:29	O
)	O
i	O
1	O
}	O
|h	O
)	O
=	O
pr	O
(	O
{	O
x	O
(	O
cid:2	O
)	O
(	O
4.15	O
)	O
}	O
|h	O
)	O
is	O
to	O
be	O
interpreted	O
as	O
meaning	O
the	O
probability	O
of	O
obtaining	O
the	O
}	O
given	O
that	O
the	O
true	O
homography	B
is	O
h.	O
the	O
log-likelihood	O
of	O
the	O
set	O
i	O
,	O
h¯xi	O
)	O
2/	O
(	O
2σ2	O
)	O
.	O
−d	O
(	O
x	O
(	O
cid:1	O
)	O
2πσ2	O
e	O
i	O
the	O
symbol	O
pr	O
(	O
{	O
x	O
(	O
cid:2	O
)	O
measurements	O
{	O
x	O
(	O
cid:2	O
)	O
of	O
correspondences	O
is	O
i	O
i	O
the	O
maximum	O
likelihood	O
estimate	O
(	O
mle	O
)	O
of	O
the	O
homography	O
,	O
ˆh	O
,	O
maximizes	O
this	O
log-	O
likelihood	O
,	O
i.e	O
.	O
minimizes	O
thus	O
,	O
we	O
note	O
that	O
ml	O
estimation	B
is	O
equivalent	B
to	O
minimizing	O
the	O
geometric	O
error	B
func-	O
tion	O
(	O
4.6	O
)	O
.	O
i	O
error	B
in	I
both	I
images	I
.	O
(	O
cid:28	O
)	O
correspondences	B
are	O
{	O
¯xi	O
↔	O
h¯xi	O
=	O
¯x	O
(	O
cid:2	O
)	O
}	O
,	O
then	O
the	O
pdf	O
of	O
the	O
noise-perturbed	O
data	O
is	O
(	O
cid:30	O
)	O
}	O
|h	O
,	O
{	O
¯xi	O
}	O
)	O
=	O
following	O
a	O
similar	O
development	O
to	O
the	O
above	O
,	O
if	O
the	O
true	O
pr	O
(	O
{	O
xi	O
,	O
x	O
(	O
cid:2	O
)	O
−	O
(	O
d	O
(	O
xi	O
,	O
¯xi	O
)	O
2+d	O
(	O
x	O
(	O
cid:1	O
)	O
i	O
,	O
h¯xi	O
)	O
2	O
)	O
/	O
(	O
2σ2	O
)	O
.	O
(	O
cid:29	O
)	O
1	O
e	O
i	O
i	O
2πσ2	O
i	O
the	O
additional	O
complication	O
here	O
is	O
that	O
we	O
have	O
to	O
seek	O
“	O
corrected	O
”	O
image	O
measure-	O
ments	O
that	O
play	O
the	O
role	O
of	O
the	O
true	O
measurements	O
(	O
h¯x	O
above	O
)	O
.	O
thus	O
the	O
ml	O
estimate	O
of	O
the	O
projective	O
transformation	B
h	O
and	O
the	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
,	O
is	O
the	O
homography	B
ˆh	O
and	O
corrected	O
correspondences	B
{	O
ˆxi	O
↔	O
ˆx	O
(	O
cid:2	O
)	O
}	O
that	O
minimize	O
i	O
i	O
(	O
cid:7	O
)	O
i	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
with	O
ˆx	O
(	O
cid:2	O
)	O
reprojection	B
error	I
function	O
(	O
4.8	O
)	O
.	O
i	O
=	O
ˆhˆxi	O
.	O
note	O
that	O
in	O
this	O
case	O
,	O
the	O
ml	O
estimate	O
is	O
identical	O
with	O
minimizing	O
the	O
mahalanobis	O
distance	B
.	O
in	O
the	O
general	O
gaussian	O
case	O
,	O
one	O
may	O
assume	O
a	O
vector	O
of	O
measurements	O
x	O
satisfying	O
a	O
gaussian	O
distribution	B
function	O
with	O
covariance	O
matrix	B
σ.	O
the	O
cases	O
above	O
are	O
equivalent	B
to	O
a	O
covariance	B
matrix	O
which	O
is	O
a	O
multiple	O
of	O
the	O
identity	O
.	O
maximizing	O
the	O
log-likelihood	O
is	O
then	O
equivalent	B
to	O
minimizing	O
the	O
mahalanobis	O
distance	B
(	O
see	O
section	O
a2.1	O
(	O
p565	O
)	O
)	O
(	O
cid:10	O
)	O
x	O
−	O
¯x	O
(	O
cid:10	O
)	O
2	O
σ	O
=	O
(	O
x	O
−	O
¯x	O
)	O
tς−1	O
(	O
x	O
−	O
¯x	O
)	O
.	O
in	O
the	O
case	O
where	O
there	O
is	O
error	O
in	O
each	O
image	O
,	O
but	O
assuming	O
that	O
errors	O
in	O
one	O
image	O
are	O
independent	O
of	O
the	O
error	O
in	O
the	O
other	O
image	O
,	O
the	O
appropriate	O
cost	B
function	I
is	O
(	O
cid:10	O
)	O
x	O
−	O
¯x	O
(	O
cid:10	O
)	O
2	O
σ	O
+	O
(	O
cid:10	O
)	O
x	O
(	O
cid:2	O
)	O
−	O
¯x	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
2	O
σ	O
(	O
cid:1	O
)	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
are	O
the	O
covariance	B
matrices	O
of	O
the	O
measurements	O
in	O
the	O
two	O
images	O
.	O
finally	O
,	O
if	O
we	O
assume	O
that	O
the	O
errors	O
for	O
all	O
the	O
points	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
independent	O
,	O
i	O
respectively	O
,	O
then	O
the	O
above	O
expression	O
104	O
where	O
σ	O
and	O
σ	O
(	O
cid:2	O
)	O
with	O
individual	O
covariance	B
matrices	O
σi	O
and	O
σ	O
(	O
cid:2	O
)	O
expands	O
to	O
(	O
cid:7	O
)	O
(	O
cid:10	O
)	O
xi	O
−	O
¯xi	O
(	O
cid:10	O
)	O
2	O
σi	O
+	O
(	O
cid:7	O
)	O
(	O
cid:10	O
)	O
x	O
(	O
cid:2	O
)	O
−	O
¯x	O
(	O
cid:2	O
)	O
i	O
(	O
cid:10	O
)	O
2	O
σ	O
(	O
cid:1	O
)	O
i	O
(	O
4.16	O
)	O
i	O
this	O
equation	O
allows	O
the	O
incorporation	O
of	O
the	O
type	O
of	O
anisotropic	O
covariance	B
matrices	O
that	O
arise	O
for	O
point	O
locations	O
computed	O
as	O
the	O
intersection	B
of	O
two	O
non-perpendicular	O
lines	B
.	O
in	O
the	O
case	O
where	O
the	O
points	O
are	O
known	O
exactly	O
in	O
one	O
of	O
the	O
two	O
images	O
,	O
errors	O
being	O
conﬁned	O
to	O
the	O
other	O
image	O
,	O
one	O
of	O
the	O
two	O
summation	O
terms	O
in	O
(	O
4.16	O
)	O
disappears	O
.	O
4.4	O
transformation	B
invariance	I
and	O
normalization	B
we	O
now	O
start	O
to	O
discuss	O
the	O
properties	B
and	O
performance	B
of	O
the	O
dlt	O
algorithm	B
of	O
section	O
4.1	O
and	O
how	O
it	O
compares	O
with	O
algorithms	O
minimizing	B
geometric	I
error	O
.	O
the	O
ﬁrst	O
topic	O
is	O
the	O
invariance	O
of	O
the	O
algorithm	B
to	O
different	O
choices	O
of	O
coordinates	O
in	O
the	O
image	O
.	O
it	O
is	O
clear	O
that	O
it	O
would	O
generally	O
be	O
undesirable	O
for	O
the	O
result	O
of	O
an	O
algorithm	B
to	O
be	O
dependent	O
on	O
such	O
arbitrary	O
choices	O
as	O
the	O
origin	O
and	O
scale	O
,	O
or	O
even	O
orientation	B
,	O
of	O
the	O
coordinate	O
system	O
in	O
an	O
image	O
.	O
4.4.1	O
invariance	B
to	I
image	I
coordinate	I
transformations	I
image	O
coordinates	B
are	O
sometimes	O
given	O
with	O
the	O
origin	O
at	O
the	O
top-left	O
of	O
the	O
image	O
,	O
and	O
sometimes	O
with	O
the	O
origin	O
at	O
the	O
centre	B
.	O
the	O
question	O
immediately	O
occurs	O
whether	O
this	O
makes	O
a	O
difference	O
to	O
the	O
results	O
of	O
computing	B
the	O
transformation	B
.	O
similarly	O
,	O
if	O
the	O
units	O
used	O
to	O
express	O
image	O
coordinates	O
are	O
changed	O
by	O
multiplication	O
by	O
some	O
factor	O
,	O
then	O
is	O
it	O
possible	O
that	O
the	O
result	O
of	O
the	O
algorithm	O
changes	O
also	O
?	O
more	O
generally	O
,	O
to	O
what	O
extent	O
is	O
the	O
result	O
of	O
an	O
algorithm	B
that	O
minimizes	O
a	O
cost	B
function	I
to	O
estimate	O
a	O
homography	B
dependent	O
on	O
the	O
choice	B
of	O
coordinates	B
in	O
the	O
image	O
?	O
suppose	O
,	O
for	O
instance	O
,	O
that	O
the	O
image	O
coordinates	O
are	O
changed	O
by	O
some	O
similarity	B
,	O
afﬁne	B
or	O
even	O
projective	B
transformation	I
before	O
running	O
the	O
algorithm	B
.	O
will	O
this	O
materially	O
change	O
the	O
result	O
?	O
formally	O
,	O
suppose	O
that	O
coordinates	B
x	O
in	B
one	I
image	I
are	O
replaced	O
by	O
˜x	O
=	O
tx	O
,	O
and	O
are	O
3	O
×	O
3	O
coordinates	B
x	O
(	O
cid:2	O
)	O
t	O
(	O
cid:2	O
)	O
ht−1˜x	O
.	O
this	O
relation	B
implies	O
that	O
(	O
cid:22	O
)	O
h	O
=	O
t	O
(	O
cid:2	O
)	O
ht−1	O
is	O
the	O
transformation	B
matrix	O
for	O
the	O
=	O
hx	O
,	O
we	O
derive	O
the	O
equation	O
˜x	O
(	O
cid:2	O
)	O
homographies	B
.	O
substituting	O
in	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
=	O
point	B
correspondences	O
˜x	O
↔	O
˜x	O
(	O
cid:2	O
)	O
taking	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
find	O
the	O
transformation	B
(	O
cid:22	O
)	O
h	O
from	O
the	O
correspondences	B
˜xi	O
↔	O
˜x	O
(	O
cid:2	O
)	O
(	O
iii	O
)	O
set	O
h	O
=	O
t	O
(	O
cid:2	O
)	O
−1	O
(	O
cid:22	O
)	O
ht	O
.	O
the	O
transformation	B
matrix	O
h	O
found	O
in	O
this	O
way	O
applies	O
to	O
the	O
original	O
untransformed	O
point	B
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i.	O
what	O
choice	O
should	O
be	O
made	O
for	O
the	O
transformations	O
t	O
and	O
t	O
(	O
cid:2	O
)	O
will	O
be	O
left	O
unspeciﬁed	O
for	O
now	O
.	O
the	O
question	O
to	O
be	O
decided	O
now	O
is	O
whether	O
the	O
(	O
i	O
)	O
transform	O
the	O
image	O
coordinates	O
according	O
to	O
transformations	O
˜xi	O
=	O
txi	O
and	O
in	O
the	O
other	O
image	O
are	O
replaced	O
by	O
˜x	O
(	O
cid:2	O
)	O
.	O
an	O
alternative	O
method	O
of	O
ﬁnding	O
the	O
transformation	B
i	O
is	O
therefore	O
suggested	O
,	O
as	O
follows	O
.	O
=	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
,	O
where	O
t	O
and	O
t	O
(	O
cid:2	O
)	O
˜x	O
(	O
cid:2	O
)	O
i	O
=	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
i.	O
i	O
.	O
4.4	O
transformation	B
invariance	I
and	O
normalization	B
105	O
outcome	O
of	O
this	O
algorithm	B
is	O
independent	O
of	O
the	O
transformations	O
t	O
and	O
t	O
(	O
cid:2	O
)	O
being	O
applied	O
.	O
ideally	O
it	O
ought	O
to	O
be	O
,	O
at	O
least	O
when	O
t	O
and	O
t	O
(	O
cid:2	O
)	O
are	O
similarity	B
transformations	O
,	O
since	O
the	O
choice	B
of	O
a	O
different	O
scale	O
,	O
orientation	B
or	O
coordinate	O
origin	O
in	O
the	O
images	O
should	O
not	O
materially	O
affect	O
the	O
outcome	O
of	O
the	O
algorithm	O
.	O
in	O
the	O
subsequent	O
sections	O
it	O
will	O
be	O
shown	O
that	O
an	O
algorithm	B
that	O
minimizes	O
geo-	O
metric	B
error	O
is	O
invariant	O
to	O
similarity	O
transformations	O
.	O
on	O
the	O
other	O
hand	O
,	O
for	O
the	O
dlt	O
algorithm	B
as	O
described	O
in	O
section	O
4.1	O
,	O
the	O
result	O
unfortunately	O
is	O
not	O
invariant	O
to	O
simi-	O
larity	O
transformations	O
.	O
the	O
solution	B
is	O
to	O
apply	O
a	O
normalizing	B
transformation	I
to	O
the	O
data	O
before	O
applying	O
the	O
dlt	O
algorithm	B
.	O
this	O
normalizing	B
transformation	I
will	O
nullify	O
the	O
effect	O
of	O
the	O
arbitrary	O
selection	O
of	O
origin	O
and	O
scale	O
in	O
the	O
coordinate	O
frame	O
of	O
the	O
image	O
,	O
and	O
will	O
mean	O
that	O
the	O
combined	O
algorithm	B
is	O
invariant	O
to	O
a	O
similarity	B
transformation	I
of	O
the	O
image	O
.	O
appropriate	O
normalizing	O
transformations	O
will	O
be	O
discussed	O
later	O
.	O
i	O
=	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
i	O
yield	O
the	O
trans-	O
i	O
where	O
˜xi	O
=	O
txi	O
and	O
˜x	O
(	O
cid:2	O
)	O
4.4.2	O
non-invariance	B
of	O
the	O
dlt	O
algorithm	B
consider	O
a	O
set	O
of	O
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
and	O
a	O
matrix	B
h	O
that	O
is	O
the	O
result	O
of	O
the	O
dlt	O
i	O
,	O
and	O
let	O
(	O
cid:22	O
)	O
h	O
be	O
deﬁned	O
by	O
(	O
cid:22	O
)	O
h	O
=	O
t	O
(	O
cid:2	O
)	O
ht−1	O
.	O
following	O
section	O
4.4.1	O
,	O
the	O
question	O
to	O
be	O
decided	O
here	O
is	O
the	O
following	O
:	O
algorithm	B
applied	O
to	O
this	O
set	O
of	O
corresponding	O
points	O
.	O
consider	O
further	O
a	O
related	O
set	O
of	O
correspondences	O
˜xi	O
↔	O
˜x	O
(	O
cid:2	O
)	O
formation	O
(	O
cid:22	O
)	O
h	O
?	O
•	O
does	O
the	O
dlt	O
algorithm	B
applied	O
to	O
the	O
correspondence	B
set	O
˜xi	O
↔	O
˜x	O
(	O
cid:2	O
)	O
we	O
will	O
use	O
the	O
following	O
notation	O
:	O
matrix	B
ai	O
is	O
the	O
dlt	O
equation	O
matrix	B
(	O
4.3–p89	O
)	O
derived	O
from	O
a	O
point	B
correspondence	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
and	O
a	O
is	O
the	O
2n	O
×	O
9	O
matrix	B
formed	O
by	O
stacking	O
the	O
ai	O
.	O
matrix	B
˜ai	O
is	O
similarly	O
deﬁned	O
in	O
terms	O
of	O
the	O
correspondences	O
˜xi	O
↔	O
˜x	O
(	O
cid:2	O
)	O
i	O
,	O
where	O
˜xi	O
=	O
txi	O
and	O
˜x	O
(	O
cid:2	O
)	O
result	O
4.3.	O
let	O
t	O
(	O
cid:2	O
)	O
be	O
a	O
similarity	B
transformation	I
with	O
scale	O
factor	O
s	O
,	O
and	O
let	O
t	O
be	O
an	O
arbitrary	O
projective	B
transformation	I
.	O
further	O
,	O
suppose	O
h	O
is	O
any	O
2d	O
homography	B
and	O
let	O
˜h	O
be	O
deﬁned	O
by	O
˜h	O
=	O
t	O
(	O
cid:2	O
)	O
ht−1	O
.	O
then	O
(	O
cid:10	O
)	O
˜a˜h	O
(	O
cid:10	O
)	O
=	O
s	O
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
where	O
h	O
and	O
˜h	O
are	O
the	O
vectors	O
of	O
entries	O
of	O
h	O
and	O
˜h	O
.	O
×	O
hxi	O
.	O
note	O
that	O
aih	O
is	O
the	O
vector	O
consisting	O
of	O
the	O
proof	O
.	O
deﬁne	O
the	O
vector	O
i	O
=	O
x	O
(	O
cid:2	O
)	O
ﬁrst	O
two	O
entries	O
of	O
i	O
.	O
let	O
˜i	O
be	O
similarly	O
deﬁned	O
in	O
terms	O
of	O
the	O
transformed	O
quantities	O
as	O
˜i	O
=	O
˜x	O
(	O
cid:2	O
)	O
×	O
(	O
cid:22	O
)	O
h˜xi	O
=	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
×	O
t	O
(	O
cid:2	O
)	O
hxi	O
=	O
t	O
(	O
cid:2	O
)	O
∗	O
i	O
for	O
some	O
projective	B
transformations	O
t	O
and	O
t	O
(	O
cid:2	O
)	O
×	O
(	O
cid:22	O
)	O
h˜xi	O
.	O
one	O
computes	O
:	O
˜i	O
=	O
˜x	O
(	O
cid:2	O
)	O
=	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
=	O
t	O
(	O
cid:2	O
)	O
∗i	O
×	O
(	O
t	O
(	O
cid:2	O
)	O
ht−1	O
)	O
txi	O
×	O
hxi	O
)	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
.	O
i	O
i	O
i	O
i	O
i	O
i	O
represents	O
the	O
cofactor	B
matrix	I
of	O
t	O
(	O
cid:2	O
)	O
where	O
t	O
(	O
cid:2	O
)	O
∗	O
and	O
the	O
second-last	O
equality	O
follows	O
from	O
lemma	O
a4.2	O
(	O
p581	O
)	O
.	O
for	O
a	O
general	O
transformation	B
t	O
,	O
the	O
error	B
vectors	O
aih	O
and	O
˜h	O
(	O
namely	O
the	O
ﬁrst	O
two	O
components	O
of	O
i	O
and	O
˜i	O
)	O
are	O
not	O
simply	O
related	O
.	O
however	O
,	O
in	O
˜ai	O
the	O
special	O
case	O
where	O
t	O
(	O
cid:2	O
)	O
where	O
r	O
is	O
a	O
rotation	B
matrix	O
,	O
t	O
is	O
a	O
translation	O
and	O
s	O
is	O
a	O
scaling	B
factor	O
.	O
in	O
this	O
case	O
,	O
we	O
is	O
a	O
similarity	B
transformation	I
,	O
one	O
may	O
write	O
t	O
(	O
cid:2	O
)	O
sr	O
t	O
0t	O
1	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
=	O
(	O
cid:17	O
)	O
=	O
s	O
106	O
see	O
that	O
t	O
(	O
cid:2	O
)	O
∗	O
sees	O
that	O
(	O
cid:18	O
)	O
r	O
0	O
−ttr	O
s	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
.	O
applying	O
t	O
(	O
cid:2	O
)	O
∗	O
just	O
to	O
the	O
ﬁrst	O
two	O
components	O
of	O
i	O
,	O
one	O
˜ai	O
˜h	O
=	O
(	O
˜i1	O
,	O
˜i2	O
)	O
t	O
=	O
sr	O
(	O
i1	O
,	O
i2	O
)	O
t	O
=	O
sraih	O
.	O
dalg	O
(	O
˜x	O
(	O
cid:2	O
)	O
error	B
,	O
except	O
for	O
constant	O
scale	O
.	O
since	O
rotation	B
does	O
not	O
affect	O
vector	O
norms	O
,	O
one	O
sees	O
that	O
(	O
cid:10	O
)	O
˜a˜h	O
(	O
cid:10	O
)	O
=	O
s	O
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
,	O
as	O
required	O
.	O
this	O
result	O
may	O
be	O
expressed	O
in	O
terms	O
of	O
algebraic	O
error	B
as	O
i	O
,	O
hxi	O
)	O
.	O
i	O
,	O
(	O
cid:22	O
)	O
h˜xi	O
)	O
=	O
sdalg	O
(	O
x	O
(	O
cid:2	O
)	O
thus	O
,	O
there	O
is	O
a	O
one-to-one	O
correspondence	B
between	O
h	O
and	O
(	O
cid:22	O
)	O
h	O
giving	O
rise	O
to	O
the	O
same	O
it	O
may	O
appear	O
therefore	O
that	O
the	O
matrices	O
h	O
and	O
(	O
cid:22	O
)	O
h	O
minimizing	O
the	O
algebraic	O
error	B
will	O
be	O
related	O
by	O
the	O
formula	O
(	O
cid:22	O
)	O
h	O
=	O
t	O
(	O
cid:2	O
)	O
ht−1	O
,	O
and	O
hence	O
one	O
may	O
retrieve	O
h	O
as	O
the	O
product	O
t	O
(	O
cid:2	O
)	O
−1	O
(	O
cid:22	O
)	O
ht	O
.	O
this	O
conclusion	O
is	O
false	O
however	O
.	O
for	O
,	O
although	O
h	O
and	O
(	O
cid:22	O
)	O
h	O
so	O
deﬁned	O
give	O
rise	O
to	O
the	O
same	O
error	O
	O
,	O
the	O
condition	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
imposed	O
as	O
a	O
constraint	O
on	O
the	O
solution	B
,	O
is	O
not	O
equivalent	B
to	O
the	O
condition	O
(	O
cid:10	O
)	O
(	O
cid:22	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1.	O
speciﬁcally	O
,	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
and	O
(	O
cid:10	O
)	O
(	O
cid:22	O
)	O
h	O
(	O
cid:10	O
)	O
are	O
not	O
related	O
in	O
any	O
simple	O
manner	O
.	O
thus	O
,	O
there	O
is	O
no	O
one-	O
to-one	O
correspondence	B
between	O
h	O
and	O
(	O
cid:22	O
)	O
h	O
giving	O
rise	O
to	O
the	O
same	O
error	O
	O
,	O
subject	O
to	O
the	O
constraint	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
(	O
cid:22	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1.	O
speciﬁcally	O
,	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
dalg	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:7	O
)	O
dalg	O
(	O
˜x	O
(	O
cid:2	O
)	O
dalg	O
(	O
˜x	O
(	O
cid:2	O
)	O
i	O
,	O
hxi	O
)	O
2	O
subject	O
to	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1	O
i	O
,	O
(	O
cid:22	O
)	O
h˜xi	O
)	O
2	O
subject	O
to	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1	O
i	O
,	O
(	O
cid:22	O
)	O
h˜xi	O
)	O
2	O
subject	O
to	O
(	O
cid:10	O
)	O
(	O
cid:22	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1.	O
minimize	O
⇔	O
minimize	O
(	O
cid:5	O
)	O
⇔	O
minimize	O
i	O
i	O
i	O
thus	O
,	O
the	O
method	O
of	O
transformation	O
leads	O
to	O
a	O
different	O
solution	B
for	O
the	O
computed	O
transformation	O
matrix	B
.	O
this	O
is	O
a	O
rather	O
undesirable	O
feature	O
of	O
the	O
dlt	O
algorithm	B
as	O
it	O
stands	O
,	O
that	O
the	O
result	O
is	O
changed	O
by	O
a	O
change	B
of	I
coordinates	I
,	O
or	O
even	O
simply	O
a	O
change	O
of	O
the	O
origin	O
of	O
coordinates	O
.	O
if	O
the	O
constraint	O
under	O
which	O
the	O
norm	B
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
is	O
minimized	O
is	O
invariant	O
under	O
the	O
transformation	B
,	O
however	O
,	O
then	O
one	O
sees	O
that	O
the	O
computed	O
matrices	O
h	O
and	O
˜h	O
are	O
related	O
in	O
the	O
right	O
way	O
.	O
examples	B
of	O
minimization	B
conditions	O
for	O
which	O
h	O
is	O
transformation-invariant	O
are	O
discussed	O
in	O
the	O
exercises	O
at	O
the	O
end	O
of	O
this	O
chapter	O
.	O
4.4.3	O
invariance	O
of	O
geometric	B
error	I
it	O
will	O
be	O
shown	O
now	O
that	O
minimizing	B
geometric	I
error	O
to	O
ﬁnd	O
h	O
is	O
invariant	O
under	O
sim-	O
ilarity	O
(	O
scaled	O
euclidean	O
)	O
transformations	O
.	O
as	O
before	O
,	O
consider	O
a	O
point	B
correspondence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
and	O
a	O
transformation	B
matrix	O
h.	O
also	O
,	O
deﬁne	O
a	O
related	O
set	O
of	O
correspondences	O
˜x	O
↔	O
˜x	O
(	O
cid:2	O
)	O
where	O
˜x	O
=	O
tx	O
and	O
˜x	O
(	O
cid:2	O
)	O
t	O
and	O
t	O
(	O
cid:2	O
)	O
,	O
(	O
cid:22	O
)	O
h˜x	O
)	O
=	O
d	O
(	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
represent	O
euclidean	O
transformations	O
of	O
ip2	O
.	O
one	O
veriﬁes	O
that	O
,	O
t	O
(	O
cid:2	O
)	O
hx	O
)	O
=	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
,	O
and	O
let	O
(	O
cid:22	O
)	O
h	O
be	O
deﬁned	O
by	O
(	O
cid:22	O
)	O
h	O
=	O
t	O
(	O
cid:2	O
)	O
ht−1	O
.	O
suppose	O
that	O
,	O
t	O
(	O
cid:2	O
)	O
ht−1tx	O
)	O
=	O
d	O
(	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
=	O
t	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
d	O
(	O
˜x	O
(	O
cid:2	O
)	O
,	O
hx	O
)	O
where	O
the	O
last	O
equality	O
holds	O
because	O
euclidean	O
distance	O
is	O
unchanged	O
under	O
a	O
eu-	O
clidean	O
transformation	B
such	O
as	O
t	O
(	O
cid:2	O
)	O
.	O
this	O
shows	O
that	O
if	O
h	O
minimizes	O
the	O
geometric	B
error	I
for	O
a	O
set	O
of	O
correspondences	O
,	O
then	O
(	O
cid:22	O
)	O
h	O
minimizes	O
the	O
geometric	B
error	I
for	O
the	O
transformed	O
4.4	O
transformation	B
invariance	I
and	O
normalization	B
107	O
set	O
of	O
correspondences	O
,	O
and	O
so	O
minimizing	B
geometric	I
error	O
is	O
invariant	O
under	O
euclidean	O
transformations	O
.	O
for	O
similarity	O
transformations	O
,	O
geometric	B
error	I
is	O
multiplied	O
by	O
the	O
scale	O
factor	O
of	O
the	O
transformation	O
,	O
hence	O
the	O
minimizing	B
transformations	O
correspond	O
in	O
the	O
same	O
way	O
as	O
in	O
the	O
euclidean	O
transformation	O
case	O
.	O
minimizing	B
geometric	I
error	O
is	O
invariant	O
to	O
similarity	O
transformations	O
.	O
4.4.4	O
normalizing	O
transformations	O
as	O
was	O
shown	O
in	O
section	O
4.4.2	O
,	O
the	O
result	O
of	O
the	O
dlt	O
algorithm	B
for	O
computing	B
2d	O
homographies	B
depends	O
on	O
the	O
coordinate	O
frame	O
in	O
which	O
points	O
are	O
expressed	O
.	O
in	O
fact	O
the	O
result	O
is	O
not	O
invariant	O
to	O
similarity	O
transformations	B
of	I
the	O
image	O
.	O
this	O
suggests	O
the	O
question	O
whether	O
some	O
coordinate	O
systems	O
are	O
in	O
some	O
way	O
better	O
than	O
others	O
for	O
computing	O
a	O
2d	O
homography	B
.	O
the	O
answer	O
to	O
this	O
is	O
an	O
emphatic	O
yes	O
.	O
in	O
this	O
section	O
a	O
method	O
of	O
normalization	O
of	O
the	O
data	O
is	O
described	O
,	O
consisting	O
of	O
translation	O
and	O
scaling	B
of	O
image	O
coordinates	O
.	O
this	O
normalization	B
should	O
be	O
carried	O
out	O
before	O
applying	O
the	O
dlt	O
algorithm	B
.	O
subsequently	O
an	O
appropriate	O
correction	B
to	O
the	O
result	O
expresses	O
the	O
computed	O
h	O
with	O
respect	O
to	O
the	O
original	O
coordinate	O
system	O
.	O
apart	O
from	O
improved	O
accuracy	O
of	O
results	O
,	O
data	O
normalization	B
provides	O
a	O
second	O
de-	O
sirable	O
beneﬁt	O
,	O
namely	O
that	O
an	O
algorithm	B
that	O
incorporates	O
an	O
initial	O
data	O
normalization	B
step	O
will	O
be	O
invariant	O
with	O
respect	O
to	O
arbitrary	O
choices	O
of	O
the	O
scale	O
and	O
coordinate	O
ori-	O
gin	O
.	O
this	O
is	O
because	O
the	O
normalization	B
step	O
undoes	O
the	O
effect	O
of	O
coordinate	O
changes	O
,	O
by	O
effectively	O
choosing	O
a	O
canonical	O
coordinate	O
frame	O
for	O
the	O
measurement	O
data	O
.	O
thus	O
,	O
algebraic	B
minimization	I
is	O
carried	O
out	O
in	O
a	O
ﬁxed	O
canonical	O
frame	O
,	O
and	O
the	O
dlt	O
algorithm	B
is	O
in	O
practice	O
invariant	O
to	O
similarity	O
transformations	O
.	O
isotropic	B
scaling	O
.	O
as	O
a	O
ﬁrst	O
step	O
of	O
normalization	O
,	O
the	O
coordinates	B
in	O
each	O
image	O
are	O
translated	O
(	O
by	O
a	O
different	O
translation	O
for	O
each	O
image	O
)	O
so	O
as	O
to	O
bring	O
the	O
centroid	O
of	O
the	O
set	O
of	O
all	O
points	O
to	O
the	O
origin	O
.	O
the	O
coordinates	B
are	O
also	O
scaled	O
so	O
that	O
on	O
the	O
average	O
a	O
point	B
x	O
is	O
of	O
the	O
form	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
w	O
)	O
t	O
,	O
with	O
each	O
of	O
x	O
,	O
y	O
and	O
w	O
having	O
the	O
same	O
average	O
magnitude	O
.	O
rather	O
than	O
choose	O
different	O
scale	O
factors	O
for	O
each	O
coordinate	O
direction	O
,	O
an	O
isotropic	B
scaling	O
factor	O
is	O
chosen	O
so	O
that	O
the	O
x	O
and	O
y-coordinates	O
of	O
a	O
point	O
are	O
scaled	O
√	O
equally	O
.	O
to	O
this	O
end	O
,	O
we	O
choose	O
to	O
scale	O
the	O
coordinates	B
so	O
that	O
the	O
average	O
distance	B
of	O
a	O
point	B
x	O
from	O
the	O
origin	O
is	O
equal	O
to	O
2.	O
this	O
means	O
that	O
the	O
“	O
average	O
”	O
point	B
is	O
equal	O
to	O
(	O
1	O
,	O
1	O
,	O
1	O
)	O
t.	O
in	O
summary	O
the	O
transformation	B
is	O
as	O
follows	O
:	O
(	O
i	O
)	O
the	O
points	O
are	O
translated	O
so	O
that	O
their	O
centroid	O
is	O
at	O
the	O
origin	O
.	O
(	O
ii	O
)	O
the	O
points	O
are	O
then	O
scaled	O
so	O
that	O
the	O
average	O
distance	B
from	O
the	O
origin	O
is	O
equal	O
√	O
2.	O
to	O
(	O
iii	O
)	O
this	O
transformation	B
is	O
applied	O
to	O
each	O
of	O
the	O
two	O
images	O
independently	O
.	O
why	O
is	O
normalization	O
essential	O
?	O
the	O
recommended	O
version	O
of	O
the	O
dlt	O
algorithm	B
with	O
data	O
normalization	B
is	O
given	O
in	O
algorithm	O
4.2.	O
we	O
will	O
now	O
motivate	O
why	O
this	O
108	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
version	O
of	O
the	O
algorithm	O
,	O
incorporating	O
data	O
normalization	B
,	O
should	O
be	O
used	O
in	O
prefer-	O
ence	O
to	O
the	O
basic	O
dlt	O
of	O
algorithm	O
4.1	O
(	O
p91	O
)	O
.	O
note	O
that	O
normalization	B
is	O
also	O
called	O
pre-conditioning	O
in	O
the	O
numerical	O
literature	O
.	O
the	O
dlt	O
method	O
of	O
algorithm	O
4.1	O
uses	O
the	O
svd	O
of	O
a	O
=	O
udvt	O
to	O
obtain	O
a	O
solution	B
to	O
the	O
overdetermined	O
set	O
of	O
equations	O
ah	O
=	O
0.	O
these	O
equations	O
do	O
not	O
have	O
an	O
exact	O
solution	B
(	O
since	O
the	O
2n	O
×	O
9	O
matrix	B
a	O
will	O
not	O
have	O
rank	O
8	O
for	O
noisy	O
data	O
)	O
,	O
but	O
the	O
vector	O
h	O
,	O
given	O
by	O
the	O
last	O
column	O
of	O
v	O
,	O
provides	O
a	O
solution	B
which	O
minimizes	O
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
(	O
subject	O
to	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1	O
)	O
.	O
this	O
is	O
equivalent	B
to	O
ﬁnding	O
the	O
rank	O
8	O
matrix	B
ˆa	O
which	O
is	O
closest	O
to	O
a	O
in	O
frobenius	O
norm	B
and	O
obtaining	O
h	O
as	O
the	O
exact	O
solution	B
of	O
ˆah	O
=	O
0.	O
the	O
matrix	B
ˆa	O
is	O
given	O
by	O
ˆa	O
=	O
uˆdvt	O
where	O
ˆd	O
is	O
d	O
with	O
the	O
smallest	O
singular	O
value	O
set	O
to	O
zero	O
.	O
the	O
matrix	B
ˆa	O
has	O
rank	O
8	O
and	O
minimizes	O
the	O
difference	O
to	O
a	O
in	O
frobenius	O
norm	B
because	O
(	O
cid:10	O
)	O
a	O
−	O
ˆa	O
(	O
cid:10	O
)	O
f	O
=	O
(	O
cid:10	O
)	O
udvt	O
−	O
uˆdvt	O
(	O
cid:10	O
)	O
f	O
=	O
(	O
cid:10	O
)	O
d	O
−	O
ˆd	O
(	O
cid:10	O
)	O
f.	O
where	O
(	O
cid:10	O
)	O
.	O
(	O
cid:10	O
)	O
f	O
is	O
the	O
frobenius	O
norm	B
,	O
i.e	O
.	O
the	O
square	O
root	O
of	O
the	O
sum	O
of	O
squares	O
of	O
all	O
entries	O
.	O
without	O
normalization	B
typical	O
image	O
points	O
xi	O
,	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
of	O
the	O
order	O
(	O
x	O
,	O
y	O
,	O
w	O
)	O
t	O
=	O
(	O
100	O
,	O
100	O
,	O
1	O
)	O
t	O
,	O
i.e.	O
,	O
x	O
,	O
y	O
are	O
much	O
larger	O
than	O
w.	O
in	O
a	O
the	O
entries	O
xx	O
will	O
,	O
xy	O
(	O
cid:2	O
)	O
be	O
of	O
order	O
104	O
,	O
entries	O
xw	O
etc	O
.	O
of	O
order	O
102	O
,	O
and	O
entries	O
ww	O
will	O
be	O
unity	O
.	O
re-	O
placing	O
a	O
by	O
ˆa	O
means	O
that	O
some	O
entries	O
are	O
increased	O
and	O
others	O
decreased	O
such	O
that	O
the	O
square	O
sum	O
of	O
differences	O
of	O
these	O
changes	O
is	O
minimal	O
(	O
and	O
the	O
resulting	O
matrix	B
has	O
rank	O
8	O
)	O
.	O
however	O
,	O
and	O
this	O
is	O
the	O
key	O
point	B
,	O
increasing	O
the	O
term	O
ww	O
by	O
100	O
means	O
a	O
huge	O
change	O
in	O
the	O
image	O
points	O
,	O
whereas	O
increasing	O
the	O
term	O
xx	O
by	O
100	O
means	O
only	O
a	O
slight	O
change	O
.	O
this	O
is	O
the	O
reason	O
why	O
all	O
entries	O
in	O
a	O
must	O
have	O
similar	O
magnitude	O
and	O
why	O
normalization	O
is	O
essential	O
.	O
,	O
yw	O
(	O
cid:2	O
)	O
,	O
yx	O
,	O
yy	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
effect	O
of	O
normalization	O
is	O
related	O
to	O
the	O
condition	B
number	I
of	O
the	O
set	O
of	O
dlt	O
equa-	O
tions	O
,	O
or	O
more	O
precisely	O
the	O
ratio	O
d1/dn−1	O
of	O
the	O
ﬁrst	O
to	O
the	O
second-last	O
singular	O
value	O
of	O
the	O
equation	O
matrix	B
a.	O
this	O
point	B
is	O
investigated	O
in	O
more	O
detail	O
in	O
[	O
hartley-97c	O
]	O
.	O
for	O
the	O
present	O
it	O
is	O
sufﬁcient	O
to	O
say	O
that	O
for	O
exact	O
data	O
and	O
inﬁnite	O
precision	O
arithmetic	O
the	O
results	O
will	O
be	O
independent	O
of	O
the	O
normalizing	O
transformation	B
.	O
however	O
,	O
in	O
the	O
pres-	O
ence	O
of	O
noise	O
the	O
solution	B
will	O
diverge	O
from	O
the	O
correct	O
result	O
.	O
the	O
effect	O
of	O
a	O
large	O
condition	B
number	I
is	O
to	O
amplify	O
this	O
divergence	O
.	O
this	O
is	O
true	O
even	O
for	O
inﬁnite-precision	O
arithmetic	O
–	O
this	O
is	O
not	O
a	O
round-off	O
error	B
effect	O
.	O
the	O
effect	O
that	O
this	O
data	O
normalization	B
has	O
on	O
the	O
results	O
of	O
the	O
dlt	O
algorithm	B
is	O
shown	O
graphically	O
in	O
ﬁgure	O
4.4.	O
the	O
conclusion	O
to	O
be	O
drawn	O
here	O
is	O
that	O
data	O
normal-	O
ization	O
gives	O
dramatically	O
better	O
results	O
.	O
the	O
examples	B
shown	O
in	O
the	O
ﬁgure	O
are	O
chosen	O
to	O
make	O
the	O
effect	O
easily	O
visible	O
.	O
however	O
,	O
a	O
marked	O
advantage	O
remains	O
even	O
in	O
cases	O
of	O
computation	O
from	O
larger	O
numbers	O
of	O
point	O
correspondences	B
,	O
with	O
points	O
more	O
widely	O
distributed	O
.	O
to	O
emphasize	O
this	O
point	B
we	O
remark	O
:	O
•	O
data	O
normalization	B
is	O
an	O
essential	O
step	O
in	O
the	O
dlt	O
algorithm	B
.	O
it	O
must	O
not	O
be	O
consid-	O
ered	O
optional	O
.	O
data	O
normalization	B
becomes	O
even	O
more	O
important	O
for	O
less	O
well	O
conditioned	O
problems	O
,	O
such	O
as	O
the	O
dlt	O
computation	B
of	I
the	O
fundamental	B
matrix	I
or	O
the	O
trifocal	B
tensor	I
,	O
which	O
will	O
be	O
considered	O
in	O
later	O
chapters	O
.	O
4.4	O
transformation	B
invariance	I
and	O
normalization	B
109	O
objective	O
given	O
n	O
≥	O
4	O
2d	O
to	O
2d	O
point	B
correspondences	O
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
matrix	B
h	O
such	O
that	O
x	O
(	O
cid:1	O
)	O
algorithm	B
i	O
=	O
hxi	O
.	O
i	O
}	O
,	O
determine	O
the	O
2d	O
homography	B
(	O
i	O
)	O
normalization	B
of	O
x	O
:	O
compute	O
a	O
similarity	B
transformation	I
t	O
,	O
consisting	O
of	O
a	O
translation	O
and	O
scaling	B
,	O
that	O
takes	O
points	O
xi	O
to	O
a	O
new	O
set	O
of	B
points	I
˜xi	O
such	O
that	O
the	O
centroid	O
of	O
the	O
√	O
points	O
˜xi	O
is	O
the	O
coordinate	O
origin	O
(	O
0	O
,	O
0	O
)	O
t	O
,	O
and	O
their	O
average	O
distance	B
from	O
the	O
origin	O
is	O
2.	O
image	O
,	O
transforming	O
points	O
x	O
(	O
cid:1	O
)	O
(	O
ii	O
)	O
normalization	B
of	O
x	O
(	O
cid:1	O
)	O
(	O
iii	O
)	O
dlt	O
:	O
apply	O
algorithm	B
4.1	O
(	O
p91	O
)	O
to	O
the	O
correspondences	B
˜xi	O
↔	O
˜x	O
(	O
cid:1	O
)	O
:	O
compute	O
a	O
similar	O
transformation	B
t	O
(	O
cid:1	O
)	O
for	O
the	O
points	O
in	O
the	O
second	O
phy	O
(	O
cid:22	O
)	O
h.	O
(	O
iv	O
)	O
denormalization	O
:	O
set	O
h	O
=	O
t	O
(	O
cid:1	O
)	O
−1	O
(	O
cid:22	O
)	O
ht	O
.	O
i	O
to	O
˜x	O
(	O
cid:1	O
)	O
i.	O
i	O
to	O
obtain	O
a	O
homogra-	O
algorithm	B
4.2.	O
the	O
normalized	O
dlt	O
for	O
2d	O
homographies	O
.	O
a	O
b	O
fig	O
.	O
4.4.	O
results	O
of	O
monte	O
carlo	O
simulation	O
(	O
see	O
section	O
5.3	O
(	O
p149	O
)	O
of	O
computation	O
of	O
2d	O
homographies	B
)	O
.	O
a	O
set	O
of	O
5	O
points	O
(	O
denoted	O
by	O
large	O
crosses	O
)	O
was	O
used	O
to	O
compute	O
a	O
2d	O
homography	B
.	O
each	O
of	O
the	O
5	O
points	O
is	O
mapped	O
(	O
in	O
the	O
noise-free	O
case	O
)	O
to	O
the	O
point	B
with	O
the	O
same	O
coordinates	O
,	O
so	O
that	O
homography	B
h	O
is	O
the	O
identity	O
mapping	O
.	O
now	O
,	O
100	O
trials	O
were	O
made	O
with	O
each	O
point	B
being	O
subject	O
to	O
0.1	O
pixel	O
gaussian	O
noise	B
in	O
one	O
image	O
.	O
(	O
for	O
reference	O
,	O
the	O
large	O
crosses	O
are	O
4	O
pixels	O
across	O
.	O
)	O
the	O
mapping	O
h	O
computed	O
using	O
the	O
dlt	O
algorithm	B
was	O
then	O
applied	O
to	O
transfer	O
a	O
further	O
point	B
into	O
the	O
second	O
image	O
.	O
the	O
100	O
projections	O
of	O
this	O
point	B
are	O
shown	O
with	O
small	O
crosses	O
and	O
the	O
95	O
%	O
ellipse	O
computed	O
from	O
their	O
scatter	O
matrix	B
is	O
also	O
shown	O
.	O
(	O
a	O
)	O
are	O
the	O
results	O
without	O
data	O
normalization	B
,	O
and	O
(	O
b	O
)	O
the	O
results	O
with	O
normalization	B
.	O
the	O
left-	O
and	O
rightmost	O
reference	O
points	O
have	O
(	O
unnormalized	O
)	O
coordinates	B
(	O
130	O
,	O
108	O
)	O
and	O
(	O
170	O
,	O
108	O
)	O
.	O
non-isotropic	B
scaling	I
.	O
other	O
methods	O
of	O
scaling	O
are	O
also	O
possible	O
.	O
in	O
non-isotropic	O
scaling	B
,	O
the	O
centroid	O
of	O
the	O
points	O
is	O
translated	O
to	O
the	O
origin	O
as	O
before	O
.	O
after	O
this	O
trans-	O
lation	O
the	O
points	O
form	O
a	O
cloud	O
about	O
the	O
origin	O
.	O
scaling	B
is	O
then	O
carried	O
out	O
so	O
that	O
the	O
two	O
principal	O
moments	O
of	O
the	O
set	O
of	B
points	I
are	O
both	O
equal	O
to	O
unity	O
.	O
thus	O
,	O
the	O
set	O
of	B
points	I
will	O
form	O
an	O
approximately	O
symmetric	B
circular	O
cloud	O
of	B
points	I
of	O
radius	O
1	O
about	O
the	O
origin	O
.	O
experimental	O
results	O
given	O
in	O
[	O
hartley-97c	O
]	O
suggest	O
that	O
the	O
extra	O
ef-	O
fort	O
required	O
for	O
non-isotropic	O
scaling	B
does	O
not	O
lead	O
to	O
signiﬁcantly	O
better	O
results	O
than	O
isotropic	B
scaling	O
.	O
a	O
further	O
variant	O
on	O
scaling	O
was	O
discussed	O
in	O
[	O
muehlich-98	O
]	O
,	O
based	O
on	O
a	O
statistical	O
analysis	O
of	O
the	O
estimator	O
,	O
its	O
bias	B
and	O
variance	B
.	O
in	O
that	O
paper	O
it	O
was	O
observed	O
that	O
some	O
columns	O
of	O
a	O
are	O
not	O
affected	O
by	O
noise	B
.	O
this	O
applies	O
to	O
the	O
third	O
and	O
sixth	O
columns	O
in	O
(	O
cid:2	O
)	O
i	O
=	O
1.	O
such	O
error-free	O
entries	O
in	O
a	O
should	O
not	O
(	O
4.3–p89	O
)	O
,	O
corresponding	O
to	O
the	O
entry	O
wiw	O
be	O
varied	O
in	O
ﬁnding	O
ˆa	O
,	O
the	O
closest	O
rank-deﬁcient	O
approximation	O
to	O
a.	O
a	O
method	O
known	O
110	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
as	O
total	O
least	B
squares	I
-	O
fixed	O
columns	O
is	O
used	O
to	O
ﬁnd	O
the	O
best	O
solution	B
.	O
for	O
estimation	O
of	O
the	O
fundamental	O
matrix	B
(	O
see	O
chapter	O
11	O
)	O
,	O
[	O
muehlich-98	O
]	O
reports	O
slightly	O
improved	O
results	O
compared	O
with	O
non-isotropic	O
scaling	B
.	O
scaling	B
with	O
points	O
near	O
inﬁnity	O
.	O
consider	O
the	O
case	O
of	B
estimation	I
of	O
a	O
homography	B
between	O
an	O
inﬁnite	O
plane	O
and	O
an	O
image	O
.	O
if	O
the	O
viewing	O
direction	O
is	O
sufﬁciently	O
oblique	O
,	O
then	O
very	O
distant	O
points	O
in	O
the	O
plane	B
may	O
be	O
visible	O
in	O
the	O
image	O
–	O
even	O
points	O
at	O
inﬁnity	O
(	O
vanishing	B
points	I
)	O
if	O
the	O
horizon	O
is	O
visible	O
.	O
in	O
this	O
case	O
it	O
makes	O
no	O
sense	O
to	O
normal-	O
ize	O
the	O
coordinates	B
of	O
points	O
in	O
the	O
inﬁnite	O
plane	O
by	O
setting	O
the	O
centroid	O
at	O
the	O
origin	O
,	O
since	O
the	O
centroid	O
may	O
have	O
very	O
large	O
coordinates	B
,	O
or	O
be	O
undeﬁned	O
.	O
an	O
approach	O
to	O
normalization	O
in	O
this	O
case	O
is	O
considered	O
in	O
exercise	O
(	O
iii	O
)	O
on	O
page	O
128	O
.	O
4.5	O
iterative	B
minimization	I
methods	O
this	O
section	O
describes	O
methods	O
for	O
minimizing	O
the	O
various	O
geometric	B
cost	O
functions	O
developed	O
in	O
section	O
4.2	O
and	O
section	O
4.3.	O
minimizing	B
such	O
cost	B
functions	I
requires	O
the	O
use	O
of	O
iterative	B
techniques	O
.	O
this	O
is	O
unfortunate	O
,	O
because	O
iterative	B
techniques	O
tend	O
to	O
have	O
certain	O
disadvantages	O
compared	O
to	O
linear	O
algorithms	O
such	O
as	O
the	O
normalized	O
dlt	O
algorithm	B
4.2	O
:	O
(	O
i	O
)	O
they	O
are	O
slower	O
.	O
(	O
ii	O
)	O
they	O
generally	O
need	O
an	O
initial	O
estimate	O
at	O
which	O
to	O
start	O
the	O
iteration	B
.	O
(	O
iii	O
)	O
they	O
risk	O
not	O
converging	O
,	O
or	O
converging	O
to	O
a	O
local	O
minimum	O
instead	O
of	O
the	O
global	O
minimum	O
.	O
(	O
iv	O
)	O
selection	O
of	O
a	O
stopping	O
criterion	O
for	O
iteration	O
may	O
be	O
tricky	O
.	O
consequently	O
,	O
iterative	B
techniques	O
generally	O
require	O
more	O
careful	O
implementation	B
.	O
the	O
technique	O
of	O
iterative	O
minimization	B
generally	O
consists	O
of	O
ﬁve	O
steps	O
:	O
(	O
i	O
)	O
cost	B
function	I
.	O
a	O
cost	B
function	I
is	O
chosen	O
as	O
the	O
basis	O
for	O
minimization	O
.	O
dif-	O
ferent	O
possible	O
cost	B
functions	I
were	O
discussed	O
in	O
section	O
4.2	O
.	O
(	O
ii	O
)	O
parametrization	B
.	O
the	O
transformation	B
(	O
or	O
other	O
entity	O
)	O
to	O
be	O
computed	O
is	O
ex-	O
pressed	O
in	O
terms	O
of	O
a	O
ﬁnite	O
number	O
of	O
parameters	O
.	O
it	O
is	O
not	O
in	O
general	O
necessary	O
that	O
this	O
be	O
a	O
minimum	O
set	O
of	O
parameters	O
,	O
and	O
there	O
are	O
in	O
fact	O
often	O
advantages	O
to	O
over-parametrization	O
.	O
(	O
see	O
the	O
discussion	O
below	O
.	O
)	O
(	O
iii	O
)	O
function	B
speciﬁcation	I
.	O
a	O
function	O
must	O
be	O
speciﬁed	O
that	O
expresses	O
the	O
cost	O
in	O
terms	O
of	O
the	O
set	O
of	O
parameters	O
.	O
(	O
iv	O
)	O
initialization	B
.	O
a	O
suitable	O
initial	O
parameter	O
estimate	O
is	O
computed	O
.	O
this	O
will	O
generally	O
be	O
done	O
using	O
a	O
linear	B
algorithm	I
such	O
as	O
the	O
dlt	O
algorithm	B
.	O
(	O
v	O
)	O
iteration	B
.	O
starting	O
from	O
the	O
initial	B
solution	I
,	O
the	O
parameters	B
are	O
iteratively	O
reﬁned	O
with	O
the	O
goal	O
of	O
minimizing	O
the	O
cost	B
function	I
.	O
a	O
word	O
about	O
parametrization	B
for	O
a	O
given	O
cost	B
function	I
,	O
there	O
are	O
often	O
several	O
choices	O
of	O
parametrization	O
.	O
the	O
gen-	O
eral	O
strategy	O
that	O
guides	O
parametrization	B
is	O
to	O
select	O
a	O
set	O
of	O
parameters	O
that	O
cover	O
the	O
complete	O
space	O
over	O
which	O
one	O
is	O
minimizing	B
,	O
while	O
at	O
the	O
same	O
time	O
allowing	O
one	O
to	O
4.5	O
iterative	B
minimization	I
methods	O
111	O
compute	O
the	O
cost	B
function	I
in	O
a	O
convenient	O
manner	O
.	O
for	O
example	O
,	O
h	O
may	O
be	O
parametrized	O
by	O
9	O
parameters	B
–	O
that	O
is	O
,	O
it	O
is	O
over-parametrized	O
,	O
since	O
there	O
are	O
really	O
only	O
8	O
degrees	B
of	I
freedom	I
,	O
overall	O
scale	O
not	O
being	O
signiﬁcant	O
.	O
a	O
minimal	O
parametrization	O
(	O
i.e	O
.	O
the	O
same	O
number	O
of	O
parameters	O
as	O
degrees	O
of	O
freedom	O
)	O
would	O
involve	O
only	O
8	O
parameters	B
.	O
in	O
general	O
no	O
bad	O
effects	O
are	O
likely	O
to	O
occur	O
if	O
a	O
minimization	B
problem	O
of	O
this	O
type	O
is	O
over-parametrized	O
,	O
as	O
long	O
as	O
for	O
all	O
choices	O
of	O
parameters	O
the	O
corresponding	O
object	O
is	O
of	O
the	O
desired	O
type	O
.	O
in	O
particular	O
for	O
homogeneous	O
objects	O
,	O
such	O
as	O
the	O
3×	O
3	O
projection	B
matrix	O
encountered	O
here	O
,	O
it	O
is	O
usually	O
not	O
necessary	O
or	O
advisable	O
to	O
attempt	O
to	O
use	O
a	O
minimal	O
parametrization	O
by	O
removing	O
the	O
scale-factor	O
ambiguity	B
.	O
the	O
reasoning	O
is	O
the	O
following	O
:	O
it	O
is	O
not	O
necessary	O
to	O
use	O
minimal	O
parametrization	O
because	O
a	O
well-performing	O
non-linear	B
minimization	O
algorithm	B
will	O
“	O
notice	O
”	O
that	O
it	O
is	O
not	O
necessary	O
to	O
move	O
in	O
redundant	O
directions	O
,	O
such	O
as	O
the	O
matrix	B
scaling	O
direction	O
.	O
the	O
algorithm	B
described	O
in	O
gill	O
and	O
murray	O
[	O
gill-78	O
]	O
,	O
which	O
is	O
a	O
modiﬁcation	O
of	O
the	O
gauss–newton	O
method	O
,	O
has	O
an	O
effective	O
strategy	O
for	O
discarding	O
redundant	O
combina-	O
tions	O
of	O
the	O
parameters	O
.	O
similarly	O
,	O
the	O
levenberg-marquardt	O
algorithm	B
(	O
see	O
section	O
a6.2	O
(	O
p600	O
)	O
)	O
handles	O
redundant	O
parametrizations	O
easily	O
.	O
it	O
is	O
not	O
advisable	O
because	O
it	O
is	O
found	O
empirically	O
that	O
the	O
cost	B
function	I
surface	O
is	O
more	O
complicated	O
when	O
minimal	O
parametrizations	O
are	O
used	O
.	O
there	O
is	O
then	O
a	O
greater	O
possibility	O
of	O
becoming	O
stuck	O
in	O
a	O
local	O
minimum	O
.	O
one	O
other	O
issue	O
that	O
arises	O
in	O
choosing	O
a	O
parametrization	B
is	O
that	O
of	O
restricting	O
the	O
transformation	B
to	O
a	O
particular	O
class	O
.	O
for	O
example	O
,	O
suppose	O
h	O
is	O
known	O
to	O
be	O
a	O
homology	B
,	O
then	O
as	O
described	O
in	O
section	O
a7.2	O
(	O
p629	O
)	O
it	O
may	O
be	O
parametrized	O
as	O
h	O
=	O
i	O
+	O
(	O
µ	O
−	O
1	O
)	O
vat	O
vta	O
where	O
µ	O
is	O
a	O
scalar	O
,	O
and	O
v	O
and	O
a	O
3-vectors	O
.	O
a	O
homology	B
has	O
5	O
degrees	B
of	I
freedom	I
which	O
correspond	O
here	O
to	O
the	O
scalar	O
µ	O
and	O
the	O
directions	O
of	O
v	O
and	O
a.	O
if	O
h	O
is	O
parametrized	O
by	O
its	O
9	O
matrix	B
entries	O
,	O
then	O
the	O
estimated	O
h	O
is	O
unlikely	O
to	O
exactly	O
be	O
a	O
homology	B
.	O
however	O
,	O
if	O
h	O
is	O
parametrized	O
by	O
µ	O
,	O
v	O
and	O
a	O
(	O
a	O
total	O
of	O
7	O
parameters	B
)	O
then	O
the	O
estimated	O
h	O
is	O
guaranteed	O
to	O
be	O
a	O
homology	B
.	O
this	O
parametrization	B
is	O
consistent	O
with	O
a	O
homology	B
(	O
it	O
is	O
also	O
an	O
over-parametrization	B
)	O
.	O
we	O
will	O
return	O
to	O
the	O
issues	O
of	O
consistent	O
,	O
local	O
,	O
minimal	O
and	O
over-parametrization	B
in	O
later	O
chapters	O
.	O
the	O
issues	O
are	O
also	O
discussed	O
further	O
in	O
appendix	O
a6.9	O
(	O
p623	O
)	O
.	O
function	B
speciﬁcation	I
it	O
has	O
been	O
seen	O
in	O
section	O
4.2.7	O
that	O
a	O
general	O
class	O
of	B
estimation	I
problems	O
is	O
concerned	O
with	O
a	O
measurement	O
space	O
irn	O
containing	O
a	O
model	B
surface	O
s.	O
given	O
a	O
measurement	O
x	O
∈	O
irn	O
the	O
estimation	B
task	O
is	O
to	O
ﬁnd	O
the	O
point	B
(	O
cid:23	O
)	O
x	O
lying	O
on	O
s	O
closest	O
to	O
x.	O
in	O
the	O
case	O
where	O
a	O
non-isotropic	B
gaussian	O
error	B
distribution	O
is	O
imposed	O
on	O
irn	O
,	O
the	O
word	O
closest	O
is	O
to	O
be	O
interpreted	O
in	O
terms	O
of	O
mahalanobis	O
distance	B
.	O
iterative	B
minimization	I
methods	O
will	O
now	O
be	O
described	O
in	O
terms	O
of	O
this	O
estimation	B
model	O
.	O
in	O
iterative	O
estimation	B
through	O
parameter	O
ﬁtting	O
,	O
the	O
model	B
surface	O
s	O
is	O
locally	O
parametrized	O
,	O
and	O
the	O
parameters	B
are	O
allowed	O
to	O
vary	O
to	O
minimize	O
the	O
distance	B
to	O
the	O
measured	O
point	B
.	O
more	O
speciﬁcally	O
,	O
(	O
i	O
)	O
one	O
has	O
a	O
measurement	O
vector	O
x	O
∈	O
irn	O
with	O
covariance	O
matrix	B
σ	O
.	O
112	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
(	O
ii	O
)	O
a	O
set	O
of	O
parameters	O
are	O
represented	O
as	O
a	O
vector	O
p	O
∈	O
irm	O
.	O
(	O
iii	O
)	O
a	O
mapping	O
f	O
:	O
irm	O
→	O
irn	O
is	O
deﬁned	O
.	O
the	O
range	O
of	O
this	O
mapping	O
is	O
(	O
at	O
least	O
locally	O
)	O
the	O
model	B
surface	O
s	O
in	O
irn	O
representing	O
the	O
set	O
of	O
allowable	O
measure-	O
ments	O
.	O
(	O
iv	O
)	O
the	O
cost	B
function	I
to	O
be	O
minimized	O
is	O
the	O
squared	O
mahalanobis	O
distance	B
(	O
cid:10	O
)	O
x	O
−	O
f	O
(	O
p	O
)	O
(	O
cid:10	O
)	O
2	O
σ	O
=	O
(	O
x	O
−	O
f	O
(	O
p	O
)	O
)	O
tς−1	O
(	O
x	O
−	O
f	O
(	O
p	O
)	O
)	O
.	O
in	O
effect	O
,	O
we	O
are	O
attempting	O
to	O
ﬁnd	O
a	O
set	O
of	O
parameters	O
p	O
such	O
that	O
f	O
(	O
p	O
)	O
=	O
x	O
,	O
or	O
fail-	O
ing	O
that	O
,	O
to	O
bring	O
f	O
(	O
p	O
)	O
as	O
close	O
to	O
x	O
as	O
possible	O
,	O
with	O
respect	O
to	O
mahalanobis	O
distance	B
.	O
the	O
levenberg–marquardt	O
algorithm	B
is	O
a	O
general	O
tool	O
for	O
iterative	O
minimization	B
,	O
when	O
the	O
cost	B
function	I
to	O
be	O
minimized	O
is	O
of	O
this	O
type	O
.	O
we	O
will	O
now	O
show	O
how	O
the	O
various	O
different	O
types	O
of	O
cost	O
functions	O
described	O
in	O
this	O
chapter	O
ﬁt	O
into	O
this	O
format	O
.	O
error	B
in	I
one	I
image	I
.	O
here	O
one	O
ﬁxes	O
the	O
coordinates	B
of	O
points	O
xi	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
varies	O
h	O
so	O
as	O
to	O
minimize	O
cost	B
function	I
(	O
4.6–p94	O
)	O
,	O
namely	O
(	O
cid:7	O
)	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
h¯xi	O
)	O
2.	O
i	O
the	O
measurement	O
vector	O
x	O
is	O
made	O
up	O
of	O
the	O
2n	O
inhomogeneous	O
coordinates	O
of	O
the	O
points	O
x	O
(	O
cid:2	O
)	O
i.	O
one	O
may	O
choose	O
as	B
parameters	I
the	O
vector	O
h	O
of	O
entries	O
of	O
the	O
homography	O
matrix	B
h.	O
the	O
function	O
f	O
is	O
deﬁned	O
by	O
f	O
:	O
h	O
(	O
cid:6	O
)	O
→	O
(	O
hx1	O
,	O
hx2	O
,	O
.	O
.	O
.	O
,	O
h	O
xn	O
)	O
where	O
it	O
is	O
understood	O
that	O
here	O
,	O
and	O
in	O
the	O
functions	O
below	O
,	O
hxi	O
indicates	O
the	O
inhomo-	O
geneous	O
coordinates	B
.	O
one	O
veriﬁes	O
that	O
(	O
cid:10	O
)	O
x	O
−	O
f	O
(	O
h	O
)	O
(	O
cid:10	O
)	O
2	O
is	O
equal	O
to	O
(	O
4.6–p94	O
)	O
.	O
symmetric	B
transfer	I
error	I
.	O
(	O
cid:7	O
)	O
in	O
the	O
case	O
of	O
the	O
symmetric	O
cost	B
function	I
(	O
4.7–p95	O
)	O
d	O
(	O
xi	O
,	O
h−1x	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
hxi	O
)	O
2	O
i	O
one	O
chooses	O
as	O
measurement	O
vector	O
x	O
the	O
4n-vector	O
made	O
up	O
of	O
the	O
inhomogeneous	O
coordinates	B
of	O
the	O
points	O
xi	O
followed	O
by	O
the	O
inhomogeneous	O
coordinates	O
of	O
the	O
points	O
x	O
(	O
cid:2	O
)	O
i.	O
the	O
parameter	O
vector	O
as	O
before	O
is	O
the	O
vector	O
h	O
of	O
entries	O
of	O
h	O
,	O
and	O
the	O
function	O
f	O
is	O
deﬁned	O
by	O
f	O
:	O
h	O
(	O
cid:6	O
)	O
→	O
(	O
h−1x	O
(	O
cid:2	O
)	O
1	O
,	O
.	O
.	O
.	O
,	O
h	O
−1x	O
(	O
cid:2	O
)	O
n	O
,	O
hx1	O
,	O
.	O
.	O
.	O
,	O
h	O
xn	O
)	O
.	O
as	O
before	O
,	O
we	O
ﬁnd	O
that	O
(	O
cid:10	O
)	O
x	O
−	O
f	O
(	O
h	O
)	O
(	O
cid:10	O
)	O
2	O
is	O
equal	O
to	O
(	O
4.7–p95	O
)	O
.	O
reprojection	B
error	I
.	O
minimizing	B
the	I
cost	I
function	I
(	O
4.8–p95	O
)	O
is	O
more	O
complex	O
.	O
the	O
difﬁculty	O
is	O
that	O
it	O
requires	O
a	O
simultaneous	O
minimization	B
over	O
all	O
choices	O
of	B
points	I
ˆxi	O
as	O
well	O
as	O
the	O
entries	O
of	O
the	O
transformation	O
matrix	B
h.	O
if	O
there	O
are	O
many	O
point	B
corre-	O
spondences	O
,	O
then	O
this	O
becomes	O
a	O
very	O
large	O
minimization	B
problem	O
.	O
thus	O
,	O
the	O
problem	O
may	O
be	O
parametrized	O
by	O
the	O
coordinates	B
of	O
the	O
points	O
ˆxi	O
and	O
the	O
entries	O
of	O
the	O
matrix	O
ˆh	O
–	O
a	O
total	O
of	O
2n	O
+	O
9	O
parameters	B
.	O
the	O
coordinates	B
of	O
ˆx	O
(	O
cid:2	O
)	O
i	O
are	O
not	O
required	O
,	O
since	O
they	O
are	O
related	O
to	O
the	O
other	O
parameters	B
by	O
ˆx	O
(	O
cid:2	O
)	O
i	O
=	O
ˆhˆxi	O
.	O
the	O
parameter	O
vector	O
is	O
therefore	O
113	O
p	O
=	O
(	O
h	O
,	O
ˆx1	O
,	O
.	O
.	O
.	O
,	O
ˆxn	O
)	O
.	O
the	O
measurement	O
vector	O
contains	O
the	O
inhomogeneous	O
coordi-	O
nates	O
of	O
all	O
the	O
points	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
4.5	O
iterative	B
minimization	I
methods	O
i.	O
the	O
function	O
f	O
is	O
deﬁned	O
by	O
1	O
,	O
.	O
.	O
.	O
,	O
ˆxn	O
,	O
ˆx	O
(	O
cid:2	O
)	O
n	O
)	O
f	O
:	O
(	O
h	O
,	O
ˆx1	O
,	O
.	O
.	O
.	O
,	O
ˆxn	O
)	O
(	O
cid:6	O
)	O
→	O
(	O
ˆx1	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
=	O
hˆxi	O
.	O
one	O
veriﬁes	O
that	O
(	O
cid:10	O
)	O
x−	O
f	O
(	O
p	O
)	O
(	O
cid:10	O
)	O
2	O
,	O
with	O
x	O
a	O
4n-vector	O
,	O
is	O
equal	O
to	O
the	O
cost	O
where	O
ˆx	O
(	O
cid:2	O
)	O
function	O
(	O
4.8–p95	O
)	O
.	O
this	O
cost	B
function	I
must	O
be	O
minimized	O
over	O
all	O
2n	O
+	O
9	O
parameters	B
.	O
sampson	O
approximation	O
.	O
in	O
contrast	O
with	O
2n	O
+	O
9	O
parameters	B
of	O
reprojection	B
error	I
,	O
minimizing	O
the	O
error	O
in	B
one	I
image	I
(	O
4.6–p94	O
)	O
or	O
symmetric	B
transfer	I
error	I
(	O
4.7–p95	O
)	O
requires	O
a	O
minimization	B
over	O
the	O
9	O
entries	O
of	O
the	O
matrix	O
h	O
only	O
–	O
in	O
general	O
a	O
more	O
tractable	O
problem	O
.	O
the	O
sampson	O
approximation	O
to	O
reprojection	O
error	B
enables	O
reprojec-	O
tion	O
error	B
also	O
to	O
be	O
minimized	O
with	O
only	O
9	O
parameters	B
.	O
this	O
is	O
an	O
important	O
consideration	O
,	O
since	O
the	O
iterative	B
solution	O
of	O
an	O
m-parameter	O
non-linear	B
minimization	O
problem	O
using	O
a	O
method	O
such	O
as	O
levenberg–marquardt	O
in-	O
volves	O
the	O
solution	B
of	O
an	O
m	O
×	O
m	O
set	O
of	O
linear	O
equations	O
at	O
each	O
iteration	B
step	O
.	O
this	O
is	O
a	O
problem	O
with	O
complexity	O
o	O
(	O
m3	O
)	O
.	O
hence	O
,	O
it	O
is	O
appropriate	O
to	O
keep	O
the	O
size	O
of	O
m	O
low	O
.	O
the	O
sampson	O
error	B
avoids	O
minimizing	B
over	O
the	O
2n	O
+	O
9	O
parameters	B
of	O
reprojection	B
er-	O
ror	O
because	O
effectively	O
it	O
determines	O
the	O
2n	O
variables	O
{	O
ˆxi	O
}	O
for	O
each	O
particular	O
choice	B
of	O
h.	O
consequently	O
the	O
minimization	B
then	O
only	O
requires	O
the	O
9	O
parameters	B
of	O
h.	O
in	O
prac-	O
tice	O
this	O
approximation	O
gives	O
excellent	O
results	O
provided	O
the	O
errors	O
are	O
small	O
compared	O
to	O
the	O
measurements	O
.	O
initialization	B
an	O
initial	O
estimate	O
for	O
the	O
parametrization	B
may	O
be	O
found	O
by	O
employing	O
a	O
linear	B
tech-	O
nique	O
.	O
for	O
example	O
,	O
the	O
normalized	O
dlt	O
algorithm	B
4.2	O
directly	O
provides	O
h	O
and	O
thence	O
the	O
9-vector	O
h	O
used	O
to	O
parametrize	O
the	O
iterative	B
minimization	I
.	O
in	O
general	O
if	O
there	O
are	O
n	O
≥	O
4	O
correspondences	B
,	O
then	O
all	O
will	O
be	O
used	O
in	O
the	O
linear	B
solution	I
.	O
however	O
,	O
as	O
will	O
be	O
seen	O
in	O
section	O
4.7	O
on	O
robust	O
estimation	B
,	O
when	O
the	O
correspondences	B
contain	O
outliers	O
it	O
may	O
be	O
advisable	O
to	O
use	O
a	O
carefully	O
selected	O
minimal	O
set	O
of	O
correspondences	O
(	O
i.e	O
.	O
four	O
correspondences	O
)	O
.	O
linear	B
techniques	O
or	O
minimal	O
solutions	O
are	O
the	O
two	O
initialization	O
techniques	O
recommended	O
in	O
this	O
book	O
.	O
an	O
alternative	O
method	O
that	O
is	O
sometimes	O
used	O
(	O
for	O
instance	O
see	O
[	O
horn-90	O
,	O
horn-91	O
]	O
)	O
is	O
to	O
carry	O
out	O
a	O
sufﬁciently	O
dense	O
sampling	O
of	O
parameter	O
space	O
,	O
iterating	O
from	O
each	O
sampled	O
starting	O
point	O
and	O
retaining	O
the	O
best	O
result	O
.	O
this	O
is	O
only	O
possible	O
if	O
the	O
dimen-	O
sion	O
of	O
the	O
parameter	O
space	O
is	O
sufﬁciently	O
small	O
.	O
sampling	O
of	O
parameter	O
space	O
may	O
be	O
done	O
either	O
randomly	O
,	O
or	O
else	O
according	O
to	O
some	O
pattern	O
.	O
another	O
initialization	B
method	O
is	O
simply	O
to	O
do	O
without	O
any	O
effective	O
initialization	B
at	O
all	O
,	O
starting	O
the	O
iteration	B
at	O
a	O
given	O
ﬁxed	O
point	O
in	O
parameter	O
space	O
.	O
this	O
method	O
is	O
not	O
often	O
viable	O
.	O
iteration	B
is	O
very	O
likely	O
to	O
fall	O
into	O
a	O
false	O
minimum	O
or	O
not	O
converge	O
.	O
even	O
in	O
the	O
best	O
case	O
,	O
the	O
number	O
of	O
iteration	O
steps	O
required	O
will	O
increase	O
the	O
further	O
one	O
starts	O
from	O
the	O
ﬁnal	O
solution	B
.	O
for	O
this	O
reason	O
using	O
a	O
good	O
initialization	B
method	O
is	O
the	O
best	O
plan	O
.	O
114	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
objective	O
given	O
n	O
>	O
4	O
image	O
point	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
estimate	O
ˆh	O
of	O
the	O
homography	O
mapping	O
between	O
the	O
images	O
.	O
the	O
mle	O
involves	O
also	O
solving	O
for	O
a	O
set	O
of	O
subsidiary	O
points	O
{	O
ˆxi	O
}	O
,	O
which	O
minimize	O
i	O
}	O
,	O
determine	O
the	O
maximum	O
likelihood	O
(	O
cid:7	O
)	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
)	O
2	O
where	O
ˆx	O
(	O
cid:1	O
)	O
algorithm	B
i	O
=	O
ˆhˆxi	O
.	O
i	O
(	O
ii	O
)	O
geometric	B
minimization	I
of	O
–	O
either	O
sampson	O
error	B
:	O
(	O
i	O
)	O
initialization	B
:	O
compute	O
an	O
initial	O
estimate	O
of	O
ˆh	O
to	O
provide	O
a	O
starting	O
point	B
for	O
the	O
ge-	O
ometric	O
minimization	B
.	O
for	O
example	O
,	O
use	O
the	O
linear	B
normalized	O
dlt	O
algorithm	B
4.2	O
,	O
or	O
use	O
ransac	O
(	O
section	O
4.7.1	O
)	O
to	O
compute	O
ˆh	O
from	O
four	O
point	B
correspondences	O
.	O
•	O
minimize	O
the	O
sampson	O
approximation	O
to	O
the	O
geometric	B
error	I
(	O
4.12–p99	O
)	O
.	O
•	O
the	O
cost	O
is	O
minimized	O
using	O
the	O
newton	O
algorithm	B
of	O
section	O
a6.1	O
(	O
p597	O
)	O
or	O
levenberg–marquardt	O
algorithm	B
of	O
section	O
a6.2	O
(	O
p600	O
)	O
over	O
a	O
suitable	O
parametriza-	O
tion	O
of	O
ˆh	O
.	O
for	O
example	O
the	O
matrix	B
may	O
be	O
parametrized	O
by	O
its	O
9	O
entries	O
.	O
or	O
gold	O
standard	O
error	B
:	O
•	O
compute	O
an	O
initial	O
estimate	O
of	O
the	O
subsidiary	O
variables	O
{	O
ˆxi	O
}	O
using	O
the	O
measured	O
points	O
{	O
xi	O
}	O
or	O
(	O
better	O
)	O
the	O
sampson	O
correction	B
to	O
these	O
points	O
given	O
by	O
(	O
4.11–p99	O
)	O
.	O
•	O
minimize	O
the	O
cost	O
(	O
cid:7	O
)	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
)	O
2	O
i	O
over	O
ˆh	O
and	O
ˆxi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n.	O
the	O
cost	O
is	O
minimized	O
using	O
the	O
levenberg–marquardt	O
algorithm	B
over	O
2n+9	O
variables	O
:	O
2n	O
for	O
the	O
n	O
2d	O
points	O
ˆxi	O
,	O
and	O
9	O
for	O
the	O
homography	B
matrix	O
ˆh	O
.	O
•	O
if	O
the	O
number	O
of	O
points	O
is	O
large	O
then	O
the	O
sparse	B
method	O
of	O
minimizing	O
this	O
cost	O
func-	O
tion	O
given	O
in	O
section	O
a6.4	O
(	O
p607	O
)	O
is	O
the	O
recommended	O
approach	O
.	O
algorithm	B
4.3.	O
the	O
gold	O
standard	O
algorithm	B
and	O
variations	O
for	O
estimating	O
h	O
from	O
image	O
correspon-	O
dences	O
.	O
the	O
gold	O
standard	O
algorithm	B
is	O
preferred	O
to	O
the	O
sampson	O
method	O
for	O
2d	O
homography	O
compu-	O
tation	O
.	O
iteration	B
methods	O
there	O
are	O
various	O
iterative	B
methods	I
for	O
minimizing	O
the	O
chosen	O
cost	B
function	I
,	O
of	O
which	O
the	O
most	O
popular	O
are	O
newton	O
iteration	B
and	O
the	O
levenberg–marquardt	O
method	O
.	O
these	O
methods	O
are	O
described	O
in	O
appendix	O
6	O
(	O
p597	O
)	O
.	O
other	O
general	O
methods	O
for	O
minimizing	O
a	O
cost	B
function	I
are	O
available	O
,	O
such	O
as	O
powell	O
’	O
s	O
method	O
and	O
the	O
simplex	O
method	O
both	O
described	O
in	O
[	O
press-88	O
]	O
.	O
summary	B
.	O
the	O
ideas	O
in	O
this	O
section	O
are	O
collected	O
together	O
in	O
algorithm	O
4.3	O
,	O
which	O
describes	O
the	O
gold	O
standard	O
and	O
sampson	O
methods	O
for	O
estimating	B
the	O
homography	B
mapping	O
between	O
point	O
correspondences	B
in	O
two	O
images	O
.	O
4.6	O
experimental	O
comparison	O
of	O
the	O
algorithms	O
115	O
a	O
b	O
c	O
fig	O
.	O
4.5.	O
three	O
images	O
of	O
a	O
plane	O
which	O
are	O
used	O
to	O
compare	O
methods	O
of	O
computing	O
projective	B
transfor-	O
mations	O
from	O
corresponding	O
points	O
.	O
method	O
pair	O
1	O
ﬁgure	O
4.5	O
a	O
&	O
b	O
pair	O
2	O
ﬁgure	O
4.5	O
a	O
&	O
c	O
linear	B
normalized	O
gold	O
standard	O
linear	B
unnormalized	O
homogeneous	B
scaling	I
sampson	O
error	O
in	O
1	O
view	O
afﬁne	B
theoretical	O
optimal	O
0.4078	O
0.4078	O
0.4080	O
0.5708	O
0.4077	O
0.4077	O
6.0095	O
0.5477	O
0.6602	O
0.6602	O
26.2056	O
0.7421	O
0.6602	O
0.6602	O
2.8481	O
0.6582	O
table	O
4.1.	O
residual	B
errors	O
in	O
pixels	O
for	O
the	O
various	O
algorithms	O
.	O
4.6	O
experimental	O
comparison	O
of	O
the	O
algorithms	O
the	O
algorithms	O
are	O
compared	O
for	O
the	O
images	O
shown	O
in	O
ﬁgure	O
4.5.	O
table	O
4.1	O
shows	O
the	O
results	O
of	O
testing	O
several	O
of	O
the	O
algorithms	O
described	O
in	O
this	O
chapter	O
.	O
residual	B
error	O
is	O
shown	O
for	O
two	O
pairs	O
of	O
images	O
.	O
the	O
methods	O
used	O
are	O
fairly	O
self-explanatory	O
,	O
with	O
a	O
few	O
exceptions	O
.	O
the	O
method	O
“	O
afﬁne	B
”	O
was	O
an	O
attempt	O
to	O
ﬁt	O
the	O
projective	B
transformation	I
with	O
an	O
optimal	O
afﬁne	B
mapping	O
.	O
the	O
“	O
optimal	O
”	O
is	O
the	O
ml	O
estimate	O
assuming	O
a	O
noise	B
level	O
of	O
one	O
pixel	O
.	O
the	O
ﬁrst	O
pair	O
of	O
images	O
are	O
(	O
a	O
)	O
and	O
(	O
b	O
)	O
of	O
ﬁgure	O
4.5	O
,	O
with	O
55	O
point	B
correspondences	O
.	O
it	O
appears	O
that	O
all	O
methods	O
work	O
almost	O
equally	O
well	O
(	O
except	O
the	O
afﬁne	B
method	O
)	O
.	O
the	O
optimal	O
residual	B
is	O
greater	O
than	O
the	O
achieved	O
results	O
,	O
because	O
the	O
noise	B
level	O
(	O
unknown	O
)	O
is	O
less	O
than	O
one	O
pixel	O
.	O
image	O
(	O
c	O
)	O
of	O
ﬁgure	O
4.5	O
was	O
produced	O
synthetically	O
by	O
resampling	O
(	O
a	O
)	O
,	O
and	O
the	O
second	O
pair	O
consists	O
of	O
(	O
a	O
)	O
and	O
(	O
c	O
)	O
with	O
20	O
point	B
correspondences	O
.	O
in	O
this	O
case	O
,	O
almost	O
all	O
methods	O
perform	O
almost	O
optimally	O
,	O
as	O
shown	O
in	O
the	O
table	O
4.1.	O
the	O
exception	O
is	O
the	O
afﬁne	B
method	O
(	O
expected	O
to	O
perform	O
badly	O
,	O
since	O
it	O
is	O
not	O
an	O
afﬁne	B
transformation	I
)	O
and	O
the	O
unnormalized	O
linear	B
method	O
.	O
the	O
unnormalized	O
method	O
is	O
expected	O
to	O
perform	O
badly	O
(	O
though	O
maybe	O
not	O
this	O
badly	O
)	O
.	O
just	O
why	O
it	O
performs	O
well	O
in	O
the	O
ﬁrst	O
pair	O
and	O
very	O
badly	O
for	O
the	O
second	O
pair	O
is	O
not	O
understood	O
.	O
in	O
any	O
case	O
,	O
it	O
is	O
best	O
to	O
avoid	O
this	O
method	O
and	O
use	O
a	O
normalized	O
linear	O
or	O
gold	O
standard	O
method	O
.	O
a	O
further	O
evaluation	O
is	O
presented	O
in	O
ﬁgure	O
4.6.	O
the	O
transformation	B
to	O
be	O
estimated	O
is	O
the	O
one	O
that	O
maps	O
the	O
chessboard	O
image	O
shown	O
here	O
to	O
a	O
square	O
grid	O
aligned	O
with	O
the	O
116	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
0.8	O
0.7	O
0.6	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
0	O
2	O
1.5	O
1	O
0.5	O
r	O
o	O
r	O
r	O
e	O
l	O
a	O
u	O
d	O
i	O
s	O
e	O
r	O
r	O
o	O
r	O
r	O
e	O
l	O
a	O
u	O
d	O
i	O
s	O
e	O
r	O
0	O
10	O
20	O
30	O
40	O
50	O
60	O
70	O
number	O
of	O
points	O
b	O
4	O
6	O
noise	B
level	O
8	O
10	O
0	O
0	O
0.5	O
1	O
1.5	O
2	O
2.5	O
3	O
noise	B
level	O
d	O
r	O
o	O
r	O
r	O
e	O
l	O
a	O
u	O
d	O
i	O
s	O
e	O
r	O
7	O
6	O
5	O
4	O
3	O
2	O
1	O
0	O
0	O
a	O
2	O
c	O
fig	O
.	O
4.6.	O
comparison	O
of	O
the	O
dlt	O
and	O
gold	O
standard	O
algorithms	O
to	O
the	O
theoretically	O
optimal	O
resid-	O
ual	O
error	B
.	O
(	O
a	O
)	O
the	O
homography	B
is	O
computed	O
between	O
a	O
chessboard	O
and	O
this	O
image	O
.	O
in	O
all	O
three	O
graphs	O
,	O
the	O
result	O
for	O
the	O
gold	O
standard	O
algorithm	B
overlap	O
and	O
are	O
indistinguishable	O
from	O
the	O
theoretical	O
mini-	O
mum	O
.	O
(	O
b	O
)	O
residual	B
error	O
as	O
a	O
function	O
of	O
the	O
number	O
of	O
points	O
.	O
(	O
c	O
)	O
the	O
effect	O
of	O
varying	O
noise	B
level	O
for	O
10	O
points	O
,	O
and	O
(	O
d	O
)	O
50	O
points	O
.	O
axes	O
.	O
as	O
may	O
be	O
seen	O
,	O
the	O
image	O
is	O
substantially	O
distorted	O
,	O
with	O
respect	O
to	O
a	O
square	O
grid	O
.	O
for	O
the	O
experiments	O
,	O
randomly	O
selected	O
points	O
in	O
the	O
image	O
were	O
chosen	O
and	O
matched	O
with	O
the	O
corresponding	O
point	B
on	O
the	O
square	O
grid	O
.	O
the	O
(	O
normalized	O
)	O
dlt	O
algorithm	B
and	O
the	O
gold	O
standard	O
algorithm	B
are	O
compared	O
to	O
the	O
theoretical	O
minimum	O
or	O
residual	B
error	O
(	O
see	O
chapter	O
5	O
)	O
.	O
note	O
that	O
for	O
noise	O
up	O
to	O
5	O
pixels	O
,	O
the	O
dlt	O
algorithm	B
performs	O
adequately	O
.	O
however	O
,	O
for	O
a	O
noise	O
level	O
of	O
10	O
pixels	O
it	O
fails	O
.	O
note	O
however	O
that	O
in	O
a	O
200-	O
pixel	O
image	O
,	O
an	O
error	B
of	O
10	O
pixels	O
is	O
extremely	O
high	O
.	O
for	O
less	O
severe	O
homographies	B
,	O
closer	O
to	O
the	O
identity	O
map	O
,	O
the	O
dlt	O
performs	O
almost	O
as	O
well	O
as	O
the	O
gold	O
standard	O
algorithm	B
.	O
4.7	O
robust	B
estimation	O
up	O
to	O
this	O
point	B
it	O
has	O
been	O
assumed	O
that	O
we	O
have	O
been	O
presented	O
with	O
a	O
set	O
of	O
corre-	O
spondences	O
,	O
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
,	O
where	O
the	O
only	O
source	O
of	O
error	O
is	O
in	O
the	O
measurement	O
of	O
the	O
point	B
’	O
s	O
position	O
,	O
which	O
follows	O
a	O
gaussian	O
distribution	B
.	O
in	O
many	O
practical	O
situations	O
this	O
assumption	O
is	O
not	O
valid	O
because	O
points	O
are	O
mismatched	O
.	O
the	O
mismatched	O
points	O
are	O
outliers	O
to	O
the	O
gaussian	O
error	B
distribution	O
.	O
these	O
outliers	O
can	O
severely	O
disturb	O
the	O
i	O
4.7	O
robust	B
estimation	O
117	O
c	O
a	O
d	O
b	O
b	O
a	O
fig	O
.	O
4.7.	O
robust	B
line	O
estimation	B
.	O
the	O
solid	O
points	O
are	O
inliers	O
,	O
the	O
open	O
points	O
outliers	O
.	O
(	O
a	O
)	O
a	O
least-	O
squares	O
(	O
orthogonal	B
regression	I
)	O
ﬁt	O
to	O
the	O
point	B
data	O
is	O
severely	O
affected	O
by	O
the	O
outliers	O
.	O
(	O
b	O
)	O
in	O
the	O
ransac	O
algorithm	B
the	O
support	O
for	B
lines	I
through	O
randomly	O
selected	O
point	B
pairs	O
is	O
measured	O
by	O
the	O
num-	O
ber	O
of	B
points	I
within	O
a	O
threshold	O
distance	B
of	O
the	O
lines	B
.	O
the	O
dotted	O
lines	B
indicate	O
the	O
threshold	O
distance	B
.	O
for	O
the	O
lines	B
shown	O
the	O
support	O
is	O
10	O
for	O
line	O
(	O
cid:8	O
)	O
a	O
,	O
b	O
(	O
cid:9	O
)	O
(	O
where	O
both	O
of	O
the	O
points	O
a	O
and	O
b	O
are	O
inliers	O
)	O
;	O
and	O
2	O
for	O
line	O
(	O
cid:8	O
)	O
c	O
,	O
d	O
(	O
cid:9	O
)	O
where	O
the	O
point	B
c	O
is	O
an	O
outlier	O
.	O
estimated	O
homography	B
,	O
and	O
consequently	O
should	O
be	O
identiﬁed	O
.	O
the	O
goal	O
then	O
is	O
to	O
de-	O
termine	O
a	O
set	O
of	O
inliers	O
from	O
the	O
presented	O
“	O
correspondences	B
”	O
so	O
that	O
the	O
homography	B
can	O
then	O
be	O
estimated	O
in	O
an	O
optimal	O
manner	O
from	O
these	O
inliers	O
using	O
the	O
algorithms	O
de-	O
scribed	O
in	O
the	O
previous	O
sections	O
.	O
this	O
is	O
robust	B
estimation	O
since	O
the	O
estimation	B
is	O
robust	B
(	O
tolerant	O
)	O
to	O
outliers	O
(	O
measurements	O
following	O
a	O
different	O
,	O
and	O
possibly	O
unmodelled	O
,	O
error	B
distribution	O
)	O
.	O
4.7.1	O
ransac	O
we	O
start	O
with	O
a	O
simple	O
example	O
that	O
can	O
easily	O
be	O
visualized	O
–	O
estimating	B
a	O
straight	O
line	B
ﬁt	O
to	O
a	O
set	O
of	O
2-dimensional	O
points	O
.	O
this	O
can	O
be	O
thought	O
of	O
as	O
estimating	B
a	O
1-	O
dimensional	O
afﬁne	B
transformation	I
,	O
x	O
=	O
ax	O
+	O
b	O
,	O
between	O
corresponding	O
points	O
lying	O
on	O
two	O
lines	B
.	O
(	O
cid:2	O
)	O
the	O
problem	O
,	O
which	O
is	O
illustrated	O
in	O
ﬁgure	O
4.7a	O
,	O
is	O
the	O
following	O
:	O
given	O
a	O
set	O
of	O
2d	O
data	O
points	O
,	O
ﬁnd	O
the	O
line	B
which	O
minimizes	O
the	O
sum	O
of	O
squared	O
perpendicular	O
distances	O
(	O
orthogonal	B
regression	I
)	O
,	O
subject	O
to	O
the	O
condition	O
that	O
none	O
of	O
the	O
valid	O
points	O
deviates	O
from	O
this	O
line	B
by	O
more	O
than	O
t	O
units	O
.	O
this	O
is	O
actually	O
two	O
problems	O
:	O
a	O
line	B
ﬁt	O
to	O
the	O
data	O
;	O
and	O
a	O
classiﬁcation	B
of	I
the	O
data	O
into	O
inliers	O
(	O
valid	O
points	O
)	O
and	O
outliers	O
.	O
the	O
threshold	O
t	O
is	O
set	O
according	O
to	O
the	O
measurement	O
noise	O
(	O
for	O
example	O
t	O
=	O
3σ	O
)	O
,	O
and	O
is	O
discussed	O
below	O
.	O
there	O
are	O
many	O
types	O
of	O
robust	O
algorithms	O
and	O
which	O
one	O
to	O
use	O
depends	O
to	O
some	O
extent	O
on	O
the	O
proportion	O
of	O
outliers	O
.	O
for	O
example	O
,	O
if	O
it	O
is	O
known	O
that	O
there	O
is	O
only	O
one	O
outlier	O
,	O
then	O
each	O
point	B
can	O
be	O
deleted	O
in	O
turn	O
and	O
the	O
line	B
estimated	O
from	O
the	O
remainder	O
.	O
here	O
we	O
describe	O
in	O
detail	O
a	O
general	O
and	O
very	O
successful	O
robust	B
estimator	O
–	O
the	O
random	O
sample	O
consensus	O
(	O
ransac	O
)	O
algorithm	B
of	O
fischler	O
and	O
bolles	O
[	O
fischler-81	O
]	O
.	O
the	O
ransac	O
algorithm	B
is	O
able	O
to	O
cope	O
with	O
a	O
large	O
proportion	O
of	O
outliers	O
.	O
the	O
idea	O
is	O
very	O
simple	O
:	O
two	O
of	O
the	O
points	O
are	O
selected	O
randomly	O
;	O
these	O
points	O
deﬁne	O
a	O
line	B
.	O
the	O
support	O
for	O
this	O
line	B
is	O
measured	O
by	O
the	O
number	O
of	O
points	O
that	O
lie	O
within	O
a	O
distance	B
threshold	I
.	O
this	O
random	O
selection	O
is	O
repeated	O
a	O
number	O
of	O
times	O
and	O
the	O
line	B
with	O
most	O
support	O
is	O
deemed	O
the	O
robust	B
ﬁt	O
.	O
the	O
points	O
within	O
the	O
threshold	O
distance	B
are	O
the	O
inliers	O
(	O
and	O
constitute	O
the	O
eponymous	O
consensus	O
set	O
)	O
.	O
the	O
intuition	O
is	O
that	O
if	O
one	O
of	O
the	O
points	O
is	O
an	O
outlier	O
then	O
the	O
line	B
will	O
not	O
gain	O
much	O
support	O
,	O
see	O
ﬁgure	O
4.7b	O
.	O
118	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
furthermore	O
,	O
scoring	O
a	O
line	B
by	O
its	O
support	O
has	O
the	O
additional	O
advantage	O
of	O
favouring	O
better	O
ﬁts	O
.	O
for	O
example	O
,	O
the	O
line	B
(	O
cid:8	O
)	O
a	O
,	O
b	O
(	O
cid:9	O
)	O
in	O
ﬁgure	O
4.7b	O
has	O
a	O
support	O
of	O
10	O
,	O
whereas	O
the	O
line	B
(	O
cid:8	O
)	O
a	O
,	O
d	O
(	O
cid:9	O
)	O
,	O
where	O
the	O
sample	O
points	O
are	O
neighbours	O
,	O
has	O
a	O
support	O
of	O
only	O
4.	O
conse-	O
quently	O
,	O
even	O
though	O
both	O
samples	O
contain	O
no	O
outliers	O
,	O
the	O
line	B
(	O
cid:8	O
)	O
a	O
,	O
b	O
(	O
cid:9	O
)	O
will	O
be	O
selected	O
.	O
more	O
generally	O
,	O
we	O
wish	O
to	O
ﬁt	O
a	O
model	B
,	O
in	O
this	O
case	O
a	O
line	B
,	O
to	O
data	O
,	O
and	O
the	O
random	O
sample	O
consists	O
of	O
a	O
minimal	O
subset	O
of	O
the	O
data	O
,	O
in	O
this	O
case	O
two	O
points	O
,	O
sufﬁcient	O
to	O
determine	O
the	O
model	B
.	O
if	O
the	O
model	B
is	O
a	O
planar	O
homography	O
,	O
and	O
the	O
data	O
a	O
set	O
of	O
2d	O
point	B
correspondences	O
,	O
then	O
the	O
minimal	O
subset	O
consists	O
of	O
four	O
correspondences	B
.	O
the	O
application	O
of	O
ransac	O
to	O
the	O
estimation	B
of	I
a	O
homography	B
is	O
described	O
below	O
.	O
as	O
stated	O
by	O
fischler	O
and	O
bolles	O
[	O
fischler-81	O
]	O
“	O
the	O
ransac	O
procedure	O
is	O
opposite	O
to	O
that	O
of	O
conventional	O
smoothing	O
techniques	O
:	O
rather	O
than	O
using	O
as	O
much	O
of	O
the	O
data	O
as	O
possible	O
to	O
obtain	O
an	O
initial	B
solution	I
and	O
then	O
attempting	O
to	O
eliminate	O
the	O
invalid	O
data	O
points	O
,	O
ransac	O
uses	O
as	O
small	O
an	O
initial	O
data	O
set	O
as	O
feasible	O
and	O
enlarges	O
this	O
set	O
with	O
consistent	O
data	O
when	O
possible	O
”	O
.	O
the	O
ransac	O
algorithm	B
is	O
summarized	O
in	O
algorithm	O
4.4.	O
three	O
questions	O
immedi-	O
ately	O
arise	O
:	O
objective	O
robust	B
ﬁt	O
of	O
a	O
model	O
to	O
a	O
data	O
set	O
s	O
which	O
contains	O
outliers	O
.	O
algorithm	B
(	O
i	O
)	O
randomly	O
select	O
a	O
sample	O
of	O
s	O
data	O
points	O
from	O
s	O
and	O
instantiate	O
the	O
model	B
from	O
this	O
subset	O
.	O
(	O
ii	O
)	O
determine	O
the	O
set	O
of	O
data	O
points	O
si	O
which	O
are	O
within	O
a	O
distance	B
threshold	I
t	O
of	O
the	O
model	O
.	O
the	O
set	O
si	O
is	O
the	O
consensus	O
set	O
of	O
the	O
sample	O
and	O
deﬁnes	O
the	O
inliers	O
of	O
s.	O
(	O
iii	O
)	O
if	O
the	O
size	O
of	O
si	O
(	O
the	O
number	O
of	O
inliers	O
)	O
is	O
greater	O
than	O
some	O
threshold	O
t	O
,	O
re-estimate	O
the	O
model	B
using	O
all	O
the	O
points	O
in	O
si	O
and	O
terminate	O
.	O
(	O
iv	O
)	O
if	O
the	O
size	O
of	O
si	O
is	O
less	O
than	O
t	O
,	O
select	O
a	O
new	O
subset	O
and	O
repeat	O
the	O
above	O
.	O
(	O
v	O
)	O
after	O
n	O
trials	O
the	O
largest	O
consensus	O
set	O
si	O
is	O
selected	O
,	O
and	O
the	O
model	B
is	O
re-estimated	O
using	O
all	O
the	O
points	O
in	O
the	O
subset	O
si	O
.	O
algorithm	B
4.4.	O
the	O
ransac	O
robust	B
estimation	O
algorithm	B
,	O
adapted	O
from	O
[	O
fischler-81	O
]	O
.	O
a	O
minimum	O
of	O
s	O
data	O
points	O
are	O
required	O
to	O
instantiate	O
the	O
free	O
parameters	B
of	O
the	O
model	B
.	O
the	O
three	O
algorithm	B
thresholds	O
t	O
,	O
t	O
,	O
and	O
n	O
are	O
discussed	O
in	O
the	O
text	O
.	O
1.	O
what	O
is	O
the	O
distance	B
threshold	I
?	O
we	O
would	O
like	O
to	O
choose	O
the	O
distance	B
threshold	I
,	O
t	O
,	O
such	O
that	O
with	O
a	O
probability	O
α	O
the	O
point	B
is	O
an	O
inlier	O
.	O
this	O
calculation	O
requires	O
the	O
prob-	O
ability	O
distribution	B
for	O
the	O
distance	B
of	O
an	O
inlier	O
from	O
the	O
model	B
.	O
in	O
practice	O
the	O
distance	B
threshold	I
is	O
usually	O
chosen	O
empirically	O
.	O
however	O
,	O
if	O
it	O
is	O
assumed	O
that	O
the	O
measure-	O
ment	O
error	B
is	O
gaussian	O
with	O
zero	O
mean	O
and	O
standard	O
deviation	O
σ	O
,	O
then	O
a	O
value	O
for	O
t	O
may	O
be	O
computed	O
.	O
in	O
this	O
case	O
the	O
square	O
of	O
the	O
point	O
distance	B
,	O
d2⊥	O
,	O
is	O
a	O
sum	O
of	O
squared	O
gaussian	O
variables	O
and	O
follows	O
a	O
χ2	O
m	O
distribution	B
with	O
m	O
degrees	B
of	I
freedom	I
,	O
where	O
m	O
equals	O
the	O
codimension	O
of	O
the	O
model	O
.	O
for	O
a	O
line	O
the	O
codimension	O
is	O
1	O
–	O
only	O
the	O
perpendicular	O
distance	B
to	O
the	O
line	B
is	O
measured	O
.	O
if	O
the	O
model	B
is	O
a	O
point	B
the	O
codimension	O
is	O
2	O
,	O
and	O
the	O
square	O
of	O
the	O
distance	O
is	O
the	O
sum	O
of	O
squared	O
x	O
and	O
y	O
measurement	O
errors	O
.	O
4.7	O
robust	B
estimation	O
119	O
the	O
probability	O
that	O
the	O
value	O
of	O
a	O
χ2	O
mulative	O
chi-squared	O
distribution	B
,	O
fm	O
(	O
k2	O
)	O
=	O
are	O
described	O
in	O
section	O
a2.2	O
(	O
p566	O
)	O
.	O
from	O
the	O
cumulative	O
distribution	B
m	O
random	O
variable	O
is	O
less	O
than	O
k2	O
is	O
given	O
by	O
the	O
cu-	O
m	O
(	O
ξ	O
)	O
dξ	O
.	O
both	O
of	O
these	O
distributions	O
(	O
cid:31	O
)	O
k2	O
0	O
χ2	O
d2⊥	O
<	O
t2	O
inlier	O
outlier	O
d2⊥	O
≥	O
t2	O
with	O
t2	O
=	O
f	O
−1	O
m	O
(	O
α	O
)	O
σ2	O
.	O
(	O
4.17	O
)	O
usually	O
α	O
is	O
chosen	O
as	O
0.95	O
,	O
so	O
that	O
there	O
is	O
a	O
95	O
%	O
probability	O
that	O
the	O
point	B
is	O
an	O
inlier	O
.	O
this	O
means	O
that	O
an	O
inlier	O
will	O
only	O
be	O
incorrectly	O
rejected	O
5	O
%	O
of	O
the	O
time	O
.	O
values	O
of	O
t	O
for	O
α	O
=	O
0.95	O
and	O
for	O
the	O
models	O
of	O
interest	O
in	O
this	O
book	O
are	O
tabulated	O
in	O
table	O
4.2.	O
codimension	O
m	O
model	B
1	O
2	O
3	O
line	B
,	O
fundamental	B
matrix	I
homography	O
,	O
camera	B
matrix	I
trifocal	O
tensor	B
t2	O
3.84	O
σ2	O
5.99	O
σ2	O
7.81	O
σ2	O
table	O
4.2.	O
the	O
distance	B
threshold	I
t2	O
=	O
f	O
spondence	O
)	O
is	O
an	O
inlier	O
.	O
−1	O
m	O
(	O
α	O
)	O
σ2	O
for	O
a	O
probability	O
of	O
α	O
=	O
0.95	O
that	O
the	O
point	B
(	O
corre-	O
2.	O
how	O
many	O
samples	O
?	O
it	O
is	O
often	O
computationally	O
infeasible	O
and	O
unnecessary	O
to	O
try	O
every	O
possible	O
sample	O
.	O
instead	O
the	O
number	B
of	I
samples	I
n	O
is	O
chosen	O
sufﬁciently	O
high	O
to	O
ensure	O
with	O
a	O
probability	O
,	O
p	O
,	O
that	O
at	O
least	O
one	O
of	O
the	O
random	O
samples	O
of	O
s	O
points	O
is	O
free	O
from	O
outliers	O
.	O
usually	O
p	O
is	O
chosen	O
at	O
0.99.	O
suppose	O
w	O
is	O
the	O
probability	O
that	O
any	O
selected	O
data	O
point	B
is	O
an	O
inlier	O
,	O
and	O
thus	O
	O
=	O
1−	O
w	O
is	O
the	O
probability	O
that	O
it	O
is	O
an	O
outlier	O
.	O
then	O
at	O
least	O
n	O
selections	O
(	O
each	O
of	O
s	O
points	O
)	O
are	O
required	O
,	O
where	O
(	O
1	O
−	O
ws	O
)	O
n	O
=	O
1	O
−	O
p	O
,	O
so	O
that	O
n	O
=	O
log	O
(	O
1	O
−	O
p	O
)	O
/	O
log	O
(	O
1	O
−	O
(	O
1	O
−	O
	O
)	O
s	O
)	O
.	O
table	O
4.3	O
gives	O
examples	B
of	O
n	O
for	O
p	O
=	O
0.99	O
for	O
a	O
given	O
s	O
and	O
	O
.	O
(	O
4.18	O
)	O
sample	O
size	O
proportion	O
of	O
outliers	O
	O
s	O
2	O
3	O
4	O
5	O
6	O
7	O
8	O
5	O
%	O
10	O
%	O
20	O
%	O
25	O
%	O
30	O
%	O
40	O
%	O
50	O
%	O
2	O
3	O
3	O
4	O
4	O
4	O
5	O
3	O
4	O
5	O
6	O
7	O
8	O
9	O
5	O
7	O
9	O
12	O
16	O
20	O
26	O
6	O
9	O
13	O
17	O
24	O
33	O
44	O
7	O
11	O
17	O
26	O
37	O
54	O
78	O
11	O
19	O
34	O
57	O
97	O
163	O
272	O
17	O
35	O
72	O
146	O
293	O
588	O
1177	O
table	O
4.3.	O
the	O
number	O
n	O
of	O
samples	O
required	O
to	O
ensure	O
,	O
with	O
a	O
probability	O
p	O
=	O
0.99	O
,	O
that	O
at	O
least	O
one	O
sample	O
has	O
no	O
outliers	O
for	O
a	O
given	O
size	O
of	O
sample	O
,	O
s	O
,	O
and	O
proportion	O
of	O
outliers	O
,	O
	O
.	O
example	O
4.4.	O
for	O
the	O
line-ﬁtting	O
problem	O
of	O
ﬁgure	O
4.7	O
there	O
are	O
n	O
=	O
12	O
data	O
points	O
,	O
of	O
120	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
which	O
two	O
are	O
outliers	O
so	O
that	O
	O
=	O
2/12	O
=	O
1/6	O
.	O
from	O
table	O
4.3	O
for	O
a	O
minimal	O
subset	O
of	O
size	O
s	O
=	O
2	O
,	O
at	O
least	O
n	O
=	O
5	O
samples	O
are	O
required	O
.	O
this	O
should	O
be	O
compared	O
with	O
the	O
cost	O
of	O
exhaustively	O
trying	O
every	O
point	B
pair	O
,	O
in	O
which	O
case	O
(	O
12	O
2	O
)	O
=	O
66	O
samples	O
are	O
required	O
(	O
the	O
notation	O
(	O
n	O
2	O
)	O
means	O
the	O
number	O
of	O
choices	O
of	O
2	O
among	O
n	O
,	O
speciﬁcally	O
,	O
(	O
cid:2	O
)	O
2	O
)	O
=	O
n	O
(	O
n	O
−	O
1	O
)	O
/2	O
)	O
.	O
(	O
n	O
note	O
(	O
i	O
)	O
the	O
number	B
of	I
samples	I
is	O
linked	O
to	O
the	O
proportion	O
rather	O
than	O
number	O
of	O
out-	O
liers	O
.	O
this	O
means	O
that	O
the	O
number	B
of	I
samples	I
required	O
may	O
be	O
smaller	O
than	O
the	O
number	O
of	O
outliers	O
.	O
consequently	O
the	O
computational	O
cost	O
of	O
the	O
sampling	O
can	O
be	O
acceptable	O
even	O
when	O
the	O
number	O
of	O
outliers	O
is	O
large	O
.	O
(	O
ii	O
)	O
the	O
number	B
of	I
samples	I
increases	O
with	O
the	O
size	O
of	O
the	O
minimal	O
subset	O
(	O
for	O
a	O
given	O
	O
and	O
p	O
)	O
.	O
it	O
might	O
be	O
thought	O
that	O
it	O
would	O
be	O
advantageous	O
to	O
use	O
more	O
than	O
the	O
minimal	O
subset	O
,	O
three	O
or	O
more	O
points	O
in	O
the	O
case	O
of	O
a	O
line	O
,	O
because	O
then	O
a	O
better	O
estimate	O
of	O
the	O
line	O
would	O
be	O
obtained	O
,	O
and	O
the	O
measured	O
support	O
would	O
more	O
accurately	O
reﬂect	O
the	O
true	O
support	O
.	O
however	O
,	O
this	O
possible	O
advantage	O
in	O
measuring	O
support	O
is	O
generally	O
outweighed	O
by	O
the	O
severe	O
increase	O
in	O
computa-	O
tional	O
cost	O
incurred	O
by	O
the	O
increase	O
in	O
the	O
number	B
of	I
samples	I
.	O
3.	O
how	O
large	O
is	O
an	O
acceptable	O
consensus	O
set	O
?	O
a	O
rule	O
of	O
thumb	O
is	O
to	O
terminate	O
if	O
the	O
size	O
of	O
the	O
consensus	O
set	O
is	O
similar	O
to	O
the	O
number	O
of	O
inliers	O
believed	O
to	O
be	O
in	O
the	O
data	O
set	O
,	O
given	O
the	O
assumed	O
proportion	O
of	O
outliers	O
,	O
i.e	O
.	O
for	O
n	O
data	O
points	O
t	O
=	O
(	O
1	O
−	O
	O
)	O
n.	O
for	O
the	O
line-ﬁtting	O
example	O
of	O
ﬁgure	O
4.7	O
a	O
conservative	O
estimate	O
of	O
	O
is	O
	O
=	O
0.2	O
,	O
so	O
that	O
t	O
=	O
(	O
1.0	O
−	O
0.2	O
)	O
12	O
=	O
10.	O
determining	O
the	O
number	O
of	O
samples	O
adaptively	O
.	O
it	O
is	O
often	O
the	O
case	O
that	O
	O
,	O
the	O
fraction	O
of	O
data	O
consisting	O
of	O
outliers	O
,	O
is	O
unknown	O
.	O
in	O
such	O
cases	O
the	O
algorithm	B
is	O
initialized	O
using	O
a	O
worst	O
case	O
estimate	O
of	O
	O
,	O
and	O
this	O
estimate	O
can	O
then	O
be	O
updated	O
as	O
larger	O
consistent	O
sets	O
are	O
found	O
.	O
for	O
example	O
,	O
if	O
the	O
worst	O
case	O
guess	O
is	O
	O
=	O
0.5	O
and	O
a	O
consensus	O
set	O
with	O
80	O
%	O
of	O
the	O
data	O
is	O
found	O
as	O
inliers	O
,	O
then	O
the	O
updated	O
estimate	O
is	O
	O
=	O
0.2.	O
this	O
idea	O
of	O
“	O
probing	O
”	O
the	O
data	O
via	O
the	O
consensus	O
sets	O
can	O
be	O
applied	O
repeatedly	O
in	O
order	O
to	O
adaptively	O
determine	O
the	O
number	B
of	I
samples	I
,	O
n.	O
to	O
continue	O
the	O
example	O
above	O
,	O
the	O
worst	O
case	O
estimate	O
of	O
	O
=	O
0.5	O
determines	O
an	O
initial	O
n	O
according	O
to	O
(	O
4.18	O
)	O
.	O
when	O
a	O
consensus	O
set	O
containing	O
more	O
than	O
50	O
%	O
of	O
the	O
data	O
is	O
found	O
,	O
we	O
then	O
know	O
that	O
there	O
is	O
at	O
least	O
that	O
proportion	O
of	O
inliers	O
.	O
this	O
updated	O
estimate	O
of	O
	O
determines	O
a	O
reduced	B
n	O
from	O
(	O
4.18	O
)	O
.	O
this	O
update	O
is	O
repeated	O
at	O
each	O
sample	O
,	O
and	O
whenever	O
a	O
con-	O
sensus	O
set	O
with	O
	O
lower	O
than	O
the	O
current	O
estimate	O
is	O
found	O
,	O
then	O
n	O
is	O
again	O
reduced	B
.	O
the	O
algorithm	B
terminates	O
as	O
soon	O
as	O
n	O
samples	O
have	O
been	O
performed	O
.	O
it	O
may	O
occur	O
that	O
a	O
sample	O
is	O
found	O
for	O
which	O
	O
determines	O
an	O
n	O
less	O
than	O
the	O
number	B
of	I
samples	I
that	O
have	O
already	O
been	O
performed	O
.	O
in	O
such	O
a	O
case	O
sufﬁcient	O
samples	O
have	O
been	O
performed	O
and	O
the	O
algorithm	B
terminates	O
.	O
in	O
pseudo-code	O
the	O
adaptive	B
computation	O
of	O
n	O
is	O
summarized	O
in	O
algorithm	O
4.5.	O
this	O
adaptive	B
approach	O
works	O
very	O
well	O
and	O
in	O
practice	O
covers	O
the	O
questions	O
of	O
both	O
4.7	O
robust	B
estimation	O
121	O
•	O
n	O
=	O
∞	O
,	O
sample	O
count=	O
0	O
.	O
•	O
while	O
n	O
>	O
sample	O
count	O
repeat	O
–	O
choose	O
a	O
sample	O
and	O
count	O
the	O
number	O
of	O
inliers	O
.	O
–	O
set	O
	O
=	O
1	O
−	O
(	O
number	O
of	O
inliers	O
)	O
/	O
(	O
total	O
number	O
of	B
points	I
)	O
–	O
set	O
n	O
from	O
	O
and	O
(	O
4.18	O
)	O
with	O
p	O
=	O
0.99	O
.	O
–	O
increment	O
the	O
sample	O
count	O
by	O
1	O
.	O
•	O
terminate	O
.	O
algorithm	B
4.5.	O
adaptive	B
algorithm	O
for	O
determining	O
the	O
number	O
of	O
ransac	O
samples	O
.	O
c	O
d	O
b	O
a	O
a	O
c	O
d	O
b	O
a	O
b	O
fig	O
.	O
4.8.	O
robust	B
ml	O
estimation	B
.	O
the	O
grey	O
points	O
are	O
classiﬁed	O
as	O
inliers	O
to	O
the	O
line	B
.	O
(	O
a	O
)	O
a	O
line	B
deﬁned	O
by	O
points	O
(	O
cid:8	O
)	O
a	O
,	O
b	O
(	O
cid:9	O
)	O
has	O
a	O
support	O
of	O
four	O
(	O
from	O
points	O
{	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
}	O
)	O
.	O
(	O
b	O
)	O
the	O
ml	O
line	B
ﬁt	O
(	O
orthogonal	B
least-squares	O
)	O
to	O
the	O
four	O
points	O
.	O
this	O
is	O
a	O
much	O
improved	O
ﬁt	O
over	O
that	O
deﬁned	O
by	O
(	O
cid:8	O
)	O
a	O
,	O
b	O
(	O
cid:9	O
)	O
.	O
10	O
points	O
are	O
classiﬁed	O
as	O
inliers	O
.	O
the	O
number	B
of	I
samples	I
and	O
terminating	O
the	O
algorithm	B
.	O
the	O
initial	O
	O
can	O
be	O
chosen	O
as	O
1.0	O
,	O
in	O
which	O
case	O
the	O
initial	O
n	O
will	O
be	O
inﬁnite	O
.	O
it	O
is	O
wise	O
to	O
use	O
a	O
conservative	O
probability	O
p	O
such	O
as	O
0.99	O
in	O
(	O
4.18	O
)	O
.	O
table	O
4.4	O
on	O
page	O
127	O
gives	O
example	O
	O
’	O
s	O
and	O
n	O
’	O
s	O
when	O
computing	O
a	O
homography	O
.	O
4.7.2	O
robust	B
maximum	O
likelihood	O
estimation	B
the	O
ransac	O
algorithm	B
partitions	O
the	O
data	O
set	O
into	O
inliers	O
(	O
the	O
largest	O
consensus	O
set	O
)	O
and	O
outliers	O
(	O
the	O
rest	O
of	O
the	O
data	O
set	O
)	O
,	O
and	O
also	O
delivers	O
an	O
estimate	O
of	O
the	O
model	O
,	O
m0	O
,	O
computed	O
from	O
the	O
minimal	O
set	O
with	O
greatest	O
support	O
.	O
the	O
ﬁnal	O
step	O
of	O
the	O
ransac	O
algorithm	B
is	O
to	O
re-estimate	O
the	O
model	B
using	O
all	O
the	O
inliers	O
.	O
this	O
re-estimation	O
should	O
be	O
optimal	O
and	O
will	O
involve	O
minimizing	B
a	O
ml	O
cost	B
function	I
,	O
as	O
described	O
in	O
section	O
4.3.	O
in	O
the	O
case	O
of	O
a	O
line	O
,	O
ml	O
estimation	B
is	O
equivalent	B
to	O
orthogonal	B
regression	I
,	O
and	O
a	O
closed	O
form	O
solution	O
is	O
available	O
.	O
in	O
general	O
,	O
though	O
,	O
the	O
ml	O
estimation	B
involves	O
iterative	B
minimization	I
,	O
and	O
the	O
minimal	O
set	O
estimate	O
,	O
m0	O
,	O
provides	O
the	O
starting	O
point	B
.	O
the	O
only	O
drawback	O
with	O
this	O
procedure	O
,	O
which	O
is	O
often	O
the	O
one	O
adopted	O
,	O
is	O
that	O
the	O
inlier–outlier	O
classiﬁcation	B
is	O
irrevocable	O
.	O
after	O
the	O
model	B
has	O
been	O
optimally	O
ﬁtted	O
to	O
the	O
consensus	O
set	O
,	O
there	O
may	O
well	O
be	O
additional	O
points	O
which	O
would	O
now	O
be	O
classiﬁed	O
as	O
inliers	O
if	O
the	O
distance	B
threshold	I
was	O
applied	O
to	O
the	O
new	O
model	B
.	O
for	O
example	O
,	O
suppose	O
the	O
line	B
(	O
cid:8	O
)	O
a	O
,	O
b	O
(	O
cid:9	O
)	O
in	O
ﬁgure	O
4.8	O
was	O
selected	O
by	O
ransac	O
.	O
this	O
line	B
has	O
a	O
support	O
of	O
four	O
points	O
,	O
all	O
inliers	O
.	O
after	O
the	O
optimal	O
ﬁt	O
to	O
these	O
four	O
points	O
,	O
there	O
are	O
now	O
10	O
points	O
which	O
would	O
correctly	O
be	O
classiﬁed	O
as	O
inliers	O
.	O
these	O
two	O
steps	O
:	O
optimal	O
ﬁt	O
to	O
inliers	O
;	O
re-	O
classify	O
inliers	O
using	O
(	O
4.17	O
)	O
;	O
can	O
then	O
be	O
iterated	O
until	O
the	O
number	O
of	O
inliers	O
converges	O
.	O
122	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
a	O
least-squares	O
ﬁt	O
with	O
inliers	O
weighted	B
by	O
their	O
distance	B
to	O
the	O
model	B
is	O
often	O
used	O
at	O
this	O
stage	O
.	O
robust	B
cost	O
function	O
.	O
an	O
alternative	O
to	O
minimizing	O
c	O
=	O
minimize	O
a	O
robust	B
version	O
including	O
all	O
data	O
.	O
a	O
suitable	O
robust	B
cost	O
function	O
is	O
i	O
d2⊥i	O
over	O
the	O
inliers	O
is	O
to	O
(	O
cid:27	O
)	O
(	O
cid:7	O
)	O
i	O
d	O
=	O
γ	O
(	O
d⊥i	O
)	O
with	O
γ	O
(	O
e	O
)	O
=	O
e2	O
e2	O
<	O
t2	O
t2	O
inlier	O
e2	O
≥	O
t2	O
outlier	O
(	O
4.19	O
)	O
here	O
d⊥i	O
are	O
point	B
errors	O
and	O
γ	O
(	O
e	O
)	O
is	O
a	O
robust	B
cost	O
function	O
[	O
huber-81	O
]	O
where	O
outliers	O
are	O
given	O
a	O
ﬁxed	O
cost	O
.	O
the	O
χ2	O
motivation	O
for	O
the	O
threshold	O
is	O
the	O
same	O
as	O
that	O
of	O
(	O
4.17	O
)	O
,	O
where	O
t2	O
is	O
deﬁned	O
.	O
the	O
quadratic	O
cost	O
for	O
inliers	O
arises	O
from	O
the	O
gaussian	O
error	B
model	O
,	O
as	O
described	O
in	O
section	O
4.3.	O
the	O
constant	O
cost	O
for	O
outliers	O
in	O
the	O
robust	B
cost	O
function	O
arises	O
from	O
the	O
assumption	O
that	O
outliers	O
follow	O
a	O
diffuse	O
or	O
uniform	O
distribution	B
,	O
the	O
log-	O
likelihood	O
of	O
which	O
is	O
a	O
constant	O
.	O
it	O
might	O
be	O
thought	O
that	O
outliers	O
could	O
be	O
excluded	O
from	O
the	O
cost	B
function	I
by	O
simply	O
thresholding	O
on	O
d⊥i	O
.	O
the	O
problem	O
with	O
thresholding	O
alone	O
is	O
that	O
it	O
would	O
result	O
in	O
only	O
outliers	O
being	O
included	O
because	O
they	O
would	O
incur	O
no	O
cost	O
.	O
the	O
cost	B
function	I
d	O
allows	O
the	O
minimization	B
to	O
be	O
conducted	O
on	O
all	O
points	O
whether	O
they	O
are	O
outliers	O
or	O
inliers	O
.	O
at	O
the	O
start	O
of	O
the	O
iterative	O
minimization	B
d	O
differs	O
from	O
c	O
only	O
by	O
a	O
constant	O
(	O
given	O
by	O
4	O
times	O
the	O
number	O
of	O
outliers	O
)	O
.	O
however	O
,	O
as	O
the	O
min-	O
imization	O
progresses	O
outliers	O
can	O
be	O
redesignated	O
inliers	O
,	O
and	O
this	O
typically	O
occurs	O
in	O
practice	O
.	O
a	O
discussion	O
and	O
comparison	O
of	O
cost	B
functions	I
is	O
given	O
in	O
appendix	O
a6.8-	O
(	O
p616	O
)	O
.	O
4.7.3	O
other	O
robust	B
algorithms	I
in	O
ransac	O
a	O
model	B
instantiated	O
from	O
a	O
minimal	O
set	O
is	O
scored	O
by	O
the	O
number	O
of	O
data	O
points	O
within	O
a	O
threshold	O
distance	B
.	O
an	O
alternative	O
is	O
to	O
score	O
the	O
model	B
by	O
the	O
me-	O
dian	O
of	O
the	O
distances	O
to	O
all	O
points	O
in	O
the	O
data	O
.	O
the	O
model	B
with	O
least	O
median	O
is	O
then	O
selected	O
.	O
this	O
is	O
least	O
median	O
of	O
squares	O
(	O
lms	O
)	O
estimation	B
,	O
where	O
,	O
as	O
in	O
ransac	O
,	O
minimum	O
size	O
subset	O
samples	O
are	O
selected	O
randomly	O
with	O
the	O
number	B
of	I
samples	I
ob-	O
tained	O
from	O
(	O
4.18	O
)	O
.	O
the	O
advantage	O
of	O
lms	O
is	O
that	O
it	O
requires	O
no	O
setting	O
of	O
thresholds	O
or	O
a	O
priori	O
knowledge	O
of	O
the	O
variance	O
of	O
the	O
error	O
.	O
the	O
disadvantage	O
of	O
lms	O
is	O
that	O
it	O
fails	O
if	O
more	O
than	O
half	O
the	O
data	O
is	O
outlying	O
,	O
for	O
then	O
the	O
median	O
distance	B
will	O
be	O
to	O
an	O
outlier	O
.	O
the	O
solution	B
is	O
to	O
use	O
the	O
proportion	O
of	O
outliers	O
to	O
determine	O
the	O
selection	O
distance	B
.	O
for	O
example	O
if	O
there	O
are	O
50	O
%	O
outliers	O
then	O
a	O
distance	B
below	O
the	O
median	O
value	O
(	O
the	O
quartile	O
say	O
)	O
should	O
be	O
used	O
.	O
both	O
the	O
ransac	O
and	O
lms	O
algorithms	O
are	O
able	O
to	O
cope	O
with	O
a	O
large	O
proportion	O
of	O
outliers	O
.	O
if	O
the	O
number	O
of	O
outliers	O
is	O
small	O
,	O
then	O
other	O
robust	B
methods	I
may	O
well	O
be	O
more	O
efﬁcient	O
.	O
these	O
include	O
case	O
deletion	O
,	O
where	O
each	O
point	B
in	O
turn	O
is	O
deleted	O
and	O
the	O
model	B
ﬁtted	O
to	O
the	O
remaining	O
data	O
;	O
and	O
iterative	B
weighted	O
least-squares	O
,	O
where	O
a	O
data	O
point	B
’	O
s	O
inﬂuence	O
on	O
the	O
ﬁt	O
is	O
weighted	B
inversely	O
by	O
its	O
residual	B
.	O
generally	O
these	O
methods	O
are	O
not	O
recommended	O
.	O
both	O
torr	O
[	O
torr-95b	O
]	O
and	O
xu	O
and	O
zhang	O
[	O
xu-96	O
]	O
describe	O
and	O
compare	O
various	O
robust	B
estimators	O
for	O
estimating	O
the	O
fundamental	B
matrix	I
.	O
4.8	O
automatic	O
computation	B
of	I
a	O
homography	B
123	O
objective	O
compute	O
the	O
2d	O
homography	B
between	O
two	O
images	O
.	O
algorithm	B
(	O
i	O
)	O
interest	B
points	I
:	O
compute	O
interest	B
points	I
in	O
each	O
image	O
.	O
(	O
ii	O
)	O
putative	O
correspondences	B
:	O
compute	O
a	O
set	O
of	O
interest	O
point	B
matches	O
based	O
on	O
proxim-	O
ity	O
and	O
similarity	B
of	O
their	O
intensity	O
neighbourhood	O
.	O
(	O
iii	O
)	O
ransac	O
robust	B
estimation	O
:	O
repeat	O
for	O
n	O
samples	O
,	O
where	O
n	O
is	O
determined	O
adap-	O
tively	O
as	O
in	O
algorithm	B
4.5	O
:	O
(	O
a	O
)	O
select	O
a	O
random	O
sample	O
of	O
4	O
correspondences	B
and	O
compute	O
the	O
homography	B
h.	O
(	O
b	O
)	O
calculate	O
the	O
distance	B
d⊥	O
for	O
each	O
putative	O
correspondence	B
.	O
(	O
c	O
)	O
compute	O
the	O
number	O
of	O
inliers	O
consistent	O
with	O
h	O
by	O
the	O
number	O
of	O
correspon-	O
√	O
dences	O
for	O
which	O
d⊥	O
<	O
t	O
=	O
5.99	O
σ	O
pixels	O
.	O
choose	O
the	O
h	O
with	O
the	O
largest	O
number	O
of	O
inliers	O
.	O
in	O
the	O
case	O
of	O
ties	O
choose	O
the	O
solution	B
that	O
has	O
the	O
lowest	O
standard	O
deviation	O
of	O
inliers	O
.	O
(	O
iv	O
)	O
optimal	O
estimation	B
:	O
re-estimate	O
h	O
from	O
all	O
correspondences	B
classiﬁed	O
as	O
inliers	O
,	O
by	O
minimizing	O
the	O
ml	O
cost	B
function	I
(	O
4.8–p95	O
)	O
using	O
the	O
levenberg–marquardt	O
algorithm	B
of	O
section	O
a6.2	O
(	O
p600	O
)	O
.	O
(	O
v	O
)	O
guided	B
matching	I
:	O
further	O
interest	O
point	O
correspondences	B
are	O
now	O
determined	O
using	O
the	O
estimated	O
h	O
to	O
deﬁne	O
a	O
search	O
region	O
about	O
the	O
transferred	O
point	B
position	O
.	O
the	O
last	O
two	O
steps	O
can	O
be	O
iterated	O
until	O
the	O
number	O
of	O
correspondences	O
is	O
stable	O
.	O
algorithm	B
4.6.	O
automatic	O
estimation	B
of	I
a	O
homography	B
between	O
two	O
images	O
using	O
ransac	O
.	O
4.8	O
automatic	O
computation	B
of	I
a	O
homography	B
this	O
section	O
describes	O
an	O
algorithm	B
to	O
automatically	O
compute	O
a	O
homography	B
between	O
two	O
images	O
.	O
the	O
input	O
to	O
the	O
algorithm	B
is	O
simply	O
the	O
images	O
,	O
with	O
no	O
other	O
a	O
priori	O
information	O
required	O
;	O
and	O
the	O
output	O
is	O
the	O
estimated	O
homography	B
together	O
with	O
a	O
set	O
of	O
interest	O
points	O
in	O
correspondence	B
.	O
the	O
algorithm	B
might	O
be	O
applied	O
,	O
for	O
example	O
,	O
to	O
two	O
images	O
of	O
a	O
planar	O
surface	O
or	O
two	O
images	O
acquired	O
by	O
rotating	O
a	O
camera	B
about	O
its	O
centre	B
.	O
the	O
ﬁrst	O
step	O
of	O
the	O
algorithm	O
is	O
to	O
compute	O
interest	B
points	I
in	O
each	O
image	O
.	O
we	O
are	O
then	O
faced	O
with	O
a	O
“	O
chicken	O
and	O
egg	O
”	O
problem	O
:	O
once	O
the	O
correspondence	B
between	O
the	O
interest	B
points	I
is	O
established	O
the	O
homography	B
can	O
be	O
computed	O
;	O
conversely	O
,	O
given	O
the	O
homography	B
the	O
correspondence	B
between	O
the	O
interest	B
points	I
can	O
easily	O
be	O
established	O
.	O
this	O
problem	O
is	O
resolved	O
by	O
using	O
robust	O
estimation	B
,	O
here	O
ransac	O
,	O
as	O
a	O
“	O
search	O
en-	O
gine	O
”	O
.	O
the	O
idea	O
is	O
ﬁrst	O
to	O
obtain	O
by	O
some	O
means	O
a	O
set	O
of	O
putative	O
point	B
correspondences	O
.	O
it	O
is	O
expected	O
that	O
a	O
proportion	O
of	O
these	O
correspondences	B
will	O
in	O
fact	O
be	O
mismatches	O
.	O
ransac	O
is	O
designed	O
to	O
deal	O
with	O
exactly	O
this	O
situation	O
–	O
estimate	O
the	O
homography	B
and	O
also	O
a	O
set	O
of	O
inliers	O
consistent	O
with	O
this	O
estimate	O
(	O
the	O
true	O
correspondences	B
)	O
,	O
and	O
outliers	O
(	O
the	O
mismatches	O
)	O
.	O
the	O
algorithm	B
is	O
summarized	O
in	O
algorithm	O
4.6	O
,	O
with	O
an	O
example	O
of	O
its	O
use	O
shown	O
in	O
ﬁgure	O
4.9	O
,	O
and	O
the	O
steps	O
described	O
in	O
more	O
detail	O
below	O
.	O
algorithms	O
with	O
essentially	O
the	O
same	O
methodology	O
enable	O
the	O
automatic	O
computation	B
of	I
the	O
fundamental	B
matrix	I
and	O
trifocal	B
tensor	I
directly	O
from	O
image	O
pairs	O
and	O
triplets	O
respectively	O
.	O
this	O
computation	B
is	O
described	O
in	O
chapter	O
11	O
and	O
chapter	O
16	O
.	O
124	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
determining	B
putative	O
correspondences	B
.	O
the	O
aim	O
,	O
in	O
the	O
absence	O
of	O
any	O
knowledge	O
of	O
the	O
homography	O
,	O
is	O
to	O
provide	O
an	O
initial	O
point	O
correspondence	B
set	O
.	O
a	O
good	O
proportion	O
of	O
these	O
correspondences	B
should	O
be	O
correct	O
,	O
but	O
the	O
aim	O
is	O
not	O
perfect	O
matching	B
,	O
since	O
ransac	O
will	O
later	O
be	O
used	O
to	O
eliminate	O
the	O
mismatches	O
.	O
think	O
of	O
these	O
as	O
“	O
seed	O
”	O
correspondences	B
.	O
these	O
putative	O
correspondences	B
are	O
obtained	O
by	O
detecting	O
interest	B
points	I
independently	O
in	O
each	O
image	O
,	O
and	O
then	O
matching	B
these	O
interest	B
points	I
using	O
a	O
combination	O
of	O
proximity	O
and	O
similarity	B
of	O
intensity	O
neighbourhoods	O
as	O
follows	O
.	O
for	O
brevity	O
,	O
the	O
interest	B
points	I
will	O
be	O
referred	O
to	O
as	O
‘	O
corners	O
’	O
.	O
however	O
,	O
these	O
corners	O
need	O
not	O
be	O
images	O
of	O
physical	O
corners	O
in	O
the	O
scene	O
.	O
the	O
corners	O
are	O
deﬁned	O
by	O
a	O
minimum	O
of	O
the	O
image	O
auto-correlation	O
function	O
.	O
for	O
each	O
corner	O
at	O
(	O
x	O
,	O
y	O
)	O
in	O
image	O
1	O
the	O
match	O
with	O
highest	O
neighbourhood	O
cross-	O
correlation	B
in	O
image	O
2	O
is	O
selected	O
within	O
a	O
square	O
search	O
region	O
centred	O
on	O
(	O
x	O
,	O
y	O
)	O
.	O
sym-	O
metrically	O
,	O
for	O
each	O
corner	O
in	O
image	O
2	O
the	O
match	O
is	O
sought	O
in	O
image	O
1.	O
occasionally	O
there	O
will	O
be	O
a	O
conﬂict	O
where	O
a	O
corner	O
in	B
one	I
image	I
is	O
“	O
claimed	O
”	O
by	O
more	O
than	O
one	O
corner	O
in	O
the	O
other	O
.	O
in	O
such	O
cases	O
a	O
“	O
winner	O
takes	O
all	O
”	O
scheme	O
is	O
applied	O
and	O
only	O
the	O
match	O
with	O
highest	O
cross-correlation	O
is	O
retained	O
.	O
a	O
variation	O
on	O
the	O
similarity	B
measure	O
is	O
to	O
use	O
squared	O
sum	O
of	O
intensity	O
differences	O
(	O
ssd	O
)	O
instead	O
of	O
(	O
normalized	O
)	O
cross-correlation	O
(	O
cc	O
)	O
.	O
cc	O
is	O
invariant	O
to	O
the	O
afﬁne	B
mapping	O
of	O
the	O
intensity	O
values	O
(	O
i.e	O
.	O
i	O
(	O
cid:6	O
)	O
→	O
αi+β	O
,	O
scaling	B
plus	O
offset	O
)	O
which	O
often	O
occurs	O
in	O
practice	O
between	O
images	O
.	O
ssd	O
is	O
not	O
invariant	O
to	O
this	O
mapping	O
.	O
however	O
,	O
ssd	O
is	O
often	O
preferred	O
when	O
there	O
is	O
small	O
variation	O
in	O
intensity	O
between	O
images	O
,	O
because	O
it	O
is	O
a	O
more	O
sensitive	O
measure	O
than	O
cc	O
and	O
is	O
computationally	O
cheaper	O
.	O
ransac	O
for	O
a	O
homography	O
.	O
the	O
ransac	O
algorithm	B
is	O
applied	O
to	O
the	O
putative	O
correspondence	B
set	O
to	O
estimate	O
the	O
homography	B
and	O
the	O
(	O
inlier	O
)	O
correspondences	B
which	O
are	O
consistent	O
with	O
this	O
estimate	O
.	O
the	O
sample	O
size	O
is	O
four	O
,	O
since	O
four	O
correspondences	O
determine	O
a	O
homography	B
.	O
the	O
number	B
of	I
samples	I
is	O
set	O
adaptively	O
as	O
the	O
proportion	O
of	O
outliers	O
is	O
determined	O
from	O
each	O
consensus	O
set	O
,	O
as	O
described	O
in	O
algorithm	O
4.5.	O
there	O
are	O
two	O
issues	O
:	O
what	O
is	O
the	O
“	O
distance	B
”	O
in	O
this	O
case	O
?	O
and	O
how	O
should	O
the	O
samples	O
be	O
selected	O
?	O
(	O
i	O
)	O
distance	B
measure	O
:	O
the	O
simplest	O
method	O
of	O
assessing	O
the	O
error	B
of	O
a	O
corre-	O
spondence	O
from	O
a	O
homography	B
h	O
is	O
to	O
use	O
the	O
symmetric	B
transfer	I
error	I
,	O
i.e	O
.	O
transfer	B
=	O
d	O
(	O
x	O
,	O
h−1x	O
(	O
cid:2	O
)	O
is	O
the	O
point	B
correspon-	O
d2	O
dence	O
.	O
a	O
better	O
,	O
though	O
more	O
expensive	O
,	O
distance	B
measure	O
is	O
the	O
reprojection	B
error	I
,	O
d2⊥	O
=	O
d	O
(	O
x	O
,	O
ˆx	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
=	O
hˆx	O
is	O
the	O
perfect	O
correspondence	B
.	O
this	O
measure	O
is	O
more	O
expensive	O
because	O
ˆx	O
must	O
also	O
be	O
computed	O
.	O
a	O
further	O
alternative	O
is	O
sampson	O
error	B
.	O
,	O
hx	O
)	O
2	O
,	O
where	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
)	O
2	O
,	O
where	O
ˆx	O
(	O
cid:2	O
)	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
,	O
ˆx	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
sample	O
selection	O
:	O
there	O
are	O
two	O
issues	O
here	O
.	O
first	O
,	O
degenerate	B
samples	O
should	O
be	O
disregarded	O
.	O
for	O
example	O
,	O
if	O
three	O
of	O
the	O
four	O
points	O
are	O
collinear	O
then	O
a	O
homography	B
can	O
not	O
be	O
computed	O
;	O
second	O
,	O
the	O
sample	O
should	O
consist	O
of	B
points	I
with	O
a	O
good	O
spatial	O
distribution	B
over	O
the	O
image	O
.	O
this	O
is	O
because	O
of	O
the	O
extrap-	O
olation	O
problem	O
–	O
an	O
estimated	O
homography	B
will	O
accurately	O
map	O
the	O
region	O
straddled	O
by	O
the	O
computation	B
points	O
,	O
but	O
the	O
accuracy	O
generally	O
deteriorates	O
4.8	O
automatic	O
computation	B
of	I
a	O
homography	B
125	O
with	O
distance	O
from	O
this	O
region	O
(	O
think	O
of	O
four	O
points	O
in	O
the	O
very	O
top	O
corner	O
of	O
the	O
image	O
)	O
.	O
distributed	O
spatial	O
sampling	O
can	O
be	O
implemented	O
by	O
tiling	O
the	O
image	O
and	O
ensuring	O
,	O
by	O
a	O
suitable	O
weighting	O
of	O
the	O
random	O
sampler	O
,	O
that	O
samples	O
with	O
points	O
lying	O
in	O
different	O
tiles	O
are	O
the	O
more	O
likely	O
.	O
robust	B
ml	O
estimation	B
and	O
guided	B
matching	I
.	O
the	O
aim	O
of	O
this	O
ﬁnal	O
stage	O
is	O
two-	O
fold	O
:	O
ﬁrst	O
,	O
to	O
obtain	O
an	O
improved	O
estimate	O
of	O
the	O
homography	O
by	O
using	O
all	O
the	O
inliers	O
in	O
the	O
estimation	B
(	O
rather	O
than	O
only	O
the	O
four	O
points	O
of	O
the	O
sample	O
)	O
;	O
second	O
,	O
to	O
obtain	O
more	O
inlying	O
matches	O
from	O
the	O
putative	O
correspondence	B
set	O
because	O
a	O
more	O
accurate	O
homog-	O
raphy	O
is	O
available	O
.	O
an	O
improved	O
estimate	O
of	O
the	O
homography	O
is	O
then	O
computed	O
from	O
the	O
inliers	O
by	O
minimizing	B
an	O
ml	O
cost	B
function	I
.	O
this	O
ﬁnal	O
stage	O
can	O
be	O
implemented	O
in	O
two	O
ways	O
.	O
one	O
way	O
is	O
to	O
carry	O
out	O
an	O
ml	O
estimation	B
on	O
the	O
inliers	O
,	O
then	O
recompute	O
the	O
inliers	O
using	O
the	O
new	O
estimated	O
h	O
,	O
and	O
repeat	O
this	O
cycle	O
until	O
the	O
number	O
of	O
inliers	O
converges	O
.	O
the	O
ml	O
cost	B
function	I
minimization	O
is	O
carried	O
out	O
using	O
the	O
levenberg–	O
marquardt	O
algorithm	B
described	O
in	O
section	O
a6.2	O
(	O
p600	O
)	O
.	O
the	O
alternative	O
is	O
to	O
estimate	O
the	O
homography	B
and	O
inliers	O
simultaneously	O
by	O
minimizing	B
a	O
robust	B
ml	O
cost	B
function	I
of	O
(	O
4.19	O
)	O
as	O
described	O
in	O
section	O
4.7.2.	O
the	O
disadvantage	O
of	O
the	O
simultaneous	O
approach	O
is	O
the	O
computational	O
effort	O
incurred	O
in	O
the	O
minimization	B
of	O
the	O
cost	B
function	I
.	O
for	O
this	O
reason	O
the	O
cycle	O
approach	O
is	O
usually	O
the	O
more	O
attractive	O
.	O
4.8.1	O
application	B
domain	I
the	O
algorithm	B
requires	O
that	O
interest	B
points	I
can	O
be	O
recovered	O
fairly	O
uniformly	O
across	O
the	O
image	O
,	O
and	O
this	O
in	O
turn	O
requires	O
scenes	O
and	O
resolutions	O
which	O
support	O
this	O
requirement	O
.	O
scenes	O
should	O
be	O
lightly	O
textured	O
–	O
images	O
of	O
blank	O
walls	O
are	O
not	O
ideal	O
.	O
the	O
search	O
window	O
proximity	O
constraint	O
places	O
an	O
upper	O
limit	O
on	O
the	O
image	O
motion	O
of	O
corners	O
(	O
the	O
disparity	O
)	O
between	O
views	O
.	O
however	O
,	O
the	O
algorithm	B
is	O
not	O
defeated	O
if	O
this	O
constraint	O
is	O
not	O
applied	O
,	O
and	O
in	O
practice	O
the	O
main	O
role	O
of	O
the	O
proximity	O
constraint	O
is	O
to	O
reduce	O
computational	B
complexity	I
,	O
as	O
a	O
smaller	O
search	O
window	O
means	O
that	O
fewer	O
corner	O
matches	O
must	O
be	O
evaluated	O
.	O
ultimately	O
the	O
scope	O
of	O
the	O
algorithm	O
is	O
limited	O
by	O
the	O
success	O
of	O
the	O
corner	O
neigh-	O
bourhood	O
similarity	B
measure	O
(	O
ssd	O
or	O
cc	O
)	O
in	O
providing	O
disambiguation	O
between	O
cor-	O
respondences	O
.	O
failure	O
generally	O
results	O
from	O
lack	O
of	O
spatial	O
invariance	O
:	O
the	O
measures	O
are	O
only	O
invariant	O
to	O
image	O
translation	O
,	O
and	O
are	O
severely	O
degraded	O
by	O
transformations	O
outside	O
this	O
class	O
such	O
as	O
image	O
rotation	B
or	O
signiﬁcant	O
differences	O
in	O
foreshortening	O
between	O
images	O
.	O
one	O
solution	B
is	O
to	O
use	O
measures	O
with	O
a	O
greater	O
invariance	O
to	O
the	O
ho-	O
mography	O
mapping	O
between	O
images	O
,	O
for	O
example	O
measures	O
which	O
are	O
rotationally	O
in-	O
variant	O
.	O
an	O
alternative	O
solution	B
is	O
to	O
use	O
an	O
initial	O
estimate	O
of	O
the	O
homography	O
to	O
map	O
between	O
intensity	O
neighbourhoods	O
.	O
details	O
are	O
beyond	O
the	O
scope	O
of	O
this	O
discussion	O
,	O
but	O
are	O
provided	O
in	O
[	O
pritchett-98	O
,	O
schmid-98	O
]	O
.	O
the	O
use	O
of	O
robust	B
estimation	O
confers	O
moderate	O
immunity	O
to	O
independent	O
motion	O
,	O
changes	O
in	O
shadows	O
,	O
partial	O
occlusions	O
etc	O
.	O
126	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
a	O
c	O
e	O
g	O
b	O
d	O
f	O
h	O
fig	O
.	O
4.9.	O
automatic	O
computation	B
of	I
a	O
homography	B
between	O
two	O
images	O
using	O
ransac	O
.	O
the	O
mo-	O
tion	O
between	O
views	O
is	O
a	O
rotation	B
about	O
the	O
camera	B
centre	I
so	O
the	O
images	O
are	O
exactly	O
related	O
by	O
a	O
homog-	O
raphy	O
.	O
(	O
a	O
)	O
(	O
b	O
)	O
left	O
and	O
right	O
images	O
of	O
keble	O
college	O
,	O
oxford	O
.	O
the	O
images	O
are	O
640	O
×	O
480	O
pixels	O
.	O
(	O
c	O
)	O
(	O
d	O
)	O
detected	O
corners	O
superimposed	O
on	O
the	O
images	O
.	O
there	O
are	O
approximately	O
500	O
corners	O
on	O
each	O
image	O
.	O
the	O
following	O
results	O
are	O
superimposed	O
on	O
the	O
left	O
image	O
:	O
(	O
e	O
)	O
268	O
putative	O
matches	O
shown	O
by	O
the	O
line	B
linking	O
corners	O
,	O
note	O
the	O
clear	O
mismatches	O
;	O
(	O
f	O
)	O
outliers	O
–	O
117	O
of	O
the	O
putative	O
matches	O
;	O
(	O
g	O
)	O
inliers	O
–	O
151	O
corre-	O
spondences	O
consistent	O
with	O
the	O
estimated	O
h	O
;	O
(	O
h	O
)	O
ﬁnal	O
set	O
of	O
262	O
correspondences	B
after	O
guided	B
matching	I
and	O
mle	O
.	O
4.9	O
closure	O
127	O
4.8.2	O
implementation	B
and	O
run	B
details	I
interest	O
points	O
are	O
obtained	O
using	O
the	O
harris	O
[	O
harris-88	O
]	O
corner	O
detector	O
.	O
this	O
detec-	O
tor	O
localizes	O
corners	O
to	O
sub-pixel	O
accuracy	O
,	O
and	O
it	O
has	O
been	O
found	O
empirically	O
that	O
the	O
correspondence	B
error	O
is	O
usually	O
less	O
than	O
a	O
pixel	O
[	O
schmid-98	O
]	O
.	O
when	O
obtaining	O
seed	O
correspondences	B
,	O
in	O
the	O
putative	O
correspondence	B
stage	O
of	O
the	O
algorithm	O
,	O
the	O
threshold	O
on	O
the	O
neighbourhood	O
similarity	B
measure	O
for	O
match	O
acceptance	O
is	O
deliberately	O
conservative	O
to	O
minimize	O
incorrect	O
matches	O
(	O
the	O
ssd	O
threshold	O
is	O
20	O
)	O
.	O
for	O
the	O
guided	B
matching	I
stage	O
this	O
threshold	O
is	O
relaxed	O
(	O
it	O
is	O
doubled	O
)	O
so	O
that	O
additional	O
putative	O
correspondences	B
are	O
available	O
.	O
1	O
−	O
	O
number	O
of	O
inliers	O
adaptive	B
n	O
6	O
10	O
44	O
58	O
73	O
151	O
2	O
%	O
20,028,244	O
3	O
%	O
2,595,658	O
6,922	O
16	O
%	O
2,291	O
21	O
%	O
911	O
26	O
%	O
56	O
%	O
43	O
table	O
4.4.	O
the	O
results	O
of	O
the	O
adaptive	B
algorithm	O
4.5	O
used	O
during	O
ransac	O
to	O
compute	O
the	O
homography	B
for	O
ﬁgure	O
4.9.	O
n	O
is	O
the	O
total	O
number	O
of	O
samples	O
required	O
as	O
the	O
algorithm	B
runs	O
for	O
p	O
=	O
0.99	O
probability	O
of	O
no	O
outliers	O
in	O
the	O
sample	O
.	O
the	O
algorithm	B
terminated	O
after	O
43	O
samples	O
.	O
for	O
the	O
example	O
of	O
ﬁgure	O
4.9	O
the	O
images	O
are	O
640×480	O
pixels	O
,	O
and	O
the	O
search	O
window	O
±320	O
pixels	O
,	O
i.e	O
.	O
the	O
entire	O
image	O
.	O
of	O
course	O
a	O
much	O
smaller	O
search	O
window	O
could	O
have	O
been	O
used	O
given	O
the	O
actual	O
point	B
disparities	O
in	O
this	O
case	O
.	O
often	O
in	O
video	O
sequences	O
a	O
search	O
window	O
of	O
±40	O
pixels	O
sufﬁces	O
(	O
i.e	O
.	O
a	O
square	O
of	O
side	O
80	O
centred	O
on	O
the	O
current	O
position	O
)	O
.	O
the	O
inlier	O
threshold	O
was	O
t	O
=	O
1.25	O
pixels	O
.	O
a	O
total	O
of	O
43	O
samples	O
were	O
required	O
,	O
with	O
the	O
sampling	O
run	O
as	O
shown	O
in	O
table	O
4.4.	O
the	O
guided	B
matching	I
required	O
two	O
iterations	O
of	O
the	O
mle–inlier	O
classiﬁcation	B
cycle	O
.	O
the	O
rms	O
values	O
for	O
d⊥	O
pixel	O
error	B
were	O
0.23	O
before	O
the	O
mle	O
and	O
0.19	O
after	O
.	O
the	O
levenberg–marquardt	O
algorithm	B
required	O
10	O
iterations	O
.	O
4.9	O
closure	O
this	O
chapter	O
has	O
illustrated	O
the	O
issues	O
and	O
techniques	O
that	O
apply	O
to	O
estimating	O
the	O
ten-	O
sors	O
representing	O
multiple	O
view	O
relations	O
.	O
these	O
ideas	O
will	O
reoccur	O
in	O
each	O
of	O
the	O
com-	O
putation	O
chapters	O
throughout	O
the	O
book	O
.	O
in	O
each	O
case	O
there	O
are	O
a	O
minimal	O
number	O
of	O
correspondences	O
required	O
;	O
degenerate	B
conﬁgurations	I
that	O
should	O
be	O
avoided	O
;	O
algebraic	B
and	O
geometric	B
errors	O
that	O
can	O
be	O
minimized	O
when	O
more	O
than	O
the	O
minimal	O
number	O
of	O
correspondences	O
are	O
available	O
;	O
parametrizations	O
that	O
enforce	O
internal	B
constraints	O
on	O
the	O
tensor	B
etc	O
.	O
4.9.1	O
the	O
literature	O
the	O
dlt	O
algorithm	B
dates	O
back	O
at	O
least	O
to	O
sutherland	O
[	O
sutherland-63	O
]	O
.	O
sampson	O
’	O
s	O
clas-	O
sic	O
paper	O
on	O
conic	O
ﬁtting	O
(	O
an	O
improvement	O
on	O
the	O
equally	O
classic	O
bookstein	O
algorithm	B
)	O
128	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
appeared	O
in	O
[	O
sampson-82	O
]	O
.	O
normalization	B
was	O
made	O
public	O
in	O
the	O
computer	O
vision	O
literature	O
by	O
hartley	O
[	O
hartley-97c	O
]	O
.	O
related	O
reading	O
on	O
numerical	O
methods	O
may	O
be	O
found	O
in	O
the	O
excellent	O
numerical	O
recipes	O
in	O
c	O
[	O
press-88	O
]	O
,	O
and	O
also	O
gill	O
and	O
murray	O
[	O
gill-78	O
]	O
for	O
iterative	O
minimization	B
.	O
fischler	O
and	O
bolles	O
’	O
[	O
fischler-81	O
]	O
ransac	O
was	O
one	O
of	O
the	O
earliest	O
robust	B
algo-	O
rithms	O
,	O
and	O
in	O
fact	O
was	O
developed	O
to	O
solve	O
a	O
computer	O
vision	O
problem	O
(	O
pose	O
from	O
3	O
points	O
)	O
.	O
the	O
original	O
paper	O
is	O
very	O
clearly	O
argued	O
and	O
well	O
worth	O
reading	O
.	O
other	O
background	O
material	O
on	O
robustness	O
may	O
be	O
found	O
in	O
rousseeuw	O
[	O
rousseeuw-87	O
]	O
.	O
the	O
primary	O
application	O
of	O
robust	B
estimation	O
in	O
computer	O
vision	O
was	O
to	O
estimating	O
the	O
fun-	O
damental	O
matrix	B
(	O
chapter	O
11	O
)	O
,	O
by	O
torr	O
and	O
murray	O
[	O
torr-93	O
]	O
using	O
ransac	O
,	O
and	O
,	O
zhang	O
et	O
al	O
.	O
[	O
zhang-95	O
]	O
using	O
lms	O
.	O
the	O
automatic	O
ml	O
estimation	B
of	I
a	O
homography	B
was	O
described	O
by	O
torr	O
and	O
zisserman	O
[	O
torr-98	O
]	O
.	O
4.9.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
computing	B
homographies	O
of	O
ipn	O
.	O
the	O
derivation	B
of	O
(	O
4.1–p89	O
)	O
and	O
(	O
4.3–p89	O
)	O
assumed	O
that	O
the	O
dimension	O
of	O
x	O
(	O
cid:2	O
)	O
i	O
is	O
three	O
,	O
so	O
that	O
the	O
cross-product	O
is	O
deﬁned	O
.	O
however	O
,	O
(	O
4.3	O
)	O
may	O
be	O
derived	O
in	O
a	O
way	O
that	O
generalizes	O
to	O
all	O
dimensions	O
.	O
(	O
cid:2	O
)	O
assuming	O
that	O
w	O
i	O
=	O
1	O
,	O
we	O
may	O
solve	O
for	O
the	O
unknown	O
scale	O
factor	O
explicitly	O
by	O
writing	O
hxi	O
=	O
k	O
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
t.	O
from	O
the	O
third	O
coordinate	O
we	O
obtain	O
k	O
=	O
h3txi	O
,	O
and	O
substituting	O
this	O
into	O
the	O
original	O
equation	O
gives	O
(	O
cid:2	O
)	O
h3txi	O
x	O
(	O
cid:2	O
)	O
i	O
h3txi	O
y	O
i	O
h1txi	O
h2txi	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
=	O
which	O
leads	O
directly	O
to	O
(	O
4.3	O
)	O
.	O
(	O
ii	O
)	O
computing	B
homographies	O
for	O
ideal	O
points	O
.	O
i	O
is	O
an	O
(	O
cid:2	O
)	O
ideal	B
point	I
,	O
so	O
that	O
w	O
i	O
=	O
0	O
,	O
then	O
the	O
pair	O
of	O
equations	O
(	O
4.3	O
)	O
collapses	O
to	O
a	O
single	O
equation	O
although	O
(	O
4.1	O
)	O
does	O
contain	O
two	O
independent	O
equations	O
.	O
to	O
avoid	O
such	O
degeneracy	B
,	O
while	O
including	O
only	O
the	O
minimum	O
number	O
of	O
equations	O
,	O
a	O
good	O
way	O
to	O
proceed	O
is	O
as	O
follows	O
.	O
we	O
may	O
rewrite	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
hxi	O
as	O
if	O
one	O
of	O
the	O
points	O
x	O
(	O
cid:2	O
)	O
[	O
x	O
(	O
cid:2	O
)	O
⊥hxi	O
=	O
0	O
i	O
]	O
is	O
a	O
matrix	B
with	O
rows	O
orthogonal	B
to	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
0.	O
each	O
leads	O
to	O
a	O
separate	O
linear	B
equation	O
in	O
the	O
entries	O
of	O
h.	O
the	O
matrix	B
may	O
be	O
obtained	O
by	O
deleting	O
the	O
ﬁrst	O
row	O
of	O
an	O
orthogonal	B
matrix	O
m	O
satis-	O
i	O
=	O
(	O
1	O
,	O
0	O
,	O
.	O
.	O
.	O
,0	O
)	O
t.	O
a	O
householder	O
matrix	B
(	O
see	O
section	O
a4.1.2	O
(	O
p580	O
)	O
)	O
where	O
[	O
x	O
(	O
cid:2	O
)	O
⊥	O
i	O
]	O
row	O
of	O
[	O
x	O
(	O
cid:2	O
)	O
⊥	O
i	O
]	O
[	O
x	O
(	O
cid:2	O
)	O
⊥	O
i	O
]	O
fying	O
mx	O
(	O
cid:2	O
)	O
is	O
an	O
easily	O
constructed	O
matrix	B
with	O
the	O
desired	O
property	O
.	O
i	O
so	O
that	O
[	O
x	O
(	O
cid:2	O
)	O
⊥x	O
(	O
cid:2	O
)	O
i	O
]	O
(	O
iii	O
)	O
scaling	B
unbounded	O
point	B
sets	O
.	O
in	O
the	O
case	O
of	B
points	I
at	O
or	O
near	O
inﬁnity	O
in	O
a	O
plane	B
,	O
it	O
is	O
neither	O
reasonable	O
nor	O
feasible	O
to	O
normalize	O
coordinates	B
using	O
the	O
isotropic	B
(	O
or	O
non-isotropic	B
)	O
scaling	B
schemes	O
presented	O
in	O
this	O
chapter	O
,	O
since	O
the	O
centroid	O
and	O
scale	O
are	O
inﬁnite	O
or	O
near	O
inﬁnite	O
.	O
a	O
method	O
that	O
seems	O
to	O
give	O
good	O
results	O
is	O
to	O
normalize	O
the	O
set	O
of	B
points	I
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
wi	O
)	O
t	O
such	O
that	O
i	O
=	O
1∀i	O
x2	O
i	O
+	O
y2	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
yi	O
=	O
0	O
;	O
i	O
=	O
2	O
;	O
x2	O
i	O
+	O
y2	O
i	O
+	O
w2	O
xi	O
=	O
w2	O
i	O
i	O
i	O
i	O
i	O
4.9	O
closure	O
129	O
note	O
that	O
the	O
coordinates	B
xi	O
and	O
yi	O
appearing	O
here	O
are	O
the	O
homogeneous	O
co-	O
ordinates	O
,	O
and	O
the	O
conditions	O
no	O
longer	O
imply	O
that	O
the	O
centroid	O
is	O
at	O
the	O
origin	O
.	O
investigate	O
methods	O
of	O
achieving	O
this	O
normalization	B
,	O
and	O
evaluate	O
its	O
properties	B
.	O
(	O
iv	O
)	O
transformation	B
invariance	I
of	O
dlt	O
.	O
we	O
consider	O
computation	B
of	I
a	O
2d	O
ho-	O
mography	O
by	O
minimizing	B
algebraic	I
error	O
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
(	O
see	O
(	O
4.5–p94	O
)	O
)	O
subject	O
to	O
vari-	O
ous	O
constraints	B
.	O
prove	O
the	O
following	O
cases	O
:	O
(	O
a	O
)	O
if	O
(	O
cid:10	O
)	O
ah	O
(	O
cid:10	O
)	O
is	O
minimized	O
subject	O
to	O
the	O
constraint	O
h9	O
=	O
h33	O
=	O
1	O
,	O
then	O
the	O
result	O
is	O
invariant	O
under	O
change	O
of	O
scale	O
but	O
not	O
translation	O
of	O
coordi-	O
nates	O
.	O
(	O
b	O
)	O
if	O
instead	O
the	O
constraint	O
is	O
h2	O
31	O
+	O
h2	O
32	O
=	O
1	O
then	O
the	O
result	O
is	O
similarity	B
invariant	O
.	O
(	O
c	O
)	O
afﬁne	B
case	O
:	O
the	O
same	O
is	O
true	O
for	O
the	O
constraint	O
h31	O
=	O
h32	O
=	O
0	O
;	O
h33	O
=	O
1	O
.	O
(	O
v	O
)	O
expressions	O
for	O
image	O
coordinate	O
derivatives	O
.	O
for	O
the	O
map	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
˜y	O
)	O
t	O
are	O
the	O
inhomogeneous	O
coordinates	O
of	O
the	O
image	O
point	B
)	O
:	O
)	O
t	O
=	O
hx	O
,	O
derive	O
the	O
following	O
expressions	O
(	O
where	O
˜x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
/w	O
,	O
y	O
/w	O
,	O
w	O
(	O
cid:2	O
)	O
,	O
y	O
=	O
(	O
˜x	O
(	O
x	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
)	O
t	O
=	O
(	O
cid:17	O
)	O
(	O
a	O
)	O
derivative	O
wrt	O
x	O
∂	O
˜x	O
(	O
cid:2	O
)	O
1	O
/∂x	O
=	O
w	O
(	O
cid:2	O
)	O
where	O
hj	O
t	O
is	O
the	O
j−th	O
row	O
of	O
h.	O
(	O
cid:17	O
)	O
(	O
b	O
)	O
derivative	O
wrt	O
h	O
∂	O
˜x	O
(	O
cid:2	O
)	O
1	O
w	O
(	O
cid:2	O
)	O
with	O
h	O
as	O
deﬁned	O
in	O
(	O
4.2–p89	O
)	O
.	O
/∂h	O
=	O
(	O
cid:18	O
)	O
h1t	O
−	O
˜x	O
h2t	O
−	O
˜y	O
(	O
cid:2	O
)	O
h3t	O
(	O
cid:2	O
)	O
h3t	O
(	O
cid:18	O
)	O
0	O
−˜x	O
xt	O
0	O
xt	O
−˜y	O
(	O
cid:2	O
)	O
xt	O
(	O
cid:2	O
)	O
xt	O
(	O
4.20	O
)	O
(	O
4.21	O
)	O
(	O
vi	O
)	O
sampson	O
error	B
with	O
non-isotropic	B
error	O
distributions	O
.	O
the	O
derivation	B
of	O
sampson	O
error	O
in	O
section	O
4.2.6	O
(	O
p98	O
)	O
assumed	O
that	O
points	O
were	O
measured	O
with	O
circular	O
error	B
distributions	O
.	O
in	O
the	O
case	O
where	O
the	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
x	O
)	O
is	O
measured	O
with	O
covariance	O
matrix	B
σx	O
it	O
is	O
appropriate	O
instead	O
to	O
minimize	O
the	O
mahalanobis	O
norm	B
(	O
cid:10	O
)	O
δx	O
(	O
cid:10	O
)	O
2	O
x	O
δx	O
.	O
show	O
that	O
in	O
this	O
case	O
the	O
formulae	O
corresponding	O
to	O
(	O
4.11–p99	O
)	O
and	O
(	O
4.12–p99	O
)	O
are	O
δx	O
=	O
−σxjt	O
(	O
jσxjt	O
)	O
σx	O
=	O
δt	O
xς−1	O
(	O
4.22	O
)	O
−1	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
(	O
cid:10	O
)	O
δx	O
(	O
cid:10	O
)	O
2	O
σx	O
=	O
t	O
(	O
jσxj	O
t	O
)	O
−1	O
.	O
(	O
4.23	O
)	O
note	O
that	O
if	O
the	O
measurements	O
in	O
the	O
two	O
images	O
are	O
independent	O
,	O
then	O
the	O
co-	O
variance	B
matrix	O
σx	O
will	O
be	O
block-diagonal	O
with	O
two	O
2	O
×	O
2	O
diagonal	O
blocks	O
cor-	O
responding	O
to	O
the	O
two	O
images	O
.	O
(	O
vii	O
)	O
sampson	O
error	B
programming	O
hint	O
.	O
in	O
the	O
case	O
of	O
2d	O
homography	B
estima-	O
tion	O
,	O
and	O
in	O
fact	O
every	O
other	O
similar	O
problem	O
considered	O
in	O
this	O
book	O
,	O
the	O
cost	B
function	I
ch	O
(	O
x	O
)	O
=	O
a	O
(	O
x	O
)	O
h	O
of	O
section	O
4.2.6	O
(	O
p98	O
)	O
is	O
multilinear	O
in	O
the	O
coordinates	B
130	O
4	O
estimation	B
–	O
2d	O
projective	B
transformations	O
objective	O
given	O
n	O
≥	O
4	O
image	O
point	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
which	O
minimizes	O
reprojection	B
error	I
in	O
both	B
images	I
(	O
4.8–p95	O
)	O
.	O
i	O
}	O
,	O
determine	O
the	O
afﬁne	B
homography	O
ha	O
algorithm	B
(	O
a	O
)	O
express	O
points	O
as	O
inhomogeneous	O
2-vectors	O
.	O
translate	O
the	O
points	O
xi	O
by	O
a	O
translation	O
t	O
i	O
by	O
a	O
translation	O
t	O
(	O
cid:1	O
)	O
.	O
so	O
that	O
their	O
centroid	O
is	O
at	O
the	O
origin	O
.	O
do	O
the	O
same	O
to	O
the	O
points	O
x	O
(	O
cid:1	O
)	O
henceforth	O
work	O
with	O
the	O
translated	O
coordinates	B
.	O
(	O
b	O
)	O
form	O
the	O
n	O
×	O
4	O
matrix	B
a	O
whose	O
rows	O
are	O
the	O
vectors	O
xt	O
i	O
=	O
(	O
xt	O
i	O
,	O
x	O
(	O
cid:1	O
)	O
i	O
(	O
cid:1	O
)	O
t	O
)	O
=	O
(	O
xi	O
,	O
yi	O
,	O
x	O
i	O
,	O
y	O
(	O
cid:1	O
)	O
i	O
)	O
.	O
(	O
c	O
)	O
let	O
v1	O
and	O
v2	O
be	O
the	O
right	O
singular-vectors	O
of	O
a	O
corresponding	O
to	O
the	O
two	O
largest	O
(	O
sic	O
)	O
(	O
d	O
)	O
let	O
h2×2	O
=	O
cb−1	O
,	O
where	O
b	O
and	O
c	O
are	O
the	O
2	O
×	O
2	O
blocks	O
such	O
that	O
singular	B
values	I
.	O
(	O
e	O
)	O
the	O
required	O
homography	B
is	O
(	O
cid:24	O
)	O
(	O
cid:25	O
)	O
b	O
c	O
.	O
(	O
cid:25	O
)	O
,	O
[	O
v1v2	O
]	O
=	O
ha	O
=	O
(	O
cid:24	O
)	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
v1vt	O
h2×2	O
h2×2t	O
−	O
t	O
(	O
cid:1	O
)	O
0t	O
1	O
1	O
+	O
v2vt	O
2	O
)	O
xi	O
and	O
the	O
corresponding	O
estimate	O
of	O
the	O
image	O
points	O
is	O
given	O
by	O
algorithm	B
4.7.	O
the	O
gold	O
standard	O
algorithm	B
for	O
estimating	B
an	O
afﬁne	B
homography	O
ha	O
from	O
image	O
cor-	O
respondences	O
.	O
of	O
x.	O
this	O
means	O
that	O
the	O
partial	O
derivative	O
∂ch	O
(	O
x	O
)	O
/∂x	O
may	O
be	O
very	O
simply	O
computed	O
.	O
for	O
instance	O
,	O
the	O
derivative	O
∂ch	O
(	O
x	O
,	O
y	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
)	O
/∂x	O
=	O
ch	O
(	O
x	O
+	O
1	O
,	O
y	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
)	O
−	O
ch	O
(	O
x	O
,	O
y	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
)	O
,	O
y	O
is	O
exact	O
,	O
not	O
a	O
ﬁnite	B
difference	O
approximation	O
.	O
this	O
means	O
that	O
for	O
pro-	O
gramming	O
purposes	O
,	O
one	O
does	O
not	O
need	O
to	O
code	O
a	O
special	O
routine	O
for	O
taking	O
derivatives	O
–	O
the	O
routine	O
for	O
computing	O
ch	O
(	O
x	O
)	O
will	O
sufﬁce	O
.	O
denoting	O
by	O
ei	O
the	O
vector	O
containing	O
1	O
in	O
the	O
i-th	O
position	O
,	O
and	O
otherwise	O
0	O
,	O
one	O
sees	O
that	O
∂ch	O
(	O
x	O
)	O
/∂xi	O
=	O
ch	O
(	O
x	O
+	O
ei	O
)	O
−	O
ch	O
(	O
x	O
)	O
,	O
and	O
further	O
jjt	O
=	O
(	O
ch	O
(	O
x	O
+	O
ei	O
)	O
−	O
ch	O
(	O
x	O
)	O
)	O
(	O
ch	O
(	O
x	O
+	O
ei	O
)	O
−	O
ch	O
(	O
x	O
)	O
)	O
t	O
.	O
(	O
cid:7	O
)	O
i	O
also	O
note	O
that	O
computationally	O
it	O
is	O
more	O
efﬁcient	O
to	O
solve	O
jjtλ	O
=	O
−	O
directly	O
for	O
λ	O
,	O
rather	O
than	O
take	O
the	O
inverse	O
as	O
λ	O
=	O
−	O
(	O
jjt	O
)	O
(	O
viii	O
)	O
minimizing	B
geometric	I
error	O
for	O
afﬁne	O
transformations	O
.	O
given	O
a	O
set	O
of	O
correspondences	O
(	O
xi	O
,	O
yi	O
)	O
↔	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
)	O
,	O
ﬁnd	O
an	O
afﬁne	B
transformation	I
ha	O
that	O
mini-	O
mizes	O
geometric	B
error	I
(	O
4.8–p95	O
)	O
.	O
we	O
will	O
step	O
through	O
the	O
derivation	B
of	O
a	O
linear	B
algorithm	I
based	O
on	O
sampson	O
’	O
s	O
approximation	O
which	O
is	O
exact	O
in	O
this	O
case	O
.	O
the	O
complete	O
method	O
is	O
summarized	O
in	O
algorithm	O
4.7	O
.	O
−1	O
.	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
4.9	O
closure	O
131	O
(	O
a	O
)	O
show	O
that	O
the	O
optimum	O
afﬁne	B
transformation	I
takes	O
the	O
centroid	O
of	O
the	O
xi	O
to	O
the	O
centroid	O
of	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
so	O
by	O
translating	O
the	O
points	O
to	O
have	O
their	O
centroid	O
at	O
the	O
origin	O
,	O
the	O
translation	O
part	O
of	O
the	O
transformation	O
is	O
determined	O
.	O
it	O
is	O
only	O
necessary	O
then	O
to	O
determine	O
the	O
upper-left	O
2	O
×	O
2	O
submatrix	O
h2×2	O
of	O
ha	O
,	O
which	O
represents	O
the	O
linear	B
part	O
of	O
the	O
transformation	O
.	O
t	O
)	O
t	O
lies	O
on	O
vh	O
if	O
and	O
only	O
if	O
[	O
h2×2|−	O
i2×2	O
]	O
x	O
=	O
0	O
.	O
(	O
b	O
)	O
the	O
point	B
xi	O
=	O
(	O
xt	O
so	O
vh	O
is	O
a	O
codimension-2	O
subspace	O
of	O
ir4	O
.	O
(	O
c	O
)	O
any	O
codimension-2	O
subspace	O
may	O
be	O
expressed	O
as	O
[	O
h2×2|	O
−	O
i	O
]	O
x	O
=	O
0	O
for	O
suitable	O
h2×2	O
.	O
thus	O
given	O
measurements	O
xi	O
,	O
the	O
estimation	B
task	O
is	O
equivalent	B
to	O
ﬁnding	O
the	O
best-ﬁtting	O
codimension-2	O
subspace	O
.	O
i	O
,	O
x	O
(	O
cid:2	O
)	O
i	O
(	O
d	O
)	O
given	O
a	O
matrix	B
m	O
with	O
rows	O
xt	O
i	O
,	O
the	O
best-ﬁtting	O
subspace	O
to	O
the	O
xi	O
is	O
spanned	O
by	O
the	O
singular	O
vectors	O
v1	O
and	O
v2	O
corresponding	O
to	O
the	O
two	O
largest	O
singular	B
values	I
of	O
m.	O
by	O
solving	B
the	O
equations	O
[	O
h2×2|	O
−	O
i	O
]	O
[	O
v1v2	O
]	O
=	O
0	O
.	O
(	O
e	O
)	O
the	O
h2×2	O
corresponding	O
to	O
the	O
subspace	O
spanned	O
by	O
v1	O
and	O
v2	O
is	O
found	O
(	O
ix	O
)	O
computing	B
homographies	O
of	O
ip3	O
from	O
line	O
correspondences	B
.	O
consider	O
computing	O
a	O
4	O
×	O
4	O
homography	B
h	O
from	O
lines	O
correspondences	B
alone	O
,	O
assuming	O
the	O
lines	B
are	O
in	O
general	O
position	O
in	O
ip3	O
.	O
there	O
are	O
two	O
questions	O
:	O
how	O
many	O
correspondences	B
are	O
required	O
?	O
,	O
and	O
how	O
to	O
formulate	O
the	O
algebraic	B
constraints	O
to	O
obtain	O
a	O
solution	B
for	O
h	O
?	O
it	O
might	O
be	O
thought	O
that	O
four	O
line	O
correspondences	B
would	O
be	O
sufﬁcient	O
because	O
each	O
line	B
in	O
ip3	O
has	O
four	O
degrees	O
of	O
freedom	O
,	O
and	O
thus	O
four	O
lines	O
should	O
provide	O
4	O
×	O
4	O
=	O
16	O
constraints	B
on	O
the	O
15	O
degrees	B
of	I
freedom	I
of	O
h.	O
however	O
,	O
a	O
conﬁguration	O
of	O
four	O
lines	B
is	O
degenerate	B
(	O
see	O
section	O
4.1.3	O
(	O
p91	O
)	O
)	O
for	O
computing	O
the	O
transformation	B
,	O
as	O
there	O
is	O
a	O
2d	O
isotropy	O
sub-	O
group	O
.	O
this	O
is	O
discussed	O
further	O
in	O
[	O
hartley-94c	O
]	O
.	O
equations	O
linear	B
in	O
h	O
can	O
be	O
obtained	O
in	O
the	O
following	O
way	O
:	O
πt	O
i	O
hxj	O
=	O
0	O
,	O
i	O
=	O
1	O
,	O
2	O
,	O
j	O
=	O
1	O
,	O
2	O
,	O
where	O
h	O
transfers	O
a	O
line	B
deﬁned	O
by	O
the	O
two	O
points	O
(	O
x1	O
,	O
x2	O
)	O
to	O
a	O
line	B
deﬁned	O
by	O
the	O
intersection	B
of	O
the	O
two	O
planes	O
(	O
π1	O
,	O
π2	O
)	O
.	O
this	O
method	O
was	O
derived	O
in	O
[	O
oskarsson-02	O
]	O
,	O
where	O
more	O
details	O
are	O
to	O
be	O
found	O
.	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
this	O
chapter	O
describes	O
methods	O
for	O
assessing	O
and	O
quantifying	O
the	O
results	O
of	O
estima-	O
tion	O
algorithms	O
.	O
often	O
it	O
is	O
not	O
sufﬁcient	O
to	O
simply	O
have	O
an	O
estimate	O
of	O
a	O
variable	O
or	O
transformation	B
.	O
instead	O
some	O
measure	O
of	O
conﬁdence	O
or	O
uncertainty	O
is	O
also	O
required	O
.	O
two	O
methods	O
for	O
computing	O
this	O
uncertainty	O
(	O
covariance	B
)	O
are	O
outlined	O
here	O
.	O
the	O
ﬁrst	O
is	O
based	O
on	O
linear	O
approximations	O
and	O
involves	O
concatenating	O
various	O
jacobian	O
expressions	O
.	O
the	O
second	O
is	O
the	O
easier	O
to	O
implement	O
monte	O
carlo	O
method	O
.	O
5.1	O
bounds	O
on	O
performance	O
once	O
an	O
algorithm	B
has	O
been	O
developed	O
for	O
the	O
estimation	B
of	I
a	O
certain	O
type	O
of	O
trans-	O
formation	O
it	O
is	O
time	O
to	O
test	O
its	O
performance	B
.	O
this	O
may	O
be	O
done	O
by	O
testing	O
it	O
on	O
real	O
or	O
on	O
synthetic	O
data	O
.	O
in	O
this	O
section	O
,	O
testing	O
on	O
synthetic	O
data	O
will	O
be	O
considered	O
,	O
and	O
a	O
methodology	O
for	O
testing	O
will	O
be	O
sketched	O
.	O
we	O
recall	O
the	O
notational	O
convention	O
:	O
•	O
a	O
quantity	O
such	O
as	O
x	O
represents	O
a	O
measured	O
image	O
point	O
.	O
•	O
estimated	O
quantities	O
are	O
represented	O
by	O
a	O
hat	O
,	O
such	O
as	O
ˆx	O
or	O
ˆh	O
.	O
•	O
true	O
values	O
are	O
represented	O
by	O
a	O
bar	O
,	O
such	O
as	O
¯x	O
or	O
¯h	O
.	O
typically	O
,	O
testing	O
will	O
begin	O
with	O
the	O
synthetic	O
generation	O
of	O
a	O
set	O
of	O
image	O
corre-	O
spondences	O
¯xi	O
↔	O
¯x	O
(	O
cid:2	O
)	O
i	O
between	O
two	O
images	O
.	O
the	O
number	O
of	O
such	O
correspondences	B
will	O
vary	O
.	O
corresponding	O
points	O
will	O
be	O
chosen	O
in	O
such	O
a	O
way	O
that	O
they	O
correspond	O
via	O
a	O
given	O
ﬁxed	O
projective	O
transformation	B
h	O
,	O
and	O
the	O
correspondence	B
is	O
exact	O
,	O
in	O
the	O
sense	O
that	O
¯x	O
(	O
cid:2	O
)	O
i	O
=	O
h¯xi	O
precisely	O
,	O
up	O
to	O
machine	O
accuracy	O
.	O
next	O
,	O
artiﬁcial	O
gaussian	O
noise	B
will	O
be	O
added	O
to	O
the	O
image	O
measurements	O
by	O
perturb-	O
ing	O
both	O
the	O
x-	O
and	O
y-coordinates	O
of	O
the	O
point	O
by	O
a	O
zero-mean	O
gaussian	O
random	O
vari-	O
able	O
with	O
known	O
variance	B
.	O
the	O
resulting	O
noisy	O
points	O
are	O
denoted	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i.	O
a	O
suitable	O
gaussian	O
random	O
number	O
generator	O
is	O
given	O
in	O
[	O
press-88	O
]	O
.	O
the	O
estimation	B
algorithm	O
is	O
then	O
run	O
to	O
compute	O
the	O
estimated	O
quantity	O
.	O
for	O
the	O
2d	O
projective	B
transformation	I
problem	O
considered	O
in	O
chapter	O
4	O
,	O
this	O
means	O
the	O
projective	B
transformation	I
itself	O
,	O
and	O
also	O
perhaps	O
estimates	O
of	O
the	O
correct	O
original	O
noise-free	O
image	O
points	O
.	O
the	O
algorithm	B
is	O
then	O
evaluated	O
according	O
to	O
how	O
closely	O
the	O
computed	O
model	O
matches	O
the	O
(	O
noisy	O
)	O
input	O
data	O
,	O
or	O
alternatively	O
,	O
how	O
closely	O
the	O
estimated	O
model	B
agrees	O
with	O
the	O
original	O
132	O
5.1	O
bounds	O
on	O
performance	O
133	O
noise-free	O
data	O
.	O
this	O
procedure	O
should	O
be	O
carried	O
out	O
many	O
times	O
with	O
different	O
noise	B
(	O
i.e	O
.	O
a	O
different	O
seed	O
for	O
the	O
random	O
number	O
generator	O
,	O
though	O
each	O
time	O
with	O
the	O
same	O
noise	O
variance	B
)	O
in	O
order	O
to	O
obtain	O
a	O
statistically	O
meaningful	O
performance	B
evaluation	O
.	O
5.1.1	O
error	B
in	I
one	I
image	I
to	O
illustrate	O
this	O
,	O
we	O
continue	O
our	O
investigation	O
of	O
the	O
problem	O
of	O
2d	O
homography	B
es-	O
timation	O
.	O
for	O
simplicity	O
we	O
consider	O
the	O
case	O
where	O
noise	B
is	O
added	O
to	O
the	O
coordinates	B
of	O
the	O
second	O
image	O
only	O
.	O
thus	O
,	O
xi	O
=	O
¯xi	O
for	O
all	O
i.	O
let	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
be	O
a	O
set	O
of	O
noisy	O
matched	O
points	O
between	O
two	O
images	O
,	O
generated	O
from	O
a	O
perfectly	O
matched	O
set	O
of	O
data	O
by	O
injection	O
of	O
gaussian	O
noise	B
with	O
variance	B
σ2	O
in	O
each	O
of	O
the	O
two	O
coordinates	B
of	O
the	O
sec-	O
ond	O
(	O
primed	O
)	O
image	O
.	O
let	O
there	O
be	O
n	O
such	O
matched	O
points	O
.	O
from	O
this	O
data	O
,	O
a	O
projective	B
transformation	I
ˆh	O
is	O
estimated	O
using	O
any	O
one	O
of	O
the	O
algorithms	O
described	O
in	O
chapter	O
4.	O
obviously	O
,	O
the	O
estimated	O
transformation	B
ˆh	O
will	O
not	O
generally	O
map	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
nor	O
¯xi	O
to	O
¯x	O
(	O
cid:2	O
)	O
precisely	O
,	O
because	O
of	O
the	O
injected	O
noise	B
in	O
the	O
coordinates	B
of	O
x	O
(	O
cid:2	O
)	O
i	O
i.	O
the	O
rms	O
(	O
root-mean-	O
squared	O
)	O
residual	B
error	O
res	O
=	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
(	O
5.1	O
)	O
(	O
cid:20	O
)	O
n	O
(	O
cid:7	O
)	O
i=1	O
1	O
2n	O
(	O
cid:21	O
)	O
1/2	O
measures	O
the	O
average	O
difference	O
between	O
the	O
noisy	O
input	O
data	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
)	O
and	O
the	O
estimated	O
points	O
ˆx	O
(	O
cid:2	O
)	O
i	O
=	O
ˆh¯xi	O
.	O
it	O
is	O
therefore	O
appropriately	O
called	O
residual	B
error	O
.	O
it	O
measures	O
how	O
well	O
the	O
computed	O
transformation	O
matches	O
the	O
input	O
data	O
,	O
and	O
as	O
such	O
is	O
a	O
suitable	O
quality	O
measure	O
for	O
the	O
estimation	B
procedure	O
.	O
the	O
value	O
of	O
the	O
residual	O
error	B
is	O
not	O
in	O
itself	O
an	O
absolute	O
measure	O
of	O
the	O
quality	O
of	O
the	O
solution	O
obtained	O
.	O
for	O
instance	O
,	O
consider	O
the	O
2d	O
projectivity	B
problem	O
in	O
the	O
case	O
where	O
the	O
input	O
data	O
consists	O
of	O
just	O
4	O
matched	O
points	O
.	O
since	O
a	O
projective	B
transformation	I
is	O
deﬁned	O
uniquely	O
and	O
exactly	O
by	O
4	O
point	B
correspondences	O
,	O
any	O
reasonable	O
algorithm	B
will	O
compute	O
an	O
ˆh	O
that	O
matches	O
the	O
points	O
exactly	O
,	O
in	O
the	O
sense	O
that	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
ˆhxi	O
.	O
this	O
means	O
that	O
the	O
residual	B
error	O
is	O
zero	O
.	O
one	O
can	O
not	O
expect	O
any	O
better	O
performance	B
from	O
an	O
algorithm	B
than	O
this	O
.	O
i	O
,	O
and	O
not	O
to	O
the	O
original	O
noise-free	O
data	O
,	O
¯x	O
(	O
cid:2	O
)	O
i.	O
in	O
fact	O
,	O
since	O
the	O
difference	O
between	O
the	O
noise-free	O
and	O
the	O
noisy	O
coordinates	B
has	O
variance	B
σ2	O
,	O
in	O
the	O
minimal	O
four-point	O
case	O
the	O
residual	B
difference	O
be-	O
tween	O
projected	O
points	O
ˆhxi	O
and	O
the	O
noise-free	O
data	O
¯x	O
(	O
cid:2	O
)	O
i	O
also	O
has	O
variance	B
σ2	O
.	O
thus	O
,	O
in	O
the	O
case	O
of	O
4	O
points	O
,	O
the	O
model	B
ﬁts	O
the	O
noisy	O
input	O
data	O
perfectly	O
(	O
i.e	O
.	O
the	O
residual	B
is	O
zero	O
)	O
,	O
but	O
does	O
not	O
give	O
a	O
very	O
close	O
approximation	O
to	O
the	O
true	O
noise-free	O
values	O
.	O
note	O
that	O
ˆh	O
matches	O
the	O
projected	O
points	O
to	O
the	O
input	O
data	O
x	O
(	O
cid:2	O
)	O
with	O
more	O
than	O
4	O
point	B
matches	O
,	O
the	O
value	O
of	O
the	O
residual	O
error	B
will	O
increase	O
.	O
in	O
fact	O
,	O
intuitively	O
,	O
one	O
expects	O
that	O
as	O
the	O
number	O
of	O
measurements	O
(	O
matched	O
points	O
)	O
increases	O
,	O
the	O
estimated	O
model	B
should	O
agree	O
more	O
and	O
more	O
closely	O
with	O
the	O
noise-free	O
true	O
values	O
.	O
asymptotically	O
,	O
the	O
variance	B
should	O
decrease	O
in	O
inverse	O
proportion	O
to	O
the	O
number	O
of	O
point	O
matches	O
.	O
at	O
the	O
same	O
time	O
,	O
the	O
residual	B
error	O
will	O
increase	O
.	O
134	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
p	O
f	O
2	O
2	O
0	O
0	O
-2	O
-2	O
2	O
1	O
0	O
-1	O
-2	O
-2	O
-2	O
0	O
0	O
x	O
2	O
2	O
fig	O
.	O
5.1.	O
as	O
the	O
values	O
of	O
the	O
parameters	O
p	O
vary	O
,	O
the	O
function	O
image	O
traces	O
out	O
a	O
surface	O
sm	O
through	O
the	O
true	O
value	O
x	O
.	O
5.1.2	O
error	B
in	I
both	I
images	I
in	O
the	O
case	O
of	O
error	O
in	B
both	I
images	I
,	O
the	O
residual	B
error	O
is	O
res	O
=	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
i	O
are	O
estimated	O
points	O
such	O
that	O
ˆx	O
(	O
cid:2	O
)	O
i=1	O
i	O
=	O
ˆhˆxi	O
.	O
where	O
ˆxi	O
and	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:20	O
)	O
n	O
(	O
cid:7	O
)	O
1√	O
4n	O
n	O
(	O
cid:7	O
)	O
i=1	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
(	O
cid:21	O
)	O
1/2	O
(	O
5.2	O
)	O
5.1.3	O
optimal	O
estimators	O
(	O
mle	O
)	O
bounds	O
for	O
estimation	B
performance	O
will	O
be	O
considered	O
in	O
a	O
general	O
framework	O
,	O
and	O
then	O
specialized	O
to	O
the	O
two	O
cases	O
of	O
error	O
in	O
one	O
or	O
both	B
images	I
.	O
the	O
goal	O
is	O
to	O
derive	O
formulae	O
for	O
the	O
expected	O
residual	B
error	O
of	O
the	O
maximum	O
likelihood	O
estimate	O
(	O
mle	O
)	O
.	O
as	O
described	O
previously	O
,	O
minimization	B
of	O
geometric	B
error	I
is	O
equivalent	B
to	O
mle	O
,	O
and	O
so	O
the	O
goal	O
of	O
any	O
algorithm	B
implementing	O
minimization	B
of	O
geometric	B
error	I
should	O
be	O
to	O
achieve	O
the	O
theoretical	O
bound	O
given	O
for	O
the	O
mle	O
.	O
another	O
algorithm	B
minimizing	O
a	O
different	O
cost	B
function	I
(	O
such	O
as	O
algebraic	O
error	B
)	O
can	O
be	O
judged	O
according	O
to	O
how	O
close	O
it	O
gets	O
to	O
the	O
bound	O
given	O
by	O
the	O
mle	O
.	O
a	O
general	O
estimation	O
problem	O
is	O
concerned	O
with	O
a	O
function	O
f	O
from	O
irm	O
to	O
irn	O
as	O
described	O
in	O
section	O
4.2.7	O
(	O
p101	O
)	O
,	O
where	O
irm	O
is	O
a	O
parameter	B
space	I
,	O
and	O
irn	O
is	O
a	O
space	O
of	O
measurements	O
.	O
consider	O
now	O
a	O
point	B
x	O
∈	O
irn	O
for	O
which	O
there	O
exists	O
a	O
vector	O
of	O
parameters	B
p	O
∈	O
irm	O
such	O
that	O
f	O
(	O
p	O
)	O
=	O
x	O
(	O
i.e	O
.	O
a	O
point	B
x	O
in	O
the	O
range	O
of	O
f	O
with	O
preimage	O
p	O
)	O
.	O
in	O
the	O
context	O
of	O
2d	O
projectivities	O
with	O
measurements	O
in	O
the	O
second	O
image	O
only	O
,	O
this	O
corresponds	O
to	O
a	O
noise-free	O
set	O
of	B
points	I
¯x	O
(	O
cid:2	O
)	O
i	O
=	O
h¯xi	O
.	O
the	O
x-	O
and	O
y-components	O
of	O
the	O
n	O
points	O
¯x	O
(	O
cid:2	O
)	O
i	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
constitute	O
the	O
n-vector	O
x	O
with	O
n	O
=	O
2n	O
,	O
and	O
the	O
parameters	B
of	O
the	O
homography	B
constitute	O
the	O
vector	O
p	O
which	O
may	O
be	O
an	O
8-	O
or	O
9-vector	O
depending	O
on	O
the	O
parametrization	B
of	I
h.	O
let	O
x	O
be	O
a	O
measurement	O
vector	O
chosen	O
according	O
to	O
an	O
isotropic	B
gaussian	O
distribu-	O
tion	O
with	O
mean	O
the	O
true	O
measurement	O
x	O
and	O
variance	B
n	O
σ2	O
(	O
this	O
notation	O
means	O
that	O
each	O
of	O
the	O
n	O
components	O
has	O
variance	B
σ2	O
)	O
.	O
as	O
the	O
value	O
of	O
the	O
parameter	O
vector	O
p	O
varies	O
in	O
a	O
neighbourhood	O
of	O
the	O
point	O
p	O
,	O
the	O
value	O
of	O
the	O
function	O
f	O
(	O
p	O
)	O
traces	O
out	O
a	O
surface	O
sm	O
in	O
irn	O
through	O
the	O
point	B
x.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
5.1.	O
the	O
surface	O
sm	O
5.1	O
bounds	O
on	O
performance	O
135	O
n	O
x	O
x	O
x	O
s	O
fig	O
.	O
5.2.	O
geometry	O
of	O
the	O
errors	O
in	O
measurement	O
space	O
using	O
the	O
tangent	O
plane	O
approximation	O
to	O
sm	O
.	O
the	O
estimated	O
point	B
(	O
cid:23	O
)	O
x	O
is	O
the	O
closest	O
point	B
on	O
sm	O
to	O
the	O
measured	O
point	B
x.	O
the	O
residual	B
error	O
is	O
the	O
distance	B
between	O
the	O
measured	O
point	B
x	O
and	O
(	O
cid:23	O
)	O
x.	O
the	O
estimation	B
error	I
is	O
the	O
distance	B
from	O
(	O
cid:23	O
)	O
x	O
to	O
the	O
true	O
point	B
x.	O
the	O
point	B
on	O
sm	O
closest	O
to	O
x.	O
the	O
ml	O
estimator	B
is	O
the	O
one	O
that	O
returns	O
this	O
closest	O
point	B
is	O
given	O
by	O
the	O
range	O
of	O
f.	O
the	O
dimension	O
of	O
the	O
surface	O
as	O
a	O
submanifold	O
of	O
irn	O
is	O
equal	O
to	O
d	O
,	O
where	O
d	O
is	O
the	O
number	O
of	O
essential	O
parameters	B
(	O
that	O
is	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
,	O
or	O
minimum	O
number	O
of	O
parameters	O
)	O
.	O
in	O
the	O
single-image	O
error	B
case	O
,	O
this	O
equals	O
8	O
,	O
since	O
the	O
mapping	O
determined	O
by	O
the	O
matrix	B
h	O
is	O
independent	O
of	O
scale	O
.	O
now	O
,	O
given	O
a	O
measurement	O
vector	O
x	O
,	O
the	O
maximum	O
likelihood	O
(	O
ml	O
)	O
estimate	O
(	O
cid:23	O
)	O
x	O
is	O
to	O
x	O
that	O
lies	O
on	O
this	O
surface	O
.	O
denote	O
this	O
ml	O
estimate	O
by	O
(	O
cid:23	O
)	O
x	O
.	O
(	O
cid:23	O
)	O
x	O
is	O
the	O
foot	O
of	O
the	O
perpendicular	O
from	O
x	O
onto	O
the	O
tangent	O
plane	O
.	O
the	O
residual	B
error	O
is	O
the	O
distance	B
from	O
the	O
point	B
x	O
to	O
the	O
estimated	O
value	O
(	O
cid:23	O
)	O
x.	O
furthermore	O
,	O
the	O
distance	B
from	O
(	O
cid:23	O
)	O
x	O
to	O
(	O
the	O
unknown	O
)	O
x	O
is	O
the	O
distance	B
from	O
the	O
optimally	O
estimated	O
value	O
to	O
the	O
true	O
we	O
now	O
assume	O
that	O
in	O
the	O
neighbourhood	O
of	O
x	O
,	O
the	O
surface	O
is	O
essentially	O
planar	O
and	O
is	O
well	O
approximated	O
by	O
the	O
tangent	O
surface	O
–	O
at	O
least	O
for	O
neighbourhoods	O
around	O
x	O
of	O
the	O
order	O
of	O
magnitude	O
of	O
noise	O
variance	B
.	O
in	O
this	O
linear	B
approximation	O
,	O
the	O
ml	O
estimate	O
value	O
as	O
seen	O
in	O
ﬁgure	O
5.2.	O
our	O
task	O
is	O
to	O
compute	O
the	O
expected	O
value	O
of	O
these	O
errors	O
.	O
computing	B
the	O
expected	O
ml	O
residual	B
error	O
has	O
now	O
been	O
abstracted	O
to	O
a	O
geomet-	O
ric	O
problem	O
as	O
follows	O
.	O
the	O
total	O
variance	O
of	O
an	O
n-dimensional	O
gaussian	O
distribution	B
is	O
the	O
trace	O
of	O
the	O
covariance	O
matrix	B
,	O
that	O
is	O
the	O
sum	O
of	O
variances	O
in	O
each	O
of	O
the	O
ax-	O
ial	O
directions	O
.	O
this	O
is	O
,	O
of	O
course	O
,	O
unchanged	O
by	O
a	O
change	O
of	O
orthogonal	O
coordinate	O
frame	O
.	O
for	O
an	O
n-dimensional	O
isotropic	B
gaussian	O
distribution	B
with	O
independent	O
vari-	O
ances	O
σ2	O
in	O
each	O
variable	O
,	O
the	O
total	O
variance	O
is	O
n	O
σ2	O
.	O
now	O
,	O
given	O
an	O
isotropic	B
gaussian	O
random	O
variable	O
deﬁned	O
on	O
irn	O
with	O
total	O
variance	B
n	O
σ2	O
and	O
mean	O
the	O
true	O
point	B
x	O
,	O
we	O
wish	O
to	O
compute	O
the	O
expected	O
distance	B
of	O
the	O
random	O
variable	O
from	O
a	O
dimension	O
d	O
hyperplane	O
passing	O
through	O
x.	O
the	O
projection	B
of	O
a	O
gaussian	O
random	O
variable	O
in	O
irn	O
onto	O
the	O
d-dimensional	O
tangent	O
plane	O
gives	O
the	O
distribution	B
of	O
the	O
estimation	B
er-	O
ror	O
(	O
the	O
difference	O
between	O
the	O
estimated	O
value	O
and	O
the	O
true	O
result	O
)	O
.	O
projection	B
onto	O
the	O
136	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
(	O
n	O
−d	O
)	O
-dimensional	O
normal	O
to	O
the	O
tangent	O
surface	O
gives	O
the	O
distribution	B
of	O
the	O
residual	B
error	O
.	O
by	O
a	O
rotation	B
of	O
axes	O
if	O
necessary	O
,	O
one	O
may	O
assume	O
,	O
without	O
loss	O
of	O
generality	O
,	O
that	O
integration	O
over	O
the	O
the	O
tangent	O
surface	O
coincides	O
with	O
the	O
ﬁrst	O
d	O
coordinate	O
axes	O
.	O
remaining	O
axial	O
directions	O
provides	O
the	O
following	O
result	O
.	O
result	O
5.1.	O
the	O
projection	B
of	O
an	O
isotropic	B
gaussian	O
distribution	B
deﬁned	O
on	O
irn	O
with	O
to-	O
tal	O
variance	B
n	O
σ2	O
onto	O
a	O
subspace	O
of	O
dimension	O
s	O
is	O
an	O
isotropic	B
gaussian	O
distribution	B
with	O
total	O
variance	O
sσ2	O
.	O
the	O
proof	O
of	O
this	O
is	O
straightforward	O
,	O
and	O
is	O
omitted	O
.	O
we	O
apply	O
this	O
in	O
the	O
two	O
cases	O
where	O
s	O
=	O
d	O
and	O
s	O
=	O
n	O
−	O
d	O
to	O
obtain	O
the	O
following	O
results	O
.	O
result	O
5.2.	O
consider	O
an	O
estimation	B
problem	I
where	O
n	O
measurements	O
are	O
to	O
be	O
modelled	O
by	O
a	O
function	O
depending	O
on	O
a	O
set	O
of	O
d	O
essential	O
parameters	O
.	O
suppose	O
the	O
measurements	O
are	O
subject	O
to	O
independent	O
gaussian	O
noise	B
with	O
standard	O
deviation	O
σ	O
in	O
each	O
measure-	O
ment	O
variable	O
.	O
(	O
i	O
)	O
the	O
rms	O
residual	B
error	O
(	O
distance	B
of	O
the	O
measured	O
from	O
the	O
estimated	O
value	O
)	O
for	O
the	O
ml	O
estimator	B
is	O
res	O
=	O
e	O
[	O
(	O
cid:10	O
)	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
(	O
cid:10	O
)	O
2/n	O
]	O
1/2	O
=	O
σ	O
(	O
1	O
−	O
d/n	O
)	O
1/2	O
(	O
5.3	O
)	O
(	O
ii	O
)	O
the	O
rms	O
estimation	B
error	I
(	O
distance	B
of	O
the	O
estimated	O
from	O
the	O
true	O
value	O
)	O
for	O
the	O
ml	O
estimator	B
is	O
est	O
=	O
e	O
[	O
(	O
cid:10	O
)	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
(	O
cid:10	O
)	O
2/n	O
]	O
1/2	O
=	O
σ	O
(	O
d/n	O
)	O
1/2	O
where	O
x	O
,	O
(	O
cid:23	O
)	O
x	O
and	O
x	O
are	O
respectively	O
the	O
measured	O
,	O
estimated	O
and	O
true	O
values	O
of	O
the	O
(	O
5.4	O
)	O
measurement	O
vector	O
.	O
result	O
5.2	O
follows	O
directly	O
from	O
result	O
5.1	O
by	O
dividing	O
by	O
n	O
to	O
get	O
the	O
variance	B
per	O
measurement	O
,	O
then	O
taking	O
a	O
square	O
root	O
to	O
get	O
standard	O
deviation	O
,	O
instead	O
of	O
variance	O
.	O
these	O
values	O
give	O
lower	O
bounds	O
for	O
residual	B
error	O
against	O
which	O
a	O
particular	O
estima-	O
tion	O
algorithm	B
may	O
be	O
measured	O
.	O
2d	O
homography	B
–	O
error	B
in	I
one	I
image	I
.	O
for	O
the	O
2d	O
projectivity	B
estimation	O
problem	O
considered	O
in	O
this	O
chapter	O
,	O
assuming	O
error	O
in	O
the	O
second	O
image	O
only	O
,	O
we	O
have	O
d	O
=	O
8	O
and	O
n	O
=	O
2n	O
,	O
where	O
n	O
is	O
the	O
number	O
of	O
point	O
matches	O
.	O
thus	O
,	O
we	O
have	O
for	O
this	O
problem	O
res	O
=	O
σ	O
(	O
1	O
−	O
4/n	O
)	O
1/2	O
est	O
=	O
σ	O
(	O
4/n	O
)	O
1/2	O
.	O
(	O
5.5	O
)	O
graphs	O
of	O
these	O
errors	O
as	O
n	O
varies	O
are	O
shown	O
in	O
ﬁgure	O
5.3	O
.	O
5.1	O
bounds	O
on	O
performance	O
137	O
r	O
o	O
r	O
r	O
e	O
/	O
l	O
a	O
u	O
d	O
i	O
s	O
e	O
r	O
r	O
o	O
r	O
r	O
e	O
/	O
l	O
a	O
u	O
d	O
i	O
s	O
e	O
r	O
number	O
of	O
points	O
a	O
number	O
of	O
points	O
b	O
fig	O
.	O
5.3.	O
optimal	O
error	B
when	O
noise	B
is	O
present	O
in	O
(	O
a	O
)	O
one	O
image	O
,	O
and	O
in	O
(	O
b	O
)	O
both	B
images	I
as	O
the	O
number	O
of	O
points	O
varies	O
.	O
an	O
error	B
level	O
of	O
one	O
pixel	O
is	O
assumed	O
.	O
the	O
descending	O
curve	O
shows	O
the	O
estimation	B
error	I
est	O
and	O
the	O
ascending	O
curve	O
shows	O
the	O
residual	B
error	O
res	O
.	O
error	B
in	I
both	I
images	I
.	O
in	O
this	O
case	O
,	O
n	O
=	O
4n	O
and	O
d	O
=	O
2n	O
+	O
8.	O
as	O
before	O
,	O
assuming	O
linearity	O
of	O
the	O
tangent	O
surface	O
in	O
the	O
neighbourhood	O
of	O
the	O
true	O
measurement	O
vector	O
(	O
cid:23	O
)	O
x	O
,	O
result	O
5.2	O
gives	O
the	O
following	O
expected	O
errors	O
.	O
n	O
−	O
4	O
2n	O
res	O
=	O
σ	O
(	O
cid:28	O
)	O
(	O
cid:28	O
)	O
(	O
cid:29	O
)	O
1/2	O
(	O
cid:29	O
)	O
1/2	O
est	O
=	O
σ	O
.	O
(	O
5.6	O
)	O
n	O
+	O
4	O
2n	O
graphs	O
of	O
these	O
errors	O
as	O
n	O
varies	O
are	O
also	O
shown	O
in	O
figure	O
5.3	O
.	O
√	O
an	O
interesting	O
observation	O
to	O
be	O
made	O
from	O
this	O
graph	O
is	O
that	O
the	O
asymptotic	O
error	B
2	O
,	O
and	O
not	O
0	O
as	O
in	O
the	O
case	O
of	O
error	O
in	B
one	I
image	I
.	O
with	O
respect	O
to	O
the	O
true	O
values	O
is	O
σ/	O
this	O
result	O
is	O
expected	O
,	O
since	O
in	O
effect	O
,	O
one	O
has	O
two	O
measurements	O
of	O
the	O
position	O
of	O
each	O
point	B
,	O
one	O
in	O
each	O
image	O
,	O
related	O
by	O
the	O
projective	B
transformation	I
.	O
with	O
two	O
√	O
measurements	O
of	O
a	O
point	O
the	O
variance	B
in	O
the	O
estimate	O
of	O
the	O
point	O
position	O
decreases	O
by	O
a	O
factor	O
of	O
2.	O
by	O
contrast	O
,	O
in	O
the	O
previous	O
case	O
where	O
errors	O
occur	O
in	B
one	I
image	I
only	O
,	O
one	O
has	O
one	O
exact	O
measurement	O
for	O
each	O
point	B
(	O
i.e	O
.	O
in	O
the	O
ﬁrst	O
image	O
)	O
.	O
thus	O
,	O
as	O
the	O
transformation	B
h	O
is	O
estimated	O
with	O
greater	O
and	O
greater	O
accuracy	O
,	O
the	O
exact	O
position	O
of	O
the	O
point	O
in	O
the	O
second	O
image	O
becomes	O
known	O
with	O
uncertainty	O
asymptotically	O
approaching	O
0.	O
mahalanobis	O
distance	B
.	O
the	O
formulae	O
quoted	O
above	O
were	O
derived	O
under	O
the	O
assump-	O
tion	O
that	O
the	O
error	B
distribution	O
in	O
measurement	O
space	O
was	O
an	O
isotropic	B
gaussian	O
distri-	O
bution	O
,	O
meaning	O
that	O
errors	O
in	O
each	O
coordinate	O
were	O
independent	O
.	O
this	O
assumption	O
is	O
not	O
essential	O
.	O
we	O
may	O
assume	O
any	O
gaussian	O
distribution	B
of	O
error	B
,	O
with	O
covariance	O
ma-	O
trix	O
σ.	O
the	O
formulae	O
of	O
result	O
5.2	O
remain	O
true	O
with	O
	O
being	O
replaced	O
with	O
the	O
expected	O
σ/n	O
]	O
1/2	O
.	O
the	O
standard	O
deviation	O
σ	O
also	O
disappears	O
,	O
mahalanobis	O
distance	B
e	O
[	O
(	O
cid:10	O
)	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
(	O
cid:10	O
)	O
2	O
since	O
it	O
is	O
taken	O
care	O
of	O
by	O
the	O
mahalanobis	O
distance	B
.	O
this	O
follows	O
from	O
a	O
simple	O
change	O
of	O
coordinates	O
in	O
the	O
measurement	O
space	O
irn	O
in	O
this	O
new	O
coordinate	O
frame	O
,	O
to	O
make	O
the	O
covariance	B
matrix	O
equal	O
to	O
the	O
identity	O
.	O
mahalanobis	O
distance	B
becomes	O
the	O
same	O
as	O
euclidean	O
distance	O
.	O
138	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
5.1.4	O
determining	B
the	I
correct	I
convergence	I
of	I
an	I
algorithm	I
the	O
relations	O
given	O
in	O
(	O
5.3	O
)	O
and	O
(	O
5.4	O
)	O
give	O
a	O
simple	O
way	O
of	O
determining	O
correct	O
conver-	O
gence	O
of	O
an	O
estimation	B
algorithm	O
,	O
without	O
the	O
need	O
to	O
determine	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
problem	O
.	O
as	O
seen	O
in	O
ﬁgure	O
5.2	O
,	O
the	O
measurement	O
space	O
corre-	O
sponding	O
to	O
the	O
model	B
speciﬁed	O
by	O
the	O
parameter	O
vector	O
p	O
forms	O
a	O
surface	O
sm	O
.	O
if	O
near	O
the	O
noise-free	O
data	O
x	O
the	O
surface	O
is	O
nearly	O
planar	O
,	O
then	O
it	O
may	O
be	O
approximated	O
by	O
its	O
tangent	O
plane	O
,	O
and	O
the	O
three	O
points	O
(	O
cid:23	O
)	O
x	O
,	O
x	O
and	O
x	O
form	O
a	O
right-angled	O
triangle	O
.	O
in	O
most	O
estimation	B
problems	O
this	O
assumption	O
of	O
planarity	O
will	O
be	O
very	O
close	O
to	O
correct	O
at	O
the	O
scale	O
set	O
by	O
typical	O
noise	O
magnitude	O
.	O
in	O
this	O
case	O
,	O
the	O
pythagorean	O
equality	O
may	O
be	O
written	O
as	O
(	O
cid:10	O
)	O
x	O
−	O
x	O
(	O
cid:10	O
)	O
2	O
=	O
(	O
cid:10	O
)	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
(	O
cid:10	O
)	O
2	O
+	O
(	O
cid:10	O
)	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
(	O
cid:10	O
)	O
2	O
(	O
5.7	O
)	O
in	O
evaluating	O
an	O
algorithm	B
with	O
synthetic	B
data	I
,	O
this	O
equality	O
allows	O
a	O
simple	O
test	O
to	O
see	O
whether	O
the	O
algorithm	B
has	O
converged	O
to	O
the	O
optimal	O
value	O
.	O
if	O
the	O
estimated	O
value	O
(	O
cid:23	O
)	O
x	O
satisﬁes	O
this	O
equality	O
,	O
then	O
it	O
is	O
a	O
strong	B
indication	O
that	O
the	O
algorithm	B
has	O
found	O
the	O
true	O
global	O
minimum	O
.	O
note	O
that	O
it	O
is	O
unnecessary	O
in	O
applying	O
this	O
test	O
to	O
determine	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
problem	O
.	O
a	O
few	O
more	B
properties	I
are	O
listed	O
:	O
•	O
this	O
test	O
can	O
be	O
used	O
to	O
determine	O
on	O
a	O
run-by-run	O
basis	O
whether	O
the	O
algorithm	B
has	O
succeeded	O
.	O
thus	O
,	O
with	O
repeated	O
runs	O
,	O
it	O
allows	O
an	O
estimate	O
of	O
the	O
percentage	O
success	O
rate	O
for	O
the	O
algorithm	B
.	O
•	O
this	O
test	O
can	O
only	O
be	O
used	O
for	O
synthetic	O
data	O
,	O
or	O
at	O
least	O
data	O
for	O
which	O
the	O
true	O
measurements	O
x	O
are	O
known	O
.	O
•	O
the	O
equality	O
(	O
5.7	O
)	O
depends	O
on	O
the	O
assumption	O
that	O
the	O
surface	O
sm	O
consisting	O
of	O
valid	O
measurements	O
is	O
locally	O
planar	O
.	O
if	O
the	O
equality	O
is	O
not	O
satisﬁed	O
for	O
a	O
particular	O
run	O
of	O
the	O
estimation	B
algorithm	O
,	O
then	O
this	O
is	O
because	O
the	O
surface	O
is	O
not	O
planar	O
,	O
or	O
(	O
far	O
more	O
•	O
the	O
test	O
(	O
5.7	O
)	O
is	O
a	O
test	O
for	O
the	O
algorithm	B
ﬁnding	O
the	O
global	O
,	O
not	O
a	O
local	O
solution	O
.	O
if	O
(	O
cid:23	O
)	O
x	O
likely	O
)	O
because	O
the	O
algorithm	B
is	O
failing	O
to	O
ﬁnd	O
the	O
best	O
solution	B
.	O
chance	O
if	O
the	O
algorithm	B
ﬁnds	O
the	O
incorrect	O
point	B
(	O
cid:23	O
)	O
x.	O
settles	O
to	O
a	O
local	O
cost	O
minimum	O
,	O
then	O
the	O
right-hand-side	O
of	O
(	O
5.7	O
)	O
is	O
likely	O
to	O
be	O
much	O
larger	O
than	O
the	O
left-hand-side	O
.	O
the	O
condition	O
is	O
unlikely	O
to	O
be	O
satisﬁed	O
entirely	O
by	O
5.2	O
covariance	B
of	O
the	O
estimated	O
transformation	B
in	O
the	O
previous	O
section	O
the	O
ml	O
estimate	O
was	O
considered	O
,	O
and	O
how	O
its	O
expected	O
average	O
error	B
may	O
be	O
computed	O
.	O
comparing	O
the	O
achieved	O
residual	B
error	O
or	O
estimation	B
error	I
of	O
an	O
algorithm	B
against	O
the	O
ml	O
error	B
is	O
a	O
good	O
way	O
of	O
evaluating	O
the	O
performance	B
of	O
a	O
particular	O
estimation	B
algorithm	O
,	O
since	O
it	O
compares	O
the	O
results	O
of	O
the	O
algorithm	B
against	O
the	O
best	O
that	O
may	O
be	O
achieved	O
(	O
the	O
optimum	O
estimate	O
)	O
in	O
the	O
absence	O
of	O
any	O
other	O
prior	O
information	O
.	O
nevertheless	O
,	O
the	O
chief	O
concern	O
is	O
how	O
accurately	O
the	O
transformation	B
itself	O
has	O
been	O
computed	O
.	O
the	O
uncertainty	O
of	O
the	O
estimated	O
transformation	B
depends	O
on	O
many	O
factors	O
,	O
including	O
the	O
number	O
of	O
points	O
used	O
to	O
compute	O
it	O
,	O
the	O
accuracy	O
of	O
the	O
given	O
point	B
matches	O
,	O
as	O
well	O
as	O
the	O
conﬁguration	O
of	O
the	O
points	O
in	O
question	O
.	O
to	O
illustrate	O
the	O
impor-	O
tance	O
of	O
the	O
conﬁguration	O
suppose	O
the	O
points	O
used	O
to	O
compute	O
the	O
transformation	B
are	O
5.2	O
covariance	B
of	O
the	O
estimated	O
transformation	B
139	O
close	O
to	O
a	O
degenerate	B
conﬁguration	I
;	O
then	O
the	O
transformation	B
may	O
not	O
be	O
computed	O
with	O
great	O
accuracy	O
.	O
for	O
instance	O
,	O
if	O
the	O
transformation	B
is	O
computed	O
from	O
a	O
set	O
of	B
points	I
that	O
lie	O
close	O
to	O
a	O
straight	O
line	B
,	O
then	O
the	O
behaviour	O
of	O
the	O
transformation	O
in	O
the	O
dimension	O
perpendicular	O
to	O
that	O
line	B
is	O
not	O
accurately	O
determined	O
.	O
thus	O
,	O
whereas	O
the	O
achievable	O
residual	B
error	O
and	O
estimation	B
error	I
were	O
seen	O
to	O
be	O
dependent	O
only	O
on	O
the	O
number	O
of	O
point	O
correspondences	B
and	O
their	O
accuracy	O
,	O
by	O
contrast	O
,	O
the	O
accuracy	O
of	O
the	O
computed	O
transformation	B
is	O
dependent	O
on	O
the	O
particular	O
points	O
.	O
the	O
uncertainty	O
of	O
the	O
computed	O
transformation	B
is	O
conveniently	O
captured	O
in	O
the	O
covariance	B
matrix	O
of	O
the	O
transformation	O
.	O
since	O
h	O
is	O
a	O
matrix	B
with	O
9	O
entries	O
,	O
its	O
covariance	B
matrix	O
will	O
be	O
a	O
9	O
×	O
9	O
matrix	B
.	O
in	O
this	O
section	O
it	O
will	O
be	O
seen	O
how	O
this	O
covariance	B
matrix	O
may	O
be	O
computed	O
.	O
5.2.1	O
forward	B
propagation	I
of	O
covariance	B
the	O
covariance	B
matrix	O
behaves	O
in	O
a	O
pleasantly	O
simple	O
manner	O
under	O
afﬁne	B
transforma-	O
tions	O
,	O
as	O
described	O
in	O
the	O
following	O
theorem	O
.	O
result	O
5.3.	O
let	O
v	O
be	O
a	O
random	O
vector	O
in	O
irm	O
with	O
mean	O
¯v	O
and	O
covariance	B
matrix	O
σ	O
,	O
and	O
suppose	O
that	O
f	O
:	O
irm	O
→	O
irn	O
is	O
an	O
afﬁne	B
mapping	O
deﬁned	O
by	O
f	O
(	O
v	O
)	O
=	O
f	O
(	O
¯v	O
)	O
+	O
a	O
(	O
v	O
−	O
¯v	O
)	O
.	O
then	O
f	O
(	O
v	O
)	O
is	O
a	O
random	O
variable	O
with	O
mean	O
f	O
(	O
¯v	O
)	O
and	O
covariance	B
matrix	O
aσat	O
.	O
note	O
that	O
it	O
is	O
not	O
assumed	O
that	O
a	O
is	O
a	O
square	O
matrix	B
.	O
instead	O
of	O
giving	O
a	O
proof	O
of	O
this	O
theorem	O
,	O
we	O
give	O
an	O
example	O
.	O
(	O
cid:17	O
)	O
example	O
5.4.	O
let	O
x	O
and	O
y	O
be	O
independent	O
random	O
variables	O
with	O
mean	O
0	O
and	O
standard	O
deviations	O
of	O
1	O
and	O
2	O
respectively	O
.	O
what	O
are	O
the	O
mean	O
and	O
standard	O
deviation	O
of	O
x	O
=	O
f	O
(	O
x	O
,	O
y	O
)	O
=	O
3x	O
+	O
2y	O
−	O
7	O
?	O
(	O
cid:18	O
)	O
=	O
f	O
(	O
0	O
,	O
0	O
)	O
=	O
−7	O
.	O
next	O
we	O
compute	O
the	O
variance	B
of	O
x	O
(	O
cid:2	O
)	O
the	O
mean	O
is	O
¯x	O
1	O
0	O
and	O
a	O
is	O
the	O
matrix	B
[	O
3	O
2	O
]	O
.	O
thus	O
,	O
the	O
variance	B
of	O
x	O
0	O
4	O
is	O
the	O
matrix	B
thus	O
3x	O
+	O
2y	O
−	O
7	O
has	O
standard	O
deviation	O
5	O
.	O
=	O
3x−2y	O
.	O
find	O
the	O
covariance	B
matrix	O
of	O
(	O
x	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
example	O
5.5.	O
let	O
x	O
given	O
that	O
x	O
and	O
y	O
have	O
the	O
same	O
distribution	O
as	O
before	O
.	O
.	O
in	O
this	O
case	O
,	O
σ	O
(	O
cid:2	O
)	O
is	O
aσat	O
=	O
25	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
3x+2y	O
and	O
y	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
,	O
y	O
)	O
,	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
25	O
−7	O
−7	O
25	O
3	O
2	O
3	O
−2	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
and	O
y	O
]	O
=	O
−7	O
.	O
.	O
one	O
computes	O
aσat	O
=	O
in	O
this	O
case	O
,	O
the	O
matrix	B
a	O
=	O
have	O
variance	B
25	O
(	O
standard	O
deviation	O
5	O
)	O
,	O
whereas	O
x	O
one	O
sees	O
that	O
both	O
x	O
are	O
negatively	O
correlated	O
,	O
with	O
covariance	O
e	O
[	O
x	O
.	O
thus	O
,	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
y	O
(	O
cid:2	O
)	O
if	O
v	O
is	O
a	O
random	O
vector	O
in	O
irm	O
and	O
f	O
:	O
irm	O
→	O
irn	O
is	O
a	O
non-linear	B
propagation	O
.	O
non-linear	B
function	O
acting	O
on	O
v	O
,	O
then	O
we	O
may	O
compute	O
an	O
approximation	O
to	O
the	O
mean	O
and	O
covariance	B
of	O
f	O
(	O
v	O
)	O
by	O
assuming	O
that	O
f	O
is	O
approximately	O
afﬁne	B
in	O
the	O
vicinity	O
of	O
the	O
mean	O
of	O
the	O
distribution	O
.	O
the	O
afﬁne	B
approximation	O
to	O
f	O
is	O
f	O
(	O
v	O
)	O
≈	O
f	O
(	O
¯v	O
)	O
+	O
j	O
(	O
v	O
−	O
¯v	O
)	O
,	O
where	O
j	O
is	O
the	O
partial	O
derivative	O
(	O
jacobian	O
)	O
matrix	B
∂f	O
/∂v	O
evaluated	O
at	O
¯v	O
.	O
note	O
that	O
j	O
has	O
dimension	O
n	O
×	O
m.	O
then	O
we	O
have	O
the	O
following	O
result	O
.	O
result	O
5.6.	O
let	O
v	O
be	O
a	O
random	O
vector	O
in	O
irm	O
with	O
mean	O
¯v	O
and	O
covariance	B
matrix	O
σ	O
,	O
140	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
and	O
let	O
f	O
:	O
irm	O
→	O
irn	O
be	O
differentiable	O
in	O
a	O
neighbourhood	O
of	O
¯v	O
.	O
then	O
up	O
to	O
a	O
ﬁrst-	O
order	O
approximation	O
,	O
f	O
(	O
v	O
)	O
is	O
a	O
random	O
variable	O
with	O
mean	O
f	O
(	O
¯v	O
)	O
and	O
covariance	B
jσjt	O
,	O
where	O
j	O
is	O
the	O
jacobian	O
matrix	B
of	O
f	O
,	O
evaluated	O
at	O
¯v	O
.	O
the	O
extent	O
to	O
which	O
this	O
result	O
gives	O
a	O
good	O
approximation	O
to	O
the	O
actual	O
mean	O
and	O
variance	B
of	O
f	O
(	O
¯v	O
)	O
depends	O
on	O
how	O
closely	O
the	O
function	O
f	O
is	O
approximated	O
by	O
a	O
linear	B
function	O
in	O
a	O
region	O
about	O
¯v	O
commensurate	O
in	O
size	O
with	O
the	O
support	O
of	O
the	O
probability	O
distribution	B
of	O
v.	O
example	O
5.7.	O
let	O
x	O
=	O
(	O
x	O
,	O
y	O
)	O
t	O
be	O
a	O
gaussian	O
random	O
vector	O
with	O
mean	O
(	O
0	O
,	O
0	O
)	O
t	O
and	O
=	O
f	O
(	O
x	O
,	O
y	O
)	O
=x	O
2	O
+	O
3x	O
−	O
2y	O
+	O
5.	O
then	O
one	O
may	O
covariance	B
matrix	O
σ2diag	O
(	O
1	O
,	O
4	O
)	O
.	O
let	O
x	O
compute	O
the	O
true	O
values	O
of	O
the	O
mean	O
and	O
standard	O
deviation	O
of	O
f	O
(	O
x	O
,	O
y	O
)	O
according	O
to	O
the	O
formulae	O
(	O
cid:2	O
)	O
!	O
!	O
∞	O
!	O
!	O
∞	O
−∞	O
p	O
(	O
x	O
,	O
y	O
)	O
f	O
(	O
x	O
,	O
y	O
)	O
dxdy	O
−∞	O
p	O
(	O
x	O
,	O
y	O
)	O
(	O
f	O
(	O
x	O
,	O
y	O
)	O
−	O
¯x	O
(	O
cid:2	O
)	O
¯x	O
=	O
σ2	O
x	O
(	O
cid:1	O
)	O
=	O
(	O
cid:2	O
)	O
)	O
2dxdy	O
where	O
p	O
(	O
x	O
,	O
y	O
)	O
=	O
−	O
(	O
x2+y2/4	O
)	O
/2σ2	O
1	O
4πσ2	O
e	O
is	O
the	O
gaussian	O
probability	O
distribution	O
(	O
a2.1–p565	O
)	O
.	O
one	O
obtains	O
(	O
cid:2	O
)	O
=	O
5	O
+	O
σ2	O
¯x	O
σ2	O
x	O
(	O
cid:1	O
)	O
=	O
25σ2	O
+	O
2σ4	O
.	O
applying	O
the	O
approximation	O
given	O
by	O
result	O
5.6	O
,	O
and	O
noting	O
that	O
j	O
=	O
[	O
3	O
−	O
2	O
]	O
,	O
we	O
ﬁnd	O
that	O
the	O
estimated	O
values	O
are	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
=	O
5	O
(	O
cid:2	O
)	O
¯x	O
x	O
(	O
cid:1	O
)	O
=	O
σ2	O
[	O
3	O
−	O
2	O
]	O
σ2	O
1	O
4	O
[	O
3	O
−	O
2	O
]	O
t	O
=	O
25σ2	O
.	O
thus	O
,	O
as	O
long	O
as	O
σ	O
is	O
small	O
,	O
this	O
is	O
a	O
close	O
approximation	O
to	O
the	O
correct	O
values	O
of	O
the	O
mean	O
and	O
variance	B
of	O
x	O
.	O
the	O
following	O
table	O
shows	O
the	O
true	O
and	O
approximated	O
values	O
for	O
the	O
mean	O
and	O
standard	O
deviation	O
of	O
f	O
(	O
x	O
,	O
y	O
)	O
for	O
two	O
different	O
values	O
of	O
σ	O
.	O
(	O
cid:2	O
)	O
σ	O
=	O
0.25	O
(	O
cid:2	O
)	O
σx	O
(	O
cid:1	O
)	O
¯x	O
(	O
cid:2	O
)	O
σ	O
=	O
0.5	O
σx	O
(	O
cid:1	O
)	O
¯x	O
estimate	O
true	O
5.0000	O
5.0625	O
1.25000	O
1.25312	O
5.00	O
5.25	O
2.5000	O
2.5249	O
for	O
reference	O
,	O
in	O
the	O
case	O
σ	O
=	O
0.25	O
,	O
one	O
sees	O
that	O
as	O
long	O
as	O
|x|	O
<	O
2σ	O
(	O
about	O
95	O
%	O
of	O
the	O
total	O
distribution	B
)	O
the	O
value	O
f	O
(	O
x	O
,	O
y	O
)	O
=	O
x2	O
+	O
3x	O
−	O
2y	O
+	O
5	O
differs	O
from	O
its	O
linear	B
approximation	O
3x	O
−	O
2y	O
+	O
5	O
by	O
no	O
more	O
than	O
x2	O
<	O
0.25	O
.	O
(	O
cid:2	O
)	O
5.2	O
covariance	B
of	O
the	O
estimated	O
transformation	B
141	O
example	O
5.8.	O
more	O
generally	O
,	O
assuming	O
that	O
x	O
and	O
y	O
are	O
independent	O
zero-mean	O
gaus-	O
sian	O
random	O
variables	O
,	O
one	O
may	O
compute	O
that	O
for	O
the	O
function	O
f	O
(	O
x	O
,	O
y	O
)	O
=	O
ax2	O
+	O
bxy	O
+	O
cy2	O
+	O
dx	O
+	O
ey	O
+	O
f	O
,	O
mean	O
=	O
aσ2	O
variance	B
=	O
2a2σ4	O
x	O
+	O
cσ2	O
y	O
+	O
f	O
x	O
+	O
b2σ2	O
xσ2	O
y	O
+	O
2c2σ4	O
y	O
+	O
d2σ2	O
x	O
+	O
e2σ2	O
y	O
which	O
are	O
close	O
to	O
the	O
estimated	O
values	O
mean	O
=	O
f	O
,	O
variance	B
=	O
d2σ2	O
σx	O
and	O
σy	O
are	O
small	O
.	O
x	O
+	O
e2σ2	O
y	O
as	O
long	O
as	O
(	O
cid:2	O
)	O
5.2.2	O
backward	B
propagation	I
of	O
covariance	B
the	O
material	O
in	O
this	O
and	O
the	O
following	O
section	O
5.2.3	O
is	O
more	O
advanced	O
.	O
the	O
examples	B
in	O
section	O
5.2.4	O
show	O
the	O
straightforward	O
application	O
of	O
the	O
results	O
of	O
these	O
sections	O
,	O
and	O
can	O
be	O
read	O
ﬁrst	O
.	O
consider	O
a	O
differentiable	O
mapping	O
f	O
from	O
a	O
“	O
parameter	B
space	I
”	O
,	O
irm	O
to	O
a	O
“	O
measure-	O
ment	O
space	O
”	O
irn	O
,	O
and	O
let	O
a	O
gaussian	O
probability	O
distribution	O
be	O
deﬁned	O
on	O
irn	O
with	O
covariance	O
matrix	B
σ.	O
let	O
sm	O
be	O
the	O
image	O
of	O
the	O
mapping	O
f.	O
we	O
assume	O
that	O
m	O
<	O
n	O
and	O
that	O
sm	O
has	O
the	O
same	O
dimension	O
m	O
as	O
the	O
parameter	B
space	I
irm	O
.	O
thus	O
we	O
are	O
not	O
considering	O
the	O
over-parametrized	B
case	I
at	O
present	O
.	O
a	O
vector	O
p	O
in	O
irm	O
represents	O
a	O
parametrization	B
of	I
the	O
point	B
f	O
(	O
p	O
)	O
on	O
sm	O
.	O
finding	O
the	O
point	B
on	O
sm	O
closest	O
in	O
maha-	O
lanobis	O
distance	B
to	O
a	O
given	O
point	B
x	O
in	O
irn	O
deﬁnes	O
a	O
map	O
from	O
irn	O
to	O
the	O
surface	O
sm	O
.	O
we	O
call	O
this	O
mapping	O
η	O
:	O
irn	O
→	O
sm	O
.	O
now	O
,	O
f	O
is	O
by	O
assumption	O
invertible	O
on	O
the	O
surface	O
sm	O
,	O
and	O
we	O
deﬁne	O
f	O
by	O
composing	O
the	O
map	O
η	O
:	O
irn	O
→	O
sm	O
and	O
f	O
−1	O
:	O
sm	O
→	O
irm	O
we	O
have	O
a	O
mapping	O
parameters	O
p	O
corresponding	O
to	O
the	O
ml	O
estimate	O
(	O
cid:23	O
)	O
x.	O
in	O
principle	O
we	O
may	O
propagate	O
the	O
−1	O
◦	O
η	O
:	O
irn	O
→	O
irm	O
.	O
this	O
mapping	O
assigns	O
to	O
a	O
measurement	O
vector	O
x	O
,	O
the	O
set	O
of	O
−1	O
:	O
sm	O
→	O
irm	O
to	O
be	O
the	O
inverse	O
function	O
.	O
f	O
covariance	B
of	O
the	O
probability	O
distribution	O
in	O
the	O
measurement	O
space	O
irn	O
to	O
compute	O
a	O
covariance	B
matrix	O
for	O
the	O
set	O
of	O
parameters	O
p	O
corresponding	O
to	O
ml	O
estimation	B
.	O
our	O
goal	O
is	O
to	O
apply	O
result	O
5.3	O
or	O
result	O
5.6.	O
we	O
consider	O
ﬁrst	O
the	O
case	O
where	O
the	O
mapping	O
f	O
is	O
an	O
afﬁne	B
mapping	O
from	O
irm	O
into	O
−1	O
◦	O
η	O
is	O
also	O
an	O
afﬁne	B
mapping	O
,	O
and	O
irn	O
.	O
we	O
will	O
show	O
next	O
that	O
the	O
mapping	O
f	O
compute	O
the	O
covariance	B
of	O
the	O
estimated	O
parameters	B
(	O
cid:23	O
)	O
p	O
=	O
f	O
−1	O
◦	O
η	O
,	O
thereby	O
allowing	O
us	O
to	O
apply	O
result	O
5.3	O
to	O
a	O
speciﬁc	O
form	O
will	O
be	O
given	O
for	O
f	O
since	O
f	O
is	O
afﬁne	B
,	O
we	O
may	O
write	O
f	O
(	O
p	O
)	O
=	O
f	O
(	O
p	O
)	O
+j	O
(	O
p	O
−	O
p	O
)	O
,	O
where	O
f	O
(	O
p	O
)	O
=	O
x	O
is	O
the	O
mean	O
of	O
the	O
probability	O
distribution	B
on	O
irn	O
.	O
since	O
we	O
are	O
assuming	O
that	O
the	O
surface	O
a	O
measurement	O
vector	O
x	O
,	O
the	O
ml	O
estimate	O
(	O
cid:23	O
)	O
x	O
minimizes	O
(	O
cid:10	O
)	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
(	O
cid:10	O
)	O
σ	O
=	O
(	O
cid:10	O
)	O
x	O
−	O
f	O
(	O
(	O
cid:23	O
)	O
p	O
)	O
(	O
cid:10	O
)	O
σ.	O
sm	O
=	O
f	O
(	O
irm	O
)	O
has	O
dimension	O
m	O
,	O
the	O
rank	O
of	O
j	O
is	O
equal	O
to	O
its	O
column	O
dimension	O
.	O
given	O
thus	O
,	O
we	O
seek	O
(	O
cid:23	O
)	O
p	O
to	O
minimize	O
this	O
latter	O
quantity	O
.	O
however	O
,	O
−1	O
◦	O
η	O
(	O
x	O
)	O
.	O
and	O
this	O
is	O
minimized	O
(	O
see	O
(	O
a5.2–p591	O
)	O
in	O
section	O
a5.2.1	O
(	O
p591	O
)	O
)	O
when	O
(	O
cid:10	O
)	O
x	O
−	O
f	O
(	O
(	O
cid:23	O
)	O
p	O
)	O
(	O
cid:10	O
)	O
σ	O
=	O
(	O
cid:10	O
)	O
(	O
x	O
−	O
x	O
)	O
−	O
j	O
(	O
(	O
cid:23	O
)	O
p	O
−	O
p	O
)	O
(	O
cid:10	O
)	O
σ	O
(	O
(	O
cid:23	O
)	O
p	O
−	O
p	O
)	O
=	O
(	O
jtς−1j	O
)	O
−1jtς−1	O
(	O
x	O
−	O
x	O
)	O
.	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
142	O
writing	O
p	O
=	O
f	O
f	O
−1x	O
and	O
(	O
cid:23	O
)	O
p	O
=	O
f	O
−1	O
◦	O
η	O
(	O
x	O
)	O
=	O
(	O
cid:23	O
)	O
p	O
−1	O
(	O
cid:23	O
)	O
x	O
,	O
we	O
see	O
that	O
=	O
(	O
jtς−1j	O
)	O
=	O
(	O
jtς−1j	O
)	O
this	O
shows	O
that	O
f	O
result	O
5.3	O
,	O
we	O
see	O
that	O
the	O
covariance	B
matrix	O
for	O
(	O
cid:23	O
)	O
p	O
is	O
−1	O
◦	O
η	O
is	O
afﬁne	B
and	O
(	O
jtς−1j	O
)	O
#	O
''	O
(	O
jtς−1j	O
)	O
(	O
jtς−1j	O
)	O
−1jtς−1	O
−1jtς−1	O
''	O
σ	O
−1	O
(	O
x	O
)	O
−1	O
◦	O
η	O
(	O
x	O
)	O
.	O
−1jtς−1	O
(	O
x	O
−	O
x	O
)	O
+	O
f	O
−1jtς−1	O
(	O
x	O
−	O
x	O
)	O
+	O
f	O
#	O
t	O
−1jtς−1	O
is	O
its	O
linear	B
part	O
.	O
applying	O
=	O
(	O
jtς−1j	O
)	O
=	O
(	O
jtς−1j	O
)	O
−1jtς−1σς−1j	O
(	O
jtς−1j	O
)	O
−1	O
,	O
−1	O
recalling	O
that	O
σ	O
is	O
symmetric	B
.	O
we	O
have	O
proved	O
the	O
following	O
theorem	O
.	O
result	O
5.9	O
backward	O
transport	O
of	O
covariance	O
–	O
afﬁne	B
case	O
.	O
let	O
f	O
:	O
irm	O
→	O
irn	O
be	O
an	O
afﬁne	B
mapping	O
of	O
the	O
form	O
f	O
(	O
p	O
)	O
=f	O
(	O
p	O
)	O
+j	O
(	O
p	O
−	O
p	O
)	O
,	O
where	O
j	O
has	O
rank	O
m.	O
let	O
x	O
be	O
a	O
random	O
variable	O
in	O
irn	O
with	O
mean	O
x	O
=	O
f	O
(	O
p	O
)	O
and	O
covariance	B
matrix	O
σ.	O
let	O
parameters	B
corresponding	O
to	O
the	O
ml	O
estimate	O
(	O
cid:23	O
)	O
x.	O
then	O
(	O
cid:23	O
)	O
p	O
=	O
f	O
−1	O
◦	O
η	O
:	O
irn	O
→	O
irm	O
be	O
the	O
mapping	O
that	O
maps	O
a	O
measurement	O
x	O
to	O
the	O
set	O
of	O
f	O
−1	O
◦	O
η	O
(	O
x	O
)	O
is	O
a	O
random	O
variable	O
with	O
mean	O
p	O
and	O
covariance	B
matrix	O
σp	O
=	O
(	O
jtς−1	O
x	O
j	O
)	O
−1	O
.	O
(	O
5.8	O
)	O
in	O
the	O
case	O
where	O
f	O
is	O
not	O
afﬁne	B
,	O
an	O
approximation	O
to	O
the	O
mean	O
and	O
covariance	B
may	O
be	O
obtained	O
by	O
approximating	O
f	O
by	O
an	O
afﬁne	B
function	O
in	O
the	O
usual	O
way	O
,	O
as	O
follows	O
.	O
result	O
5.10	O
backward	O
transport	O
of	O
covariance	O
–	O
non-linear	B
case	O
.	O
let	O
f	O
:	O
irm	O
→	O
irn	O
be	O
a	O
differentiable	O
mapping	O
and	O
let	O
j	O
be	O
its	O
jacobian	O
matrix	B
evaluated	O
at	O
a	O
point	B
p.	O
suppose	O
that	O
j	O
has	O
rank	O
m.	O
then	O
f	O
is	O
one-to-one	O
in	O
a	O
neighbourhood	O
of	O
p.	O
let	O
x	O
be	O
a	O
random	O
variable	O
in	O
irn	O
with	O
mean	O
x	O
=	O
f	O
(	O
p	O
)	O
and	O
covariance	B
matrix	O
σx	O
.	O
let	O
rameters	O
corresponding	O
to	O
the	O
ml	O
estimate	O
(	O
cid:23	O
)	O
x.	O
then	O
to	O
ﬁrst-order	O
,	O
(	O
cid:23	O
)	O
p	O
=	O
f	O
−1	O
◦	O
η	O
:	O
irn	O
→	O
irm	O
be	O
the	O
mapping	O
that	O
maps	O
a	O
measurement	O
x	O
to	O
the	O
set	O
of	O
pa-	O
f	O
−1	O
◦	O
η	O
(	O
x	O
)	O
is	O
a	O
random	O
variable	O
with	O
mean	O
p	O
and	O
covariance	B
matrix	O
(	O
jtς−1	O
−1	O
.	O
x	O
j	O
)	O
5.2.3	O
over-parametrization	B
one	O
may	O
generalize	O
result	O
5.9	O
and	O
result	O
5.10	O
to	O
the	O
case	O
of	O
redundant	O
sets	O
of	O
parame-	O
ters	O
–	O
the	O
over-parametrized	B
case	I
.	O
in	O
this	O
case	O
,	O
the	O
mapping	O
f	O
from	O
the	O
parameter	B
space	I
irm	O
to	O
measurement	O
space	O
irn	O
is	O
not	O
locally	O
one-to-one	O
.	O
for	O
instance	O
,	O
in	O
the	O
case	O
of	O
estimating	O
a	O
2d	O
homography	B
as	O
discussed	O
in	O
section	O
4.5	O
(	O
p110	O
)	O
there	O
is	O
a	O
mapping	O
f	O
(	O
p	O
)	O
where	O
p	O
is	O
a	O
9-vector	O
representing	O
the	O
entries	O
of	O
the	O
homography	O
matrix	B
h.	O
since	O
the	O
homography	B
has	O
only	O
8	O
degrees	B
of	I
freedom	I
,	O
the	O
mapping	O
f	O
is	O
not	O
one-to-one	O
.	O
in	O
par-	O
ticular	O
,	O
for	O
any	O
constant	O
k	O
,	O
the	O
matrix	B
kh	O
represents	O
the	O
same	O
map	O
,	O
and	O
so	O
the	O
image	O
coordinate	O
vectors	O
f	O
(	O
p	O
)	O
and	O
f	O
(	O
kp	O
)	O
are	O
equal	O
.	O
in	O
the	O
general	O
case	O
of	O
a	O
mapping	O
f	O
:	O
irm	O
→	O
irn	O
the	O
jacobian	O
matrix	B
j	O
does	O
not	O
have	O
full	O
rank	O
m	O
,	O
but	O
rather	O
a	O
smaller	O
rank	O
d	O
<	O
m.	O
this	O
rank	O
d	O
is	O
called	O
the	O
number	O
of	O
essential	O
parameters	B
.	O
the	O
matrix	B
jtς−1	O
x	O
j	O
in	O
this	O
case	O
has	O
dimension	O
m	O
but	O
rank	O
5.2	O
covariance	B
of	O
the	O
estimated	O
transformation	B
143	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
0	O
-1	O
-1	O
p	O
-0.5	O
-0.5	O
s	O
0	O
0	O
1	O
0.5	O
0	O
-0.5	O
f	O
2	O
2	O
0	O
0	O
-2	O
-2	O
2	O
1	O
0	O
-1	O
-2	O
0.5	O
0.5	O
1	O
-1	O
-2	O
-2	O
0	O
0	O
x	O
x	O
2	O
2	O
fig	O
.	O
5.4.	O
back	O
propagation	O
(	O
over-parametrized	O
)	O
.	O
mapping	O
f	O
maps	O
constrained	O
parameter	O
surface	O
to	O
measurement	O
space	O
.	O
a	O
measurement	O
x	O
is	O
mapped	O
(	O
by	O
a	O
mapping	O
η	O
)	O
to	O
the	O
closest	O
point	B
on	O
the	O
surface	O
−1	O
to	O
the	O
parameter	B
space	I
,	O
providing	O
the	O
ml	O
estimate	O
of	O
the	O
parameters	O
.	O
the	O
f	O
(	O
sp	O
)	O
and	O
then	O
back	O
via	O
f	O
covariance	B
of	O
x	O
is	O
transferred	O
via	O
f	O
−1	O
◦	O
η	O
to	O
a	O
covariance	B
of	O
the	O
parameters	B
.	O
−1	O
,	O
clearly	O
does	O
not	O
hold	O
,	O
since	O
the	O
matrix	B
d	O
<	O
m.	O
the	O
formula	O
(	O
5.8	O
)	O
,	O
σp	O
=	O
(	O
jtς−1	O
on	O
the	O
right	O
side	O
is	O
not	O
invertible	O
.	O
x	O
j	O
)	O
in	O
fact	O
,	O
it	O
is	O
clear	O
that	O
without	O
any	O
further	O
restriction	O
,	O
the	O
elements	O
of	O
the	O
estimated	O
vector	O
(	O
cid:23	O
)	O
p	O
may	O
vary	O
without	O
bound	O
,	O
namely	O
through	O
multiplication	O
by	O
an	O
arbitrary	O
con-	O
stant	O
k.	O
hence	O
the	O
elements	O
have	O
inﬁnite	O
variance	O
.	O
it	O
is	O
usual	O
to	O
restrict	O
the	O
estimated	O
homography	B
matrix	O
h	O
or	O
more	O
generally	O
the	O
parameter	O
vector	O
p	O
by	O
imposing	O
some	O
con-	O
straint	O
.	O
the	O
usual	O
constraint	O
is	O
that	O
(	O
cid:10	O
)	O
p	O
(	O
cid:10	O
)	O
=	O
1	O
though	O
other	O
constraints	B
are	O
possible	O
,	O
such	O
as	O
demanding	O
that	O
the	O
last	O
parameter	O
should	O
equal	O
1	O
(	O
see	O
section	O
4.4.2	O
(	O
p105	O
)	O
)	O
.	O
thus	O
,	O
the	O
parameter	O
vector	O
p	O
is	O
constrained	O
to	O
lie	O
on	O
a	O
surface	O
in	O
the	O
parameter	B
space	I
ir9	O
,	O
or	O
generally	O
irm	O
.	O
in	O
the	O
ﬁrst	O
case	O
the	O
surface	O
(	O
cid:10	O
)	O
p	O
(	O
cid:10	O
)	O
=	O
1	O
is	O
the	O
unit	O
sphere	O
in	O
irm	O
.	O
the	O
constraint	O
pm	O
=	O
1	O
represents	O
a	O
plane	B
in	O
irm	O
.	O
in	O
the	O
general	O
case	O
we	O
may	O
assume	O
that	O
the	O
estimated	O
vector	O
p	O
lies	O
on	O
some	O
submanifold	O
of	O
irm	O
as	O
in	O
the	O
following	O
theorem	O
.	O
result	O
5.11.	O
backward	O
transport	O
of	O
covariance	O
–	O
over-parametrized	B
case	I
.	O
let	O
f	O
:	O
irm	O
→	O
irn	O
be	O
a	O
differentiable	O
mapping	O
taking	O
a	O
parameter	O
vector	O
p	O
to	O
a	O
mea-	O
surement	O
vector	O
x.	O
let	O
sp	O
be	O
a	O
smooth	O
manifold	O
of	O
dimension	O
d	O
embedded	O
in	O
irm	O
passing	O
through	O
point	B
p	O
,	O
and	O
such	O
that	O
the	O
map	O
f	O
is	O
one-to-one	O
on	O
the	O
manifold	O
sp	O
in	O
a	O
neighbourhood	O
of	O
p	O
,	O
mapping	O
sp	O
locally	O
to	O
a	O
manifold	O
f	O
(	O
sp	O
)	O
in	O
irn	O
.	O
the	O
function	O
f	O
−1	O
,	O
restricted	O
to	O
the	O
surface	O
f	O
(	O
sp	O
)	O
in	O
a	O
neighbourhood	O
of	O
has	O
a	O
local	O
inverse	O
,	O
denoted	O
f	O
x.	O
let	O
a	O
gaussian	O
distribution	B
on	O
irn	O
be	O
deﬁned	O
with	O
mean	O
x	O
and	O
covariance	B
matrix	O
σx	O
and	O
let	O
η	O
:	O
irn	O
→	O
f	O
(	O
sp	O
)	O
be	O
the	O
mapping	O
that	O
takes	O
a	O
point	B
in	O
irn	O
to	O
the	O
closest	O
−1	O
◦	O
η	O
the	O
probability	O
point	O
on	O
f	O
(	O
sp	O
)	O
with	O
respect	O
to	O
mahalanobis	O
norm	B
(	O
cid:10	O
)	O
·	O
(	O
cid:10	O
)	O
σx	O
.	O
via	O
f	O
distribution	B
on	O
irn	O
with	O
covariance	O
matrix	B
σx	O
induces	O
a	O
probability	O
distribution	O
on	O
irm	O
with	O
covariance	O
matrix	B
,	O
to	O
ﬁrst-order	O
equal	O
to	O
σp	O
=	O
(	O
jtς−1	O
x	O
j	O
)	O
+a	O
=	O
a	O
(	O
atjtς−1	O
(	O
5.9	O
)	O
where	O
a	O
is	O
any	O
m	O
×	O
d	O
matrix	B
whose	O
column	O
vectors	O
span	O
the	O
tangent	O
space	O
to	O
sp	O
at	O
p.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
5.4.	O
the	O
notation	O
(	O
jtς−1	O
x	O
j	O
)	O
+a	O
,	O
deﬁned	O
by	O
(	O
5.9	O
)	O
,	O
is	O
dis-	O
x	O
ja	O
)	O
−1at	O
cussed	O
further	O
in	O
section	O
a5.2	O
(	O
p590	O
)	O
.	O
144	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
proof	O
.	O
the	O
proof	O
of	O
result	O
5.11	O
is	O
straightforward	O
.	O
let	O
d	O
be	O
the	O
number	O
of	O
essential	O
parameters	B
.	O
one	O
deﬁnes	O
a	O
map	O
g	O
:	O
ird	O
→	O
irm	O
mapping	O
an	O
open	O
neighbourhood	O
u	O
in	O
ird	O
to	O
an	O
open	O
set	O
of	O
sp	O
containing	O
the	O
point	B
p.	O
then	O
the	O
combined	O
mapping	O
f	O
◦	O
g	O
:	O
ird	O
→	O
irn	O
is	O
one-to-one	O
on	O
the	O
neighbourhood	O
u.	O
let	O
us	O
denote	O
the	O
partial	O
derivative	O
matrices	O
of	O
f	O
by	O
j	O
and	O
of	O
g	O
by	O
a.	O
the	O
matrix	B
of	O
partial	O
derivatives	O
of	O
f	O
◦	O
g	O
is	O
then	O
ja	O
.	O
result	O
5.10	O
now	O
applies	O
,	O
and	O
one	O
sees	O
that	O
the	O
probability	O
distribution	O
function	O
with	O
covariance	B
matrix	O
σ	O
on	O
irn	O
may	O
be	O
transported	O
backwards	O
to	O
a	O
covariance	B
matrix	O
(	O
atjtς−1ja	O
)	O
−1	O
on	O
ird	O
.	O
transporting	O
this	O
forwards	O
again	O
to	O
irm	O
,	O
applying	O
result	O
5.6	O
,	O
we	O
arrive	O
at	O
the	O
covariance	B
matrix	O
a	O
(	O
atjtς−1ja	O
)	O
−1at	O
on	O
sp	O
.	O
this	O
matrix	B
,	O
which	O
will	O
be	O
denoted	O
here	O
by	O
(	O
jtς−1j	O
)	O
+a	O
,	O
is	O
related	O
to	O
the	O
pseudo-inverse	B
of	O
(	O
jtς−1j	O
)	O
as	O
deﬁned	O
in	O
section	O
a5.2	O
(	O
p590	O
)	O
.	O
the	O
expression	O
(	O
5.9	O
)	O
is	O
not	O
dependent	O
on	O
the	O
particular	O
choice	B
of	O
the	O
matrix	B
a	O
as	O
long	O
as	O
the	O
column	O
span	O
of	O
a	O
is	O
unchanged	O
.	O
in	O
particular	O
,	O
if	O
a	O
is	O
replaced	O
by	O
ab	O
for	O
any	O
invertible	O
d	O
×	O
d	O
matrix	B
b	O
,	O
then	O
the	O
value	O
of	O
(	O
5.9	O
)	O
does	O
not	O
change	O
.	O
thus	O
,	O
any	O
matrix	B
a	O
whose	O
columns	O
span	O
the	O
tangent	O
space	O
of	O
sp	O
at	O
p	O
will	O
do	O
.	O
note	O
that	O
the	O
proof	O
gives	O
a	O
speciﬁc	O
way	O
of	O
computing	O
a	O
matrix	B
a	O
spanning	O
the	O
tangent	O
space	O
–	O
namely	O
the	O
jacobian	O
matrix	B
of	O
g.	O
in	O
many	O
instances	O
,	O
as	O
we	O
will	O
see	O
,	O
there	O
are	O
easier	O
ways	O
of	O
ﬁnding	O
a.	O
note	O
that	O
the	O
covariance	B
matrix	O
(	O
5.9	O
)	O
is	O
singular	O
.	O
in	O
particular	O
,	O
it	O
has	O
dimension	O
m	O
and	O
rank	O
d	O
<	O
m.	O
this	O
is	O
because	O
the	O
variance	B
of	O
the	O
estimated	O
parameter	O
set	O
in	O
directions	O
orthogonal	B
to	O
the	O
constraint	O
surface	O
sp	O
is	O
zero	O
–	O
there	O
can	O
be	O
no	O
variation	O
in	O
that	O
direction	O
.	O
note	O
that	O
whereas	O
jtς−1j	O
is	O
non-invertible	O
,	O
the	O
d	O
×	O
d	O
matrix	B
atjtς−1ja	O
has	O
rank	O
d	O
and	O
is	O
invertible	O
.	O
an	O
important	O
case	O
occurs	O
when	O
the	O
constraint	O
surface	O
is	O
locally	O
orthogonal	B
to	O
the	O
null-space	B
of	O
the	O
jacobian	O
matrix	B
.	O
denote	O
by	O
nl	O
(	O
x	O
)	O
the	O
left	O
null-space	B
of	O
matrix	B
x	O
,	O
namely	O
the	O
space	O
of	O
all	O
vectors	O
x	O
such	O
that	O
xtx	O
=	O
0.	O
then	O
(	O
as	O
shown	O
in	O
section	O
a5.2-	O
(	O
p590	O
)	O
)	O
,	O
the	O
pseudo-inverse	B
x+	O
is	O
given	O
by	O
x+	O
=	O
x+a	O
=	O
a	O
(	O
atxa	O
)	O
−1at	O
if	O
and	O
only	O
if	O
nl	O
(	O
a	O
)	O
=n	O
l	O
(	O
x	O
)	O
.	O
the	O
following	O
result	O
then	O
derives	O
directly	O
from	O
result	O
5.11.	O
result	O
5.12.	O
let	O
f	O
:	O
irm	O
→	O
irn	O
be	O
a	O
differentiable	O
mapping	O
taking	O
p	O
to	O
x	O
,	O
and	O
let	O
j	O
be	O
the	O
jacobian	O
matrix	B
of	O
f.	O
let	O
a	O
gaussian	O
distribution	B
on	O
irn	O
be	O
deﬁned	O
at	O
x	O
with	O
−1	O
◦	O
η	O
:	O
irn	O
→	O
irm	O
as	O
in	O
result	O
5.11	O
be	O
the	O
mapping	O
covariance	O
matrix	B
σx	O
and	O
let	O
f	O
taking	O
a	O
measurement	O
x	O
to	O
the	O
mle	O
parameter	O
vector	O
p	O
constrained	O
to	O
lie	O
on	O
a	O
surface	O
−1	O
◦	O
η	O
induces	O
a	O
distribution	B
on	O
sp	O
locally	O
orthogonal	B
to	O
the	O
null-space	B
of	O
j.	O
then	O
f	O
irm	O
with	O
covariance	O
matrix	B
,	O
to	O
ﬁrst-order	O
equal	O
to	O
σp	O
=	O
(	O
jtς−1	O
x	O
j	O
)	O
+	O
.	O
(	O
5.10	O
)	O
note	O
that	O
the	O
restriction	O
that	O
p	O
be	O
constrained	O
to	O
lie	O
on	O
a	O
surface	O
locally	O
orthogonal	B
to	O
the	O
null-space	B
of	O
j	O
is	O
in	O
many	O
cases	O
the	O
natural	O
constraint	O
.	O
for	O
instance	O
,	O
if	O
p	O
is	O
a	O
homogeneous	O
parameter	O
vector	O
(	O
such	O
as	O
the	O
entries	O
of	O
a	O
homogeneous	O
matrix	B
)	O
,	O
the	O
restriction	O
is	O
satisﬁed	O
for	O
the	O
usual	O
constraint	O
(	O
cid:10	O
)	O
p	O
(	O
cid:10	O
)	O
=	O
1.	O
in	O
such	O
a	O
case	O
,	O
the	O
constraint	O
surface	O
is	O
the	O
unit	O
sphere	O
,	O
and	O
the	O
tangent	O
plane	O
at	O
any	O
point	B
is	O
perpendicular	O
to	O
the	O
parameter	O
vector	O
.	O
on	O
the	O
other	O
hand	O
,	O
since	O
p	O
is	O
a	O
homogeneous	O
vector	O
,	O
the	O
function	O
5.2	O
covariance	B
of	O
the	O
estimated	O
transformation	B
145	O
f	O
(	O
p	O
)	O
is	O
invariant	O
to	O
changes	O
of	O
scale	O
,	O
and	O
so	O
j	O
has	O
a	O
null-vector	O
in	O
the	O
radial	O
direction	O
,	O
thus	O
perpendicular	O
to	O
the	O
constraint	O
surface	O
.	O
in	O
other	O
cases	O
,	O
it	O
is	O
often	O
not	O
critical	O
what	O
restriction	O
we	O
place	O
on	O
the	O
parameter	O
set	O
for	O
the	O
purpose	O
of	O
computing	O
the	O
covariance	B
matrix	O
of	O
the	O
parameters	O
.	O
in	O
addition	O
,	O
since	O
the	O
pseudo-inversion	O
operation	O
is	O
its	O
own	O
inverse	O
,	O
we	O
can	O
retrieve	O
the	O
original	O
matrix	B
from	O
its	O
pseudo-inverse	B
,	O
according	O
to	O
jtς−1	O
p.	O
one	O
can	O
then	O
compute	O
the	O
covariance	B
matrix	O
corresponding	O
to	O
any	O
other	O
subspace	O
,	O
according	O
to	O
x	O
j	O
=	O
σ+	O
(	O
jtς−1	O
x	O
j	O
)	O
+a	O
=	O
(	O
σ+	O
p	O
)	O
+a	O
where	O
the	O
columns	O
of	O
a	O
span	O
the	O
constrained	O
subspace	O
of	O
parameter	O
space	O
.	O
5.2.4	O
application	O
and	O
examples	B
error	O
in	B
one	I
image	I
.	O
let	O
us	O
consider	O
the	O
application	O
of	O
this	O
theory	O
to	O
the	O
problem	O
of	O
ﬁnding	O
the	O
covariance	B
of	O
an	O
estimated	O
2d	O
homography	B
h.	O
first	O
,	O
we	O
look	O
at	O
the	O
case	O
where	O
the	O
error	B
is	O
limited	O
to	O
the	O
second	O
image	O
.	O
the	O
3	O
×	O
3	O
matrix	B
h	O
is	O
represented	O
by	O
a	O
9-dimensional	O
parameter	O
vector	O
which	O
will	O
be	O
denoted	O
by	O
h	O
instead	O
of	O
p	O
so	O
as	O
to	O
remind	O
us	O
that	O
it	O
is	O
made	O
up	O
of	O
the	O
entries	O
of	O
h.	O
the	O
covariance	B
of	O
the	O
estimated	O
ˆh	O
is	O
a	O
9	O
×	O
9	O
symmetric	B
matrix	O
.	O
we	O
are	O
given	O
a	O
set	O
of	O
matched	O
points	O
¯xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i.	O
the	O
points	O
¯xi	O
are	O
ﬁxed	O
true	O
values	O
,	O
and	O
the	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
considered	O
as	O
random	O
variables	O
subject	O
to	O
gaussian	O
noise	B
with	O
variance	B
σ2	O
in	O
each	O
component	O
,	O
or	O
if	O
desired	O
,	O
with	O
a	O
more	O
general	O
covariance	B
.	O
the	O
function	O
f	O
:	O
ir9	O
→	O
ir2n	O
is	O
deﬁned	O
as	O
mapping	O
a	O
9-	O
vector	O
h	O
representing	O
a	O
matrix	B
h	O
to	O
the	O
2n-vector	O
made	O
up	O
of	O
the	O
coordinates	O
of	O
the	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
make	O
up	O
a	O
composite	O
vector	O
in	O
irn	O
,	O
which	O
we	O
denote	O
by	O
x	O
(	O
cid:2	O
)	O
.	O
as	O
we	O
have	O
seen	O
,	O
as	O
h	O
varies	O
,	O
the	O
point	B
f	O
(	O
h	O
)	O
traces	O
out	O
an	O
8-dimensional	O
surface	O
sp	O
in	O
ir2n	O
.	O
each	O
point	B
x	O
(	O
cid:2	O
)	O
i	O
consistent	O
closest	O
point	B
(	O
cid:23	O
)	O
x	O
with	O
the	O
ﬁrst-image	O
points	O
¯xi	O
.	O
given	O
a	O
vector	O
of	O
measurements	O
x	O
(	O
cid:2	O
)	O
,	O
one	O
selects	O
the	O
−1	O
(	O
(	O
cid:23	O
)	O
x	O
(	O
cid:2	O
)	O
on	O
the	O
surface	O
sp	O
with	O
respect	O
to	O
mahalanobis	O
distance	B
.	O
the	O
pre-image	O
)	O
,	O
subject	O
to	O
constraint	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
represents	O
the	O
estimated	O
homography	B
ˆh	O
=	O
f	O
matrix	B
ˆh	O
,	O
estimated	O
using	O
the	O
ml	O
estimator	B
.	O
from	O
the	O
probability	O
distribution	O
of	O
values	O
of	O
x	O
(	O
cid:2	O
)	O
one	O
wishes	O
to	O
derive	O
the	O
distribution	B
of	O
the	O
estimated	O
ˆh	O
.	O
the	O
covariance	B
matrix	O
σh	O
is	O
given	O
by	O
result	O
5.12.	O
this	O
covariance	B
matrix	O
corresponds	O
to	O
the	O
constraint	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1.	O
thus	O
,	O
a	O
procedure	O
for	O
computing	O
the	O
covariance	B
matrix	O
of	O
the	O
estimated	O
transforma-	O
on	O
the	O
surface	O
represents	O
a	O
set	O
of	B
points	I
x	O
(	O
cid:2	O
)	O
i	O
=	O
h¯xi	O
.	O
the	O
coordinates	B
of	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
tion	O
is	O
as	O
follows	O
.	O
(	O
i	O
)	O
estimate	O
the	O
transformation	B
ˆh	O
from	O
the	O
given	O
data	O
.	O
(	O
ii	O
)	O
compute	O
the	O
jacobian	O
matrix	B
jf	O
=	O
∂x	O
(	O
cid:2	O
)	O
(	O
iii	O
)	O
the	O
covariance	B
matrix	O
of	O
the	O
estimated	O
h	O
is	O
given	O
by	O
(	O
5.10	O
)	O
:	O
σh	O
=	O
(	O
jt	O
f	O
/∂h	O
,	O
evaluated	O
at	O
ˆh	O
.	O
σ−1	O
x	O
(	O
cid:1	O
)	O
jf	O
)	O
+	O
.	O
we	O
investigate	O
the	O
two	O
last	O
steps	O
of	O
this	O
method	O
in	O
slightly	O
more	O
detail	O
.	O
computation	B
of	I
the	O
derivative	B
matrix	I
.	O
j	O
=	O
∂x	O
(	O
cid:2	O
)	O
n	O
)	O
t	O
where	O
ji	O
=	O
∂x	O
(	O
cid:2	O
)	O
(	O
jt	O
the	O
jacobian	O
matrix	B
/∂h	O
.	O
this	O
matrix	B
has	O
a	O
natural	O
decomposition	B
into	O
blocks	O
so	O
that	O
j	O
=	O
i/∂h	O
is	O
given	O
in	O
i/∂h	O
.	O
a	O
formula	O
for	O
∂x	O
(	O
cid:2	O
)	O
consider	O
ﬁrst	O
i	O
,	O
.	O
.	O
.	O
,	O
j	O
t	O
1	O
,	O
jt	O
2	O
,	O
.	O
.	O
.	O
,	O
j	O
t	O
146	O
(	O
4.21–p129	O
)	O
:	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
(	O
cid:17	O
)	O
˜xt	O
i	O
0t	O
˜xt	O
i	O
0t	O
−x	O
(	O
cid:2	O
)	O
i˜xt	O
−y	O
(	O
cid:2	O
)	O
i˜xt	O
i	O
i	O
(	O
cid:18	O
)	O
(	O
5.11	O
)	O
ji	O
=	O
∂x	O
(	O
cid:2	O
)	O
1	O
(	O
cid:2	O
)	O
w	O
i	O
i	O
represents	O
the	O
vector	O
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
.	O
i/∂h	O
=	O
/∂h	O
.	O
an	O
important	O
case	O
is	O
when	O
the	O
image	O
measurements	O
x	O
(	O
cid:2	O
)	O
where	O
˜xt	O
stacking	O
these	O
matrices	O
on	O
top	O
of	O
each	O
other	O
for	O
all	O
points	O
xi	O
gives	O
the	O
derivative	B
matrix	I
∂x	O
(	O
cid:2	O
)	O
i	O
are	O
independent	O
random	O
vectors	O
.	O
in	O
this	O
case	O
σ	O
=	O
diag	O
(	O
σ1	O
,	O
.	O
.	O
.	O
,	O
σ	O
n	O
)	O
where	O
each	O
σi	O
is	O
the	O
2×	O
2	O
covariance	B
matrix	O
of	O
the	O
i-th	O
measured	O
point	B
x	O
(	O
cid:2	O
)	O
σh	O
=	O
(	O
jtς−1	O
i.	O
then	O
one	O
computes	O
σ−1	O
(	O
cid:20	O
)	O
(	O
cid:7	O
)	O
x	O
(	O
cid:1	O
)	O
j	O
)	O
+	O
=	O
(	O
5.12	O
)	O
(	O
cid:21	O
)	O
+	O
.	O
ji	O
jt	O
i	O
i	O
i	O
example	O
5.13.	O
we	O
consider	O
the	O
simple	O
numerical	O
example	O
of	O
a	O
point	O
correspondence	B
containing	O
just	O
4	O
points	O
as	O
follows	O
:	O
x1	O
=	O
(	O
1	O
,	O
0	O
)	O
t	O
↔	O
(	O
1	O
,	O
0	O
)	O
t	O
=	O
x	O
(	O
cid:2	O
)	O
x2	O
=	O
(	O
0	O
,	O
1	O
)	O
t	O
↔	O
(	O
0	O
,	O
1	O
)	O
t	O
=	O
x	O
(	O
cid:2	O
)	O
x3	O
=	O
(	O
−1	O
,	O
0	O
)	O
t	O
↔	O
(	O
−1	O
,	O
0	O
)	O
t	O
=	O
x	O
(	O
cid:2	O
)	O
x4	O
=	O
(	O
0	O
,	O
−1	O
)	O
t	O
↔	O
(	O
0	O
,	O
−1	O
)	O
t	O
=	O
x	O
(	O
cid:2	O
)	O
1	O
2	O
3	O
4	O
namely	O
,	O
the	O
identity	O
map	O
on	O
the	O
points	O
of	O
a	O
projective	B
basis	O
.	O
we	O
assume	O
that	O
points	O
xi	O
are	O
known	O
exactly	O
,	O
and	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
have	O
one	O
pixel	O
standard	O
deviation	O
in	O
each	O
coordinate	O
direction	O
.	O
this	O
means	O
that	O
the	O
covariance	B
matrix	O
σx	O
(	O
cid:1	O
)	O
obviously	O
,	O
the	O
computed	O
homography	O
will	O
be	O
the	O
identity	O
map	O
.	O
for	O
simplicity	O
we	O
normalize	O
(	O
scale	O
it	O
)	O
so	O
that	O
it	O
is	O
indeed	O
the	O
identity	O
matrix	B
,	O
and	O
hence	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
2	O
=	O
3	O
instead	O
of	O
the	O
usual	O
normalization	B
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
=	O
1.	O
in	O
this	O
case	O
,	O
all	O
the	O
w	O
(	O
cid:2	O
)	O
i	O
in	O
(	O
5.11	O
)	O
are	O
equal	O
to	O
1.	O
the	O
matrix	B
j	O
is	O
easily	O
computed	O
from	O
(	O
5.11	O
)	O
to	O
equal	O
i	O
is	O
the	O
identity	O
.	O
jtj	O
=	O
(	O
5.13	O
)	O
j	O
=	O
then	O
	O
	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
−1	O
0	O
0	O
0	O
0	O
−1	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
1	O
0	O
0	O
1	O
0	O
0	O
1	O
0	O
0	O
−1	O
0	O
0	O
0	O
1	O
0	O
−1	O
0	O
0	O
−1	O
0	O
−1	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
−1	O
−1	O
1	O
0	O
−1	O
1	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
0	O
−1	O
1	O
1	O
0	O
−2	O
2	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
2	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
−2	O
0	O
0	O
4	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
2	O
0	O
0	O
0	O
0	O
0	O
0	O
−2	O
0	O
0	O
0	O
0	O
2	O
0	O
0	O
0	O
−2	O
0	O
0	O
0	O
0	O
0	O
0	O
4	O
0	O
0	O
−2	O
0	O
0	O
0	O
0	O
2	O
0	O
0	O
−2	O
0	O
0	O
0	O
0	O
0	O
2	O
0	O
−2	O
0	O
0	O
0	O
−2	O
0	O
0	O
0	O
4	O
	O
.	O
	O
.	O
5.2	O
covariance	B
of	O
the	O
estimated	O
transformation	B
147	O
to	O
take	O
the	O
pseudo-inverse	B
of	O
this	O
matrix	B
,	O
we	O
may	O
use	O
(	O
5.9	O
)	O
where	O
a	O
is	O
a	O
matrix	B
with	O
columns	O
spanning	O
the	O
tangent	O
plane	O
to	O
the	O
constraint	O
surface	O
.	O
since	O
h	O
is	O
computed	O
subject	O
to	O
the	O
condition	O
(	O
cid:10	O
)	O
h	O
(	O
cid:10	O
)	O
2	O
=	O
3	O
,	O
which	O
represents	O
a	O
hypersphere	O
,	O
the	O
constraint	O
sur-	O
face	O
is	O
perpendicular	O
to	O
the	O
vector	O
h	O
corresponding	O
to	O
the	O
computed	O
homography	O
h.	O
a	O
householder	O
matrix	B
a	O
(	O
see	O
section	O
a4.1.2	O
(	O
p580	O
)	O
)	O
corresponding	O
to	O
the	O
vector	O
h	O
has	O
the	O
property	O
that	O
ah	O
=	O
(	O
0	O
,	O
.	O
.	O
.	O
,0	O
,	O
1	O
)	O
t	O
,	O
so	O
the	O
ﬁrst	O
8	O
columns	O
of	O
a	O
(	O
denoted	O
a1	O
)	O
are	O
per-	O
pendicular	O
to	O
h	O
as	O
required	O
.	O
this	O
allows	O
the	O
pseudo-inverse	B
to	O
be	O
computed	O
exactly	O
without	O
using	O
svd	O
.	O
applying	O
(	O
5.9	O
)	O
the	O
pseudo-inverse	B
is	O
computed	O
to	O
be	O
	O
5	O
0	O
0	O
0	O
−4	O
0	O
9	O
0	O
0	O
0	O
0	O
9	O
0	O
0	O
0	O
0	O
9	O
−4	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
9	O
0	O
0	O
0	O
0	O
0	O
−1	O
0	O
0	O
0	O
−1	O
0	O
0	O
0	O
0	O
0	O
9	O
0	O
0	O
0	O
0	O
0	O
0	O
5	O
0	O
0	O
0	O
9	O
0	O
0	O
18	O
0	O
9	O
0	O
	O
.	O
0	O
−1	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
−1	O
0	O
9	O
0	O
0	O
0	O
0	O
18	O
2	O
0	O
0	O
(	O
5.14	O
)	O
(	O
cid:2	O
)	O
σh	O
=	O
(	O
jtj	O
)	O
+a1	O
=	O
a1	O
(	O
at	O
1	O
(	O
jtj	O
)	O
a1	O
)	O
−1at	O
1	O
=	O
1	O
18	O
the	O
diagonals	O
give	O
the	O
individual	O
variances	O
of	O
the	O
entries	O
of	O
h.	O
this	O
computed	O
covariance	O
is	O
used	O
to	O
assess	O
the	O
accuracy	O
of	O
point	O
transfer	B
in	O
example	O
5.14	O
.	O
5.2.5	O
error	B
in	I
both	I
images	I
in	O
the	O
case	O
of	O
error	O
in	B
both	I
images	I
,	O
computation	B
of	I
the	O
covariance	B
of	O
the	O
transformation	B
is	O
a	O
bit	O
more	O
complicated	O
.	O
as	O
seen	O
in	O
section	O
4.2.7	O
(	O
p101	O
)	O
,	O
one	O
may	O
deﬁne	O
a	O
set	O
of	O
2n+8	O
parameters	B
,	O
where	O
8	O
parameters	B
describe	O
the	O
transformation	B
matrix	O
and	O
2n	O
parameters	B
ˆxi	O
represent	O
estimates	O
of	O
the	O
points	O
in	O
the	O
ﬁrst	O
image	O
.	O
more	O
conveniently	O
,	O
one	O
may	O
over-parametrize	O
by	O
using	O
9	O
parameters	B
for	O
the	O
transformation	B
h.	O
the	O
jacobian	O
matrix	B
naturally	O
splits	O
up	O
into	O
two	O
parts	O
as	O
j	O
=	O
[	O
a	O
|	O
b	O
]	O
where	O
a	O
and	O
b	O
are	O
the	O
derivatives	O
with	O
respect	O
to	O
the	O
camera	B
parameters	I
and	O
the	O
points	O
xi	O
respectively	O
.	O
applying	O
(	O
5.10	O
)	O
one	O
computes	O
(	O
cid:17	O
)	O
jtς−1	O
x	O
j	O
=	O
atς−1	O
btς−1	O
x	O
a	O
atς−1	O
x	O
b	O
x	O
a	O
btς−1	O
x	O
b	O
(	O
cid:18	O
)	O
.	O
the	O
pseudo-inverse	B
of	O
this	O
matrix	B
is	O
the	O
covariance	B
of	O
the	O
parameter	O
set	O
and	O
the	O
top-left	O
block	O
of	O
this	O
pseudo-inverse	B
is	O
the	O
covariance	B
of	O
the	O
entries	O
of	O
h.	O
a	O
detailed	O
discussion	O
of	O
this	O
is	O
given	O
in	O
section	O
a6.4.1	O
(	O
p608	O
)	O
,	O
where	O
it	O
is	O
shown	O
how	O
one	O
can	O
make	O
use	O
of	O
the	O
block	O
structure	B
of	O
the	O
jacobian	O
to	O
simplify	O
the	O
computation	B
.	O
in	O
example	O
5.13	O
on	O
estimating	O
the	O
covariance	B
of	O
h	O
from	O
four	O
points	O
in	O
the	O
previous	O
section	O
,	O
the	O
covariance	B
turns	O
out	O
to	O
be	O
σh	O
=	O
2	O
(	O
jtς−1	O
x	O
(	O
cid:1	O
)	O
j	O
)	O
+	O
,	O
namely	O
twice	O
the	O
covariance	B
computed	O
for	O
noise	O
in	B
one	I
image	I
only	O
.	O
this	O
assumes	O
that	O
points	O
are	O
measured	O
with	O
the	O
same	O
covariance	O
in	B
both	I
images	I
.	O
this	O
simple	O
relationship	O
between	O
the	O
covariances	O
in	O
the	O
one	O
and	O
two-image	O
cases	O
does	O
not	O
generally	O
hold	O
.	O
148	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
5.2.6	O
using	O
the	O
covariance	B
matrix	O
in	O
point	O
transfer	B
once	O
one	O
has	O
the	O
covariance	B
,	O
one	O
may	O
compute	O
the	O
uncertainty	O
associated	O
with	O
a	O
given	O
point	B
transfer	I
.	O
consider	O
a	O
new	O
point	B
x	O
in	O
the	O
ﬁrst	O
image	O
,	O
not	O
used	O
in	O
the	O
computation	B
of	I
the	O
transformation	B
,	O
h.	O
the	O
corresponding	O
point	B
in	O
the	O
second	O
image	O
is	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
.	O
however	O
,	O
because	O
of	O
the	O
uncertainty	O
in	O
the	O
estimation	B
of	I
h	O
,	O
the	O
correct	O
location	O
of	O
the	O
point	O
x	O
(	O
cid:2	O
)	O
will	O
also	O
have	O
associated	O
uncertainty	O
.	O
one	O
may	O
compute	O
this	O
uncertainty	O
from	O
the	O
covariance	B
matrix	O
of	O
h.	O
the	O
covariance	B
matrix	O
for	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
is	O
given	O
by	O
the	O
formula	O
σx	O
(	O
cid:1	O
)	O
=	O
jhσhjt	O
h	O
(	O
5.15	O
)	O
where	O
jh	O
=	O
∂x	O
(	O
cid:2	O
)	O
/∂h	O
.	O
a	O
formula	O
for	O
∂x	O
(	O
cid:2	O
)	O
/∂h	O
is	O
given	O
in	O
(	O
4.21–p129	O
)	O
.	O
if	O
in	O
addition	O
,	O
the	O
point	B
x	O
itself	O
is	O
measured	O
with	O
some	O
uncertainty	O
,	O
then	O
one	O
has	O
instead	O
σx	O
(	O
cid:1	O
)	O
=	O
jhσhjt	O
h	O
+	O
jxσxjt	O
x	O
(	O
5.16	O
)	O
assuming	O
that	O
there	O
is	O
no	O
cross-correlation	O
between	O
x	O
and	O
h	O
,	O
which	O
is	O
reasonable	O
,	O
since	O
point	B
x	O
is	O
assumed	O
to	O
be	O
a	O
new	O
point	B
not	O
used	O
in	O
the	O
computation	B
of	I
the	O
transformation	B
h.	O
a	O
formula	O
for	O
the	O
jacobian	O
matrix	B
jx	O
=	O
∂x	O
(	O
cid:2	O
)	O
/∂x	O
is	O
given	O
in	O
(	O
4.20–p129	O
)	O
.	O
the	O
covariance	B
matrix	O
σx	O
(	O
cid:1	O
)	O
given	O
by	O
(	O
5.15	O
)	O
is	O
expressed	O
in	O
terms	O
of	O
the	O
covariance	O
matrix	B
σh	O
of	O
the	O
transformation	O
h.	O
we	O
have	O
seen	O
that	O
this	O
covariance	B
matrix	O
σh	O
depends	O
on	O
the	O
particular	O
constraint	O
used	O
in	O
estimating	O
h	O
,	O
according	O
to	O
(	O
5.9	O
)	O
.	O
it	O
may	O
therefore	O
appear	O
that	O
σx	O
(	O
cid:1	O
)	O
also	O
depends	O
on	O
the	O
particular	O
method	O
used	O
to	O
constrain	O
h.	O
it	O
may	O
however	O
be	O
veriﬁed	O
that	O
these	O
formulae	O
are	O
independent	O
of	O
the	O
particular	O
constraint	O
a	O
used	O
to	O
compute	O
the	O
covariance	B
matrix	O
σp	O
=	O
(	O
jtς−1	O
example	O
5.14.	O
to	O
continue	O
example	O
5.13	O
,	O
let	O
the	O
computed	O
2d	O
homography	B
h	O
be	O
given	O
by	O
the	O
identity	O
matrix	B
,	O
with	O
covariance	O
matrix	B
σh	O
as	O
in	O
(	O
5.14	O
)	O
.	O
consider	O
an	O
arbitrary	O
point	B
(	O
x	O
,	O
y	O
)	O
mapped	O
to	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
=	O
hx	O
.	O
in	O
this	O
case	O
the	O
covariance	B
matrix	O
σx	O
(	O
cid:1	O
)	O
=	O
jhσhjt	O
h	O
may	O
be	O
computed	O
symbolically	O
to	O
equal	O
x	O
j	O
)	O
+a	O
.	O
σx	O
(	O
cid:1	O
)	O
=	O
σx	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
σx	O
(	O
cid:1	O
)	O
y	O
(	O
cid:1	O
)	O
σx	O
(	O
cid:1	O
)	O
y	O
(	O
cid:1	O
)	O
σy	O
(	O
cid:1	O
)	O
y	O
(	O
cid:1	O
)	O
=	O
1	O
4	O
2	O
−	O
x2	O
+	O
x4	O
+	O
y2	O
+	O
x2y2	O
xy	O
(	O
x2	O
+	O
y2	O
−	O
2	O
)	O
xy	O
(	O
x2	O
+	O
y2	O
−	O
2	O
)	O
2	O
−	O
y2	O
+	O
y4	O
+	O
x2	O
+	O
x2y2	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
.	O
note	O
that	O
σx	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
and	O
σy	O
(	O
cid:1	O
)	O
y	O
(	O
cid:1	O
)	O
are	O
even	O
functions	O
of	O
x	O
and	O
y	O
,	O
whereas	O
σx	O
(	O
cid:1	O
)	O
y	O
(	O
cid:1	O
)	O
is	O
an	O
odd	O
func-	O
tion	O
.	O
this	O
is	O
a	O
consequence	O
of	O
the	O
symmetry	O
about	O
the	O
x	O
and	O
y	O
axes	O
of	O
the	O
point	O
set	O
used	O
to	O
compute	O
h.	O
also	O
note	O
that	O
σx	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
and	O
σy	O
(	O
cid:1	O
)	O
y	O
(	O
cid:1	O
)	O
differ	O
by	O
swapping	O
x	O
and	O
y	O
,	O
which	O
is	O
a	O
further	O
consequence	O
of	O
the	O
symmetry	O
of	O
the	O
deﬁning	O
point	B
set	O
.	O
as	O
may	O
be	O
seen	O
,	O
the	O
variance	B
σx	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
varies	O
as	O
the	O
fourth	O
power	O
of	O
x	O
,	O
and	O
hence	O
the	O
standard	O
deviation	O
varies	O
as	O
the	O
square	O
.	O
this	O
shows	O
that	O
extrapolating	O
the	O
values	O
of	O
transformed	O
points	O
x	O
(	O
cid:2	O
)	O
(	O
cid:19	O
)	O
=	O
hx	O
far	O
beyond	O
the	O
set	O
of	B
points	I
used	O
to	O
compute	O
h	O
is	O
not	O
reliable	O
.	O
more	O
speciﬁcally	O
,	O
the	O
rms	O
uncertainty	O
of	O
the	O
position	O
of	O
x	O
(	O
cid:2	O
)	O
is	O
equal	O
to	O
(	O
σx	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
+	O
σy	O
(	O
cid:1	O
)	O
y	O
(	O
cid:1	O
)	O
)	O
1/2	O
=	O
trace	O
(	O
σx	O
(	O
cid:1	O
)	O
)	O
which	O
one	O
ﬁnds	O
is	O
equal	O
to	O
(	O
1	O
+	O
(	O
x2	O
+	O
y2	O
)	O
2	O
)	O
1/2	O
=	O
(	O
1	O
+	O
r4	O
)	O
1/2	O
,	O
where	O
r	O
is	O
the	O
radial	O
distance	O
from	O
the	O
origin	O
.	O
note	O
the	O
interesting	O
fact	O
that	O
the	O
rms	O
error	B
is	O
only	O
dependent	O
on	O
the	O
radial	O
distance	O
.	O
in	O
fact	O
,	O
one	O
may	O
verify	O
that	O
the	O
probability	O
distribution	O
for	O
point	O
x	O
(	O
cid:2	O
)	O
,	O
its	O
depends	O
only	O
on	O
the	O
radial	O
distance	O
of	O
x	O
(	O
cid:2	O
)	O
5.3	O
monte	O
carlo	O
estimation	B
of	I
covariance	O
149	O
8	O
6	O
4	O
2	O
0.5	O
1	O
1.5	O
2	O
2.5	O
3	O
fig	O
.	O
5.5.	O
rms	O
error	O
in	O
the	O
position	O
of	O
a	O
projected	O
point	B
x	O
(	O
cid:1	O
)	O
from	O
the	O
origin	O
.	O
the	O
homography	B
h	O
is	O
computed	O
from	O
4	O
evenly	O
spaced	O
points	O
on	O
a	O
unit	O
circle	O
around	O
the	O
origin	O
with	O
errors	O
in	O
the	O
second	O
image	O
only	O
.	O
the	O
rms	O
error	B
is	O
proportional	O
to	O
the	O
assumed	O
error	O
in	O
the	O
points	O
used	O
to	O
compute	O
h	O
,	O
and	O
the	O
vertical	O
axis	O
is	O
calibrated	B
in	O
terms	O
of	O
this	O
assumed	O
error	B
.	O
as	O
a	O
function	O
of	O
radial	O
distance	O
of	O
x	O
(	O
cid:1	O
)	O
two	O
principal	O
axes	O
pointing	O
radially	O
and	O
tangentially	O
.	O
figure	O
5.5	O
shows	O
the	O
graph	O
of	O
the	O
(	O
cid:2	O
)	O
rms	O
error	O
in	O
x	O
(	O
cid:2	O
)	O
as	O
a	O
function	O
of	O
r.	O
this	O
example	O
has	O
computed	O
the	O
covariance	B
of	O
a	O
transferred	O
point	B
in	O
the	O
minimal	O
case	O
of	O
four	O
point	B
correspondences	O
.	O
for	O
more	O
than	O
four	O
correspondences	O
,	O
the	O
situation	O
is	O
not	O
substantially	O
different	O
.	O
extrapolation	O
beyond	O
the	O
set	O
of	B
points	I
used	O
to	O
compute	O
the	O
homography	B
is	O
unreliable	O
.	O
in	O
fact	O
,	O
one	O
may	O
show	O
that	O
if	O
h	O
is	O
computed	O
from	O
n	O
points	O
evenly	O
spaced	O
around	O
a	O
unit	O
circle	O
(	O
instead	O
of	O
4	O
as	O
in	O
the	O
computation	B
above	O
)	O
then	O
the	O
rms	O
error	B
is	O
equal	O
to	O
σx	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
+	O
σy	O
(	O
cid:1	O
)	O
y	O
(	O
cid:1	O
)	O
=	O
4	O
(	O
1	O
+	O
r4	O
)	O
/n	O
,	O
so	O
the	O
error	B
exhibits	O
the	O
same	O
quadratic	O
growth	O
.	O
5.3	O
monte	O
carlo	O
estimation	B
of	I
covariance	O
the	O
method	O
of	O
estimating	O
covariance	B
discussed	O
in	O
the	O
previous	O
sections	O
has	O
relied	O
on	O
an	O
assumption	O
of	O
linearity	O
.	O
in	O
other	O
words	O
,	O
it	O
has	O
been	O
assumed	O
that	O
the	O
surface	O
f	O
(	O
h	O
)	O
is	O
locally	O
ﬂat	O
in	O
the	O
vicinity	O
of	O
the	O
estimated	O
point	B
,	O
at	O
least	O
over	O
a	O
region	O
corresponding	O
to	O
the	O
approximate	O
extent	O
of	O
the	O
noise	O
distribution	B
.	O
it	O
has	O
also	O
been	O
assumed	O
that	O
the	O
method	O
of	B
estimation	I
of	O
the	O
transformation	B
h	O
was	O
the	O
maximum	O
likelihood	O
estimate	O
.	O
if	O
the	O
surface	O
is	O
not	O
entirely	O
ﬂat	O
then	O
the	O
estimate	O
of	O
covariance	O
may	O
be	O
incorrect	O
.	O
in	O
addition	O
,	O
a	O
particular	O
estimation	B
method	O
may	O
be	O
inferior	O
to	O
the	O
ml	O
estimate	O
,	O
thereby	O
introducing	O
additional	O
uncertainty	O
in	O
the	O
values	O
of	O
the	O
estimated	O
transformation	B
h.	O
a	O
general	O
(	O
though	O
expensive	O
)	O
method	O
of	O
getting	O
an	O
estimate	O
of	O
the	O
covariance	O
is	O
by	O
exhaustive	O
simulation	O
.	O
assuming	O
that	O
the	O
noise	B
is	O
drawn	O
from	O
a	O
given	O
noise	B
dis-	O
tribution	O
,	O
one	O
starts	O
with	O
a	O
set	O
of	O
point	O
matches	O
corresponding	O
perfectly	O
to	O
a	O
given	O
transformation	B
.	O
one	O
then	O
adds	O
noise	B
to	O
the	O
points	O
and	O
computes	O
the	O
corresponding	O
transformation	B
using	O
the	O
chosen	O
estimation	B
procedure	O
.	O
the	O
covariance	B
of	O
the	O
trans-	O
formation	O
h	O
or	O
a	O
further	O
transferred	O
point	B
is	O
then	O
computed	O
statistically	O
from	O
multiple	O
trials	O
with	O
noise	O
drawn	O
from	O
the	O
assumed	O
noise	B
distribution	O
.	O
this	O
is	O
illustrated	O
for	O
the	O
case	O
of	O
the	O
identity	O
mapping	O
in	O
ﬁgure	O
5.6.	O
both	O
the	O
analytical	O
and	O
the	O
monte	O
carlo	O
methods	O
of	O
estimating	O
covariance	B
of	O
the	O
transformation	B
h	O
may	O
be	O
applied	O
to	O
the	O
estimation	B
of	I
covariance	O
from	O
real	O
data	O
for	O
which	O
one	O
does	O
not	O
know	O
the	O
true	O
value	O
of	O
h.	O
from	O
the	O
given	O
data	O
,	O
an	O
estimate	O
of	O
h	O
and	O
the	O
corresponding	O
true	O
values	O
of	O
the	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
and	O
xi	O
are	O
computed	O
.	O
then	O
the	O
150	O
5	O
algorithm	B
evaluation	O
and	O
error	B
analysis	O
fig	O
.	O
5.6.	O
transfer	B
of	O
a	O
point	B
under	O
the	O
identity	O
mapping	O
for	O
the	O
normalized	O
and	O
unnormalized	O
dlt	O
algorithm	B
.	O
see	O
also	O
ﬁgure	O
4.4	O
(	O
p109	O
)	O
for	O
further	O
explanation	O
.	O
covariance	B
is	O
computed	O
as	O
if	O
the	O
estimated	O
values	O
were	O
the	O
true	O
values	O
of	O
the	O
matched	O
data	O
points	O
and	O
the	O
transformation	B
.	O
the	O
resulting	O
covariance	B
matrix	O
is	O
assumed	O
to	O
be	O
the	O
covariance	B
of	O
the	O
true	O
transformation	B
.	O
this	O
identiﬁcation	O
is	O
based	O
on	O
the	O
assumption	O
that	O
the	O
true	O
values	O
of	O
the	O
data	O
points	O
are	O
sufﬁciently	O
close	O
to	O
the	O
estimated	O
values	O
that	O
the	O
covariance	B
matrix	O
is	O
essentially	O
unaffected	O
.	O
5.4	O
closure	O
an	O
extended	O
discussion	O
of	O
bias	O
and	O
variance	B
of	O
estimated	O
parameters	B
is	O
given	O
in	O
appendix	O
3	O
(	O
p568	O
)	O
.	O
5.4.1	O
the	O
literature	O
the	O
derivations	O
throughout	O
this	O
chapter	O
have	O
been	O
considerably	O
simpliﬁed	O
by	O
only	O
us-	O
ing	O
ﬁrst-order	O
taylor	O
expansions	O
,	O
and	O
assuming	O
gaussian	O
error	B
distributions	O
.	O
similar	O
ideas	O
(	O
ml	O
,	O
covariance	B
.	O
.	O
.	O
)	O
can	O
be	O
developed	O
for	O
other	O
distributions	O
by	O
using	O
the	O
fisher	O
information	O
matrix	B
.	O
related	O
reading	O
may	O
be	O
found	O
in	O
kanatani	O
[	O
kanatani-96	O
]	O
,	O
press	O
et	O
al	O
.	O
[	O
press-88	O
]	O
,	O
and	O
other	O
statistical	O
textbooks	O
.	O
criminisi	O
et	O
al	O
.	O
[	O
criminisi-99b	O
]	O
give	O
many	O
examples	B
of	O
the	O
computed	O
covariances	O
in	O
point	O
transfer	B
as	O
the	O
correspondences	B
used	O
to	O
determine	O
the	O
homography	B
vary	O
in	O
number	O
and	O
position	O
.	O
5.4.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
consider	O
the	O
problem	O
of	O
computing	O
a	O
best	O
line	B
ﬁt	O
to	O
a	O
set	O
of	O
2d	O
points	O
in	O
the	O
plane	B
using	O
orthogonal	B
regression	I
.	O
suppose	O
that	O
n	O
points	O
are	O
measured	O
with	O
independent	O
standard	O
deviations	O
of	O
σ	O
in	O
each	O
coordinate	O
.	O
what	O
is	O
the	O
expected	O
rms	O
distance	B
of	O
each	O
point	B
from	O
a	O
ﬁtted	O
line	B
?	O
answer	O
:	O
σ	O
(	O
(	O
n	O
−	O
2	O
)	O
/n	O
)	O
1/2	O
.	O
(	O
ii	O
)	O
(	O
harder	O
)	O
:	O
in	O
section	O
18.5.2	O
(	O
p450	O
)	O
a	O
method	O
is	O
given	O
for	O
computing	O
a	O
projective	B
reconstruction	I
from	O
a	O
set	O
of	O
n+4	O
point	B
correspondences	O
across	O
m	O
views	O
,	O
where	O
4	O
of	O
the	O
point	O
correspondences	B
are	O
presumed	O
to	O
be	O
known	O
to	O
be	O
from	O
a	O
plane	B
.	O
suppose	O
the	O
4	O
planar	O
correspondences	O
are	O
known	O
exactly	O
,	O
and	O
the	O
other	O
n	O
image	O
points	O
are	O
measured	O
with	O
1	O
pixel	O
error	B
(	O
each	O
coordinate	O
in	O
each	O
image	O
)	O
.	O
what	O
is	O
the	O
expected	O
residual	B
error	O
of	O
(	O
cid:10	O
)	O
xi	O
−	O
ˆpixj	O
(	O
cid:10	O
)	O
?	O
j	O
part	O
i	O
camera	B
geometry	O
and	O
single	B
view	I
geometry	O
the	O
cyclops	O
,	O
c.	O
1914	O
(	O
oil	O
on	O
canvas	O
)	O
by	O
odilon	O
redon	O
(	O
1840-1916	O
)	O
rijksmuseum	O
kroller-muller	O
,	O
otterlo	O
,	O
netherlands	O
/bridgeman	O
art	O
library	O
outline	O
this	O
part	O
of	O
the	O
book	O
concentrates	O
on	O
the	O
geometry	O
of	O
a	O
single	O
perspective	O
camera	B
.	O
it	O
contains	O
three	O
chapters	O
.	O
chapter	O
6	O
describes	O
the	O
projection	B
of	O
3d	O
scene	O
space	O
onto	O
a	O
2d	O
image	B
plane	I
.	O
the	O
camera	B
mapping	O
is	O
represented	O
by	O
a	O
matrix	B
,	O
and	O
in	O
the	O
case	O
of	O
mapping	O
points	O
it	O
is	O
a	O
3	O
×	O
4	O
matrix	B
p	O
which	O
maps	O
from	O
homogeneous	O
coordinates	B
of	O
a	O
world	O
point	B
in	O
3-space	O
to	O
homogeneous	O
coordinates	B
of	O
the	O
imaged	O
point	B
on	O
the	O
image	B
plane	I
.	O
this	O
matrix	B
has	O
in	O
general	O
11	O
degrees	B
of	I
freedom	I
,	O
and	O
the	O
properties	B
of	O
the	O
camera	B
,	O
such	O
as	O
its	O
centre	B
and	O
focal	B
length	I
,	O
may	O
be	O
extracted	O
from	O
it	O
.	O
in	O
particular	O
the	O
internal	B
camera	O
parameters	B
,	O
such	O
as	O
the	O
focal	B
length	I
and	O
aspect	O
ratio	O
,	O
are	O
packaged	O
in	O
a	O
3	O
×	O
3	O
matrix	B
k	O
which	O
is	O
obtained	O
from	O
p	O
by	O
a	O
simple	O
decomposition	O
.	O
there	O
are	O
two	O
particularly	O
important	O
classes	O
of	B
camera	I
matrix	O
:	O
ﬁnite	B
cameras	O
,	O
and	O
cameras	B
with	O
their	O
centre	B
at	O
inﬁnity	O
such	O
as	O
the	O
afﬁne	B
camera	I
which	O
represents	O
parallel	B
projection	I
.	O
chapter	O
7	O
describes	O
the	O
estimation	B
of	I
the	O
camera	B
matrix	I
p	O
,	O
given	O
the	O
coordinates	B
of	O
a	O
set	O
of	O
corresponding	O
world	O
and	O
image	O
points	O
.	O
the	O
chapter	O
also	O
describes	O
how	O
constraints	B
on	O
the	O
camera	B
may	O
be	O
efﬁciently	O
incorporated	O
into	O
the	O
estimation	B
,	O
and	O
a	O
method	O
of	O
correcting	O
for	O
radial	O
lens	O
distortion	B
.	O
chapter	O
8	O
has	O
three	O
main	O
topics	O
.	O
first	O
,	O
it	O
covers	O
the	O
action	O
of	O
a	O
camera	B
on	O
geometric	B
objects	O
other	O
than	O
ﬁnite	B
points	O
.	O
these	O
include	O
lines	B
,	O
conics	O
,	O
quadrics	B
and	O
points	O
at	O
inﬁnity	O
.	O
the	O
image	O
of	O
points/lines	O
at	B
inﬁnity	I
are	O
vanishing	O
points/lines	O
.	O
the	O
second	O
topic	O
is	O
camera	B
calibration	I
,	O
in	O
which	O
the	O
internal	B
parameters	I
k	O
of	O
the	O
camera	O
matrix	B
are	O
computed	O
,	O
without	O
computing	B
the	O
entire	O
matrix	B
p.	O
in	O
particular	O
the	O
relation	B
of	O
the	O
internal	B
parameters	I
to	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
is	O
described	O
,	O
and	O
the	O
calibration	B
of	O
a	O
camera	B
from	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
.	O
the	O
ﬁnal	O
topic	O
is	O
the	O
calibrating	B
conic	I
.	O
this	O
is	O
a	O
simple	O
geometric	O
device	O
for	O
visualizing	O
camera	B
calibration	I
.	O
152	O
6	O
camera	B
models	O
a	O
camera	B
is	O
a	O
mapping	O
between	O
the	O
3d	O
world	O
(	O
object	O
space	O
)	O
and	O
a	O
2d	O
image	O
.	O
the	O
principal	O
camera	O
of	O
interest	O
in	O
this	O
book	O
is	O
central	B
projection	I
.	O
this	O
chapter	O
develops	O
a	O
number	O
of	O
camera	O
models	O
which	O
are	O
matrices	O
with	O
particular	O
properties	B
that	O
represent	O
the	O
camera	B
mapping	O
.	O
it	O
will	O
be	O
seen	O
that	O
all	O
cameras	B
modelling	O
central	B
projection	I
are	O
specializations	O
of	O
the	O
general	O
projective	B
camera	I
.	O
the	O
anatomy	O
of	O
this	O
most	O
general	O
camera	O
model	B
is	O
examined	O
using	O
the	O
tools	O
of	O
projective	O
geometry	O
.	O
it	O
will	O
be	O
seen	O
that	O
geometric	B
entities	O
of	O
the	O
camera	O
,	O
such	O
as	O
the	O
projection	B
centre	O
and	O
image	B
plane	I
,	O
can	O
be	O
computed	O
quite	O
simply	O
from	O
its	O
matrix	B
representation	O
.	O
specializations	O
of	O
the	O
general	O
projective	B
camera	I
inherit	O
its	O
properties	B
,	O
for	O
example	O
their	O
geometry	O
is	O
computed	O
using	O
the	O
same	O
algebraic	O
expressions	O
.	O
the	O
specialized	O
models	O
fall	O
into	O
two	O
major	O
classes	O
–	O
those	O
that	O
model	B
cameras	O
with	O
a	O
ﬁnite	B
centre	O
,	O
and	O
those	O
that	O
model	B
cameras	O
with	O
centre	O
“	O
at	B
inﬁnity	I
”	O
.	O
of	O
the	O
cam-	O
eras	O
at	B
inﬁnity	I
the	O
afﬁne	B
camera	I
is	O
of	O
particular	O
importance	O
because	O
it	O
is	O
the	O
natural	O
generalization	O
of	O
parallel	O
projection	O
.	O
this	O
chapter	O
is	O
principally	O
concerned	O
with	O
the	O
projection	B
of	O
points	O
.	O
the	O
action	O
of	O
a	O
camera	B
on	O
other	O
geometric	B
entities	O
,	O
such	O
as	O
lines	O
,	O
is	O
deferred	O
until	O
chapter	O
8	O
.	O
6.1	O
finite	O
cameras	B
in	O
this	O
section	O
we	O
start	O
with	O
the	O
most	O
specialized	O
and	O
simplest	O
camera	B
model	O
,	O
which	O
is	O
the	O
basic	O
pinhole	O
camera	O
,	O
and	O
then	O
progressively	O
generalize	O
this	O
model	B
through	O
a	O
series	O
of	O
gradations	O
.	O
the	O
models	O
we	O
develop	O
are	O
principally	O
designed	O
for	O
ccd	O
like	O
sensors	O
,	O
but	O
are	O
also	O
applicable	O
to	O
other	O
cameras	B
,	O
for	O
example	O
x-ray	O
images	O
,	O
scanned	O
photographic	O
nega-	O
tives	O
,	O
scanned	O
photographs	O
from	O
enlarged	O
negatives	O
,	O
etc	O
.	O
the	O
basic	B
pinhole	I
model	I
.	O
we	O
consider	O
the	O
central	B
projection	I
of	O
points	O
in	O
space	O
onto	O
a	O
plane	B
.	O
let	O
the	O
centre	B
of	O
projection	B
be	O
the	O
origin	O
of	O
a	O
euclidean	O
coordinate	O
system	O
,	O
and	O
consider	O
the	O
plane	B
z	O
=	O
f	O
,	O
which	O
is	O
called	O
the	O
image	B
plane	I
or	O
focal	O
plane	O
.	O
under	O
the	O
pinhole	O
camera	O
model	B
,	O
a	O
point	B
in	O
space	O
with	O
coordinates	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
is	O
mapped	O
to	O
the	O
point	B
on	O
the	O
image	B
plane	I
where	O
a	O
line	B
joining	O
the	O
point	B
x	O
to	O
the	O
centre	B
of	O
projection	B
meets	O
the	O
image	B
plane	I
.	O
this	O
is	O
shown	O
in	O
ﬁgure	O
6.1.	O
by	O
similar	O
triangles	O
,	O
one	O
quickly	O
153	O
154	O
y	O
6	O
camera	B
models	O
x	O
x	O
y	O
p	O
x	O
x	O
z	O
y	O
c	O
principal	O
axis	O
f	O
image	B
plane	I
c	O
camera	B
centre	I
f	O
y	O
/	O
z	O
p	O
z	O
fig	O
.	O
6.1.	O
pinhole	O
camera	O
geometry	O
.	O
c	O
is	O
the	O
camera	B
centre	I
and	O
p	O
the	O
principal	B
point	I
.	O
the	O
camera	B
centre	I
is	O
here	O
placed	O
at	O
the	O
coordinate	O
origin	O
.	O
note	O
the	O
image	B
plane	I
is	O
placed	O
in	O
front	O
of	O
the	O
camera	O
centre	B
.	O
computes	O
that	O
the	O
point	B
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
is	O
mapped	O
to	O
the	O
point	B
(	O
f	O
x/z	O
,	O
f	O
y/z	O
,	O
f	O
)	O
t	O
on	O
the	O
image	B
plane	I
.	O
ignoring	O
the	O
ﬁnal	O
image	O
coordinate	O
,	O
we	O
see	O
that	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
(	O
cid:6	O
)	O
→	O
(	O
f	O
x/z	O
,	O
f	O
y/z	O
)	O
t	O
(	O
6.1	O
)	O
describes	O
the	O
central	B
projection	I
mapping	O
from	O
world	O
to	O
image	O
coordinates	B
.	O
this	O
is	O
a	O
mapping	O
from	O
euclidean	O
3-space	O
ir3	O
to	O
euclidean	O
2-space	O
ir2	O
.	O
the	O
centre	B
of	O
projection	B
is	O
called	O
the	O
camera	B
centre	I
.	O
it	O
is	O
also	O
known	O
as	O
the	O
optical	O
centre	B
.	O
the	O
line	B
from	O
the	O
camera	B
centre	I
perpendicular	O
to	O
the	O
image	B
plane	I
is	O
called	O
the	O
principal	O
axis	O
or	O
principal	O
ray	O
of	O
the	O
camera	O
,	O
and	O
the	O
point	B
where	O
the	O
principal	O
axis	O
meets	O
the	O
image	B
plane	I
is	O
called	O
the	O
principal	B
point	I
.	O
the	O
plane	B
through	O
the	O
camera	B
centre	I
parallel	O
to	O
the	O
image	B
plane	I
is	O
called	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
.	O
central	B
projection	I
using	O
homogeneous	O
coordinates	O
.	O
if	O
the	O
world	O
and	O
image	O
points	O
are	O
represented	O
by	O
homogeneous	O
vectors	O
,	O
then	O
central	B
projection	I
is	O
very	O
simply	O
ex-	O
pressed	O
as	O
a	O
linear	B
mapping	O
between	O
their	O
homogeneous	O
coordinates	O
.	O
in	O
particular	O
,	O
(	O
6.1	O
)	O
may	O
be	O
written	O
in	O
terms	O
of	O
matrix	O
multiplication	O
as	O
	O
x	O
y	O
z	O
1	O
	O
(	O
cid:6	O
)	O
→	O
	O
f	O
x	O
f	O
y	O
z	O
	O
=	O
	O
f	O
	O
.	O
	O
	O
x	O
y	O
z	O
1	O
f	O
0	O
0	O
1	O
0	O
(	O
6.2	O
)	O
the	O
matrix	B
in	O
this	O
expression	O
may	O
be	O
written	O
as	O
diag	O
(	O
f	O
,	O
f	O
,	O
1	O
)	O
[	O
i	O
|	O
0	O
]	O
where	O
diag	O
(	O
f	O
,	O
f	O
,	O
1	O
)	O
is	O
a	O
diagonal	O
matrix	B
and	O
[	O
i	O
|	O
0	O
]	O
represents	O
a	O
matrix	B
divided	O
up	O
into	O
a	O
3	O
×	O
3	O
block	O
(	O
the	O
identity	O
matrix	B
)	O
plus	O
a	O
column	B
vector	I
,	O
here	O
the	O
zero	O
vector	O
.	O
we	O
now	O
introduce	O
the	O
notation	O
x	O
for	O
the	O
world	O
point	B
represented	O
by	O
the	O
homoge-	O
neous	O
4-vector	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
,	O
x	O
for	O
the	O
image	O
point	O
represented	O
by	O
a	O
homogeneous	O
3-	O
vector	O
,	O
and	O
p	O
for	O
the	O
3×4	O
homogeneous	O
camera	O
projection	B
matrix	O
.	O
then	O
(	O
6.2	O
)	O
is	O
written	O
compactly	O
as	O
x	O
=	O
px	O
which	O
deﬁnes	O
the	O
camera	B
matrix	I
for	O
the	O
pinhole	B
model	I
of	O
central	B
projection	I
as	O
p	O
=	O
diag	O
(	O
f	O
,	O
f	O
,	O
1	O
)	O
[	O
i	O
|	O
0	O
]	O
.	O
6.1	O
finite	O
cameras	B
155	O
y	O
cam	O
p	O
x	O
cam	O
y	O
0	O
y	O
x	O
x	O
0	O
fig	O
.	O
6.2.	O
image	O
(	O
x	O
,	O
y	O
)	O
and	O
camera	B
(	O
xcam	O
,	O
ycam	O
)	O
coordinate	O
systems	O
.	O
principal	B
point	I
offset	I
.	O
the	O
expression	O
(	O
6.1	O
)	O
assumed	O
that	O
the	O
origin	O
of	O
coordinates	O
in	O
the	O
image	B
plane	I
is	O
at	O
the	O
principal	B
point	I
.	O
in	O
practice	O
,	O
it	O
may	O
not	O
be	O
,	O
so	O
that	O
in	O
general	O
there	O
is	O
a	O
mapping	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
(	O
cid:6	O
)	O
→	O
(	O
f	O
x/z	O
+	O
px	O
,	O
f	O
y/z	O
+	O
py	O
)	O
t	O
where	O
(	O
px	O
,	O
py	O
)	O
t	O
are	O
the	O
coordinates	B
of	O
the	O
principal	B
point	I
.	O
see	O
ﬁgure	O
6.2.	O
this	O
equation	O
may	O
be	O
expressed	O
conveniently	O
in	O
homogeneous	O
coordinates	B
as	O
	O
(	O
cid:6	O
)	O
→	O
	O
x	O
y	O
z	O
1	O
	O
f	O
f	O
y	O
+	O
zpy	O
	O
=	O
	O
f	O
x	O
+	O
zpx	O
	O
f	O
k	O
=	O
z	O
px	O
f	O
py	O
1	O
	O
.	O
	O
	O
x	O
y	O
z	O
1	O
px	O
0	O
f	O
py	O
0	O
0	O
1	O
	O
(	O
6.3	O
)	O
(	O
6.4	O
)	O
(	O
6.5	O
)	O
now	O
,	O
writing	O
then	O
(	O
6.3	O
)	O
has	O
the	O
concise	O
form	O
x	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
xcam	O
.	O
the	O
matrix	B
k	O
is	O
called	O
the	O
camera	B
calibration	I
matrix	O
.	O
in	O
(	O
6.5	O
)	O
we	O
have	O
written	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
as	O
xcam	O
to	O
emphasize	O
that	O
the	O
camera	B
is	O
assumed	O
to	O
be	O
located	O
at	O
the	O
origin	O
of	O
a	O
euclidean	O
coordinate	O
system	O
with	O
the	O
principal	O
axis	O
of	O
the	O
camera	B
pointing	O
straight	O
down	O
the	O
z-axis	O
,	O
and	O
the	O
point	B
xcam	O
is	O
expressed	O
in	O
this	O
coordinate	O
system	O
.	O
such	O
a	O
coordinate	O
system	O
may	O
be	O
called	O
the	O
camera	B
coordinate	O
frame	O
.	O
camera	B
rotation	I
and	O
translation	O
.	O
in	O
general	O
,	O
points	O
in	O
space	O
will	O
be	O
expressed	O
in	O
terms	O
of	O
a	O
different	O
euclidean	O
coordinate	O
frame	O
,	O
known	O
as	O
the	O
world	O
coordinate	O
frame	O
.	O
the	O
two	O
coordinate	O
frames	O
are	O
related	O
via	O
a	O
rotation	O
and	O
a	O
translation	O
.	O
see	O
ﬁgure	O
6.3.	O
if	O
(	O
cid:22	O
)	O
x	O
is	O
an	O
inhomogeneous	O
3-vector	O
representing	O
the	O
coordinates	B
of	O
a	O
point	B
in	O
the	O
world	O
coordinate	O
frame	O
,	O
and	O
(	O
cid:22	O
)	O
xcam	O
represents	O
the	O
same	O
point	O
in	O
the	O
camera	B
coordinate	O
frame	O
,	O
then	O
we	O
may	O
write	O
(	O
cid:22	O
)	O
xcam	O
=	O
r	O
(	O
(	O
cid:22	O
)	O
x−	O
(	O
cid:22	O
)	O
c	O
)	O
,	O
where	O
(	O
cid:22	O
)	O
c	O
represents	O
the	O
coordinates	B
of	O
the	O
camera	B
xcam	O
=	O
0	O
x	O
.	O
(	O
6.6	O
)	O
(	O
cid:18	O
)	O
r	O
−r	O
(	O
cid:22	O
)	O
c	O
0	O
1	O
(	O
cid:17	O
)	O
r	O
−r	O
(	O
cid:22	O
)	O
c	O
(	O
cid:17	O
)	O
	O
=	O
(	O
cid:18	O
)	O
	O
x	O
x	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
x	O
y	O
z	O
1	O
1	O
156	O
6	O
camera	B
models	O
y	O
cam	O
c	O
xcam	O
zcam	O
r	O
,	O
t	O
z	O
o	O
x	O
y	O
fig	O
.	O
6.3.	O
the	O
euclidean	O
transformation	O
between	O
the	O
world	O
and	O
camera	B
coordinate	O
frames	O
.	O
centre	B
in	O
the	O
world	O
coordinate	O
frame	O
,	O
and	O
r	O
is	O
a	O
3	O
×	O
3	O
rotation	B
matrix	O
representing	O
the	O
orientation	B
of	O
the	O
camera	B
coordinate	O
frame	O
.	O
this	O
equation	O
may	O
be	O
written	O
in	O
homoge-	O
neous	O
coordinates	B
as	O
putting	O
this	O
together	O
with	O
(	O
6.5	O
)	O
leads	O
to	O
the	O
formula	O
(	O
6.7	O
)	O
contained	O
in	O
k	O
are	O
called	O
the	O
internal	B
camera	O
parameters	B
,	O
or	O
the	O
internal	B
orientation	O
where	O
x	O
is	O
now	O
in	O
a	O
world	O
coordinate	O
frame	O
.	O
this	O
is	O
the	O
general	O
mapping	O
given	O
by	O
a	O
pinhole	O
camera	O
.	O
one	O
sees	O
that	O
a	O
general	O
pinhole	O
camera	B
,	O
p	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
,	O
has	O
9	O
degrees	B
of	I
freedom	I
:	O
3	O
for	O
k	O
(	O
the	O
elements	O
f	O
,	O
px	O
,	O
py	O
)	O
,	O
3	O
for	O
r	O
,	O
and	O
3	O
for	O
(	O
cid:22	O
)	O
c.	O
the	O
parameters	B
of	O
the	O
camera	B
.	O
the	O
parameters	B
of	O
r	O
and	O
(	O
cid:22	O
)	O
c	O
which	O
relate	O
the	O
camera	B
orientation	I
and	O
the	O
world	O
to	O
image	O
transformation	B
as	O
(	O
cid:22	O
)	O
xcam	O
=	O
r	O
(	O
cid:22	O
)	O
x	O
+	O
t.	O
in	O
this	O
case	O
the	O
camera	B
matrix	I
is	O
where	O
from	O
(	O
6.7	O
)	O
t	O
=	O
−r	O
(	O
cid:22	O
)	O
c.	O
position	O
to	O
a	O
world	O
coordinate	O
system	O
are	O
called	O
the	O
external	O
parameters	B
or	O
the	O
exterior	B
orientation	I
.	O
it	O
is	O
often	O
convenient	O
not	O
to	O
make	O
the	O
camera	B
centre	I
explicit	O
,	O
and	O
instead	O
to	O
represent	O
p	O
=	O
k	O
[	O
r	O
|	O
t	O
]	O
simply	O
(	O
6.8	O
)	O
ccd	O
cameras	B
.	O
the	O
pinhole	O
camera	O
model	B
just	O
derived	O
assumes	O
that	O
the	O
image	O
coor-	O
dinates	O
are	O
euclidean	O
coordinates	O
having	O
equal	O
scales	O
in	O
both	O
axial	O
directions	O
.	O
in	O
the	O
case	O
of	O
ccd	O
cameras	B
,	O
there	O
is	O
the	O
additional	O
possibility	O
of	O
having	O
non-square	O
pixels	O
.	O
if	O
image	O
coordinates	O
are	O
measured	O
in	O
pixels	O
,	O
then	O
this	O
has	O
the	O
extra	O
effect	O
of	O
introducing	O
unequal	O
scale	O
factors	O
in	O
each	O
direction	O
.	O
in	O
particular	O
if	O
the	O
number	O
of	O
pixels	O
per	O
unit	O
	O
	O
.	O
	O
αx	O
k	O
=	O
x0	O
αy	O
y0	O
1	O
	O
αx	O
k	O
=	O
s	O
x0	O
αy	O
y0	O
1	O
p	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
(	O
6.9	O
)	O
(	O
6.10	O
)	O
(	O
6.11	O
)	O
6.1	O
finite	O
cameras	B
157	O
distance	B
in	O
image	O
coordinates	O
are	O
mx	O
and	O
my	O
in	O
the	O
x	O
and	O
y	O
directions	O
,	O
then	O
the	O
trans-	O
formation	O
from	O
world	O
coordinates	B
to	O
pixel	O
coordinates	B
is	O
obtained	O
by	O
multiplying	O
(	O
6.4	O
)	O
on	O
the	O
left	O
by	O
an	O
extra	O
factor	O
diag	O
(	O
mx	O
,	O
my	O
,	O
1	O
)	O
.	O
thus	O
,	O
the	O
general	O
form	O
of	O
the	O
calibration	O
matrix	B
of	O
a	O
ccd	O
camera	B
is	O
where	O
αx	O
=	O
f	O
mx	O
and	O
αy	O
=	O
f	O
my	O
represent	O
the	O
focal	B
length	I
of	O
the	O
camera	B
in	O
terms	O
of	O
pixel	O
dimensions	O
in	O
the	O
x	O
and	O
y	O
direction	O
respectively	O
.	O
similarly	O
,	O
˜x0	O
=	O
(	O
x0	O
,	O
y0	O
)	O
is	O
the	O
principal	B
point	I
in	O
terms	O
of	O
pixel	O
dimensions	O
,	O
with	O
coordinates	O
x0	O
=	O
mxpx	O
and	O
y0	O
=	O
mypy	O
.	O
a	O
ccd	O
camera	B
thus	O
has	O
10	O
degrees	B
of	I
freedom	I
.	O
finite	O
projective	B
camera	I
.	O
for	O
added	O
generality	O
,	O
we	O
can	O
consider	O
a	O
calibration	B
matrix	I
of	O
the	O
form	O
the	O
added	O
parameter	O
s	O
is	O
referred	O
to	O
as	O
the	O
skew	O
parameter	O
.	O
the	O
skew	O
parameter	O
will	O
be	O
zero	O
for	O
most	O
normal	O
cameras	O
.	O
however	O
,	O
in	O
certain	O
unusual	O
instances	O
which	O
are	O
described	O
in	O
section	O
6.2.4	O
,	O
it	O
can	O
take	O
non-zero	O
values	O
.	O
a	O
camera	B
for	O
which	O
the	O
calibration	B
matrix	I
k	O
is	O
of	O
the	O
form	O
(	O
6.10	O
)	O
will	O
be	O
called	O
a	O
ﬁnite	B
projective	I
camera	O
.	O
a	O
ﬁnite	B
projective	I
camera	O
has	O
11	O
degrees	B
of	I
freedom	I
.	O
this	O
is	O
the	O
same	O
number	O
of	O
degrees	O
of	O
freedom	O
as	O
a	O
3	O
×	O
4	O
matrix	B
,	O
deﬁned	O
up	O
to	O
an	O
arbitrary	O
scale	O
.	O
note	O
that	O
the	O
left	O
hand	O
3×	O
3	O
submatrix	O
of	O
p	O
,	O
equal	O
to	O
kr	O
,	O
is	O
non-singular	O
.	O
conversely	O
,	O
any	O
3	O
×	O
4	O
matrix	B
p	O
for	O
which	O
the	O
left	O
hand	O
3	O
×	O
3	O
submatrix	O
is	O
non-singular	O
is	O
the	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
.	O
indeed	O
,	O
letting	O
m	O
be	O
the	O
left	O
3	O
×	O
3	O
submatrix	O
of	O
p	O
,	O
one	O
decomposes	O
m	O
as	O
camera	O
matrix	B
of	O
some	O
ﬁnite	B
projective	I
camera	O
,	O
because	O
p	O
can	O
be	O
decomposed	O
as	O
p	O
=	O
therefore	O
be	O
written	O
p	O
=	O
m	O
[	O
i	O
|	O
m−1p4	O
]	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
where	O
p4	O
is	O
the	O
last	O
column	O
of	O
p.	O
in	O
short	O
•	O
the	O
set	O
of	B
camera	I
matrices	O
of	O
ﬁnite	O
projective	B
cameras	O
is	O
identical	O
with	O
the	O
set	O
of	O
homogeneous	O
3×	O
4	O
matrices	O
for	O
which	O
the	O
left	O
hand	O
3×	O
3	O
submatrix	O
is	O
non-singular	O
.	O
a	O
product	O
m	O
=	O
kr	O
where	O
k	O
is	O
upper-triangular	O
of	O
the	O
form	O
(	O
6.10	O
)	O
and	O
r	O
is	O
a	O
rotation	B
matrix	O
.	O
this	O
decomposition	B
is	O
essentially	O
the	O
rq	O
matrix	B
decomposition	O
,	O
described	O
in	O
section	O
a4.1.1	O
(	O
p579	O
)	O
,	O
of	O
which	O
more	O
will	O
be	O
said	O
in	O
section	O
6.2.4.	O
the	O
matrix	B
p	O
can	O
general	B
projective	I
cameras	O
.	O
the	O
ﬁnal	O
step	O
in	O
our	O
hierarchy	B
of	I
projective	O
cameras	B
is	O
to	O
remove	O
the	O
non-singularity	O
restriction	O
on	O
the	O
left	O
hand	O
3	O
×	O
3	O
submatrix	O
.	O
a	O
general	B
projective	I
camera	O
is	O
one	O
represented	O
by	O
an	O
arbitrary	O
homogeneous	O
3×	O
4	O
matrix	B
of	O
rank	O
3.	O
it	O
has	O
11	O
degrees	B
of	I
freedom	I
.	O
the	O
rank	O
3	O
requirement	O
arises	O
because	O
if	O
the	O
rank	O
is	O
158	O
6	O
camera	B
models	O
camera	B
centre	I
.	O
the	O
camera	B
centre	I
is	O
the	O
1-dimensional	O
right	O
null-space	B
c	O
of	O
p	O
,	O
i.e	O
.	O
pc	O
=	O
0	O
.	O
(	O
cid:21	O
)	O
finite	O
camera	B
(	O
m	O
is	O
not	O
singular	O
)	O
c	O
=	O
(	O
cid:21	O
)	O
camera	B
at	O
inﬁnity	O
(	O
m	O
is	O
singular	O
)	O
c	O
=	O
i.e	O
.	O
md	O
=	O
0	O
.	O
(	O
cid:29	O
)	O
(	O
cid:28	O
)	O
−m−1p4	O
(	O
cid:28	O
)	O
(	O
cid:29	O
)	O
1	O
d	O
0	O
where	O
d	O
is	O
the	O
null	O
3-vector	O
of	O
m	O
,	O
column	O
points	O
.	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
3	O
,	O
the	O
column	O
vectors	O
pi	O
are	O
vanishing	B
points	I
in	O
the	O
image	O
corresponding	O
to	O
the	O
x	O
,	O
y	O
and	O
z	O
axes	O
respectively	O
.	O
column	O
p4	O
is	O
the	O
image	O
of	O
the	O
coordinate	O
origin	O
.	O
principal	B
plane	I
.	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
is	O
p3	O
,	O
the	O
last	O
row	O
of	O
p.	O
axis	O
planes	O
.	O
the	O
planes	O
p1	O
and	O
p2	O
(	O
the	O
ﬁrst	O
and	O
second	O
rows	O
of	O
p	O
)	O
represent	O
planes	O
in	O
space	O
through	O
the	O
camera	B
centre	I
,	O
corresponding	O
to	O
points	O
that	O
map	O
to	O
the	O
image	O
lines	O
x	O
=	O
0	O
and	O
y	O
=	O
0	O
respectively	O
.	O
principal	B
point	I
.	O
the	O
image	O
point	O
x0	O
=	O
mm3	O
is	O
the	O
principal	B
point	I
of	O
the	O
camera	B
,	O
where	O
m3t	O
is	O
the	O
third	O
row	O
of	O
m.	O
principal	O
ray	O
.	O
the	O
principal	O
ray	O
(	O
axis	O
)	O
of	O
the	O
camera	O
is	O
the	O
ray	O
passing	O
through	O
the	O
camera	B
centre	I
c	O
with	O
direction	O
vector	O
m3t	O
.	O
the	O
principal	B
axis	I
vector	I
v	O
=	O
det	O
(	O
m	O
)	O
m3	O
is	O
directed	O
towards	O
the	O
front	O
of	O
the	O
camera	O
.	O
table	O
6.1.	O
summary	B
of	O
the	O
properties	B
of	O
a	O
projective	B
camera	I
p.	O
the	O
matrix	B
is	O
represented	O
by	O
the	O
block	O
form	O
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
.	O
less	O
than	O
this	O
then	O
the	O
range	O
of	O
the	O
matrix	O
mapping	O
will	O
be	O
a	O
line	B
or	O
point	O
and	O
not	O
the	O
whole	O
plane	B
;	O
in	O
other	O
words	O
not	O
a	O
2d	O
image	O
.	O
6.2	O
the	O
projective	B
camera	I
a	O
general	B
projective	I
camera	O
p	O
maps	O
world	O
points	O
x	O
to	O
image	O
points	O
x	O
according	O
to	O
x	O
=	O
px	O
.	O
building	O
on	O
this	O
mapping	O
we	O
will	O
now	O
dissect	O
the	O
camera	B
model	O
to	O
reveal	O
how	O
geometric	B
entities	O
,	O
such	O
as	O
the	O
camera	B
centre	I
,	O
are	O
encoded	O
.	O
some	O
of	O
the	O
properties	O
that	O
we	O
consider	O
will	O
apply	O
only	O
to	O
ﬁnite	O
projective	B
cameras	O
and	O
their	O
specializations	O
,	O
whilst	O
others	O
will	O
apply	O
to	O
general	O
cameras	B
.	O
the	O
distinction	O
will	O
be	O
evident	O
from	O
the	O
context	O
.	O
the	O
derived	O
properties	B
of	O
the	O
camera	B
are	O
summarized	O
in	O
table	O
6.1	O
.	O
6.2.1	O
camera	B
anatomy	I
a	O
general	B
projective	I
camera	O
may	O
be	O
decomposed	O
into	O
blocks	O
according	O
to	O
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
,	O
where	O
m	O
is	O
a	O
3	O
×	O
3	O
matrix	B
.	O
it	O
will	O
be	O
seen	O
that	O
if	O
m	O
is	O
non-singular	O
,	O
then	O
this	O
is	O
a	O
ﬁnite	B
camera	O
,	O
otherwise	O
it	O
is	O
not	O
.	O
camera	B
centre	I
.	O
the	O
matrix	B
p	O
has	O
a	O
1-dimensional	O
right	O
null-space	B
because	O
its	O
rank	O
is	O
3	O
,	O
whereas	O
it	O
has	O
4	O
columns	O
.	O
suppose	O
the	O
null-space	B
is	O
generated	O
by	O
the	O
4-vector	O
c	O
,	O
that	O
is	O
pc	O
=	O
0.	O
it	O
will	O
now	O
be	O
shown	O
that	O
c	O
is	O
the	O
camera	B
centre	I
,	O
represented	O
as	O
a	O
homogeneous	O
4-vector	O
.	O
consider	O
the	O
line	B
containing	O
c	O
and	O
any	O
other	O
point	B
a	O
in	O
3-space	O
.	O
points	O
on	O
this	O
line	B
may	O
be	O
represented	O
by	O
the	O
join	O
x	O
(	O
λ	O
)	O
=λ	O
a	O
+	O
(	O
1−	O
λ	O
)	O
c	O
.	O
6.2	O
the	O
projective	B
camera	I
159	O
c	O
p	O
3	O
p	O
2	O
p	O
1	O
o	O
z	O
y	O
x	O
fig	O
.	O
6.4.	O
the	O
three	O
image	O
points	O
deﬁned	O
by	O
the	O
columns	O
pi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
3	O
,	O
of	O
the	O
projection	O
matrix	B
are	O
the	O
vanishing	B
points	I
of	O
the	O
directions	O
of	O
the	O
world	O
axes	O
.	O
under	O
the	O
mapping	O
x	O
=	O
px	O
points	O
on	O
this	O
line	B
are	O
projected	O
to	O
x	O
=	O
px	O
(	O
λ	O
)	O
=λ	O
pa	O
+	O
(	O
1−	O
λ	O
)	O
pc	O
=	O
λpa	O
since	O
pc	O
=	O
0.	O
that	O
is	O
all	O
points	O
on	O
the	O
line	B
are	O
mapped	O
to	O
the	O
same	O
image	O
point	B
pa	O
,	O
which	O
means	O
that	O
the	O
line	B
must	O
be	O
a	O
ray	O
through	O
the	O
camera	B
centre	I
.	O
it	O
follows	O
that	O
c	O
is	O
the	O
homogeneous	B
representation	I
of	O
the	O
camera	B
centre	I
,	O
since	O
for	O
all	O
choices	O
of	O
a	O
the	O
line	B
x	O
(	O
λ	O
)	O
is	O
a	O
ray	O
through	O
the	O
camera	B
centre	I
.	O
this	O
result	O
is	O
not	O
unexpected	O
since	O
the	O
image	O
point	O
(	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
=	O
pc	O
is	O
not	O
deﬁned	O
,	O
the	O
case	O
of	O
ﬁnite	O
cameras	B
the	O
result	O
may	O
be	O
established	O
directly	O
,	O
since	O
c	O
=	O
(	O
(	O
cid:22	O
)	O
ct	O
and	O
the	O
camera	B
centre	I
is	O
the	O
unique	O
point	B
in	O
space	O
for	O
which	O
the	O
image	O
is	O
undeﬁned	O
.	O
in	O
is	O
clearly	O
the	O
null-vector	O
of	O
p	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
.	O
the	O
result	O
is	O
true	O
even	O
in	O
the	O
case	O
where	O
,	O
1	O
)	O
t	O
the	O
ﬁrst	O
3×	O
3	O
submatrix	O
m	O
of	O
p	O
is	O
singular	O
.	O
in	O
this	O
singular	O
case	O
,	O
though	O
,	O
the	O
null-vector	O
has	O
the	O
form	O
c	O
=	O
(	O
dt	O
,	O
0	O
)	O
t	O
where	O
md	O
=	O
0.	O
the	O
camera	B
centre	I
is	O
then	O
a	O
point	B
at	O
inﬁnity	O
.	O
camera	B
models	O
of	O
this	O
class	O
are	O
discussed	O
in	O
section	O
6.3.	O
column	O
vectors	O
.	O
the	O
columns	O
of	O
the	O
projective	O
camera	B
are	O
3-vectors	O
which	O
have	O
a	O
geometric	B
meaning	O
as	O
particular	O
image	O
points	O
.	O
with	O
the	O
notation	O
that	O
the	O
columns	O
of	O
p	O
are	O
pi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
,	O
then	O
p1	O
,	O
p2	O
,	O
p3	O
are	O
the	O
vanishing	B
points	I
of	O
the	O
world	O
coordinate	O
x	O
,	O
y	O
and	O
z	O
axes	O
respectively	O
.	O
this	O
follows	O
because	O
these	O
points	O
are	O
the	O
images	O
of	O
the	O
axes	O
’	O
directions	O
.	O
for	O
example	O
the	O
x-axis	O
has	O
direction	O
d	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
which	O
is	O
imaged	O
at	O
p1	O
=	O
pd	O
.	O
see	O
ﬁgure	O
6.4.	O
the	O
column	O
p4	O
is	O
the	O
image	O
of	O
the	O
world	O
origin	O
.	O
row	O
vectors	O
.	O
the	O
rows	O
of	O
the	O
projective	O
camera	B
(	O
6.12	O
)	O
are	O
4-vectors	O
which	O
may	O
be	O
interpreted	O
geometrically	O
as	O
particular	O
world	O
planes	O
.	O
these	O
planes	O
are	O
examined	O
next	O
.	O
we	O
introduce	O
the	O
notation	O
that	O
the	O
rows	O
of	O
p	O
are	O
pit	O
so	O
that	O
	O
p11	O
p12	O
p13	O
p14	O
p21	O
p22	O
p23	O
p24	O
p31	O
p32	O
p33	O
p34	O
	O
=	O
p	O
=	O
	O
.	O
	O
p1t	O
p2t	O
p3t	O
(	O
6.12	O
)	O
160	O
6	O
camera	B
models	O
y	O
x	O
2	O
p	O
p	O
3	O
y	O
x	O
principal	B
plane	I
fig	O
.	O
6.5.	O
two	O
of	O
the	O
three	O
planes	O
deﬁned	O
by	O
the	O
rows	O
of	O
the	O
projection	O
matrix	B
.	O
the	O
principal	B
plane	I
.	O
the	O
principal	B
plane	I
is	O
the	O
plane	B
through	O
the	O
camera	B
centre	I
par-	O
allel	O
to	O
the	O
image	B
plane	I
.	O
it	O
consists	O
of	O
the	O
set	O
of	B
points	I
x	O
which	O
are	O
imaged	O
on	O
the	O
line	B
at	I
inﬁnity	I
of	O
the	O
image	O
.	O
explicitly	O
,	O
px	O
=	O
(	O
x	O
,	O
y	O
,	O
0	O
)	O
t.	O
thus	O
a	O
point	B
lies	O
on	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
if	O
and	O
only	O
if	O
p3tx	O
=	O
0.	O
in	O
other	O
words	O
,	O
p3	O
is	O
the	O
vector	O
repre-	O
senting	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
.	O
if	O
c	O
is	O
the	O
camera	B
centre	I
,	O
then	O
pc	O
=	O
0	O
,	O
and	O
so	O
in	O
particular	O
p3tc	O
=	O
0.	O
that	O
is	O
c	O
lies	O
on	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
.	O
axis	O
planes	O
.	O
consider	O
the	O
set	O
of	B
points	I
x	O
on	O
the	O
plane	B
p1	O
.	O
this	O
set	O
satisﬁes	O
p1tx	O
=	O
0	O
,	O
and	O
so	O
is	O
imaged	O
at	O
px	O
=	O
(	O
0	O
,	O
y	O
,	O
w	O
)	O
t	O
which	O
are	O
points	O
on	O
the	O
image	O
y-axis	O
.	O
again	O
it	O
follows	O
from	O
pc	O
=	O
0	O
that	O
p1tc	O
=	O
0	O
and	O
so	O
c	O
lies	O
also	O
on	O
the	O
plane	B
p1	O
.	O
consequently	O
the	O
plane	B
p1	O
is	O
deﬁned	O
by	O
the	O
camera	B
centre	I
and	O
the	O
line	B
x	O
=	O
0	O
in	O
the	O
image	O
.	O
similarly	O
the	O
plane	B
p2	O
is	O
deﬁned	O
by	O
the	O
camera	B
centre	I
and	O
the	O
line	B
y	O
=	O
0.	O
unlike	O
the	O
principal	B
plane	I
p3	O
,	O
the	O
axis	O
planes	O
p1	O
and	O
p2	O
are	O
dependent	O
on	O
the	O
image	O
x-	O
and	O
y-axes	O
,	O
i.e	O
.	O
on	O
the	O
choice	B
of	O
the	O
image	O
coordinate	O
system	O
.	O
thus	O
they	O
are	O
less	O
tightly	O
coupled	O
to	O
the	O
natural	O
camera	B
geometry	O
than	O
the	O
principal	B
plane	I
.	O
in	O
particular	O
the	O
line	B
of	O
intersection	B
of	O
the	O
planes	O
p1	O
and	O
p2	O
is	O
a	O
line	B
joining	O
the	O
camera	B
centre	I
and	O
image	O
origin	O
,	O
i.e	O
.	O
the	O
back-projection	B
of	O
the	O
image	O
origin	O
.	O
this	O
line	B
will	O
not	O
coincide	O
in	O
general	O
with	O
the	O
camera	B
principal	O
axis	O
.	O
the	O
planes	O
arising	O
from	O
pi	O
are	O
illustrated	O
in	O
ﬁgure	O
6.5.	O
the	O
camera	B
centre	I
c	O
lies	O
on	O
all	O
three	O
planes	O
,	O
and	O
since	O
these	O
planes	O
are	O
distinct	O
(	O
as	O
the	O
p	O
matrix	B
has	O
rank	O
3	O
)	O
it	O
must	O
lie	O
on	O
their	O
intersection	B
.	O
algebraically	O
,	O
the	O
condition	O
for	O
the	O
centre	B
to	O
lie	O
on	O
all	O
three	O
planes	O
is	O
pc	O
=	O
0	O
which	O
is	O
the	O
original	O
equation	O
for	O
the	O
camera	B
centre	I
given	O
above	O
.	O
the	O
principal	B
point	I
.	O
the	O
principal	O
axis	O
is	O
the	O
line	B
passing	O
through	O
the	O
camera	B
centre	I
c	O
,	O
with	O
direction	O
perpendicular	O
to	O
the	O
principal	B
plane	I
p3	O
.	O
the	O
axis	O
intersects	O
the	O
image	B
plane	I
at	O
the	O
principal	B
point	I
.	O
we	O
may	O
determine	O
this	O
point	B
as	O
follows	O
.	O
in	O
general	O
,	O
the	O
normal	O
to	O
a	O
plane	B
π	O
=	O
(	O
π1	O
,	O
π2	O
,	O
π3	O
,	O
π4	O
)	O
t	O
is	O
the	O
vector	O
(	O
π1	O
,	O
π2	O
,	O
π3	O
)	O
t.	O
this	O
may	O
alterna-	O
tively	O
be	O
represented	O
by	O
a	O
point	B
(	O
π1	O
,	O
π2	O
,	O
π3	O
,	O
0	O
)	O
t	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
in	O
the	O
case	O
of	O
the	O
principal	O
plane	B
p3	O
of	O
the	O
camera	O
,	O
this	O
point	B
is	O
(	O
p31	O
,	O
p32	O
,	O
p33	O
,	O
0	O
)	O
t	O
,	O
which	O
we	O
denote	O
(	O
cid:23	O
)	O
p3	O
.	O
projecting	O
that	O
point	B
using	O
the	O
camera	B
matrix	I
p	O
gives	O
the	O
principal	B
point	I
of	O
the	O
camera	B
p	O
(	O
cid:23	O
)	O
p3	O
.	O
note	O
that	O
only	O
the	O
left	O
hand	O
3	O
×	O
3	O
part	O
of	O
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
is	O
involved	O
in	O
this	O
6.2	O
the	O
projective	B
camera	I
161	O
formula	O
.	O
in	O
fact	O
the	O
principal	B
point	I
is	O
computed	O
as	O
x0	O
=	O
mm3	O
where	O
m3t	O
is	O
the	O
third	O
row	O
of	O
m.	O
the	O
principal	B
axis	I
vector	I
.	O
although	O
any	O
point	B
x	O
not	O
on	O
the	O
principal	B
plane	I
may	O
be	O
mapped	O
to	O
an	O
image	O
point	O
according	O
to	O
x	O
=	O
px	O
,	O
in	O
reality	O
only	O
half	O
the	O
points	O
in	O
space	O
,	O
those	O
that	O
lie	O
in	O
front	O
of	O
the	O
camera	O
,	O
may	O
be	O
seen	O
in	O
an	O
image	O
.	O
let	O
p	O
be	O
written	O
as	O
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
.	O
it	O
has	O
just	O
been	O
seen	O
that	O
the	O
vector	O
m3	O
points	O
in	O
the	O
direction	O
of	O
the	O
principal	O
axis	O
.	O
we	O
would	O
like	O
to	O
deﬁne	O
this	O
vector	O
in	O
such	O
a	O
way	O
that	O
it	O
points	O
in	O
the	O
direction	O
towards	O
the	O
front	O
of	O
the	O
camera	O
(	O
the	O
positive	O
direction	O
)	O
.	O
note	O
however	O
that	O
p	O
is	O
only	O
deﬁned	O
up	O
to	O
sign	O
.	O
this	O
leaves	O
an	O
ambiguity	B
as	O
to	O
whether	O
m3	O
or	O
−m3	O
points	O
in	O
the	O
positive	O
direction	O
.	O
we	O
now	O
proceed	O
to	O
resolve	O
this	O
ambiguity	B
.	O
we	O
start	O
by	O
considering	O
coordinates	B
with	O
respect	O
to	O
the	O
camera	B
coordinate	O
frame	O
.	O
according	O
to	O
(	O
6.5	O
)	O
,	O
the	O
equation	O
for	O
projection	O
of	O
a	O
3d	O
point	B
to	O
a	O
point	B
in	O
the	O
image	O
is	O
given	O
by	O
x	O
=	O
pcamxcam	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
xcam	O
,	O
where	O
xcam	O
is	O
the	O
3d	O
point	B
expressed	O
in	O
camera	O
coordinates	B
.	O
in	O
this	O
case	O
observe	O
that	O
the	O
vector	O
v	O
=	O
det	O
(	O
m	O
)	O
m3	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
points	O
towards	O
the	O
front	O
of	O
the	O
camera	O
in	O
the	O
direction	O
of	O
the	O
principal	O
axis	O
,	O
irrespective	O
of	O
the	O
scaling	O
of	O
pcam	O
.	O
for	O
example	O
,	O
if	O
pcam	O
→	O
kpcam	O
then	O
v	O
→	O
k4v	O
which	O
has	O
the	O
if	O
the	O
3d	O
point	B
is	O
expressed	O
in	O
world	O
coordinates	B
then	O
p	O
=	O
kk	O
[	O
r	O
|	O
−r	O
(	O
cid:22	O
)	O
c	O
]	O
=	O
[	O
m	O
|	O
p4	O
]	O
,	O
same	O
direction	O
.	O
where	O
m	O
=	O
kkr	O
.	O
since	O
det	O
(	O
r	O
)	O
>	O
0	O
the	O
vector	O
v	O
=	O
det	O
(	O
m	O
)	O
m3	O
is	O
again	O
unaffected	O
by	O
scaling	B
.	O
in	O
summary	O
,	O
•	O
v	O
=	O
det	O
(	O
m	O
)	O
m3	O
is	O
a	O
vector	O
in	O
the	O
direction	O
of	O
the	O
principal	O
axis	O
,	O
directed	O
towards	O
the	O
front	O
of	O
the	O
camera	O
.	O
6.2.2	O
action	O
of	O
a	O
projective	B
camera	I
on	O
points	O
forward	O
projection	B
.	O
as	O
we	O
have	O
already	O
seen	O
,	O
a	O
general	B
projective	I
camera	O
maps	O
a	O
point	B
in	O
space	O
x	O
to	O
an	O
image	O
point	O
according	O
to	O
the	O
mapping	O
x	O
=	O
px	O
.	O
points	O
d	O
=	O
(	O
dt	O
,	O
0	O
)	O
t	O
on	O
the	O
plane	O
at	O
inﬁnity	O
represent	O
vanishing	B
points	I
.	O
such	O
points	O
map	O
to	O
and	O
thus	O
are	O
only	O
affected	O
by	O
m	O
,	O
the	O
ﬁrst	O
3	O
×	O
3	O
submatrix	O
of	O
p.	O
x	O
=	O
pd	O
=	O
[	O
m	O
|	O
p4	O
]	O
d	O
=	O
md	O
back-projection	B
of	O
points	O
to	O
rays	O
.	O
given	O
a	O
point	B
x	O
in	O
an	O
image	O
,	O
we	O
next	O
determine	O
the	O
set	O
of	B
points	I
in	O
space	O
that	O
map	O
to	O
this	O
point	B
.	O
this	O
set	O
will	O
constitute	O
a	O
ray	O
in	O
space	O
passing	O
through	O
the	O
camera	B
centre	I
.	O
the	O
form	B
of	I
the	O
ray	O
may	O
be	O
speciﬁed	O
in	O
several	O
ways	O
,	O
depending	O
on	O
how	O
one	O
wishes	O
to	O
represent	O
a	O
line	B
in	O
3-space	O
.	O
a	O
pl¨ucker	O
represen-	O
tation	O
is	O
postponed	O
until	O
section	O
8.1.2	O
(	O
p196	O
)	O
.	O
here	O
the	O
line	B
is	O
represented	O
as	O
the	O
join	O
of	O
two	O
points	O
.	O
we	O
know	O
two	O
points	O
on	O
the	O
ray	O
.	O
these	O
are	O
the	O
camera	B
centre	I
c	O
(	O
where	O
pc	O
=	O
0	O
)	O
and	O
the	O
point	B
p+x	O
,	O
where	O
p+	O
is	O
the	O
pseudo-inverse	B
of	O
p.	O
the	O
pseudo-inverse	B
of	O
p	O
is	O
the	O
−1	O
,	O
for	O
which	O
pp+	O
=	O
i	O
(	O
see	O
section	O
a5.2	O
(	O
p590	O
)	O
)	O
.	O
point	B
p+x	O
lies	O
matrix	B
p+	O
=	O
pt	O
(	O
ppt	O
)	O
162	O
6	O
camera	B
models	O
x	O
c	O
m	O
3	O
x	O
.	O
m	O
3	O
fig	O
.	O
6.6.	O
if	O
the	O
camera	B
matrix	I
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
is	O
normalized	O
so	O
that	O
(	O
cid:10	O
)	O
m3	O
(	O
cid:10	O
)	O
=	O
1	O
and	O
det	O
m	O
>	O
0	O
,	O
and	O
x	O
=	O
w	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
=	O
px	O
,	O
where	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
,	O
then	O
w	O
is	O
the	O
depth	O
of	O
the	O
point	B
x	O
from	O
the	O
camera	B
centre	I
in	O
the	O
direction	O
of	O
the	O
principal	O
ray	O
of	O
the	O
camera	O
.	O
on	O
the	O
ray	O
because	O
it	O
projects	O
to	O
x	O
,	O
since	O
p	O
(	O
p+x	O
)	O
=i	O
x	O
=	O
x.	O
then	O
the	O
ray	O
is	O
the	O
line	B
formed	O
by	O
the	O
join	O
of	O
these	O
two	O
points	O
x	O
(	O
λ	O
)	O
=p	O
+x	O
+	O
λc	O
.	O
(	O
6.13	O
)	O
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
,	O
the	O
camera	B
centre	I
is	O
given	O
by	O
(	O
cid:22	O
)	O
c	O
=	O
−m−1p4	O
.	O
an	O
image	O
point	O
x	O
back-	O
in	O
the	O
case	O
of	O
ﬁnite	O
cameras	B
an	O
alternative	O
expression	O
can	O
be	O
developed	O
.	O
writing	O
projects	O
to	O
a	O
ray	O
intersecting	O
the	O
plane	O
at	O
inﬁnity	O
at	O
the	O
point	B
d	O
=	O
(	O
(	O
m−1x	O
)	O
t	O
,	O
0	O
)	O
t	O
,	O
and	O
d	O
provides	O
a	O
second	O
point	B
on	O
the	O
ray	O
.	O
again	O
writing	O
the	O
line	B
as	O
the	O
join	O
of	O
two	O
points	O
on	O
the	O
ray	O
,	O
(	O
cid:20	O
)	O
m−1x	O
0	O
(	O
cid:21	O
)	O
+	O
(	O
cid:20	O
)	O
−m−1p4	O
(	O
cid:21	O
)	O
=	O
1	O
(	O
cid:20	O
)	O
x	O
(	O
µ	O
)	O
=µ	O
(	O
cid:21	O
)	O
m−1	O
(	O
µx	O
−	O
p4	O
)	O
1	O
.	O
(	O
6.14	O
)	O
6.2.3	O
depth	B
of	I
points	I
next	O
,	O
we	O
consider	O
the	O
distance	B
a	O
point	B
lies	O
in	O
front	O
of	O
or	O
behind	O
the	O
principal	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
=	O
(	O
(	O
cid:22	O
)	O
xt	O
plane	B
of	O
the	O
camera	B
.	O
consider	O
a	O
camera	B
matrix	I
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
,	O
projecting	O
a	O
point	B
c	O
=	O
(	O
(	O
cid:22	O
)	O
c	O
,	O
1	O
)	O
t	O
be	O
the	O
camera	B
centre	I
.	O
then	O
w	O
=	O
p3tx	O
=	O
p3t	O
(	O
x	O
−	O
c	O
)	O
since	O
pc	O
=	O
0	O
for	O
,	O
1	O
)	O
t	O
in	O
3-space	O
to	O
the	O
image	O
point	O
x	O
=	O
w	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
=	O
px	O
.	O
let	O
the	O
camera	B
centre	I
c.	O
however	O
,	O
p3t	O
(	O
x	O
−	O
c	O
)	O
=	O
m3t	O
(	O
(	O
cid:22	O
)	O
x	O
−	O
(	O
cid:22	O
)	O
c	O
)	O
where	O
m3	O
is	O
the	O
principal	O
ray	O
direction	O
,	O
so	O
w	O
=	O
m3t	O
(	O
(	O
cid:22	O
)	O
x−	O
(	O
cid:22	O
)	O
c	O
)	O
can	O
be	O
interpreted	O
as	O
the	O
dot	O
product	O
of	O
the	O
ray	O
from	O
the	O
camera	B
centre	I
to	O
the	O
point	B
x	O
,	O
with	O
the	O
principal	O
ray	O
direction	O
.	O
if	O
the	O
camera	B
matrix	I
is	O
normalized	O
so	O
that	O
det	O
m	O
>	O
0	O
and	O
(	O
cid:10	O
)	O
m3	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
then	O
m3	O
is	O
a	O
unit	O
vector	O
pointing	O
in	O
the	O
positive	O
axial	O
direction	O
.	O
then	O
w	O
may	O
be	O
interpreted	O
as	O
the	O
depth	O
of	O
the	O
point	B
x	O
from	O
the	O
camera	B
centre	I
c	O
in	O
the	O
direction	O
of	O
the	O
principal	O
ray	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
6.6.	O
any	O
camera	B
matrix	I
may	O
be	O
normalized	O
by	O
multiplying	O
it	O
by	O
an	O
appropriate	O
factor	O
.	O
however	O
,	O
to	O
avoid	O
having	O
always	O
to	O
deal	O
with	O
normalized	O
camera	B
matrices	I
,	O
the	O
depth	O
of	O
a	O
point	B
may	O
be	O
computed	O
as	O
follows	O
:	O
result	O
6.1.	O
let	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
be	O
a	O
3d	O
point	O
and	O
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
be	O
a	O
camera	B
matrix	I
for	O
a	O
ﬁnite	B
camera	O
.	O
suppose	O
p	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
=	O
w	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t.	O
then	O
depth	O
(	O
x	O
;	O
p	O
)	O
=	O
sign	O
(	O
det	O
m	O
)	O
w	O
t	O
(	O
cid:10	O
)	O
m3	O
(	O
cid:10	O
)	O
(	O
6.15	O
)	O
6.2	O
the	O
projective	B
camera	I
163	O
is	O
the	O
depth	O
of	O
the	O
point	B
x	O
in	O
front	O
of	O
the	O
principal	O
plane	B
of	O
the	O
camera	B
.	O
this	O
formula	O
is	O
an	O
effective	O
way	O
to	O
determine	O
if	O
a	O
point	B
x	O
is	O
in	O
front	O
of	O
the	O
camera	O
.	O
one	O
veriﬁes	O
that	O
the	O
value	O
of	O
depth	O
(	O
x	O
;	O
p	O
)	O
is	O
unchanged	O
if	O
either	O
the	O
point	B
x	O
or	O
the	O
camera	B
matrix	I
p	O
is	O
multiplied	O
by	O
a	O
constant	O
factor	O
k.	O
thus	O
,	O
depth	O
(	O
x	O
;	O
p	O
)	O
is	O
independent	O
of	O
the	O
particular	O
homogeneous	B
representation	I
of	O
x	O
and	O
p.	O
6.2.4	O
decomposition	B
of	I
the	O
camera	B
matrix	I
let	O
p	O
be	O
a	O
camera	B
matrix	I
representing	O
a	O
general	B
projective	I
camera	O
.	O
we	O
wish	O
to	O
ﬁnd	O
the	O
camera	B
centre	I
,	O
the	O
orientation	B
of	O
the	O
camera	B
and	O
the	O
internal	B
parameters	I
of	O
the	O
camera	B
from	O
p.	O
finding	O
the	O
camera	B
centre	I
.	O
the	O
camera	B
centre	I
c	O
is	O
the	O
point	B
for	O
which	O
pc	O
=	O
0.	O
numerically	O
this	O
right	O
null-vector	O
may	O
be	O
obtained	O
from	O
the	O
svd	O
of	O
p	O
,	O
see	O
section	O
a4.4	O
(	O
p585	O
)	O
.	O
algebraically	O
,	O
the	O
centre	B
c	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
may	O
be	O
obtained	O
as	O
(	O
see	O
(	O
3.5–	O
p67	O
)	O
)	O
x	O
=	O
det	O
(	O
[	O
p2	O
,	O
p3	O
,	O
p4	O
]	O
)	O
y	O
=	O
−	O
det	O
(	O
[	O
p1	O
,	O
p3	O
,	O
p4	O
]	O
)	O
z	O
=	O
det	O
(	O
[	O
p1	O
,	O
p2	O
,	O
p4	O
]	O
)	O
t	O
=	O
−	O
det	O
(	O
[	O
p1	O
,	O
p2	O
,	O
p3	O
]	O
)	O
.	O
finding	O
the	O
camera	B
orientation	I
and	O
internal	B
parameters	I
.	O
in	O
the	O
case	O
of	O
a	O
ﬁnite	O
camera	B
,	O
according	O
to	O
(	O
6.11	O
)	O
,	O
p	O
=	O
[	O
m	O
|	O
−m	O
(	O
cid:22	O
)	O
c	O
]	O
=	O
k	O
[	O
r	O
|	O
−r	O
(	O
cid:22	O
)	O
c	O
]	O
.	O
we	O
may	O
easily	O
ﬁnd	O
both	O
k	O
and	O
r	O
by	O
decomposing	O
m	O
as	O
m	O
=	O
kr	O
using	O
the	O
rq-	O
decomposition	B
.	O
this	O
decomposition	B
into	O
the	O
product	O
of	O
an	O
upper-triangular	O
and	O
orthog-	O
onal	O
matrix	B
is	O
described	O
in	O
section	O
a4.1.1	O
(	O
p579	O
)	O
.	O
the	O
matrix	B
r	O
gives	O
the	O
orientation	B
of	O
the	O
camera	B
,	O
whereas	O
k	O
is	O
the	O
calibration	B
matrix	I
.	O
the	O
ambiguity	B
in	O
the	O
decomposition	B
is	O
removed	O
by	O
requiring	O
that	O
k	O
have	O
positive	O
diagonal	O
entries	O
.	O
the	O
matrix	B
k	O
has	O
the	O
form	O
(	O
6.10	O
)	O
k	O
=	O
	O
αx	O
s	O
x0	O
0	O
αy	O
y0	O
0	O
1	O
0	O
	O
where	O
•	O
αx	O
is	O
the	O
scale	O
factor	O
in	O
the	O
x-coordinate	O
direction	O
,	O
•	O
αy	O
is	O
the	O
scale	O
factor	O
in	O
the	O
y-coordinate	O
direction	O
,	O
•	O
s	O
is	O
the	O
skew	O
,	O
•	O
(	O
x0	O
,	O
y0	O
)	O
t	O
are	O
the	O
coordinates	B
of	O
the	O
principal	B
point	I
.	O
the	O
aspect	O
ratio	O
is	O
αy/αx	O
.	O
example	O
6.2.	O
the	O
camera	B
matrix	I
	O
p	O
=	O
3.39645	O
e+2	O
2.77744	O
e+2	O
−1.44946	O
e+6	O
3.53553	O
e+2	O
−1.03528	O
e+2	O
2.33212	O
e+1	O
4.59607	O
e+2	O
−6.32525	O
e+5	O
7.07107	O
e−1	O
−3.53553	O
e−1	O
6.12372	O
e−1	O
−9.18559	O
e+2	O
	O
164	O
6	O
camera	B
models	O
with	O
p	O
=	O
[	O
m	O
|	O
−m	O
(	O
cid:22	O
)	O
c	O
]	O
,	O
has	O
centre	B
(	O
cid:22	O
)	O
c	O
=	O
(	O
1000.0	O
,	O
2000.0	O
,	O
1500.0	O
)	O
t	O
,	O
and	O
the	O
matrix	B
m	O
	O
.	O
	O
468.2	O
decomposes	O
as	O
	O
	O
m	O
=	O
kr	O
=	O
91.2	O
300.0	O
427.2	O
200.0	O
1.0	O
0.41380	O
0.90915	O
0.04708	O
−0.57338	O
0.22011	O
0.78917	O
0.70711	O
−0.35355	O
0.61237	O
(	O
cid:2	O
)	O
when	O
is	O
s	O
(	O
cid:5	O
)	O
=	O
0	O
?	O
as	O
was	O
shown	O
in	O
section	O
6.1	O
a	O
true	O
ccd	O
camera	B
has	O
only	O
four	O
internal	O
camera	B
parameters	I
,	O
since	O
generally	O
s	O
=	O
0.	O
if	O
s	O
(	O
cid:5	O
)	O
=	O
0	O
then	O
this	O
can	O
be	O
interpreted	O
as	O
a	O
skewing	O
of	O
the	O
pixel	O
elements	O
in	O
the	O
ccd	O
array	O
so	O
that	O
the	O
x-	O
and	O
y-axes	O
are	O
not	O
perpendicular	O
.	O
this	O
is	O
admittedly	O
very	O
unlikely	O
to	O
happen	O
.	O
in	O
realistic	O
circumstances	O
a	O
non-zero	B
skew	I
might	O
arise	O
as	O
a	O
result	O
of	O
taking	O
an	O
image	O
of	O
an	O
image	O
,	O
for	O
example	O
if	O
a	O
photograph	O
is	O
re-photographed	O
,	O
or	O
a	O
negative	O
is	O
enlarged	O
.	O
consider	O
enlarging	O
an	O
image	O
taken	O
by	O
a	O
pinhole	O
camera	O
(	O
such	O
as	O
an	O
ordinary	O
ﬁlm	O
cam-	O
era	O
)	O
where	O
the	O
axis	O
of	O
the	O
magnifying	O
lens	O
is	O
not	O
perpendicular	O
to	O
the	O
ﬁlm	O
plane	B
or	O
the	O
enlarged	O
image	B
plane	I
.	O
the	O
most	O
severe	O
distortion	B
that	O
can	O
arise	O
from	O
this	O
“	O
picture	B
of	O
a	O
picture	B
”	O
process	O
is	O
a	O
planar	O
homography	O
.	O
suppose	O
the	O
original	O
(	O
ﬁnite	B
)	O
camera	B
is	O
represented	O
by	O
the	O
matrix	B
p	O
,	O
then	O
the	O
camera	B
representing	O
the	O
picture	B
of	O
a	O
picture	B
is	O
hp	O
,	O
where	O
h	O
is	O
the	O
homography	B
matrix	O
.	O
since	O
h	O
is	O
non-singular	O
,	O
the	O
left	O
3	O
×	O
3	O
submatrix	O
of	O
hp	O
is	O
non-singular	O
and	O
can	O
be	O
decomposed	O
as	O
the	O
product	O
kr	O
–	O
and	O
k	O
need	O
not	O
have	O
s	O
=	O
0.	O
note	O
however	O
that	O
the	O
k	O
and	O
r	O
are	O
no	O
longer	O
the	O
calibration	B
matrix	I
and	O
orientation	B
of	O
the	O
original	O
camera	B
.	O
on	O
the	O
other	O
hand	O
,	O
one	O
veriﬁes	O
that	O
the	O
process	O
of	O
taking	O
a	O
picture	B
of	O
a	O
picture	B
does	O
not	O
change	O
the	O
apparent	B
camera	O
centre	B
.	O
indeed	O
,	O
since	O
h	O
is	O
non-singular	O
,	O
hpc	O
=	O
0	O
if	O
and	O
only	O
if	O
pc	O
=	O
0.	O
where	O
is	O
the	O
decomposition	B
required	O
?	O
if	O
the	O
camera	B
p	O
is	O
constructed	O
from	O
(	O
6.11	O
)	O
then	O
the	O
parameters	B
are	O
known	O
and	O
a	O
decomposition	B
is	O
clearly	O
unnecessary	O
.	O
so	O
the	O
question	O
arises	O
–	O
where	O
would	O
one	O
obtain	O
a	O
camera	B
for	O
which	O
the	O
decomposition	B
is	O
not	O
known	O
?	O
in	O
fact	O
cameras	B
will	O
be	O
computed	O
in	O
myriad	O
ways	O
throughout	O
this	O
book	O
and	O
decomposing	O
an	O
unknown	O
camera	B
is	O
a	O
frequently	O
used	O
tool	O
in	O
practice	O
.	O
for	O
example	O
cameras	B
can	O
be	O
computed	O
directly	O
by	O
calibration	B
–	O
where	O
the	O
camera	B
is	O
computed	O
from	O
a	O
set	O
of	O
world	O
to	O
image	O
correspondences	B
(	O
chapter	O
7	O
)	O
–	O
and	O
indirectly	O
by	O
computing	O
a	O
multiple	O
view	O
relation	B
(	O
such	O
as	O
the	O
fundamental	B
matrix	I
or	O
trifocal	B
tensor	I
)	O
and	O
subse-	O
quently	O
computing	B
projection	O
matrices	O
from	O
this	O
relation	B
.	O
a	O
note	O
on	O
coordinate	O
orientation	B
.	O
in	O
the	O
derivation	B
of	O
the	O
camera	B
model	O
and	O
its	O
parametrization	B
(	O
6.10	O
)	O
it	O
is	O
assumed	O
that	O
the	O
coordinate	O
systems	O
used	O
in	O
both	O
the	O
image	O
and	O
the	O
3d	O
world	O
are	O
right	O
handed	O
systems	O
,	O
as	O
shown	O
in	O
ﬁgure	O
6.1	O
(	O
p154	O
)	O
.	O
however	O
,	O
a	O
common	O
practice	O
in	O
measuring	O
image	O
coordinates	O
is	O
that	O
the	O
y-coordinate	O
increases	O
in	O
the	O
downwards	O
direction	O
,	O
thus	O
deﬁning	O
a	O
left	O
handed	O
coordinate	O
system	O
,	O
contrary	O
to	O
ﬁgure	O
6.1	O
(	O
p154	O
)	O
.	O
a	O
recommended	O
practice	O
in	O
this	O
case	O
is	O
to	O
negate	O
the	O
y-coordinate	O
of	O
the	O
image	O
point	B
so	O
that	O
the	O
coordinate	O
system	O
again	O
becomes	O
right	O
handed	O
.	O
however	O
,	O
if	O
6.2	O
the	O
projective	B
camera	I
165	O
the	O
image	O
coordinate	O
system	O
is	O
left	O
handed	O
,	O
then	O
the	O
consequences	O
are	O
not	O
grave	O
.	O
the	O
relationship	O
between	O
world	O
and	O
image	O
coordinates	O
is	O
still	O
expressed	O
by	O
a	O
3	O
×	O
4	O
camera	B
matrix	I
.	O
decomposition	B
of	I
this	O
camera	B
matrix	I
according	O
to	O
(	O
6.11	O
)	O
with	O
k	O
of	O
the	O
form	O
(	O
6.10	O
)	O
is	O
still	O
possible	O
with	O
αx	O
and	O
αy	O
positive	O
.	O
the	O
difference	O
is	O
that	O
r	O
now	O
represents	O
the	O
orientation	B
of	O
the	O
camera	B
with	O
respect	O
to	O
the	O
negative	O
z-axis	O
.	O
in	O
addition	O
,	O
the	O
depth	B
of	I
points	I
given	O
by	O
(	O
6.15	O
)	O
will	O
be	O
negative	O
instead	O
of	O
positive	O
for	O
points	O
in	O
front	O
of	O
the	O
camera	O
.	O
if	O
this	O
is	O
borne	O
in	O
mind	O
then	O
it	O
is	O
permissible	O
to	O
use	O
left	O
handed	O
coordinates	B
in	O
the	O
image	O
.	O
6.2.5	O
euclidean	O
vs	O
projective	B
spaces	O
the	O
development	O
of	O
the	O
sections	O
to	O
this	O
point	B
has	O
implicitly	O
assumed	O
that	O
the	O
world	O
and	O
image	O
coordinate	O
systems	O
are	O
euclidean	O
.	O
ideas	O
have	O
been	O
borrowed	O
from	O
projec-	O
tive	O
geometry	O
(	O
such	O
as	O
directions	O
corresponding	O
to	O
points	O
on	O
π∞	O
)	O
and	O
the	O
convenient	O
notation	O
of	O
homogeneous	O
coordinates	O
has	O
allowed	O
central	B
projection	I
to	O
be	O
represented	O
linearly	O
.	O
in	O
subsequent	O
chapters	O
of	O
the	O
book	O
we	O
will	O
go	O
further	O
and	O
use	O
a	O
projective	B
coordinate	O
frame	O
.	O
this	O
is	O
easily	O
achieved	O
,	O
for	O
suppose	O
the	O
world	O
coordinate	O
frame	O
is	O
projective	B
;	O
then	O
the	O
transformation	B
between	O
the	O
camera	B
and	O
world	O
coordinate	O
frame	O
(	O
6.6	O
)	O
is	O
again	O
represented	O
by	O
a	O
4	O
×	O
4	O
homogeneous	O
matrix	O
,	O
xcam	O
=	O
hx	O
,	O
and	O
the	O
resulting	O
map	O
from	O
projective	O
3-space	O
ip3	O
to	O
the	O
image	O
is	O
still	O
represented	O
by	O
a	O
3	O
×	O
4	O
matrix	B
p	O
with	O
rank	O
3.	O
in	O
fact	O
,	O
at	O
its	O
most	O
general	O
the	O
projective	B
camera	I
is	O
a	O
map	O
from	O
ip3	O
to	O
ip2	O
,	O
and	O
covers	O
the	O
composed	O
effects	O
of	O
a	O
projective	O
transformation	B
of	O
3-space	O
,	O
a	O
projection	B
from	O
3-	O
space	O
to	O
an	O
image	O
,	O
and	O
a	O
projective	B
transformation	I
of	O
the	O
image	O
.	O
this	O
follows	O
simply	O
by	O
concatenating	O
the	O
matrices	O
representing	O
these	O
mappings	O
:	O
	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
	O
[	O
4	O
×	O
4	O
homography	B
]	O
p	O
=	O
[	O
3	O
×	O
3	O
homography	B
]	O
which	O
results	O
in	O
a	O
3	O
×	O
4	O
matrix	B
.	O
however	O
,	O
it	O
is	O
important	O
to	O
remember	O
that	O
cameras	B
are	O
euclidean	O
devices	O
and	O
simply	O
because	O
we	O
have	O
a	O
projective	B
model	O
of	O
a	O
camera	O
it	O
does	O
not	O
mean	O
that	O
we	O
should	O
eschew	O
notions	O
of	O
euclidean	O
geometry	O
.	O
euclidean	O
and	O
afﬁne	B
interpretations	O
.	O
although	O
a	O
(	O
ﬁnite	B
)	O
3×	O
4	O
matrix	B
can	O
always	O
be	O
decomposed	O
as	O
in	O
section	O
6.2.4	O
to	O
obtain	O
a	O
rotation	B
matrix	O
,	O
a	O
calibration	B
matrix	I
k	O
,	O
and	O
so	O
forth	O
,	O
euclidean	O
interpretations	O
of	O
the	O
parameters	O
so	O
obtained	O
are	O
only	O
meaningful	O
if	O
the	O
image	O
and	O
space	O
coordinates	O
are	O
in	O
an	O
appropriate	O
frame	O
.	O
in	O
the	O
decomposition	B
case	O
a	O
euclidean	O
frame	O
is	O
required	O
for	O
both	O
image	O
and	O
3-space	O
.	O
on	O
the	O
other	O
hand	O
,	O
the	O
in-	O
terpretation	O
of	O
the	O
null-vector	O
of	O
p	O
as	O
the	O
camera	B
centre	I
is	O
valid	O
even	O
if	O
both	O
frames	O
are	O
projective	B
–	O
the	O
interpretation	O
requires	O
only	O
collinearity	O
,	O
which	O
is	O
a	O
projective	B
notion	O
.	O
the	O
interpretation	O
of	O
p3	O
as	O
the	O
principal	B
plane	I
requires	O
at	O
least	O
afﬁne	B
frames	O
for	O
the	O
im-	O
age	O
and	O
3-space	O
.	O
finally	O
,	O
the	O
interpretation	O
of	O
m3	O
as	O
the	O
principal	O
ray	O
requires	O
an	O
afﬁne	B
image	O
frame	O
but	O
a	O
euclidean	O
world	O
frame	O
in	O
order	O
for	O
the	O
concept	O
of	O
orthogonality	O
(	O
to	O
the	O
principal	B
plane	I
)	O
to	O
be	O
meaningful	O
.	O
166	O
6	O
camera	B
models	O
perspective	O
weak	B
perspective	I
increasing	O
focal	B
length	I
increasing	O
distance	B
from	O
camera	B
fig	O
.	O
6.7.	O
as	O
the	O
focal	B
length	I
increases	O
and	O
the	O
distance	B
between	O
the	O
camera	B
and	O
object	O
also	O
increases	O
,	O
the	O
image	O
remains	O
the	O
same	O
size	O
but	O
perspective	O
effects	O
diminish	O
.	O
6.3	O
cameras	B
at	O
inﬁnity	O
we	O
now	O
turn	O
to	O
consider	O
cameras	B
with	O
centre	B
lying	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
this	O
means	O
that	O
the	O
left	O
hand	O
3	O
×	O
3	O
block	O
of	O
the	O
camera	O
matrix	B
p	O
is	O
singular	O
.	O
the	O
camera	B
centre	I
may	O
be	O
found	O
from	O
pc	O
=	O
0	O
just	O
as	O
with	O
ﬁnite	B
cameras	O
.	O
cameras	B
at	O
inﬁnity	O
may	O
be	O
broadly	O
classiﬁed	O
into	O
two	O
different	O
types	O
,	O
afﬁne	B
cameras	I
and	O
non-afﬁne	O
cameras	B
.	O
we	O
consider	O
ﬁrst	O
of	O
all	O
the	O
afﬁne	B
class	O
of	O
cameras	O
which	O
are	O
the	O
most	O
important	O
in	O
practice	O
.	O
deﬁnition	B
6.3.	O
an	O
afﬁne	B
camera	I
is	O
one	O
that	O
has	O
a	O
camera	B
matrix	I
p	O
in	O
which	O
the	O
last	O
row	O
p3t	O
is	O
of	O
the	O
form	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
it	O
is	O
called	O
an	O
afﬁne	B
camera	I
because	O
points	O
at	O
inﬁnity	O
are	O
mapped	O
to	O
points	O
at	B
inﬁnity	I
.	O
6.3.1	O
afﬁne	B
cameras	I
consider	O
what	O
happens	O
as	O
we	O
apply	O
a	O
cinematographic	O
technique	O
of	O
tracking	O
back	O
while	O
zooming	O
in	O
,	O
in	O
such	O
a	O
way	O
as	O
to	O
keep	O
objects	O
of	O
interest	O
the	O
same	O
size1	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
6.7.	O
we	O
are	O
going	O
to	O
model	O
this	O
process	O
by	O
taking	O
the	O
limit	O
as	O
both	O
the	O
focal	B
length	I
and	O
principal	O
axis	O
distance	O
of	O
the	O
camera	O
from	O
the	O
object	O
increase	O
.	O
in	O
analyzing	O
this	O
technique	O
,	O
we	O
start	O
with	O
a	O
ﬁnite	B
projective	I
camera	O
(	O
6.11	O
)	O
.	O
the	O
1	O
see	O
‘	O
vertigo	O
’	O
(	O
dir	O
.	O
hitchcock	O
,	O
1958	O
)	O
and	O
‘	O
mishima	O
’	O
(	O
dir	O
.	O
schrader	O
,	O
1985	O
)	O
.	O
camera	B
matrix	I
may	O
be	O
written	O
as	O
6.3	O
cameras	B
at	O
inﬁnity	O
p0	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
=	O
k	O
	O
r1t	O
−r1t	O
(	O
cid:22	O
)	O
c	O
r2t	O
−r2t	O
(	O
cid:22	O
)	O
c	O
r3t	O
−r3t	O
(	O
cid:22	O
)	O
c	O
	O
167	O
(	O
6.16	O
)	O
has	O
orientation	B
denoted	O
by	O
matrix	B
r	O
and	O
internal	B
parameters	I
matrix	O
k	O
of	O
the	O
form	O
given	O
in	O
(	O
6.10–p157	O
)	O
.	O
from	O
section	O
6.2.1	O
the	O
principal	O
ray	O
of	O
the	O
camera	O
is	O
in	O
the	O
direction	O
where	O
rit	O
is	O
the	O
i-th	O
row	O
of	O
the	O
rotation	B
matrix	O
.	O
this	O
camera	B
is	O
located	O
at	O
position	O
(	O
cid:22	O
)	O
c	O
and	O
of	O
the	O
vector	O
r3	O
,	O
and	O
the	O
value	O
d0	O
=	O
−r3t	O
(	O
cid:22	O
)	O
c	O
is	O
the	O
distance	B
of	O
the	O
world	O
origin	O
from	O
the	O
(	O
cid:22	O
)	O
c	O
−	O
tr3	O
.	O
replacing	O
(	O
cid:22	O
)	O
c	O
in	O
(	O
6.16	O
)	O
by	O
(	O
cid:22	O
)	O
c	O
−	O
tr3	O
gives	O
the	O
camera	B
matrix	I
at	O
time	O
t	O
:	O
	O
now	O
,	O
we	O
consider	O
what	O
happens	O
if	O
the	O
camera	B
centre	I
is	O
moved	O
backwards	O
along	O
the	O
principal	O
ray	O
at	O
unit	O
speed	O
for	O
a	O
time	O
t	O
,	O
so	O
that	O
the	O
centre	B
of	O
the	O
camera	B
is	O
moved	O
to	O
	O
r1t	O
−r1t	O
(	O
cid:22	O
)	O
c	O
r2t	O
−r2t	O
(	O
cid:22	O
)	O
c	O
camera	B
centre	I
in	O
the	O
direction	O
of	O
the	O
principal	O
ray	O
.	O
	O
r1t	O
−r1t	O
(	O
(	O
cid:22	O
)	O
c	O
−	O
tr3	O
)	O
r2t	O
−r2t	O
(	O
(	O
cid:22	O
)	O
c	O
−	O
tr3	O
)	O
r3t	O
−r3t	O
(	O
(	O
cid:22	O
)	O
c	O
−	O
tr3	O
)	O
	O
=	O
k	O
where	O
the	O
terms	O
ritr3	O
are	O
zero	O
for	O
i	O
=	O
1	O
,	O
2	O
because	O
r	O
is	O
a	O
rotation	B
matrix	O
.	O
the	O
scalar	O
dt	O
=	O
−r3t	O
(	O
cid:22	O
)	O
c	O
+	O
t	O
is	O
the	O
depth	O
of	O
the	O
world	O
origin	O
with	O
respect	O
to	O
the	O
camera	B
centre	I
in	O
the	O
direction	O
of	O
the	O
principal	O
ray	O
r3	O
of	O
the	O
camera	O
.	O
thus	O
•	O
the	O
effect	O
of	O
tracking	O
along	O
the	O
principal	O
ray	O
is	O
to	O
replace	O
the	O
(	O
3,4	O
)	O
entry	O
of	O
the	O
matrix	O
by	O
the	O
depth	O
dt	O
of	O
the	O
camera	O
centre	B
from	O
the	O
world	O
origin	O
.	O
r3t	O
dt	O
pt	O
=	O
k	O
(	O
6.17	O
)	O
next	O
,	O
we	O
consider	O
zooming	O
such	O
that	O
the	O
camera	B
focal	O
length	O
is	O
increased	O
by	O
a	O
factor	O
k.	O
this	O
magniﬁes	O
the	O
image	O
by	O
a	O
factor	O
k.	O
it	O
is	O
shown	O
in	O
section	O
8.4.1	O
(	O
p203	O
)	O
that	O
the	O
effect	O
of	O
zooming	O
by	O
a	O
factor	O
k	O
is	O
to	O
multiply	O
the	O
calibration	B
matrix	I
k	O
on	O
the	O
right	O
by	O
diag	O
(	O
k	O
,	O
k	O
,	O
1	O
)	O
.	O
now	O
,	O
we	O
combine	O
the	O
effects	O
of	O
tracking	O
and	O
zooming	O
.	O
we	O
suppose	O
that	O
the	O
magni-	O
ﬁcation	O
factor	O
is	O
k	O
=	O
dt/d0	O
so	O
that	O
the	O
image	O
size	O
remains	O
ﬁxed	O
.	O
the	O
resulting	O
camera	B
matrix	I
at	O
time	O
t	O
,	O
derived	O
from	O
(	O
6.17	O
)	O
,	O
is	O
	O
dt/d0	O
pt	O
=	O
k	O
dt/d0	O
	O
	O
r1t	O
−r1t	O
(	O
cid:22	O
)	O
c	O
r2t	O
−r2t	O
(	O
cid:22	O
)	O
c	O
1	O
r3t	O
−r1t	O
(	O
cid:22	O
)	O
c	O
−r2t	O
(	O
cid:22	O
)	O
c	O
	O
r1t	O
r2t	O
r3td0/dt	O
d0	O
and	O
one	O
can	O
ignore	O
the	O
factor	O
dt/d0	O
.	O
when	O
t	O
=	O
0	O
,	O
the	O
camera	B
matrix	I
pt	O
corresponds	O
with	O
(	O
6.16	O
)	O
.	O
now	O
,	O
in	O
the	O
limit	O
as	O
dt	O
tends	O
to	O
inﬁnity	O
,	O
this	O
matrix	B
becomes	O
k	O
dt	O
dt	O
d0	O
	O
=	O
	O
r1t	O
−r1t	O
(	O
cid:22	O
)	O
c	O
r2t	O
−r2t	O
(	O
cid:22	O
)	O
c	O
0t	O
d0	O
	O
	O
p∞	O
=	O
lim	O
t→∞	O
pt	O
=	O
k	O
(	O
6.18	O
)	O
which	O
is	O
just	O
the	O
original	O
camera	B
matrix	I
(	O
6.16	O
)	O
with	O
the	O
ﬁrst	O
three	O
entries	O
of	O
the	O
last	O
row	O
set	O
to	O
zero	O
.	O
from	O
deﬁnition	O
6.3	O
p∞	O
is	O
an	O
instance	O
of	O
an	O
afﬁne	B
camera	I
.	O
168	O
6	O
camera	B
models	O
6.3.2	O
error	B
in	I
employing	I
an	O
afﬁne	B
camera	I
it	O
may	O
be	O
noted	O
that	O
the	O
image	O
of	O
any	O
point	B
on	O
the	O
plane	B
through	O
the	O
world	O
origin	O
perpendicular	O
to	O
the	O
principal	O
axis	O
direction	O
r3	O
is	O
unchanged	O
by	O
this	O
combined	O
zooming	O
and	O
motion	O
.	O
indeed	O
,	O
such	O
a	O
point	B
may	O
be	O
written	O
as	O
one	O
then	O
veriﬁes	O
that	O
p0x	O
=	O
ptx	O
=	O
p∞x	O
for	O
all	O
t	O
,	O
since	O
r3t	O
(	O
αr1	O
+	O
βr2	O
)	O
=	O
0.	O
for	O
points	O
not	O
on	O
this	O
plane	B
the	O
images	O
under	O
p0	O
and	O
p∞	O
differ	O
,	O
and	O
we	O
will	O
now	O
investigate	O
the	O
extent	O
of	O
this	O
error	B
.	O
consider	O
a	O
point	B
x	O
which	O
is	O
at	O
a	O
perpendicular	O
distance	B
∆	O
from	O
this	O
plane	B
.	O
the	O
3d	O
point	B
can	O
be	O
represented	O
as	O
(	O
cid:21	O
)	O
.	O
(	O
cid:21	O
)	O
x	O
=	O
αr1	O
+	O
βr2	O
1	O
(	O
cid:20	O
)	O
x	O
=	O
αr1	O
+	O
βr2	O
+	O
∆r3	O
1	O
(	O
cid:20	O
)	O
(	O
cid:17	O
)	O
and	O
is	O
imaged	O
by	O
the	O
cameras	B
p0	O
and	O
p∞	O
at	O
	O
	O
˜x	O
where	O
˜x	O
=	O
α	O
−	O
r1t	O
(	O
cid:22	O
)	O
c	O
,	O
˜y	O
=	O
β	O
−	O
r2t	O
(	O
cid:22	O
)	O
c.	O
now	O
,	O
writing	O
the	O
calibration	B
matrix	I
as	O
	O
xafﬁne	O
=	O
p∞x	O
=	O
k	O
xproj	O
=	O
p0x	O
=	O
k	O
	O
d0	O
+	O
∆	O
˜y	O
d0	O
˜x	O
˜y	O
(	O
cid:18	O
)	O
,	O
k	O
=	O
k2×2	O
˜x0	O
˜0t	O
1	O
(	O
cid:21	O
)	O
where	O
k2×2	O
is	O
an	O
upper-triangular	O
2	O
×	O
2	O
matrix	B
,	O
gives	O
(	O
cid:20	O
)	O
xproj	O
=	O
k2×2˜x	O
+	O
(	O
d0	O
+	O
∆	O
)	O
˜x0	O
d0	O
+	O
∆	O
xafﬁne	O
=	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
k2×2˜x	O
+	O
d0˜x0	O
d0	O
the	O
image	O
point	O
for	O
p0	O
is	O
obtained	O
by	O
dehomogenizing	O
,	O
by	O
dividing	O
by	O
the	O
third	O
element	O
,	O
as	O
˜xproj	O
=	O
˜x0	O
+	O
k2×2˜x/	O
(	O
d0	O
+	O
∆	O
)	O
,	O
and	O
for	O
p∞	O
the	O
inhomogeneous	O
image	O
point	B
is	O
˜xafﬁne	O
=	O
˜x0	O
+	O
k2×2˜x/d0	O
.	O
the	O
relationship	O
between	O
the	O
two	O
points	O
is	O
therefore	O
˜xafﬁne	O
−	O
˜x0	O
=	O
d0	O
+	O
∆	O
d0	O
(	O
˜xproj	O
−	O
˜x0	O
)	O
which	O
shows	O
that	O
•	O
the	O
effect	O
of	O
the	O
afﬁne	O
approximation	O
p∞	O
to	O
the	O
true	O
camera	B
matrix	I
p0	O
is	O
to	O
move	O
the	O
image	O
of	O
a	O
point	B
x	O
radially	O
towards	O
or	O
away	O
from	O
the	O
principal	B
point	I
˜x0	O
by	O
a	O
factor	O
equal	O
to	O
(	O
d0	O
+	O
∆	O
)	O
/d0	O
=	O
1	O
+	O
∆/d0	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
6.8	O
.	O
169	O
afﬁne	B
imaging	I
conditions	I
.	O
from	O
the	O
expressions	O
for	O
˜xproj	O
and	O
˜xafﬁne	O
we	O
can	O
deduce	O
that	O
6.3	O
cameras	B
at	O
inﬁnity	O
˜xafﬁne	O
−	O
˜xproj	O
=	O
(	O
˜xproj	O
−	O
˜x0	O
)	O
∆	O
d0	O
(	O
6.19	O
)	O
which	O
shows	O
that	O
the	O
distance	B
between	O
the	O
true	O
perspective	O
image	O
position	O
and	O
the	O
position	O
obtained	O
using	O
the	O
afﬁne	B
camera	I
approximation	O
p∞	O
will	O
be	O
small	O
provided	O
:	O
(	O
i	O
)	O
the	O
depth	O
relief	O
(	O
∆	O
)	O
is	O
small	O
compared	O
to	O
the	O
average	O
depth	O
(	O
d0	O
)	O
,	O
and	O
(	O
ii	O
)	O
the	O
distance	B
of	O
the	O
point	B
from	O
the	O
principal	O
ray	O
is	O
small	O
.	O
the	O
latter	O
condition	O
is	O
satisﬁed	O
by	O
a	O
small	O
ﬁeld	O
of	O
view	O
.	O
in	O
general	O
,	O
images	O
acquired	O
using	O
a	O
lens	O
with	O
a	O
longer	O
focal	B
length	I
tend	O
to	O
satisfy	O
these	O
conditions	O
as	O
both	O
the	O
ﬁeld	O
of	O
view	O
and	O
the	O
depth	O
of	O
ﬁeld	O
are	O
smaller	O
than	O
those	O
obtained	O
by	O
a	O
short	O
focal	B
length	I
lens	O
with	O
the	O
same	O
ccd	O
array	O
.	O
for	O
scenes	O
at	O
which	O
there	O
are	O
many	O
points	O
at	O
different	O
depths	O
,	O
the	O
afﬁne	B
camera	I
is	O
not	O
a	O
good	O
approximation	O
.	O
for	O
instance	O
where	O
the	O
scene	O
contains	O
close	O
foreground	O
as	O
well	O
as	O
background	O
objects	O
,	O
an	O
afﬁne	B
camera	I
model	O
should	O
not	O
be	O
used	O
.	O
however	O
,	O
a	O
different	O
afﬁne	B
model	O
can	O
be	O
used	O
for	O
each	O
region	O
in	O
these	O
circumstances	O
.	O
6.3.3	O
decomposition	B
of	I
p∞	O
the	O
camera	B
matrix	I
(	O
6.18	O
)	O
may	O
be	O
written	O
as	O
k2×2	O
˜x0	O
ˆ0t	O
1	O
p∞	O
=	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
ˆt	O
ˆr	O
0t	O
d0	O
where	O
ˆr	O
consists	O
of	O
the	O
two	O
ﬁrst	O
rows	O
of	O
a	O
rotation	O
matrix	B
,	O
ˆt	O
is	O
the	O
vector	O
(	O
−r1t	O
(	O
cid:22	O
)	O
c	O
,	O
−r2t	O
(	O
cid:22	O
)	O
c	O
)	O
t	O
,	O
and	O
ˆ0	O
the	O
vector	O
(	O
0	O
,	O
0	O
)	O
t.	O
the	O
2	O
×	O
2	O
matrix	B
k2×2	O
is	O
upper-triangular	O
.	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
d	O
−1	O
k2×2	O
˜x0	O
0	O
ˆ0t	O
1	O
ˆt	O
ˆr	O
0t	O
1	O
p∞	O
=	O
k2×2	O
˜x0	O
ˆ0t	O
1	O
ˆt	O
ˆr	O
0t	O
d0	O
one	O
quickly	O
veriﬁes	O
that	O
−1	O
so	O
we	O
may	O
replace	O
k2×2	O
by	O
d	O
0	O
product	O
gives	O
k2×2	O
and	O
assume	O
that	O
d0	O
=	O
1.	O
multiplying	O
out	O
this	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
ˆr	O
0t	O
ˆt	O
+	O
k−1	O
2×2˜x0	O
1	O
p∞	O
=	O
=	O
k2×2ˆr	O
k2×2ˆt	O
+	O
˜x0	O
ˆ0t	O
k2×2	O
k2×2ˆt	O
+	O
˜x0	O
ˆ0t	O
1	O
1	O
k2×2	O
ˆ0	O
ˆ0t	O
1	O
(	O
cid:18	O
)	O
ˆ0	O
ˆr	O
0t	O
1	O
.	O
thus	O
,	O
making	O
appropriate	O
substitutions	O
for	O
ˆt	O
or	O
˜x0	O
,	O
we	O
can	O
write	O
the	O
afﬁne	B
camera	I
matrix	O
in	O
one	O
of	O
the	O
two	O
forms	O
k2×2	O
ˆ0	O
ˆ0t	O
1	O
k2×2	O
˜x0	O
ˆ0t	O
1	O
ˆ0	O
ˆr	O
0t	O
1	O
ˆt	O
ˆr	O
0t	O
1	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
p∞	O
=	O
(	O
6.20	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
.	O
(	O
cid:17	O
)	O
=	O
consequently	O
,	O
the	O
camera	B
p∞	O
can	O
be	O
interpreted	O
in	O
terms	O
of	O
these	O
decompositions	O
in	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
=	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
=	O
170	O
6	O
camera	B
models	O
∆	O
x	O
weak	B
perspective	I
c	O
perspective	O
f	O
d	O
0	O
fig	O
.	O
6.8.	O
perspective	O
vs	O
weak	B
perspective	I
projection	O
.	O
the	O
action	O
of	O
the	O
weak	B
perspective	I
camera	O
is	O
equivalent	B
to	O
orthographic	B
projection	I
onto	O
a	O
plane	B
(	O
at	O
z	O
=	O
d0	O
)	O
,	O
followed	O
by	O
perspective	O
projection	B
from	O
the	O
plane	B
.	O
the	O
difference	O
between	O
the	O
perspective	O
and	O
weak	B
perspective	I
image	O
point	B
depends	O
both	O
on	O
the	O
distance	B
∆	O
of	O
the	O
point	O
x	O
from	O
the	O
plane	B
,	O
and	O
the	O
distance	B
of	O
the	O
point	B
from	O
the	O
principal	O
ray	O
.	O
one	O
of	O
two	O
ways	O
,	O
either	O
with	O
˜x0	O
=	O
0	O
or	O
with	O
ˆt	O
=	O
ˆ0	O
.	O
using	O
the	O
second	O
decomposition	B
of	I
(	O
6.20	O
)	O
,	O
the	O
image	O
of	O
the	O
world	O
origin	O
is	O
p∞	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
=	O
(	O
˜xt	O
0	O
,	O
1	O
)	O
t.	O
consequently	O
,	O
the	O
value	O
of	O
˜x0	O
is	O
dependent	O
on	O
the	O
particular	O
choice	B
of	O
world	O
coordinates	B
,	O
and	O
hence	O
is	O
not	O
an	O
intrinsic	O
property	O
of	O
the	O
camera	O
itself	O
.	O
this	O
means	O
that	O
the	O
camera	B
matrix	I
p∞	O
does	O
not	O
have	O
a	O
principal	B
point	I
.	O
therefore	O
,	O
it	O
is	O
preferable	O
to	O
use	O
the	O
ﬁrst	O
decomposition	B
of	I
p∞	O
in	O
(	O
6.20	O
)	O
,	O
and	O
write	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
p∞	O
=	O
k2×2	O
ˆ0	O
ˆ0t	O
1	O
ˆt	O
ˆr	O
0t	O
1	O
(	O
6.21	O
)	O
where	O
the	O
two	O
matrices	O
represent	O
the	O
internal	B
camera	O
parameters	B
and	O
external	O
camera	B
parameters	I
of	O
p∞	O
.	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
parallel	B
projection	I
.	O
in	O
summary	O
the	O
essential	O
differences	O
between	O
p∞	O
and	O
a	O
ﬁnite	B
camera	O
are	O
:	O
•	O
the	O
parallel	B
projection	I
matrix	O
trix	O
[	O
i	O
|	O
0	O
]	O
of	O
a	O
ﬁnite	O
camera	B
(	O
6.5–p155	O
)	O
.	O
•	O
the	O
calibration	B
matrix	I
k2×2	O
ˆ0	O
ˆ0t	O
1	O
•	O
the	O
principal	B
point	I
is	O
not	O
deﬁned	O
.	O
replaces	O
k	O
of	O
a	O
ﬁnite	O
camera	B
(	O
6.10–p157	O
)	O
.	O
replaces	O
the	O
canonical	O
projection	O
ma-	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
1	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
6.3.4	O
a	O
hierarchy	B
of	I
afﬁne	O
cameras	B
in	O
a	O
similar	O
manner	O
to	O
the	O
development	O
of	O
the	O
ﬁnite	O
projection	B
camera	O
taxonomy	O
in	O
section	O
6.1	O
we	O
can	O
start	O
with	O
the	O
basic	O
operation	O
of	O
parallel	O
projection	O
and	O
build	O
a	O
hierarchy	B
of	I
camera	O
models	O
representing	O
progressively	O
more	O
general	O
cases	O
of	O
parallel	O
projection	O
.	O
6.3	O
cameras	B
at	O
inﬁnity	O
171	O
orthographic	B
projection	I
.	O
consider	O
projection	B
along	O
the	O
z-axis	O
.	O
this	O
is	O
represented	O
by	O
a	O
matrix	B
of	O
the	O
form	O
	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
1	O
	O
.	O
p	O
=	O
t	O
r	O
0t	O
1	O
(	O
cid:17	O
)	O
	O
r1t	O
t1	O
r2t	O
t2	O
0t	O
1	O
.	O
(	O
cid:18	O
)	O
	O
.	O
h	O
=	O
p	O
=	O
(	O
6.22	O
)	O
(	O
6.23	O
)	O
(	O
6.25	O
)	O
this	O
mapping	O
takes	O
a	O
point	B
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
to	O
the	O
image	O
point	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
,	O
dropping	O
the	O
z-coordinate	O
.	O
for	O
a	O
general	O
orthographic	B
projection	I
mapping	O
,	O
we	O
precede	O
this	O
map	O
by	O
a	O
3d	O
eu-	O
clidean	O
coordinate	O
change	O
of	O
the	O
form	O
writing	O
t	O
=	O
(	O
t1	O
,	O
t2	O
,	O
t3	O
)	O
t	O
,	O
we	O
see	O
that	O
a	O
general	O
orthographic	O
camera	B
is	O
of	O
the	O
form	O
an	O
orthographic	B
camera	O
has	O
ﬁve	O
degrees	B
of	I
freedom	I
,	O
namely	O
the	O
three	O
parameters	B
de-	O
scribing	O
the	O
rotation	B
matrix	O
r	O
,	O
plus	O
the	O
two	O
offset	O
parameters	B
t1	O
and	O
t2	O
.	O
an	O
orthographic	B
projection	I
matrix	O
p	O
=	O
[	O
m	O
|	O
t	O
]	O
is	O
characterized	O
by	O
a	O
matrix	B
m	O
with	O
last	O
row	O
zero	O
,	O
with	O
the	O
ﬁrst	O
two	O
rows	O
orthogonal	B
and	O
of	O
unit	O
norm	B
,	O
and	O
t3	O
=	O
1.	O
scaled	B
orthographic	I
projection	I
.	O
a	O
scaled	B
orthographic	I
projection	I
is	O
an	O
orthographic	B
projection	I
followed	O
by	O
isotropic	B
scaling	O
.	O
thus	O
,	O
in	O
general	O
,	O
its	O
matrix	B
may	O
be	O
written	O
in	O
the	O
form	O
	O
k	O
p	O
=	O
k	O
	O
	O
r1t	O
t1	O
r2t	O
t2	O
0t	O
1	O
	O
=	O
	O
r1t	O
r2t	O
0t	O
1	O
	O
.	O
t1	O
t2	O
1/k	O
it	O
has	O
six	O
degrees	B
of	I
freedom	I
.	O
a	O
scaled	B
orthographic	I
projection	I
matrix	O
p	O
=	O
[	O
m	O
|	O
t	O
]	O
is	O
characterized	O
by	O
a	O
matrix	B
m	O
with	O
last	O
row	O
zero	O
,	O
and	O
the	O
ﬁrst	O
two	O
rows	O
orthogonal	B
and	O
of	O
equal	O
norm	B
.	O
(	O
6.24	O
)	O
weak	B
perspective	I
projection	O
.	O
analogous	O
to	O
a	O
ﬁnite	B
ccd	O
camera	B
,	O
we	O
may	O
consider	O
the	O
case	O
of	O
a	O
camera	O
at	B
inﬁnity	I
for	O
which	O
the	O
scale	O
factors	O
in	O
the	O
two	O
axial	O
image	O
directions	O
are	O
not	O
equal	O
.	O
such	O
a	O
camera	B
has	O
a	O
projection	B
matrix	O
of	O
the	O
form	O
	O
αx	O
p	O
=	O
	O
	O
r1t	O
t1	O
r2t	O
t2	O
0t	O
1	O
	O
.	O
αy	O
1	O
it	O
has	O
seven	O
degrees	B
of	I
freedom	I
.	O
a	O
weak	B
perspective	I
projection	O
matrix	B
p	O
=	O
[	O
m	O
|	O
t	O
]	O
is	O
characterized	O
by	O
a	O
matrix	B
m	O
with	O
last	O
row	O
zero	O
,	O
and	O
ﬁrst	O
two	O
rows	O
orthogonal	B
(	O
but	O
they	O
need	O
not	O
have	O
equal	O
norm	B
as	O
is	O
required	O
in	O
the	O
scaled	B
orthographic	I
case	O
)	O
.	O
the	O
geometric	B
action	O
of	O
this	O
camera	B
is	O
illustrated	O
in	O
ﬁgure	O
6.8	O
.	O
172	O
the	O
afﬁne	B
camera	I
,	O
pa.	O
as	O
has	O
already	O
been	O
seen	O
in	O
the	O
case	O
of	O
p∞	O
,	O
a	O
general	O
camera	O
matrix	B
of	O
the	O
afﬁne	B
form	O
,	O
and	O
with	O
no	O
restrictions	O
on	O
its	O
elements	O
,	O
may	O
be	O
decomposed	O
as	O
6	O
camera	B
models	O
	O
αx	O
pa	O
=	O
	O
	O
r1t	O
t1	O
r2t	O
t2	O
0t	O
1	O
	O
.	O
s	O
αy	O
1	O
it	O
has	O
eight	O
degrees	B
of	I
freedom	I
,	O
and	O
may	O
be	O
thought	O
of	O
as	O
the	O
parallel	B
projection	I
version	O
of	O
the	O
ﬁnite	O
projective	B
camera	I
(	O
6.11–p157	O
)	O
.	O
in	O
full	O
generality	O
an	O
afﬁne	B
camera	I
has	O
the	O
form	O
	O
m11	O
m12	O
m13	O
m21	O
m22	O
m23	O
0	O
0	O
0	O
	O
.	O
t1	O
t2	O
1	O
pa	O
=	O
it	O
has	O
eight	O
degrees	B
of	I
freedom	I
corresponding	O
to	O
the	O
eight	O
non-zero	O
and	O
non-unit	O
matrix	B
elements	O
.	O
we	O
denote	O
the	O
top	O
left	O
2	O
×	O
3	O
submatrix	O
by	O
m2×3	O
.	O
the	O
sole	O
restriction	O
on	O
the	O
afﬁne	B
camera	I
is	O
that	O
m2×3	O
has	O
rank	O
2.	O
this	O
arises	O
from	O
the	O
requirement	O
that	O
the	O
rank	O
of	O
p	O
is	O
3.	O
the	O
afﬁne	B
camera	I
covers	O
the	O
composed	O
effects	O
of	O
an	O
afﬁne	B
transformation	I
of	O
3-space	O
,	O
an	O
orthographic	B
projection	I
from	O
3-space	O
to	O
an	O
image	O
,	O
and	O
an	O
afﬁne	B
transformation	I
of	O
the	O
image	O
.	O
this	O
follows	O
simply	O
by	O
concatenating	O
the	O
matrices	O
representing	O
these	O
map-	O
pings	O
:	O
pa	O
=	O
[	O
3	O
×	O
3	O
aﬃne	O
]	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
1	O
which	O
results	O
in	O
a	O
3	O
×	O
4	O
matrix	B
of	O
the	O
afﬁne	B
form	O
.	O
projection	B
under	O
an	O
afﬁne	B
camera	I
is	O
a	O
linear	B
mapping	O
on	O
inhomogeneous	O
coordinates	B
	O
1	O
0	O
0	O
0	O
	O
[	O
4	O
×	O
4	O
aﬃne	O
]	O
composed	O
with	O
a	O
translation	O
:	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:17	O
)	O
x	O
y	O
=	O
m11	O
m12	O
m13	O
m21	O
m22	O
m23	O
(	O
cid:20	O
)	O
	O
+	O
(	O
cid:21	O
)	O
(	O
cid:18	O
)	O
	O
x	O
(	O
cid:22	O
)	O
x	O
+	O
˜t	O
.	O
y	O
z	O
t1	O
t2	O
(	O
6.26	O
)	O
which	O
is	O
written	O
more	O
concisely	O
as	O
˜x	O
=	O
m2×3	O
the	O
point	B
˜t	O
=	O
(	O
t1	O
,	O
t2	O
)	O
t	O
is	O
the	O
image	O
of	O
the	O
world	O
origin	O
.	O
the	O
camera	B
models	O
of	O
this	O
section	O
are	O
seen	O
to	O
be	O
afﬁne	B
cameras	I
satisfying	O
additional	O
constraints	B
,	O
thus	O
the	O
afﬁne	B
camera	I
is	O
an	O
abstraction	O
of	O
this	O
hierarchy	O
.	O
for	O
example	O
,	O
in	O
the	O
case	O
of	O
the	O
weak	O
perspective	O
camera	B
the	O
rows	O
of	O
m2×3	O
are	O
scalings	O
of	O
rows	O
of	O
a	O
rotation	O
matrix	B
,	O
and	O
thus	O
are	O
orthogonal	B
.	O
6.3.5	O
more	B
properties	I
of	O
the	O
afﬁne	B
camera	I
the	O
plane	O
at	O
inﬁnity	O
in	O
space	O
is	O
mapped	O
to	O
points	O
at	B
inﬁnity	I
in	O
the	O
image	O
.	O
this	O
is	O
easily	O
seen	O
by	O
computing	B
pa	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
0	O
)	O
t	O
=	O
(	O
x	O
,	O
y	O
,	O
0	O
)	O
t.	O
extending	O
the	O
terminology	O
of	O
ﬁnite	O
6.3	O
cameras	B
at	O
inﬁnity	O
173	O
projective	B
cameras	O
,	O
we	O
interpret	O
this	O
by	O
saying	O
that	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
is	O
the	O
plane	O
at	O
inﬁnity	O
.	O
the	O
optical	O
centre	B
,	O
since	O
it	O
lies	O
on	O
the	O
principal	B
plane	I
,	O
must	O
also	O
lie	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
from	O
this	O
we	O
have	O
(	O
i	O
)	O
conversely	O
,	O
any	O
projective	B
camera	I
matrix	O
for	O
which	O
the	O
principal	B
plane	I
is	O
the	O
plane	O
at	O
inﬁnity	O
is	O
an	O
afﬁne	B
camera	I
matrix	O
.	O
(	O
ii	O
)	O
parallel	B
world	O
lines	B
are	O
projected	O
to	O
parallel	O
image	O
lines	O
.	O
this	O
follows	O
because	O
parallel	B
world	O
lines	B
intersect	O
at	O
the	O
plane	O
at	O
inﬁnity	O
,	O
and	O
this	O
intersection	B
point	O
is	O
mapped	O
to	O
a	O
point	B
at	O
inﬁnity	O
in	O
the	O
image	O
.	O
hence	O
the	O
image	O
lines	O
are	O
parallel	B
.	O
(	O
iii	O
)	O
the	O
vector	O
d	O
satisfying	O
m2×3d	O
=	O
0	O
is	O
the	O
direction	O
of	O
parallel	O
projection	O
,	O
and	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
dt	O
,	O
0	O
)	O
t	O
the	O
camera	B
centre	I
since	O
pa	O
=	O
0.	O
d	O
0	O
any	O
camera	B
which	O
consists	O
of	O
the	O
composed	O
effects	O
of	O
afﬁne	O
transformations	O
(	O
ei-	O
ther	O
of	O
space	O
,	O
or	O
of	O
the	O
image	O
)	O
with	O
parallel	O
projection	B
will	O
have	O
the	O
afﬁne	B
form	O
.	O
for	O
example	O
,	O
para-perspective	O
projection	B
consists	O
of	O
two	O
such	O
mappings	O
:	O
the	O
ﬁrst	O
is	O
par-	O
allel	O
projection	B
onto	O
a	O
plane	B
π	O
through	O
the	O
centroid	O
and	O
parallel	B
to	O
the	O
image	B
plane	I
.	O
the	O
direction	O
of	O
parallel	O
projection	O
is	O
the	O
ray	O
joining	O
the	O
centroid	O
to	O
the	O
camera	B
centre	I
.	O
this	O
parallel	B
projection	I
is	O
followed	O
by	O
an	O
afﬁne	B
transformation	I
(	O
actually	O
a	O
similarity	B
)	O
between	O
π	O
and	O
the	O
image	O
.	O
thus	O
a	O
para-perspective	O
camera	B
is	O
an	O
afﬁne	B
camera	I
.	O
6.3.6	O
general	O
cameras	O
at	B
inﬁnity	I
an	O
afﬁne	B
camera	I
is	O
one	O
for	O
which	O
the	O
principal	B
plane	I
is	O
the	O
plane	O
at	O
inﬁnity	O
.	O
as	O
such	O
,	O
its	O
camera	B
centre	I
lies	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
however	O
,	O
it	O
is	O
possible	O
for	O
the	O
camera	B
centre	I
to	O
lie	O
on	O
the	O
plane	O
at	O
inﬁnity	O
without	O
the	O
whole	O
principal	B
plane	I
being	O
the	O
plane	O
at	O
inﬁnity	O
.	O
a	O
camera	B
centre	I
lies	O
at	B
inﬁnity	I
if	O
p	O
=	O
[	O
m	O
|	O
p4	O
]	O
with	O
m	O
a	O
singular	O
matrix	O
.	O
this	O
is	O
clearly	O
a	O
weaker	O
condition	O
than	O
insisting	O
that	O
the	O
last	O
row	O
of	O
m	O
is	O
zero	O
,	O
as	O
is	O
the	O
case	O
for	B
afﬁne	I
cameras	I
.	O
if	O
m	O
is	O
singular	O
,	O
but	O
the	O
last	O
row	O
of	O
m	O
is	O
not	O
zero	O
,	O
then	O
the	O
camera	B
is	O
not	O
afﬁne	B
,	O
but	O
not	O
a	O
ﬁnite	B
projective	I
camera	O
either	O
.	O
such	O
a	O
camera	B
is	O
rather	O
a	O
strange	O
object	O
,	O
however	O
,	O
and	O
will	O
not	O
be	O
treated	O
in	O
detail	O
in	O
this	O
book	O
.	O
we	O
may	O
compare	O
the	O
properties	B
of	O
afﬁne	B
and	O
non-afﬁne	O
inﬁnite	O
cameras	O
:	O
afﬁne	B
camera	I
non-afﬁne	O
camera	B
camera	O
centre	B
on	O
π∞	O
principal	B
plane	I
is	O
π∞	O
image	O
of	O
points	O
on	O
π∞	O
on	O
l∞	O
yes	O
yes	O
yes	O
yes	O
no	O
no	O
in	O
general	O
in	O
both	O
cases	O
the	O
camera	B
centre	I
is	O
the	O
direction	O
of	O
projection	O
.	O
furthermore	O
,	O
in	O
the	O
case	O
of	O
an	O
afﬁne	B
camera	I
all	O
non-inﬁnite	O
points	O
are	O
in	O
front	O
of	O
the	O
camera	O
.	O
for	O
a	O
non-afﬁne	O
camera	B
space	O
is	O
partitioned	O
into	O
two	O
sets	O
of	B
points	I
by	O
the	O
principal	B
plane	I
.	O
a	O
general	O
camera	O
at	B
inﬁnity	I
could	O
arise	O
from	O
a	O
perspective	O
image	O
of	O
an	O
image	O
pro-	O
duced	O
by	O
an	O
afﬁne	B
camera	I
.	O
this	O
imaging	O
process	O
corresponds	O
to	O
left-multiplying	O
the	O
174	O
6	O
camera	B
models	O
line	B
of	O
motion	O
y	O
perspective	O
axis	O
image	O
plane	B
x	O
orthographic	B
axis	O
instantaneous	O
view	O
plane	B
fig	O
.	O
6.9.	O
acquisition	O
geometry	O
of	O
a	O
pushbroom	O
camera	B
.	O
afﬁne	B
camera	I
by	O
a	O
general	O
3	O
×	O
3	O
matrix	B
representing	O
the	O
planar	O
homography	O
.	O
the	O
re-	O
sulting	O
3	O
×	O
4	O
matrix	B
is	O
still	O
a	O
camera	B
at	O
inﬁnity	O
,	O
but	O
it	O
does	O
not	O
have	O
the	O
afﬁne	B
form	O
,	O
since	O
parallel	B
lines	I
in	O
the	O
world	O
will	O
in	O
general	O
appear	O
as	O
converging	O
lines	B
in	O
the	O
image	O
.	O
6.4	O
other	O
camera	B
models	O
6.4.1	O
pushbroom	B
cameras	O
the	O
linear	B
pushbroom	O
(	O
lp	O
)	O
camera	B
is	O
an	O
abstraction	O
of	O
a	O
type	O
of	O
sensor	O
common	O
in	O
satellites	O
,	O
for	O
instance	O
the	O
spot	O
sensor	O
.	O
in	O
such	O
a	O
camera	B
,	O
a	O
linear	B
sensor	O
array	O
is	O
used	O
to	O
capture	O
a	O
single	O
line	O
of	O
imagery	O
at	O
a	O
time	O
.	O
as	O
the	O
sensor	O
moves	O
the	O
sensor	O
plane	B
sweeps	O
out	O
a	O
region	O
of	O
space	O
(	O
hence	O
the	O
name	O
pushbroom	B
)	O
,	O
capturing	O
the	O
image	O
a	O
single	O
line	O
at	O
a	O
time	O
.	O
the	O
second	O
dimension	O
of	O
the	O
image	O
is	O
provided	O
by	O
the	O
motion	O
of	O
the	O
sensor	O
.	O
in	O
the	O
linear	B
pushbroom	O
model	B
,	O
the	O
sensor	O
is	O
assumed	O
to	O
move	O
in	O
a	O
straight	O
line	O
at	O
constant	O
velocity	O
with	O
respect	O
to	O
the	O
ground	O
.	O
in	O
addition	O
,	O
one	O
assumes	O
that	O
the	O
orientation	B
of	O
the	O
sensor	O
array	O
with	O
respect	O
to	O
the	O
direction	O
of	O
travel	O
is	O
constant	O
.	O
in	O
the	O
direction	O
of	O
the	O
sensor	O
,	O
the	O
image	O
is	O
effectively	O
a	O
perspective	O
image	O
,	O
whereas	O
in	O
the	O
direction	O
of	O
the	O
sensor	O
motion	O
it	O
is	O
an	O
orthographic	B
projection	I
.	O
the	O
geometry	O
of	O
the	O
lp	O
camera	B
is	O
illustrated	O
in	O
ﬁgure	O
6.9.	O
it	O
turns	O
out	O
that	O
the	O
mapping	O
from	O
object	O
space	O
into	O
the	O
image	O
may	O
be	O
described	O
by	O
a	O
3	O
×	O
4	O
camera	B
matrix	I
,	O
just	O
as	O
with	O
a	O
general	B
projective	I
camera	O
.	O
however	O
,	O
the	O
way	O
in	O
which	O
this	O
matrix	B
is	O
used	O
is	O
somewhat	O
different	O
.	O
•	O
let	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
be	O
an	O
object	O
point	B
,	O
and	O
let	O
p	O
be	O
the	O
camera	B
matrix	I
of	O
the	O
lp	O
camera	B
.	O
suppose	O
that	O
px	O
=	O
(	O
x	O
,	O
y	O
,	O
w	O
)	O
t.	O
then	O
the	O
corresponding	O
image	O
point	O
(	O
represented	O
as	O
an	O
inhomogeneous	O
2-vector	O
)	O
is	O
(	O
x	O
,	O
y/w	O
)	O
t.	O
one	O
must	O
compare	O
this	O
with	O
the	O
projective	B
camera	I
mapping	O
.	O
in	O
that	O
case	O
the	O
point	B
represented	O
by	O
(	O
x	O
,	O
y	O
,	O
w	O
)	O
t	O
is	O
(	O
x/w	O
,	O
y/w	O
)	O
t.	O
note	O
the	O
difference	O
that	O
in	O
the	O
lp	O
case	O
,	O
the	O
coordinate	O
x	O
is	O
not	O
divided	O
by	O
the	O
factor	O
w	O
to	O
get	O
the	O
image	O
coordinate	O
.	O
in	O
this	O
formula	O
,	O
the	O
x-axis	O
in	O
the	O
image	O
is	O
the	O
direction	O
of	O
the	O
sensor	O
motion	O
,	O
whereas	O
the	O
y-axis	O
is	O
in	O
the	O
direction	O
of	O
the	O
linear	O
sensor	O
array	O
.	O
the	O
camera	B
has	O
11	O
degrees	B
of	I
freedom	I
.	O
another	O
way	O
of	O
writing	O
the	O
formula	O
for	O
lp	O
projection	B
is	O
6.4	O
other	O
camera	B
models	O
˜x	O
=	O
x	O
=	O
p1tx	O
˜y	O
=	O
y/z	O
=	O
p2tx	O
p3tx	O
175	O
(	O
6.27	O
)	O
where	O
(	O
˜x	O
,	O
˜y	O
)	O
is	O
the	O
image	O
point	O
.	O
note	O
that	O
the	O
˜y-coordinate	O
behaves	O
projectively	O
,	O
whereas	O
the	O
˜x	O
is	O
obtained	O
by	O
orthog-	O
onal	O
projection	B
of	O
the	O
point	B
x	O
on	O
the	O
direction	O
perpendicular	O
to	O
the	O
plane	B
p1	O
.	O
the	O
vector	O
p1	O
represents	O
the	O
sweep	O
plane	B
of	O
the	O
camera	B
at	O
time	O
t	O
=	O
0	O
–	O
that	O
is	O
the	O
moment	O
when	O
the	O
line	B
with	O
coordinates	B
˜x	O
=	O
0	O
is	O
captured	O
.	O
mapping	O
of	O
lines	B
.	O
one	O
of	O
the	O
novel	O
features	O
of	O
the	O
lp	O
camera	B
is	O
that	O
straight	O
lines	B
in	O
space	O
are	O
not	O
mapped	O
to	O
straight	O
lines	B
in	O
the	O
image	O
(	O
they	O
are	O
mapped	O
to	O
straight	O
lines	B
in	O
the	O
case	O
of	O
a	O
projective	O
camera	B
–	O
see	O
section	O
8.1.2	O
)	O
.	O
the	O
set	O
of	B
points	I
x	O
lying	O
on	O
a	O
3d	O
line	B
may	O
be	O
written	O
as	O
x0	O
+	O
αd	O
,	O
where	O
x0	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
is	O
a	O
point	B
on	O
the	O
line	B
and	O
d	O
=	O
(	O
dx	O
,	O
dy	O
,	O
dz	O
,	O
0	O
)	O
t	O
is	O
the	O
intersection	B
of	O
this	O
line	B
with	O
the	O
plane	O
at	O
inﬁnity	O
.	O
in	O
this	O
case	O
,	O
we	O
compute	O
from	O
(	O
6.27	O
)	O
˜x	O
=	O
p1t	O
(	O
x0	O
+	O
td	O
)	O
p2t	O
(	O
x0	O
+	O
td	O
)	O
p3t	O
(	O
x0	O
+	O
td	O
)	O
˜y	O
=	O
.	O
this	O
may	O
be	O
written	O
as	O
a	O
pair	O
of	O
equations	O
˜x	O
=	O
a+bt	O
and	O
(	O
c+dt	O
)	O
˜y	O
=	O
e+f	O
t.	O
eliminating	O
t	O
from	O
these	O
equations	O
leads	O
to	O
an	O
equation	O
of	O
the	O
form	O
α˜x˜y	O
+	O
β	O
˜x	O
+	O
γ	O
˜y	O
+	O
δ	O
=	O
0	O
,	O
which	O
is	O
the	O
equation	O
of	O
a	O
hyperbola	O
in	O
the	O
image	B
plane	I
,	O
asymptotic	O
in	O
one	O
direction	O
to	O
the	O
line	B
α˜x	O
+	O
γ	O
=	O
0	O
,	O
and	O
in	O
the	O
other	O
direction	O
to	O
the	O
line	B
α˜y	O
+	O
β	O
=	O
0.	O
a	O
hyperbola	O
is	O
made	O
up	O
of	O
two	O
curves	O
.	O
however	O
,	O
only	O
one	O
of	O
the	O
curves	O
making	O
up	O
the	O
image	O
of	O
a	O
line	B
actually	O
appears	O
in	O
the	O
image	O
–	O
the	O
other	O
part	O
of	O
the	O
hyperbola	O
corresponds	O
to	O
points	O
lying	O
behind	O
the	O
camera	B
.	O
6.4.2	O
line	B
cameras	O
this	O
chapter	O
has	O
dealt	O
with	O
the	O
central	B
projection	I
of	O
3-space	O
onto	O
a	O
2d	O
image	O
.	O
an	O
analogous	O
development	O
can	O
be	O
given	O
for	O
the	O
central	B
projection	I
of	O
a	O
plane	B
onto	O
a	O
1d	O
line	B
contained	O
in	O
the	O
plane	B
.	O
see	O
ﬁgure	O
22.1	O
(	O
p535	O
)	O
.	O
the	O
camera	B
model	O
for	O
this	O
geometry	O
is	O
	O
=	O
p2×3x	O
(	O
cid:18	O
)	O
	O
x	O
y	O
z	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
x	O
y	O
=	O
p11	O
p12	O
p13	O
p21	O
p22	O
p23	O
which	O
is	O
a	O
linear	B
mapping	O
from	O
homogeneous	O
representation	B
of	O
the	O
plane	B
to	O
a	O
homo-	O
geneous	O
representation	B
of	O
the	O
line	B
.	O
the	O
camera	B
has	O
5	O
degrees	B
of	I
freedom	I
.	O
again	O
the	O
null-space	B
,	O
c	O
,	O
of	O
thep	O
2×3	O
projection	B
matrix	O
is	O
the	O
camera	B
centre	I
,	O
and	O
the	O
matrix	B
can	O
be	O
decomposed	O
in	O
a	O
similar	O
manner	O
to	O
the	O
ﬁnite	B
projective	I
camera	O
(	O
6.11–p157	O
)	O
as	O
p2×3	O
=	O
k2×2r2×2	O
[	O
i2×2	O
|	O
−˜c	O
]	O
176	O
where	O
˜c	O
is	O
the	O
inhomogeneous	O
2-vector	O
representing	O
the	O
centre	B
(	O
2	O
dof	O
)	O
,	O
r2×2	O
is	O
a	O
rota-	O
tion	O
matrix	B
(	O
1	O
dof	O
)	O
,	O
and	O
6	O
camera	B
models	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
k2×2	O
=	O
αx	O
x0	O
1	O
the	O
internal	B
calibration	O
matrix	B
(	O
2	O
dof	O
)	O
.	O
6.5	O
closure	O
this	O
chapter	O
has	O
covered	O
camera	B
models	O
,	O
their	O
taxonomy	O
and	O
anatomy	O
.	O
the	O
subsequent	O
chapters	O
cover	O
the	O
estimation	B
of	I
cameras	O
from	O
a	O
set	O
of	O
world	O
to	O
image	O
correspondences	B
,	O
and	O
the	O
action	O
of	O
a	O
camera	B
on	O
various	O
geometric	B
objects	O
such	O
as	O
lines	O
and	O
quadrics	B
.	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
are	O
also	O
described	O
in	O
more	O
detail	O
in	O
chapter	O
8	O
.	O
6.5.1	O
the	O
literature	O
[	O
aloimonos-90	O
]	O
deﬁned	O
a	O
hierarchy	B
of	I
camera	O
models	O
including	O
para-perspective	O
.	O
mundy	O
and	O
zisserman	O
[	O
mundy-92	O
]	O
generalized	O
this	O
with	O
the	O
afﬁne	B
camera	I
.	O
faugeras	O
developed	O
properties	B
of	O
the	O
projective	B
camera	I
in	O
his	O
textbook	O
[	O
faugeras-93	O
]	O
.	O
further	O
details	O
on	O
the	O
linear	B
pushbroom	O
camera	B
are	O
given	O
in	O
[	O
gupta-97	O
]	O
,	O
and	O
on	O
the	O
2d	O
camera	B
in	O
[	O
quan-97b	O
]	O
.	O
6.5.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
let	O
i0	O
be	O
a	O
projective	B
image	O
,	O
and	O
i1	O
be	O
an	O
image	O
of	O
i0	O
(	O
an	O
image	O
of	O
an	O
image	O
)	O
.	O
let	O
the	O
composite	O
image	O
be	O
denoted	O
by	O
i	O
.	O
show	O
that	O
the	O
apparent	B
camera	O
centre	B
of	O
i	O
is	O
the	O
same	O
as	O
that	O
of	O
i0	O
.	O
speculate	O
on	O
how	O
this	O
explains	O
why	O
a	O
portrait	O
’	O
s	O
eyes	O
“	O
follow	O
you	O
round	O
the	O
room.	O
”	O
verify	O
on	O
the	O
other	O
hand	O
that	O
all	O
other	O
parameters	B
of	O
i	O
and	O
i0	O
may	O
be	O
different	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
show	O
that	O
the	O
ray	O
back-projected	O
from	O
an	O
image	O
point	O
x	O
under	O
a	O
projective	B
camera	I
p	O
(	O
as	O
in	O
(	O
6.14–p162	O
)	O
)	O
may	O
be	O
written	O
as	O
l∗	O
=	O
pt	O
[	O
x	O
]	O
×p	O
(	O
6.28	O
)	O
where	O
l∗	O
is	O
the	O
dual	B
pl¨ucker	O
representation	B
of	O
a	O
line	B
(	O
3.9–p71	O
)	O
.	O
(	O
iii	O
)	O
the	O
afﬁne	B
camera	I
.	O
(	O
a	O
)	O
show	O
that	O
the	O
afﬁne	B
camera	I
is	O
the	O
most	O
general	O
linear	O
mapping	O
on	O
ho-	O
mogeneous	O
coordinates	B
that	O
maps	O
parallel	B
world	O
lines	B
to	O
parallel	B
image	O
lines	B
.	O
to	O
do	O
this	O
consider	O
the	O
projection	B
of	O
points	O
on	O
π∞	O
,	O
and	O
show	O
that	O
only	O
if	O
p	O
has	O
the	O
afﬁne	B
form	O
will	O
they	O
map	O
to	O
points	O
at	B
inﬁnity	I
in	O
the	O
image	O
.	O
(	O
b	O
)	O
show	O
that	O
for	O
parallel	O
lines	B
mapped	O
by	O
an	O
afﬁne	B
camera	I
the	O
ratio	O
of	O
lengths	O
on	O
line	O
segments	O
is	O
an	O
invariant	O
.	O
what	O
other	O
invariants	B
are	O
there	O
under	O
an	O
afﬁne	B
camera	I
?	O
(	O
iv	O
)	O
the	O
rational	O
polynomial	O
camera	B
is	O
a	O
general	O
camera	O
model	B
,	O
used	O
extensively	O
6.5	O
closure	O
177	O
in	O
the	O
satellite	O
surveillance	O
community	O
.	O
image	O
coordinates	O
are	O
deﬁned	O
by	O
the	O
ratios	O
x	O
=	O
nx	O
(	O
x	O
)	O
/dx	O
(	O
x	O
)	O
y	O
=	O
ny	O
(	O
x	O
)	O
/dy	O
(	O
x	O
)	O
where	O
the	O
functions	O
nx	O
,	O
dx	O
,	O
ny	O
,	O
dy	O
are	O
homogeneous	O
cubic	O
polynomials	O
in	O
the	O
3-space	O
point	B
x.	O
each	O
cubic	O
has	O
20	O
coefﬁcients	O
,	O
so	O
that	O
overall	O
the	O
camera	B
has	O
78	O
degrees	B
of	I
freedom	I
.	O
all	O
of	O
the	O
cameras	O
surveyed	O
in	O
this	O
chapter	O
(	O
projective	B
,	O
afﬁne	B
,	O
pushbroom	B
)	O
are	O
special	O
cases	O
of	O
the	O
rational	O
polynomial	O
camera	B
.	O
its	O
dis-	O
advantage	O
is	O
that	O
it	O
is	O
severely	O
over-parametrized	O
for	O
these	O
cases	O
.	O
more	O
details	O
are	O
given	O
in	O
hartley	O
and	O
saxena	O
[	O
hartley-97e	O
]	O
.	O
camera	B
(	O
6.22	O
)	O
by	O
applying	O
a	O
4	O
×	O
4	O
homography	B
h	O
on	O
the	O
right	O
such	O
that	O
(	O
v	O
)	O
a	O
ﬁnite	B
projective	I
camera	O
(	O
6.11–p157	O
)	O
p	O
may	O
be	O
transformed	O
to	O
an	O
orthographic	B
ph	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
h	O
=	O
	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
1	O
	O
=	O
porthog	O
.	O
(	O
the	O
last	O
row	O
of	O
h	O
is	O
chosen	O
so	O
that	O
h	O
has	O
rank	O
4	O
)	O
.	O
then	O
since	O
x	O
=	O
p	O
(	O
hh−1	O
)	O
x	O
=	O
(	O
ph	O
)	O
(	O
h−1x	O
)	O
=	O
porthogx	O
(	O
cid:2	O
)	O
imaging	O
under	O
p	O
is	O
equivalent	B
to	O
ﬁrst	O
transforming	O
the	O
3-space	O
points	O
x	O
to	O
x	O
(	O
cid:2	O
)	O
=	O
h−1x	O
and	O
then	O
applying	O
an	O
orthographic	B
projection	I
.	O
thus	O
the	O
action	O
of	O
any	O
camera	B
may	O
be	O
considered	O
as	O
a	O
projective	B
transformation	I
of	O
3-space	O
followed	O
by	O
orthographic	B
projection	I
.	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
this	O
chapter	O
describes	O
numerical	O
methods	O
for	O
estimating	B
the	O
camera	B
projection	O
matrix	B
from	O
corresponding	O
3-space	O
and	O
image	O
entities	O
.	O
this	O
computation	B
of	I
the	O
camera	B
matrix	I
is	O
known	O
as	O
resectioning	B
.	O
the	O
simplest	O
such	O
correspondence	B
is	O
that	O
between	O
a	O
3d	O
point	B
x	O
and	O
its	O
image	O
x	O
under	O
the	O
unknown	O
camera	B
mapping	O
.	O
given	O
sufﬁciently	O
many	O
correspondences	B
xi	O
↔	O
xi	O
the	O
camera	B
matrix	I
p	O
may	O
be	O
determined	O
.	O
similarly	O
,	O
p	O
may	O
be	O
determined	O
from	O
sufﬁciently	O
many	O
corresponding	O
world	O
and	O
image	O
lines	O
.	O
if	O
additional	O
constraints	B
apply	O
to	O
the	O
matrix	B
p	O
,	O
such	O
as	O
that	O
the	O
pixels	O
are	O
square	O
,	O
then	O
a	O
restricted	O
camera	B
matrix	I
subject	O
to	O
these	O
constraints	B
may	O
be	O
estimated	O
from	O
world	O
to	O
image	O
correspondences	B
.	O
throughout	O
this	O
book	O
it	O
is	O
assumed	O
that	O
the	O
map	O
from	O
3-space	O
to	O
the	O
image	O
is	O
linear	B
.	O
this	O
assumption	O
is	O
invalid	O
if	O
there	O
is	O
lens	O
distortion	B
.	O
the	O
topic	O
of	O
radial	O
lens	O
distortion	B
correction	I
is	O
dealt	O
with	O
in	O
this	O
chapter	O
.	O
the	O
internal	B
parameters	I
k	O
of	O
the	O
camera	O
may	O
be	O
extracted	O
from	O
the	O
matrix	B
p	O
by	O
the	O
decomposition	B
of	I
section	O
6.2.4.	O
alternatively	O
,	O
the	O
internal	B
parameters	I
can	O
be	O
computed	O
directly	O
,	O
without	O
necessitating	O
estimating	B
p	O
,	O
by	O
the	O
methods	O
of	O
chapter	O
8	O
.	O
7.1	O
basic	O
equations	O
we	O
assume	O
a	O
number	O
of	O
point	O
correspondences	B
xi	O
↔	O
xi	O
between	O
3d	O
points	O
xi	O
and	O
2d	O
image	O
points	O
xi	O
are	O
given	O
.	O
we	O
are	O
required	O
to	O
ﬁnd	O
a	O
camera	B
matrix	I
p	O
,	O
namely	O
a	O
3	O
×	O
4	O
matrix	B
such	O
that	O
xi	O
=	O
pxi	O
for	O
all	O
i.	O
the	O
similarity	B
of	O
this	O
problem	O
with	O
that	O
of	O
computing	O
a	O
2d	O
projective	B
transformation	I
h	O
,	O
treated	O
in	O
chapter	O
4	O
,	O
is	O
evident	O
.	O
the	O
only	O
difference	O
is	O
the	O
dimension	O
of	O
the	O
problem	O
.	O
in	O
the	O
2d	O
case	O
the	O
matrix	B
h	O
has	O
dimension	O
3×	O
3	O
,	O
whereas	O
in	O
the	O
present	O
case	O
,	O
p	O
is	O
a	O
3×	O
4	O
matrix	B
.	O
as	O
one	O
may	O
expect	O
,	O
much	O
of	O
the	O
material	O
from	O
chapter	O
4	O
applies	O
almost	O
unchanged	O
to	O
the	O
present	O
case	O
.	O
as	O
in	O
section	O
4.1	O
(	O
p88	O
)	O
for	O
each	O
correspondence	B
xi	O
↔	O
xi	O
we	O
derive	O
a	O
relationship	O
	O
0t	O
wixt	O
−yixt	O
i	O
i	O
i	O
−wixt	O
0t	O
xixt	O
i	O
yixt	O
−xixt	O
i	O
i	O
0t	O
	O
	O
=	O
0	O
.	O
	O
p1	O
p2	O
p3	O
(	O
7.1	O
)	O
where	O
each	O
pit	O
is	O
a	O
4-vector	O
,	O
the	O
i-th	O
row	O
of	O
p.	O
alternatively	O
,	O
one	O
may	O
choose	O
to	O
use	O
178	O
only	O
the	O
ﬁrst	O
two	O
equations	O
:	O
(	O
cid:17	O
)	O
0t	O
−wixt	O
0t	O
wixt	O
i	O
i	O
yixt	O
−xixt	O
i	O
i	O
7.1	O
basic	O
equations	O
	O
=	O
0	O
179	O
(	O
7.2	O
)	O
(	O
cid:18	O
)	O
	O
p1	O
p2	O
p3	O
since	O
the	O
three	O
equations	O
of	O
(	O
7.1	O
)	O
are	O
linearly	O
dependent	O
.	O
from	O
a	O
set	O
of	O
n	O
point	B
corre-	O
spondences	O
,	O
we	O
obtain	O
a	O
2n	O
×	O
12	O
matrix	B
a	O
by	O
stacking	O
up	O
the	O
equations	O
(	O
7.2	O
)	O
for	O
each	O
correspondence	B
.	O
the	O
projection	B
matrix	O
p	O
is	O
computed	O
by	O
solving	B
the	O
set	O
of	O
equations	O
ap	O
=	O
0	O
,	O
where	O
p	O
is	O
the	O
vector	O
containing	O
the	O
entries	O
of	O
the	O
matrix	O
p.	O
minimal	B
solution	I
.	O
since	O
the	O
matrix	B
p	O
has	O
12	O
entries	O
,	O
and	O
(	O
ignoring	O
scale	O
)	O
11	O
degrees	B
of	I
freedom	I
,	O
it	O
is	O
necessary	O
to	O
have	O
11	O
equations	O
to	O
solve	O
for	O
p.	O
since	O
each	O
point	B
corre-	O
spondence	O
leads	O
to	O
two	O
equations	O
,	O
at	O
a	O
minimum	O
5	O
1	O
2	O
such	O
correspondences	B
are	O
required	O
to	O
solve	O
for	O
p.	O
the	O
1	O
2	O
indicates	O
that	O
only	O
one	O
of	O
the	O
equations	O
is	O
used	O
from	O
the	O
sixth	O
point	B
,	O
so	O
one	O
needs	O
only	O
to	O
know	O
the	O
x-coordinate	O
(	O
or	O
alternatively	O
the	O
y-coordinate	O
)	O
of	O
the	O
sixth	O
image	O
point	O
.	O
given	O
this	O
minimum	O
number	O
of	O
correspondences	O
,	O
the	O
solution	B
is	O
exact	O
,	O
i.e	O
.	O
the	O
space	O
points	O
are	O
projected	O
exactly	O
onto	O
their	O
measured	O
images	O
.	O
the	O
solution	B
is	O
obtained	O
by	O
solving	B
ap	O
=	O
0	O
where	O
a	O
is	O
an	O
11	O
×	O
12	O
matrix	B
in	O
this	O
case	O
.	O
in	O
general	O
a	O
will	O
have	O
rank	O
11	O
,	O
and	O
the	O
solution	B
vector	O
p	O
is	O
the	O
1-dimensional	O
right	O
null-space	B
of	O
a.	O
over-determined	B
solution	I
.	O
if	O
the	O
data	O
is	O
not	O
exact	O
,	O
because	O
of	O
noise	O
in	O
the	O
point	B
coordinates	O
,	O
and	O
n	O
≥	O
6	O
point	B
correspondences	O
are	O
given	O
,	O
then	O
there	O
will	O
not	O
be	O
an	O
exact	O
solution	B
to	O
the	O
equations	O
ap	O
=	O
0.	O
as	O
in	O
the	O
estimation	B
of	I
a	O
homography	B
a	O
solution	B
for	O
p	O
may	O
be	O
obtained	O
by	O
minimizing	B
an	O
algebraic	B
or	O
geometric	B
error	I
.	O
in	O
the	O
case	O
of	O
algebraic	O
error	B
the	O
approach	O
is	O
to	O
minimize	O
(	O
cid:10	O
)	O
ap	O
(	O
cid:10	O
)	O
subject	O
to	O
some	O
normalization	B
constraint	O
.	O
possible	O
constraints	B
are	O
(	O
i	O
)	O
(	O
cid:10	O
)	O
p	O
(	O
cid:10	O
)	O
=	O
1	O
;	O
(	O
ii	O
)	O
(	O
cid:10	O
)	O
ˆp3	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
where	O
ˆp3	O
is	O
the	O
vector	O
(	O
p31	O
,	O
p32	O
,	O
p33	O
)	O
t	O
,	O
namely	O
the	O
ﬁrst	O
three	O
entries	O
in	O
the	O
last	O
row	O
of	O
p.	O
the	O
ﬁrst	O
of	O
these	O
is	O
preferred	O
for	O
routine	O
use	O
and	O
will	O
be	O
used	O
for	O
the	O
moment	O
.	O
we	O
will	O
return	O
to	O
the	O
second	O
normalization	B
constraint	O
in	O
section	O
7.2.1.	O
in	O
either	O
case	O
,	O
the	O
residual	B
ap	O
is	O
known	O
as	O
the	O
algebraic	B
error	I
.	O
using	O
these	O
equations	O
,	O
the	O
complete	O
dlt	O
algorithm	B
for	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
proceeds	O
in	O
the	O
same	O
manner	O
as	O
that	O
for	O
h	O
given	O
in	O
algorithm	O
4.1	O
(	O
p91	O
)	O
.	O
degenerate	B
conﬁgurations	I
.	O
analysis	O
of	O
the	O
degenerate	O
conﬁgurations	O
for	O
estimation	O
of	O
p	O
is	O
rather	O
more	O
involved	O
than	O
in	O
the	O
case	O
of	O
the	O
2d	O
homography	B
.	O
there	O
are	O
two	O
types	O
of	O
conﬁgurations	O
in	O
which	O
ambiguous	O
solutions	O
exist	O
for	O
p.	O
these	O
conﬁgurations	O
will	O
be	O
investigated	O
in	O
detail	O
in	O
chapter	O
22.	O
the	O
most	O
important	O
critical	B
conﬁgurations	I
are	O
as	O
follows	O
:	O
(	O
i	O
)	O
the	O
camera	B
and	O
points	O
all	O
lie	O
on	O
a	O
twisted	O
cubic	O
.	O
180	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
(	O
ii	O
)	O
the	O
points	O
all	O
lie	O
on	O
the	O
union	O
of	O
a	O
plane	O
and	O
a	O
single	O
straight	O
line	B
containing	O
the	O
camera	B
centre	I
.	O
for	O
such	O
conﬁgurations	O
,	O
the	O
camera	B
can	O
not	O
be	O
obtained	O
uniquely	O
from	O
the	O
images	O
of	O
the	O
points	O
.	O
instead	O
,	O
it	O
may	O
move	O
arbitrarily	O
along	O
the	O
twisted	B
cubic	I
,	O
or	O
straight	O
line	B
respectively	O
.	O
if	O
data	O
is	O
close	O
to	O
a	O
degenerate	B
conﬁguration	I
then	O
a	O
poor	O
estimate	O
for	O
p	O
is	O
obtained	O
.	O
for	O
example	O
,	O
if	O
the	O
camera	B
is	O
distant	O
from	O
a	O
scene	O
with	O
low	O
relief	O
,	O
such	O
as	O
a	O
near-nadir	O
aerial	O
view	O
,	O
then	O
this	O
situation	O
is	O
close	O
to	O
the	O
planar	O
degeneracy	O
.	O
data	O
normalization	B
.	O
it	O
is	O
important	O
to	O
carry	O
out	O
some	O
sort	O
of	O
data	O
normalization	B
just	O
as	O
in	O
the	O
2d	O
homography	B
estimation	I
case	O
.	O
the	O
points	O
xi	O
in	O
the	O
image	O
are	O
appropriately	O
normalized	O
in	O
the	O
same	O
way	O
as	O
before	O
.	O
namely	O
the	O
points	O
should	O
be	O
translated	O
so	O
that	O
√	O
their	O
centroid	O
is	O
at	O
the	O
origin	O
,	O
and	O
scaled	O
so	O
that	O
their	O
rms	O
(	O
root-mean-squared	O
)	O
dis-	O
tance	O
from	O
the	O
origin	O
is	O
2.	O
what	O
normalization	O
should	O
be	O
applied	O
to	O
the	O
3d	O
points	O
xi	O
is	O
a	O
little	O
more	O
problematical	O
.	O
in	O
the	O
case	O
where	O
the	O
variation	O
in	O
depth	O
of	O
the	O
points	O
from	O
the	O
camera	B
is	O
relatively	O
slight	O
it	O
makes	O
sense	O
to	O
carry	O
out	O
the	O
same	O
sort	O
of	O
normal-	O
ization	O
.	O
thus	O
,	O
the	O
centroid	O
of	O
the	O
points	O
is	O
translated	O
to	O
the	O
origin	O
,	O
and	O
their	O
coordinates	B
are	O
scaled	O
so	O
that	O
the	O
rms	O
distance	B
from	O
the	O
origin	O
is	O
3	O
(	O
so	O
that	O
the	O
“	O
average	O
”	O
point	B
has	O
coordinates	B
of	O
magnitude	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
1	O
)	O
t	O
)	O
.	O
this	O
approach	O
is	O
suitable	O
for	O
a	O
compact	O
distribution	B
of	O
points	O
,	O
such	O
as	O
those	O
on	O
the	O
calibration	B
object	O
of	O
ﬁgure	O
7.1	O
.	O
√	O
in	O
the	O
case	O
where	O
there	O
are	O
some	O
points	O
that	O
lie	O
at	O
a	O
great	O
distance	B
from	O
the	O
camera	B
,	O
the	O
previous	O
normalization	B
technique	O
does	O
not	O
work	O
well	O
.	O
for	O
instance	O
,	O
if	O
there	O
are	O
points	O
close	O
to	O
the	O
camera	B
,	O
as	O
well	O
as	B
points	I
that	O
lie	O
at	B
inﬁnity	I
(	O
which	O
are	O
imaged	O
as	O
vanishing	O
points	O
)	O
or	O
close	O
to	O
inﬁnity	O
,	O
as	O
may	O
occur	O
in	O
oblique	O
views	O
of	O
terrain	O
,	O
then	O
it	O
is	O
not	O
possible	O
or	O
reasonable	O
to	O
translate	O
the	O
points	O
so	O
that	O
their	O
centroid	O
is	O
at	O
the	O
origin	O
.	O
the	O
normalization	B
method	O
described	O
in	O
exercise	O
(	O
iii	O
)	O
on	O
page	O
128	O
would	O
be	O
more	O
appropriately	O
used	O
in	O
such	O
a	O
case	O
,	O
though	O
this	O
has	O
not	O
been	O
thoroughly	O
tested	O
.	O
with	O
appropriate	O
normalization	B
the	O
estimate	O
of	O
p	O
is	O
carried	O
out	O
in	O
the	O
same	O
manner	O
as	O
algorithm	O
4.2	O
(	O
p109	O
)	O
for	O
h.	O
line	B
correspondences	I
.	O
it	O
is	O
a	O
simple	O
matter	O
to	O
extend	O
the	O
dlt	O
algorithm	B
to	O
take	O
account	O
of	O
line	O
correspondences	B
as	O
well	O
.	O
a	O
line	B
in	O
3d	O
may	O
be	O
represented	O
by	O
two	O
points	O
x0	O
and	O
x1	O
through	O
which	O
the	O
line	B
passes	O
.	O
now	O
,	O
according	O
to	O
result	O
8.2	O
(	O
p197	O
)	O
the	O
plane	B
formed	O
by	O
back-projecting	O
from	O
the	O
image	O
line	O
l	O
is	O
equal	O
to	O
ptl	O
.	O
the	O
condition	O
that	O
the	O
point	B
xj	O
lies	O
on	O
this	O
plane	B
is	O
then	O
ltpxj	O
=	O
0	O
for	O
j	O
=	O
0	O
,	O
1	O
.	O
(	O
7.3	O
)	O
each	O
choice	B
of	O
j	O
gives	O
a	O
single	O
linear	O
equation	O
in	O
the	O
entries	O
of	O
the	O
matrix	O
p	O
,	O
so	O
two	O
equations	O
are	O
obtained	O
for	O
each	O
3d	O
to	O
2d	O
line	B
correspondence	O
.	O
these	O
equations	O
,	O
being	O
linear	B
in	O
the	O
entries	O
of	O
p	O
,	O
may	O
be	O
added	O
to	O
the	O
equations	O
(	O
7.1	O
)	O
obtained	O
from	O
point	O
correspondences	O
and	O
a	O
solution	B
to	O
the	O
composite	O
equation	O
set	O
may	O
be	O
computed	O
.	O
as	O
in	O
the	O
case	O
of	O
2d	O
homographies	B
(	O
chapter	O
4	O
)	O
,	O
one	O
may	O
deﬁne	O
geometric	B
error	I
.	O
sup-	O
pose	O
for	O
the	O
moment	O
that	O
world	O
points	O
xi	O
are	O
known	O
far	O
more	O
accurately	O
than	O
the	O
7.2	O
geometric	B
error	I
7.2	O
geometric	B
error	I
181	O
(	O
cid:27	O
)	O
objective	O
given	O
n	O
≥	O
6	O
world	O
to	O
image	O
point	B
correspondences	O
{	O
xi	O
↔	O
xi	O
}	O
,	O
determine	O
the	O
maxi-	O
mum	O
likelihood	O
estimate	O
of	O
the	O
camera	O
projection	B
matrix	O
p	O
,	O
i.e	O
.	O
the	O
p	O
which	O
minimizes	O
i	O
d	O
(	O
xi	O
,	O
pxi	O
)	O
2.	O
algorithm	B
(	O
i	O
)	O
linear	B
solution	I
.	O
compute	O
an	O
initial	O
estimate	O
of	O
p	O
using	O
a	O
linear	B
method	O
such	O
as	O
algorithm	O
4.2	O
(	O
p109	O
)	O
:	O
(	O
a	O
)	O
normalization	B
:	O
use	O
a	O
similarity	B
transformation	I
t	O
to	O
normalize	O
the	O
image	O
points	O
,	O
and	O
a	O
second	O
similarity	B
transformation	I
u	O
to	O
normalize	O
the	O
space	O
points	O
.	O
suppose	O
the	O
normalized	O
image	O
points	O
are	O
˜xi	O
=	O
txi	O
,	O
and	O
the	O
normalized	O
space	O
points	O
are	O
˜xi	O
=	O
uxi	O
.	O
(	O
b	O
)	O
dlt	O
:	O
form	O
the	O
2n	O
×	O
12	O
matrix	B
a	O
by	O
stacking	O
the	O
equations	O
(	O
7.2	O
)	O
generated	O
by	O
each	O
correspondence	B
˜xi	O
↔	O
˜xi	O
.	O
write	O
p	O
for	O
the	O
vector	O
containing	O
the	O
entries	O
of	O
the	O
matrix	O
˜p	O
.	O
a	O
solution	B
of	O
ap	O
=	O
0	O
,	O
subject	O
to	O
(	O
cid:10	O
)	O
p	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
is	O
obtained	O
from	O
the	O
unit	O
singular	O
vector	O
of	O
a	O
corresponding	O
to	O
the	O
smallest	O
singular	O
value	O
.	O
(	O
ii	O
)	O
minimize	O
geometric	B
error	I
.	O
using	O
the	O
linear	B
estimate	O
as	O
a	O
starting	O
point	B
minimize	O
the	O
geometric	B
error	I
(	O
7.4	O
)	O
:	O
(	O
cid:7	O
)	O
i	O
d	O
(	O
˜xi	O
,	O
˜p	O
˜xi	O
)	O
2	O
over	O
˜p	O
,	O
using	O
an	O
iterative	B
algorithm	O
such	O
as	O
levenberg–marquardt	O
.	O
(	O
iii	O
)	O
denormalization	O
.	O
the	O
camera	B
matrix	I
for	O
the	O
original	O
(	O
unnormalized	O
)	O
coordinates	B
is	O
obtained	O
from	O
˜p	O
as	O
p	O
=	O
t−1˜pu	O
.	O
algorithm	B
7.1.	O
the	O
gold	O
standard	O
algorithm	B
for	O
estimating	B
p	O
from	O
world	O
to	O
image	O
point	B
correspon-	O
dences	O
in	O
the	O
case	O
that	O
the	O
world	O
points	O
are	O
very	O
accurately	O
known	O
.	O
measured	O
image	O
points	O
.	O
for	O
example	O
the	O
points	O
xi	O
might	O
arise	O
from	O
an	O
accurately	O
machined	O
calibration	B
object	O
.	O
then	O
the	O
geometric	B
error	I
in	O
the	O
image	O
is	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
(	O
cid:7	O
)	O
i	O
(	O
cid:7	O
)	O
min	O
p	O
i	O
where	O
xi	O
is	O
the	O
measured	O
point	O
and	O
ˆxi	O
is	O
the	O
point	B
pxi	O
,	O
i.e	O
.	O
the	O
point	B
which	O
is	O
the	O
exact	O
image	O
of	O
xi	O
under	O
p.	O
if	O
the	O
measurement	O
errors	O
are	O
gaussian	O
then	O
the	O
solution	B
of	O
d	O
(	O
xi	O
,	O
pxi	O
)	O
2	O
(	O
7.4	O
)	O
is	O
the	O
maximum	O
likelihood	O
estimate	O
of	O
p.	O
just	O
as	O
in	O
the	O
2d	O
homography	B
case	O
,	O
minimizing	B
geometric	I
error	O
requires	O
the	O
use	O
of	O
iterative	B
techniques	O
,	O
such	O
as	O
levenberg–marquardt	O
.	O
a	O
parametrization	B
of	I
p	O
is	O
required	O
,	O
and	O
the	O
vector	O
of	O
matrix	B
elements	O
p	O
provides	O
this	O
.	O
the	O
dlt	O
solution	B
,	O
or	O
a	O
minimal	B
solution	I
,	O
may	O
be	O
used	O
as	O
a	O
starting	O
point	B
for	O
the	O
iterative	B
minimization	I
.	O
the	O
complete	O
gold	O
standard	O
algorithm	B
is	O
summarized	O
in	O
algorithm	O
7.1.	O
example	O
7.1.	O
camera	B
estimation	O
from	O
a	O
calibration	B
object	O
we	O
will	O
compare	O
the	O
dlt	O
algorithm	B
with	O
the	O
gold	O
standard	O
algorithm	B
7.1	O
for	O
data	O
182	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
fig	O
.	O
7.1.	O
an	O
image	O
of	O
a	O
typical	O
calibration	O
object	O
.	O
the	O
black	O
and	O
white	O
checkerboard	O
pattern	O
(	O
a	O
“	O
tsai	O
grid	O
”	O
)	O
is	O
designed	O
to	O
enable	O
the	O
positions	O
of	O
the	O
corners	O
of	O
the	O
imaged	O
squares	O
to	O
be	O
obtained	O
to	O
high	O
accuracy	O
.	O
a	O
total	O
of	O
197	O
points	O
were	O
identiﬁed	O
and	O
used	O
to	O
calibrate	O
the	O
camera	B
in	O
the	O
examples	B
of	O
this	O
chapter	O
.	O
fy	O
fx/fy	O
skew	O
x0	O
y0	O
residual	B
linear	O
iterative	B
1673.3	O
1675.5	O
1.0063	O
1.0063	O
1.39	O
1.43	O
379.96	O
379.79	O
305.78	O
305.25	O
0.365	O
0.364	O
table	O
7.1.	O
dlt	O
and	O
gold	O
standard	O
calibration	B
.	O
from	O
the	O
calibration	B
object	O
shown	O
in	O
ﬁgure	O
7.1.	O
the	O
image	O
points	O
xi	O
are	O
obtained	O
from	O
the	O
calibration	B
object	O
using	O
the	O
following	O
steps	O
:	O
(	O
i	O
)	O
canny	O
edge	O
detection	O
[	O
canny-86	O
]	O
.	O
(	O
ii	O
)	O
straight	O
line	B
ﬁtting	O
to	O
the	O
detected	O
linked	O
edges	O
.	O
(	O
iii	O
)	O
intersecting	O
the	O
lines	B
to	O
obtain	O
the	O
imaged	O
corners	O
.	O
if	O
sufﬁcient	O
care	O
is	O
taken	O
the	O
points	O
xi	O
are	O
obtained	O
to	O
a	O
localization	O
accuracy	O
of	O
far	O
better	O
than	O
1/10	O
of	O
a	O
pixel	O
.	O
a	O
rule	O
of	O
thumb	O
is	O
that	O
for	O
a	O
good	O
estimation	B
the	O
number	O
of	O
constraints	O
(	O
point	B
measurements	O
)	O
should	O
exceed	O
the	O
number	O
of	O
unknowns	O
(	O
the	O
11	O
camera	B
parameters	I
)	O
by	O
a	O
factor	O
of	O
ﬁve	O
.	O
this	O
means	O
that	O
at	O
least	O
28	O
points	O
should	O
be	O
used	O
.	O
table	O
7.1	O
shows	O
the	O
calibration	B
results	O
obtained	O
by	O
using	O
the	O
linear	B
dlt	O
method	O
and	O
the	O
gold	O
standard	O
method	O
.	O
note	O
that	O
the	O
improvement	O
achieved	O
using	O
the	O
gold	O
standard	O
algorithm	B
is	O
very	O
slight	O
.	O
the	O
difference	O
of	O
residual	O
of	O
one	O
thousandth	O
of	O
a	O
(	O
cid:2	O
)	O
pixel	O
is	O
insigniﬁcant	O
.	O
errors	O
in	O
the	O
world	O
points	O
it	O
may	O
be	O
the	O
case	O
that	O
world	O
points	O
are	O
not	O
measured	O
with	O
“	O
inﬁnite	O
”	O
accuracy	O
.	O
in	O
this	O
case	O
one	O
may	O
choose	O
to	O
estimate	O
p	O
by	O
minimizing	B
a	O
3d	O
geometric	B
error	I
,	O
or	O
an	O
image	O
geometric	O
error	B
,	O
or	O
both	O
.	O
if	O
only	O
errors	O
in	O
the	O
world	O
points	O
are	O
considered	O
then	O
the	O
3d	O
geometric	B
error	I
is	O
de-	O
ﬁned	O
as	O
(	O
cid:7	O
)	O
i	O
d	O
(	O
xi	O
,	O
(	O
cid:23	O
)	O
xi	O
)	O
2	O
7.2	O
geometric	B
error	I
183	O
c	O
x	O
i	O
f	O
d	O
/	O
x	O
i	O
x	O
i	O
∆	O
w	O
fig	O
.	O
7.2.	O
the	O
dlt	O
algorithm	B
minimizes	O
the	O
sum	O
of	O
squares	O
of	O
geometric	O
distance	B
∆	O
between	O
the	O
point	B
xi	O
and	O
the	O
point	B
x	O
(	O
cid:1	O
)	O
i	O
mapping	O
exactly	O
onto	O
xi	O
and	O
lying	O
in	O
the	O
plane	B
through	O
xi	O
parallel	B
to	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
.	O
a	O
short	O
calculation	O
shows	O
that	O
wd	O
=	O
f∆	O
.	O
where	O
(	O
cid:23	O
)	O
xi	O
is	O
the	O
closest	O
point	B
in	O
space	O
to	O
xi	O
that	O
maps	O
exactly	O
onto	O
xi	O
via	O
xi	O
=	O
p	O
(	O
cid:23	O
)	O
xi	O
.	O
this	O
requires	O
that	O
one	O
augment	O
the	O
set	O
of	O
parameters	O
by	O
including	O
parameters	B
(	O
cid:23	O
)	O
xi	O
,	O
the	O
more	O
generally	O
,	O
if	O
errors	O
in	O
both	O
the	O
world	O
and	O
image	O
points	O
are	O
considered	O
,	O
then	O
a	O
weighted	B
sum	O
of	O
world	O
and	O
image	O
errors	O
is	O
minimized	O
.	O
as	O
in	O
the	O
2d	O
homography	B
case	O
,	O
estimated	O
3d	O
points	O
.	O
one	O
minimizes	O
n	O
(	O
cid:7	O
)	O
dmah	O
(	O
xi	O
,	O
p	O
(	O
cid:23	O
)	O
xi	O
)	O
2	O
+	O
dmah	O
(	O
xi	O
,	O
(	O
cid:23	O
)	O
xi	O
)	O
2	O
i=1	O
where	O
dmah	O
represents	O
mahalanobis	O
distance	B
with	O
respect	O
to	O
the	O
known	O
error	O
covari-	O
ance	O
matrices	O
for	O
each	O
of	O
the	O
measurements	O
xi	O
and	O
xi	O
.	O
in	O
the	O
simplest	O
case	O
,	O
the	O
maha-	O
lanobis	O
distance	B
is	O
simply	O
a	O
weighted	B
geometric	O
distance	B
,	O
where	O
the	O
weights	O
are	O
chosen	O
to	O
reﬂect	O
the	O
relative	O
accuracy	O
of	O
measurements	O
of	O
the	O
image	O
and	O
3d	O
points	O
,	O
and	O
also	O
the	O
fact	O
that	O
image	O
and	O
world	O
points	O
are	O
typically	O
measured	O
in	O
different	O
units	O
.	O
7.2.1	O
geometric	B
interpretation	I
of	O
algebraic	B
error	I
suppose	O
all	O
the	O
points	O
xi	O
in	O
the	O
dlt	O
algorithm	B
are	O
normalized	O
such	O
that	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
zi	O
,	O
1	O
)	O
t	O
,	O
and	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
t.	O
in	O
this	O
case	O
,	O
it	O
was	O
seen	O
in	O
section	O
4.2.4-	O
i	O
(	O
ˆwid	O
(	O
xi	O
,	O
ˆxi	O
)	O
)	O
2	O
,	O
(	O
p95	O
)	O
that	O
the	O
quantity	O
being	O
minimized	O
by	O
the	O
dlt	O
algorithm	B
is	O
where	O
ˆwi	O
(	O
ˆxi	O
,	O
ˆyi	O
,	O
1	O
)	O
t	O
=	O
pxi	O
.	O
however	O
,	O
according	O
to	O
(	O
6.15–p162	O
)	O
,	O
(	O
cid:27	O
)	O
ˆwi	O
=	O
±	O
(	O
cid:10	O
)	O
ˆp3	O
(	O
cid:10	O
)	O
depth	O
(	O
x	O
;	O
p	O
)	O
.	O
thus	O
,	O
the	O
value	O
ˆwi	O
may	O
be	O
interpreted	O
as	O
the	O
depth	O
of	O
the	O
point	B
xi	O
from	O
the	O
camera	B
in	O
the	O
direction	O
along	O
the	O
principal	O
ray	O
,	O
provided	O
the	O
camera	B
is	O
normalized	O
so	O
that	O
(	O
cid:10	O
)	O
ˆp3	O
(	O
cid:10	O
)	O
2	O
=	O
33	O
=	O
1.	O
referring	O
to	O
ﬁgure	O
7.2	O
one	O
sees	O
that	O
ˆwid	O
(	O
xi	O
,	O
ˆxi	O
)	O
is	O
proportional	O
to	O
p2	O
31	O
+	O
p2	O
f	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
is	O
a	O
point	B
mapping	O
to	O
xi	O
and	O
lying	O
in	O
a	O
plane	B
through	O
xi	O
parallel	B
to	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
.	O
thus	O
,	O
the	O
algebraic	B
error	I
being	O
minimized	O
is	O
equal	O
to	O
f	O
32	O
+	O
p2	O
,	O
x	O
)	O
,	O
where	O
f	O
is	O
the	O
focal	B
length	I
and	O
x	O
(	O
cid:2	O
)	O
i	O
)	O
is	O
the	O
correction	B
that	O
needs	O
to	O
be	O
made	O
to	O
the	O
measured	O
3d	O
points	O
in	O
order	O
to	O
correspond	O
precisely	O
with	O
the	O
measured	O
image	O
points	O
xi	O
.	O
the	O
restric-	O
tion	O
is	O
that	O
the	O
correction	B
must	O
be	O
made	O
in	O
the	O
direction	O
perpendicular	O
to	O
the	O
principal	O
axis	O
of	O
the	O
camera	B
.	O
because	O
of	O
this	O
restriction	O
,	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
i	O
is	O
not	O
the	O
same	O
as	O
the	O
clos-	O
the	O
distance	B
d	O
(	O
xi	O
,	O
x	O
(	O
cid:2	O
)	O
est	O
point	B
(	O
cid:23	O
)	O
xi	O
to	O
xi	O
that	O
maps	O
to	O
xi	O
.	O
however	O
,	O
for	O
points	O
xi	O
not	O
too	O
far	O
from	O
the	O
principal	O
i	O
d	O
(	O
xi	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:27	O
)	O
i	O
)	O
2	O
.	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
i	O
)	O
is	O
a	O
reasonable	O
approximation	O
to	O
the	O
distance	B
184	O
d	O
(	O
xi	O
,	O
(	O
cid:23	O
)	O
xi	O
)	O
.	O
the	O
dlt	O
slightly	O
weights	O
the	O
points	O
farther	O
away	O
from	O
the	O
principal	O
ray	O
by	O
ray	O
of	O
the	O
camera	O
,	O
the	O
distance	B
d	O
(	O
xi	O
,	O
x	O
(	O
cid:2	O
)	O
i	O
)	O
,	O
which	O
is	O
slightly	O
larger	O
than	O
d	O
(	O
xi	O
,	O
(	O
cid:23	O
)	O
xi	O
)	O
.	O
in	O
minimizing	O
the	O
squared	O
sum	O
of	O
d	O
(	O
xi	O
,	O
x	O
(	O
cid:2	O
)	O
addition	O
,	O
the	O
presence	O
of	O
the	O
focal	O
length	O
f	O
in	O
the	O
expression	O
for	O
algebraic	O
error	B
sug-	O
gests	O
that	O
the	O
dlt	O
algorithm	B
will	O
be	O
biased	O
towards	O
minimizing	B
focal	O
length	O
at	O
a	O
cost	O
of	O
a	O
slight	O
increase	O
in	O
3d	O
geometric	B
error	I
.	O
transformation	B
invariance	I
.	O
we	O
have	O
just	O
seen	O
that	O
by	O
minimizing	B
(	O
cid:10	O
)	O
ap	O
(	O
cid:10	O
)	O
subject	O
to	O
the	O
constraint	O
(	O
cid:10	O
)	O
ˆp3	O
(	O
cid:10	O
)	O
=	O
1	O
one	O
may	O
interpret	O
the	O
solution	B
in	O
terms	O
of	O
minimizing	O
3d	O
geometric	B
distances	O
.	O
such	O
an	O
interpretation	O
is	O
not	O
affected	O
by	O
similarity	B
transformations	O
in	O
either	O
3d	O
space	O
or	O
the	O
image	O
space	O
.	O
thus	O
,	O
one	O
is	O
led	O
to	O
expect	O
that	O
carrying	O
out	O
translation	O
and	O
scaling	B
of	O
the	O
data	O
,	O
either	O
in	O
the	O
image	O
or	O
in	O
3d	O
point	B
coordinates	O
,	O
will	O
not	O
have	O
any	O
effect	O
on	O
the	O
solutions	O
.	O
this	O
is	O
indeed	O
the	O
case	O
as	O
may	O
be	O
shown	O
using	O
the	O
arguments	O
of	O
section	O
4.4.2	O
(	O
p105	O
)	O
.	O
7.2.2	O
estimation	B
of	I
an	O
afﬁne	B
camera	I
the	O
methods	O
developed	O
above	O
for	O
the	O
projective	B
cameras	O
can	O
be	O
applied	O
directly	O
to	O
afﬁne	O
cameras	B
.	O
an	O
afﬁne	B
camera	I
is	O
one	O
for	O
which	O
the	O
projection	B
matrix	O
has	O
last	O
row	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
in	O
the	O
dlt	O
estimation	B
of	I
the	O
camera	B
in	O
this	O
case	O
one	O
minimizes	O
(	O
cid:10	O
)	O
ap	O
(	O
cid:10	O
)	O
sub-	O
ject	O
to	O
this	O
condition	O
on	O
the	O
last	O
row	O
of	O
p.	O
as	O
in	O
the	O
case	O
of	O
computing	O
2d	O
afﬁne	B
trans-	O
formations	O
,	O
for	B
afﬁne	I
cameras	I
,	O
algebraic	B
error	I
and	O
geometric	B
image	O
error	B
are	O
equal	O
.	O
this	O
means	O
that	O
geometric	B
image	O
distances	O
may	O
be	O
minimized	O
by	O
a	O
linear	B
algorithm	I
.	O
suppose	O
as	O
above	O
that	O
all	O
the	O
points	O
xi	O
are	O
normalized	O
such	O
that	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
zi	O
,	O
1	O
)	O
t	O
,	O
and	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
t	O
,	O
and	O
also	O
that	O
the	O
last	O
row	O
of	O
p	O
has	O
the	O
afﬁne	B
form	O
.	O
then	O
(	O
7.2	O
)	O
for	O
a	O
single	O
correspondence	B
reduces	O
to	O
0t	O
−xt	O
i	O
0t	O
xt	O
i	O
(	O
cid:18	O
)	O
(	O
cid:20	O
)	O
p1	O
p2	O
(	O
7.5	O
)	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:17	O
)	O
+	O
which	O
shows	O
that	O
the	O
squared	O
algebraic	O
error	O
in	O
this	O
case	O
equals	O
the	O
squared	O
geometric	O
error	B
(	O
cid:15	O
)	O
xi	O
−	O
p1txi	O
(	O
cid:16	O
)	O
2	O
+	O
(	O
cid:15	O
)	O
yi	O
−	O
p2txi	O
(	O
cid:7	O
)	O
i	O
(	O
cid:10	O
)	O
ap	O
(	O
cid:10	O
)	O
2	O
=	O
yi−xi	O
(	O
cid:16	O
)	O
=	O
0	O
(	O
cid:7	O
)	O
2	O
=	O
i	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2.	O
this	O
result	O
may	O
also	O
be	O
seen	O
geometrically	O
by	O
comparison	O
of	O
ﬁgure	O
6.8	O
(	O
p170	O
)	O
and	O
ﬁgure	O
7.2.	O
a	O
linear	B
estimation	O
algorithm	B
for	O
an	O
afﬁne	B
camera	I
which	O
minimizes	O
geometric	B
error	I
is	O
given	O
in	O
algorithm	O
7.2.	O
under	O
the	O
assumption	O
of	O
gaussian	O
measurement	O
errors	O
this	O
is	O
the	O
maximum	O
likelihood	O
estimate	O
of	O
pa.	O
7.3	O
restricted	O
camera	B
estimation	O
the	O
dlt	O
algorithm	B
,	O
as	O
it	O
has	O
so	O
far	O
been	O
described	O
,	O
computes	O
a	O
general	B
projective	I
camera	O
matrix	B
p	O
from	O
a	O
set	O
of	O
3d	O
to	O
2d	O
point	B
correspondences	O
.	O
the	O
matrix	B
p	O
with	O
centre	O
at	O
a	O
ﬁnite	B
point	O
may	O
be	O
decomposed	O
as	O
p	O
=	O
k	O
[	O
r	O
|	O
−r	O
(	O
cid:22	O
)	O
c	O
]	O
where	O
r	O
is	O
a	O
3	O
×	O
3	O
7.3	O
restricted	O
camera	B
estimation	O
185	O
(	O
cid:27	O
)	O
objective	O
given	O
n	O
≥	O
4	O
world	O
to	O
image	O
point	B
correspondences	O
{	O
xi	O
↔	O
xi	O
}	O
,	O
determine	O
the	O
maximum	O
likelihood	O
estimate	O
of	O
the	O
afﬁne	O
camera	B
projection	O
matrix	B
pa	O
,	O
i.e	O
.	O
the	O
camera	B
p	O
which	O
mini-	O
mizes	O
i	O
d	O
(	O
xi	O
,	O
pxi	O
)	O
2	O
subject	O
to	O
the	O
afﬁne	B
constraint	O
p3t	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
algorithm	B
(	O
i	O
)	O
normalization	B
:	O
use	O
a	O
similarity	B
transformation	I
t	O
to	O
normalize	O
the	O
image	O
points	O
,	O
and	O
a	O
second	O
similarity	B
transformation	I
u	O
to	O
normalize	O
the	O
space	O
points	O
.	O
suppose	O
the	O
normal-	O
ized	O
image	O
points	O
are	O
˜xi	O
=	O
txi	O
,	O
and	O
the	O
normalized	O
space	O
points	O
are	O
˜xi	O
=	O
uxi	O
,	O
with	O
unit	O
last	O
component	O
.	O
(	O
cid:29	O
)	O
(	O
ii	O
)	O
each	O
correspondence	B
˜xi	O
↔	O
˜xi	O
contributes	O
(	O
from	O
(	O
7.5	O
)	O
)	O
equations	O
(	O
cid:18	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:28	O
)	O
(	O
cid:17	O
)	O
˜xt	O
i	O
0t	O
0t	O
˜xt	O
i	O
˜p1	O
˜p2	O
=	O
˜xi	O
˜yi	O
which	O
are	O
stacked	O
into	O
a	O
2n	O
×	O
8	O
matrix	B
equation	O
a8p8	O
=	O
b	O
,	O
where	O
p8	O
is	O
the	O
8-vector	O
containing	O
the	O
ﬁrst	O
two	O
rows	O
of	O
˜pa	O
.	O
(	O
iii	O
)	O
the	O
solution	B
is	O
obtained	O
by	O
the	O
pseudo-inverse	B
of	O
a8	O
(	O
see	O
section	O
a5.2	O
(	O
p590	O
)	O
)	O
(	O
iv	O
)	O
denormalization	O
:	O
the	O
camera	B
matrix	I
for	O
the	O
original	O
(	O
unnormalized	O
)	O
coordinates	B
is	O
and	O
˜p3t	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
obtained	O
from	O
˜pa	O
as	O
8	O
b	O
p8	O
=	O
a+	O
pa	O
=	O
t−1˜pau	O
algorithm	B
7.2.	O
the	O
gold	O
standard	O
algorithm	B
for	O
estimating	B
an	O
afﬁne	B
camera	I
matrix	O
pa	O
from	O
world	O
to	O
image	O
correspondences	B
.	O
rotation	B
matrix	O
and	O
k	O
has	O
the	O
form	O
(	O
6.10–p157	O
)	O
:	O
	O
αx	O
k	O
=	O
s	O
x0	O
αy	O
y0	O
1	O
	O
.	O
(	O
7.6	O
)	O
the	O
non-zero	O
entries	O
of	O
k	O
are	O
geometrically	O
meaningful	O
quantities	O
,	O
the	O
internal	B
cali-	O
bration	O
parameters	B
of	O
p.	O
one	O
may	O
wish	O
to	O
ﬁnd	O
the	O
best-ﬁt	O
camera	B
matrix	I
p	O
subject	O
to	O
restrictive	O
conditions	O
on	O
the	O
camera	B
parameters	I
.	O
common	O
assumptions	O
are	O
(	O
i	O
)	O
the	O
skew	O
s	O
is	O
zero	O
.	O
(	O
ii	O
)	O
the	O
pixels	O
are	O
square	O
:	O
αx	O
=	O
αy	O
.	O
(	O
iii	O
)	O
the	O
principal	B
point	I
(	O
x0	O
,	O
y0	O
)	O
is	O
known	O
.	O
(	O
iv	O
)	O
the	O
complete	O
camera	B
calibration	I
matrix	O
k	O
is	O
known	O
.	O
in	O
some	O
cases	O
it	O
is	O
possible	O
to	O
estimate	O
a	O
restricted	O
camera	B
matrix	I
with	O
a	O
linear	B
algo-	O
rithm	O
(	O
see	O
the	O
exercises	O
at	O
the	O
end	O
of	O
the	O
chapter	O
)	O
.	O
as	O
an	O
example	O
of	O
restricted	O
estimation	B
,	O
suppose	O
that	O
we	O
wish	O
to	O
ﬁnd	O
the	O
best	O
pinhole	O
camera	O
model	B
(	O
that	O
is	O
projective	B
camera	I
with	O
s	O
=	O
0	O
and	O
αx	O
=	O
αy	O
)	O
that	O
ﬁts	O
a	O
set	O
of	O
point	O
measurements	O
.	O
this	O
problem	O
may	O
be	O
solved	O
by	O
minimizing	B
either	O
geometric	B
or	O
algebraic	B
error	I
,	O
as	O
will	O
be	O
discussed	O
next	O
.	O
186	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
minimizing	B
geometric	I
error	O
.	O
to	O
minimize	O
geometric	B
error	I
,	O
one	O
selects	O
a	O
set	O
of	O
pa-	O
rameters	O
that	O
characterize	O
the	O
camera	B
matrix	I
to	O
be	O
computed	O
.	O
for	O
instance	O
,	O
suppose	O
we	O
wish	O
to	O
enforce	O
the	O
constraints	B
s	O
=	O
0	O
and	O
αx	O
=	O
αy	O
.	O
one	O
can	O
parametrize	O
the	O
camera	B
matrix	I
using	O
the	O
remaining	O
9	O
parameters	B
.	O
these	O
are	O
x0	O
,	O
y0	O
,	O
α	O
,	O
plus	O
6	O
parameters	B
rep-	O
resenting	O
the	O
orientation	B
r	O
and	O
location	O
(	O
cid:22	O
)	O
c	O
of	O
the	O
camera	O
.	O
let	O
this	O
set	O
of	O
parameters	O
be	O
denoted	O
collectively	O
by	O
q.	O
the	O
camera	B
matrix	I
p	O
may	O
then	O
be	O
explicitly	O
computed	O
in	O
terms	O
of	O
the	O
parameters	O
.	O
the	O
geometric	B
error	I
may	O
then	O
be	O
minimized	O
with	O
respect	O
to	O
the	O
set	O
of	O
parameters	O
using	O
iterative	O
minimization	B
(	O
such	O
as	O
levenberg–marquardt	O
)	O
.	O
note	O
that	O
in	O
the	O
case	O
of	O
minimization	O
of	O
image	O
error	B
only	O
,	O
the	O
size	O
of	O
the	O
minimization	B
problem	O
is	O
9	O
×	O
2n	O
(	O
supposing	O
9	O
unknown	O
camera	B
parameters	I
)	O
.	O
in	O
other	O
words	O
the	O
lm	O
minimization	B
is	O
minimizing	B
a	O
function	O
f	O
:	O
ir9	O
→	O
ir2n	O
.	O
in	O
the	O
case	O
of	O
minimization	O
of	O
3d	O
and	O
2d	O
error	B
,	O
the	O
function	O
f	O
is	O
from	O
ir3n+9	O
→	O
ir5n	O
,	O
since	O
the	O
3d	O
points	O
must	O
be	O
included	O
among	O
the	O
measurements	O
and	O
minimization	B
also	O
includes	O
estimation	B
of	I
the	O
true	O
positions	O
of	O
the	O
3d	O
points	O
.	O
minimizing	B
algebraic	I
error	O
.	O
it	O
is	O
possible	O
to	O
minimize	O
algebraic	B
error	I
instead	O
,	O
in	O
which	O
case	O
the	O
iterative	B
minimization	I
problem	O
becomes	O
much	O
smaller	O
,	O
as	O
will	O
be	O
ex-	O
plained	O
next	O
.	O
consider	O
the	O
parametrization	B
map	O
taking	O
a	O
set	O
of	O
parameters	O
q	O
to	O
the	O
corresponding	O
camera	B
matrix	I
p	O
=	O
k	O
[	O
r	O
|	O
−r	O
(	O
cid:22	O
)	O
c	O
]	O
.	O
let	O
this	O
map	O
be	O
denoted	O
by	O
g.	O
ef-	O
fectively	O
,	O
one	O
has	O
a	O
map	O
p	O
=	O
g	O
(	O
q	O
)	O
,	O
where	O
p	O
is	O
the	O
vector	O
of	O
entries	O
of	O
the	O
matrix	O
p.	O
minimizing	B
algebraic	I
error	O
over	O
all	O
point	B
matches	O
is	O
equivalent	B
to	O
minimizing	B
(	O
cid:10	O
)	O
ag	O
(	O
q	O
)	O
(	O
cid:10	O
)	O
.	O
in	O
general	O
,	O
the	O
2n	O
×	O
12	O
matrix	B
a	O
may	O
have	O
a	O
the	O
reduced	B
measurement	I
matrix	I
.	O
very	O
large	O
number	O
of	O
rows	O
.	O
it	O
is	O
possible	O
to	O
replace	O
a	O
by	O
a	O
square	O
12×	O
12	O
matrix	B
ˆa	O
such	O
that	O
(	O
cid:10	O
)	O
ap	O
(	O
cid:10	O
)	O
=	O
ptatap	O
=	O
(	O
cid:10	O
)	O
ˆap	O
(	O
cid:10	O
)	O
for	O
any	O
vector	O
p.	O
such	O
a	O
matrix	B
ˆa	O
is	O
called	O
a	O
reduced	B
measurement	I
matrix	I
.	O
one	O
way	O
to	O
do	O
this	O
is	O
using	O
the	O
singular	O
value	O
decomposition	B
(	O
svd	O
)	O
.	O
let	O
a	O
=	O
udvt	O
be	O
the	O
svd	O
of	O
a	O
,	O
and	O
deﬁne	O
ˆa	O
=	O
dvt	O
.	O
then	O
ata	O
=	O
(	O
vdut	O
)	O
(	O
udvt	O
)	O
=	O
(	O
vd	O
)	O
(	O
dvt	O
)	O
=	O
ˆa	O
tˆa	O
as	O
required	O
.	O
another	O
way	O
of	O
obtaining	O
ˆa	O
is	O
to	O
use	O
the	O
qr	O
decomposition	B
a	O
=	O
qˆa	O
,	O
where	O
q	O
has	O
orthogonal	B
columns	O
and	O
ˆa	O
is	O
upper	O
triangular	O
and	O
square	O
.	O
note	O
that	O
the	O
mapping	O
q	O
(	O
cid:6	O
)	O
→	O
ˆag	O
(	O
q	O
)	O
is	O
a	O
mapping	O
from	O
ir9	O
to	O
ir12	O
.	O
this	O
is	O
a	O
simple	O
parameter-minimization	O
problem	O
that	O
may	O
be	O
solved	O
using	O
the	O
levenberg–marquardt	O
method	O
.	O
the	O
important	O
point	B
to	O
note	O
is	O
the	O
following	O
:	O
•	O
given	O
a	O
set	O
of	O
n	O
world	O
to	O
image	O
correspondences	B
,	O
xi	O
↔	O
xi	O
,	O
the	O
problem	O
of	O
ﬁnd-	O
(	O
cid:27	O
)	O
ing	O
a	O
constrained	O
camera	B
matrix	I
p	O
that	O
minimizes	O
the	O
sum	O
of	O
algebraic	O
distances	O
i	O
dalg	O
(	O
xi	O
,	O
pxi	O
)	O
2	O
reduces	O
to	O
the	O
minimization	B
of	O
a	O
function	O
ir9	O
→	O
ir12	O
,	O
independent	O
of	O
the	O
number	O
n	O
of	O
correspondences	O
.	O
p	O
=	O
k	O
[	O
r	O
|	O
−r	O
(	O
cid:22	O
)	O
c	O
]	O
with	O
k	O
as	O
in	O
(	O
7.6	O
)	O
then	O
p	O
satisﬁes	O
the	O
condition	O
p2	O
minimization	B
of	O
(	O
cid:10	O
)	O
ˆag	O
(	O
q	O
)	O
(	O
cid:10	O
)	O
takes	O
place	O
over	O
all	O
values	O
of	O
the	O
parameters	O
q.	O
note	O
that	O
if	O
33	O
=	O
1	O
,	O
since	O
these	O
entries	O
are	O
the	O
same	O
as	O
the	O
last	O
row	O
of	O
the	O
rotation	B
matrix	O
r.	O
thus	O
,	O
minimizing	B
ag	O
(	O
q	O
)	O
will	O
lead	O
to	O
a	O
matrix	B
p	O
satisfying	O
the	O
constraints	B
s	O
=	O
0	O
and	O
αx	O
=	O
αy	O
and	O
scaled	O
32	O
+p2	O
31+p2	O
7.3	O
restricted	O
camera	B
estimation	O
187	O
such	O
that	O
p2	O
all	O
point	B
correspondences	O
.	O
32	O
+	O
p2	O
31	O
+	O
p2	O
33	O
=	O
1	O
,	O
and	O
which	O
in	O
addition	O
minimizes	O
the	O
algebraic	B
error	I
for	O
initialization	B
.	O
one	O
way	O
of	O
ﬁnding	O
camera	B
parameters	I
to	O
initialize	O
the	O
iteration	B
is	O
as	O
follows	O
.	O
(	O
i	O
)	O
use	O
a	O
linear	B
algorithm	I
such	O
as	O
dlt	O
to	O
ﬁnd	O
an	O
initial	O
camera	O
matrix	B
.	O
(	O
ii	O
)	O
clamp	O
ﬁxed	O
parameters	O
to	O
their	O
desired	O
values	O
(	O
for	O
instance	O
set	O
s	O
=	O
0	O
and	O
set	O
αx	O
=	O
αy	O
to	O
the	O
average	O
of	O
their	O
values	O
obtained	O
using	O
dlt	O
)	O
.	O
(	O
iii	O
)	O
set	O
variable	O
parameters	B
to	O
their	O
values	O
obtained	O
by	O
decomposition	B
of	I
the	O
initial	O
camera	O
matrix	B
(	O
see	O
section	O
6.2.4	O
)	O
.	O
ideally	O
,	O
the	O
assumed	O
values	O
of	O
the	O
ﬁxed	O
parameters	B
will	O
be	O
close	O
to	O
the	O
values	O
ob-	O
tained	O
by	O
the	O
dlt	O
.	O
however	O
,	O
in	O
practice	O
this	O
is	O
not	O
always	O
the	O
case	O
.	O
then	O
altering	O
these	O
parameters	B
to	O
their	O
desired	O
values	O
results	O
in	O
an	O
incorrect	O
initial	O
camera	O
matrix	B
that	O
may	O
lead	O
to	O
large	O
residuals	B
,	O
and	O
difﬁculty	O
in	O
converging	O
.	O
a	O
method	O
which	O
works	O
better	O
in	O
practice	O
is	O
to	O
use	O
soft	O
constraints	B
by	O
adding	O
extra	O
terms	O
to	O
the	O
cost	B
function	I
.	O
thus	O
,	O
for	O
the	O
case	O
where	O
s	O
=	O
0	O
and	O
αx	O
=	O
αy	O
,	O
one	O
adds	O
extra	O
terms	O
ws2	O
+	O
w	O
(	O
αx	O
−	O
αy	O
)	O
2	O
to	O
the	O
cost	B
function	I
.	O
in	O
the	O
case	O
of	O
geometric	O
image	O
error	O
,	O
the	O
cost	B
function	I
becomes	O
(	O
cid:7	O
)	O
d	O
(	O
xi	O
,	O
pxi	O
)	O
2	O
+	O
ws2	O
+	O
w	O
(	O
αx	O
−	O
αy	O
)	O
2	O
.	O
i	O
one	O
begins	O
with	O
the	O
values	O
of	O
the	O
parameters	O
estimated	O
using	O
the	O
dlt	O
.	O
the	O
weights	O
begin	O
with	O
low	O
values	O
and	O
are	O
increased	O
at	O
each	O
iteration	B
of	O
the	O
estimation	B
procedure	O
.	O
thus	O
,	O
the	O
values	O
of	O
s	O
and	O
the	O
aspect	O
ratio	O
are	O
drawn	O
gently	O
to	O
their	O
desired	O
values	O
.	O
finally	O
they	O
may	O
be	O
clamped	O
to	O
their	O
desired	O
values	O
for	O
a	O
ﬁnal	O
estimation	B
.	O
exterior	B
orientation	I
.	O
suppose	O
that	O
all	O
the	O
internal	B
parameters	I
of	O
the	O
camera	B
are	O
known	O
,	O
then	O
all	O
that	O
remains	O
to	O
be	O
determined	O
are	O
the	O
position	O
and	O
orientation	B
(	O
or	O
pose	O
)	O
of	O
the	O
camera	O
.	O
this	O
is	O
the	O
“	O
exterior	B
orientation	I
”	O
problem	O
,	O
which	O
is	O
important	O
in	O
the	O
analysis	O
of	O
calibrated	O
systems	O
.	O
to	O
compute	O
the	O
exterior	B
orientation	I
a	O
conﬁguration	O
with	O
accurately	O
known	O
position	O
in	O
a	O
world	O
coordinate	O
frame	O
is	O
imaged	O
.	O
the	O
pose	O
of	O
the	O
camera	O
is	O
then	O
sought	O
.	O
such	O
a	O
situation	O
arises	O
in	O
hand–eye	O
calibration	B
for	O
robotic	O
systems	O
,	O
where	O
the	O
position	O
of	O
the	O
camera	O
is	O
required	O
,	O
and	O
also	O
in	O
model-based	O
recognition	O
using	O
alignment	O
where	O
the	O
position	O
of	O
an	O
object	O
relative	O
to	O
the	O
camera	B
is	O
required	O
.	O
there	O
are	O
six	O
parameters	B
that	O
must	O
be	O
determined	O
,	O
three	O
for	O
the	O
orientation	B
and	O
three	O
for	O
the	O
position	O
.	O
as	O
each	O
world	O
to	O
image	O
point	B
correspondence	O
generates	O
two	O
con-	O
straints	O
it	O
would	O
be	O
expected	O
that	O
three	O
points	O
are	O
sufﬁcient	O
.	O
this	O
is	O
indeed	O
the	O
case	O
,	O
and	O
the	O
resulting	O
non-linear	B
equations	O
have	O
four	B
solutions	I
in	O
general	O
.	O
experimental	B
evaluation	I
results	O
of	O
constrained	O
estimation	O
for	O
the	O
calibration	B
grid	O
of	O
example	O
7.1	O
are	O
given	O
in	O
table	O
7.2.	O
both	O
the	O
algebraic	B
and	O
geometric	B
minimization	I
involve	O
an	O
iterative	B
minimization	I
188	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
fy	O
fx/fy	O
skew	O
x0	O
y0	O
residual	B
algebraic	O
geometric	B
1633.4	O
1637.2	O
1.0	O
1.0	O
0.0	O
0.0	O
371.21	O
371.32	O
293.63	O
293.69	O
0.601	O
0.601	O
table	O
7.2.	O
calibration	B
for	O
a	O
restricted	O
camera	B
matrix	I
.	O
over	O
9	O
parameters	B
.	O
however	O
,	O
the	O
algebraic	B
method	O
is	O
far	O
quicker	O
,	O
since	O
it	O
minimizes	O
only	O
12	O
errors	O
,	O
instead	O
of	O
2n	O
=	O
396	O
in	O
the	O
geometric	B
minimization	I
.	O
note	O
that	O
ﬁxing	O
skew	O
and	O
aspect	O
ratio	O
has	O
altered	O
the	O
values	O
of	O
the	O
other	O
parameters	B
(	O
compare	O
table	O
7.1	O
)	O
and	O
increased	O
the	O
residual	B
.	O
covariance	B
estimation	I
.	O
the	O
techniques	O
of	O
covariance	O
estimation	B
and	O
propagation	O
of	O
the	O
errors	O
into	O
an	O
image	O
may	O
be	O
handled	O
in	O
just	O
the	O
same	O
way	O
as	O
in	O
the	O
2d	O
homography	B
case	O
(	O
chapter	O
5	O
)	O
.	O
similarly	O
,	O
the	O
minimum	O
expected	O
residual	B
error	O
may	O
be	O
computed	O
as	O
in	O
result	O
5.2	O
(	O
p136	O
)	O
.	O
assuming	O
that	O
all	O
errors	O
are	O
in	O
the	O
image	O
measurements	O
,	O
the	O
expected	O
ml	O
residual	B
error	O
is	O
equal	O
to	O
res	O
=	O
σ	O
(	O
1	O
−	O
d/2n	O
)	O
1/2	O
.	O
where	O
d	O
is	O
the	O
number	O
of	O
camera	O
parameters	B
being	O
ﬁtted	O
(	O
11	O
for	O
a	O
full	O
pinhole	O
camera	O
model	B
)	O
.	O
this	O
formula	O
may	O
also	O
be	O
used	O
to	O
estimate	O
the	O
accuracy	O
of	O
the	O
point	O
mea-	O
surements	O
,	O
given	O
a	O
residual	B
error	O
.	O
in	O
the	O
case	O
of	O
example	O
7.1	O
where	O
n	O
=	O
197	O
and	O
res	O
=	O
0.365	O
this	O
results	O
in	O
a	O
value	O
of	O
σ	O
=	O
0.37.	O
this	O
value	O
is	O
greater	O
than	O
expected	O
.	O
the	O
reason	O
,	O
as	O
we	O
will	O
see	O
later	O
,	O
lies	O
in	O
the	O
camera	B
model	O
–	O
we	O
are	O
ignoring	O
radial	B
distortion	I
.	O
example	O
7.2.	O
covariance	B
ellipsoid	O
for	O
an	O
estimated	O
camera	B
suppose	O
that	O
the	O
camera	B
is	O
estimated	O
using	O
the	O
maximum	O
likelihood	O
(	O
gold	O
stan-	O
dard	O
)	O
method	O
,	O
optimizing	O
over	O
a	O
set	O
of	B
camera	I
parameters	O
.	O
the	O
estimated	O
covari-	O
ance	O
of	O
the	O
point	O
measurements	O
can	O
then	O
be	O
used	O
to	O
compute	O
the	O
covariance	B
of	O
the	O
camera	B
model	O
by	O
back-propagation	O
,	O
according	O
to	O
result	O
5.10	O
(	O
p142	O
)	O
.	O
this	O
gives	O
σcamera	O
=	O
(	O
jtς−1	O
−1	O
where	O
j	O
is	O
the	O
jacobian	O
matrix	B
of	O
the	O
measured	O
points	O
in	O
terms	O
of	O
the	O
camera	O
parameters	B
.	O
uncertainty	O
in	O
3d	O
world	O
points	O
may	O
also	O
be	O
taken	O
into	O
account	O
in	O
this	O
way	O
.	O
if	O
the	O
camera	B
is	O
parametrized	O
in	O
terms	O
of	O
meaningful	O
param-	O
eters	O
(	O
such	O
as	O
camera	O
position	O
)	O
,	O
then	O
the	O
variance	B
of	O
each	O
parameter	O
can	O
be	O
measured	O
directly	O
from	O
the	O
diagonal	O
entries	O
of	O
the	O
covariance	O
matrix	B
.	O
points	O
j	O
)	O
knowing	O
the	O
covariance	B
of	O
the	O
camera	B
parameters	I
,	O
error	B
bounds	O
or	O
ellipsoids	O
can	O
be	O
computed	O
.	O
for	O
instance	O
,	O
from	O
the	O
covariance	B
matrix	O
for	O
all	O
the	O
parameters	B
we	O
may	O
extract	O
the	O
subblock	O
representing	O
the	O
3	O
×	O
3	O
covariance	B
matrix	O
of	O
the	O
camera	O
position	O
,	O
σc	O
.	O
a	O
conﬁdence	O
ellipsoid	O
for	O
the	O
camera	B
centre	I
is	O
then	O
deﬁned	O
by	O
(	O
c	O
−	O
¯c	O
)	O
tς−1	O
c	O
(	O
c	O
−	O
¯c	O
)	O
=k	O
2	O
where	O
k2	O
is	O
computed	O
from	O
the	O
inverse	O
cumulative	O
χ2	O
sired	O
conﬁdence	O
level	O
α	O
:	O
namely	O
k2	O
=	O
f	O
n	O
distribution	B
in	O
terms	O
of	O
the	O
de-	O
−1	O
n	O
(	O
α	O
)	O
(	O
see	O
ﬁgure	O
a2.1	O
(	O
p567	O
)	O
)	O
.	O
here	O
n	O
is	O
the	O
7.4	O
radial	B
distortion	I
189	O
a	O
b	O
fig	O
.	O
7.3.	O
camera	B
centre	I
covariance	O
ellipsoids	O
.	O
(	O
a	O
)	O
five	O
images	O
of	O
stanislas	O
square	O
(	O
nancy	O
,	O
france	O
)	O
,	O
for	O
which	O
3d	O
calibration	B
points	O
are	O
known	O
.	O
(	O
b	O
)	O
camera	B
centre	I
covariance	O
ellipsoids	O
corresponding	O
to	O
each	O
image	O
,	O
computed	O
for	O
cameras	B
estimated	O
from	O
the	O
imaged	O
calibration	B
points	O
.	O
note	O
,	O
the	O
typical	O
cigar	O
shape	O
of	O
the	O
ellipsoid	O
aligned	O
towards	O
the	O
scene	O
data	O
.	O
figure	O
courtesy	O
of	O
vincent	O
lepetit	O
,	O
marie-odile	O
berger	O
and	O
gilles	O
simon	O
.	O
number	O
of	O
variables	O
–	O
that	O
is	O
3	O
in	O
the	O
case	O
of	O
the	O
camera	O
centre	B
.	O
with	O
the	O
chosen	O
level	O
of	O
certainty	O
α	O
,	O
the	O
camera	B
centre	I
lies	O
inside	O
the	O
ellipsoid	O
.	O
figure	O
7.3	O
shows	O
an	O
example	O
of	O
ellipsoidal	O
uncertainty	O
regions	O
for	O
computed	O
camera	B
centres	O
.	O
given	O
the	O
estimated	O
covariance	B
matrix	O
for	O
the	O
computed	O
camera	O
,	O
the	O
tech-	O
niques	O
of	O
section	O
5.2.6	O
(	O
p148	O
)	O
may	O
be	O
used	O
to	O
compute	O
the	O
uncertainty	O
in	O
the	O
image	O
(	O
cid:2	O
)	O
positions	O
of	O
further	O
3d	O
world	O
points	O
.	O
7.4	O
radial	B
distortion	I
the	O
assumption	O
throughout	O
these	O
chapters	O
has	O
been	O
that	O
a	O
linear	B
model	O
is	O
an	O
accurate	O
model	B
of	O
the	O
imaging	O
process	O
.	O
thus	O
the	O
world	O
point	B
,	O
image	O
point	O
and	O
optical	O
centre	B
are	O
collinear	O
,	O
and	O
world	O
lines	B
are	O
imaged	O
as	O
lines	O
and	O
so	O
on	O
.	O
for	O
real	O
(	O
non-pinhole	O
)	O
lenses	O
this	O
assumption	O
will	O
not	O
hold	O
.	O
the	O
most	O
important	O
deviation	O
is	O
generally	O
a	O
radial	B
distortion	I
.	O
in	O
practice	O
this	O
error	B
becomes	O
more	O
signiﬁcant	O
as	O
the	O
focal	B
length	I
(	O
and	O
price	O
)	O
of	O
the	O
lens	O
decreases	O
.	O
see	O
ﬁgure	O
7.4.	O
the	O
cure	O
for	O
this	O
distortion	B
is	O
to	O
correct	O
the	O
image	O
measurements	O
to	O
those	O
that	O
would	O
have	O
been	O
obtained	O
under	O
a	O
perfect	O
linear	B
camera	O
action	O
.	O
the	O
camera	B
is	O
then	O
effectively	O
again	O
a	O
linear	B
device	O
.	O
this	O
process	O
is	O
illustrated	O
in	O
ﬁgure	O
7.5.	O
this	O
correction	B
must	O
190	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
a	O
b	O
fig	O
.	O
7.4	O
.	O
(	O
a	O
)	O
short	O
vs	O
(	O
b	O
)	O
long	O
focal	O
lengths	O
.	O
note	O
the	O
curved	O
imaged	O
lines	B
at	O
the	O
periphery	O
in	O
(	O
a	O
)	O
which	O
are	O
images	O
of	O
straight	O
scene	O
lines	O
.	O
radial	B
distortion	I
linear	O
image	O
correction	O
fig	O
.	O
7.5.	O
the	O
image	O
of	O
a	O
square	O
with	O
signiﬁcant	O
radial	B
distortion	I
is	O
corrected	O
to	O
one	O
that	O
would	O
have	O
been	O
obtained	O
under	O
a	O
perfect	O
linear	B
lens	O
.	O
be	O
carried	O
out	O
in	O
the	O
right	O
place	O
in	O
the	O
projection	B
process	O
.	O
lens	O
distortion	B
takes	O
place	O
during	O
the	O
initial	O
projection	O
of	O
the	O
world	O
onto	O
the	O
image	B
plane	I
,	O
according	O
to	O
(	O
6.2–p154	O
)	O
.	O
subsequently	O
,	O
the	O
calibration	B
matrix	I
(	O
7.6	O
)	O
reﬂects	O
a	O
choice	B
of	O
afﬁne	B
coordinates	O
in	O
the	O
image	O
,	O
translating	O
physical	O
locations	O
in	O
the	O
image	B
plane	I
to	O
pixel	O
coordinates	B
.	O
we	O
will	O
denote	O
the	O
image	O
coordinates	O
of	O
a	O
point	O
under	O
ideal	O
(	O
non-distorted	O
)	O
pinhole	O
projection	O
by	O
(	O
˜x	O
,	O
˜y	O
)	O
,	O
measured	O
in	O
units	O
of	O
focal-length	O
.	O
thus	O
,	O
for	O
a	O
point	O
x	O
we	O
have	O
(	O
see	O
(	O
6.5–p155	O
)	O
)	O
(	O
˜x	O
,	O
˜y	O
,	O
1	O
)	O
t	O
=	O
[	O
i	O
|	O
0	O
]	O
xcam	O
where	O
xcam	O
is	O
the	O
3d	O
point	B
in	O
camera	B
coordinates	O
,	O
related	O
to	O
world	O
coordinates	B
by	O
(	O
6.6–	O
p156	O
)	O
.	O
the	O
actual	O
projected	O
point	B
is	O
related	O
to	O
the	O
ideal	B
point	I
by	O
a	O
radial	O
displacement	O
.	O
thus	O
,	O
radial	O
(	O
lens	O
)	O
distortion	B
is	O
modelled	O
as	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
xd	O
yd	O
=	O
l	O
(	O
˜r	O
)	O
˜x	O
˜y	O
(	O
7.7	O
)	O
where	O
•	O
(	O
˜x	O
,	O
˜y	O
)	O
is	O
the	O
ideal	O
image	O
position	O
(	O
which	O
obeys	O
linear	B
projection	O
)	O
.	O
•	O
(	O
xd	O
,	O
yd	O
)	O
is	O
the	O
actual	O
image	O
position	O
,	O
after	O
radial	B
distortion	I
.	O
•	O
˜r	O
is	O
the	O
radial	O
distance	O
•	O
l	O
(	O
˜r	O
)	O
is	O
a	O
distortion	B
factor	O
,	O
which	O
is	O
a	O
function	O
of	O
the	O
radius	O
˜r	O
only	O
.	O
˜x2	O
+	O
˜y2	O
from	O
the	O
centre	B
for	O
radial	B
distortion	I
.	O
√	O
7.4	O
radial	B
distortion	I
191	O
correction	B
of	O
distortion	B
.	O
in	O
pixel	O
coordinates	B
the	O
correction	B
is	O
written	O
ˆx	O
=	O
xc	O
+	O
l	O
(	O
r	O
)	O
(	O
x	O
−	O
xc	O
)	O
ˆy	O
=	O
yc	O
+	O
l	O
(	O
r	O
)	O
(	O
y	O
−	O
yc	O
)	O
.	O
where	O
(	O
x	O
,	O
y	O
)	O
are	O
the	O
measured	O
coordinates	B
,	O
(	O
ˆx	O
,	O
ˆy	O
)	O
are	O
the	O
corrected	O
coordinates	B
,	O
and	O
(	O
xc	O
,	O
yc	O
)	O
is	O
the	O
centre	B
of	O
radial	B
distortion	I
,	O
with	O
r2	O
=	O
(	O
x	O
−	O
xc	O
)	O
2	O
+	O
(	O
y	O
−	O
yc	O
)	O
2.	O
note	O
,	O
if	O
the	O
aspect	O
ratio	O
is	O
not	O
unity	O
then	O
it	O
is	O
necessary	O
to	O
correct	O
for	O
this	O
when	O
computing	B
r.	O
with	O
this	O
correction	B
the	O
coordinates	B
(	O
ˆx	O
,	O
ˆy	O
)	O
are	O
related	O
to	O
the	O
coordinates	B
of	O
the	O
3d	O
world	O
point	B
by	O
a	O
linear	B
projective	O
camera	B
.	O
choice	B
of	O
the	O
distortion	B
function	I
and	O
centre	B
.	O
the	O
function	O
l	O
(	O
r	O
)	O
is	O
only	O
deﬁned	O
for	O
positive	O
values	O
of	O
r	O
and	O
l	O
(	O
0	O
)	O
=	O
1.	O
an	O
approximation	O
to	O
an	O
arbitrary	O
function	O
l	O
(	O
r	O
)	O
may	O
be	O
given	O
by	O
a	O
taylor	O
expansion	O
l	O
(	O
r	O
)	O
=	O
1	O
+	O
κ1r	O
+	O
κ2r2	O
+	O
κ3r3	O
+	O
.	O
.	O
..	O
the	O
coef-	O
ﬁcients	O
for	O
radial	O
correction	B
{	O
κ1	O
,	O
κ2	O
,	O
κ3	O
,	O
.	O
.	O
.	O
,	O
xc	O
,	O
yc	O
}	O
are	O
considered	O
part	O
of	O
the	O
interior	O
calibration	B
of	O
the	O
camera	B
.	O
the	O
principal	B
point	I
is	O
often	O
used	O
as	O
the	O
centre	B
for	O
radial	B
distortion	I
,	O
though	O
these	O
need	O
not	O
coincide	O
exactly	O
.	O
this	O
correction	B
,	O
together	O
with	O
the	O
camera	B
calibration	I
matrix	O
,	O
speciﬁes	O
the	O
mapping	O
from	O
an	O
image	O
point	O
to	O
a	O
ray	O
in	O
the	O
camera	B
coordinate	O
system	O
.	O
computing	B
the	O
distortion	B
function	I
.	O
the	O
function	O
l	O
(	O
r	O
)	O
may	O
be	O
computed	O
by	O
mini-	O
mizing	O
a	O
cost	O
based	O
on	O
the	O
deviation	O
from	O
a	O
linear	B
mapping	O
.	O
for	O
example	O
,	O
algorithm	B
7.1	O
(	O
p181	O
)	O
estimates	O
p	O
by	O
minimizing	B
geometric	I
image	O
error	B
for	O
calibration	B
objects	O
such	O
as	O
the	O
tsai	O
grids	O
of	O
ﬁgure	O
7.1.	O
the	O
distortion	B
function	I
may	O
be	O
included	O
as	O
part	O
of	O
the	O
imaging	O
process	O
,	O
and	O
the	O
parameters	B
κi	O
computed	O
together	O
with	O
p	O
during	O
the	O
iterative	B
minimization	I
of	O
the	O
geometric	B
error	I
.	O
similarly	O
,	O
the	O
distortion	B
function	I
may	O
be	O
com-	O
puted	O
when	O
estimating	B
the	O
homography	B
between	O
a	O
single	O
tsai	O
grid	O
and	O
its	O
image	O
.	O
a	O
simple	O
and	O
more	O
general	O
approach	O
is	O
to	O
determine	O
l	O
(	O
r	O
)	O
by	O
the	O
requirement	O
that	O
images	O
of	O
straight	O
scene	O
lines	O
should	O
be	O
straight	O
.	O
a	O
cost	B
function	I
is	O
deﬁned	O
on	O
the	O
imaged	O
lines	B
(	O
such	O
as	O
the	O
distance	B
between	O
the	O
line	B
joining	O
the	O
imaged	O
line	B
’	O
s	O
ends	O
and	O
its	O
mid-point	O
)	O
after	O
the	O
corrective	O
mapping	O
by	O
l	O
(	O
r	O
)	O
.	O
this	O
cost	O
is	O
iteratively	O
minimized	O
over	O
the	O
parameters	B
κi	O
of	O
the	O
distortion	O
function	O
and	O
the	O
centre	B
of	O
radial	B
distortion	I
.	O
this	O
is	O
a	O
very	O
practical	O
method	O
for	O
images	O
of	O
urban	O
scenes	O
since	O
there	O
are	O
usually	O
plenty	O
of	B
lines	I
available	O
.	O
it	O
has	O
the	O
advantage	O
that	O
no	O
special	O
calibration	B
pattern	O
is	O
required	O
as	O
the	O
scene	O
provides	O
the	O
calibration	B
entities	O
.	O
example	O
7.3.	O
radial	O
correction	O
.	O
the	O
function	O
l	O
(	O
r	O
)	O
is	O
computed	O
for	O
the	O
image	O
of	O
ﬁgure	O
7.6a	O
by	O
minimizing	B
a	O
cost	O
based	O
on	O
the	O
straightness	O
of	O
imaged	O
scene	O
lines	O
.	O
the	O
image	O
is	O
640×480	O
pixels	O
and	O
the	O
correction	B
and	O
centre	B
are	O
computed	O
as	O
κ1	O
=	O
0.103689	O
,	O
κ2	O
=	O
0.00487908	O
,	O
κ3	O
=	O
0.00116894	O
,	O
κ4	O
=	O
0.000841614	O
,	O
xc	O
=	O
321.87	O
,	O
yc	O
=	O
241.18	O
pixels	O
,	O
where	O
pixels	O
are	O
normalized	O
by	O
the	O
average	O
half-size	O
of	O
the	O
image	O
.	O
this	O
is	O
a	O
correction	B
by	O
30	O
pixels	O
at	O
the	O
image	O
periphery	O
.	O
the	O
result	O
of	O
warping	O
the	O
image	O
is	O
(	O
cid:2	O
)	O
shown	O
in	O
ﬁgure	O
7.6b	O
.	O
example	O
7.4.	O
we	O
continue	O
with	O
the	O
example	O
of	O
the	O
calibration	O
grid	O
shown	O
in	O
ﬁgure	O
7.1	O
and	O
discussed	O
in	O
example	O
7.1	O
(	O
p181	O
)	O
.	O
radial	B
distortion	I
was	O
removed	O
by	O
the	O
straight	O
line	B
192	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
a	O
b	O
fig	O
.	O
7.6.	O
radial	B
distortion	I
correction	O
.	O
(	O
a	O
)	O
the	O
original	O
image	O
with	O
lines	B
which	O
are	O
straight	O
in	O
the	O
world	O
,	O
but	O
curved	O
in	O
the	O
image	O
.	O
several	O
of	O
these	O
lines	B
are	O
annotated	O
by	O
dashed	O
curves	O
.	O
(	O
b	O
)	O
the	O
image	O
warped	O
to	O
remove	O
the	O
radial	B
distortion	I
.	O
note	O
that	O
the	O
lines	B
in	O
the	O
periphery	O
of	O
the	O
image	O
are	O
now	O
straight	O
,	O
but	O
that	O
the	O
boundary	O
of	O
the	O
image	O
is	O
curved	O
.	O
method	O
,	O
and	O
then	O
the	O
camera	B
calibrated	O
using	O
the	O
methods	O
described	O
in	O
this	O
chapter	O
.	O
the	O
results	O
are	O
given	O
in	O
table	O
7.3.	O
note	O
that	O
the	O
residuals	B
after	O
radial	O
correction	O
are	O
substantially	O
smaller	O
.	O
estimation	B
of	I
the	O
error	B
of	O
point	B
measurements	O
from	O
the	O
residual	B
leads	O
to	O
a	O
value	O
of	O
σ	O
=	O
0.18	O
pixels	O
.	O
since	O
radial	B
distortion	I
involves	O
selective	O
stretching	O
of	O
the	O
image	O
,	O
it	O
is	O
quite	O
plausible	O
(	O
cid:2	O
)	O
that	O
the	O
effective	O
focal	B
length	I
of	O
the	O
image	O
is	O
changed	O
,	O
as	O
seen	O
here	O
.	O
fy	O
fx/fy	O
skew	O
x0	O
y0	O
residual	B
linear	O
iterative	B
algebraic	O
iterative	B
linear	O
iterative	B
algebraic	O
iterative	B
1580.5	O
1580.7	O
1556.0	O
1556.6	O
1673.3	O
1675.5	O
1633.4	O
1637.2	O
1.0044	O
1.0044	O
1.0000	O
1.0000	O
1.0063	O
1.0063	O
1.0000	O
1.0000	O
0.75	O
0.70	O
0.00	O
0.00	O
1.39	O
1.43	O
0.00	O
0.00	O
377.53	O
377.42	O
372.42	O
372.41	O
379.96	O
379.79	O
371.21	O
371.32	O
299.12	O
299.02	O
291.86	O
291.86	O
305.78	O
305.25	O
293.63	O
293.69	O
0.179	O
0.179	O
0.381	O
0.380	O
0.365	O
0.364	O
0.601	O
0.601	O
table	O
7.3.	O
calibration	B
with	O
and	O
without	O
radial	B
distortion	I
correction	O
.	O
the	O
results	O
above	O
the	O
line	B
are	O
after	O
radial	O
correction	O
–	O
the	O
results	O
below	O
for	O
comparison	O
are	O
without	O
radial	B
distortion	I
(	O
from	O
the	O
previous	O
tables	O
)	O
.	O
the	O
upper	O
two	O
methods	O
in	O
each	O
case	O
solve	O
for	O
the	O
general	O
camera	O
model	B
,	O
the	O
lower	O
two	O
are	O
for	O
a	O
constrained	O
model	B
with	O
square	O
pixels	O
.	O
in	O
correcting	O
for	O
radial	O
distortion	B
,	O
it	O
is	O
often	O
not	O
actually	O
necessary	O
to	O
warp	O
the	O
image	O
.	O
measurements	O
can	O
be	O
made	O
in	O
the	O
original	O
image	O
,	O
for	O
example	O
the	O
position	O
of	O
a	O
corner	O
feature	O
,	O
and	O
the	O
measurement	O
simply	O
mapped	O
according	O
to	O
(	O
7.7	O
)	O
.	O
the	O
question	O
of	O
where	O
features	O
should	O
be	O
measured	O
does	O
not	O
have	O
an	O
unambiguous	O
answer	O
.	O
warping	O
the	O
im-	O
age	O
will	O
distort	O
noise	B
models	O
(	O
because	O
of	O
averaging	O
)	O
and	O
may	O
well	O
introduce	O
aliasing	O
effects	O
.	O
for	O
this	O
reason	O
feature	B
detection	I
on	O
the	O
unwarped	O
image	O
will	O
often	O
be	O
prefer-	O
able	O
.	O
however	O
,	O
feature	O
grouping	O
,	O
such	O
as	O
linking	O
edgels	O
into	O
straight	O
line	B
primitives	O
,	O
is	O
best	O
performed	O
after	O
warping	O
since	O
thresholds	O
on	O
linearity	O
may	O
well	O
be	O
erroneously	O
exceeded	O
in	O
the	O
original	O
image	O
.	O
7.5	O
closure	O
193	O
7.5	O
closure	O
7.5.1	O
the	O
literature	O
the	O
original	O
application	O
of	O
the	O
dlt	O
in	O
[	O
sutherland-63	O
]	O
was	O
for	O
camera	O
computation	O
.	O
estimation	B
by	O
iterative	B
minimization	I
of	O
geometric	B
errors	O
is	O
a	O
standard	O
procedure	O
of	O
photogrammetrists	O
,	O
e.g	O
.	O
see	O
[	O
slama-80	O
]	O
.	O
a	O
minimal	B
solution	I
for	O
a	O
calibrated	B
camera	O
(	O
pose	O
from	O
the	O
image	O
of	O
3	O
points	O
)	O
was	O
the	O
original	O
problem	O
studied	O
by	O
fischler	O
and	O
bolles	O
[	O
fischler-81	O
]	O
in	O
their	O
ransac	O
paper	O
.	O
solutions	O
to	O
this	O
problem	O
reoccur	O
often	O
in	O
the	O
literature	O
;	O
a	O
good	O
treatment	O
is	O
given	O
in	O
[	O
wolfe-91	O
]	O
and	O
also	O
[	O
haralick-91	O
]	O
.	O
quasi-linear	O
solutions	O
for	O
one	O
more	O
than	O
the	O
mini-	O
mum	O
number	O
of	O
point	O
correspondences	B
xi	O
↔	O
xi	O
are	O
in	O
[	O
quan-98	O
]	O
and	O
[	O
triggs-99a	O
]	O
.	O
another	O
class	O
of	O
methods	O
,	O
which	O
are	O
not	O
covered	O
here	O
,	O
is	O
the	O
iterative	B
estimation	I
of	O
a	O
projective	B
camera	I
starting	O
from	O
an	O
afﬁne	B
one	O
.	O
the	O
algorithm	B
of	O
“	O
model	B
based	O
pose	O
in	O
25	O
lines	B
of	O
code	O
”	O
by	O
dementhon	O
and	O
davis	O
[	O
dementhon-95	O
]	O
is	O
based	O
on	O
this	O
idea	O
.	O
a	O
similar	O
method	O
is	O
used	O
in	O
[	O
christy-96	O
]	O
.	O
devernay	O
and	O
faugeras	O
[	O
devernay-95	O
]	O
introduced	O
a	O
straight	O
line	B
method	O
for	O
com-	O
in	O
the	O
photogrammetry	O
puting	O
radial	B
distortion	I
into	O
the	O
computer	O
vision	O
literature	O
.	O
literature	O
the	O
method	O
is	O
known	O
as	O
“	O
plumb	O
line	B
correction	O
”	O
,	O
see	O
[	O
brown-71	O
]	O
.	O
7.5.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
given	O
5	O
world-to-image	O
point	B
correspondences	O
,	O
xi	O
↔	O
xi	O
,	O
show	O
that	O
there	O
are	O
in	O
general	O
four	B
solutions	I
for	O
a	O
camera	B
matrix	I
p	O
with	O
zero	O
skew	O
that	O
exactly	O
maps	O
the	O
world	O
to	O
image	O
points	O
.	O
(	O
ii	O
)	O
given	O
3	O
world-to-image	O
point	B
correspondences	O
,	O
xi	O
↔	O
xi	O
,	O
show	O
that	O
there	O
are	O
in	O
general	O
four	B
solutions	I
for	O
a	O
camera	B
matrix	I
p	O
with	O
known	O
calibration	B
k	O
that	O
exactly	O
maps	O
the	O
world	O
to	O
image	O
points	O
.	O
(	O
iii	O
)	O
find	O
a	O
linear	B
algorithm	I
for	O
computing	B
the	O
camera	B
matrix	I
p	O
under	O
each	O
of	O
the	O
following	O
conditions	O
:	O
(	O
a	O
)	O
the	O
camera	B
location	O
(	O
but	O
not	O
orientation	B
)	O
is	O
known	O
.	O
(	O
b	O
)	O
the	O
direction	O
of	O
the	O
principal	O
ray	O
of	O
the	O
camera	O
is	O
known	O
.	O
(	O
c	O
)	O
the	O
camera	B
location	O
and	O
the	O
principal	O
ray	O
of	O
the	O
camera	O
are	O
known	O
.	O
(	O
d	O
)	O
the	O
camera	B
location	O
and	O
complete	O
orientation	B
of	O
the	O
camera	B
are	O
known	O
.	O
(	O
e	O
)	O
the	O
camera	B
location	O
and	O
orientation	B
are	O
known	O
,	O
as	O
well	O
as	O
some	O
subset	O
of	O
the	O
internal	O
camera	B
parameters	I
(	O
αx	O
,	O
αy	O
,	O
s	O
,	O
x0	O
and	O
y0	O
)	O
.	O
(	O
iv	O
)	O
conﬂation	O
of	O
focal	O
length	O
and	O
position	O
on	O
principal	O
axis	O
.	O
compare	O
the	O
im-	O
aged	O
position	O
of	O
a	O
point	O
of	O
depth	O
d	O
before	O
and	O
after	O
an	O
increase	O
in	O
camera	O
focal	B
length	I
∆f	O
,	O
or	O
a	O
displacement	O
∆t3	O
of	O
the	O
camera	O
backwards	O
along	O
the	O
principal	O
axis	O
.	O
let	O
(	O
x	O
,	O
y	O
)	O
t	O
and	O
(	O
x	O
)	O
t	O
be	O
the	O
image	O
coordinates	O
of	O
the	O
point	O
before	O
and	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
194	O
7	O
computation	B
of	I
the	O
camera	B
matrix	I
p	O
after	O
the	O
change	O
.	O
following	O
a	O
similar	O
derivation	B
to	O
that	O
of	O
(	O
6.19–p169	O
)	O
,	O
show	O
that	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
(	O
cid:20	O
)	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
y	O
(	O
cid:21	O
)	O
=	O
+	O
k	O
x	O
y	O
x	O
−	O
x0	O
y	O
−	O
y0	O
where	O
kf	O
=	O
∆f	O
/f	O
for	O
a	O
focal	O
length	O
change	O
,	O
or	O
kt3	O
=	O
−∆t3/d	O
for	O
a	O
displace-	O
ment	O
(	O
here	O
skew	O
s	O
=	O
0	O
,	O
and	O
αx	O
=	O
αy	O
=	O
f	O
)	O
.	O
for	O
a	O
set	O
of	O
calibration	O
points	O
xi	O
with	O
depth	O
relief	O
(	O
∆i	O
)	O
small	O
compared	O
to	O
the	O
average	O
depth	O
(	O
d0	O
)	O
,	O
i	O
=	O
−∆t3/di	O
=	O
−∆t3/	O
(	O
d0	O
+	O
∆i	O
)	O
≈	O
−∆t3/d0	O
kt3	O
i.e	O
.	O
kt3	O
is	O
approximately	O
constant	O
across	O
the	O
set	O
.	O
it	O
follows	O
that	O
in	O
calibrating	O
i	O
from	O
such	O
a	O
set	O
,	O
similar	O
image	O
residuals	O
are	O
obtained	O
by	O
changing	O
the	O
focal	B
length	I
kf	O
or	O
displacing	O
the	O
camera	B
kt3	O
.	O
consequently	O
,	O
the	O
estimated	O
parameters	B
of	O
focal	B
length	I
and	O
position	O
on	O
the	O
principal	O
axis	O
are	O
correlated	O
.	O
(	O
v	O
)	O
pushbroom	B
camera	O
computation	B
.	O
the	O
pushbroom	B
camera	O
,	O
described	O
in	O
section	O
6.4.1	O
,	O
may	O
also	O
be	O
computed	O
using	O
a	O
dlt	O
method	O
.	O
the	O
x	O
(	O
orthographic	B
)	O
part	O
of	O
the	O
projection	O
matrix	B
has	O
4	O
degrees	B
of	I
freedom	I
which	O
may	O
be	O
determined	O
by	O
four	O
or	O
more	O
point	O
correspondences	B
xi	O
↔	O
xi	O
;	O
the	O
y	O
(	O
perspective	O
)	O
part	O
of	O
the	O
projection	O
matrix	B
has	O
7	O
degrees	B
of	I
freedom	I
and	O
may	O
be	O
determined	O
from	O
7	O
cor-	O
respondences	O
.	O
hence	O
,	O
a	O
minimal	B
solution	I
requires	O
7	O
points	O
.	O
details	O
are	O
given	O
in	O
[	O
gupta-97	O
]	O
.	O
8	O
more	O
single	O
view	O
geometry	O
chapter	O
6	O
introduced	O
the	O
projection	B
matrix	O
as	O
the	O
model	B
for	O
the	O
action	O
of	O
a	O
camera	B
on	O
points	O
.	O
this	O
chapter	O
describes	O
the	O
link	O
between	O
other	O
3d	O
entities	O
and	O
their	O
images	O
under	O
perspective	O
projection	B
.	O
these	O
entities	O
include	O
planes	O
,	O
lines	B
,	O
conics	O
and	O
quadrics	B
;	O
and	O
we	O
develop	O
their	O
forward	O
and	O
back-projection	B
properties	O
.	O
the	O
camera	B
is	O
dissected	O
further	O
,	O
and	O
reduced	B
to	O
its	O
centre	B
point	O
and	O
image	B
plane	I
.	O
two	O
properties	O
are	O
established	O
:	O
images	O
acquired	O
by	O
cameras	B
with	O
the	O
same	O
centre	O
are	O
related	O
by	O
a	O
plane	B
projective	O
transformation	B
;	O
and	O
images	O
of	O
entities	O
on	O
the	O
plane	O
at	O
inﬁnity	O
,	O
π∞	O
,	O
do	O
not	O
depend	O
on	O
camera	O
position	O
,	O
only	O
on	O
camera	O
rotation	O
and	O
internal	O
parameters	B
,	O
k.	O
the	O
images	O
of	O
entities	O
(	O
points	O
,	O
lines	B
,	O
conics	O
)	O
on	O
π∞	O
are	O
of	O
particular	O
importance	O
.	O
it	O
will	O
be	O
seen	O
that	O
the	O
image	O
of	O
a	O
point	B
on	O
π∞	O
is	O
a	O
vanishing	O
point	O
,	O
and	O
the	O
image	O
of	O
a	O
line	B
on	O
π∞	O
a	O
vanishing	O
line	O
;	O
their	O
images	O
depend	O
on	O
both	O
k	O
and	O
camera	B
rotation	I
.	O
however	O
,	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
ω	O
,	O
depends	O
only	O
on	O
k	O
;	O
it	O
is	O
unaffected	O
by	O
the	O
camera	B
’	O
s	O
rotation	B
.	O
the	O
conic	B
ω	O
is	O
intimately	O
connected	O
with	O
camera	O
calibration	B
,	O
k	O
,	O
and	O
−1	O
is	O
established	O
.	O
it	O
follows	O
that	O
ω	O
deﬁnes	O
the	O
angle	B
between	O
the	O
relation	B
ω	O
=	O
(	O
kkt	O
)	O
rays	O
back-projected	O
from	O
image	O
points	O
.	O
these	O
properties	B
enable	O
camera	B
relative	O
rotation	B
to	O
be	O
computed	O
from	O
vanishing	O
points	O
independently	O
of	B
camera	I
position	O
.	O
further	O
,	O
since	O
k	O
enables	O
the	O
angle	B
between	O
rays	O
to	O
be	O
computed	O
from	O
image	O
points	O
,	O
in	O
turn	O
k	O
may	O
be	O
computed	O
from	O
the	O
known	O
angle	O
between	O
rays	O
.	O
in	O
particular	O
k	O
may	O
be	O
determined	O
from	O
vanishing	O
points	O
corre-	O
sponding	O
to	O
orthogonal	O
scene	O
directions	O
.	O
this	O
means	O
that	O
a	O
camera	B
can	O
be	O
calibrated	B
from	O
scene	O
features	O
,	O
without	O
requiring	O
known	O
world	O
coordinates	B
.	O
a	O
ﬁnal	O
geometric	B
entity	O
introduced	O
in	O
this	O
chapter	O
is	O
the	O
calibrating	B
conic	I
,	O
which	O
enables	O
a	O
geometric	B
visualization	O
of	O
k.	O
8.1	O
action	O
of	O
a	O
projective	B
camera	I
on	O
planes	O
,	O
lines	B
,	O
and	O
conics	O
in	O
this	O
section	O
(	O
and	O
indeed	O
in	O
most	O
of	O
this	O
book	O
)	O
it	O
is	O
only	O
the	O
3×	O
4	O
form	O
and	O
rank	O
of	O
the	O
camera	O
projection	B
matrix	O
p	O
that	O
is	O
important	O
in	O
determining	O
its	O
action	O
.	O
the	O
particular	O
properties	B
and	O
relations	O
of	O
its	O
elements	O
are	O
often	O
not	O
relevant	O
.	O
195	O
196	O
8	O
more	O
single	O
view	O
geometry	O
c	O
x	O
z	O
x	O
x	O
π	O
y	O
π	O
fig	O
.	O
8.1.	O
perspective	O
image	O
of	O
points	O
on	O
a	O
plane	O
.	O
the	O
xy-plane	O
of	O
the	O
world	O
coordinate	O
frame	O
is	O
aligned	O
with	O
the	O
plane	B
π.	O
points	O
on	O
the	O
image	O
and	O
scene	O
planes	O
are	O
related	O
by	O
a	O
plane	B
projective	O
transformation	B
.	O
8.1.1	O
on	O
planes	O
the	O
point	B
imaging	O
equation	O
x	O
=	O
px	O
is	O
a	O
map	O
from	O
a	O
point	B
in	O
a	O
world	O
coordinate	O
frame	O
,	O
to	O
a	O
point	B
in	O
image	O
coordinates	O
.	O
we	O
have	O
the	O
freedom	O
to	O
choose	O
the	O
world	O
coordinate	O
frame	O
.	O
suppose	O
it	O
is	O
chosen	O
such	O
that	O
the	O
xy-plane	O
corresponds	O
to	O
a	O
plane	B
π	O
in	O
the	O
scene	O
,	O
so	O
that	O
points	O
on	O
the	O
scene	O
plane	O
have	O
zero	O
z-coordinate	O
as	O
shown	O
in	O
ﬁgure	O
8.1	O
(	O
it	O
is	O
assumed	O
that	O
the	O
camera	B
centre	I
does	O
not	O
lie	O
on	O
the	O
scene	O
plane	O
)	O
.	O
then	O
,	O
if	O
the	O
columns	O
of	O
p	O
are	O
denoted	O
as	O
pi	O
,	O
the	O
image	O
of	O
a	O
point	B
on	O
π	O
is	O
given	O
by	O
x	O
=	O
px	O
=	O
p1	O
p2	O
p3	O
p4	O
p1	O
p2	O
p4	O
''	O
	O
=	O
''	O
#	O
	O
x	O
y	O
0	O
1	O
	O
.	O
#	O
	O
x	O
y	O
1	O
so	O
that	O
the	O
map	O
between	O
points	O
xπ	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
on	O
π	O
and	O
their	O
image	O
x	O
is	O
a	O
general	O
planar	O
homography	B
(	O
a	O
plane	B
to	O
plane	B
projective	O
transformation	B
)	O
:	O
x	O
=	O
hxπ	O
,	O
with	O
h	O
a	O
3	O
×	O
3	O
matrix	B
of	O
rank	O
3.	O
this	O
shows	O
that	O
:	O
•	O
the	O
most	O
general	O
transformation	O
that	O
can	O
occur	O
between	O
a	O
scene	O
plane	O
and	O
an	O
image	B
plane	I
under	O
perspective	O
imaging	O
is	O
a	O
plane	B
projective	O
transformation	B
.	O
if	O
the	O
camera	B
is	O
afﬁne	B
,	O
then	O
a	O
similar	O
derivation	B
shows	O
that	O
the	O
scene	O
and	O
image	O
planes	O
are	O
related	O
by	O
an	O
afﬁne	B
transformation	I
.	O
example	O
8.1.	O
for	O
a	O
calibrated	O
camera	B
(	O
6.8–p156	O
)	O
p	O
=	O
k	O
[	O
r	O
|	O
t	O
]	O
,	O
the	O
homography	B
be-	O
tween	O
a	O
world	O
plane	O
at	O
z	O
=	O
0	O
and	O
the	O
image	O
is	O
where	O
ri	O
are	O
the	O
columns	O
of	O
r.	O
h	O
=	O
k	O
[	O
r1	O
,	O
r2	O
,	O
t	O
]	O
(	O
8.1	O
)	O
(	O
cid:2	O
)	O
8.1.2	O
on	O
lines	O
forward	B
projection	I
.	O
a	O
line	B
in	O
3-space	O
projects	O
to	O
a	O
line	B
in	O
the	O
image	O
.	O
this	O
is	O
easily	O
seen	O
geometrically	O
–	O
the	O
line	B
and	O
camera	B
centre	I
deﬁne	O
a	O
plane	B
,	O
and	O
the	O
image	O
is	O
the	O
intersection	B
of	O
this	O
plane	B
with	O
the	O
image	B
plane	I
(	O
ﬁgure	O
8.2	O
)	O
–	O
and	O
is	O
proved	O
algebraically	O
8.1	O
action	O
of	O
a	O
projective	B
camera	I
on	O
planes	O
,	O
lines	B
,	O
and	O
conics	O
197	O
l	O
π	O
l	O
c	O
fig	O
.	O
8.2.	O
line	O
projection	O
.	O
a	O
line	B
l	O
in	O
3-space	O
is	O
imaged	O
as	O
a	O
line	B
l	O
by	O
a	O
perspective	O
camera	B
.	O
the	O
image	O
line	O
l	O
is	O
the	O
intersection	B
of	O
the	O
plane	B
π	O
,	O
deﬁned	O
by	O
l	O
and	O
the	O
camera	B
centre	I
c	O
,	O
with	O
the	O
image	B
plane	I
.	O
conversely	O
an	O
image	O
line	O
l	O
back-projects	O
to	O
a	O
plane	B
π	O
in	O
3-space	O
.	O
the	O
plane	B
is	O
the	O
“	O
pull-back	O
”	O
of	O
the	O
line	O
.	O
by	O
noting	O
that	O
if	O
a	O
,	O
b	O
are	O
points	O
in	O
3-space	O
,	O
and	O
a	O
,	O
b	O
their	O
images	O
under	O
p	O
,	O
then	O
a	O
point	B
x	O
(	O
µ	O
)	O
=	O
a	O
+	O
µb	O
on	B
a	I
line	I
which	O
is	O
the	O
join	O
of	O
a	O
,	O
b	O
in	O
3-space	O
projects	O
to	O
a	O
point	B
x	O
(	O
µ	O
)	O
=p	O
(	O
a	O
+	O
µb	O
)	O
=	O
pa	O
+	O
µpb	O
=	O
a	O
+	O
µb	O
which	O
is	O
on	O
the	O
line	B
joining	O
a	O
and	O
b.	O
back-projection	B
of	O
lines	B
.	O
the	O
set	O
of	B
points	I
in	O
space	O
which	O
map	O
to	O
a	O
line	B
in	O
the	O
image	O
is	O
a	O
plane	B
in	O
space	O
deﬁned	O
by	O
the	O
camera	B
centre	I
and	O
image	O
line	O
,	O
as	O
shown	O
in	O
ﬁgure	O
8.2.	O
algebraically	O
,	O
result	O
8.2.	O
the	O
set	O
of	B
points	I
in	O
space	O
mapping	O
to	O
a	O
line	B
l	O
via	O
the	O
camera	O
matrix	B
p	O
is	O
the	O
plane	B
ptl	O
.	O
proof	O
.	O
a	O
point	B
x	O
lies	O
on	O
l	O
if	O
and	O
only	O
if	O
xtl	O
=	O
0.	O
a	O
space	O
point	O
x	O
maps	O
to	O
a	O
point	B
px	O
,	O
which	O
lies	O
on	O
the	O
line	B
if	O
and	O
only	O
if	O
xtptl	O
=	O
0.	O
thus	O
,	O
if	O
ptl	O
is	O
taken	O
to	O
represent	O
a	O
plane	B
,	O
then	O
x	O
lies	O
on	O
this	O
plane	B
if	O
and	O
only	O
if	O
x	O
maps	O
to	O
a	O
point	B
on	O
the	O
line	B
l.	O
in	O
other	O
words	O
,	O
ptl	O
is	O
the	O
back-projection	B
of	O
the	O
line	B
l.	O
geometrically	O
there	O
is	O
a	O
star	O
(	O
two-parameter	O
family	O
)	O
of	O
planes	O
through	O
the	O
camera	B
cen-	O
tre	O
,	O
and	O
the	O
three	O
rows	O
of	O
the	O
projection	O
matrix	B
pit	O
(	O
6.12–p159	O
)	O
are	O
a	O
basis	O
for	O
this	O
star	O
.	O
the	O
plane	B
ptl	O
is	O
a	O
linear	B
combination	O
of	O
this	O
basis	O
corresponding	O
to	O
the	O
element	O
of	O
the	O
star	O
containing	O
the	O
camera	B
centre	I
and	O
the	O
line	B
l.	O
for	O
example	O
,	O
if	O
l	O
=	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
then	O
the	O
plane	B
is	O
p2	O
,	O
and	O
is	O
the	O
back	O
projection	B
of	O
the	O
image	O
x-axis	O
.	O
pl¨ucker	O
line	B
representation	I
.	O
understanding	O
this	O
material	O
on	O
pl¨ucker	O
line	B
mapping	O
is	O
not	O
required	O
for	O
following	O
the	O
rest	O
of	O
the	O
book	O
.	O
we	O
now	O
turn	O
to	O
forward	O
projection	B
of	O
lines	B
.	O
if	O
a	O
line	B
in	O
3-space	O
is	O
represented	O
by	O
pl¨ucker	O
coordinates	B
then	O
its	O
image	O
can	O
be	O
expressed	O
as	O
a	O
linear	B
map	O
on	O
these	O
coordi-	O
nates	O
.	O
we	O
will	O
develop	O
this	O
map	O
for	O
both	O
the	O
4	O
×	O
4	O
matrix	B
and	O
6-vector	O
line	B
representa-	O
tions	O
.	O
198	O
8	O
more	O
single	O
view	O
geometry	O
result	O
8.3.	O
under	O
the	O
camera	B
mapping	O
p	O
,	O
a	O
line	B
in	O
3-space	O
represented	O
as	O
a	O
pl¨ucker	O
matrix	B
l	O
,	O
as	O
deﬁned	O
in	O
(	O
3.8–p70	O
)	O
,	O
is	O
imaged	O
as	O
the	O
line	B
l	O
where	O
[	O
l	O
]	O
×	O
=	O
plpt	O
.	O
(	O
8.2	O
)	O
where	O
the	O
notation	O
[	O
l	O
]	O
×	O
is	O
deﬁned	O
in	O
(	O
a4.5–p581	O
)	O
.	O
proof	O
.	O
suppose	O
as	O
above	O
that	O
a	O
=	O
pa	O
,	O
b	O
=	O
pb	O
.	O
the	O
pl¨ucker	O
matrix	B
l	O
for	O
the	O
line	B
through	O
a	O
,	O
b	O
in	O
3-space	O
is	O
l	O
=	O
abt	O
−	O
bat	O
.	O
then	O
the	O
matrix	B
m	O
=	O
plpt	O
=	O
abt	O
−	O
bat	O
is	O
3	O
×	O
3	O
and	O
antisymmetric	O
,	O
with	O
null-space	O
a	O
×	O
b.	O
consequently	O
,	O
m	O
=	O
[	O
a	O
×	O
b	O
]	O
×	O
,	O
and	O
since	O
the	O
line	B
through	O
the	O
image	O
points	O
is	O
given	O
by	O
l	O
=	O
a	O
×	O
b	O
,	O
this	O
completes	O
the	O
proof	O
.	O
it	O
is	O
clear	O
from	O
the	O
form	B
of	I
(	O
8.2	O
)	O
that	O
there	O
is	O
a	O
linear	B
relation	O
between	O
the	O
image	O
line	O
coordinates	B
li	O
and	O
the	O
world	O
line	B
coordinates	I
ljk	O
,	O
but	O
that	O
this	O
relation	B
is	O
quadratic	O
in	O
the	O
elements	O
of	O
the	O
point	O
projection	B
matrix	O
p.	O
thus	O
,	O
(	O
8.2	O
)	O
may	O
be	O
rearranged	O
such	O
that	O
the	O
map	O
between	O
the	O
pl¨ucker	O
line	B
coordinates	I
,	O
l	O
(	O
a	O
6-vector	O
)	O
,	O
and	O
the	O
image	O
line	O
coordinates	B
l	O
(	O
a	O
3-vector	O
)	O
is	O
represented	O
by	O
a	O
single	O
3	O
×	O
6	O
matrix	B
.	O
it	O
can	O
be	O
shown	O
that	O
deﬁnition	B
8.4.	O
the	O
line	B
projection	I
matrix	I
p	O
is	O
the	O
3	O
×	O
6	O
matrix	B
of	O
rank	O
3	O
given	O
by	O
	O
p2	O
∧	O
p3	O
p3	O
∧	O
p1	O
p1	O
∧	O
p2	O
	O
p	O
=	O
(	O
8.3	O
)	O
(	O
8.4	O
)	O
where	O
pit	O
are	O
the	O
rows	O
of	O
the	O
point	O
camera	B
matrix	I
p	O
,	O
and	O
pi	O
∧	O
pj	O
are	O
the	O
pl¨ucker	O
line	B
coordinates	I
of	O
the	O
intersection	B
of	O
the	O
planes	O
pi	O
and	O
pj	O
.	O
then	O
the	O
forward	O
line	O
projection	B
is	O
given	O
by	O
result	O
8.5.	O
under	O
the	O
line	B
projection	I
matrix	I
p	O
,	O
a	O
line	B
in	O
ip3	O
represented	O
by	O
pl¨ucker	O
line	B
coordinates	I
l	O
,	O
as	O
deﬁned	O
in	O
(	O
3.11–p72	O
)	O
,	O
is	O
mapped	O
to	O
the	O
image	O
line	O
	O
(	O
p2	O
∧	O
p3|l	O
)	O
(	O
p3	O
∧	O
p1|l	O
)	O
(	O
p1	O
∧	O
p2|l	O
)	O
	O
l	O
=	O
pl	O
=	O
where	O
the	O
product	O
(	O
l|	O
ˆl	O
)	O
is	O
deﬁned	O
in	O
(	O
3.13–p72	O
)	O
.	O
proof	O
.	O
suppose	O
the	O
line	B
in	O
3-space	O
is	O
the	O
join	O
of	O
the	O
points	O
a	O
and	O
b	O
,	O
and	O
these	O
project	O
to	O
a	O
=	O
pa	O
,	O
b	O
=	O
pb	O
respectively	O
.	O
then	O
the	O
image	O
line	O
l	O
=	O
a	O
×	O
b	O
=	O
(	O
pa	O
)	O
×	O
(	O
pb	O
)	O
.	O
consider	O
the	O
ﬁrst	O
element	O
l1	O
=	O
(	O
p2ta	O
)	O
(	O
p3tb	O
)	O
−	O
(	O
p2tb	O
)	O
(	O
p3ta	O
)	O
=	O
(	O
p2	O
∧	O
p3|l	O
)	O
where	O
the	O
second	O
equality	O
follows	O
from	O
(	O
3.14–p73	O
)	O
.	O
the	O
other	O
components	O
follow	O
in	O
a	O
similar	O
manner	O
.	O
8.1	O
action	O
of	O
a	O
projective	B
camera	I
on	O
planes	O
,	O
lines	B
,	O
and	O
conics	O
199	O
the	O
line	B
projection	I
matrix	I
p	O
plays	O
the	O
same	O
role	O
for	B
lines	I
as	O
p	O
does	O
for	O
points	O
.	O
the	O
rows	O
of	O
p	O
may	O
be	O
interpreted	O
geometrically	O
as	O
lines	B
,	O
in	O
a	O
similar	O
manner	O
to	O
the	O
interpretation	O
of	O
the	O
rows	O
of	O
the	O
point	O
camera	B
matrix	I
p	O
as	O
planes	O
given	O
in	O
section	O
6.2.1	O
(	O
p158	O
)	O
.	O
the	O
rows	O
pit	O
of	O
p	O
are	O
the	O
principal	B
plane	I
and	O
axis	O
planes	O
of	O
the	O
camera	B
.	O
the	O
rows	O
of	O
p	O
are	O
the	O
lines	B
of	O
intersection	B
of	O
pairs	O
of	O
these	O
camera	B
planes	O
.	O
for	O
example	O
,	O
the	O
ﬁrst	O
row	O
of	O
p	O
is	O
p2	O
∧	O
p3	O
,	O
and	O
this	O
is	O
the	O
6-vector	O
pl¨ucker	O
line	B
representation	I
of	O
the	O
line	B
of	O
intersection	B
of	O
the	O
y	O
=	O
0	O
axis	O
plane	O
,	O
p2	O
,	O
and	O
the	O
principal	B
plane	I
,	O
p3	O
.	O
the	O
three	O
lines	B
corresponding	O
to	O
the	O
three	O
rows	O
of	O
p	O
intersect	O
at	O
the	O
camera	B
centre	I
.	O
consider	O
lines	B
l	O
in	O
3-space	O
for	O
which	O
pl	O
=	O
0.	O
these	O
lines	B
are	O
in	O
the	O
null-space	B
of	O
p.	O
since	O
each	O
row	O
of	O
p	O
is	O
a	O
line	B
,	O
and	O
from	O
result	O
3.5	O
(	O
p72	O
)	O
the	O
product	O
(	O
l1|l2	O
)	O
=	O
0	O
if	O
two	O
lines	O
intersect	O
,	O
if	O
follows	O
that	O
l	O
intersects	O
each	O
of	O
the	O
lines	O
represented	O
by	O
the	O
rows	O
of	O
p.	O
these	O
lines	B
are	O
the	O
intersection	B
of	O
the	O
camera	B
planes	O
,	O
and	O
the	O
only	O
point	B
on	O
all	O
3	O
camera	B
planes	O
is	O
the	O
camera	B
centre	I
.	O
thus	O
we	O
have	O
•	O
the	O
lines	B
l	O
in	O
ip3	O
for	O
which	O
pl	O
=	O
0	O
pass	O
through	O
the	O
camera	B
centre	I
.	O
the	O
3	O
×	O
6	O
matrix	B
p	O
has	O
a	O
3-dimensional	O
null-space	B
.	O
allowing	O
for	O
the	O
homogeneous	O
scale	O
factor	O
,	O
this	O
null-space	B
is	O
a	O
two-parameter	O
family	O
of	B
lines	I
containing	O
the	O
camera	B
centre	I
.	O
this	O
is	O
to	O
be	O
expected	O
since	O
there	O
is	O
a	O
star	O
(	O
two	O
parameter	O
family	O
)	O
of	B
lines	I
in	O
ip3	O
concurrent	B
with	O
a	O
point	B
.	O
8.1.3	O
on	O
conics	O
back-projection	B
of	O
conics	O
.	O
a	O
conic	B
c	O
back-projects	O
to	O
a	O
cone	O
.	O
a	O
cone	O
is	O
a	O
degenerate	B
quadric	O
,	O
i.e	O
.	O
the	O
4×	O
4	O
matrix	B
representing	O
the	O
quadric	O
does	O
not	O
have	O
full	O
rank	O
.	O
the	O
cone	O
vertex	O
,	O
in	O
this	O
case	O
the	O
camera	B
centre	I
,	O
is	O
the	O
null-vector	O
of	O
the	O
quadric	O
matrix	B
.	O
result	O
8.6.	O
under	O
the	O
camera	B
p	O
the	O
conic	B
c	O
back-projects	O
to	O
the	O
cone	O
qco	O
=	O
ptcp	O
.	O
proof	O
.	O
a	O
point	B
x	O
lies	O
on	O
c	O
if	O
and	O
only	O
if	O
xtcx	O
=	O
0.	O
a	O
space	O
point	O
x	O
maps	O
to	O
a	O
point	B
px	O
,	O
which	O
lies	O
on	O
the	O
conic	B
if	O
and	O
only	O
if	O
xtptcpx	O
=	O
0.	O
thus	O
,	O
if	O
qco	O
=	O
ptcp	O
is	O
taken	O
to	O
represent	O
a	O
quadric	O
,	O
then	O
x	O
lies	O
on	O
this	O
quadric	O
if	O
and	O
only	O
if	O
x	O
maps	O
to	O
a	O
point	B
on	O
the	O
conic	B
c.	O
in	O
other	O
words	O
,	O
qco	O
is	O
the	O
back-projection	B
of	O
the	O
conic	B
c.	O
note	O
the	O
camera	B
centre	I
c	O
is	O
qcoc	O
=	O
ptc	O
(	O
pc	O
)	O
=0	O
.	O
example	O
8.7.	O
suppose	O
that	O
p	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
;	O
then	O
the	O
conic	B
c	O
back-projects	O
to	O
the	O
cone	O
the	O
degenerate	B
quadric	O
since	O
the	O
vertex	O
of	O
(	O
cid:18	O
)	O
.	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
qco	O
=	O
kt	O
0t	O
c	O
[	O
k	O
|	O
0	O
]	O
=	O
ktck	O
0	O
0t	O
0	O
the	O
matrix	B
qco	O
has	O
rank	O
3.	O
its	O
null-vector	O
is	O
the	O
camera	B
centre	I
c	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
(	O
cid:2	O
)	O
200	O
8	O
more	O
single	O
view	O
geometry	O
n	O
k	O
x	O
n	O
x	O
contour	B
generator	I
a	O
γ	O
apparent	B
γ	O
contour	B
c	O
b	O
fig	O
.	O
8.3.	O
contour	B
generator	I
and	O
apparent	B
contour	O
.	O
(	O
a	O
)	O
for	O
parallel	O
projection	B
;	O
(	O
b	O
)	O
for	O
central	O
projec-	O
tion	O
.	O
the	O
ray	O
from	O
the	O
camera	B
centre	I
through	O
x	O
is	O
tangent	O
to	O
the	O
surface	O
at	O
x.	O
the	O
set	O
of	O
such	O
tangent	O
points	O
x	O
deﬁnes	O
the	O
contour	B
generator	I
,	O
and	O
their	O
image	O
deﬁnes	O
the	O
apparent	B
contour	O
.	O
in	O
general	O
the	O
contour	B
generator	I
is	O
a	O
space	B
curve	I
.	O
figure	O
courtesy	O
of	O
roberto	O
cipolla	O
and	O
peter	O
giblin	O
.	O
8.2	O
images	O
of	O
smooth	O
surfaces	O
the	O
image	O
outline	O
of	O
a	O
smooth	O
surface	O
s	O
results	O
from	O
surface	O
points	O
at	O
which	O
the	O
imag-	O
ing	O
rays	O
are	O
tangent	O
to	O
the	O
surface	O
,	O
as	O
shown	O
in	O
ﬁgure	O
8.3.	O
similarly	O
,	O
lines	B
tangent	O
to	O
the	O
outline	O
back-project	O
to	O
planes	O
which	O
are	O
tangent	O
planes	O
to	O
the	O
surface	O
.	O
deﬁnition	B
8.8.	O
the	O
contour	B
generator	I
γ	O
is	O
the	O
set	O
of	B
points	I
x	O
on	O
s	O
at	O
which	O
rays	O
are	O
tangent	O
to	O
the	O
surface	O
.	O
the	O
corresponding	O
image	O
apparent	O
contour	B
γ	O
is	O
the	O
set	O
of	B
points	I
x	O
which	O
are	O
the	O
image	O
of	O
x	O
,	O
i.e	O
.	O
γ	O
is	O
the	O
image	O
of	O
γ.	O
the	O
apparent	B
contour	O
is	O
also	O
called	O
the	O
“	O
outline	O
”	O
and	O
“	O
proﬁle	B
”	O
.	O
if	O
the	O
surface	O
is	O
viewed	O
in	O
the	O
direction	O
of	O
x	O
from	O
the	O
camera	B
centre	I
,	O
then	O
the	O
surface	O
appears	O
to	O
fold	O
,	O
or	O
to	O
have	O
a	O
boundary	O
or	O
occluding	B
contour	O
.	O
it	O
is	O
evident	O
that	O
the	O
contour	B
generator	I
γ	O
depends	O
only	O
on	O
the	O
relative	O
position	O
of	O
the	O
camera	O
centre	B
and	O
surface	O
,	O
not	O
on	O
the	O
image	B
plane	I
.	O
however	O
,	O
the	O
apparent	B
contour	O
γ	O
is	O
deﬁned	O
by	O
the	O
intersection	B
of	O
the	O
image	B
plane	I
with	O
the	O
rays	O
to	O
the	O
contour	B
generator	I
,	O
and	O
so	O
does	O
depend	O
on	O
the	O
position	O
of	O
the	O
image	O
plane	B
.	O
in	O
the	O
case	O
of	O
parallel	O
projection	O
with	O
direction	O
k	O
,	O
consider	O
all	O
the	O
rays	O
parallel	B
to	O
k	O
which	O
are	O
tangent	O
to	O
s	O
,	O
see	O
ﬁgure	O
8.3a	O
.	O
these	O
rays	O
form	O
a	O
“	O
cylinder	O
”	O
of	O
tangent	O
rays	O
,	O
and	O
the	O
curve	O
along	O
which	O
this	O
cylinder	O
is	O
tangent	O
to	O
s	O
is	O
the	O
contour	B
generator	I
γ.	O
the	O
curve	O
in	O
which	O
the	O
cylinder	O
meets	O
the	O
image	B
plane	I
is	O
the	O
apparent	B
contour	O
γ.	O
note	O
that	O
both	O
γ	O
and	O
γ	O
depend	O
in	O
an	O
essential	O
way	O
on	O
k.	O
the	O
set	O
γ	O
slips	O
over	O
the	O
surface	O
as	O
the	O
direction	O
of	O
k	O
changes	O
.	O
for	O
example	O
,	O
with	O
s	O
a	O
sphere	O
,	O
γ	O
is	O
the	O
great	O
circle	O
orthogonal	B
to	O
k.	O
in	O
this	O
case	O
,	O
the	O
contour	B
generator	I
γ	O
is	O
a	O
plane	B
curve	O
,	O
but	O
in	O
general	O
γ	O
is	O
a	O
space	B
curve	I
.	O
we	O
next	O
describe	O
the	O
projection	B
properties	O
of	B
quadrics	I
.	O
for	O
this	O
class	O
of	O
surface	O
algebraic	B
expressions	O
can	O
be	O
developed	O
for	O
the	O
contour	B
generator	I
and	O
apparent	B
contour	O
.	O
8.3	O
action	O
of	O
a	O
projective	B
camera	I
on	O
quadrics	B
201	O
γ	O
c	O
fig	O
.	O
8.4.	O
the	O
cone	O
of	O
rays	O
for	O
a	O
quadric	O
.	O
the	O
vertex	O
of	O
the	O
cone	O
is	O
the	O
camera	B
centre	I
.	O
(	O
a	O
)	O
the	O
contour	B
generator	I
γ	O
of	O
a	O
quadric	O
is	O
a	O
plane	B
curve	O
(	O
a	O
conic	B
)	O
which	O
is	O
the	O
intersection	B
of	O
the	O
quadric	O
with	O
the	O
polar	O
plane	B
of	O
the	O
camera	B
centre	I
,	O
c.	O
8.3	O
action	O
of	O
a	O
projective	B
camera	I
on	O
quadrics	B
a	O
quadric	O
is	O
a	O
smooth	O
surface	O
and	O
so	O
its	O
outline	O
curve	O
is	O
given	O
by	O
points	O
where	O
the	O
back-projected	O
rays	O
are	O
tangent	O
to	O
the	O
quadric	O
surface	O
as	O
shown	O
in	O
ﬁgure	O
8.4.	O
suppose	O
the	O
quadric	O
is	O
a	O
sphere	O
,	O
then	O
the	O
cone	O
of	O
rays	O
between	O
the	O
camera	B
centre	I
and	O
quadric	O
is	O
right-circular	O
,	O
i.e	O
.	O
the	O
contour	B
generator	I
is	O
a	O
circle	O
,	O
with	O
the	O
plane	B
of	O
the	O
circle	O
orthogonal	B
to	O
the	O
line	B
joining	O
the	O
camera	B
and	O
sphere	O
centres	O
.	O
this	O
can	O
be	O
seen	O
from	O
the	O
rotational	O
symmetry	O
of	O
the	O
geometry	O
about	O
this	O
line	B
.	O
the	O
image	O
of	O
the	O
sphere	O
is	O
obtained	O
by	O
intersecting	O
the	O
cone	O
with	O
the	O
image	B
plane	I
.	O
it	O
is	O
clear	O
that	O
this	O
is	O
a	O
classical	O
conic	B
section	O
,	O
so	O
that	O
the	O
apparent	B
contour	O
of	O
a	O
sphere	O
is	O
a	O
conic	B
.	O
in	O
particular	O
if	O
the	O
sphere	O
centre	B
lies	O
on	O
the	O
principal	O
(	O
z	O
)	O
camera	B
axis	O
,	O
then	O
the	O
conic	B
is	O
a	O
circle	O
.	O
now	O
consider	O
a	O
3-space	O
projective	B
transformation	I
of	O
this	O
geometry	O
.	O
under	O
this	O
map	O
the	O
sphere	O
is	O
transformed	O
to	O
a	O
quadric	O
and	O
the	O
apparent	B
contour	O
to	O
a	O
conic	B
.	O
however	O
,	O
since	O
intersection	B
and	O
tangency	O
are	O
preserved	O
,	O
the	O
contour	B
generator	I
is	O
a	O
(	O
plane	B
)	O
conic	B
.	O
consequently	O
,	O
the	O
apparent	B
contour	O
of	O
a	O
general	O
quadric	O
is	O
a	O
conic	B
,	O
and	O
the	O
contour	B
gen-	O
erator	O
is	O
also	O
a	O
conic	B
.	O
we	O
will	O
now	O
give	O
algebraic	B
representations	O
for	O
these	O
geometric	B
results	O
.	O
forward	B
projection	I
of	O
quadrics	B
.	O
since	O
the	O
outline	O
arises	O
from	O
tangency	O
,	O
it	O
is	O
not	O
surprising	O
that	O
the	O
dual	B
of	O
the	O
quadric	O
,	O
q∗	O
,	O
is	O
important	O
here	O
since	O
it	O
deﬁnes	O
the	O
tangent	O
planes	O
to	O
the	O
quadric	O
q.	O
result	O
8.9.	O
under	O
the	O
camera	B
matrix	I
p	O
the	O
outline	O
of	O
the	O
quadric	O
q	O
is	O
the	O
conic	B
c	O
given	O
by	O
c∗	O
=	O
pq∗pt	O
.	O
(	O
8.5	O
)	O
proof	O
.	O
this	O
expression	O
is	O
simply	O
derived	O
from	O
the	O
observation	O
that	O
lines	B
l	O
tangent	O
to	O
the	O
conic	B
outline	O
satisfy	O
ltc∗l	O
=	O
0.	O
these	O
lines	B
back-project	O
to	O
planes	O
π	O
=	O
ptl	O
that	O
are	O
tangent	O
to	O
the	O
quadric	O
and	O
thus	O
satisfy	O
πtq∗π	O
=	O
0.	O
then	O
it	O
follows	O
that	O
for	O
each	O
line	B
πtq∗π	O
=	O
ltpq∗ptl	O
=	O
ltc∗l	O
=	O
0	O
202	O
8	O
more	O
single	O
view	O
geometry	O
and	O
since	O
this	O
is	O
true	O
for	O
all	O
lines	B
tangent	O
to	O
c	O
the	O
result	O
follows	O
.	O
note	O
the	O
similarity	B
of	O
(	O
8.5	O
)	O
with	O
the	O
projection	B
of	O
a	O
line	B
represented	O
by	O
a	O
pl¨ucker	O
ma-	O
trix	O
(	O
8.2	O
)	O
.	O
an	O
expression	O
for	O
the	O
projection	B
of	O
the	O
point	B
quadric	O
q	O
can	O
be	O
derived	O
from	O
(	O
8.5	O
)	O
but	O
it	O
is	O
quite	O
complicated	O
.	O
however	O
,	O
the	O
plane	B
of	O
the	O
contour	B
generator	I
is	O
easily	O
expressed	O
in	O
terms	O
of	O
q	O
:	O
•	O
the	O
plane	B
of	O
γ	O
for	O
a	O
quadric	O
q	O
and	O
camera	B
with	O
centre	B
c	O
is	O
given	O
by	O
πγ	O
=	O
qc	O
.	O
this	O
result	O
follows	O
directly	O
from	O
the	O
pole–polar	O
relation	O
for	O
a	O
point	O
and	O
quadric	O
of	O
section	O
3.2.3	O
(	O
p73	O
)	O
.	O
its	O
proof	O
is	O
left	O
as	O
an	O
exercise	O
.	O
note	O
,	O
the	O
intersection	B
of	O
a	O
quadric	O
and	O
plane	B
is	O
a	O
conic	B
.	O
so	O
γ	O
is	O
a	O
conic	B
and	O
its	O
image	O
γ	O
,	O
which	O
is	O
the	O
apparent	B
contour	O
,	O
is	O
also	O
a	O
conic	B
as	O
has	O
been	O
seen	O
above	O
.	O
we	O
may	O
also	O
derive	O
an	O
expression	O
for	O
the	O
cone	O
of	O
rays	O
formed	O
by	O
the	O
camera	B
centre	I
and	O
quadric	O
.	O
this	O
cone	O
is	O
a	O
degenerate	B
quadric	O
of	O
rank	O
3.	O
result	O
8.10.	O
the	O
cone	O
with	O
vertex	O
v	O
and	O
tangent	O
to	O
the	O
quadric	O
q	O
is	O
the	O
degenerate	B
quadric	O
qco	O
=	O
(	O
vtqv	O
)	O
q	O
−	O
(	O
qv	O
)	O
(	O
qv	O
)	O
t.	O
note	O
that	O
qcov	O
=	O
0	O
,	O
so	O
that	O
v	O
is	O
the	O
vertex	O
of	O
the	O
cone	O
as	O
required	O
.	O
the	O
proof	O
is	O
omitted	O
.	O
example	O
8.11.	O
we	O
write	O
the	O
quadric	O
in	O
block	O
form	O
:	O
(	O
cid:17	O
)	O
q	O
=	O
q3×3	O
q	O
qt	O
q44	O
(	O
cid:18	O
)	O
.	O
then	O
if	O
v	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
which	O
corresponds	O
to	O
the	O
cone	O
vertex	O
being	O
at	O
the	O
centre	B
of	O
the	O
world	O
coordinate	O
frame	O
,	O
(	O
cid:17	O
)	O
qco	O
=	O
q44q3×3	O
−	O
qqt	O
0	O
0t	O
(	O
cid:18	O
)	O
which	O
is	O
clearly	O
a	O
degenerate	B
quadric	O
.	O
0	O
(	O
cid:2	O
)	O
8.4	O
the	O
importance	O
of	O
the	O
camera	O
centre	B
an	O
object	O
in	O
3-space	O
and	O
camera	B
centre	I
deﬁne	O
a	O
set	O
of	O
rays	O
,	O
and	O
an	O
image	O
is	O
obtained	O
by	O
intersecting	O
these	O
rays	O
with	O
a	O
plane	B
.	O
often	O
this	O
set	O
is	O
referred	O
to	O
as	O
a	O
cone	O
of	O
rays	O
,	O
even	O
though	O
it	O
is	O
not	O
a	O
classical	O
cone	O
.	O
suppose	O
the	O
cone	O
of	O
rays	O
is	O
intersected	O
by	O
two	O
planes	O
,	O
as	O
shown	O
in	O
ﬁgure	O
8.5	O
,	O
then	O
the	O
two	O
images	O
,	O
i	O
and	O
i	O
,	O
are	O
clearly	O
related	O
by	O
a	O
perspective	O
map	O
.	O
this	O
means	O
that	O
images	O
obtained	O
with	O
the	O
same	O
camera	O
centre	O
may	O
be	O
mapped	O
to	O
one	O
another	O
by	O
a	O
plane	B
projective	O
transformation	B
,	O
in	O
other	O
words	O
they	O
are	O
projectively	O
equivalent	B
and	O
so	O
have	O
the	O
same	O
projective	O
properties	B
.	O
a	O
camera	B
can	O
thus	O
be	O
thought	O
of	O
as	O
a	O
projective	B
imaging	O
device	O
–	O
measuring	O
projective	B
properties	O
of	O
the	O
cone	O
of	O
rays	O
with	O
vertex	O
the	O
camera	B
centre	I
.	O
(	O
cid:2	O
)	O
the	O
result	O
that	O
the	O
two	O
images	O
i	O
and	O
i	O
are	O
related	O
by	O
a	O
homography	B
will	O
now	O
be	O
derived	O
algebraically	O
to	O
obtain	O
a	O
formula	O
for	O
this	O
homography	B
.	O
consider	O
two	O
cameras	O
(	O
cid:2	O
)	O
p	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
=	O
k	O
(	O
cid:2	O
)	O
r	O
(	O
cid:2	O
)	O
8.4	O
the	O
importance	O
of	O
the	O
camera	O
centre	B
203	O
c	O
x	O
/	O
x	O
x	O
fig	O
.	O
8.5.	O
the	O
cone	O
of	O
rays	O
with	O
vertex	O
the	O
camera	B
centre	I
.	O
an	O
image	O
is	O
obtained	O
by	O
intersecting	O
this	O
cone	O
with	O
a	O
plane	B
.	O
a	O
ray	O
between	O
a	O
3-space	O
point	B
x	O
and	O
the	O
camera	B
centre	I
c	O
pierces	O
the	O
planes	O
in	O
the	O
image	O
points	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
.	O
all	O
such	O
image	O
points	O
are	O
related	O
by	O
a	O
planar	O
homography	O
,	O
x	O
(	O
cid:1	O
)	O
=	O
hx	O
.	O
with	O
the	O
same	O
centre	O
.	O
note	O
that	O
since	O
the	O
cameras	B
have	O
a	O
common	O
centre	B
there	O
is	O
a	O
simple	O
relation	O
between	O
them	O
,	O
namely	O
p	O
(	O
cid:2	O
)	O
−1p	O
.	O
it	O
then	O
follows	O
that	O
the	O
images	O
of	O
a	O
3-space	O
point	B
x	O
by	O
the	O
two	O
cameras	O
are	O
related	O
as	O
=	O
(	O
k	O
(	O
cid:2	O
)	O
r	O
(	O
cid:2	O
)	O
)	O
(	O
kr	O
)	O
x	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
=	O
(	O
k	O
(	O
cid:2	O
)	O
r	O
(	O
cid:2	O
)	O
)	O
(	O
kr	O
)	O
−1px	O
=	O
(	O
k	O
(	O
cid:2	O
)	O
r	O
(	O
cid:2	O
)	O
)	O
(	O
kr	O
)	O
−1x	O
.	O
that	O
is	O
,	O
the	O
corresponding	O
image	O
points	O
are	O
related	O
by	O
a	O
planar	O
homography	O
(	O
a	O
3	O
×	O
3	O
matrix	B
)	O
as	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
,	O
where	O
h	O
=	O
(	O
k	O
(	O
cid:2	O
)	O
r	O
(	O
cid:2	O
)	O
)	O
(	O
kr	O
)	O
−1	O
.	O
we	O
will	O
now	O
investigate	O
several	O
cases	O
of	O
moving	O
the	O
image	B
plane	I
whilst	O
ﬁxing	O
the	O
camera	B
centre	I
.	O
for	O
simplicity	O
the	O
world	O
coordinate	O
frame	O
will	O
be	O
chosen	O
to	O
coincide	O
with	O
the	O
camera	B
’	O
s	O
,	O
so	O
that	O
p	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
(	O
and	O
it	O
will	O
be	O
assumed	O
that	O
the	O
image	B
plane	I
never	O
contains	O
the	O
centre	B
,	O
as	O
the	O
image	O
would	O
then	O
be	O
degenerate	B
)	O
.	O
8.4.1	O
moving	B
the	O
image	B
plane	I
consider	O
ﬁrst	O
an	O
increase	O
in	O
focal	O
length	O
.	O
to	O
a	O
ﬁrst	O
approximation	O
this	O
corresponds	O
to	O
a	O
displacement	O
of	O
the	O
image	O
plane	B
along	O
the	O
principal	O
axis	O
.	O
the	O
image	O
effect	O
is	O
a	O
simple	O
magniﬁcation	O
.	O
this	O
is	O
only	O
a	O
ﬁrst	O
approximation	O
because	O
with	O
a	O
compound	O
lens	O
zooming	O
will	O
perturb	O
both	O
the	O
principal	B
point	I
and	O
the	O
effective	O
camera	B
centre	I
.	O
algebraically	O
,	O
if	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
are	O
the	O
images	O
of	O
a	O
point	O
x	O
before	O
and	O
after	O
zooming	O
,	O
then	O
x	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
x	O
x	O
(	O
cid:2	O
)	O
=	O
k	O
(	O
cid:2	O
)	O
[	O
i	O
|	O
0	O
]	O
x	O
=	O
k	O
(	O
cid:2	O
)	O
k−1	O
(	O
k	O
[	O
i	O
|	O
0	O
]	O
x	O
)	O
=k	O
(	O
cid:2	O
)	O
k−1x	O
so	O
that	O
x	O
(	O
cid:2	O
)	O
a	O
short	O
calculation	O
shows	O
that	O
=	O
hx	O
with	O
h	O
=	O
k	O
(	O
cid:2	O
)	O
k−1	O
.	O
if	O
only	O
the	O
focal	O
lengths	O
differ	O
between	O
k	O
and	O
k	O
(	O
cid:2	O
)	O
then	O
(	O
cid:17	O
)	O
k	O
(	O
cid:2	O
)	O
k−1	O
=	O
ki	O
(	O
1	O
−	O
k	O
)	O
˜x0	O
0t	O
1	O
(	O
cid:18	O
)	O
.	O
where	O
˜x0	O
is	O
the	O
inhomogeneous	O
principal	O
point	B
,	O
and	O
k	O
=	O
f	O
/f	O
is	O
the	O
magniﬁcation	O
factor	O
.	O
this	O
result	O
follows	O
directly	O
from	O
similar	O
triangles	O
:	O
the	O
effect	O
of	O
zooming	O
by	O
a	O
(	O
cid:2	O
)	O
204	O
8	O
more	O
single	O
view	O
geometry	O
a	O
b	O
c	O
fig	O
.	O
8.6.	O
between	O
images	O
(	O
a	O
)	O
and	O
(	O
b	O
)	O
the	O
camera	B
rotates	O
about	O
the	O
camera	B
centre	I
.	O
corresponding	O
points	O
(	O
that	O
is	O
images	O
of	O
the	O
same	O
3d	O
point	B
)	O
are	O
related	O
by	O
a	O
plane	B
projective	O
transformation	B
.	O
note	O
that	O
3d	O
points	O
at	O
different	O
depths	O
which	O
are	O
coincident	O
in	O
image	O
(	O
a	O
)	O
,	O
such	O
as	O
the	O
mug	O
lip	O
and	O
cat	O
body	O
,	O
are	O
also	O
coincident	O
in	O
(	O
b	O
)	O
,	O
so	O
there	O
is	O
no	O
motion	O
parallax	B
in	O
this	O
case	O
.	O
however	O
,	O
between	O
images	O
(	O
a	O
)	O
and	O
(	O
c	O
)	O
the	O
camera	B
rotates	O
about	O
the	O
camera	B
centre	I
and	O
translates	O
.	O
under	O
this	O
general	B
motion	I
coincident	O
points	O
of	O
differing	O
depth	O
in	O
(	O
a	O
)	O
are	O
imaged	O
at	O
different	O
points	O
in	O
(	O
c	O
)	O
,	O
so	O
there	O
is	O
motion	O
parallax	B
in	O
this	O
case	O
due	O
to	O
the	O
camera	B
translation	I
.	O
factor	O
k	O
is	O
to	O
move	O
the	O
image	O
point	O
˜x	O
on	B
a	I
line	I
radiating	O
from	O
the	O
principal	B
point	I
˜x0	O
to	O
=	O
k˜x	O
+	O
(	O
1−	O
k	O
)	O
˜x0	O
.	O
algebraically	O
,	O
using	O
the	O
most	O
general	O
form	O
(	O
6.10–p157	O
)	O
the	O
point	B
˜x	O
(	O
cid:2	O
)	O
of	O
the	O
calibration	O
matrix	B
k	O
,	O
we	O
may	O
write	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
k	O
(	O
cid:2	O
)	O
=	O
=	O
(	O
cid:18	O
)	O
ki	O
(	O
1	O
−	O
k	O
)	O
˜x0	O
(	O
cid:17	O
)	O
0t	O
ka	O
˜x0	O
0t	O
1	O
=	O
k	O
1	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
k	O
=	O
ki	O
.	O
1	O
ki	O
(	O
1	O
−	O
k	O
)	O
˜x0	O
(	O
cid:18	O
)	O
0t	O
1	O
a	O
0t	O
˜x0	O
1	O
this	O
shows	O
that	O
•	O
the	O
effect	O
of	O
zooming	O
by	O
a	O
factor	O
k	O
is	O
to	O
multiply	O
the	O
calibration	B
matrix	I
k	O
on	O
the	O
right	O
by	O
diag	O
(	O
k	O
,	O
k	O
,	O
1	O
)	O
.	O
8.4.2	O
camera	B
rotation	I
a	O
second	O
common	O
example	O
is	O
where	O
the	O
camera	B
is	O
rotated	O
about	O
its	O
centre	B
with	O
no	O
change	O
in	O
the	O
internal	B
parameters	I
.	O
examples	B
of	O
this	O
“	O
pure	O
”	O
rotation	B
are	O
given	O
in	O
ﬁgure	O
8.6	O
and	O
ﬁgure	O
8.9.	O
algebraically	O
,	O
if	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
are	O
the	O
images	O
of	O
a	O
point	O
x	O
be-	O
fore	O
and	O
after	O
the	O
pure	O
rotation	B
x	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
x	O
x	O
(	O
cid:2	O
)	O
=	O
k	O
[	O
r	O
|	O
0	O
]	O
x	O
=	O
krk−1k	O
[	O
i	O
|	O
0	O
]	O
x	O
=	O
krk−1x	O
=	O
hx	O
with	O
h	O
=	O
krk−1	O
.	O
this	O
homography	B
is	O
a	O
conjugate	O
rotation	O
and	O
is	O
so	O
that	O
x	O
(	O
cid:2	O
)	O
discussed	O
further	O
in	O
section	O
a7.1	O
(	O
p628	O
)	O
.	O
for	O
now	O
,	O
we	O
mention	O
a	O
few	O
of	O
its	O
properties	B
by	O
way	O
of	O
an	O
example	O
.	O
example	O
8.12.	O
properties	B
of	O
a	O
conjugate	O
rotation	O
the	O
homography	B
h	O
=	O
krk−1	O
has	O
the	O
same	O
eigenvalues	O
(	O
up	O
to	O
scale	O
)	O
as	O
the	O
rotation	B
matrix	O
,	O
namely	O
{	O
µ	O
,	O
µeiθ	O
,	O
µe	O
−iθ	O
}	O
,	O
where	O
µ	O
is	O
an	O
unknown	O
scale	O
factor	O
(	O
if	O
h	O
is	O
scaled	O
such	O
that	O
det	O
h	O
=	O
1	O
,	O
then	O
µ	O
=	O
1	O
)	O
.	O
consequently	O
the	O
angle	B
of	O
rotation	B
between	O
views	O
may	O
be	O
computed	O
directly	O
from	O
the	O
phase	O
of	O
the	O
complex	O
eigenvalues	O
of	O
h.	O
similarly	O
,	O
it	O
can	O
be	O
8.4	O
the	O
importance	O
of	O
the	O
camera	O
centre	B
205	O
a	O
b	O
c	O
fig	O
.	O
8.7.	O
synthetic	O
views	O
.	O
(	O
a	O
)	O
source	O
image	O
.	O
(	O
b	O
)	O
fronto-parallel	O
view	O
of	O
the	O
corridor	O
ﬂoor	O
generated	O
from	O
(	O
a	O
)	O
using	O
the	O
four	O
corners	O
of	O
a	O
ﬂoor	O
tile	O
to	O
compute	O
the	O
homography	B
.	O
(	O
c	O
)	O
fronto-parallel	O
view	O
of	O
the	O
corridor	O
wall	O
generated	O
from	O
(	O
a	O
)	O
using	O
the	O
four	O
corners	O
of	O
the	O
door	O
frame	O
to	O
compute	O
the	O
homography	B
.	O
shown	O
(	O
see	O
exercises	O
)	O
that	O
the	O
eigenvector	O
of	O
h	O
corresponding	O
to	O
the	O
real	O
eigenvalue	O
is	O
the	O
vanishing	O
point	O
of	O
the	O
rotation	O
axis	O
.	O
for	O
example	O
,	O
between	O
images	O
(	O
a	O
)	O
and	O
(	O
b	O
)	O
of	O
ﬁgure	O
8.6	O
there	O
is	O
a	O
pure	O
rotation	B
of	O
the	O
camera	B
.	O
the	O
homography	B
h	O
is	O
computed	O
by	O
algorithm	B
4.6	O
(	O
p123	O
)	O
,	O
and	O
from	O
this	O
the	O
angle	B
of	O
rotation	B
is	O
estimated	O
as	O
4.66	O
,	O
and	O
the	O
axis	O
vanishing	O
point	B
as	O
(	O
−0.0088	O
,	O
1	O
,	O
0.0001	O
)	O
t	O
,	O
i.e	O
.	O
virtually	O
at	B
inﬁnity	I
in	O
the	O
y	O
direction	O
,	O
so	O
the	O
rotation	B
axis	O
(	O
cid:2	O
)	O
is	O
almost	O
parallel	B
to	O
the	O
y-axis	O
.	O
the	O
transformation	B
h	O
=	O
krk−1	O
is	O
an	O
example	O
of	O
the	O
inﬁnite	O
homography	B
mapping	O
h∞	O
,	O
that	O
will	O
appear	O
many	O
times	O
through	O
this	O
book	O
.	O
it	O
is	O
deﬁned	O
in	O
section	O
13.4	O
(	O
p338	O
)	O
.	O
the	O
conjugation	O
property	O
is	O
used	O
for	O
auto-calibration	O
in	O
chapter	O
19	O
.	O
◦	O
8.4.3	O
applications	O
and	O
examples	B
the	O
homographic	O
relation	B
between	O
images	O
with	O
the	O
same	O
camera	O
centre	O
can	O
be	O
ex-	O
ploited	O
in	O
several	O
ways	O
.	O
one	O
is	O
the	O
creation	O
of	O
synthetic	O
images	O
by	O
projective	B
warping	O
.	O
another	O
is	O
mosaicing	O
,	O
where	O
panoramic	O
images	O
can	O
be	O
created	O
by	O
using	O
planar	O
homo-	O
graphies	O
to	O
“	O
sew	O
”	O
together	O
views	O
obtained	O
by	O
a	O
rotating	O
camera	B
.	O
example	O
8.13.	O
synthetic	O
views	O
new	O
images	O
corresponding	O
to	O
different	O
camera	B
orientations	O
(	O
with	O
the	O
same	O
camera	O
centre	O
)	O
can	O
be	O
generated	O
from	O
an	O
existing	O
image	O
by	O
warping	O
with	O
planar	O
homographies	B
.	O
in	O
a	O
fronto-parallel	O
view	O
a	O
rectangle	O
is	O
imaged	O
as	O
a	O
rectangle	O
,	O
and	O
the	O
world	O
and	O
image	O
rectangle	O
have	O
the	O
same	O
aspect	O
ratio	O
.	O
conversely	O
,	O
a	O
fronto-parallel	O
view	O
can	O
be	O
synthesized	O
by	O
warping	O
an	O
image	O
with	O
the	O
homography	B
that	O
maps	O
a	O
rectangle	O
imaged	O
as	O
a	O
quadrilateral	O
to	O
a	O
rectangle	O
with	O
the	O
correct	O
aspect	O
ratio	O
.	O
the	O
algorithm	B
is	O
:	O
(	O
i	O
)	O
compute	O
the	O
homography	B
h	O
which	O
maps	O
the	O
image	O
quadrilateral	O
to	O
a	O
rectangle	O
with	O
the	O
correct	O
aspect	O
ratio	O
.	O
(	O
ii	O
)	O
projectively	O
warp	O
the	O
source	O
image	O
with	O
this	O
homography	B
.	O
examples	B
are	O
shown	O
in	O
ﬁgure	O
8.7	O
.	O
(	O
cid:2	O
)	O
206	O
8	O
more	O
single	O
view	O
geometry	O
  	O
	O
  	O
	O
 	O
  	O
	O
 	O
  	O
	O
 	O
  	O
 	O
 	O
	O
 	O
	O
  	O
 	O
 	O
	O
 	O
	O
fig	O
.	O
8.8.	O
three	O
images	O
acquired	O
by	O
a	O
rotating	O
camera	B
may	O
be	O
registered	O
to	O
the	O
frame	O
of	O
the	O
middle	O
one	O
,	O
as	O
shown	O
,	O
by	O
projectively	O
warping	O
the	O
outer	O
images	O
to	O
align	O
with	O
the	O
middle	O
one	O
.	O
example	O
8.14.	O
planar	O
panoramic	O
mosaicing	O
images	O
acquired	O
by	O
a	O
camera	B
rotating	O
about	O
its	O
centre	B
are	O
related	O
to	O
each	O
other	O
by	O
a	O
planar	O
homography	O
.	O
a	O
set	O
of	O
such	O
images	O
may	O
be	O
registered	O
with	O
the	O
plane	B
of	O
one	O
of	O
the	O
images	O
by	O
projectively	O
warping	O
the	O
other	O
images	O
,	O
as	O
illustrated	O
in	O
ﬁgure	O
8.8.	O
fig	O
.	O
8.9.	O
planar	O
panoramic	O
mosaicing	O
.	O
eight	O
images	O
(	O
out	O
of	O
thirty	O
)	O
acquired	O
by	O
rotating	O
a	O
camcorder	O
about	O
its	O
centre	B
.	O
the	O
thirty	O
images	O
are	O
registered	O
(	O
automatically	O
)	O
using	O
planar	O
homographies	B
and	O
com-	O
posed	O
into	O
the	O
single	O
panoramic	O
mosaic	O
shown	O
.	O
note	O
the	O
characteristic	O
“	O
bow	O
tie	O
”	O
shape	O
resulting	O
from	O
registering	O
to	O
an	O
image	O
at	O
the	O
middle	O
of	O
the	O
sequence	O
.	O
in	O
outline	O
the	O
algorithm	B
is	O
:	O
(	O
i	O
)	O
choose	O
one	O
image	O
of	O
the	O
set	O
as	O
a	O
reference	O
.	O
(	O
ii	O
)	O
compute	O
the	O
homography	B
h	O
which	O
maps	O
one	O
of	O
the	O
other	O
images	O
of	O
the	O
set	O
to	O
this	O
reference	O
image	O
.	O
8.4	O
the	O
importance	O
of	O
the	O
camera	O
centre	B
207	O
(	O
iii	O
)	O
projectively	O
warp	O
the	O
image	O
with	O
this	O
homography	B
,	O
and	O
augment	O
the	O
reference	O
image	O
with	O
the	O
non-overlapping	O
part	O
of	O
the	O
warped	O
image	O
.	O
(	O
iv	O
)	O
repeat	O
the	O
last	O
two	O
steps	O
for	O
the	O
remaining	O
images	O
of	O
the	O
set	O
.	O
the	O
homographies	B
may	O
be	O
computed	O
by	O
identifying	O
(	O
at	O
least	O
)	O
four	O
corresponding	O
points	O
,	O
or	O
by	O
using	O
the	O
automatic	O
method	O
of	O
algorithm	O
4.6	O
(	O
p123	O
)	O
.	O
an	O
example	O
mo-	O
(	O
cid:2	O
)	O
saic	O
is	O
shown	O
in	O
ﬁgure	O
8.9	O
.	O
8.4.4	O
projective	B
(	O
reduced	B
)	O
notation	O
it	O
will	O
be	O
seen	O
in	O
chapter	O
20	O
that	O
if	O
canonical	O
projective	O
coordinates	B
are	O
chosen	O
for	O
world	O
and	O
image	O
points	O
,	O
i.e	O
.	O
x1	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
x2	O
=	O
(	O
0	O
,	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
x3	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
,	O
x4	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
and	O
x1	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
x2	O
=	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
,	O
x3	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
x4	O
=	O
(	O
1	O
,	O
1	O
,	O
1	O
)	O
t	O
,	O
then	O
the	O
camera	B
matrix	I
	O
a	O
0	O
0	O
−d	O
	O
p	O
=	O
0	O
b	O
0	O
−d	O
0	O
0	O
c	O
−d	O
−1	O
)	O
t	O
=	O
0	O
,	O
which	O
means	O
−1	O
,	O
b	O
satisﬁes	O
xi	O
=	O
pxi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
,	O
and	O
also	O
that	O
p	O
(	O
a	O
−1	O
)	O
t.	O
this	O
is	O
known	O
as	O
the	O
reduced	B
−1	O
,	O
d	O
that	O
the	O
camera	B
centre	I
is	O
c	O
=	O
(	O
a	O
camera	B
matrix	I
,	O
and	O
it	O
is	O
clearly	O
completely	O
speciﬁed	O
by	O
the	O
3	O
degrees	B
of	I
freedom	I
of	O
the	O
camera	B
centre	I
c.	O
this	O
is	O
a	O
further	O
illustration	O
of	O
the	O
fact	O
that	O
all	O
images	O
acquired	O
by	O
cameras	B
with	O
the	O
same	O
camera	O
centre	O
are	O
projectively	O
equivalent	B
–	O
the	O
camera	B
has	O
been	O
reduced	B
to	O
its	O
essence	O
:	O
a	O
projective	B
device	O
whose	O
action	O
is	O
to	O
map	O
ip3	O
to	O
ip2	O
with	O
only	O
the	O
position	O
of	O
the	O
camera	O
centre	B
affecting	O
the	O
result	O
.	O
this	O
camera	B
representation	O
is	O
used	O
in	O
establishing	O
duality	B
relations	O
in	O
chapter	O
20	O
.	O
−1	O
,	O
d	O
−1	O
,	O
c	O
−1	O
,	O
b	O
−1	O
,	O
c	O
(	O
8.6	O
)	O
8.4.5	O
moving	B
the	O
camera	B
centre	I
the	O
cases	O
of	O
zooming	O
and	O
camera	B
rotation	I
illustrate	O
that	O
moving	B
the	O
image	B
plane	I
,	O
whilst	O
ﬁxing	O
the	O
camera	B
centre	I
,	O
induces	O
a	O
transformation	B
between	O
images	O
that	O
depends	O
only	O
on	O
the	O
image	B
plane	I
motion	O
,	O
but	O
not	O
on	O
the	O
3-space	O
structure	B
.	O
conversely	O
,	O
no	O
information	O
on	O
3-space	O
structure	B
can	O
be	O
obtained	O
by	O
this	O
action	O
.	O
however	O
,	O
if	O
the	O
camera	B
centre	I
is	O
moved	O
then	O
the	O
map	O
between	O
corresponding	O
image	O
points	O
does	O
depend	O
on	O
the	O
3-space	O
structure	B
,	O
and	O
indeed	O
may	O
often	O
be	O
used	O
to	O
(	O
partially	O
)	O
determine	O
the	O
structure	B
.	O
this	O
is	O
the	O
subject	O
of	O
much	O
of	O
the	O
remainder	O
of	O
this	O
book	O
.	O
how	O
can	O
one	O
determine	O
from	O
the	O
images	O
alone	O
whether	O
the	O
camera	B
centre	I
has	O
moved	O
?	O
consider	O
two	O
3-space	O
points	O
which	O
have	O
coincident	O
images	O
in	O
the	O
ﬁrst	O
view	O
,	O
i.e	O
.	O
the	O
points	O
are	O
on	O
the	O
same	O
ray	O
.	O
if	O
the	O
camera	B
centre	I
is	O
moved	O
(	O
not	O
along	O
that	O
ray	O
)	O
the	O
image	O
coincidence	O
is	O
lost	O
.	O
this	O
relative	O
displacement	O
of	O
previously	O
coincident	O
im-	O
age	O
points	O
is	O
termed	O
parallax	B
,	O
and	O
is	O
illustrated	O
in	O
ﬁgure	O
8.6	O
and	O
shown	O
schematically	O
in	O
ﬁgure	O
8.10.	O
if	O
the	O
scene	O
is	O
static	O
and	O
motion	O
parallax	B
is	O
evident	O
between	O
two	O
views	O
then	O
the	O
camera	B
centre	I
has	O
moved	O
.	O
indeed	O
,	O
a	O
convenient	O
method	O
for	O
obtaining	O
a	O
camera	B
208	O
8	O
more	O
single	O
view	O
geometry	O
x	O
1	O
l	O
x	O
c	O
x	O
2	O
x/	O
2	O
x	O
/	O
1	O
c	O
/	O
fig	O
.	O
8.10.	O
motion	O
parallax	B
.	O
the	O
images	O
of	O
the	O
space	O
points	O
x1	O
and	O
x2	O
are	O
coincident	O
when	O
viewed	O
by	O
the	O
camera	B
with	O
centre	B
c.	O
however	O
,	O
when	O
viewed	O
by	O
a	O
camera	B
with	O
centre	B
c	O
(	O
cid:1	O
)	O
,	O
which	O
does	O
not	O
lie	O
on	O
the	O
line	B
l	O
through	O
x1	O
and	O
x2	O
,	O
the	O
images	O
of	O
the	O
space	O
points	O
are	O
not	O
coincident	O
.	O
in	O
fact	O
the	O
line	B
through	O
the	O
image	O
points	O
x	O
(	O
cid:1	O
)	O
2	O
is	O
the	O
image	O
of	O
the	O
ray	O
l	O
,	O
and	O
will	O
be	O
seen	O
in	O
chapter	O
9	O
to	O
be	O
an	O
epipolar	B
line	I
.	O
the	O
vector	O
between	O
the	O
points	O
x	O
(	O
cid:1	O
)	O
2	O
is	O
the	O
parallax	B
.	O
1	O
and	O
x	O
(	O
cid:1	O
)	O
1	O
and	O
x	O
(	O
cid:1	O
)	O
motion	O
that	O
is	O
only	O
a	O
rotation	B
about	O
its	O
centre	B
(	O
for	O
example	O
for	O
a	O
camera	O
mounted	O
on	O
a	O
robot	O
head	O
)	O
is	O
to	O
adjust	O
the	O
motion	O
until	O
there	O
is	O
no	O
parallax	O
.	O
an	O
important	O
special	O
case	O
of	O
3-space	O
structure	B
is	O
when	O
all	O
scene	O
points	O
are	O
coplanar	O
.	O
in	O
this	O
case	O
the	O
images	O
of	O
corresponding	O
points	O
are	O
related	O
by	O
a	O
planar	O
homography	O
even	O
if	O
the	O
camera	B
centre	I
is	O
moved	O
.	O
the	O
map	O
between	O
images	O
in	O
this	O
case	O
is	O
discussed	O
in	O
detail	O
in	O
chapter	O
13	O
on	O
planes	O
.	O
in	O
particular	O
vanishing	B
points	I
,	O
which	O
are	O
images	O
of	B
points	I
on	O
the	O
plane	B
π∞	O
,	O
are	O
related	O
by	O
a	O
planar	O
homography	O
for	O
any	O
camera	B
motion	I
.	O
we	O
return	O
to	O
this	O
in	O
section	O
8.6	O
.	O
8.5	O
camera	B
calibration	I
and	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
up	O
to	O
this	O
point	B
we	O
have	O
discussed	O
projective	B
properties	O
of	O
the	O
forward	O
and	O
back-	O
projection	B
of	O
various	O
entities	O
(	O
point	B
,	O
lines	B
,	O
conics	O
.	O
.	O
.	O
)	O
.	O
these	O
properties	B
depend	O
only	O
on	O
the	O
3×	O
4	O
form	B
of	I
the	O
projective	B
camera	I
matrix	O
p.	O
now	O
we	O
describe	O
what	O
is	O
gained	O
if	O
the	O
camera	B
internal	O
calibration	B
,	O
k	O
,	O
is	O
known	O
.	O
it	O
will	O
be	O
seen	O
that	O
euclidean	O
properties	O
,	O
such	O
as	O
the	O
angle	B
between	O
two	O
rays	O
,	O
can	O
then	O
be	O
measured	O
.	O
what	O
does	O
calibration	B
give	O
?	O
an	O
image	O
point	O
x	O
back-projects	O
to	O
a	O
ray	O
deﬁned	O
by	O
x	O
and	O
points	O
on	O
the	O
ray	O
are	O
written	O
as	O
(	O
cid:22	O
)	O
x	O
=	O
λd	O
in	O
the	O
camera	B
euclidean	O
coordinate	O
frame	O
,	O
then	O
the	O
camera	B
centre	I
.	O
calibration	B
relates	O
the	O
image	O
point	O
to	O
the	O
ray	O
’	O
s	O
direction	O
.	O
suppose	O
these	O
points	O
map	O
to	O
the	O
point	B
x	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
(	O
λdt	O
,	O
1	O
)	O
t	O
=	O
kd	O
up	O
to	O
scale	O
.	O
conversely	O
the	O
direction	O
d	O
is	O
obtained	O
from	O
the	O
image	O
point	O
x	O
as	O
d	O
=	O
k−1x	O
.	O
thus	O
we	O
have	O
established	O
:	O
result	O
8.15.	O
the	O
camera	B
calibration	I
matrix	O
k	O
is	O
the	O
(	O
afﬁne	B
)	O
transformation	B
between	O
x	O
and	O
the	O
ray	O
’	O
s	O
direction	O
d	O
=	O
k−1x	O
measured	O
in	O
the	O
camera	B
’	O
s	O
euclidean	O
coordinate	O
frame	O
.	O
note	O
,	O
d	O
=	O
k−1x	O
is	O
in	O
general	O
not	O
a	O
unit	O
vector	O
.	O
8.5	O
camera	B
calibration	I
and	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
209	O
c	O
θ	O
x1	O
x2	O
d1	O
d	O
2	O
fig	O
.	O
8.11.	O
the	O
angle	B
θ	O
between	B
two	I
rays	I
.	O
the	O
angle	B
between	O
two	O
rays	O
,	O
with	O
directions	O
d1	O
,	O
d2	O
corresponding	O
to	O
image	O
points	O
x1	O
,	O
x2	O
respectively	O
,	O
may	O
be	O
obtained	O
from	O
the	O
familiar	O
cosine	B
formula	I
for	O
the	O
angle	B
between	O
two	O
vectors	O
:	O
cos	O
θ	O
=	O
=	O
dt	O
1	O
d1	O
dt	O
1	O
(	O
cid:19	O
)	O
(	O
cid:19	O
)	O
(	O
cid:19	O
)	O
d2	O
(	O
cid:19	O
)	O
(	O
k−1x1	O
)	O
t	O
(	O
k−1x1	O
)	O
dt	O
d2	O
(	O
cid:19	O
)	O
2	O
1	O
(	O
k−tk−1	O
)	O
x2	O
xt	O
=	O
.	O
(	O
k−1x1	O
)	O
t	O
(	O
k−1x2	O
)	O
(	O
cid:19	O
)	O
(	O
k−1x2	O
)	O
t	O
(	O
k−1x2	O
)	O
1	O
(	O
k−tk−1	O
)	O
x1	O
xt	O
2	O
(	O
k−tk−1	O
)	O
x2	O
xt	O
(	O
8.7	O
)	O
the	O
formula	O
(	O
8.7	O
)	O
shows	O
that	O
if	O
k	O
,	O
and	O
consequently	O
the	O
matrix	B
k−tk−1	O
,	O
is	O
known	O
,	O
then	O
the	O
angle	B
between	O
rays	O
can	O
be	O
measured	O
from	O
their	O
corresponding	O
image	O
points	O
.	O
a	O
camera	B
for	O
which	O
k	O
is	O
known	O
is	O
termed	O
calibrated	B
.	O
a	O
calibrated	B
camera	O
is	O
a	O
direction	O
sensor	O
,	O
able	O
to	O
measure	O
the	O
direction	O
of	O
rays	O
–	O
like	O
a	O
2d	O
protractor	O
.	O
the	O
calibration	B
matrix	I
k	O
also	O
provides	O
a	O
relation	B
between	O
an	O
image	O
line	O
and	O
a	O
scene	O
plane	O
:	O
result	O
8.16.	O
an	O
image	O
line	O
l	O
deﬁnes	O
a	O
plane	B
through	O
the	O
camera	B
centre	I
with	O
normal	O
direction	O
n	O
=	O
ktl	O
measured	O
in	O
the	O
camera	B
’	O
s	O
euclidean	O
coordinate	O
frame	O
.	O
note	O
,	O
the	O
normal	O
n	O
will	O
not	O
in	O
general	O
be	O
a	O
unit	O
vector	O
.	O
proof	O
.	O
points	O
x	O
on	O
the	O
line	B
l	O
back-project	O
to	O
directions	O
d	O
=	O
k−1x	O
which	O
are	O
orthogonal	B
to	O
the	O
plane	B
normal	O
n	O
,	O
and	O
thus	O
satisfy	O
dtn	O
=	O
xtk−tn	O
=	O
0.	O
since	O
points	O
on	O
l	O
satisfy	O
xtl	O
=	O
0	O
,	O
it	O
follows	O
that	O
l	O
=	O
k−tn	O
,	O
and	O
hence	O
n	O
=	O
ktl	O
.	O
8.5.1	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
we	O
now	O
derive	O
a	O
very	O
important	O
result	O
which	O
relates	O
the	O
calibration	B
matrix	I
k	O
to	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
ω.	O
first	O
we	O
must	O
determine	O
the	O
map	O
between	O
the	O
plane	O
at	O
inﬁnity	O
,	O
π∞	O
,	O
and	O
the	O
camera	B
image	O
plane	B
.	O
points	O
on	O
π∞	O
may	O
be	O
written	O
as	O
x∞	O
=	O
(	O
dt	O
,	O
0	O
)	O
t	O
,	O
and	O
are	O
imaged	O
by	O
a	O
general	O
camera	O
p	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
as	O
x	O
=	O
px∞	O
=	O
kr	O
[	O
i	O
|	O
−	O
(	O
cid:22	O
)	O
c	O
]	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
d	O
0	O
=	O
krd	O
.	O
this	O
shows	O
that	O
210	O
8	O
more	O
single	O
view	O
geometry	O
•	O
the	O
mapping	O
between	O
π∞	O
and	O
an	O
image	O
is	O
given	O
by	O
the	O
planar	O
homography	O
x	O
=	O
hd	O
with	O
h	O
=	O
kr	O
.	O
(	O
8.8	O
)	O
note	O
that	O
this	O
map	O
is	O
independent	O
of	O
the	O
position	O
of	O
the	O
camera	O
,	O
c	O
,	O
and	O
depends	O
only	O
on	O
the	O
camera	B
internal	O
calibration	B
and	O
orientation	B
with	O
respect	O
to	O
the	O
world	O
coordinate	O
frame	O
.	O
now	O
,	O
since	O
the	O
absolute	O
conic	O
ω∞	O
(	O
section	O
3.6	O
(	O
p81	O
)	O
)	O
is	O
on	O
π∞	O
we	O
can	O
compute	O
its	O
image	O
under	O
h	O
,	O
and	O
ﬁnd	O
of	O
the	O
absolute	O
image	O
−1	O
=	O
k−tk−1	O
.	O
result	O
8.17.	O
the	O
ω	O
=	O
(	O
kkt	O
)	O
proof	O
.	O
from	O
result	O
2.13	O
(	O
p37	O
)	O
under	O
a	O
point	B
homography	O
x	O
(	O
cid:6	O
)	O
→	O
hx	O
a	O
conic	B
c	O
maps	O
as	O
c	O
(	O
cid:6	O
)	O
→	O
h−tch−1	O
.	O
it	O
follows	O
that	O
ω∞	O
,	O
which	O
is	O
the	O
conic	B
c	O
=	O
ω∞	O
=	O
i	O
on	O
π∞	O
,	O
maps	O
to	O
ω	O
=	O
(	O
kr	O
)	O
−1	O
=	O
k−trr−1k−1	O
=	O
(	O
kkt	O
)	O
−1	O
.	O
so	O
the	O
iac	O
ω	O
=	O
(	O
kkt	O
)	O
−ti	O
(	O
kr	O
)	O
conic	B
conic	O
−1	O
.	O
(	O
the	O
iac	O
)	O
is	O
the	O
like	O
ω∞	O
the	O
conic	B
ω	O
is	O
an	O
imaginary	O
point	B
conic	O
with	O
no	O
real	O
points	O
.	O
for	O
the	O
moment	O
it	O
may	O
be	O
thought	O
of	O
as	O
a	O
convenient	O
algebraic	B
device	O
,	O
but	O
it	O
will	O
be	O
used	O
in	O
computations	O
later	O
in	O
this	O
chapter	O
,	O
and	O
also	O
in	O
chapter	O
19	O
on	O
camera	O
auto-calibration	B
.	O
a	O
few	O
remarks	O
here	O
:	O
(	O
i	O
)	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
ω	O
,	O
depends	O
only	O
on	O
the	O
internal	B
parameters	I
k	O
of	O
the	O
matrix	O
p	O
;	O
it	O
does	O
not	O
depend	O
on	O
the	O
camera	B
orientation	I
or	O
position	O
.	O
(	O
ii	O
)	O
it	O
follows	O
from	O
(	O
8.7	O
)	O
that	O
the	O
angle	B
between	O
two	O
rays	O
is	O
given	O
by	O
the	O
simple	O
expression	O
cos	O
θ	O
=	O
(	O
cid:19	O
)	O
xt	O
1	O
(	O
cid:19	O
)	O
xt	O
1	O
ωx1	O
ωx2	O
xt	O
2	O
.	O
ωx2	O
(	O
8.9	O
)	O
this	O
expression	O
is	O
independent	O
of	O
the	O
projective	O
coordinate	O
frame	O
in	O
the	O
image	O
,	O
that	O
is	O
,	O
it	O
is	O
unchanged	O
under	O
projective	B
transformation	I
of	O
the	O
image	O
.	O
to	O
see	O
this	O
consider	O
any	O
2d	O
projective	B
transformation	I
,	O
h.	O
the	O
points	O
xi	O
are	O
transformed	O
to	O
hxi	O
,	O
and	O
ω	O
transforms	O
(	O
as	O
any	O
image	O
conic	O
)	O
to	O
h−tωh−1	O
.	O
thus	O
,	O
(	O
8.9	O
)	O
is	O
unchanged	O
,	O
and	O
hence	O
holds	O
in	O
any	O
projective	B
coordinate	O
frame	O
in	O
the	O
image	O
.	O
(	O
iii	O
)	O
a	O
particularly	O
important	O
specialization	O
of	O
(	O
8.9	O
)	O
is	O
that	O
if	O
two	O
image	O
points	O
x1	O
and	O
x2	O
correspond	O
to	O
orthogonal	O
directions	O
then	O
xt	O
1	O
ωx2	O
=	O
0	O
.	O
(	O
8.10	O
)	O
this	O
equation	O
will	O
be	O
used	O
at	O
several	O
points	O
later	O
in	O
the	O
book	O
as	O
it	O
provides	O
a	O
linear	B
constraint	O
on	O
ω	O
.	O
(	O
iv	O
)	O
we	O
may	O
also	O
deﬁne	O
the	O
dual	B
image	I
of	I
the	I
absolute	I
conic	I
(	O
the	O
diac	O
)	O
as	O
ω∗	O
=	O
ω−1	O
=	O
kkt	O
.	O
(	O
8.11	O
)	O
this	O
is	O
a	O
dual	B
(	O
line	B
)	O
conic	B
,	O
whereas	O
ω	O
is	O
a	O
point	B
conic	O
(	O
though	O
it	O
contains	O
no	O
real	O
points	O
)	O
.	O
the	O
conic	B
ω∗	O
∞	O
and	O
is	O
given	O
by	O
(	O
8.5	O
)	O
ω∗	O
is	O
the	O
image	O
of	O
q∗	O
=	O
pq∗	O
∞pt	O
.	O
8.5	O
camera	B
calibration	I
and	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
211	O
(	O
v	O
)	O
result	O
8.17	O
shows	O
that	O
once	O
ω	O
(	O
or	O
equivalently	O
ω∗	O
)	O
is	O
identiﬁed	O
in	O
an	O
image	O
then	O
k	O
is	O
also	O
determined	O
.	O
this	O
follows	O
because	O
a	O
symmetric	B
matrix	O
ω	O
may	O
be	O
uniquely	O
decomposed	O
into	O
a	O
product	O
ω∗	O
=	O
kkt	O
of	O
an	O
upper-triangular	O
matrix	B
with	O
positive	O
diagonal	O
entries	O
and	O
its	O
transpose	O
by	O
the	O
cholesky	O
factorization	B
(	O
see	O
result	O
a4.5	O
(	O
p582	O
)	O
)	O
.	O
(	O
vi	O
)	O
it	O
was	O
seen	O
in	O
chapter	O
3	O
that	O
a	O
plane	B
π	O
intersects	O
π∞	O
in	O
a	O
line	B
,	O
and	O
this	O
line	B
intersects	O
ω∞	O
in	O
two	O
points	O
which	O
are	O
the	O
circular	B
points	I
of	O
π.	O
the	O
imaged	O
circular	B
points	I
lie	O
on	O
ω	O
at	O
the	O
points	O
at	O
which	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
π	O
intersects	O
ω.	O
these	O
ﬁnal	O
two	O
properties	O
of	O
ω	O
are	O
the	O
basis	O
for	O
a	O
calibration	O
algorithm	B
,	O
as	O
shown	O
in	O
the	O
following	O
example	O
.	O
example	O
8.18.	O
a	O
simple	O
calibration	O
device	O
the	O
image	O
of	O
three	O
squares	O
(	O
on	O
planes	O
which	O
are	O
not	O
parallel	B
,	O
but	O
which	O
need	O
not	O
be	O
orthogonal	B
)	O
provides	O
sufﬁciently	O
many	O
constraints	B
to	O
compute	O
k.	O
consider	O
one	O
of	O
the	O
squares	O
.	O
the	O
correspondences	B
between	O
its	O
four	O
corner	O
points	O
and	O
their	O
images	O
deﬁne	O
the	O
homography	B
h	O
between	O
the	O
plane	B
π	O
of	O
the	O
square	O
and	O
the	O
image	O
.	O
applying	O
this	O
homography	B
to	O
circular	B
points	I
on	O
π	O
determines	O
their	O
images	O
as	O
h	O
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
t.	O
thus	O
we	O
have	O
two	O
points	O
on	O
the	O
(	O
as	O
yet	O
unknown	O
)	O
ω.	O
a	O
similar	O
procedure	O
applied	O
to	O
the	O
other	O
squares	O
generates	O
a	O
total	O
of	O
six	O
points	O
on	O
ω	O
,	O
from	O
which	O
it	O
may	O
be	O
computed	O
(	O
since	O
ﬁve	O
points	O
are	O
required	O
to	O
determine	O
a	O
conic	B
)	O
.	O
in	O
outline	O
the	O
algorithm	B
has	O
the	O
following	O
steps	O
:	O
(	O
i	O
)	O
for	O
each	O
square	O
compute	O
the	O
homography	B
h	O
that	O
maps	O
its	O
corner	O
points	O
,	O
(	O
0	O
,	O
0	O
)	O
t	O
,	O
(	O
1	O
,	O
0	O
)	O
t	O
,	O
(	O
0	O
,	O
1	O
)	O
t	O
,	O
(	O
1	O
,	O
1	O
)	O
t	O
,	O
to	O
their	O
imaged	O
points	O
.	O
(	O
the	O
alignment	O
of	O
the	O
plane	O
coordinate	O
system	O
with	O
the	O
square	O
is	O
a	O
similarity	B
transformation	I
and	O
does	O
not	O
affect	O
the	O
position	O
of	O
the	O
circular	O
points	O
on	O
the	O
plane	B
)	O
.	O
(	O
ii	O
)	O
compute	O
the	O
imaged	O
circular	B
points	I
for	O
the	O
plane	B
of	O
that	O
square	O
as	O
h	O
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
t.	O
writing	O
h	O
=	O
[	O
h1	O
,	O
h2	O
,	O
h3	O
]	O
,	O
the	O
imaged	O
circular	B
points	I
are	O
h1	O
±	O
ih2	O
.	O
(	O
iii	O
)	O
fit	O
a	O
conic	B
ω	O
to	O
the	O
six	O
imaged	O
circular	B
points	I
.	O
the	O
constraint	O
that	O
the	O
imaged	O
circular	B
points	I
lie	O
on	O
ω	O
may	O
be	O
rewritten	O
as	O
two	O
real	O
constraints	B
.	O
if	O
h1	O
±	O
ih2	O
t	O
ω	O
(	O
h1	O
±	O
ih2	O
)	O
=	O
0	O
,	O
and	O
the	O
imaginary	O
and	O
real	O
parts	O
lies	O
on	O
ω	O
then	O
(	O
h1	O
±	O
ih2	O
)	O
give	O
respectively	O
:	O
ht	O
1	O
ωh2	O
=	O
0	O
and	O
ht	O
1	O
ωh1	O
=	O
ht	O
2	O
ωh2	O
(	O
8.12	O
)	O
which	O
are	O
equations	O
linear	B
in	O
ω.	O
the	O
conic	B
ω	O
is	O
determined	O
up	O
to	O
scale	O
from	O
ﬁve	O
or	O
more	O
such	O
equations	O
.	O
−1	O
using	O
the	O
cholesky	O
factorization	B
.	O
(	O
iv	O
)	O
compute	O
the	O
calibration	B
k	O
from	O
ω	O
=	O
(	O
kkt	O
)	O
figure	O
8.12	O
shows	O
a	O
calibration	B
object	O
consisting	O
of	O
three	O
planes	O
imprinted	O
with	O
squares	O
,	O
and	O
the	O
computed	O
matrix	O
k.	O
for	O
the	O
purpose	O
of	O
internal	O
calibration	B
,	O
the	O
squares	O
have	O
the	O
advantage	O
over	O
a	O
standard	O
calibration	B
object	O
(	O
e.g	O
.	O
ﬁgure	O
7.1	O
(	O
p182	O
)	O
)	O
that	O
no	O
(	O
cid:2	O
)	O
measured	O
3d	O
co-ordinates	O
are	O
required	O
.	O
212	O
8	O
more	O
single	O
view	O
geometry	O
(	O
cid:17	O
)	O
k	O
=	O
1108.3	O
−9.8	O
1097.8	O
0	O
0	O
0	O
(	O
cid:18	O
)	O
525.8	O
395.9	O
1	O
a	O
b	O
fig	O
.	O
8.12.	O
calibration	B
from	O
metric	B
planes	O
.	O
(	O
a	O
)	O
three	O
squares	O
provide	O
a	O
simple	O
calibration	O
object	O
.	O
the	O
planes	O
need	O
not	O
be	O
orthogonal	B
.	O
(	O
b	O
)	O
the	O
computed	O
calibration	O
matrix	B
using	O
the	O
algorithm	B
of	O
example	O
8.18.	O
the	O
image	O
size	O
is	O
1024	O
×	O
768	O
pixels	O
.	O
x	O
1	O
a	O
ω	O
x	O
2	O
image	O
ω	O
x	O
b	O
l	O
image	O
fig	O
.	O
8.13.	O
orthogonality	B
represented	O
by	O
conjugacy	B
and	O
pole–polar	O
relationships	O
.	O
(	O
a	O
)	O
image	O
points	O
x1	O
,	O
x2	O
back-project	O
to	O
orthogonal	O
rays	O
if	O
the	O
points	O
are	O
conjugate	O
with	O
respect	O
to	O
ω	O
,	O
i.e	O
.	O
xt	O
1	O
ωx2	O
=	O
0	O
.	O
(	O
b	O
)	O
the	O
point	B
x	O
and	O
line	B
l	O
back-project	O
to	O
a	O
ray	O
and	O
plane	B
that	O
are	O
orthogonal	B
if	O
x	O
and	O
l	O
are	O
pole–polar	O
with	O
respect	O
to	O
ω	O
,	O
i.e	O
.	O
l	O
=	O
ωx	O
.	O
for	O
example	O
(	O
see	O
section	O
8.6.3	O
)	O
,	O
the	O
vanishing	O
point	O
of	O
the	O
normal	O
direction	O
to	O
a	O
plane	B
and	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
are	O
pole–polar	O
with	O
respect	O
to	O
ω.	O
we	O
will	O
return	O
to	O
camera	O
calibration	B
in	O
section	O
8.8	O
,	O
where	O
vanishing	B
points	I
and	O
lines	B
provide	O
constraints	B
on	O
k.	O
the	O
geometric	B
constraints	O
that	O
are	O
used	O
in	O
example	O
8.18	O
are	O
discussed	O
further	O
in	O
section	O
8.8.1	O
.	O
8.5.2	O
orthogonality	O
and	O
ω	O
the	O
conic	B
ω	O
is	O
a	O
device	O
for	O
representing	O
orthogonality	O
in	O
an	O
image	O
.	O
it	O
has	O
already	O
been	O
seen	O
(	O
8.10	O
)	O
that	O
if	O
two	O
image	O
points	O
x1	O
and	O
x2	O
back-project	O
to	O
orthogonal	O
rays	O
,	O
then	O
the	O
points	O
satisfy	O
xt	O
1	O
ωx2	O
=	O
0.	O
similarly	O
,	O
it	O
may	O
be	O
shown	O
that	O
result	O
8.19.	O
a	O
point	B
x	O
and	O
line	B
l	O
back-projecting	O
to	O
a	O
ray	O
and	O
plane	B
respectively	O
that	O
are	O
orthogonal	B
are	O
related	O
by	O
l	O
=	O
ωx	O
.	O
geometrically	O
these	O
relations	O
express	O
that	O
image	O
points	O
back-projecting	O
to	O
orthogonal	O
rays	O
are	O
conjugate	O
with	O
respect	O
to	O
ω	O
(	O
xt	O
ωx2	O
=	O
0	O
)	O
,	O
and	O
that	O
a	O
point	O
and	O
line	O
back-	O
1	O
projecting	O
to	O
an	O
orthogonal	B
ray	O
and	O
plane	B
are	O
in	O
a	O
pole–polar	B
relationship	I
(	O
l	O
=	O
ωx	O
)	O
.	O
see	O
section	O
2.8.1	O
(	O
p58	O
)	O
.	O
a	O
schematic	O
representation	B
of	O
these	O
two	O
relations	O
is	O
given	O
in	O
ﬁgure	O
8.13	O
.	O
8.6	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
213	O
these	O
geometric	B
representations	O
of	O
orthogonality	O
,	O
and	O
indeed	O
the	O
projective	B
repre-	O
sentation	O
(	O
8.9	O
)	O
of	O
the	O
angle	O
between	B
two	I
rays	I
measured	O
from	O
image	O
points	O
,	O
are	O
simply	O
specializations	O
and	O
a	O
recapitulation	O
of	O
relations	O
derived	O
earlier	O
in	O
the	O
book	O
.	O
for	O
ex-	O
ample	O
,	O
we	O
have	O
already	O
developed	O
a	O
projective	B
representation	O
(	O
3.23–p82	O
)	O
of	O
the	O
angle	O
between	O
two	O
lines	O
in	O
3-space	O
,	O
namely	O
(	O
cid:19	O
)	O
cos	O
θ	O
=	O
dt	O
1	O
(	O
cid:19	O
)	O
ω∞d2	O
dt	O
2	O
dt	O
1	O
ω∞d1	O
ω∞d2	O
where	O
d1	O
and	O
d2	O
are	O
the	O
directions	O
of	O
the	O
lines	O
(	O
which	O
are	O
the	O
points	O
at	O
which	O
the	O
lines	B
intersect	O
π∞	O
)	O
.	O
rays	O
are	O
lines	B
in	O
3-space	O
which	O
are	O
coincident	O
at	O
the	O
camera	B
centre	I
,	O
and	O
so	O
(	O
3.23–p82	O
)	O
may	O
be	O
applied	O
directly	O
to	O
rays	O
.	O
this	O
is	O
precisely	O
what	O
(	O
8.9	O
)	O
does	O
–	O
it	O
is	O
simply	O
(	O
3.23–p82	O
)	O
computed	O
in	O
the	O
image	O
.	O
under	O
the	O
map	O
(	O
8.8	O
)	O
h	O
=	O
kr	O
,	O
which	O
is	O
the	O
homography	B
between	O
the	O
plane	B
π∞	O
in	O
the	O
world	O
coordinate	O
frame	O
and	O
the	O
image	B
plane	I
,	O
ω∞	O
(	O
cid:6	O
)	O
→	O
htωh	O
=	O
(	O
kr	O
)	O
tω	O
(	O
kr	O
)	O
and	O
−1xi	O
.	O
substituting	O
these	O
relations	O
into	O
(	O
3.23–p82	O
)	O
gives	O
(	O
8.9	O
)	O
.	O
di	O
=	O
h−1xi	O
=	O
(	O
kr	O
)	O
similarly	O
the	O
conjugacy	B
and	O
pole–polar	O
relations	O
for	O
orthogonality	O
in	O
the	O
image	O
are	O
a	O
direct	O
image	O
of	O
those	O
on	O
π∞	O
,	O
as	O
can	O
be	O
seen	O
by	O
comparing	O
ﬁgure	O
3.8	O
(	O
p83	O
)	O
with	O
ﬁgure	O
8.13.	O
in	O
practice	O
these	O
orthogonality	B
results	O
ﬁnd	O
greatest	O
application	O
in	O
the	O
case	O
of	O
vanish-	O
ing	O
points	O
and	O
vanishing	B
lines	I
.	O
8.6	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
one	O
of	O
the	O
distinguishing	O
features	O
of	O
perspective	O
projection	B
is	O
that	O
the	O
image	O
of	O
an	O
object	O
that	O
stretches	O
off	O
to	O
inﬁnity	O
can	O
have	O
ﬁnite	B
extent	O
.	O
for	O
example	O
,	O
an	O
inﬁnite	O
scene	O
line	B
is	O
imaged	O
as	O
a	O
line	B
terminating	O
in	O
a	O
vanishing	O
point	O
.	O
similarly	O
,	O
parallel	B
world	O
lines	B
,	O
such	O
as	O
railway	O
lines	B
,	O
are	O
imaged	O
as	O
converging	O
lines	B
,	O
and	O
their	O
image	O
intersection	O
is	O
the	O
vanishing	O
point	O
for	O
the	O
direction	O
of	O
the	O
railway	O
.	O
8.6.1	O
vanishing	B
points	I
the	O
perspective	O
geometry	O
that	O
gives	O
rise	O
to	O
vanishing	O
points	O
is	O
illustrated	O
in	O
ﬁgure	O
8.14.	O
it	O
is	O
evident	O
that	O
geometrically	O
the	O
vanishing	O
point	O
of	O
a	O
line	O
is	O
obtained	O
by	O
intersecting	O
the	O
image	B
plane	I
with	O
a	O
ray	O
parallel	B
to	O
the	O
world	O
line	B
and	O
passing	O
through	O
the	O
camera	B
centre	I
.	O
thus	O
a	O
vanishing	O
point	O
depends	O
only	O
on	O
the	O
direction	O
of	O
a	O
line	O
,	O
not	O
on	O
its	O
position	O
.	O
consequently	O
a	O
set	O
of	O
parallel	O
world	O
lines	B
have	O
a	O
common	O
vanishing	O
point	O
,	O
as	O
illustrated	O
in	O
ﬁgure	O
8.16.	O
algebraically	O
the	O
vanishing	O
point	O
may	O
be	O
obtained	O
as	O
a	O
limiting	O
point	B
as	O
follows	O
:	O
points	O
on	O
a	O
line	O
in	O
3-space	O
through	O
the	O
point	B
a	O
and	O
with	O
direction	O
d	O
=	O
(	O
dt	O
,	O
0	O
)	O
t	O
are	O
written	O
as	O
x	O
(	O
λ	O
)	O
=	O
a	O
+	O
λd	O
,	O
see	O
ﬁgure	O
8.14b	O
.	O
as	O
the	O
parameter	O
λ	O
varies	O
from	O
0	O
to	O
∞	O
the	O
point	B
x	O
(	O
λ	O
)	O
varies	O
from	O
the	O
ﬁnite	B
point	O
a	O
to	O
the	O
point	B
d	O
at	B
inﬁnity	I
.	O
under	O
a	O
projective	B
camera	I
p	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
,	O
a	O
point	B
x	O
(	O
λ	O
)	O
is	O
imaged	O
at	O
x	O
(	O
λ	O
)	O
=	O
px	O
(	O
λ	O
)	O
=p	O
a	O
+	O
λpd	O
=	O
a	O
+	O
λkd	O
where	O
a	O
is	O
the	O
image	O
of	O
a.	O
then	O
the	O
vanishing	O
point	O
v	O
of	O
the	O
line	O
is	O
obtained	O
as	O
the	O
214	O
8	O
more	O
single	O
view	O
geometry	O
x	O
v	O
x	O
/	O
v	O
/	O
c	O
d	O
x1	O
2	O
x	O
a	O
x	O
3	O
x	O
4	O
x	O
d	O
x	O
(	O
λ	O
)	O
a	O
x	O
(	O
)	O
λ	O
d	O
c	O
v	O
b	O
(	O
a	O
)	O
plane	B
to	O
line	B
camera	O
.	O
the	O
points	O
xi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
4	O
are	O
fig	O
.	O
8.14.	O
vanishing	O
point	O
formation	O
.	O
equally	O
spaced	O
on	O
the	O
world	O
line	B
,	O
but	O
their	O
spacing	O
on	O
the	O
image	O
line	O
monotonically	O
decreases	O
.	O
in	O
the	O
limit	O
x	O
→	O
∞	O
the	O
world	O
point	B
is	O
imaged	O
at	O
x	O
=	O
v	O
on	O
the	O
vertical	O
image	O
line	O
,	O
and	O
at	O
x	O
(	O
cid:1	O
)	O
=	O
v	O
(	O
cid:1	O
)	O
on	O
the	O
inclined	O
image	O
line	O
.	O
thus	O
the	O
vanishing	O
point	O
of	O
the	O
world	O
line	B
is	O
obtained	O
by	O
intersecting	O
the	O
image	B
plane	I
with	O
a	O
ray	O
parallel	B
to	O
the	O
world	O
line	B
through	O
the	O
camera	B
centre	I
c.	O
(	O
b	O
)	O
3-space	O
to	O
plane	O
camera	B
.	O
the	O
vanishing	O
point	O
,	O
v	O
,	O
of	O
a	O
line	O
with	O
direction	O
d	O
is	O
the	O
intersection	B
of	O
the	O
image	B
plane	I
with	O
a	O
ray	O
parallel	B
to	O
d	O
through	O
c.	O
the	O
world	O
line	B
may	O
be	O
parametrized	O
as	O
x	O
(	O
λ	O
)	O
=	O
a	O
+	O
λd	O
,	O
where	O
a	O
is	O
a	O
point	B
on	O
the	O
line	B
,	O
and	O
d	O
=	O
(	O
dt	O
,	O
0	O
)	O
t.	O
limit	O
v	O
=	O
lim	O
λ→∞	O
x	O
(	O
λ	O
)	O
=	O
lim	O
λ→∞	O
(	O
a	O
+	O
λkd	O
)	O
=	O
kd	O
.	O
from	O
result	O
8.15	O
,	O
v	O
=	O
kd	O
means	O
that	O
the	O
vanishing	O
point	O
v	O
back-projects	O
to	O
a	O
ray	O
with	O
direction	O
d.	O
note	O
that	O
v	O
depends	O
only	O
on	O
the	O
direction	O
d	O
of	O
the	O
line	O
,	O
not	O
on	O
its	O
position	O
speciﬁed	O
by	O
a.	O
in	O
the	O
language	O
of	O
projective	O
geometry	O
this	O
result	O
is	O
obtained	O
directly	O
:	O
in	O
projective	O
3-space	O
the	O
plane	O
at	O
inﬁnity	O
π∞	O
is	O
the	O
plane	B
of	O
directions	O
,	O
and	O
all	O
lines	B
with	O
the	O
same	O
direction	O
intersect	O
π∞	O
in	O
the	O
same	O
point	O
(	O
see	O
chapter	O
3	O
)	O
.	O
the	O
vanishing	O
point	O
is	O
simply	O
the	O
image	O
of	O
this	O
intersection	B
.	O
thus	O
if	O
a	O
line	B
has	O
direction	O
d	O
,	O
then	O
it	O
intersects	O
π∞	O
in	O
the	O
point	B
x∞	O
=	O
(	O
dt	O
,	O
0	O
)	O
t.	O
then	O
v	O
is	O
the	O
image	O
of	O
x∞	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
d	O
0	O
v	O
=	O
px∞	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
=	O
kd	O
.	O
to	O
summarize	O
:	O
result	O
8.20.	O
the	O
vanishing	O
point	O
of	B
lines	I
with	O
direction	O
d	O
in	O
3-space	O
is	O
the	O
intersection	B
8.6	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
215	O
v	O
of	O
the	O
image	O
plane	B
with	O
a	O
ray	O
through	O
the	O
camera	B
centre	I
with	O
direction	O
d	O
,	O
namely	O
v	O
=	O
kd	O
.	O
note	O
,	O
lines	B
parallel	O
to	O
the	O
image	B
plane	I
are	O
imaged	O
as	O
parallel	O
lines	B
,	O
since	O
v	O
is	O
at	B
inﬁnity	I
in	O
the	O
image	O
.	O
however	O
,	O
the	O
converse	O
–	O
that	O
parallel	B
image	O
lines	B
are	O
the	O
image	O
of	O
parallel	O
scene	O
lines	O
–	O
does	O
not	O
hold	O
since	O
lines	B
which	O
intersect	O
on	O
the	O
principal	B
plane	I
are	O
imaged	O
as	O
parallel	O
lines	B
.	O
example	O
8.21.	O
camera	B
rotation	I
from	O
vanishing	B
points	I
vanishing	O
points	O
are	O
images	O
of	B
points	I
at	O
inﬁnity	O
,	O
and	O
provide	O
orientation	B
(	O
attitude	O
)	O
in-	O
formation	O
in	O
a	O
similar	O
manner	O
to	O
that	O
provided	O
by	O
the	O
ﬁxed	O
stars	O
.	O
consider	O
two	O
images	O
of	O
a	O
scene	O
obtained	O
by	O
calibrated	B
cameras	O
,	O
where	O
the	O
two	O
cameras	O
differ	O
in	O
orientation	O
and	O
position	O
.	O
the	O
points	O
at	O
inﬁnity	O
are	O
part	O
of	O
the	O
scene	O
and	O
so	O
are	O
independent	O
of	O
the	O
camera	O
.	O
their	O
images	O
,	O
the	O
vanishing	B
points	I
,	O
are	O
not	O
affected	O
by	O
the	O
change	O
in	O
camera	B
position	O
,	O
but	O
are	O
affected	O
by	O
the	O
camera	B
rotation	I
.	O
suppose	O
both	O
cameras	O
have	O
the	O
same	O
calibration	O
matrix	B
k	O
,	O
and	O
the	O
camera	B
rotates	O
by	O
r	O
between	O
views	O
.	O
let	O
a	O
scene	O
line	O
have	O
vanishing	O
point	O
vi	O
in	O
the	O
ﬁrst	O
view	O
,	O
and	O
v	O
(	O
cid:2	O
)	O
i	O
in	O
the	O
second	O
.	O
the	O
vanishing	O
point	O
vi	O
has	O
direction	O
di	O
measured	O
in	O
the	O
ﬁrst	O
camera	B
’	O
s	O
euclidean	O
coordi-	O
nate	O
frame	O
,	O
and	O
the	O
corresponding	O
vanishing	O
point	O
v	O
(	O
cid:2	O
)	O
i	O
measured	O
in	O
the	O
second	O
camera	B
’	O
s	O
euclidean	O
coordinate	O
frame	O
.	O
these	O
directions	O
can	O
be	O
computed	O
from	O
the	O
vanishing	B
points	I
,	O
for	O
example	O
di	O
=	O
k−1vi/	O
(	O
cid:10	O
)	O
k−1vi	O
(	O
cid:10	O
)	O
,	O
where	O
the	O
normalizing	O
fac-	O
tor	O
(	O
cid:10	O
)	O
k−1vi	O
(	O
cid:10	O
)	O
is	O
included	O
to	O
ensure	O
that	O
di	O
is	O
a	O
unit	O
vector	O
.	O
the	O
directions	O
di	O
and	O
d	O
(	O
cid:2	O
)	O
are	O
related	O
by	O
the	O
camera	B
rotation	I
as	O
d	O
(	O
cid:2	O
)	O
i	O
=	O
rdi	O
,	O
which	O
represents	O
two	O
independent	O
con-	O
straints	O
on	O
r.	O
thus	O
the	O
rotation	B
matrix	O
r	O
can	O
be	O
computed	O
from	O
two	O
such	O
corresponding	O
(	O
cid:2	O
)	O
directions	O
.	O
i	O
has	O
direction	O
d	O
(	O
cid:2	O
)	O
i	O
the	O
angle	B
between	O
two	O
scene	O
lines	B
.	O
we	O
have	O
seen	O
that	O
the	O
vanishing	O
point	O
of	O
a	O
scene	O
line	B
back-projects	O
to	O
a	O
ray	O
parallel	B
to	O
the	O
scene	O
line	O
.	O
consequently	O
(	O
8.9	O
)	O
,	O
which	O
de-	O
termines	O
the	O
angle	B
between	O
rays	O
back-projected	O
from	O
image	O
points	O
,	O
enables	O
the	O
angle	B
between	O
the	O
directions	O
of	O
two	O
scene	O
lines	O
to	O
be	O
measured	O
from	O
their	O
vanishing	B
points	I
:	O
result	O
8.22.	O
let	O
v1	O
and	O
v2	O
be	O
the	O
vanishing	B
points	I
of	O
two	O
lines	O
in	O
an	O
image	O
,	O
and	O
let	O
ω	O
be	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
in	O
the	O
image	O
.	O
if	O
θ	O
is	O
the	O
angle	B
between	O
the	O
two	O
line	O
directions	O
,	O
then	O
.	O
ωv2	O
(	O
8.13	O
)	O
(	O
cid:19	O
)	O
cos	O
θ	O
=	O
(	O
cid:19	O
)	O
vt	O
1	O
ωv1	O
ωv2	O
vt	O
2	O
vt	O
1	O
a	O
note	O
on	O
computing	O
vanishing	B
points	I
often	O
vanishing	B
points	I
are	O
computed	O
from	O
the	O
image	O
of	O
a	O
set	O
of	O
parallel	O
line	O
segments	O
,	O
though	O
they	O
may	O
be	O
determined	O
in	O
other	O
ways	O
for	O
example	O
by	O
using	O
equal	O
length	O
in-	O
tervals	O
on	B
a	I
line	I
as	O
described	O
in	O
example	O
2.18	O
(	O
p50	O
)	O
and	O
example	O
2.20	O
(	O
p51	O
)	O
.	O
in	O
the	O
case	O
of	O
imaged	O
parallel	B
line	O
segments	O
the	O
objective	O
is	O
to	O
estimate	O
their	O
common	O
image	O
intersection	O
–	O
which	O
is	O
the	O
image	O
of	O
the	O
direction	O
of	O
the	O
parallel	O
scene	O
lines	O
.	O
due	O
to	O
measurement	O
noise	B
the	O
imaged	O
line	B
segments	O
will	O
generally	O
not	O
intersect	O
in	O
a	O
unique	O
216	O
8	O
more	O
single	O
view	O
geometry	O
v	O
a	O
b	O
c	O
fig	O
.	O
8.15.	O
ml	O
estimate	O
of	O
a	O
vanishing	O
point	B
from	O
imaged	O
parallel	B
scene	O
lines	B
.	O
(	O
a	O
)	O
estimating	B
the	O
vanishing	O
point	O
v	O
involves	O
ﬁtting	O
a	O
line	B
(	O
shown	O
thin	O
here	O
)	O
through	O
v	O
to	O
each	O
measured	O
line	B
(	O
shown	O
thick	O
here	O
)	O
.	O
the	O
ml	O
estimate	O
of	O
v	O
is	O
the	O
point	B
which	O
minimizes	O
the	O
sum	O
of	O
squared	O
orthogonal	B
distances	O
between	O
the	O
ﬁtted	O
lines	B
and	O
the	O
measured	O
lines	B
’	O
end	O
points	O
.	O
(	O
b	O
)	O
measured	O
line	B
segments	O
are	O
shown	O
in	O
white	O
,	O
and	O
ﬁtted	O
lines	B
in	O
black	O
.	O
(	O
c	O
)	O
a	O
close-up	O
of	O
the	O
dashed	O
square	O
in	O
(	O
b	O
)	O
.	O
note	O
the	O
very	O
slight	O
angle	B
between	O
the	O
measured	O
and	O
ﬁtted	O
lines	B
.	O
point	B
.	O
commonly	O
the	O
vanishing	O
point	O
is	O
then	O
computed	O
by	O
intersecting	O
the	O
lines	B
pair-	O
wise	O
and	O
using	O
the	O
centroid	O
of	O
these	O
intersections	O
,	O
or	O
ﬁnding	O
the	O
closest	O
point	B
to	O
all	O
the	O
measured	O
lines	B
.	O
however	O
,	O
these	O
are	O
not	O
optimal	O
procedures	O
.	O
under	O
the	O
assumption	O
of	O
gaussian	O
measurement	O
noise	O
,	O
the	O
maximum	O
likelihood	O
es-	O
timate	O
(	O
mle	O
)	O
of	O
the	O
vanishing	O
point	O
and	O
line	O
segments	O
is	O
computed	O
by	O
determining	B
a	O
set	O
of	B
lines	I
that	O
do	O
intersect	O
in	O
a	O
single	O
point	O
,	O
and	O
which	O
minimize	O
the	O
sum	O
of	O
squared	O
orthogonal	B
distances	O
from	O
the	O
endpoints	O
of	O
the	O
measured	O
line	B
segments	O
as	O
shown	O
in	O
ﬁgure	O
8.15	O
(	O
a	O
)	O
.	O
this	O
minimization	B
may	O
be	O
computed	O
numerically	O
using	O
the	O
levenberg–	O
marquardt	O
algorithm	B
(	O
section	O
a6.2	O
(	O
p600	O
)	O
)	O
.	O
note	O
that	O
if	O
the	O
lines	B
are	O
deﬁned	O
by	O
ﬁtting	O
to	O
many	O
points	O
,	O
rather	O
than	O
just	O
their	O
end	O
points	O
,	O
one	O
can	O
use	O
the	O
method	O
described	O
in	O
section	O
16.7.2	O
(	O
p404	O
)	O
to	O
reduce	O
each	O
line	B
to	O
an	O
equivalent	B
pair	O
of	O
weighted	O
end	O
points	O
which	O
can	O
then	O
be	O
used	O
in	O
this	O
algorithm	B
.	O
figure	O
8.15	O
(	O
b	O
)	O
(	O
c	O
)	O
shows	O
an	O
example	O
of	O
a	O
vanishing	O
point	B
computed	O
in	O
this	O
manner	O
.	O
it	O
is	O
evident	O
that	O
the	O
residuals	B
between	O
the	O
measured	O
and	O
ﬁtted	O
lines	B
are	O
very	O
small	O
.	O
8.6.2	O
vanishing	B
lines	I
parallel	O
planes	O
in	O
3-space	O
intersect	O
π∞	O
in	O
a	O
common	O
line	B
,	O
and	O
the	O
image	O
of	O
this	O
line	B
is	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
.	O
geometrically	O
the	O
vanishing	O
line	O
is	O
constructed	O
,	O
as	O
shown	O
in	O
ﬁgure	O
8.16	O
,	O
by	O
intersecting	O
the	O
image	O
with	O
a	O
plane	B
parallel	O
to	O
the	O
scene	O
plane	O
through	O
the	O
camera	B
centre	I
.	O
it	O
is	O
clear	O
that	O
a	O
vanishing	O
line	O
depends	O
only	O
on	O
the	O
orientation	B
of	O
the	O
scene	O
plane	O
;	O
it	O
does	O
not	O
depend	O
on	O
its	O
position	O
.	O
since	O
lines	B
parallel	O
to	O
a	O
plane	B
intersect	O
the	O
plane	O
at	O
π∞	O
,	O
it	O
is	O
easily	O
seen	O
that	O
the	O
vanishing	O
point	O
of	O
a	O
line	O
parallel	B
to	O
a	O
plane	B
lies	O
on	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
.	O
an	O
example	O
is	O
shown	O
in	O
ﬁgure	O
8.17.	O
if	O
the	O
camera	B
calibration	I
k	O
is	O
known	O
then	O
a	O
scene	O
plane	O
’	O
s	O
vanishing	O
line	O
may	O
be	O
used	O
to	O
determine	O
information	O
about	O
the	O
plane	B
,	O
and	O
we	O
mention	O
three	O
examples	B
here	O
:	O
(	O
i	O
)	O
the	O
plane	B
’	O
s	O
orientation	B
relative	O
to	O
the	O
camera	B
may	O
be	O
determined	O
from	O
its	O
van-	O
ishing	O
line	B
.	O
from	O
result	O
8.16	O
a	O
plane	B
through	O
the	O
camera	B
centre	I
with	O
normal	O
8.6	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
217	O
v	O
1	O
v	O
2	O
l	O
a	O
l	O
b	O
n	O
c	O
n	O
π	O
fig	O
.	O
8.16.	O
vanishing	O
line	O
formation	O
.	O
(	O
a	O
)	O
the	O
two	O
sets	O
of	B
parallel	I
lines	I
on	O
the	O
scene	O
plane	O
converge	O
to	O
the	O
vanishing	B
points	I
v1	O
and	O
v2	O
in	O
the	O
image	O
.	O
the	O
line	B
l	O
through	O
v1	O
and	O
v2	O
is	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
.	O
(	O
b	O
)	O
the	O
vanishing	O
line	O
l	O
of	O
a	O
plane	O
π	O
is	O
obtained	O
by	O
intersecting	O
the	O
image	B
plane	I
with	O
a	O
plane	B
through	O
the	O
camera	B
centre	I
c	O
and	O
parallel	B
to	O
π.	O
a	O
b	O
c	O
fig	O
.	O
8.17.	O
vanishing	B
points	I
and	O
lines	B
.	O
the	O
vanishing	O
line	O
of	O
the	O
ground	O
plane	B
(	O
the	O
horizon	O
)	O
of	O
the	O
corridor	O
may	O
be	O
obtained	O
from	O
two	O
sets	O
of	B
parallel	I
lines	I
on	O
the	O
plane	B
.	O
(	O
a	O
)	O
the	O
vanishing	B
points	I
of	O
lines	B
which	O
are	O
nearly	O
parallel	B
to	O
the	O
image	B
plane	I
are	O
distant	O
from	O
the	O
ﬁnite	B
(	O
actual	O
)	O
image	O
.	O
(	O
b	O
)	O
note	O
the	O
monotonic	O
decrease	O
in	O
the	O
spacing	O
of	O
the	O
imaged	O
equally	O
spaced	O
parallel	B
lines	I
corresponding	O
to	O
the	O
sides	O
of	O
the	O
ﬂoor	O
tiles	O
.	O
(	O
c	O
)	O
the	O
vanishing	O
point	O
of	B
lines	I
parallel	O
to	O
a	O
plane	B
(	O
here	O
the	O
ground	O
plane	O
)	O
lies	O
on	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
.	O
218	O
8	O
more	O
single	O
view	O
geometry	O
direction	O
n	O
intersects	O
the	O
image	B
plane	I
in	O
the	O
line	B
l	O
=	O
k−tn	O
.	O
consequently	O
,	O
l	O
is	O
the	O
vanishing	O
line	O
of	O
planes	O
perpendicular	O
to	O
n.	O
thus	O
a	O
plane	B
with	O
vanishing	O
line	O
l	O
has	O
orientation	B
n	O
=	O
ktl	O
in	O
the	O
camera	B
’	O
s	O
euclidean	O
coordinate	O
frame	O
.	O
(	O
ii	O
)	O
the	O
plane	B
may	O
be	O
metrically	O
rectiﬁed	O
given	O
only	O
its	O
vanishing	O
line	O
.	O
this	O
can	O
be	O
seen	O
by	O
considering	O
a	O
synthetic	O
rotation	O
of	O
the	O
camera	O
in	O
the	O
manner	O
of	O
example	O
8.13	O
(	O
p205	O
)	O
.	O
since	O
the	O
plane	B
normal	O
is	O
known	O
from	O
the	O
vanishing	O
line	O
,	O
the	O
cam-	O
era	O
can	O
be	O
synthetically	O
rotated	O
by	O
a	O
homography	B
so	O
that	O
the	O
plane	B
is	O
fronto-	O
parallel	B
(	O
i.e	O
.	O
parallel	B
to	O
the	O
image	B
plane	I
)	O
.	O
the	O
computation	B
of	I
this	O
homography	B
is	O
discussed	O
in	O
exercise	O
(	O
ix	O
)	O
.	O
(	O
iii	O
)	O
the	O
angle	B
between	O
two	O
scene	O
planes	O
can	O
be	O
determined	O
from	O
their	O
vanishing	B
lines	I
.	O
suppose	O
the	O
vanishing	B
lines	I
are	O
l1	O
and	O
l2	O
,	O
then	O
the	O
angle	B
θ	O
between	O
the	O
planes	O
is	O
given	O
by	O
(	O
cid:19	O
)	O
(	O
cid:19	O
)	O
ω∗l2	O
lt	O
2	O
lt	O
1	O
ω∗l1	O
lt	O
1	O
.	O
ω∗l2	O
(	O
8.14	O
)	O
cos	O
θ	O
=	O
the	O
proof	O
is	O
left	O
as	O
an	O
exercise	O
.	O
computing	B
vanishing	I
lines	I
a	O
common	O
way	O
to	O
determine	O
a	O
vanishing	O
line	O
of	O
a	O
scene	O
plane	B
is	O
ﬁrst	O
to	O
determine	O
vanishing	B
points	I
for	O
two	O
sets	O
of	B
lines	I
parallel	O
to	O
the	O
plane	B
,	O
and	O
then	O
to	O
construct	O
the	O
line	B
through	O
the	O
two	O
vanishing	O
points	O
.	O
this	O
construction	O
is	O
illustrated	O
in	O
ﬁgure	O
8.17.	O
alternative	O
methods	O
of	O
determining	O
vanishing	B
points	I
are	O
shown	O
in	O
example	O
2.19	O
(	O
p51	O
)	O
and	O
example	O
2.20	O
(	O
p51	O
)	O
.	O
however	O
,	O
the	O
vanishing	O
line	O
may	O
be	O
determined	O
directly	O
,	O
without	O
using	O
vanishing	O
points	O
as	O
an	O
intermediate	O
step	O
.	O
for	O
example	O
,	O
the	O
vanishing	O
line	O
may	O
be	O
computed	O
given	O
an	O
imaged	O
set	O
of	O
equally	O
spaced	O
coplanar	O
parallel	B
lines	I
.	O
this	O
is	O
a	O
useful	O
method	O
in	O
practice	O
because	O
such	O
sets	O
commonly	O
occur	O
in	O
man-made	O
structures	O
,	O
such	O
as	O
:	O
stairs	O
,	O
windows	O
on	O
the	O
wall	O
of	O
a	O
building	O
,	O
fences	O
,	O
radiators	O
and	O
zebra	O
crossings	O
.	O
the	O
following	O
example	O
illustrates	O
the	O
projective	B
geometry	O
involved	O
.	O
example	O
8.23.	O
the	O
vanishing	O
line	O
given	O
the	O
image	O
of	O
three	O
coplanar	O
equally	O
spaced	O
parallel	B
lines	I
a	O
set	O
of	O
equally	O
spaced	O
lines	B
on	O
the	O
scene	O
plane	O
may	O
be	O
represented	O
as	O
ax	O
+	O
λ	O
=	O
0	O
,	O
where	O
λ	O
takes	O
integer	O
values	O
.	O
this	O
set	O
(	O
a	O
pencil	O
)	O
of	B
lines	I
may	O
be	O
written	O
as	O
l	O
(	O
cid:2	O
)	O
n	O
=	O
(	O
a	O
,	O
b	O
,	O
n	O
)	O
t	O
=	O
(	O
a	O
,	O
b	O
,	O
0	O
)	O
t	O
+	O
n	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
where	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
is	O
the	O
line	B
at	I
inﬁnity	I
on	O
the	O
scene	O
plane	O
.	O
under	O
perspective	O
imaging	O
the	O
point	B
transformation	O
is	O
x	O
=	O
hx	O
(	O
cid:2	O
)	O
,	O
and	O
the	O
corresponding	O
line	B
map	O
is	O
ln	O
=	O
h−tl	O
(	O
cid:2	O
)	O
n	O
=	O
l0	O
+	O
nl	O
,	O
where	O
l	O
,	O
the	O
image	O
of	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
is	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
.	O
the	O
imaged	O
geometry	O
is	O
shown	O
in	O
ﬁgure	O
8.18	O
(	O
c	O
)	O
.	O
note	O
all	O
lines	B
ln	O
intersect	O
in	O
a	O
common	O
vanishing	O
point	O
(	O
which	O
is	O
given	O
by	O
li×	O
lj	O
,	O
for	O
i	O
(	O
cid:5	O
)	O
=	O
j	O
)	O
and	O
the	O
spacing	O
decreases	O
monotonically	O
with	O
n.	O
the	O
vanishing	O
line	O
l	O
may	O
be	O
determined	O
from	O
three	O
lines	O
of	O
the	O
set	O
provided	O
their	O
index	O
(	O
n	O
)	O
is	O
identiﬁed	O
.	O
for	O
example	O
,	O
from	O
the	O
image	O
of	O
three	O
equally	O
spaced	O
lines	B
,	O
l0	O
,	O
l1	O
and	O
l2	O
,	O
the	O
closed	O
form	O
solution	O
for	O
the	O
vanishing	O
line	O
is	O
:	O
+	O
by	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
=	O
(	O
l0	O
×	O
l2	O
)	O
t	O
(	O
l1	O
×	O
l2	O
)	O
l1	O
+	O
2	O
(	O
l0	O
×	O
l1	O
)	O
t	O
(	O
l2	O
×	O
l1	O
)	O
l2	O
.	O
(	O
8.15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
8.6	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
219	O
l	O
a	O
l	O
3	O
l	O
n	O
l	O
2	O
l	O
1	O
l	O
0	O
l	O
c	O
b	O
v	O
 	O
	O
 	O
	O
fig	O
.	O
8.18.	O
determining	B
a	O
planes	O
vanishing	O
line	O
from	O
imaged	O
equally	O
spaced	O
parallel	B
lines	I
.	O
(	O
a	O
)	O
image	O
of	O
a	O
vertical	O
fence	O
with	O
equally	O
spaced	O
bars	O
.	O
(	O
b	O
)	O
the	O
computed	O
vanishing	O
line	B
l	O
from	O
three	O
equally	O
spaced	O
bars	O
(	O
12	O
apart	O
)	O
.	O
note	O
the	O
vanishing	O
point	O
of	O
the	O
horizontal	O
lines	B
lies	O
on	O
this	O
vanishing	O
line	O
.	O
(	O
c	O
)	O
the	O
spacing	O
between	O
the	O
imaged	O
lines	B
ln	O
monotonically	O
decreases	O
with	O
n.	O
the	O
proof	O
is	O
left	O
as	O
an	O
exercise	O
.	O
figure	O
8.18	O
(	O
b	O
)	O
shows	O
a	O
vanishing	O
line	O
computed	O
in	O
this	O
(	O
cid:2	O
)	O
way	O
.	O
8.6.3	O
orthogonality	B
relationships	I
amongst	O
vanishing	B
points	I
and	O
lines	B
it	O
is	O
often	O
the	O
case	O
in	O
practice	O
that	O
the	O
lines	B
and	O
planes	O
giving	O
rise	O
to	O
vanishing	O
points	O
are	O
orthogonal	B
.	O
in	O
this	O
case	O
there	O
are	O
particularly	O
simple	O
relationships	O
amongst	O
their	O
vanishing	B
points	I
and	O
lines	B
involving	O
ω	O
,	O
and	O
furthermore	O
these	O
relations	O
can	O
be	O
used	O
to	O
(	O
partially	O
)	O
determine	O
ω	O
,	O
and	O
consequently	O
the	O
camera	B
calibration	I
k	O
as	O
will	O
be	O
seen	O
in	O
section	O
8.8.	O
it	O
follows	O
from	O
(	O
8.13	O
)	O
that	O
the	O
vanishing	B
points	I
,	O
v1	O
,	O
v2	O
,	O
of	O
two	O
perpendicular	O
world	O
lines	B
satisfy	O
vt	O
ωv2	O
=	O
0.	O
this	O
means	O
that	O
the	O
vanishing	B
points	I
are	O
conjugate	O
with	O
1	O
respect	O
to	O
ω	O
,	O
as	O
illustrated	O
in	O
ﬁgure	O
8.13.	O
similarly	O
it	O
follows	O
from	O
result	O
8.19	O
that	O
the	O
vanishing	O
point	O
v	O
of	O
a	O
direction	O
perpendicular	O
to	O
a	O
plane	B
with	O
vanishing	O
line	O
l	O
satisﬁes	O
l	O
=	O
ωv	O
.	O
this	O
means	O
that	O
the	O
vanishing	O
point	O
and	O
line	B
are	O
in	O
a	O
pole–polar	O
relation	O
with	O
respect	O
to	O
ω	O
,	O
as	O
is	O
also	O
illustrated	O
in	O
ﬁgure	O
8.13.	O
summarizing	O
these	O
image	O
relations	O
:	O
(	O
i	O
)	O
the	O
vanishing	B
points	I
of	O
lines	B
with	O
perpendicular	O
directions	O
satisfy	O
vt	O
1	O
ωv2	O
=	O
0	O
.	O
(	O
8.16	O
)	O
(	O
ii	O
)	O
if	O
a	O
line	B
is	O
perpendicular	O
to	O
a	O
plane	B
then	O
their	O
respective	O
vanishing	O
point	O
v	O
and	O
vanishing	O
line	O
l	O
are	O
related	O
by	O
l	O
=	O
ωv	O
(	O
8.17	O
)	O
and	O
inversely	O
v	O
=	O
ω∗l	O
.	O
(	O
iii	O
)	O
the	O
vanishing	B
lines	I
of	O
two	O
perpendicular	O
planes	O
satisfy	O
lt	O
1	O
ω∗l2	O
=	O
0	O
.	O
220	O
8	O
more	O
single	O
view	O
geometry	O
  	O
	O
  	O
	O
 	O
	O
 	O
	O
c	O
 v	O
image	B
plane	I
l	O
a	O
π	O
 	O
 	O
	O
 	O
	O
 	O
l	O
 	O
	O
 	O
	O
b	O
π	O
  	O
 	O
	O
 	O
	O
 	O
  	O
	O
  	O
	O
fig	O
.	O
8.19.	O
geometry	O
of	O
a	O
vertical	O
vanishing	O
point	O
and	O
ground	O
plane	O
vanishing	O
line	O
.	O
(	O
a	O
)	O
the	O
vertical	O
vanishing	O
point	O
v	O
is	O
the	O
image	O
of	O
the	O
vertical	O
“	O
footprint	O
”	O
of	O
the	O
camera	O
centre	B
on	O
the	O
ground	O
plane	O
π	O
.	O
(	O
b	O
)	O
the	O
vanishing	O
line	O
l	O
partitions	O
all	O
points	O
in	O
scene	O
space	O
.	O
any	O
scene	O
point	O
projecting	O
onto	O
the	O
vanishing	O
line	O
is	O
at	O
the	O
same	O
distance	O
from	O
the	O
plane	B
π	O
as	O
the	O
camera	B
centre	I
;	O
if	O
it	O
lies	O
“	O
above	O
”	O
the	O
line	B
it	O
is	O
farther	O
from	O
the	O
plane	B
,	O
and	O
if	O
“	O
below	O
”	O
then	O
it	O
is	O
closer	O
to	O
the	O
plane	B
than	O
the	O
camera	B
centre	I
.	O
for	O
example	O
,	O
suppose	O
the	O
vanishing	O
line	O
l	O
of	O
the	O
ground	O
plane	B
(	O
the	O
horizon	O
)	O
is	O
identiﬁed	O
in	O
an	O
image	O
,	O
and	O
the	O
internal	B
calibration	O
matrix	B
k	O
is	O
known	O
,	O
then	O
the	O
vertical	O
vanishing	O
point	O
v	O
(	O
which	O
is	O
the	O
vanishing	O
point	O
of	O
the	O
normal	O
direction	O
to	O
the	O
plane	B
)	O
may	O
be	O
obtained	O
from	O
v	O
=	O
ω∗l	O
.	O
8.7	O
afﬁne	B
3d	O
measurements	O
and	O
reconstruction	B
it	O
has	O
been	O
seen	O
in	O
section	O
2.7.2	O
(	O
p49	O
)	O
that	O
identifying	O
a	O
scene	O
plane	O
’	O
s	O
vanishing	O
line	O
allows	O
afﬁne	O
properties	O
of	O
the	O
scene	O
plane	O
to	O
be	O
measured	O
.	O
if	O
in	O
addition	O
a	O
vanishing	O
point	O
for	O
a	O
direction	O
not	O
parallel	B
to	O
the	O
plane	B
is	O
identiﬁed	O
,	O
then	O
afﬁne	B
properties	I
can	O
be	O
computed	O
for	O
the	O
3-space	O
of	O
the	O
perspectively	O
imaged	O
scene	O
.	O
we	O
will	O
illustrate	O
this	O
idea	O
for	O
the	O
case	O
where	O
the	O
vanishing	O
point	O
corresponds	O
to	O
a	O
direction	O
orthogonal	B
to	O
the	O
plane	B
,	O
although	O
orthogonality	B
is	O
not	O
necessary	O
for	O
the	O
construction	O
.	O
the	O
method	O
described	O
in	O
this	O
section	O
does	O
not	O
require	O
that	O
the	O
internal	B
calibration	O
of	O
the	O
camera	O
k	O
be	O
known	O
.	O
it	O
will	O
be	O
convenient	O
to	O
think	O
of	O
the	O
scene	O
plane	B
as	O
the	O
horizontal	O
ground	O
plane	O
,	O
in	O
which	O
case	O
the	O
vanishing	O
line	O
is	O
the	O
horizon	O
.	O
similarly	O
,	O
it	O
will	O
be	O
convenient	O
to	O
think	O
of	O
the	O
direction	O
orthogonal	B
to	O
the	O
scene	O
plane	O
as	O
vertical	O
,	O
so	O
that	O
v	O
is	O
the	O
vertical	O
vanishing	O
point	O
.	O
this	O
situation	O
is	O
illustrated	O
in	O
ﬁgure	O
8.19.	O
suppose	O
we	O
wish	O
to	O
measure	O
the	O
relative	O
lengths	O
of	O
two	O
line	B
segments	O
in	O
the	O
vertical	O
direction	O
as	O
shown	O
in	O
ﬁgure	O
8.20	O
(	O
a	O
)	O
.	O
we	O
will	O
show	O
the	O
following	O
result	O
:	O
result	O
8.24.	O
given	O
the	O
vanishing	O
line	O
of	O
the	O
ground	O
plane	B
l	O
and	O
the	O
vertical	O
vanishing	O
point	O
v	O
,	O
then	O
the	O
relative	O
length	O
of	O
vertical	O
line	B
segments	O
can	O
be	O
measured	O
provided	O
their	O
end	O
point	B
lies	O
on	O
the	O
ground	O
plane	O
.	O
clearly	O
the	O
relative	O
lengths	O
can	O
not	O
be	O
measured	O
directly	O
from	O
their	O
imaged	O
lengths	O
because	O
as	O
a	O
vertical	O
line	B
recedes	O
deeper	O
into	O
the	O
scene	O
(	O
i.e	O
.	O
further	O
from	O
the	O
camera	B
)	O
then	O
its	O
imaged	O
length	O
decreases	O
.	O
the	O
construction	O
to	O
determine	O
the	O
relative	O
lengths	O
proceeds	O
in	O
two	O
steps	O
:	O
8.7	O
afﬁne	B
3d	O
measurements	O
and	O
reconstruction	B
221	O
 	O
t2	O
 	O
	O
l2	O
 	O
	O
 	O
	O
2b	O
l	O
 	O
	O
 	O
	O
u	O
 	O
	O
 	O
	O
image	O
 	O
	O
 	O
	O
t1	O
l1	O
 	O
	O
b1	O
 	O
	O
a	O
v	O
  	O
l1	O
t1	O
 	O
l2	O
 	O
	O
 	O
	O
  	O
	O
  	O
	O
2t	O
t1	O
  	O
	O
  	O
	O
1b	O
  	O
2b	O
c	O
  	O
	O
t2	O
  	O
	O
 	O
	O
 	O
	O
t1	O
d	O
2	O
  	O
2b	O
b	O
l	O
3	O
2t	O
1t	O
  	O
 	O
  	O
2b	O
d	O
image	O
t1	O
  	O
d	O
1	O
  	O
	O
b1	O
  	O
	O
  	O
	O
v	O
  	O
	O
l1	O
l2	O
  	O
	O
2t	O
  	O
	O
  	O
	O
  	O
	O
1t	O
t1	O
 	O
	O
 	O
	O
 	O
1b	O
fig	O
.	O
8.20.	O
computing	B
length	O
ratios	O
of	O
parallel	O
scene	O
lines	B
.	O
(	O
a	O
)	O
3d	O
geometry	O
:	O
the	O
vertical	O
line	B
seg-	O
ments	O
l1	O
=	O
(	O
cid:8	O
)	O
b1	O
,	O
t1	O
(	O
cid:9	O
)	O
and	O
l2	O
=	O
(	O
cid:8	O
)	O
b2	O
,	O
t2	O
(	O
cid:9	O
)	O
have	O
length	O
d1	O
and	O
d2	O
respectively	O
.	O
the	O
base	O
points	O
b1	O
,	O
b2	O
are	O
on	O
the	O
ground	O
plane	O
.	O
we	O
wish	O
to	O
compute	O
the	O
scene	O
length	O
ratio	O
d1	O
:	O
d2	O
from	O
the	O
imaged	O
conﬁgu-	O
ration	O
.	O
(	O
b	O
)	O
in	O
the	O
scene	O
the	O
length	O
of	O
the	O
line	B
segment	O
l1	O
may	O
be	O
transferred	O
to	O
l2	O
by	O
constructing	O
a	O
line	B
parallel	O
to	O
the	O
ground	O
plane	O
to	O
generate	O
the	O
point	B
(	O
cid:22	O
)	O
t1	O
.	O
(	O
c	O
)	O
image	O
geometry	O
:	O
l	O
is	O
the	O
ground	O
plane	O
˜t1	O
(	O
the	O
image	O
of	O
(	O
cid:22	O
)	O
t1	O
)	O
by	O
the	O
intersection	B
of	O
l2	O
and	O
the	O
line	B
(	O
cid:8	O
)	O
t1	O
,	O
u	O
(	O
cid:9	O
)	O
.	O
(	O
d	O
)	O
the	O
line	B
l3	O
is	O
parallel	B
to	O
l1	O
in	O
vanishing	O
line	B
,	O
and	O
v	O
the	O
vertical	O
vanishing	O
point	O
.	O
a	O
corresponding	O
parallel	B
line	O
construction	O
in	O
the	O
image	O
requires	O
ﬁrst	O
determining	O
the	O
vanishing	O
point	B
u	O
from	O
the	O
images	O
bi	O
of	O
bi	O
,	O
and	O
then	O
determining	O
the	O
image	O
.	O
the	O
points	O
ˆt1	O
and	O
ˆt2	O
are	O
constructed	O
by	O
intersecting	O
l3	O
with	O
the	O
lines	B
(	O
cid:8	O
)	O
t1	O
,	O
˜t1	O
(	O
cid:9	O
)	O
and	O
(	O
cid:8	O
)	O
t1	O
,	O
t2	O
(	O
cid:9	O
)	O
respectively	O
.	O
the	O
distance	B
ratio	I
d	O
(	O
b2	O
,	O
ˆt1	O
)	O
:	O
d	O
(	O
b2	O
,	O
ˆt2	O
)	O
is	O
the	O
computed	O
estimate	O
of	O
d1	O
:	O
d2	O
.	O
step	O
1	O
:	O
map	O
the	O
length	O
of	O
one	O
line	B
segment	O
onto	O
the	O
other	O
.	O
in	O
3d	O
the	O
length	O
of	O
l1	O
may	O
be	O
compared	O
to	O
l2	O
by	O
constructing	O
a	O
line	B
parallel	O
to	O
the	O
ground	O
plane	O
in	O
the	O
direction	O
(	O
cid:8	O
)	O
b1	O
,	O
b2	O
(	O
cid:9	O
)	O
that	O
transfers	O
t1	O
onto	O
l2	O
.	O
this	O
transferred	O
point	B
will	O
be	O
denoted	O
(	O
cid:22	O
)	O
t1	O
(	O
see	O
ﬁgure	O
8.20	O
(	O
b	O
)	O
)	O
.	O
in	O
the	O
image	O
a	O
corresponding	O
construction	O
is	O
carried	O
out	O
by	O
ﬁrst	O
determining	O
the	O
vanishing	O
point	B
u	O
which	O
is	O
the	O
intersection	B
of	O
(	O
cid:8	O
)	O
b1	O
,	O
b2	O
(	O
cid:9	O
)	O
with	O
l.	O
now	O
any	O
scene	O
line	O
parallel	B
to	O
(	O
cid:8	O
)	O
b1	O
,	O
b2	O
(	O
cid:9	O
)	O
is	O
imaged	O
as	O
a	O
line	B
through	O
u	O
,	O
so	O
in	O
particular	O
the	O
intersection	B
of	O
the	O
line	B
(	O
cid:8	O
)	O
t1	O
,	O
u	O
(	O
cid:9	O
)	O
with	O
l2	O
deﬁnes	O
the	O
image	O
˜t1	O
of	O
the	O
transferred	O
point	B
(	O
cid:22	O
)	O
t1	O
image	O
of	O
the	O
line	O
through	O
t1	O
parallel	B
to	O
(	O
cid:8	O
)	O
b1	O
,	O
b2	O
(	O
cid:9	O
)	O
is	O
the	O
line	B
through	O
t1	O
and	O
u.	O
the	O
(	O
see	O
ﬁgure	O
8.20	O
(	O
c	O
)	O
)	O
.	O
step	O
2	O
:	O
determine	O
the	O
ratio	O
of	O
lengths	O
on	O
the	O
scene	O
line	O
.	O
we	O
now	O
have	O
four	O
collinear	O
points	O
on	O
an	O
imaged	O
scene	O
line	O
and	O
wish	O
to	O
determine	O
the	O
actual	O
length	O
ra-	O
tio	O
in	O
the	O
scene	O
.	O
the	O
four	O
collinear	O
image	O
points	O
are	O
b2	O
,	O
˜t1	O
,	O
t2	O
and	O
v.	O
these	O
may	O
be	O
treated	O
as	O
images	O
of	O
scene	O
points	O
at	O
distances	O
0	O
,	O
d1	O
,	O
d2	O
and	O
∞	O
,	O
respectively	O
,	O
along	O
the	O
scene	O
line	O
.	O
the	O
afﬁne	B
ratio	O
d1	O
:	O
d2	O
may	O
be	O
obtained	O
by	O
applying	O
a	O
projective	B
transfor-	O
222	O
8	O
more	O
single	O
view	O
geometry	O
objective	O
given	O
the	O
vanishing	O
line	O
of	O
the	O
ground	O
plane	B
l	O
and	O
the	O
vertical	O
vanishing	O
point	O
v	O
and	O
the	O
top	O
(	O
t1	O
,	O
t2	O
)	O
and	O
base	O
(	O
b1	O
,	O
b2	O
)	O
points	O
of	O
two	O
line	O
segments	O
as	O
in	O
ﬁgure	O
8.20	O
,	O
compute	O
the	O
ratio	O
of	O
lengths	O
of	O
the	O
line	O
segments	O
in	O
the	O
scene	O
.	O
algorithm	B
(	O
i	O
)	O
compute	O
the	O
vanishing	O
point	O
u	O
=	O
(	O
b1	O
×	O
b2	O
)	O
×	O
l.	O
(	O
ii	O
)	O
compute	O
the	O
transferred	O
point	B
˜t1	O
=	O
(	O
t1	O
×	O
u	O
)	O
×	O
l2	O
(	O
where	O
l2	O
=	O
v	O
×	O
b2	O
)	O
.	O
(	O
iii	O
)	O
represent	O
the	O
four	O
points	O
b2	O
,	O
˜t1	O
,	O
t2	O
and	O
v	O
on	O
the	O
image	O
line	O
l1	O
by	O
their	O
distance	B
from	O
b2	O
,	O
as0	O
,	O
˜t1	O
,	O
t2	O
and	O
v	O
respectively	O
.	O
(	O
iv	O
)	O
compute	O
a	O
1d	O
projective	B
transformation	I
h2×2	O
mapping	O
homogeneous	O
coordinates	B
(	O
0	O
,	O
1	O
)	O
(	O
cid:6	O
)	O
→	O
(	O
0	O
,	O
1	O
)	O
and	O
(	O
v	O
,	O
1	O
)	O
(	O
cid:6	O
)	O
→	O
(	O
1	O
,	O
0	O
)	O
(	O
which	O
maps	O
the	O
vanishing	O
point	O
v	O
to	O
inﬁnity	O
)	O
.	O
a	O
suitable	O
matrix	B
is	O
given	O
by	O
(	O
v	O
)	O
the	O
(	O
scaled	O
)	O
distance	B
of	O
the	O
scene	O
points	O
(	O
cid:22	O
)	O
t1	O
and	O
t2	O
from	O
b2	O
on	O
l2	O
may	O
then	O
be	O
ob-	O
tained	O
from	O
the	O
position	O
of	O
the	O
points	O
h2×2	O
(	O
˜t1	O
,	O
1	O
)	O
t	O
and	O
h2×2	O
(	O
t2	O
,	O
1	O
)	O
t.	O
their	O
distance	B
ratio	I
is	O
then	O
given	O
by	O
h2×2	O
=	O
1	O
0	O
1	O
−v	O
(	O
cid:24	O
)	O
(	O
cid:25	O
)	O
.	O
˜t1	O
(	O
v	O
−	O
t2	O
)	O
t2	O
(	O
v	O
−	O
˜t1	O
)	O
d1	O
d2	O
=	O
algorithm	B
8.1.	O
computing	B
scene	O
length	O
ratios	O
from	O
a	O
single	O
image	O
.	O
mation	O
to	O
the	O
image	O
line	O
which	O
maps	O
v	O
to	O
inﬁnity	O
.	O
a	O
geometric	B
construction	O
of	O
this	O
projectivity	B
is	O
shown	O
in	O
ﬁgure	O
8.20	O
(	O
d	O
)	O
(	O
see	O
example	O
2.20	O
(	O
p51	O
)	O
)	O
.	O
details	O
of	O
the	O
algorithm	O
to	O
carry	O
out	O
these	O
two	O
steps	O
are	O
given	O
in	O
algorithm	O
8.1.	O
note	O
,	O
no	O
knowledge	O
of	O
the	O
camera	O
calibration	B
k	O
or	O
pose	O
is	O
necessary	O
to	O
apply	O
the	O
algorithm	B
.	O
in	O
fact	O
,	O
the	O
position	O
of	O
the	O
camera	O
centre	B
relative	O
to	O
the	O
ground	O
plane	O
can	O
also	O
be	O
computed	O
.	O
the	O
algorithm	B
is	O
well	O
conditioned	O
even	O
when	O
the	O
vanishing	O
point	O
and/or	O
line	B
are	O
at	B
inﬁnity	I
in	O
the	O
image	O
.	O
for	O
example	O
,	O
under	O
afﬁne	B
image	O
conditionings	O
,	O
or	O
if	O
the	O
image	B
plane	I
is	O
parallel	B
to	O
the	O
vertical	O
scene	O
direction	O
(	O
so	O
that	O
v	O
is	O
at	B
inﬁnity	I
)	O
.	O
in	O
these	O
cases	O
the	O
distance	B
ratio	I
simpliﬁes	O
to	O
d1	O
d2	O
=	O
˜t1	O
t2	O
.	O
example	O
8.25.	O
measuring	O
a	O
person	O
’	O
s	O
height	O
in	O
a	O
single	O
image	O
suppose	O
we	O
have	O
an	O
image	O
which	O
contains	O
sufﬁcient	O
information	O
to	O
compute	O
the	O
ground	O
plane	O
vanishing	O
line	O
and	O
the	O
vertical	O
vanishing	O
point	O
,	O
and	O
also	O
one	O
object	O
of	O
known	O
height	O
for	O
which	O
the	O
top	O
and	O
base	O
are	O
imaged	O
.	O
then	O
the	O
height	O
of	O
a	O
person	O
standing	O
on	O
the	O
ground	O
plane	O
can	O
be	O
measured	O
anywhere	O
in	O
the	O
scene	O
provided	O
that	O
their	O
head	O
and	O
feet	O
are	O
both	O
visible	O
.	O
figure	O
8.21	O
(	O
a	O
)	O
shows	O
an	O
example	O
.	O
the	O
scene	O
con-	O
tains	O
plenty	O
of	O
horizontal	O
lines	B
from	O
which	O
to	O
compute	O
a	O
horizontal	O
vanishing	O
point	O
.	O
two	O
such	O
vanishing	B
points	I
determine	O
the	O
vanishing	O
line	O
of	O
the	O
ﬂoor	O
(	O
which	O
is	O
the	O
hori-	O
zon	O
for	O
this	O
image	O
)	O
.	O
the	O
scene	O
also	O
contains	O
plenty	O
of	O
vertical	O
lines	B
from	O
which	O
to	O
compute	O
a	O
vertical	O
vanishing	O
point	O
(	O
ﬁgure	O
8.21	O
(	O
c	O
)	O
)	O
.	O
assuming	O
that	O
the	O
two	O
people	O
are	O
standing	O
vertically	O
,	O
then	O
their	O
relative	O
height	O
may	O
be	O
computed	O
directly	O
from	O
their	O
length	O
ratio	O
using	O
algorithm	O
8.1.	O
their	O
absolute	O
height	O
may	O
be	O
determined	O
by	O
comput-	O
8.8	O
determining	B
camera	O
calibration	B
k	O
from	O
a	O
single	B
view	I
223	O
a	O
c	O
b	O
d	O
fig	O
.	O
8.21.	O
height	O
measurements	O
using	O
afﬁne	O
properties	B
.	O
(	O
a	O
)	O
the	O
original	O
image	O
.	O
we	O
wish	O
to	O
measure	O
the	O
height	O
of	O
the	O
two	O
people	O
.	O
(	O
b	O
)	O
the	O
image	O
after	O
radial	B
distortion	I
correction	O
(	O
see	O
section	O
7.4	O
(	O
p189	O
)	O
)	O
.	O
(	O
c	O
)	O
the	O
vanishing	O
line	O
(	O
shown	O
)	O
is	O
computed	O
from	O
two	O
vanishing	B
points	I
corresponding	O
to	O
horizontal	O
di-	O
rections	O
.	O
the	O
lines	B
used	O
to	O
compute	O
the	O
vertical	O
vanishing	B
points	I
are	O
also	O
shown	O
.	O
the	O
vertical	O
vanishing	O
point	O
is	O
not	O
shown	O
since	O
it	O
lies	O
well	O
below	O
the	O
image	O
.	O
(	O
d	O
)	O
using	O
the	O
known	O
height	O
of	O
the	O
ﬁling	O
cabinet	O
on	O
the	O
left	O
of	O
the	O
image	O
,	O
the	O
absolute	O
height	O
of	O
the	O
two	O
people	O
are	O
measured	O
as	O
described	O
in	O
algorithm	O
8.1.	O
the	O
measured	O
heights	O
are	O
within	O
2cm	O
of	O
ground	O
truth	O
.	O
the	O
computation	B
of	I
the	O
uncertainty	O
is	O
described	O
in	O
[	O
criminisi-00	O
]	O
.	O
ing	O
their	O
height	O
relative	O
to	O
an	O
object	O
on	O
the	O
ground	O
plane	O
with	O
known	O
height	O
.	O
here	O
the	O
known	O
height	O
is	O
provided	O
by	O
the	O
ﬁling	O
cabinet	O
.	O
the	O
result	O
is	O
shown	O
in	O
ﬁgure	O
8.21	O
(	O
d	O
)	O
.	O
(	O
cid:2	O
)	O
8.8	O
determining	B
camera	O
calibration	B
k	O
from	O
a	O
single	B
view	I
we	O
have	O
seen	O
that	O
once	O
ω	O
is	O
known	O
the	O
angle	B
between	O
rays	O
can	O
be	O
measured	O
.	O
con-	O
versely	O
if	O
the	O
angle	B
between	O
rays	O
is	O
known	O
then	O
a	O
constraint	O
is	O
placed	O
on	O
ω.	O
each	O
known	O
angle	O
between	B
two	I
rays	I
gives	O
a	O
constraint	O
of	O
the	O
form	O
(	O
8.13	O
)	O
on	O
ω.	O
unfor-	O
tunately	O
,	O
for	O
arbitrary	O
angles	O
,	O
and	O
known	O
v1	O
and	O
v2	O
,	O
this	O
gives	O
a	O
quadratic	O
constraint	O
on	O
the	O
entries	O
of	O
ω.	O
if	O
the	O
lines	B
are	O
perpendicular	O
,	O
however	O
,	O
(	O
8.13	O
)	O
reduces	O
to	O
(	O
8.16	O
)	O
vt	O
ωv2	O
=	O
0	O
,	O
and	O
the	O
constraint	O
on	O
ω	O
is	O
linear	B
.	O
1	O
a	O
linear	B
constraint	O
on	O
ω	O
also	O
results	O
from	O
a	O
vanishing	O
point	O
and	O
vanishing	O
line	O
arising	O
from	O
a	O
line	B
and	O
its	O
orthogonal	B
plane	O
.	O
a	O
common	O
example	O
is	O
a	O
vertical	O
direction	O
and	O
horizontal	O
plane	B
as	O
in	O
ﬁgure	O
8.19.	O
from	O
(	O
8.17	O
)	O
l	O
=	O
ωv	O
.	O
writing	O
this	O
as	O
l	O
×	O
(	O
ωv	O
)	O
=0	O
224	O
8	O
more	O
single	O
view	O
geometry	O
condition	O
vanishing	O
points	O
v1	O
,	O
v2	O
corresponding	O
to	O
orthogonal	O
lines	B
vanishing	O
point	B
v	O
and	O
vanishing	O
line	O
l	O
corresponding	O
to	O
orthogonal	O
line	B
and	O
plane	B
constraint	O
vt	O
1	O
ωv2	O
=	O
0	O
[	O
l	O
]	O
×ωv	O
=	O
0	O
metric	B
plane	O
imaged	O
with	O
known	O
homography	B
h	O
=	O
[	O
h1	O
,	O
h2	O
,	O
h3	O
]	O
ht	O
1	O
ωh2	O
=	O
0	O
ht	O
1	O
ωh1	O
=	O
ht	O
2	O
ωh2	O
zero	B
skew	I
square	O
pixels	O
ω12	O
=	O
ω21	O
=	O
0	O
ω12	O
=	O
ω21	O
=	O
0	O
ω11	O
=	O
ω22	O
type	O
#	O
constraints	B
linear	O
linear	B
linear	O
linear	B
linear	O
1	O
2	O
2	O
1	O
2	O
table	O
8.1.	O
scene	O
and	O
internal	B
constraints	O
on	O
ω.	O
removes	O
the	O
homogeneous	B
scaling	I
factor	O
and	O
results	O
in	O
three	O
homogeneous	O
equations	O
linear	B
in	O
the	O
entries	O
of	O
ω.	O
these	O
are	O
equivalent	B
to	O
two	O
independent	O
constraints	B
on	O
ω.	O
all	O
these	O
conditions	O
provide	O
linear	B
constraints	O
on	O
ω.	O
given	O
a	O
sufﬁcient	O
number	O
of	O
such	O
constraints	B
ω	O
may	O
be	O
computed	O
and	O
hence	O
the	O
camera	B
calibration	I
k	O
also	O
follows	O
since	O
ω	O
=	O
(	O
kkt	O
)	O
−1	O
.	O
the	O
number	O
of	O
entries	O
of	O
ω	O
that	O
need	O
be	O
determined	O
from	B
scene	I
constraints	I
of	O
this	O
sort	O
can	O
be	O
reduced	B
if	O
the	O
calibration	B
matrix	I
k	O
has	O
a	O
more	O
specialized	O
form	O
than	O
(	O
6.10–	O
in	O
the	O
case	O
where	O
k	O
is	O
known	O
to	O
have	O
zero	B
skew	I
(	O
s	O
=	O
0	O
)	O
,	O
or	O
square	O
pixels	O
p157	O
)	O
.	O
(	O
αx	O
=	O
αy	O
and	O
s	O
=	O
0	O
)	O
,	O
we	O
can	O
take	O
advantage	O
of	O
this	O
condition	O
to	O
help	O
ﬁnd	O
ω.	O
in	O
particular	O
,	O
it	O
is	O
quickly	O
veriﬁed	O
by	O
direct	O
computation	O
that	O
:	O
result	O
8.26.	O
if	O
s	O
=	O
k12	O
=	O
0	O
then	O
ω12	O
=	O
ω21	O
=	O
0	O
.	O
if	O
in	O
addition	O
αx	O
=	O
k11	O
=	O
k22	O
=	O
αy	O
,	O
then	O
ω11	O
=	O
ω22	O
.	O
thus	O
,	O
in	O
solving	O
for	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
one	O
may	O
easily	O
take	O
into	O
account	O
the	O
zero-skew	O
or	O
square-aspect	O
ratio	O
constraint	O
on	O
the	O
camera	B
,	O
if	O
such	O
a	O
constraint	O
is	O
known	O
to	O
exist	O
.	O
one	O
may	O
also	O
verify	O
that	O
no	O
such	O
simple	O
connection	O
as	O
result	O
8.26	O
exists	O
between	O
the	O
entries	O
of	O
k	O
and	O
those	O
of	O
ω∗	O
=	O
kkt	O
.	O
we	O
have	O
now	O
seen	O
three	O
sources	O
of	O
constraints	O
on	O
ω	O
:	O
(	O
i	O
)	O
metric	B
information	O
on	O
a	O
plane	O
imaged	O
with	O
a	O
known	O
homography	O
,	O
see	O
(	O
8.12–	O
p211	O
)	O
(	O
ii	O
)	O
vanishing	B
points	I
and	O
lines	B
corresponding	O
to	O
perpendicular	O
directions	O
and	O
planes	O
,	O
(	O
8.16	O
)	O
(	O
iii	O
)	O
“	O
internal	B
constraints	O
”	O
such	O
as	O
zero	O
skew	O
or	O
square	O
pixels	O
,	O
as	O
in	O
result	O
8.26	O
these	O
constraints	B
are	O
summarized	O
in	O
table	O
8.1.	O
we	O
now	O
describe	O
how	O
these	O
constraints	B
may	O
be	O
combined	O
to	O
estimate	O
ω	O
and	O
thence	O
k.	O
since	O
all	O
the	O
above	O
constraints	B
(	O
including	O
the	O
internal	B
constraints	O
)	O
are	O
described	O
al-	O
gebraically	O
as	O
linear	O
equations	O
on	O
ω	O
,	O
it	O
is	O
a	O
simple	O
matter	O
to	O
combine	O
them	O
as	O
rows	O
of	O
8.8	O
determining	B
camera	O
calibration	B
k	O
from	O
a	O
single	B
view	I
225	O
objective	O
compute	O
k	O
via	O
ω	O
by	O
combining	O
scene	O
and	O
internal	B
constraints	O
.	O
algorithm	B
(	O
i	O
)	O
represent	O
ω	O
as	O
a	O
homogeneous	O
6-vector	O
w	O
=	O
(	O
w1	O
,	O
w2	O
,	O
w3	O
,	O
w4	O
,	O
w5	O
,	O
w6	O
)	O
t	O
where	O
:	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
ω	O
=	O
w1	O
w2	O
w4	O
w2	O
w3	O
w5	O
w4	O
w5	O
w6	O
(	O
ii	O
)	O
each	O
available	O
constraint	O
from	O
table	O
8.1	O
may	O
be	O
written	O
as	O
atw	O
=	O
0.	O
for	O
exam-	O
ple	O
,	O
for	O
the	O
orthogonality	B
constraint	O
utωv	O
=	O
0	O
,	O
where	O
u	O
=	O
(	O
u1	O
,	O
u2	O
,	O
u3	O
)	O
t	O
and	O
v	O
=	O
(	O
v1	O
,	O
v2	O
,	O
v3	O
)	O
t	O
,	O
the	O
6-vector	O
a	O
is	O
given	O
by	O
a	O
=	O
(	O
v1u1	O
,	O
v1u2	O
+	O
v2u1	O
,	O
v2u2	O
,	O
v1u3	O
+	O
v3u1	O
,	O
v2u3	O
+	O
v3u2	O
,	O
v3u3	O
)	O
t.	O
similar	O
constraints	B
vectors	O
are	O
obtained	O
from	O
the	O
other	O
sources	O
of	O
scene	O
and	O
internal	B
constraints	O
.	O
for	O
example	O
a	O
metric	B
plane	O
generates	O
two	O
such	O
constraints	B
.	O
n	O
×	O
6	O
matrix	B
for	O
n	O
constraints	B
.	O
(	O
iii	O
)	O
stack	O
the	O
equations	O
atw	O
=	O
0	O
from	O
each	O
constraint	O
in	O
the	O
form	O
aw	O
=	O
0	O
,	O
where	O
a	O
is	O
a	O
(	O
iv	O
)	O
solve	O
for	O
w	O
using	O
the	O
svd	O
as	O
in	O
algorithm	B
4.2	O
(	O
p109	O
)	O
.	O
this	O
determines	O
ω	O
.	O
(	O
v	O
)	O
decompose	O
ω	O
into	O
k	O
using	O
matrix	O
inversion	O
and	O
cholesky	O
factorization	B
(	O
see	O
section	O
a4.2.1	O
(	O
p582	O
)	O
)	O
.	O
algorithm	B
8.2.	O
computing	B
k	O
from	O
scene	O
and	O
internal	B
constraints	O
.	O
a	O
constraint	O
matrix	B
.	O
all	O
constraints	B
may	O
be	O
collected	O
together	O
so	O
that	O
for	O
n	O
constraints	B
the	O
system	O
of	O
equations	O
may	O
be	O
written	O
as	O
aw	O
=	O
0	O
,	O
where	O
a	O
is	O
a	O
n	O
×	O
6	O
matrix	B
and	O
w	O
is	O
a	O
6-vector	O
containing	O
the	O
six	O
distinct	O
homogeneous	O
entries	O
of	O
ω.	O
with	O
a	O
minimum	O
of	O
5	O
constraint	O
equations	O
an	O
exact	O
solution	B
is	O
found	O
.	O
with	O
more	O
than	O
ﬁve	O
equations	O
,	O
a	O
least-squares	B
solution	I
is	O
found	O
by	O
algorithm	B
a5.4	O
(	O
p593	O
)	O
.	O
the	O
method	O
is	O
summarized	O
in	O
algorithm	O
8.2.	O
with	O
more	O
than	O
the	O
minimum	O
required	O
ﬁve	O
constraints	B
,	O
we	O
have	O
the	O
option	O
to	O
apply	O
some	O
of	O
the	O
constraints	O
as	O
hard	O
constraints	B
–	O
that	O
is	O
,	O
constraints	B
that	O
will	O
be	O
satisﬁed	O
exactly	O
.	O
this	O
can	O
be	O
done	O
by	O
parametrizing	O
ω	O
so	O
that	O
the	O
constraints	B
are	O
satisﬁed	O
ex-	O
plicitly	O
(	O
for	O
instance	O
setting	O
ω21	O
=	O
ω12	O
=	O
0	O
for	O
the	O
zero	B
skew	I
constraint	O
,	O
and	O
also	O
ω11	O
=	O
ω22	O
for	O
the	O
square-pixel	O
constraint	O
)	O
.	O
the	O
minimization	B
method	O
of	O
algorithm	O
a5.5	O
(	O
p594	O
)	O
may	O
also	O
be	O
used	O
to	O
enforce	O
hard	O
constraints	B
.	O
otherwise	O
,	O
treating	O
all	O
con-	O
straints	O
as	O
soft	O
constraints	B
and	O
using	O
algorithm	O
a5.4	O
(	O
p593	O
)	O
will	O
produce	O
a	O
solution	B
in	O
which	O
the	O
constraints	B
are	O
not	O
satisﬁed	O
exactly	O
in	O
the	O
presence	O
of	O
noise	O
–	O
for	O
instance	O
,	O
pixels	O
may	O
not	O
be	O
quite	O
square	O
.	O
finally	O
,	O
an	O
important	O
issue	O
in	O
practice	O
is	O
that	O
of	O
degeneracy	O
.	O
this	O
occurs	O
when	O
the	O
combined	O
constraints	B
are	O
not	O
independent	O
and	O
results	O
in	O
the	O
matrix	B
a	O
dropping	O
rank	O
.	O
if	O
the	O
rank	O
is	O
less	O
than	O
the	O
number	O
of	O
unknowns	O
,	O
then	O
a	O
parametrized	O
family	O
of	O
so-	O
lutions	O
for	O
ω	O
(	O
and	O
hence	O
k	O
)	O
is	O
obtained	O
.	O
also	O
,	O
if	O
conditions	O
are	O
near	O
degenerate	B
then	O
the	O
solution	B
is	O
ill-conditioned	O
and	O
the	O
particular	O
member	O
of	O
the	O
family	O
is	O
determined	O
by	O
“	O
noise	B
”	O
.	O
these	O
degeneracies	B
can	O
often	O
be	O
understood	O
geometrically	O
–	O
for	O
example	O
in	O
example	O
8.18	O
if	O
the	O
three	O
metric	B
planes	O
are	O
parallel	B
then	O
the	O
three	O
pairs	O
of	O
imaged	O
226	O
8	O
more	O
single	O
view	O
geometry	O
a	O
b	O
	O
  	O
	O
  	O
	O
  	O
  	O
	O
  	O
	O
c	O
	O
 	O
	O
 	O
	O
 	O
fig	O
.	O
8.22.	O
for	O
the	O
case	O
that	O
image	O
skew	O
is	O
zero	O
and	O
the	O
aspect	O
ratio	O
unity	O
the	O
principal	B
point	I
is	O
the	O
orthocentre	O
of	O
an	O
orthogonal	B
triad	O
of	O
vanishing	O
points	O
.	O
(	O
a	O
)	O
original	O
image	O
.	O
(	O
b	O
)	O
three	O
sets	O
of	B
parallel	I
lines	I
in	O
the	O
scene	O
,	O
with	O
each	O
set	O
having	O
direction	O
orthogonal	B
to	O
the	O
others	O
.	O
(	O
c	O
)	O
the	O
principal	B
point	I
is	O
the	O
orthocentre	O
of	O
the	O
triangle	O
with	O
the	O
vanishing	B
points	I
as	O
vertices	O
.	O
circular	B
points	I
are	O
coincident	O
and	O
only	O
provide	O
a	O
total	O
of	O
two	O
constraints	O
instead	O
of	O
six	O
.	O
a	O
pragmatic	O
solution	B
to	O
the	O
problem	O
of	O
degeneracy	B
,	O
popularized	O
by	O
zhang	O
[	O
zhang-00	O
]	O
,	O
is	O
to	O
image	O
a	O
metric	B
plane	O
many	O
times	O
in	O
varying	O
positions	O
.	O
this	O
reduces	O
the	O
chances	O
of	O
degeneracy	O
occurring	O
,	O
and	O
also	O
provides	O
a	O
very	O
over-determined	B
solution	I
.	O
example	O
8.27.	O
calibration	B
from	O
three	O
orthogonal	B
vanishing	O
points	O
suppose	O
that	O
it	O
is	O
known	O
that	O
the	O
camera	B
has	O
zero	B
skew	I
,	O
and	O
that	O
the	O
pixels	O
are	O
square	O
(	O
or	O
equivalently	O
their	O
aspect	O
ratio	O
is	O
known	O
)	O
.	O
a	O
triad	O
of	O
orthogonal	O
vanishing	O
point	O
directions	O
supplies	O
three	O
more	O
constraints	O
.	O
this	O
gives	O
a	O
total	O
of	O
5	O
constraints	B
–	O
sufﬁcient	O
to	O
compute	O
ω	O
,	O
and	O
hence	O
k.	O
in	O
outline	O
the	O
algorithm	B
has	O
the	O
following	O
steps	O
:	O
(	O
i	O
)	O
in	O
the	O
case	O
of	O
square	O
pixels	O
ω	O
has	O
the	O
form	O
	O
w1	O
ω	O
=	O
0	O
w2	O
0	O
w1	O
w3	O
w2	O
w3	O
w4	O
	O
.	O
(	O
ii	O
)	O
each	O
pair	O
of	O
vanishing	O
points	O
vi	O
,	O
vj	O
generates	O
an	O
equation	O
vt	O
i	O
ωvj	O
=	O
0	O
,	O
which	O
is	O
linear	B
in	O
the	O
elements	O
of	O
ω.	O
the	O
constraints	B
from	O
the	O
three	O
pairs	O
of	O
vanishing	O
points	O
are	O
stacked	O
together	O
to	O
form	O
an	O
equation	O
aw	O
=	O
0	O
,	O
where	O
a	O
is	O
a	O
3	O
×	O
4	O
matrix	B
.	O
(	O
iii	O
)	O
the	O
vector	O
w	O
is	O
obtained	O
as	O
the	O
null	O
vector	O
of	O
a	O
,	O
and	O
this	O
determines	O
ω.	O
the	O
ma-	O
−1	O
by	O
cholesky	O
factorization	B
of	O
ω	O
,	O
followed	O
trix	O
k	O
is	O
obtained	O
from	O
ω	O
=	O
(	O
kkt	O
)	O
by	O
inversion	O
.	O
an	O
example	O
is	O
shown	O
in	O
ﬁgure	O
8.22	O
(	O
a	O
)	O
.	O
vanishing	B
points	I
are	O
computed	O
corre-	O
sponding	O
to	O
the	O
three	O
perpendicular	O
directions	O
shown	O
in	O
ﬁgure	O
8.22	O
(	O
b	O
)	O
.	O
the	O
image	O
is	O
1024	O
×	O
768	O
pixels	O
,	O
and	O
the	O
calibration	B
matrix	I
is	O
computed	O
to	O
be	O
(	O
cid:2	O
)	O
	O
1163	O
0	O
0	O
k	O
=	O
	O
.	O
0	O
548	O
1163	O
404	O
1	O
0	O
8.8	O
determining	B
camera	O
calibration	B
k	O
from	O
a	O
single	B
view	I
227	O
image	B
plane	I
l	O
2	O
v	O
3	O
l	O
p	O
l	O
1	O
n	O
v	O
3	O
l	O
c	O
p	O
x	O
3l	O
π	O
a	O
v	O
1	O
x	O
l	O
3	O
b	O
v	O
2	O
fig	O
.	O
8.23.	O
geometric	B
construction	O
of	O
the	O
principal	O
point	B
.	O
the	O
vanishing	O
line	O
l3	O
back-projects	O
to	O
a	O
plane	B
π	O
with	O
normal	O
n.	O
the	O
vanishing	O
point	O
v3	O
back-projects	O
to	O
a	O
line	B
orthogonal	O
to	O
the	O
plane	B
π	O
.	O
(	O
a	O
)	O
the	O
normal	O
n	O
of	O
the	O
plane	O
π	O
through	O
the	O
camera	B
centre	I
c	O
and	O
the	O
principal	O
axis	O
deﬁne	O
a	O
plane	B
,	O
which	O
intersects	O
the	O
image	O
in	O
the	O
line	B
l	O
=	O
(	O
cid:8	O
)	O
v3	O
,	O
x	O
(	O
cid:9	O
)	O
.	O
the	O
line	B
l3	O
is	O
the	O
intersection	B
of	O
π	O
with	O
the	O
image	B
plane	I
,	O
and	O
is	O
also	O
its	O
vanishing	O
line	O
.	O
the	O
point	B
v3	O
is	O
the	O
intersection	B
of	O
the	O
normal	O
with	O
the	O
image	B
plane	I
,	O
and	O
is	O
also	O
its	O
vanishing	O
point	O
.	O
clearly	O
the	O
principal	B
point	I
lies	O
on	O
l	O
,	O
and	O
l	O
and	O
l3	O
are	O
perpendicular	O
on	O
the	O
image	B
plane	I
.	O
(	O
b	O
)	O
the	O
principal	B
point	I
may	O
be	O
determined	O
from	O
three	O
such	O
constraints	B
as	O
the	O
orthocentre	O
of	O
the	O
triangle	O
.	O
v3	O
p	O
x	O
α	O
c	O
a	O
α	O
a	O
v3	O
l	O
p	O
x	O
b	O
α	O
b	O
fig	O
.	O
8.24.	O
geometric	B
construction	O
of	O
the	O
focal	O
length	O
.	O
(	O
a	O
)	O
consider	O
the	O
plane	B
deﬁned	O
by	O
the	O
camera	B
centre	I
c	O
,	O
principal	B
point	I
and	O
one	O
of	O
the	O
vanishing	O
points	O
,	O
e.g	O
.	O
v3	O
as	O
shown	O
in	O
ﬁgure	O
8.23	O
(	O
a	O
)	O
.	O
the	O
rays	O
from	O
c	O
to	O
v3	O
and	O
x	O
are	O
perpendicular	O
to	O
each	O
other	O
.	O
the	O
focal	B
length	I
,	O
α	O
,	O
is	O
the	O
distance	B
from	O
the	O
camera	B
centre	I
to	O
the	O
image	B
plane	I
.	O
by	O
similar	O
triangles	O
,	O
α2	O
=	O
d	O
(	O
p	O
,	O
v3	O
)	O
d	O
(	O
p	O
,	O
x	O
)	O
,	O
where	O
d	O
(	O
u	O
,	O
v	O
)	O
is	O
the	O
distance	B
between	O
the	O
points	O
u	O
and	O
v.	O
(	O
b	O
)	O
in	O
the	O
image	O
a	O
circle	O
is	O
drawn	O
with	O
diameter	O
the	O
line	B
between	O
v3	O
and	O
x.	O
a	O
line	B
through	O
p	O
perpendicular	O
to	O
(	O
cid:8	O
)	O
v3	O
,	O
x	O
(	O
cid:9	O
)	O
meets	O
the	O
circle	O
in	O
two	O
points	O
a	O
and	O
b.	O
the	O
focal	B
length	I
equals	O
the	O
distance	B
d	O
(	O
p	O
,	O
a	O
)	O
.	O
the	O
principal	B
point	I
and	O
focal	B
length	I
may	O
also	O
be	O
computed	O
geometrically	O
in	O
this	O
case	O
.	O
the	O
principal	B
point	I
is	O
the	O
orthocentre	O
of	O
the	O
triangle	O
with	O
vertices	O
the	O
vanishing	B
points	I
.	O
figure	O
8.23	O
shows	O
that	O
the	O
principal	B
point	I
lies	O
on	O
the	O
perpendicular	O
line	B
from	O
one	O
triangle	O
side	O
to	O
the	O
opposite	O
vertex	O
.	O
a	O
similar	O
construction	O
for	O
the	O
other	O
two	O
sides	O
shows	O
that	O
the	O
principal	B
point	I
is	O
the	O
orthocentre	O
.	O
an	O
algebraic	B
derivation	I
of	O
this	O
result	O
is	O
left	O
to	O
the	O
exercises	O
.	O
the	O
focal	B
length	I
can	O
also	O
be	O
computed	O
geometrically	O
as	O
shown	O
in	O
ﬁgure	O
8.24.	O
as	O
a	O
cautionary	O
note	O
,	O
this	O
estimation	B
method	O
is	O
degenerate	B
if	O
one	O
of	O
the	O
vanishing	O
228	O
8	O
more	O
single	O
view	O
geometry	O
a	O
b	O
fig	O
.	O
8.25.	O
plane	B
rectiﬁcation	O
via	O
partial	O
internal	B
parameters	I
(	O
a	O
)	O
original	O
image	O
.	O
(	O
b	O
)	O
rectiﬁcation	O
assuming	O
the	O
camera	B
has	O
square	O
pixels	O
and	O
principal	B
point	I
at	O
the	O
centre	B
of	O
the	O
image	O
.	O
the	O
focal	B
length	I
is	O
computed	O
from	O
the	O
single	O
orthogonal	O
vanishing	O
point	O
pair	O
.	O
the	O
aspect	O
ratio	O
of	O
a	O
window	O
in	O
the	O
rectiﬁed	O
image	O
differs	O
from	O
the	O
ground	B
truth	I
value	O
by	O
3.7	O
%	O
.	O
note	O
that	O
the	O
two	O
parallel	O
planes	O
,	O
the	O
upper	O
building	O
facade	O
and	O
the	O
lower	O
shopfront	O
,	O
are	O
both	O
mapped	O
to	O
fronto-parallel	O
planes	O
.	O
points	O
,	O
say	O
the	O
vertical	O
,	O
is	O
at	B
inﬁnity	I
.	O
in	O
this	O
case	O
a	O
drops	O
rank	O
to	O
two	O
,	O
and	O
there	O
is	O
a	O
one-parameter	O
family	O
of	O
solutions	O
for	O
ω	O
and	O
correspondingly	O
for	O
k.	O
this	O
degeneracy	B
can	O
be	O
seen	O
geometrically	O
from	O
the	O
orthocentre	O
construction	O
of	O
ﬁgure	O
8.23.	O
if	O
v3	O
is	O
at	B
inﬁnity	I
then	O
the	O
principal	B
point	I
p	O
lies	O
on	O
the	O
line	B
l3	O
=	O
(	O
cid:8	O
)	O
v1	O
,	O
v2	O
(	O
cid:9	O
)	O
,	O
but	O
its	O
x	O
position	O
is	O
not	O
deﬁned	O
.	O
example	O
8.28.	O
determining	O
the	O
focal	O
length	O
when	O
the	O
other	O
internal	B
parameters	I
are	O
known	O
we	O
consider	O
a	O
further	O
example	O
of	O
calibration	O
from	O
a	O
single	B
view	I
.	O
suppose	O
that	O
it	O
is	O
known	O
that	O
the	O
camera	B
has	O
zero	B
skew	I
,	O
that	O
the	O
pixels	O
are	O
square	O
(	O
or	O
equivalently	O
their	O
aspect	O
ratio	O
is	O
known	O
)	O
,	O
and	O
also	O
that	O
the	O
principal	B
point	I
is	O
at	O
the	O
image	O
centre	O
.	O
then	O
only	O
the	O
focal	B
length	I
is	O
unknown	O
.	O
in	O
this	O
case	O
,	O
the	O
form	B
of	I
ω	O
is	O
very	O
simple	O
:	O
it	O
is	O
a	O
diagonal	O
matrix	B
diag	O
(	O
1/f	O
2	O
,	O
1/f	O
2	O
,	O
1	O
)	O
with	O
only	O
one	O
degree	O
of	O
freedom	O
.	O
using	O
algorithm	O
8.2	O
,	O
the	O
focal	B
length	I
f	O
may	O
be	O
determined	O
from	O
one	O
further	O
constraint	O
,	O
such	O
as	O
the	O
one	O
arising	O
from	O
two	O
vanishing	O
points	O
corresponding	O
to	O
orthogonal	O
directions	O
.	O
an	O
example	O
is	O
shown	O
in	O
ﬁgure	O
8.25	O
(	O
a	O
)	O
.	O
here	O
the	O
vanishing	B
points	I
used	O
in	O
the	O
con-	O
straint	O
are	O
computed	O
from	O
the	O
horizontal	O
edges	O
of	O
the	O
windows	O
and	O
pavement	O
,	O
and	O
the	O
vertical	O
edges	O
of	O
the	O
windows	O
.	O
these	O
vanishing	B
points	I
also	O
determine	O
the	O
vanishing	O
line	O
l	O
of	O
the	O
building	O
facade	O
.	O
given	O
k	O
and	O
the	O
vanishing	O
line	O
l	O
,	O
the	O
camera	B
can	O
be	O
syn-	O
thetically	O
rotated	O
such	O
that	O
the	O
facade	O
is	O
fronto-parallel	O
by	O
mapping	O
the	O
image	O
with	O
a	O
homography	B
as	O
in	O
example	O
8.13	O
(	O
p205	O
)	O
.	O
the	O
result	O
is	O
shown	O
in	O
ﬁgure	O
8.25	O
(	O
b	O
)	O
.	O
note	O
,	O
in	O
example	O
8.13	O
it	O
was	O
necessary	O
to	O
know	O
the	O
aspect	O
ratio	O
of	O
a	O
rectangle	O
on	O
the	O
scene	O
plane	O
in	O
order	O
to	O
rectify	O
the	O
plane	B
.	O
here	O
it	O
is	O
only	O
necessary	O
to	O
know	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
because	O
the	O
camera	B
calibration	I
k	O
provides	O
the	O
additional	O
information	O
(	O
cid:2	O
)	O
required	O
for	O
the	O
homography	B
.	O
8.8.1	O
the	O
geometry	O
of	O
the	O
constraints	O
although	O
the	O
algebraic	B
constraints	O
given	O
in	O
table	O
8.1	O
appear	O
to	O
arise	O
from	O
distinct	O
sources	O
,	O
they	O
are	O
in	O
fact	O
all	O
equivalent	B
to	O
one	O
of	O
two	O
simple	O
geometric	O
relations	O
:	O
two	O
points	O
lying	O
on	O
the	O
conic	B
ω	O
,	O
or	O
conjugacy	B
of	O
two	O
points	O
with	O
respect	O
to	O
ω.	O
for	O
example	O
,	O
the	O
zero	B
skew	I
constraint	O
is	O
an	O
orthogonality	B
constraint	O
:	O
it	O
speciﬁes	O
that	O
8.9	O
single	B
view	I
reconstruction	O
229	O
the	O
image	O
x	O
and	O
y	O
axes	O
are	O
orthogonal	B
.	O
these	O
axes	O
correspond	O
to	O
rays	O
with	O
directions	O
in	O
the	O
camera	B
’	O
s	O
euclidean	O
coordinate	O
frame	O
,	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
and	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
,	O
respectively	O
,	O
that	O
are	O
imaged	O
at	O
vx	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
and	O
vy	O
=	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
(	O
since	O
the	O
rays	O
are	O
parallel	B
to	O
the	O
image	B
plane	I
)	O
.	O
the	O
zero	B
skew	I
constraint	O
ω12	O
=	O
ω21	O
=	O
0	O
is	O
just	O
another	O
way	O
of	O
writing	O
the	O
orthogonality	B
constraint	O
(	O
8.16	O
)	O
vt	O
ωvx	O
=	O
0.	O
geometrically	O
skew	O
zero	O
is	O
equivalent	B
y	O
to	O
conjugacy	O
of	O
the	O
points	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
and	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
with	O
respect	O
to	O
ω.	O
the	O
square	O
pixel	O
constraint	O
may	O
be	O
interpreted	O
in	O
two	O
ways	O
.	O
a	O
square	O
has	O
the	O
prop-	O
erty	O
of	O
deﬁning	O
two	O
sets	O
of	O
orthogonal	O
lines	B
:	O
adjacent	O
edges	O
are	O
orthogonal	B
,	O
and	O
so	O
are	O
the	O
two	O
diagonals	O
.	O
thus	O
,	O
the	O
square	O
pixel	O
constraint	O
may	O
be	O
interpreted	O
as	O
a	O
pair	O
of	O
orthogonal	O
line	B
constraints	O
.	O
the	O
diagonal	O
vanishing	B
points	I
of	O
a	O
square	O
pixel	O
are	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
t	O
and	O
(	O
−1	O
,	O
1	O
,	O
0	O
)	O
t.	O
the	O
resulting	O
orthogonality	B
constraints	O
lead	O
to	O
the	O
square	O
pixel	O
constraints	B
given	O
in	O
table	O
8.1.	O
alternatively	O
,	O
the	O
square	O
pixel	O
constraint	O
can	O
be	O
interpreted	O
in	O
terms	O
of	O
two	O
known	O
points	O
lying	O
on	O
the	O
iac	O
.	O
if	O
the	O
image	B
plane	I
has	O
square	O
pixels	O
,	O
then	O
it	O
has	O
a	O
euclidean	O
coordinate	O
system	O
and	O
the	O
circular	B
points	I
have	O
known	O
coordinates	O
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
t.	O
it	O
may	O
be	O
veriﬁed	O
that	O
the	O
two	O
square	O
pixel	O
equations	O
are	O
equivalent	B
to	O
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
ω	O
(	O
1	O
,	O
±i	O
,	O
0	O
)	O
t	O
=	O
0.	O
this	O
is	O
the	O
most	O
important	O
geometric	B
equivalence	O
.	O
in	O
essence	O
an	O
image	B
plane	I
with	O
square	O
pixels	O
acts	O
as	O
a	O
metric	B
plane	O
in	O
the	O
scene	O
.	O
a	O
square	O
pixel	O
image	B
plane	I
is	O
equiv-	O
alent	O
to	O
a	O
metric	B
plane	O
imaged	O
with	O
a	O
homography	B
given	O
by	O
the	O
identity	O
.	O
indeed	O
if	O
the	O
homography	B
h	O
in	O
the	O
“	O
metric	B
plane	O
imaged	O
with	O
known	O
homography	B
”	O
constraint	O
of	O
table	O
8.1	O
is	O
replaced	O
by	O
the	O
identity	O
then	O
the	O
square	O
pixel	O
constraints	B
are	O
immediately	O
obtained	O
.	O
thus	O
,	O
we	O
see	O
that	O
all	O
the	O
constraints	B
given	O
in	O
table	O
8.1	O
are	O
derived	O
either	O
from	O
known	O
points	O
lying	O
on	O
ω	O
,	O
or	O
from	O
pairs	O
of	B
points	I
that	O
are	O
conjugate	O
with	O
respect	O
to	O
ω.	O
deter-	O
mining	O
ω	O
may	O
therefore	O
be	O
viewed	O
as	O
a	O
conic	B
ﬁtting	I
problem	O
,	O
given	O
points	O
on	O
the	O
conic	B
and	O
conjugate	O
point	O
pairs	O
.	O
it	O
is	O
well	O
to	O
bear	O
in	O
mind	O
that	O
conic	B
ﬁtting	I
is	O
a	O
delicate	O
problem	O
,	O
often	O
unstable	O
(	O
[	O
bookstein-79	O
]	O
)	O
if	O
the	O
points	O
are	O
not	O
well	O
distributed	O
on	O
the	O
conic	B
.	O
the	O
same	O
observa-	O
tion	O
is	O
true	O
of	O
the	O
present	O
problem	O
,	O
which	O
we	O
have	O
seen	O
is	O
equivalent	B
to	O
conic	B
ﬁtting	I
.	O
the	O
method	O
given	O
in	O
algorithm	O
8.2	O
for	O
ﬁnding	O
the	O
calibration	B
from	O
vanishing	B
points	I
amounts	O
to	O
minimization	O
of	O
algebraic	O
error	B
,	O
and	O
therefore	O
does	O
not	O
give	O
an	O
optimal	O
so-	O
lution	O
.	O
for	O
greater	O
accuracy	O
,	O
the	O
methods	O
of	O
chapter	O
4	O
,	O
for	O
instance	O
the	O
sampson	O
error	B
method	O
of	O
section	O
4.2.6	O
(	O
p98	O
)	O
should	O
be	O
used	O
.	O
8.9	O
single	B
view	I
reconstruction	O
as	O
an	O
application	O
of	O
the	O
methods	O
developed	O
in	O
this	O
chapter	O
we	O
demonstrate	O
now	O
the	O
3d	O
reconstruction	B
of	O
a	O
texture	O
mapped	O
piecewise	O
planar	O
graphical	O
model	B
from	O
a	O
single	O
image	O
.	O
the	O
camera	B
calibration	I
methods	O
of	O
section	O
8.8	O
and	O
the	O
rectiﬁcation	O
method	O
of	O
example	O
8.28	O
may	O
be	O
combined	O
to	O
back	O
project	O
image	O
regions	O
to	O
texture	O
the	O
planes	O
of	O
the	O
model	O
.	O
the	O
method	O
will	O
be	O
illustrated	O
for	O
the	O
image	O
of	O
ﬁgure	O
8.26	O
(	O
a	O
)	O
,	O
where	O
the	O
scene	O
con-	O
tains	O
three	O
dominant	O
and	O
mutually	O
orthogonal	B
planes	O
:	O
the	O
building	O
facades	O
on	O
the	O
left	O
and	O
right	O
and	O
the	O
ground	O
plane	O
.	O
the	O
parallel	B
line	O
sets	O
in	O
three	O
orthogonal	B
directions	O
de-	O
230	O
8	O
more	O
single	O
view	O
geometry	O
a	O
b	O
c	O
fig	O
.	O
8.26.	O
single	B
view	I
reconstruction	O
.	O
(	O
a	O
)	O
original	O
image	O
of	O
the	O
fellows	O
quad	O
,	O
merton	O
college	O
,	O
oxford	O
.	O
(	O
b	O
)	O
(	O
c	O
)	O
views	O
of	O
the	O
3d	O
model	B
created	O
from	O
the	O
single	O
image	O
.	O
the	O
vanishing	O
line	O
of	O
the	O
roof	O
planes	O
is	O
computed	O
from	O
the	O
repetition	O
of	O
the	O
texture	O
pattern	O
.	O
ﬁne	O
three	O
vanishing	B
points	I
and	O
together	O
with	O
the	O
constraint	O
of	O
square	O
pixels	O
the	O
camera	B
calibration	I
may	O
be	O
computed	O
using	O
the	O
method	O
described	O
in	O
section	O
8.8.	O
from	O
the	O
van-	O
ishing	O
lines	B
of	O
the	O
three	O
planes	O
,	O
likewise	O
determined	O
by	O
the	O
vanishing	B
points	I
,	O
together	O
with	O
the	O
computed	O
ω	O
,	O
homographies	B
may	O
be	O
computed	O
to	O
texture	O
map	O
the	O
appropriate	O
image	O
regions	O
onto	O
the	O
orthogonal	B
planes	O
of	O
the	O
model	O
.	O
in	O
more	O
detail	O
taking	O
the	O
left	O
facade	O
as	O
a	O
reference	O
plane	B
in	O
ﬁgure	O
8.26	O
(	O
a	O
)	O
,	O
its	O
correctly	O
proportioned	O
width	O
and	O
height	O
are	O
determined	O
by	O
the	O
rectiﬁcation	O
.	O
the	O
right	O
facade	O
and	O
ground	O
planes	O
deﬁne	O
3d	O
planes	O
orthogonal	B
to	O
the	O
reference	O
(	O
we	O
have	O
assumed	O
the	O
orthogonality	B
of	O
the	O
planes	O
in	O
computing	O
the	O
camera	B
,	O
so	O
relative	O
orientations	O
are	O
deﬁned	O
)	O
.	O
scaling	B
of	O
the	O
right	O
and	O
ground	O
planes	O
is	O
computed	O
from	O
the	O
points	O
common	O
to	O
the	O
planes	O
and	O
this	O
completes	O
a	O
three	O
orthogonal	B
plane	O
model	B
.	O
having	O
computed	O
the	O
calibration	B
,	O
the	O
relative	O
orientation	B
of	O
planes	O
in	O
the	O
scene	O
that	O
are	O
not	O
orthogonal	B
(	O
such	O
as	O
the	O
roof	O
)	O
can	O
be	O
computed	O
if	O
their	O
vanishing	B
lines	I
can	O
be	O
found	O
using	O
(	O
8.14–p218	O
)	O
.	O
their	O
relative	O
positions	O
and	O
dimensions	O
can	O
be	O
determined	O
if	O
the	O
intersection	B
of	O
a	O
pair	O
of	O
planes	O
is	O
visible	O
in	O
the	O
image	O
,	O
so	O
that	O
there	O
are	O
points	O
common	O
to	O
both	O
planes	O
.	O
relative	O
size	O
can	O
be	O
computed	O
from	O
the	O
rectiﬁcation	O
of	O
a	O
distance	O
between	O
common	O
points	O
using	O
the	O
homographies	B
of	O
both	O
planes	O
.	O
views	O
of	O
the	O
model	O
,	O
with	O
texture	O
mapped	O
correctly	O
to	O
the	O
planes	O
,	O
appear	O
in	O
ﬁgure	O
8.26	O
(	O
b	O
)	O
and	O
(	O
c	O
)	O
.	O
8.10	O
the	O
calibrating	B
conic	I
8.10	O
the	O
calibrating	B
conic	I
231	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
(	O
iac	O
)	O
is	O
an	O
imaginary	O
conic	B
in	O
an	O
image	O
,	O
and	O
hence	O
is	O
not	O
visible	O
.	O
sometimes	O
it	O
is	O
useful	O
for	O
visualization	O
purposes	O
to	O
consider	O
a	O
different	O
conic	B
that	O
is	O
closely	O
related	O
to	O
the	O
calibration	B
of	O
the	O
camera	B
.	O
such	O
a	O
conic	B
is	O
the	O
cal-	O
ibrating	O
conic	B
,	O
which	O
is	O
the	O
image	O
of	O
a	O
cone	O
with	O
apex	O
angle	B
45	O
and	O
axis	O
coinciding	O
with	O
the	O
principal	O
axis	O
of	O
the	O
camera	B
.	O
◦	O
◦	O
we	O
wish	O
to	O
compute	O
a	O
formula	O
for	O
this	O
cone	O
in	O
terms	O
of	O
the	O
calibration	O
matrix	B
of	O
the	O
camera	B
.	O
since	O
the	O
45	O
cone	O
moves	O
with	O
the	O
camera	B
,	O
its	O
image	O
is	O
clearly	O
independent	O
of	O
the	O
orientation	O
and	O
position	O
of	O
the	O
camera	O
.	O
thus	O
,	O
we	O
may	O
assume	O
that	O
the	O
camera	B
is	O
located	O
at	O
the	O
origin	O
and	O
oriented	O
directly	O
along	O
the	O
z-axis	O
.	O
thus	O
,	O
let	O
the	O
camera	B
matrix	I
be	O
p	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
.	O
now	O
,	O
any	O
point	B
on	O
the	O
45	O
◦	O
cone	O
satisﬁes	O
x2	O
+	O
y2	O
=	O
z2	O
.	O
points	O
on	O
this	O
cone	O
map	O
to	O
points	O
on	O
the	O
conic	B
	O
1	O
c	O
=	O
k−t	O
	O
k−1	O
1	O
−1	O
(	O
8.18	O
)	O
as	O
one	O
easily	O
veriﬁes	O
from	O
result	O
8.6	O
(	O
p199	O
)	O
.	O
this	O
conic	B
will	O
be	O
referred	O
to	O
as	O
the	O
cal-	O
ibrating	O
conic	B
of	O
the	O
camera	B
.	O
for	O
a	O
calibrated	O
camera	B
with	O
identity	O
calibration	B
matrix	I
k	O
=	O
i	O
,	O
the	O
calibrating	B
conic	I
is	O
a	O
unit	O
circle	O
centred	O
at	O
the	O
origin	O
(	O
which	O
is	O
the	O
principal	B
point	I
of	O
the	O
image	O
)	O
.	O
the	O
conic	B
of	O
(	O
8.18	O
)	O
is	O
simply	O
this	O
unit	O
circle	O
transformed	O
by	O
an	O
afﬁne	B
transformation	I
according	O
to	O
the	O
conic	B
transformation	O
rule	O
of	O
result	O
2.13	O
(	O
p37	O
)	O
:	O
(	O
c	O
(	O
cid:6	O
)	O
→	O
h−tch−1	O
)	O
.	O
thus	O
the	O
calibrating	B
conic	I
of	O
a	O
camera	B
with	O
calibration	B
matrix	I
k	O
is	O
the	O
afﬁne	B
transformation	I
of	O
a	O
unit	O
circle	O
centred	O
on	O
the	O
origin	O
by	O
the	O
matrix	B
k.	O
the	O
calibration	B
parameters	O
are	O
easily	O
read	O
from	O
the	O
calibrating	B
conic	I
.	O
the	O
principal	B
point	I
is	O
the	O
centre	B
of	O
the	O
conic	B
,	O
and	O
the	O
scale	O
factors	O
and	O
skew	O
are	O
easily	O
identiﬁed	O
,	O
as	O
in	O
ﬁgure	O
8.27.	O
in	O
the	O
case	O
of	O
zero	O
skew	O
,	O
the	O
calibrating	B
conic	I
has	O
its	O
principal	O
axes	O
aligned	O
with	O
the	O
image	O
coordinate	O
axes	O
.	O
an	O
example	O
on	O
a	O
real	O
image	O
is	O
shown	O
in	O
ﬁgure	O
8.29.	O
example	O
8.29.	O
suppose	O
k	O
=	O
diag	O
(	O
f	O
,	O
f	O
,	O
1	O
)	O
,	O
which	O
is	O
the	O
calibration	B
matrix	I
for	O
a	O
camera	B
of	O
focal	B
length	I
f	O
pixels	O
,	O
with	O
no	O
skew	O
,	O
square	O
pixels	O
,	O
and	O
image	O
origin	O
coincident	O
with	O
the	O
principal	B
point	I
.	O
then	O
from	O
(	O
8.18	O
)	O
the	O
calibrating	B
conic	I
is	O
c	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
−f	O
2	O
)	O
,	O
(	O
cid:2	O
)	O
which	O
is	O
a	O
circle	O
of	O
radius	O
f	O
centred	O
on	O
the	O
principal	B
point	I
.	O
in	O
particular	O
the	O
rays	O
corresponding	O
to	O
two	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
orthogonality	O
and	O
the	O
calibrating	B
conic	I
a	O
formula	O
was	O
given	O
in	O
(	O
8.9–p210	O
)	O
for	O
the	O
angle	B
between	O
the	O
rays	O
corresponding	O
to	O
two	O
image	O
points	O
.	O
are	O
perpendicular	O
when	O
x	O
(	O
cid:2	O
)	O
tωx	O
=	O
0.	O
as	O
shown	O
in	O
ﬁgure	O
8.13	O
(	O
p212	O
)	O
this	O
may	O
be	O
interpreted	O
as	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
we	O
wish	O
to	O
carry	O
out	O
a	O
similar	O
analysis	O
in	O
terms	O
of	O
the	O
calibrating	O
conic	B
.	O
writing	O
c	O
=	O
k−tdk−1	O
,	O
where	O
d	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
−1	O
)	O
,	O
we	O
ﬁnd	O
lying	O
on	O
the	O
line	B
ωx	O
,	O
which	O
is	O
the	O
polar	O
of	O
x	O
with	O
respect	O
to	O
the	O
iac	O
.	O
c	O
=	O
(	O
k−tk−1	O
)	O
(	O
kdk−1	O
)	O
=ω	O
s	O
where	O
s	O
=	O
kdk−1	O
.	O
however	O
,	O
for	O
any	O
point	B
x	O
,	O
the	O
product	O
sx	O
represents	O
the	O
reﬂection	O
of	O
232	O
8	O
more	O
single	O
view	O
geometry	O
α	O
y	O
αx	O
(	O
x	O
,	O
y	O
)	O
0	O
0	O
s	O
αy	O
α	O
x	O
(	O
x	O
,	O
y	O
)	O
0	O
0	O
a	O
b	O
fig	O
.	O
8.27.	O
reading	O
the	O
internal	B
camera	O
parameters	B
k	O
from	O
the	O
calibrating	B
conic	I
.	O
(	O
a	O
)	O
skew	O
s	O
is	O
zero	O
.	O
(	O
b	O
)	O
skew	O
s	O
is	O
non-zero	O
.	O
the	O
skew	O
parameter	O
of	O
k	O
(	O
see	O
(	O
6.10–p157	O
)	O
,	O
is	O
given	O
by	O
the	O
x-coordinate	O
of	O
the	O
highest	O
point	B
of	O
the	O
conic	B
.	O
l	O
x	O
.	O
x	O
c	O
fig	O
.	O
8.28.	O
to	O
construct	O
the	O
line	B
perpendicular	O
to	O
the	O
ray	O
through	O
image	O
point	O
x	O
proceed	O
as	O
follows	O
:	O
(	O
i	O
)	O
reﬂect	O
x	O
through	O
the	O
centre	B
of	O
c	O
to	O
get	O
point	B
˙x	O
(	O
i.e	O
.	O
at	O
the	O
same	O
distance	O
from	O
the	O
centre	B
as	O
x	O
)	O
.	O
(	O
ii	O
)	O
the	O
desired	O
line	B
is	O
the	O
polar	O
of	O
˙x	O
.	O
the	O
point	B
x	O
through	O
the	O
centre	B
of	O
the	O
conic	B
c	O
,	O
that	O
is	O
,	O
the	O
principal	B
point	I
of	O
the	O
camera	B
.	O
representing	O
this	O
reﬂected	O
point	B
by	O
˙x	O
,	O
one	O
ﬁnds	O
that	O
x	O
(	O
cid:2	O
)	O
tωx	O
=	O
x	O
(	O
cid:2	O
)	O
tc	O
˙x	O
.	O
(	O
8.19	O
)	O
this	O
leads	O
to	O
the	O
following	O
geometric	B
result	O
:	O
result	O
8.30.	O
the	O
line	B
in	O
an	O
image	O
corresponding	O
to	O
the	O
plane	B
perpendicular	O
to	O
a	O
ray	O
through	O
image	O
point	O
x	O
is	O
the	O
polar	O
c	O
˙x	O
of	O
the	O
reﬂected	O
point	B
˙x	O
with	O
respect	O
to	O
the	O
cali-	O
brating	O
conic	B
.	O
this	O
construction	O
is	O
illustrated	O
in	O
ﬁgure	O
8.28.	O
example	O
8.31.	O
the	O
calibrating	B
conic	I
given	O
three	O
orthogonal	B
vanishing	O
points	O
the	O
calibrating	B
conic	I
can	O
be	O
drawn	O
directly	O
for	O
the	O
example	O
of	O
ﬁgure	O
8.22.	O
again	O
assume	O
there	O
is	O
no	O
skew	O
and	O
square	O
pixels	O
,	O
then	O
the	O
calibrating	B
conic	I
is	O
a	O
circle	O
.	O
now	O
given	O
three	O
mutually	O
perpendicular	O
vanishing	B
points	I
,	O
one	O
can	O
ﬁnd	O
the	O
calibrating	B
conic	I
by	O
direct	O
geometric	O
construction	O
as	O
shown	O
in	O
ﬁgure	O
8.29	O
.	O
(	O
i	O
)	O
first	O
,	O
construct	O
the	O
triangle	O
with	O
vertices	O
the	O
three	O
vanishing	B
points	I
v1	O
,	O
v2	O
and	O
v3	O
.	O
(	O
ii	O
)	O
the	O
centre	B
of	O
c	O
is	O
the	O
orthocentre	O
of	O
the	O
triangle	O
.	O
8.11	O
closure	O
233	O
calibrating	B
conic	I
v1	O
v3	O
c	O
a	O
v1	O
v	O
2	O
calibrating	B
conic	I
 	I
	O
 	O
	O
 	O
	O
v	O
1	O
	O
v3	O
 	O
 	O
	O
 	O
	O
c	O
b	O
 	O
	O
 	O
	O
2v	O
fig	O
.	O
8.29.	O
the	O
calibrating	B
conic	I
computed	O
from	O
three	O
orthogonal	O
vanishing	B
points	I
.	O
(	O
a	O
)	O
the	O
geometric	B
construction	O
.	O
(	O
b	O
)	O
the	O
calibrating	B
conic	I
for	O
the	O
image	O
of	O
ﬁgure	O
8.22	O
.	O
(	O
iii	O
)	O
reﬂect	O
one	O
of	O
the	O
vanishing	O
points	O
(	O
say	O
v1	O
)	O
in	O
the	O
centre	B
to	O
get	O
˙v1	O
.	O
(	O
iv	O
)	O
the	O
radius	O
of	O
c	O
is	O
determined	O
by	O
the	O
condition	O
that	O
the	O
polar	O
of	O
˙v1	O
is	O
the	O
line	B
passing	O
though	O
v2	O
and	O
v3	O
.	O
(	O
cid:2	O
)	O
8.11	O
closure	O
8.11.1	O
the	O
literature	O
faugeras	O
and	O
mourrain	O
[	O
faugeras-95a	O
]	O
,	O
and	O
faugeras	O
and	O
papadopoulo	O
[	O
faugeras-97	O
]	O
develop	O
the	O
projection	B
of	O
lines	B
using	O
pl¨ucker	O
coordinates	B
.	O
koenderink	O
[	O
koenderink-84	O
,	O
koenderink-90	O
]	O
,	O
and	O
giblin	O
and	O
weiss	O
[	O
giblin-87	O
]	O
give	O
many	O
properties	B
of	O
the	O
contour	B
generator	I
and	O
apparent	B
contour	O
,	O
and	O
their	O
relation	O
to	O
the	O
differential	O
geometry	O
of	O
sur-	O
faces	O
.	O
[	O
kanatani-92	O
]	O
gives	O
an	O
alternative	O
,	O
calibrated	B
,	O
treatment	O
of	O
vanishing	O
points	O
and	O
lines	B
,	O
and	O
of	O
the	O
result	O
that	O
images	O
acquired	O
by	O
cameras	B
with	O
the	O
same	O
centre	O
are	O
re-	O
lated	O
by	O
a	O
planar	O
homography	O
.	O
mundy	O
and	O
zisserman	O
[	O
mundy-92	O
]	O
showed	O
this	O
result	O
geometrically	O
,	O
and	O
[	O
hartley-94a	O
]	O
gave	O
a	O
simple	O
algebraic	O
derivation	B
based	O
on	O
camera	O
projection	B
matrices	O
.	O
[	O
faugeras-92b	O
]	O
introduced	O
the	O
projective	B
(	O
reduced	B
)	O
camera	B
ma-	O
trix	O
.	O
the	O
link	O
between	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
and	O
camera	B
calibration	I
was	O
ﬁrst	O
given	O
in	O
[	O
faugeras-92a	O
]	O
.	O
the	O
computation	B
of	I
panoramic	O
mosaics	O
is	O
described	O
in	O
[	O
capel-98	O
,	O
sawhney-98	O
,	O
szeliski-97	O
]	O
.	O
the	O
ml	O
method	O
of	O
computing	O
vanishing	B
points	I
is	O
given	O
in	O
liebowitz	O
&	O
zisserman	O
[	O
liebowitz-98	O
]	O
.	O
applications	O
of	O
automatic	O
vanishing	O
line	O
estimation	B
from	O
coplanar	O
equally	O
spaced	O
lines	B
are	O
given	O
in	O
[	O
schaffalitzky-00b	O
]	O
and	O
also	O
[	O
se-00	O
]	O
.	O
afﬁne	B
3d	O
measurements	O
from	O
a	O
single	B
view	I
is	O
described	O
in	O
[	O
criminisi-00	O
,	O
proesmans-98	O
]	O
.	O
the	O
result	O
that	O
k	O
may	O
be	O
computed	O
from	O
multiple	O
scene	O
planes	O
on	O
which	O
metric	B
structure	I
(	O
such	O
as	O
a	O
square	O
)	O
is	O
known	O
was	O
given	O
in	O
[	O
liebowitz-98	O
]	O
.	O
algorithms	O
for	O
this	O
computation	B
are	O
given	O
in	O
[	O
liebowitz-99a	O
,	O
sturm-99c	O
,	O
zhang-00	O
]	O
.	O
the	O
advantage	O
in	O
using	O
ω	O
,	O
rather	O
than	O
ω∗	O
,	O
when	O
imposing	O
the	O
skew	O
zero	O
constraint	O
was	O
ﬁrst	O
noted	O
in	O
[	O
armstrong-96b	O
]	O
.	O
the	O
method	O
of	O
internal	O
calibration	B
using	O
three	O
vanishing	B
points	I
for	O
orthogonal	B
directions	O
was	O
given	O
by	O
caprile	O
and	O
torre	O
[	O
caprile-90	O
]	O
,	O
though	O
there	O
234	O
8	O
more	O
single	O
view	O
geometry	O
is	O
an	O
earlier	O
reference	O
to	O
this	O
result	O
in	O
the	O
photogrammetry	O
literature	O
[	O
gracie-68	O
]	O
.	O
a	O
simple	O
formula	O
for	O
the	O
focal	B
length	I
in	O
this	O
case	O
is	O
given	O
in	O
[	O
cipolla-99	O
,	O
hartley-02b	O
]	O
.	O
a	O
discussion	O
of	O
the	O
degeneracies	O
that	O
arise	O
when	O
combining	O
multiple	O
constraints	B
is	O
given	O
in	O
[	O
liebowitz-99b	O
,	O
liebowitz-01	O
]	O
.	O
single	B
view	I
reconstruction	O
is	O
investigated	O
in	O
[	O
criminisi-99a	O
,	O
criminisi-01	O
,	O
horry-97	O
,	O
liebowitz-99a	O
,	O
sturm-99a	O
]	O
.	O
8.11.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
homography	B
from	O
a	O
world	O
plane	B
.	O
suppose	O
h	O
is	O
computed	O
(	O
e.g	O
.	O
from	O
the	O
correspondence	B
between	O
four	O
or	O
more	O
known	O
world	O
points	O
and	O
their	O
images	O
)	O
and	O
k	O
known	O
,	O
then	O
the	O
pose	O
of	O
the	O
camera	O
{	O
r	O
,	O
t	O
}	O
may	O
be	O
computed	O
from	O
the	O
camera	B
matrix	I
[	O
r1	O
,	O
r2	O
,	O
r1	O
×	O
r2	O
,	O
t	O
]	O
,	O
where	O
[	O
r1	O
,	O
r2	O
,	O
t	O
]	O
=	O
±k−1h/	O
(	O
cid:10	O
)	O
k−1h	O
(	O
cid:10	O
)	O
.	O
note	O
that	O
there	O
is	O
a	O
two-fold	O
ambiguity	B
.	O
this	O
result	O
follows	O
from	O
(	O
8.1–p196	O
)	O
which	O
gives	O
the	O
homography	B
between	O
a	O
world	O
plane	B
and	O
calibrated	B
camera	O
p	O
=	O
show	O
that	O
the	O
homography	B
x	O
=	O
h	O
(	O
cid:22	O
)	O
x	O
between	O
points	O
on	O
a	O
world	O
plane	B
(	O
nt	O
,	O
d	O
)	O
t	O
k	O
[	O
r	O
|	O
t	O
]	O
.	O
have	O
coordinates	B
(	O
cid:22	O
)	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t.	O
and	O
the	O
image	O
may	O
be	O
expressed	O
as	O
h	O
=	O
k	O
(	O
r	O
−	O
tnt/d	O
)	O
.	O
the	O
points	O
on	O
the	O
plane	B
(	O
ii	O
)	O
line	O
projection	O
.	O
the	O
map	O
(	O
8.2–p198	O
)	O
,	O
i.e	O
.	O
it	O
is	O
projected	O
to	O
the	O
line	B
l	O
=	O
0	O
.	O
(	O
a	O
)	O
show	O
that	O
any	O
line	B
containing	O
the	O
camera	B
centre	I
lies	O
in	O
the	O
null-space	B
of	O
(	O
b	O
)	O
show	O
that	O
the	O
line	B
l	O
=	O
p	O
tx	O
in	O
ip3	O
is	O
the	O
ray	O
through	O
the	O
image	O
point	O
x	O
and	O
the	O
camera	B
centre	I
.	O
hint	O
:	O
start	O
from	O
result	O
3.5	O
(	O
p72	O
)	O
,	O
and	O
show	O
that	O
the	O
camera	B
centre	I
c	O
lies	O
on	O
l.	O
(	O
c	O
)	O
what	O
is	O
the	O
geometric	B
interpretation	I
of	O
the	O
columns	O
of	O
p	O
?	O
(	O
iii	O
)	O
contour	B
generator	I
of	O
a	O
quadric	O
.	O
the	O
contour	B
generator	I
γ	O
of	O
a	O
quadric	O
con-	O
sists	O
of	O
the	O
set	O
of	B
points	I
x	O
on	O
q	O
for	O
which	O
the	O
tangent	O
planes	O
contain	O
the	O
camera	B
centre	I
,	O
c.	O
the	O
tangent	O
plane	O
at	O
a	O
point	B
x	O
on	O
q	O
is	O
given	O
by	O
π	O
=	O
qx	O
,	O
and	O
the	O
condition	O
that	O
c	O
is	O
on	O
π	O
is	O
ctπ	O
=	O
ctqx	O
=	O
0.	O
thus	O
points	O
x	O
on	O
γ	O
satisfy	O
ctqx	O
=	O
0	O
,	O
and	O
thus	O
lie	O
on	O
the	O
plane	B
πγ	O
=	O
qc	O
since	O
πt	O
γx	O
=	O
ctqx	O
=	O
0.	O
this	O
shows	O
that	O
the	O
contour	B
generator	I
of	O
a	O
quadric	O
is	O
a	O
plane	B
curve	O
and	O
furthermore	O
,	O
since	O
πγ	O
=	O
qc	O
,	O
that	O
the	O
plane	B
of	O
γ	O
is	O
the	O
polar	O
plane	B
of	O
the	O
camera	B
centre	I
with	O
respect	O
to	O
the	O
quadric	O
.	O
(	O
iv	O
)	O
apparent	B
contour	O
of	O
an	O
algebraic	B
surface	O
.	O
show	O
that	O
the	O
apparent	B
contour	O
of	O
a	O
homogeneous	O
algebraic	B
surface	O
of	O
degree	O
n	O
is	O
a	O
curve	O
of	O
degree	O
n	O
(	O
n	O
−	O
1	O
)	O
.	O
for	O
example	O
,	O
if	O
n	O
=	O
2	O
then	O
the	O
surface	O
is	O
a	O
quadric	O
and	O
the	O
apparent	B
contour	O
a	O
conic	B
.	O
hint	O
:	O
write	O
the	O
surface	O
as	O
f	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
w	O
)	O
=	O
0	O
,	O
then	O
the	O
tangent	O
plane	O
contains	O
the	O
camera	B
centre	I
c	O
if	O
∂f	O
∂y	O
which	O
is	O
a	O
surface	O
of	O
a	O
degree	O
n	O
−	O
1	O
.	O
∂f	O
∂x	O
cx	O
+	O
cy	O
+	O
cz	O
∂f	O
∂z	O
+	O
cw	O
∂f	O
∂w	O
=	O
0	O
8.11	O
closure	O
235	O
(	O
v	O
)	O
rotation	B
axis	O
vanishing	O
point	O
for	O
h	O
=	O
krk−1	O
.	O
the	O
homography	B
of	O
a	O
conjugate	O
rotation	O
h	O
=	O
krk−1	O
has	O
an	O
eigenvector	O
ka	O
,	O
where	O
a	O
is	O
the	O
direction	O
of	O
the	O
rotation	O
axis	O
,	O
since	O
hka	O
=	O
kra	O
=	O
ka	O
.	O
the	O
last	O
equality	O
follows	O
because	O
ra	O
=	O
1a	O
,	O
i.e	O
.	O
a	O
is	O
the	O
unit	O
eigenvector	O
of	O
r.	O
it	O
follows	O
that	O
(	O
a	O
)	O
ka	O
is	O
a	O
ﬁxed	O
point	O
under	O
the	O
homography	B
h	O
;	O
and	O
(	O
b	O
)	O
from	O
result	O
8.20	O
(	O
p215	O
)	O
v	O
=	O
ka	O
is	O
the	O
vanishing	O
point	O
of	O
the	O
rotation	O
axis	O
.	O
(	O
vi	O
)	O
synthetic	O
rotations	O
.	O
suppose	O
,	O
as	O
in	O
example	O
8.12	O
(	O
p205	O
)	O
,	O
that	O
a	O
homography	B
is	O
estimated	O
between	O
two	O
images	O
related	O
by	O
a	O
pure	O
rotation	B
about	O
the	O
camera	B
centre	I
.	O
then	O
the	O
estimated	O
homography	B
will	O
be	O
a	O
conjugate	O
rotation	O
,	O
so	O
that	O
h	O
=	O
kr	O
(	O
θ	O
)	O
k−1	O
(	O
though	O
k	O
and	O
r	O
are	O
unknown	O
)	O
.	O
however	O
,	O
h2	O
applied	O
to	O
the	O
ﬁrst	O
image	O
generates	O
the	O
image	O
that	O
would	O
have	O
been	O
obtained	O
by	O
rotating	O
the	O
camera	B
about	O
the	O
same	O
axis	O
through	O
twice	O
the	O
angle	B
,	O
since	O
h2	O
=	O
kr2k−1	O
=	O
kr	O
(	O
2θ	O
)	O
k−1	O
.	O
more	O
generally	O
we	O
may	O
write	O
hλ	O
to	O
represent	O
a	O
rotation	B
through	O
any	O
fractional	O
angle	B
λθ	O
.	O
to	O
make	O
sense	O
of	O
hλ	O
,	O
observe	O
that	O
the	O
eigenvalue	O
decomposition	O
of	O
h	O
−iθ	O
)	O
u−1	O
,	O
and	O
both	O
θ	O
and	O
u	O
may	O
be	O
computed	O
from	O
the	O
is	O
h	O
(	O
θ	O
)	O
=	O
u	O
diag	O
(	O
1	O
,	O
eiθ	O
,	O
e	O
estimated	O
h.	O
then	O
hλ	O
=	O
u	O
diag	O
(	O
1	O
,	O
eiλθ	O
,	O
e	O
−iλθ	O
)	O
u−1	O
=	O
kr	O
(	O
λθ	O
)	O
k−1	O
.	O
which	O
is	O
the	O
conjugate	O
of	O
a	O
rotation	B
through	O
angle	B
λθ	O
.	O
writing	O
φ	O
instead	O
of	O
λθ	O
,	O
we	O
may	O
use	O
this	O
homography	B
to	O
generate	O
synthetic	O
images	O
rotated	O
through	O
any	O
angle	B
φ.	O
the	O
images	O
are	O
interpolated	O
between	O
the	O
original	O
images	O
(	O
if	O
0	O
<	O
φ	O
<	O
θ	O
)	O
,	O
or	O
extrapolated	O
(	O
if	O
φ	O
>	O
θ	O
)	O
.	O
(	O
vii	O
)	O
show	O
that	O
the	O
imaged	O
circular	B
points	I
of	O
a	O
perspectively	O
imaged	O
plane	B
may	O
be	O
computed	O
if	O
any	O
of	O
the	O
following	O
are	O
on	O
the	O
plane	B
:	O
(	O
i	O
)	O
a	O
square	O
grid	O
;	O
(	O
ii	O
)	O
two	O
rectangles	O
arranged	O
such	O
that	O
the	O
sides	O
of	O
one	O
rectangle	O
are	O
not	O
parallel	B
to	O
the	O
sides	O
of	O
the	O
other	O
;	O
(	O
iii	O
)	O
two	O
circles	O
of	O
equal	O
radius	O
;	O
(	O
iv	O
)	O
two	O
circles	O
of	O
unequal	O
radius	O
.	O
(	O
viii	O
)	O
show	O
that	O
in	O
the	O
case	O
of	O
zero	O
skew	O
,	O
ω	O
is	O
the	O
conic	B
(	O
cid:28	O
)	O
x	O
−	O
x0	O
αx	O
(	O
cid:20	O
)	O
(	O
cid:29	O
)	O
2	O
+	O
(	O
cid:21	O
)	O
2	O
y	O
−	O
y0	O
αy	O
+	O
1	O
=	O
0	O
which	O
may	O
be	O
interpreted	O
as	O
an	O
ellipse	O
aligned	O
with	O
the	O
axes	O
,	O
centred	O
on	O
the	O
principal	B
point	I
,	O
and	O
with	O
axes	O
of	O
length	O
iαx	O
and	O
iαy	O
in	O
the	O
x	O
and	O
y	O
directions	O
respectively	O
.	O
(	O
ix	O
)	O
if	O
the	O
camera	B
calibration	I
k	O
and	O
the	O
vanishing	O
line	O
l	O
of	O
a	O
scene	O
plane	B
are	O
known	O
then	O
the	O
scene	O
plane	O
can	O
be	O
metric	B
rectiﬁed	O
by	O
a	O
homography	B
corresponding	O
to	O
a	O
synthetic	O
rotation	O
h	O
=	O
krk−1	O
that	O
maps	O
l	O
to	O
l∞	O
,	O
i.e	O
.	O
it	O
is	O
required	O
that	O
h−tl	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
this	O
condition	O
arises	O
because	O
if	O
the	O
plane	B
is	O
rotated	O
such	O
that	O
its	O
vanishing	O
line	O
is	O
l∞	O
then	O
it	O
is	O
fronto-parallel	O
.	O
show	O
that	O
h−tl	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
is	O
equivalent	B
to	O
rn	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
where	O
n	O
=	O
ktl	O
is	O
the	O
normal	O
to	O
the	O
scene	O
plane	O
.	O
this	O
is	O
the	O
condition	O
that	O
the	O
scene	O
normal	O
is	O
rotated	O
to	O
lie	O
along	O
the	O
camera	B
z	O
axis	O
.	O
note	O
the	O
rotation	B
is	O
not	O
uniquely	O
deﬁned	O
since	O
a	O
rotation	B
about	O
the	O
plane	B
’	O
s	O
236	O
8	O
more	O
single	O
view	O
geometry	O
normal	O
does	O
not	O
affect	O
its	O
metric	B
rectiﬁcation	I
.	O
however	O
,	O
the	O
last	O
row	O
of	O
r	O
equals	O
n	O
,	O
so	O
that	O
r	O
=	O
[	O
r1	O
,	O
r2	O
,	O
n	O
]	O
t	O
where	O
n	O
,	O
r1	O
and	O
r2	O
are	O
a	O
triad	O
of	O
orthonormal	O
vectors	O
.	O
(	O
x	O
)	O
show	O
that	O
the	O
angle	B
between	O
two	O
planes	O
with	O
vanishing	O
lines	B
l1	O
and	O
l2	O
is	O
(	O
cid:19	O
)	O
lt	O
1	O
(	O
cid:19	O
)	O
ω∗l2	O
lt	O
2	O
lt	O
1	O
ω∗l1	O
cos	O
θ	O
=	O
.	O
ω∗l2	O
(	O
xi	O
)	O
derive	O
(	O
8.15–p218	O
)	O
.	O
hint	O
,	O
the	O
line	B
l	O
lies	O
in	O
the	O
pencil	O
deﬁned	O
by	O
l1	O
and	O
l2	O
,	O
so	O
it	O
can	O
be	O
expressed	O
as	O
l	O
=	O
αl1	O
+	O
βl2	O
.	O
then	O
use	O
the	O
relations	O
ln	O
=	O
l0	O
+	O
nl	O
for	O
n	O
=	O
1	O
,	O
2	O
to	O
solve	O
for	O
α	O
and	O
β	O
.	O
(	O
xii	O
)	O
for	O
the	O
case	O
of	O
vanishing	O
points	O
arising	O
from	O
three	O
orthogonal	O
directions	O
,	O
and	O
for	O
an	O
image	O
with	O
square	O
pixels	O
,	O
show	O
algebraically	O
that	O
the	O
principal	B
point	I
is	O
the	O
orthocentre	O
of	O
the	O
triangle	O
with	O
vertices	O
the	O
vanishing	B
points	I
.	O
hint	O
:	O
suppose	O
the	O
vanishing	O
point	O
at	O
one	O
vertex	O
of	O
the	O
triangle	O
is	O
v	O
and	O
the	O
line	B
of	O
the	O
opposite	O
side	O
(	O
through	O
the	O
other	O
two	O
vanishing	O
points	O
)	O
is	O
l.	O
then	O
from	O
(	O
8.17–p219	O
)	O
v	O
=	O
ω∗l	O
since	O
v	O
and	O
l	O
arise	O
from	O
an	O
orthogonal	B
line	O
and	O
plane	B
respectively	O
.	O
show	O
that	O
the	O
principal	B
point	I
lies	O
on	O
the	O
line	B
from	O
v	O
to	O
l	O
which	O
is	O
perpendicular	O
in	O
the	O
image	O
to	O
l.	O
since	O
this	O
result	O
is	O
true	O
for	O
any	O
vertex	O
the	O
principal	B
point	I
is	O
the	O
orthocentre	O
of	O
the	O
triangle	O
.	O
(	O
xiii	O
)	O
show	O
that	O
the	O
vanishing	B
points	I
of	O
an	O
orthogonal	B
triad	O
of	O
directions	O
are	O
the	O
ver-	O
tices	O
of	O
a	O
self-polar	O
triangle	O
[	O
springer-64	O
]	O
with	O
respect	O
to	O
ω	O
.	O
(	O
xiv	O
)	O
if	O
a	O
camera	B
has	O
square	O
pixels	O
,	O
then	O
the	O
apparent	B
contour	O
of	O
a	O
sphere	O
centred	O
on	O
the	O
principal	O
axis	O
is	O
a	O
circle	O
.	O
if	O
the	O
sphere	O
is	O
translated	O
parallel	B
to	O
the	O
image	B
plane	I
,	O
then	O
the	O
apparent	B
contour	O
deforms	O
from	O
a	O
circle	O
to	O
an	O
ellipse	O
with	O
the	O
principal	B
point	I
on	O
its	O
major	O
axis	O
.	O
(	O
a	O
)	O
how	O
can	O
this	O
observation	O
be	O
used	O
as	O
a	O
method	O
of	O
internal	O
parameter	O
calibration	O
?	O
(	O
b	O
)	O
show	O
by	O
a	O
geometric	B
argument	O
that	O
the	O
aspect	O
ratio	O
of	O
the	O
ellipse	O
does	O
not	O
depend	O
on	O
the	O
distance	B
of	O
the	O
sphere	O
from	O
the	O
camera	B
.	O
if	O
the	O
sphere	O
is	O
now	O
translated	O
parallel	B
to	O
the	O
principal	O
axis	O
the	O
apparent	B
contour	O
can	O
deform	O
to	O
a	O
hyperbola	O
,	O
but	O
only	O
one	O
branch	O
of	O
the	O
hyperbola	O
is	O
imaged	O
.	O
why	O
is	O
this	O
?	O
(	O
xv	O
)	O
show	O
that	O
for	O
a	O
general	O
camera	B
the	O
apparent	B
contour	O
of	O
a	O
sphere	O
is	O
related	O
to	O
the	O
iac	O
as	O
:	O
ω	O
=	O
c	O
+	O
vvt	O
where	O
c	O
is	O
the	O
conic	B
outline	O
of	O
the	O
imaged	O
sphere	O
,	O
and	O
v	O
is	O
a	O
3-vector	O
that	O
depends	O
on	O
the	O
position	O
of	O
the	O
sphere	O
.	O
a	O
proof	O
is	O
given	O
in	O
[	O
agrawal-03	O
]	O
.	O
note	O
this	O
relation	B
places	O
two	O
constraints	O
on	O
ω	O
,	O
so	O
that	O
in	O
principle	O
ω	O
,	O
and	O
hence	O
the	O
calibration	B
k	O
,	O
may	O
be	O
computed	O
from	O
three	O
images	O
of	O
a	O
sphere	O
.	O
however	O
,	O
in	O
practice	O
this	O
is	O
not	O
a	O
well	O
conditioned	O
method	O
for	O
computing	O
k	O
because	O
the	O
deviation	O
of	O
the	O
sphere	O
’	O
s	O
outline	O
from	O
a	O
circle	O
is	O
small	O
.	O
part	O
ii	O
two-view	O
geometry	O
the	O
birth	O
of	O
venus	O
(	O
detail	O
)	O
,	O
c.	O
1485	O
(	O
tempera	O
on	O
canvas	O
)	O
by	O
sandro	O
botticelli	O
(	O
1444/5-1510	O
)	O
galleria	O
degli	O
ufﬁzi	O
,	O
florence	O
,	O
italy/bridgeman	O
art	O
library	O
outline	O
this	O
part	O
of	O
the	O
book	O
covers	O
the	O
geometry	O
of	O
two	O
perspective	O
views	O
.	O
these	O
views	O
may	O
be	O
acquired	O
simultaneously	O
as	O
in	O
a	O
stereo	O
rig	O
,	O
or	O
acquired	O
sequentially	O
,	O
for	O
example	O
by	O
a	O
camera	B
moving	O
relative	O
to	O
the	O
scene	O
.	O
these	O
two	O
situations	O
are	O
geometrically	O
equivalent	O
and	O
will	O
not	O
be	O
differentiated	O
here	O
.	O
each	O
view	O
has	O
an	O
associated	O
camera	B
matrix	I
,	O
p	O
,	O
p	O
(	O
cid:1	O
)	O
indicates	O
entities	O
associated	O
with	O
the	O
second	O
view	O
,	O
and	O
a	O
3-space	O
point	B
x	O
is	O
imaged	O
as	O
x	O
=	O
px	O
in	O
the	O
ﬁrst	O
view	O
,	O
and	O
x	O
(	O
cid:1	O
)	O
=	O
p	O
(	O
cid:1	O
)	O
x	O
in	O
the	O
second	O
.	O
image	O
points	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
correspond	O
because	O
they	O
are	O
the	O
image	O
of	O
the	O
same	O
3-space	O
point	B
.	O
there	O
are	O
three	O
questions	O
that	O
will	O
be	O
addressed	O
:	O
,	O
where	O
(	O
cid:1	O
)	O
(	O
i	O
)	O
correspondence	B
geometry	O
.	O
given	O
an	O
image	O
point	O
x	O
in	O
the	O
ﬁrst	O
view	O
,	O
how	O
does	O
this	O
constrain	O
the	O
position	O
of	O
the	O
corresponding	O
point	B
x	O
(	O
cid:1	O
)	O
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
ii	O
)	O
camera	B
geometry	O
(	O
motion	O
)	O
.	O
given	O
a	O
set	O
of	O
corresponding	O
image	O
points	O
for	O
the	O
two	B
views	I
?	O
(	O
iii	O
)	O
scene	O
geometry	O
(	O
structure	B
)	O
.	O
given	O
corresponding	O
image	O
points	O
x	O
↔	O
x	O
(	O
cid:1	O
)	O
i	O
}	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
,	O
what	O
are	O
the	O
cameras	B
p	O
and	O
p	O
(	O
cid:1	O
)	O
what	O
is	O
the	O
position	O
of	O
(	O
their	O
pre-image	O
)	O
x	O
in	O
3-space	O
?	O
in	O
the	O
second	O
view	O
?	O
and	O
cameras	B
p	O
,	O
p	O
(	O
cid:1	O
)	O
,	O
chapter	O
9	O
describes	O
the	O
epipolar	B
geometry	O
of	O
two	O
views	O
,	O
and	O
directly	O
answers	O
the	O
ﬁrst	O
question	O
:	O
a	O
point	B
in	O
one	O
view	O
deﬁnes	O
an	O
epipolar	B
line	I
in	O
the	O
other	O
view	O
on	O
which	O
the	O
corresponding	O
point	B
lies	O
.	O
the	O
epipolar	B
geometry	O
depends	O
only	O
on	O
the	O
cameras	B
–	O
their	O
relative	O
position	O
and	O
their	O
internal	B
parameters	I
.	O
it	O
does	O
not	O
depend	O
at	O
all	O
on	O
the	O
scene	O
structure	O
.	O
the	O
epipolar	B
geometry	O
is	O
represented	O
by	O
a	O
3	O
×	O
3	O
matrix	B
called	O
the	O
fundamental	B
matrix	I
f.	O
the	O
anatomy	O
of	O
the	O
fundamental	O
matrix	B
is	O
described	O
,	O
and	O
its	O
computation	B
from	I
camera	I
matrices	I
p	O
and	O
p	O
(	O
cid:1	O
)	O
may	O
be	O
computed	O
from	O
f	O
up	O
to	O
a	O
projective	B
ambiguity	I
of	O
3-space	O
.	O
given	O
.	O
it	O
is	O
then	O
shown	O
that	O
p	O
and	O
p	O
(	O
cid:1	O
)	O
chapter	O
10	O
describes	O
one	O
of	O
the	O
most	O
important	O
results	O
in	O
uncalibrated	O
multiple	O
view	O
geometry	O
–	O
a	O
reconstruction	B
of	O
both	O
cameras	O
and	O
scene	O
structure	O
can	O
be	O
computed	O
from	O
image	O
point	B
correspondences	O
alone	O
;	O
no	O
other	O
information	O
is	O
required	O
.	O
this	O
answers	O
both	O
the	O
second	O
and	O
third	O
questions	O
simultaneously	O
.	O
the	O
reconstruction	B
obtained	O
from	O
point	O
correspondences	O
alone	O
is	O
up	O
to	O
a	O
projective	B
ambiguity	I
of	O
3-space	O
,	O
and	O
this	O
ambiguity	B
can	O
be	O
resolved	O
by	O
supplying	O
well	O
deﬁned	O
additional	O
information	O
on	O
the	O
cameras	B
or	O
scene	O
.	O
in	O
this	O
manner	O
an	O
afﬁne	B
or	O
metric	B
reconstruction	I
may	O
be	O
computed	O
from	O
uncalibrated	O
images	O
.	O
the	O
following	O
two	O
chapters	O
then	O
ﬁll	O
in	O
the	O
details	O
and	O
numerical	O
algorithms	O
for	O
computing	O
this	O
reconstruction	B
.	O
chapter	O
11	O
describes	O
methods	O
for	O
computing	B
f	O
from	O
a	O
set	O
of	O
corresponding	O
image	O
points	O
{	O
xi	O
↔	O
i	O
}	O
,	O
even	O
though	O
the	O
structure	B
(	O
3d	O
pre-image	O
xi	O
)	O
of	O
these	O
points	O
is	O
unknown	O
and	O
the	O
camera	B
matrices	I
x	O
(	O
cid:1	O
)	O
are	O
unknown	O
.	O
the	O
cameras	B
p	O
and	O
p	O
(	O
cid:1	O
)	O
may	O
then	O
be	O
determined	O
,	O
up	O
to	O
a	O
projective	B
ambiguity	I
,	O
from	O
the	O
computed	O
f.	O
chapter	O
12	O
then	O
describes	O
the	O
computation	B
of	I
scene	O
structure	B
by	O
triangulation	B
given	O
the	O
cameras	B
and	O
corresponding	O
image	O
points	O
–	O
the	O
point	B
x	O
in	O
3-space	O
is	O
computed	O
as	O
the	O
intersection	B
of	O
rays	O
back-	O
projected	O
from	O
the	O
corresponding	O
points	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
.	O
similarly	O
,	O
the	O
3d	O
position	O
of	O
other	O
geometric	B
entities	O
,	O
such	O
as	O
lines	O
or	O
conics	O
,	O
may	O
also	O
be	O
computed	O
given	O
their	O
image	O
correspondences	O
.	O
via	O
their	O
associated	O
cameras	B
p	O
,	O
p	O
(	O
cid:1	O
)	O
chapter	O
13	O
covers	O
the	O
two-view	O
geometry	O
of	O
planes	O
.	O
it	O
provides	O
an	O
alternative	O
answer	O
to	O
the	O
ﬁrst	O
question	O
:	O
if	O
scene	O
points	O
lie	O
on	O
a	O
plane	O
,	O
then	O
once	O
the	O
geometry	O
of	O
this	O
plane	B
is	O
computed	O
,	O
the	O
image	O
x	O
of	O
a	O
point	O
in	B
one	I
image	I
determines	O
the	O
position	O
of	O
x	O
(	O
cid:1	O
)	O
in	O
the	O
other	O
image	O
.	O
the	O
points	O
are	O
related	O
by	O
a	O
plane	B
projective	O
transformation	B
.	O
this	O
chapter	O
also	O
describes	O
a	O
particularly	O
important	O
projective	B
transformation	I
between	O
views	O
–	O
the	O
inﬁnite	B
homography	I
,	O
which	O
is	O
the	O
transformation	B
arising	O
from	O
the	O
plane	O
at	O
inﬁnity	O
.	O
are	O
afﬁne	B
.	O
this	O
case	O
has	O
a	O
number	O
of	O
simpliﬁcations	O
over	O
the	O
general	B
projective	I
case	O
,	O
and	O
provides	O
a	O
very	O
good	O
approximation	O
in	O
many	O
practical	O
situations	O
.	O
chapter	O
14	O
describes	O
two-view	O
geometry	O
in	O
the	O
specialized	O
case	O
that	O
the	O
two	O
cameras	O
p	O
and	O
p	O
(	O
cid:1	O
)	O
238	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
the	O
epipolar	B
geometry	O
is	O
the	O
intrinsic	O
projective	B
geometry	O
between	O
two	O
views	O
.	O
it	O
is	O
independent	O
of	O
scene	O
structure	B
,	O
and	O
only	O
depends	O
on	O
the	O
cameras	B
’	O
internal	B
parameters	I
and	O
relative	O
pose	O
.	O
the	O
fundamental	B
matrix	I
f	O
encapsulates	O
this	O
intrinsic	O
geometry	O
.	O
it	O
is	O
a	O
3	O
×	O
3	O
matrix	B
of	O
rank	O
2.	O
if	O
a	O
point	B
in	O
3-space	O
x	O
is	O
imaged	O
as	O
x	O
in	O
the	O
ﬁrst	O
view	O
,	O
and	O
x	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
,	O
then	O
the	O
image	O
points	O
satisfy	O
the	O
relation	B
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0.	O
we	O
will	O
ﬁrst	O
describe	O
epipolar	B
geometry	O
,	O
and	O
derive	O
the	O
fundamental	B
matrix	I
.	O
the	O
properties	B
of	O
the	O
fundamental	B
matrix	I
are	O
then	O
elucidated	O
,	O
both	O
for	O
general	B
motion	I
of	O
the	O
camera	B
between	O
the	O
views	O
,	O
and	O
for	O
several	O
commonly	O
occurring	O
special	O
motions	O
.	O
it	O
is	O
next	O
shown	O
that	O
the	O
cameras	B
can	O
be	O
retrieved	O
from	O
f	O
up	O
to	O
a	O
projective	B
transformation	I
of	O
3-space	O
.	O
this	O
result	O
is	O
the	O
basis	O
for	O
the	O
projective	B
reconstruction	I
theorem	O
given	O
in	O
chapter	O
10.	O
finally	O
,	O
if	O
the	O
camera	B
internal	O
calibration	B
is	O
known	O
,	O
it	O
is	O
shown	O
that	O
the	O
eu-	O
clidean	O
motion	O
of	O
the	O
cameras	O
between	O
views	O
may	O
be	O
computed	O
from	O
the	O
fundamental	B
matrix	I
up	O
to	O
a	O
ﬁnite	B
number	O
of	O
ambiguities	O
.	O
the	O
fundamental	B
matrix	I
is	O
independent	O
of	O
scene	O
structure	B
.	O
however	O
,	O
it	O
can	O
be	O
com-	O
puted	O
from	O
correspondences	O
of	O
imaged	O
scene	O
points	O
alone	O
,	O
without	O
requiring	O
knowl-	O
edge	O
of	O
the	O
cameras	O
’	O
internal	B
parameters	I
or	O
relative	O
pose	O
.	O
this	O
computation	B
is	O
de-	O
scribed	O
in	O
chapter	O
11	O
.	O
9.1	O
epipolar	B
geometry	O
the	O
epipolar	B
geometry	O
between	O
two	O
views	O
is	O
essentially	O
the	O
geometry	O
of	O
the	O
inter-	O
section	O
of	O
the	O
image	O
planes	O
with	O
the	O
pencil	O
of	O
planes	O
having	O
the	O
baseline	O
as	O
axis	O
(	O
the	O
baseline	O
is	O
the	O
line	B
joining	O
the	O
camera	B
centres	O
)	O
.	O
this	O
geometry	O
is	O
usually	O
motivated	O
by	O
considering	O
the	O
search	O
for	O
corresponding	O
points	O
in	O
stereo	O
matching	O
,	O
and	O
we	O
will	O
start	O
from	O
that	O
objective	O
here	O
.	O
suppose	O
a	O
point	B
x	O
in	O
3-space	O
is	O
imaged	O
in	O
two	O
views	O
,	O
at	O
x	O
in	O
the	O
ﬁrst	O
,	O
and	O
x	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
.	O
what	O
is	O
the	O
relation	B
between	O
the	O
corresponding	O
image	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
?	O
as	O
shown	O
in	O
ﬁgure	O
9.1a	O
the	O
image	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
,	O
space	O
point	O
x	O
,	O
and	O
camera	B
centres	O
are	O
coplanar	O
.	O
denote	O
this	O
plane	B
as	O
π.	O
clearly	O
,	O
the	O
rays	O
back-projected	O
from	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
intersect	O
at	O
x	O
,	O
and	O
the	O
rays	O
are	O
coplanar	O
,	O
lying	O
in	O
π.	O
it	O
is	O
this	O
latter	O
property	O
that	O
is	O
of	O
most	O
signiﬁcance	O
in	O
searching	O
for	O
a	O
correspondence	O
.	O
239	O
240	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
x	O
epipolar	B
plane	O
π	O
x	O
?	O
x	O
x	O
?	O
x	O
c	O
/	O
x	O
c	O
/	O
x	O
e	O
/	O
l	O
/	O
e	O
epipolar	B
line	I
for	O
x	O
a	O
b	O
and	O
image	O
planes	O
.	O
the	O
camera	B
centres	O
,	O
3-space	O
point	B
x	O
,	O
and	O
its	O
images	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
fig	O
.	O
9.1.	O
point	B
correspondence	O
geometry	O
.	O
(	O
a	O
)	O
the	O
two	O
cameras	O
are	O
indicated	O
by	O
their	O
centres	O
c	O
and	O
c	O
(	O
cid:1	O
)	O
lie	O
in	O
a	O
common	O
plane	B
π	O
.	O
(	O
b	O
)	O
an	O
image	O
point	O
x	O
back-projects	O
to	O
a	O
ray	O
in	O
3-space	O
deﬁned	O
by	O
the	O
ﬁrst	O
camera	B
centre	I
,	O
c	O
,	O
and	O
x.	O
this	O
ray	O
is	O
imaged	O
as	O
a	O
line	B
l	O
(	O
cid:1	O
)	O
in	O
the	O
second	O
view	O
.	O
the	O
3-space	O
point	B
x	O
which	O
projects	O
to	O
x	O
must	O
lie	O
on	O
this	O
ray	O
,	O
so	O
the	O
image	O
of	O
x	O
in	O
the	O
second	O
view	O
must	O
lie	O
on	O
l	O
(	O
cid:1	O
)	O
.	O
π	O
l	O
/	O
l	O
e	O
/	O
e	O
baseline	O
a	O
e	O
baseline	O
x	O
b	O
/	O
e	O
fig	O
.	O
9.2.	O
epipolar	B
geometry	O
.	O
(	O
a	O
)	O
the	O
camera	B
baseline	O
intersects	O
each	O
image	B
plane	I
at	O
the	O
epipoles	B
e	O
and	O
e	O
(	O
cid:1	O
)	O
.	O
any	O
plane	B
π	O
containing	O
the	O
baseline	O
is	O
an	O
epipolar	B
plane	O
,	O
and	O
intersects	O
the	O
image	O
planes	O
in	O
corresponding	O
epipolar	B
lines	I
l	O
and	O
l	O
(	O
cid:1	O
)	O
.	O
(	O
b	O
)	O
as	O
the	O
position	O
of	O
the	O
3d	O
point	B
x	O
varies	O
,	O
the	O
epipolar	B
planes	O
“	O
rotate	O
”	O
about	O
the	O
baseline	O
.	O
this	O
family	O
of	O
planes	O
is	O
known	O
as	O
an	O
epipolar	B
pencil	O
.	O
all	O
epipolar	B
lines	I
intersect	O
at	O
the	O
epipole	O
.	O
supposing	O
now	O
that	O
we	O
know	O
only	O
x	O
,	O
we	O
may	O
ask	O
how	O
the	O
corresponding	O
point	B
x	O
(	O
cid:2	O
)	O
is	O
constrained	O
.	O
the	O
plane	B
π	O
is	O
determined	O
by	O
the	O
baseline	O
and	O
the	O
ray	O
deﬁned	O
by	O
x.	O
from	O
above	O
we	O
know	O
that	O
the	O
ray	O
corresponding	O
to	O
the	O
(	O
unknown	O
)	O
point	B
x	O
(	O
cid:2	O
)	O
lies	O
in	O
π	O
,	O
hence	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
of	O
π	O
with	O
the	O
second	O
image	B
plane	I
.	O
this	O
line	B
l	O
(	O
cid:2	O
)	O
is	O
the	O
image	O
in	O
the	O
second	O
view	O
of	O
the	O
ray	O
back-projected	O
from	O
x.	O
it	O
is	O
the	O
epipolar	B
line	I
corresponding	O
to	O
x.	O
in	O
terms	O
of	O
a	O
stereo	O
correspondence	O
algorithm	B
the	O
beneﬁt	O
is	O
that	O
the	O
search	O
for	O
the	O
point	B
corresponding	O
to	O
x	O
need	O
not	O
cover	O
the	O
entire	O
image	B
plane	I
but	O
can	O
be	O
restricted	O
to	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
lies	O
on	O
the	O
line	B
of	O
intersection	B
l	O
(	O
cid:2	O
)	O
.	O
the	O
geometric	B
entities	O
involved	O
in	O
epipolar	O
geometry	O
are	O
illustrated	O
in	O
ﬁgure	O
9.2.	O
the	O
terminology	B
is	O
•	O
the	O
epipole	O
is	O
the	O
point	B
of	O
intersection	B
of	O
the	O
line	B
joining	O
the	O
camera	B
centres	O
(	O
the	O
baseline	O
)	O
with	O
the	O
image	B
plane	I
.	O
equivalently	O
,	O
the	O
epipole	O
is	O
the	O
image	O
in	O
one	O
view	O
9.2	O
the	O
fundamental	B
matrix	I
f	O
241	O
e	O
e	O
/	O
a	O
b	O
c	O
fig	O
.	O
9.3.	O
converging	O
cameras	B
.	O
(	O
a	O
)	O
epipolar	B
geometry	O
for	O
converging	O
cameras	B
.	O
(	O
b	O
)	O
and	O
(	O
c	O
)	O
a	O
pair	O
of	O
images	O
with	O
superimposed	O
corresponding	O
points	O
and	O
their	O
epipolar	B
lines	I
(	O
in	O
white	O
)	O
.	O
the	O
motion	O
between	O
the	O
views	O
is	O
a	O
translation	O
and	O
rotation	B
.	O
in	O
each	O
image	O
,	O
the	O
direction	O
of	O
the	O
other	O
camera	B
may	O
be	O
inferred	O
from	O
the	O
intersection	B
of	O
the	O
pencil	O
of	B
epipolar	I
lines	I
.	O
in	O
this	O
case	O
,	O
both	O
epipoles	O
lie	O
outside	O
of	O
the	O
visible	O
image	O
.	O
of	O
the	O
camera	O
centre	B
of	O
the	O
other	O
view	O
.	O
it	O
is	O
also	O
the	O
vanishing	O
point	O
of	O
the	O
baseline	O
(	O
translation	O
)	O
direction	O
.	O
•	O
an	O
epipolar	B
plane	O
is	O
a	O
plane	B
containing	O
the	O
baseline	O
.	O
there	O
is	O
a	O
one-parameter	O
family	O
(	O
a	O
pencil	O
)	O
of	O
epipolar	O
planes	O
.	O
•	O
an	O
epipolar	B
line	I
is	O
the	O
intersection	B
of	O
an	O
epipolar	B
plane	O
with	O
the	O
image	B
plane	I
.	O
all	O
epipolar	B
lines	I
intersect	O
at	O
the	O
epipole	O
.	O
an	O
epipolar	B
plane	O
intersects	O
the	O
left	O
and	O
right	O
image	O
planes	O
in	O
epipolar	O
lines	B
,	O
and	O
deﬁnes	O
the	O
correspondence	B
between	O
the	O
lines	B
.	O
examples	B
of	O
epipolar	B
geometry	O
are	O
given	O
in	O
ﬁgure	O
9.3	O
and	O
ﬁgure	O
9.4.	O
the	O
epipolar	B
geometry	O
of	O
these	O
image	O
pairs	O
,	O
and	O
indeed	O
all	O
the	O
examples	B
of	O
this	O
chapter	O
,	O
is	O
computed	O
directly	O
from	O
the	O
images	O
as	O
described	O
in	O
section	O
11.6	O
(	O
p290	O
)	O
.	O
9.2	O
the	O
fundamental	B
matrix	I
f	O
the	O
fundamental	B
matrix	I
is	O
the	O
algebraic	B
representation	O
of	O
epipolar	O
geometry	O
.	O
in	O
the	O
following	O
we	O
derive	O
the	O
fundamental	B
matrix	I
from	O
the	O
mapping	O
between	O
a	O
point	O
and	O
its	O
epipolar	B
line	I
,	O
and	O
then	O
specify	O
the	O
properties	B
of	O
the	O
matrix	B
.	O
there	O
exists	O
a	O
corresponding	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
second	O
image	O
matching	O
the	O
point	B
x	O
must	O
lie	O
on	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
given	O
a	O
pair	O
of	O
images	O
,	O
it	O
was	O
seen	O
in	O
ﬁgure	O
9.1	O
that	O
to	O
each	O
point	B
x	O
in	B
one	I
image	I
,	O
in	O
the	O
.	O
the	O
epipolar	B
line	I
in	O
the	O
other	O
image	O
.	O
any	O
point	B
x	O
(	O
cid:2	O
)	O
242	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
e	O
at	O
infinity	O
/	O
e	O
at	O
infinity	O
a	O
b	O
c	O
fig	O
.	O
9.4.	O
motion	O
parallel	B
to	O
the	O
image	B
plane	I
.	O
in	O
the	O
case	O
of	O
a	O
special	O
motion	O
where	O
the	O
translation	O
is	O
parallel	B
to	O
the	O
image	B
plane	I
,	O
and	O
the	O
rotation	B
axis	O
is	O
perpendicular	O
to	O
the	O
image	B
plane	I
,	O
the	O
intersection	B
of	O
the	O
baseline	O
with	O
the	O
image	B
plane	I
is	O
at	B
inﬁnity	I
.	O
consequently	O
the	O
epipoles	B
are	O
at	B
inﬁnity	I
,	O
and	O
epipolar	B
lines	I
are	O
parallel	B
.	O
(	O
a	O
)	O
epipolar	B
geometry	O
for	O
motion	O
parallel	B
to	O
the	O
image	B
plane	I
.	O
(	O
b	O
)	O
and	O
(	O
c	O
)	O
a	O
pair	O
of	O
images	O
for	O
which	O
the	O
motion	O
between	O
views	O
is	O
(	O
approximately	O
)	O
a	O
translation	O
parallel	B
to	O
the	O
x-axis	O
,	O
with	O
no	O
rotation	B
.	O
four	O
corresponding	O
epipolar	B
lines	I
are	O
superimposed	O
in	O
white	O
.	O
note	O
that	O
corresponding	O
points	O
lie	O
on	O
corresponding	O
epipolar	B
lines	I
.	O
is	O
the	O
projection	B
in	O
the	O
second	O
image	O
of	O
the	O
ray	O
from	O
the	O
point	B
x	O
through	O
the	O
camera	B
centre	I
c	O
of	O
the	O
ﬁrst	O
camera	B
.	O
thus	O
,	O
there	O
is	O
a	O
map	O
x	O
(	O
cid:6	O
)	O
→	O
l	O
(	O
cid:2	O
)	O
from	O
a	O
point	B
in	O
one	O
image	O
to	O
its	O
corresponding	O
epipolar	B
line	I
in	O
the	O
other	O
image	O
.	O
it	O
is	O
the	O
nature	O
of	O
this	O
map	O
that	O
will	O
now	O
be	O
explored	O
.	O
it	O
will	O
turn	O
out	O
that	O
this	O
mapping	O
is	O
a	O
(	O
singular	O
)	O
correlation	B
,	O
that	O
is	O
a	O
projective	B
mapping	O
from	O
points	O
to	O
lines	O
,	O
which	O
is	O
represented	O
by	O
a	O
matrix	B
f	O
,	O
the	O
fundamental	B
matrix	I
.	O
9.2.1	O
geometric	B
derivation	I
we	O
begin	O
with	O
a	O
geometric	B
derivation	I
of	O
the	O
fundamental	B
matrix	I
.	O
the	O
mapping	O
from	O
a	O
point	B
in	O
one	O
image	O
to	O
a	O
corresponding	O
epipolar	B
line	I
in	O
the	O
other	O
image	O
may	O
be	O
de-	O
composed	O
into	O
two	O
steps	O
.	O
in	O
the	O
ﬁrst	O
step	O
,	O
the	O
point	B
x	O
is	O
mapped	O
to	O
some	O
point	B
x	O
(	O
cid:2	O
)	O
in	O
the	O
other	O
image	O
lying	O
on	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
is	O
a	O
potential	O
match	O
for	O
the	O
point	B
x.	O
in	O
the	O
second	O
step	O
,	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
to	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
is	O
obtained	O
as	O
the	O
line	B
joining	O
x	O
(	O
cid:2	O
)	O
.	O
this	O
point	B
x	O
(	O
cid:2	O
)	O
.	O
step	O
1	O
:	O
point	B
transfer	I
via	O
a	O
plane	B
.	O
refer	O
to	O
ﬁgure	O
9.5.	O
consider	O
a	O
plane	B
π	O
in	O
space	O
not	O
passing	O
through	O
either	O
of	O
the	O
two	O
camera	B
centres	O
.	O
the	O
ray	O
through	O
the	O
ﬁrst	O
camera	B
centre	I
corresponding	O
to	O
the	O
point	B
x	O
meets	O
the	O
plane	B
π	O
in	O
a	O
point	B
x.	O
this	O
point	B
x	O
is	O
then	O
projected	O
to	O
a	O
point	B
x	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
image	O
.	O
this	O
procedure	O
is	O
known	O
as	O
transfer	B
via	O
the	O
plane	B
π.	O
since	O
x	O
lies	O
on	O
the	O
ray	O
corresponding	O
to	O
x	O
,	O
the	O
projected	O
point	B
x	O
(	O
cid:2	O
)	O
must	O
lie	O
on	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
corresponding	O
to	O
the	O
image	O
of	O
this	O
ray	O
,	O
as	O
illustrated	O
in	O
9.2	O
the	O
fundamental	B
matrix	I
f	O
243	O
x	O
π	O
x	O
e	O
h	O
π	O
/	O
l	O
/x	O
/	O
e	O
fig	O
.	O
9.5.	O
a	O
point	B
x	O
in	B
one	I
image	I
is	O
transferred	O
via	O
the	O
plane	O
π	O
to	O
a	O
matching	B
point	O
x	O
(	O
cid:1	O
)	O
image	O
.	O
the	O
epipolar	B
line	I
through	O
x	O
(	O
cid:1	O
)	O
write	O
x	O
(	O
cid:1	O
)	O
=	O
hπx	O
and	O
l	O
(	O
cid:1	O
)	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×x	O
(	O
cid:1	O
)	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×hπx	O
=	O
fx	O
where	O
f	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×hπ	O
is	O
the	O
fundamental	B
matrix	I
.	O
is	O
obtained	O
by	O
joining	O
x	O
(	O
cid:1	O
)	O
to	O
the	O
epipole	O
e	O
(	O
cid:1	O
)	O
in	O
the	O
second	O
.	O
in	O
symbols	O
one	O
may	O
ﬁgure	O
9.1b	O
.	O
the	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
are	O
both	B
images	I
of	O
the	O
3d	O
point	B
x	O
lying	O
on	O
a	O
plane	O
.	O
the	O
set	O
of	O
all	O
such	O
points	O
xi	O
in	O
the	O
ﬁrst	O
image	O
and	O
the	O
corresponding	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
in	O
the	O
second	O
image	O
are	O
projectively	O
equivalent	B
,	O
since	O
they	O
are	O
each	O
projectively	O
equivalent	B
to	O
(	O
cid:0	O
)	O
mapping	O
each	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
the	O
planar	O
point	O
set	O
xi	O
.	O
thus	O
there	O
is	O
a	O
2d	O
homography	B
h	O
i.	O
step	O
2	O
:	O
constructing	O
the	O
epipolar	B
line	I
.	O
given	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
=	O
e	O
(	O
cid:2	O
)	O
×	O
x	O
(	O
cid:2	O
)	O
through	O
x	O
(	O
cid:2	O
)	O
may	O
be	O
written	O
as	O
x	O
(	O
cid:2	O
)	O
is	O
deﬁned	O
in	O
(	O
a4.5–p581	O
)	O
)	O
.	O
since	O
x	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
=	O
h	O
can	O
be	O
written	O
as	O
l	O
(	O
cid:2	O
)	O
]	O
×x	O
(	O
cid:2	O
)	O
x	O
,	O
we	O
have	O
and	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
(	O
the	O
notation	O
[	O
e	O
(	O
cid:2	O
)	O
passing	O
]	O
×	O
x	O
=	O
fx	O
(	O
cid:0	O
)	O
]	O
×h	O
(	O
cid:0	O
)	O
]	O
×h	O
where	O
we	O
deﬁne	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
(	O
cid:0	O
)	O
,	O
the	O
fundamental	B
matrix	I
.	O
this	O
shows	O
result	O
9.1.	O
the	O
fundamental	B
matrix	I
f	O
may	O
be	O
written	O
as	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
transfer	B
mapping	O
from	O
one	O
image	O
to	O
another	O
via	O
any	O
plane	B
π.	O
furthermore	O
,	O
since	O
[	O
e	O
(	O
cid:2	O
)	O
has	O
rank	O
2	O
and	O
h	O
(	O
cid:0	O
)	O
rank	O
3	O
,	O
f	O
is	O
a	O
matrix	B
of	O
rank	O
2	O
.	O
(	O
cid:0	O
)	O
,	O
where	O
h	O
]	O
×h	O
(	O
cid:0	O
)	O
is	O
the	O
]	O
×	O
geometrically	O
,	O
f	O
represents	O
a	O
mapping	O
from	O
the	O
2-dimensional	O
projective	B
plane	I
ip2	O
of	O
the	O
ﬁrst	O
image	O
to	O
the	O
pencil	O
of	B
epipolar	I
lines	I
through	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
.	O
thus	O
,	O
it	O
rep-	O
resents	O
a	O
mapping	O
from	O
a	O
2-dimensional	O
onto	O
a	O
1-dimensional	O
projective	B
space	O
,	O
and	O
hence	O
must	O
have	O
rank	O
2.	O
note	O
,	O
the	O
geometric	B
derivation	I
above	O
involves	O
a	O
scene	O
plane	O
π	O
,	O
but	O
a	O
plane	B
is	O
not	O
required	O
in	O
order	O
for	O
f	O
to	O
exist	O
.	O
the	O
plane	B
is	O
simply	O
used	O
here	O
as	O
a	O
means	O
of	O
deﬁning	O
a	O
point	B
map	O
from	O
one	O
image	O
to	O
another	O
.	O
the	O
connection	O
between	O
the	O
fundamental	B
matrix	I
and	O
transfer	B
of	O
points	O
from	O
one	O
image	O
to	O
another	O
via	O
a	O
plane	B
is	O
dealt	O
with	O
in	O
some	O
depth	O
in	O
chapter	O
13	O
.	O
9.2.2	O
algebraic	B
derivation	I
the	O
form	B
of	I
the	O
fundamental	B
matrix	I
in	O
terms	O
of	O
the	O
two	O
camera	B
projection	O
matri-	O
ces	O
,	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
,	O
may	O
be	O
derived	O
algebraically	O
.	O
the	O
following	O
formulation	O
is	O
due	O
to	O
xu	O
and	O
zhang	O
[	O
xu-96	O
]	O
.	O
244	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
the	O
ray	O
back-projected	O
from	O
x	O
by	O
p	O
is	O
obtained	O
by	O
solving	B
px	O
=	O
x.	O
the	O
one-	O
parameter	O
family	O
of	O
solutions	O
is	O
of	O
the	O
form	O
given	O
by	O
(	O
6.13–p162	O
)	O
as	O
x	O
(	O
λ	O
)	O
=p	O
+x	O
+	O
λc	O
where	O
p+	O
is	O
the	O
pseudo-inverse	B
of	O
p	O
,	O
i.e	O
.	O
pp+	O
=	O
i	O
,	O
and	O
c	O
its	O
null-vector	O
,	O
namely	O
the	O
camera	B
centre	I
,	O
deﬁned	O
by	O
pc	O
=	O
0.	O
the	O
ray	O
is	O
parametrized	O
by	O
the	O
scalar	O
λ.	O
in	O
particular	O
two	O
points	O
on	O
the	O
ray	O
are	O
p+x	O
(	O
at	O
λ	O
=	O
0	O
)	O
,	O
and	O
the	O
ﬁrst	O
camera	B
centre	I
c	O
(	O
at	O
λ	O
=	O
∞	O
)	O
.	O
these	O
two	O
points	O
are	O
imaged	O
by	O
the	O
second	O
camera	B
p	O
(	O
cid:2	O
)	O
at	O
p	O
(	O
cid:2	O
)	O
p+x	O
and	O
p	O
(	O
cid:2	O
)	O
c	O
respectively	O
in	O
the	O
second	O
view	O
.	O
the	O
epipolar	B
line	I
is	O
the	O
line	B
joining	O
these	O
two	O
projected	O
=	O
(	O
p	O
(	O
cid:2	O
)	O
c	O
)	O
×	O
(	O
p	O
(	O
cid:2	O
)	O
p+x	O
)	O
.	O
the	O
point	B
p	O
(	O
cid:2	O
)	O
c	O
is	O
the	O
epipole	O
in	O
the	O
second	O
image	O
,	O
points	O
,	O
namely	O
l	O
(	O
cid:2	O
)	O
namely	O
the	O
projection	B
of	O
the	O
ﬁrst	O
camera	B
centre	I
,	O
and	O
may	O
be	O
denoted	O
by	O
e	O
(	O
cid:2	O
)	O
.	O
thus	O
,	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
]	O
×	O
(	O
p	O
(	O
cid:2	O
)	O
p+	O
)	O
x	O
=	O
fx	O
,	O
where	O
f	O
is	O
the	O
matrix	B
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×p	O
(	O
cid:2	O
)	O
p+	O
.	O
(	O
9.1	O
)	O
this	O
is	O
essentially	O
the	O
same	O
formula	O
for	O
the	O
fundamental	B
matrix	I
as	O
the	O
one	O
derived	O
in	O
(	O
cid:0	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
p+	O
in	O
terms	O
the	O
previous	O
section	O
,	O
the	O
homography	B
h	O
(	O
cid:0	O
)	O
having	O
the	O
explicit	O
form	O
h	O
of	O
the	O
two	O
camera	B
matrices	I
.	O
note	O
that	O
this	O
derivation	B
breaks	O
down	O
in	O
the	O
case	O
where	O
the	O
two	O
camera	O
centres	O
are	O
the	O
same	O
for	O
,	O
in	O
this	O
case	O
,	O
c	O
is	O
the	O
common	O
camera	B
centre	I
,	O
and	O
so	O
p	O
(	O
cid:2	O
)	O
c	O
=	O
0.	O
it	O
follows	O
that	O
f	O
deﬁned	O
in	O
(	O
9.1	O
)	O
is	O
the	O
zero	O
matrix	O
.	O
of	O
both	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
example	O
9.2.	O
suppose	O
the	O
camera	B
matrices	I
are	O
those	O
of	O
a	O
calibrated	O
stereo	O
rig	O
with	O
the	O
world	O
origin	O
at	O
the	O
ﬁrst	O
camera	B
p	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
(	O
cid:17	O
)	O
k−1	O
0t	O
p+	O
=	O
p	O
(	O
cid:2	O
)	O
[	O
r	O
|	O
t	O
]	O
.	O
=	O
k	O
(	O
cid:2	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:18	O
)	O
c	O
=	O
0	O
1	O
then	O
and	O
f	O
=	O
[	O
p	O
(	O
cid:2	O
)	O
c	O
]	O
×p	O
(	O
cid:2	O
)	O
p+	O
=	O
[	O
k	O
(	O
cid:2	O
)	O
t	O
]	O
×k	O
(	O
cid:2	O
)	O
rk−1	O
=	O
k	O
(	O
cid:2	O
)	O
−t	O
[	O
t	O
]	O
×rk−1	O
=	O
k	O
(	O
cid:2	O
)	O
−tr	O
[	O
rtt	O
]	O
×k−1	O
=	O
k	O
(	O
cid:2	O
)	O
−trkt	O
[	O
krtt	O
]	O
×	O
(	O
9.2	O
)	O
where	O
the	O
various	O
forms	O
follow	O
from	O
result	O
a4.3	O
(	O
p582	O
)	O
.	O
note	O
that	O
the	O
epipoles	B
(	O
deﬁned	O
as	O
the	O
image	O
of	O
the	O
other	O
camera	B
centre	I
)	O
are	O
=	O
krtt	O
e	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
=	O
k	O
(	O
cid:2	O
)	O
t.	O
(	O
9.3	O
)	O
(	O
cid:20	O
)	O
−rtt	O
(	O
cid:21	O
)	O
e	O
=	O
p	O
1	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
0	O
1	O
thus	O
we	O
may	O
write	O
(	O
9.2	O
)	O
as	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×k	O
(	O
cid:2	O
)	O
rk−1	O
=	O
k	O
(	O
cid:2	O
)	O
−t	O
[	O
t	O
]	O
×rk−1	O
=	O
k	O
(	O
cid:2	O
)	O
−tr	O
[	O
rtt	O
]	O
×k−1	O
=	O
k	O
(	O
cid:2	O
)	O
−trkt	O
[	O
e	O
]	O
×	O
.	O
(	O
9.4	O
)	O
(	O
cid:2	O
)	O
the	O
expression	O
for	O
the	O
fundamental	B
matrix	I
can	O
be	O
derived	O
in	O
many	O
ways	O
,	O
and	O
indeed	O
will	O
be	O
derived	O
again	O
several	O
times	O
in	O
this	O
book	O
.	O
in	O
particular	O
,	O
(	O
17.3–p412	O
)	O
expresses	O
f	O
in	O
terms	O
of	O
4	O
×	O
4	O
determinants	O
composed	O
from	O
rows	O
of	O
the	O
camera	O
matrices	O
for	O
each	O
view	O
.	O
9.2	O
the	O
fundamental	B
matrix	I
f	O
245	O
9.2.3	O
correspondence	B
condition	O
up	O
to	O
this	O
point	B
we	O
have	O
considered	O
the	O
map	O
x	O
→	O
l	O
(	O
cid:2	O
)	O
the	O
most	O
basic	O
properties	O
of	O
the	O
fundamental	O
matrix	B
.	O
deﬁned	O
by	O
f.	O
we	O
may	O
now	O
state	O
result	O
9.3.	O
the	O
fundamental	B
matrix	I
satisﬁes	O
the	O
condition	O
that	O
for	O
any	O
pair	O
of	O
corre-	O
sponding	O
points	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
in	O
the	O
two	O
images	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0.	O
correspond	O
,	O
then	O
x	O
(	O
cid:2	O
)	O
this	O
is	O
true	O
,	O
because	O
if	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
lies	O
on	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
=	O
x	O
(	O
cid:2	O
)	O
tfx	O
.	O
conversely	O
,	O
=	O
fx	O
corresponding	O
to	O
the	O
point	B
x.	O
in	O
other	O
words	O
0	O
=	O
x	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
if	O
image	O
points	O
satisfy	O
the	O
relation	B
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
then	O
the	O
rays	O
deﬁned	O
by	O
these	O
points	O
are	O
coplanar	O
.	O
this	O
is	O
a	O
necessary	O
condition	O
for	O
points	O
to	O
correspond	O
.	O
the	O
importance	O
of	O
the	O
relation	O
of	O
result	O
9.3	O
is	O
that	O
it	O
gives	O
a	O
way	O
of	O
characterizing	O
the	O
fundamental	B
matrix	I
without	O
reference	O
to	O
the	O
camera	B
matrices	I
,	O
i.e	O
.	O
only	O
in	O
terms	O
of	O
corresponding	O
image	O
points	O
.	O
this	O
enables	O
f	O
to	O
be	O
computed	O
from	O
image	O
correspon-	O
dences	O
alone	O
.	O
we	O
have	O
seen	O
from	O
(	O
9.1	O
)	O
that	O
f	O
may	O
be	O
computed	O
from	O
the	O
two	O
camera	O
matrices	O
,	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
,	O
and	O
in	O
particular	O
that	O
f	O
is	O
determined	O
uniquely	O
from	O
the	O
cameras	B
,	O
up	O
to	O
an	O
overall	O
scaling	B
.	O
however	O
,	O
we	O
may	O
now	O
enquire	O
how	O
many	O
correspondences	B
are	O
required	O
to	O
compute	O
f	O
from	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
,	O
and	O
the	O
circumstances	O
under	O
which	O
the	O
ma-	O
trix	O
is	O
uniquely	O
deﬁned	O
by	O
these	O
correspondences	B
.	O
the	O
details	O
of	O
this	O
are	O
postponed	O
until	O
chapter	O
11	O
,	O
where	O
it	O
will	O
be	O
seen	O
that	O
in	O
general	O
at	O
least	O
7	O
correspondences	B
are	O
required	O
to	O
compute	O
f.	O
9.2.4	O
properties	B
of	O
the	O
fundamental	B
matrix	I
deﬁnition	O
9.4.	O
suppose	O
we	O
have	O
two	O
images	O
acquired	O
by	O
cameras	B
with	O
non-coincident	O
centres	O
,	O
then	O
the	O
fundamental	B
matrix	I
f	O
is	O
the	O
unique	O
3×3	O
rank	O
2	O
homogeneous	O
matrix	O
which	O
satisﬁes	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
(	O
9.5	O
)	O
for	O
all	O
corresponding	O
points	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
we	O
now	O
brieﬂy	O
list	O
a	O
number	O
of	O
properties	O
of	O
the	O
fundamental	O
matrix	B
.	O
the	O
most	O
.	O
important	O
properties	B
are	O
also	O
summarized	O
in	O
table	O
9.1	O
.	O
(	O
i	O
)	O
transpose	O
:	O
if	O
f	O
is	O
the	O
fundamental	B
matrix	I
of	O
the	O
pair	O
of	O
cameras	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
,	O
then	O
(	O
ii	O
)	O
epipolar	B
lines	I
:	O
for	O
any	O
point	B
x	O
in	O
the	O
ﬁrst	O
image	O
,	O
the	O
corresponding	O
epipolar	B
represents	O
the	O
epipolar	B
line	I
corresponding	O
=	O
fx	O
.	O
similarly	O
,	O
l	O
=	O
ftx	O
(	O
cid:2	O
)	O
ft	O
is	O
the	O
fundamental	B
matrix	I
of	O
the	O
pair	O
in	O
the	O
opposite	O
order	O
:	O
(	O
p	O
(	O
cid:2	O
)	O
line	B
is	O
l	O
(	O
cid:2	O
)	O
to	O
x	O
(	O
cid:2	O
)	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
tf	O
=	O
0	O
,	O
i.e	O
.	O
e	O
(	O
cid:2	O
)	O
null-vector	O
of	O
f.	O
=	O
fx	O
contains	O
satisﬁes	O
e	O
(	O
cid:2	O
)	O
t	O
(	O
fx	O
)	O
=	O
(	O
e	O
(	O
cid:2	O
)	O
tf	O
)	O
x	O
=	O
0	O
for	O
all	O
x.	O
it	O
follows	O
that	O
is	O
the	O
left	O
null-vector	O
of	O
f.	O
similarly	O
fe	O
=	O
0	O
,	O
i.e	O
.	O
e	O
is	O
the	O
right	O
(	O
iii	O
)	O
the	O
epipole	O
:	O
for	O
any	O
point	B
x	O
(	O
other	O
than	O
e	O
)	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
image	O
.	O
.	O
thus	O
e	O
(	O
cid:2	O
)	O
,	O
p	O
)	O
.	O
x	O
(	O
cid:1	O
)	O
tfx	O
=	O
0	O
.	O
•	O
epipolar	B
lines	I
:	O
(	O
cid:21	O
)	O
l	O
(	O
cid:1	O
)	O
=	O
fx	O
is	O
the	O
epipolar	B
line	I
corresponding	O
to	O
x	O
.	O
(	O
cid:21	O
)	O
l	O
=	O
ftx	O
(	O
cid:1	O
)	O
is	O
the	O
epipolar	B
line	I
corresponding	O
to	O
x	O
(	O
cid:1	O
)	O
•	O
epipoles	B
:	O
(	O
cid:21	O
)	O
fe	O
=	O
0	O
.	O
(	O
cid:21	O
)	O
fte	O
(	O
cid:1	O
)	O
=	O
0.	O
.	O
•	O
computation	B
from	I
camera	I
matrices	I
p	O
,	O
p	O
(	O
cid:1	O
)	O
:	O
(	O
cid:21	O
)	O
general	O
cameras	O
,	O
246	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
•	O
f	O
is	O
a	O
rank	O
2	O
homogeneous	O
matrix	O
with	O
7	O
degrees	B
of	I
freedom	I
.	O
•	O
point	B
correspondence	O
:	O
if	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
are	O
corresponding	O
image	O
points	O
,	O
then	O
f	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×p	O
(	O
cid:1	O
)	O
p+	O
,	O
where	O
p+	O
is	O
the	O
pseudo-inverse	B
of	O
p	O
,	O
and	O
e	O
(	O
cid:1	O
)	O
=	O
p	O
(	O
cid:1	O
)	O
c	O
,	O
with	O
pc	O
=	O
0	O
.	O
(	O
cid:21	O
)	O
canonical	O
cameras	O
,	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:1	O
)	O
=	O
[	O
m	O
|	O
m	O
]	O
,	O
f	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×m	O
=	O
m−t	O
[	O
e	O
]	O
×	O
,	O
where	O
e	O
(	O
cid:1	O
)	O
=	O
m	O
and	O
e	O
=	O
m−1m	O
.	O
(	O
cid:21	O
)	O
cameras	B
not	O
at	B
inﬁnity	I
p	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:1	O
)	O
=	O
k	O
(	O
cid:1	O
)	O
[	O
r	O
|	O
t	O
]	O
,	O
f	O
=	O
k	O
(	O
cid:1	O
)	O
−t	O
[	O
t	O
]	O
×rk−1	O
=	O
[	O
k	O
(	O
cid:1	O
)	O
t	O
]	O
×k	O
(	O
cid:1	O
)	O
rk−1	O
=	O
k	O
(	O
cid:1	O
)	O
−trkt	O
[	O
krtt	O
]	O
×	O
.	O
table	O
9.1.	O
summary	B
of	O
fundamental	B
matrix	I
properties	O
.	O
(	O
iv	O
)	O
f	O
has	O
seven	O
degrees	B
of	I
freedom	I
:	O
a	O
3×3	O
homogeneous	O
matrix	O
has	O
eight	O
indepen-	O
dent	O
ratios	O
(	O
there	O
are	O
nine	O
elements	O
,	O
and	O
the	O
common	O
scaling	B
is	O
not	O
signiﬁcant	O
)	O
;	O
however	O
,	O
f	O
also	O
satisﬁes	O
the	O
constraint	O
det	O
f	O
=	O
0	O
which	O
removes	O
one	O
degree	O
of	O
freedom	O
.	O
=	O
fx	O
,	O
which	O
is	O
the	O
epipolar	B
line	I
of	O
x.	O
if	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
v	O
)	O
f	O
is	O
a	O
correlation	B
,	O
a	O
projective	B
map	O
taking	O
a	O
point	B
to	O
a	O
line	B
(	O
see	O
deﬁnition	B
2.29-	O
(	O
p59	O
)	O
)	O
.	O
in	O
this	O
case	O
a	O
point	B
in	O
the	O
ﬁrst	O
image	O
x	O
deﬁnes	O
a	O
line	B
in	O
the	O
second	O
l	O
(	O
cid:2	O
)	O
are	O
corresponding	O
epipolar	B
lines	I
(	O
see	O
ﬁgure	O
9.6a	O
)	O
then	O
any	O
point	B
x	O
on	O
l	O
is	O
mapped	O
to	O
the	O
same	O
line	O
l	O
(	O
cid:2	O
)	O
.	O
this	O
means	O
there	O
is	O
no	O
inverse	O
mapping	O
,	O
and	O
f	O
is	O
not	O
of	O
full	O
rank	O
.	O
for	O
this	O
reason	O
,	O
f	O
is	O
not	O
a	O
proper	O
correlation	B
(	O
which	O
would	O
be	O
invertible	O
)	O
.	O
9.2.5	O
the	O
epipolar	B
line	I
homography	I
the	O
set	O
of	B
epipolar	I
lines	I
in	O
each	O
of	O
the	O
images	O
forms	O
a	O
pencil	O
of	B
lines	I
passing	O
through	O
the	O
epipole	O
.	O
such	O
a	O
pencil	O
of	B
lines	I
may	O
be	O
considered	O
as	O
a	O
1-dimensional	O
projective	B
space	O
.	O
it	O
is	O
clear	O
from	O
ﬁgure	O
9.6b	O
that	O
corresponding	O
epipolar	B
lines	I
are	O
perspectively	O
related	O
,	O
so	O
that	O
there	O
is	O
a	O
homography	B
between	O
the	O
pencil	O
of	B
epipolar	I
lines	I
centred	O
at	O
e	O
in	O
the	O
ﬁrst	O
view	O
,	O
and	O
the	O
pencil	O
centred	O
at	O
e	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
.	O
a	O
homography	B
between	O
two	O
such	O
1-dimensional	O
projective	B
spaces	O
has	O
3	O
degrees	B
of	I
freedom	I
.	O
for	O
e	O
,	O
2	O
for	O
e	O
(	O
cid:2	O
)	O
line	B
through	O
e	O
(	O
cid:2	O
)	O
here	O
we	O
give	O
an	O
explicit	O
formula	O
for	O
this	O
mapping	O
.	O
the	O
degrees	B
of	I
freedom	I
of	O
the	O
fundamental	B
matrix	I
can	O
thus	O
be	O
counted	O
as	O
follows	O
:	O
2	O
,	O
and	O
3	O
for	O
the	O
epipolar	B
line	I
homography	I
which	O
maps	O
a	O
line	B
through	O
e	O
to	O
a	O
.	O
a	O
geometric	B
representation	I
of	O
this	O
homography	B
is	O
given	O
in	O
section	O
9.4	O
.	O
9.3	O
fundamental	O
matrices	O
arising	O
from	O
special	O
motions	O
247	O
l3	O
l	O
2	O
1l	O
3l/	O
/	O
2l	O
l/	O
1	O
e	O
e	O
/	O
p	O
a	O
b	O
fig	O
.	O
9.6.	O
epipolar	B
line	I
homography	I
.	O
(	O
a	O
)	O
there	O
is	O
a	O
pencil	O
of	B
epipolar	I
lines	I
in	O
each	O
image	O
centred	O
on	O
the	O
epipole	O
.	O
the	O
correspondence	B
between	O
epipolar	B
lines	I
,	O
li	O
↔	O
l	O
(	O
cid:1	O
)	O
i	O
,	O
is	O
deﬁned	O
by	O
the	O
pencil	O
of	O
planes	O
with	O
axis	O
the	O
baseline	O
.	O
(	O
b	O
)	O
the	O
corresponding	O
lines	B
are	O
related	O
by	O
a	O
perspectivity	O
with	O
centre	O
any	O
point	B
p	O
on	O
the	O
baseline	O
.	O
it	O
follows	O
that	O
the	O
correspondence	B
between	O
epipolar	B
lines	I
in	O
the	O
pencils	O
is	O
a	O
1d	O
homography	B
.	O
]	O
×l	O
(	O
cid:2	O
)	O
.	O
are	O
related	O
by	O
l	O
(	O
cid:2	O
)	O
.	O
are	O
corresponding	O
epipolar	B
lines	I
,	O
and	O
k	O
is	O
any	O
line	B
not	O
=	O
f	O
[	O
k	O
]	O
×l	O
.	O
symmetrically	O
,	O
result	O
9.5.	O
suppose	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
passing	O
through	O
the	O
epipole	O
e	O
,	O
then	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
l	O
=	O
ft	O
[	O
k	O
(	O
cid:2	O
)	O
proof	O
.	O
the	O
expression	O
[	O
k	O
]	O
×l	O
=	O
k	O
×	O
l	O
is	O
the	O
point	B
of	O
intersection	B
of	O
the	O
two	O
lines	O
k	O
and	O
l	O
,	O
and	O
hence	O
a	O
point	B
on	O
the	O
epipolar	B
line	I
l	O
–	O
call	O
it	O
x.	O
hence	O
,	O
f	O
[	O
k	O
]	O
×l	O
=	O
fx	O
is	O
the	O
epipolar	B
line	I
corresponding	O
to	O
the	O
point	B
x	O
,	O
namely	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
furthermore	O
a	O
convenient	O
choice	B
for	O
k	O
is	O
the	O
line	B
e	O
,	O
since	O
kte	O
=	O
ete	O
(	O
cid:5	O
)	O
=	O
0	O
,	O
so	O
that	O
the	O
line	B
e	O
does	O
not	O
pass	O
through	O
the	O
point	B
e	O
as	O
is	O
required	O
.	O
a	O
similar	O
argument	O
holds	O
for	O
the	O
choice	B
of	O
k	O
(	O
cid:2	O
)	O
.	O
thus	O
the	O
epipolar	B
line	I
homography	I
may	O
be	O
written	O
as	O
=	O
e	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
=	O
f	O
[	O
e	O
]	O
×l	O
l	O
=	O
ft	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×l	O
(	O
cid:2	O
)	O
.	O
9.3	O
fundamental	O
matrices	O
arising	O
from	O
special	O
motions	O
a	O
special	O
motion	O
arises	O
from	O
a	O
particular	O
relationship	O
between	O
the	O
translation	O
direction	O
,	O
t	O
,	O
and	O
the	O
direction	O
of	O
the	O
rotation	O
axis	O
,	O
a.	O
we	O
will	O
discuss	O
two	O
cases	O
:	O
pure	O
translation	O
,	O
where	O
there	O
is	O
no	O
rotation	O
;	O
and	O
pure	O
planar	B
motion	I
,	O
where	O
t	O
is	O
orthogonal	B
to	O
a	O
(	O
the	O
signiﬁcance	O
of	O
the	O
planar	O
motion	O
case	O
is	O
described	O
in	O
section	O
3.4.1	O
(	O
p77	O
)	O
)	O
.	O
the	O
‘	O
pure	O
’	O
indicates	O
that	O
there	O
is	O
no	O
change	O
in	O
the	O
internal	B
parameters	I
.	O
such	O
cases	O
are	O
important	O
,	O
ﬁrstly	O
because	O
they	O
occur	O
in	O
practice	O
,	O
for	O
example	O
a	O
camera	B
viewing	O
an	O
object	O
rotating	O
on	O
a	O
turntable	O
is	O
equivalent	B
to	O
planar	B
motion	I
for	O
pairs	O
of	O
views	O
;	O
and	O
secondly	O
because	O
the	O
fundamental	B
matrix	I
has	O
a	O
special	O
form	O
and	O
thus	O
additional	O
properties	B
.	O
9.3.1	O
pure	O
translation	O
in	O
considering	O
pure	O
translations	O
of	O
the	O
camera	O
,	O
one	O
may	O
consider	O
the	O
equivalent	B
situ-	O
ation	O
in	O
which	O
the	O
camera	B
is	O
stationary	O
,	O
and	O
the	O
world	O
undergoes	O
a	O
translation	O
−t	O
.	O
in	O
this	O
situation	O
points	O
in	O
3-space	O
move	O
on	O
straight	O
lines	B
parallel	O
to	O
t	O
,	O
and	O
the	O
imaged	O
in-	O
tersection	O
of	O
these	O
parallel	B
lines	I
is	O
the	O
vanishing	O
point	O
v	O
in	O
the	O
direction	O
of	O
t.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
9.7	O
and	O
ﬁgure	O
9.8.	O
it	O
is	O
evident	O
that	O
v	O
is	O
the	O
epipole	O
for	O
both	O
views	O
,	O
and	O
the	O
imaged	O
parallel	B
lines	I
are	O
the	O
epipolar	B
lines	I
.	O
the	O
algebraic	B
details	O
are	O
given	O
in	O
the	O
following	O
example	O
.	O
248	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
parallel	O
lines	B
e	O
vanishing	O
point	O
image	O
camera	O
centre	B
fig	O
.	O
9.7.	O
under	O
a	O
pure	O
translational	O
camera	O
motion	O
,	O
3d	O
points	O
appear	O
to	O
slide	O
along	O
parallel	B
rails	O
.	O
the	O
images	O
of	O
these	O
parallel	B
lines	I
intersect	O
in	O
a	O
vanishing	O
point	O
corresponding	O
to	O
the	O
translation	O
direction	O
.	O
the	O
epipole	O
e	O
is	O
the	O
vanishing	O
point	O
.	O
c	O
e	O
/	O
e	O
/	O
c	O
a	O
b	O
c	O
fig	O
.	O
9.8.	O
pure	O
translational	B
motion	I
.	O
(	O
a	O
)	O
under	O
the	O
motion	O
the	O
epipole	O
is	O
a	O
ﬁxed	O
point	O
,	O
i.e	O
.	O
has	O
the	O
same	O
coordinates	O
in	B
both	I
images	I
,	O
and	O
points	O
appear	O
to	O
move	O
along	O
lines	B
radiating	O
from	O
the	O
epipole	O
.	O
the	O
epipole	O
in	O
this	O
case	O
is	O
termed	O
the	O
focus	O
of	O
expansion	O
(	O
foe	O
)	O
.	O
(	O
b	O
)	O
and	O
(	O
c	O
)	O
the	O
same	O
epipolar	O
lines	B
are	O
overlaid	O
in	O
both	O
cases	O
.	O
note	O
the	O
motion	O
of	O
the	O
posters	O
on	O
the	O
wall	O
which	O
slide	O
along	O
the	O
epipolar	B
line	I
.	O
example	O
9.6.	O
suppose	O
the	O
motion	O
of	O
the	O
cameras	O
is	O
a	O
pure	O
translation	O
with	O
no	O
rotation	O
and	O
no	O
change	O
in	O
the	O
internal	B
parameters	I
.	O
one	O
may	O
assume	O
that	O
the	O
two	O
cameras	O
are	O
p	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
9.3	O
fundamental	O
matrices	O
arising	O
from	O
special	O
motions	O
=	O
k	O
[	O
i	O
|	O
t	O
]	O
.	O
then	O
from	O
(	O
9.4	O
)	O
(	O
using	O
r	O
=	O
i	O
and	O
k	O
=	O
k	O
(	O
cid:2	O
)	O
)	O
249	O
]	O
×	O
.	O
if	O
the	O
camera	B
translation	I
is	O
parallel	B
to	O
the	O
x-axis	O
,	O
then	O
e	O
(	O
cid:2	O
)	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×kk−1	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
so	O
	O
0	O
0	O
0	O
0	O
0	O
−1	O
0	O
0	O
1	O
	O
.	O
f	O
=	O
the	O
relation	B
between	O
corresponding	O
points	O
,	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
,	O
reduces	O
to	O
y	O
=	O
y	O
,	O
i.e	O
.	O
the	O
epipolar	B
lines	I
are	O
corresponding	O
rasters	O
.	O
this	O
is	O
the	O
situation	O
that	O
is	O
sought	O
by	O
image	O
(	O
cid:2	O
)	O
rectiﬁcation	O
described	O
in	O
section	O
11.12	O
(	O
p302	O
)	O
.	O
(	O
cid:2	O
)	O
indeed	O
if	O
the	O
image	O
point	O
x	O
is	O
normalized	O
as	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
,	O
then	O
from	O
x	O
=	O
px	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
x	O
,	O
the	O
space	O
point	O
’	O
s	O
(	O
inhomogeneous	O
)	O
coordinates	B
are	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
=	O
zk−1x	O
,	O
where	O
z	O
is	O
the	O
depth	O
of	O
the	O
point	B
x	O
(	O
the	O
distance	B
of	O
x	O
from	O
the	O
camera	B
centre	I
measured	O
along	O
the	O
principal	O
axis	O
of	O
the	O
ﬁrst	O
camera	B
)	O
.	O
it	O
then	O
follows	O
from	O
x	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
=	O
k	O
[	O
i	O
|	O
t	O
]	O
x	O
that	O
the	O
mapping	O
from	O
an	O
image	O
point	O
x	O
to	O
an	O
image	O
point	O
x	O
(	O
cid:2	O
)	O
is	O
x	O
(	O
cid:2	O
)	O
=	O
x	O
+	O
kt/z	O
.	O
(	O
9.6	O
)	O
the	O
motion	O
x	O
(	O
cid:2	O
)	O
=	O
x	O
+	O
kt/z	O
of	O
(	O
9.6	O
)	O
shows	O
that	O
the	O
image	O
point	O
“	O
starts	O
”	O
at	O
x	O
and	O
then	O
moves	O
along	O
the	O
line	B
deﬁned	O
by	O
x	O
and	O
the	O
epipole	O
e	O
=	O
e	O
(	O
cid:2	O
)	O
=	O
v.	O
the	O
extent	O
of	O
the	O
motion	O
depends	O
on	O
the	O
magnitude	O
of	O
the	O
translation	O
t	O
(	O
which	O
is	O
not	O
a	O
homogeneous	O
vector	O
here	O
)	O
and	O
the	O
inverse	O
depth	O
z	O
,	O
so	O
that	O
points	O
closer	O
to	O
the	O
camera	B
appear	O
to	O
move	O
faster	O
than	O
those	O
further	O
away	O
–	O
a	O
common	O
experience	O
when	O
looking	O
out	O
of	O
a	O
train	O
window	O
.	O
note	O
that	O
in	O
this	O
case	O
of	O
pure	O
translation	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
is	O
skew-symmetric	O
and	O
has	O
only	O
2	O
degrees	B
of	I
freedom	I
,	O
which	O
correspond	O
to	O
the	O
position	O
of	O
the	O
epipole	O
.	O
the	O
epipolar	B
line	I
of	O
x	O
is	O
l	O
(	O
cid:2	O
)	O
and	O
e	O
=	O
e	O
(	O
cid:2	O
)	O
are	O
collinear	O
(	O
assuming	O
both	O
images	O
are	O
overlaid	O
on	O
top	O
of	O
each	O
other	O
)	O
.	O
this	O
collinearity	O
property	O
is	O
termed	O
auto-epipolar	B
,	O
and	O
does	O
not	O
hold	O
for	O
general	O
motion	O
.	O
=	O
fx	O
=	O
[	O
e	O
]	O
×x	O
,	O
and	O
x	O
lies	O
on	O
this	O
line	B
since	O
xt	O
[	O
e	O
]	O
×x	O
=	O
0	O
,	O
i.e	O
.	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
general	B
motion	I
.	O
the	O
pure	O
translation	O
case	O
gives	O
additional	O
insight	O
into	O
the	O
general	B
motion	I
case	O
.	O
given	O
two	O
arbitrary	O
cameras	B
,	O
we	O
may	O
rotate	O
the	O
camera	B
used	O
for	O
the	O
ﬁrst	O
image	O
so	O
that	O
it	O
is	O
aligned	O
with	O
the	O
second	O
camera	B
.	O
this	O
rotation	B
may	O
be	O
simulated	O
by	O
applying	O
a	O
projective	B
transformation	I
to	O
the	O
ﬁrst	O
image	O
.	O
a	O
further	O
correction	B
may	O
be	O
applied	O
to	O
the	O
ﬁrst	O
image	O
to	O
account	O
for	O
any	O
difference	O
in	O
the	O
calibration	B
matrices	O
of	O
the	O
two	O
images	O
.	O
the	O
result	O
of	O
these	O
two	O
corrections	O
is	O
a	O
projective	B
transformation	I
h	O
of	O
the	O
ﬁrst	O
image	O
.	O
if	O
one	O
assumes	O
these	O
corrections	O
to	O
have	O
been	O
made	O
,	O
then	O
the	O
effective	O
relationship	O
of	O
the	O
two	O
cameras	O
to	O
each	O
other	O
is	O
that	O
of	O
a	O
pure	O
translation	O
.	O
consequently	O
,	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
the	O
corrected	O
ﬁrst	O
image	O
and	O
]	O
×	O
,	O
satisfying	O
x	O
(	O
cid:2	O
)	O
tˆfˆx	O
=	O
0	O
,	O
where	O
ˆx	O
=	O
hx	O
is	O
the	O
the	O
second	O
image	O
is	O
of	O
the	O
form	O
ˆf	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
corrected	O
point	B
in	O
the	O
ﬁrst	O
image	O
.	O
from	O
this	O
one	O
deduces	O
that	O
x	O
(	O
cid:2	O
)	O
t	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×hx	O
=	O
0	O
,	O
and	O
so	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
the	O
initial	O
point	O
correspondences	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
is	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×h	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
9.9	O
.	O
250	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
h	O
c	O
e	O
/e	O
/	O
c	O
fig	O
.	O
9.9.	O
general	O
camera	O
motion	O
.	O
the	O
ﬁrst	O
camera	B
(	O
on	O
the	O
left	O
)	O
may	O
be	O
rotated	O
and	O
corrected	O
to	O
simulate	O
a	O
pure	O
translational	B
motion	I
.	O
the	O
fundamental	B
matrix	I
for	O
the	O
original	O
pair	O
is	O
the	O
product	O
f	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×h	O
,	O
where	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×	O
is	O
the	O
fundamental	B
matrix	I
of	O
the	O
translation	O
,	O
and	O
h	O
is	O
the	O
projective	B
transformation	I
corresponding	O
to	O
the	O
correction	B
of	O
the	O
ﬁrst	O
camera	B
.	O
=	O
k	O
(	O
cid:2	O
)	O
example	O
9.7.	O
continuing	O
from	O
example	O
9.2	O
,	O
assume	O
again	O
that	O
the	O
two	O
cameras	O
are	O
p	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
[	O
r	O
|	O
t	O
]	O
.	O
then	O
as	O
described	O
in	O
section	O
8.4.2	O
(	O
p204	O
)	O
the	O
requisite	O
projective	B
transformation	I
is	O
h	O
=	O
k	O
(	O
cid:2	O
)	O
rk−1	O
=	O
h∞	O
,	O
where	O
h∞	O
is	O
the	O
inﬁnite	B
homography	I
(	O
see	O
section	O
13.4	O
(	O
p338	O
)	O
)	O
,	O
and	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
=	O
zk−1x	O
,	O
and	O
from	O
x	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
=	O
k	O
(	O
cid:2	O
)	O
point	B
x	O
to	O
an	O
image	O
point	O
x	O
(	O
cid:2	O
)	O
if	O
the	O
image	O
point	O
x	O
is	O
normalized	O
as	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
,	O
as	O
in	O
example	O
9.6	O
,	O
then	O
[	O
r	O
|	O
t	O
]	O
x	O
the	O
mapping	O
from	O
an	O
image	O
]	O
×h∞	O
.	O
is	O
x	O
(	O
cid:2	O
)	O
=	O
k	O
(	O
cid:2	O
)	O
rk−1x	O
+	O
k	O
(	O
cid:2	O
)	O
t/z	O
.	O
(	O
9.7	O
)	O
the	O
mapping	O
is	O
in	O
two	O
parts	O
:	O
the	O
ﬁrst	O
term	O
depends	O
on	O
the	O
image	O
position	O
alone	O
,	O
i.e	O
.	O
x	O
,	O
but	O
not	O
the	O
point	B
’	O
s	O
depth	O
z	O
,	O
and	O
takes	O
account	O
of	O
the	O
camera	O
rotation	O
and	O
change	O
of	O
internal	O
parameters	B
;	O
the	O
second	O
term	O
depends	O
on	O
the	O
depth	O
,	O
but	O
not	O
on	O
the	O
image	O
position	O
x	O
,	O
and	O
takes	O
account	O
of	B
camera	I
translation	O
.	O
in	O
the	O
case	O
of	O
pure	O
translation	O
(	O
cid:2	O
)	O
(	O
r	O
=	O
i	O
,	O
k	O
=	O
k	O
(	O
cid:2	O
)	O
)	O
(	O
9.7	O
)	O
reduces	O
to	O
(	O
9.6	O
)	O
.	O
9.3.2	O
pure	O
planar	B
motion	I
in	O
this	O
case	O
the	O
rotation	B
axis	O
is	O
orthogonal	B
to	O
the	O
translation	O
direction	O
.	O
orthogonality	B
imposes	O
one	O
constraint	O
on	O
the	O
motion	O
,	O
and	O
it	O
is	O
shown	O
in	O
the	O
exercises	O
at	O
the	O
end	O
of	O
this	O
chapter	O
that	O
if	O
k	O
(	O
cid:2	O
)	O
=	O
k	O
then	O
fs	O
,	O
the	O
symmetric	B
part	I
of	O
f	O
,	O
has	O
rank	O
2	O
in	O
this	O
planar	B
motion	I
case	O
(	O
note	O
,	O
for	O
a	O
general	O
motion	O
the	O
symmetric	B
part	I
of	O
f	O
has	O
full	O
rank	O
)	O
.	O
thus	O
,	O
the	O
condition	O
that	O
det	O
fs	O
=	O
0	O
is	O
an	O
additional	O
constraint	O
on	O
f	O
and	O
reduces	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
from	O
7	O
,	O
for	O
a	O
general	O
motion	O
,	O
to	O
6	O
degrees	B
of	I
freedom	I
for	O
a	O
pure	O
planar	B
motion	I
.	O
9.4	O
geometric	B
representation	I
of	O
the	O
fundamental	B
matrix	I
this	O
section	O
is	O
not	O
essential	O
for	O
a	O
ﬁrst	O
reading	O
and	O
the	O
reader	O
may	O
optionally	O
skip	O
to	O
section	O
9.5.	O
in	O
this	O
section	O
the	O
fundamental	B
matrix	I
is	O
decomposed	O
into	O
its	O
symmetric	B
and	O
skew-	O
symmetric	B
parts	O
,	O
and	O
each	O
part	O
is	O
given	O
a	O
geometric	B
representation	I
.	O
the	O
symmetric	B
and	O
9.4	O
geometric	B
representation	I
of	O
the	O
fundamental	B
matrix	I
251	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
f	O
−	O
ft	O
(	O
cid:16	O
)	O
/2	O
skew-symmetric	O
parts	O
of	O
the	O
fundamental	O
matrix	B
are	O
fs	O
=	O
f	O
+	O
ft	O
/2	O
fa	O
=	O
so	O
that	O
f	O
=	O
fs	O
+	O
fa	O
.	O
to	O
motivate	O
the	O
decomposition	B
,	O
consider	O
the	O
points	O
x	O
in	O
3-space	O
that	O
map	O
to	O
the	O
same	O
point	O
in	O
two	O
images	O
.	O
these	O
image	O
points	O
are	O
ﬁxed	O
under	O
the	O
camera	B
motion	I
so	O
that	O
x	O
=	O
x	O
(	O
cid:2	O
)	O
.	O
clearly	O
such	O
points	O
are	O
corresponding	O
and	O
thus	O
satisfy	O
xtfx	O
=	O
0	O
,	O
which	O
is	O
a	O
necessary	O
condition	O
on	O
corresponding	O
points	O
.	O
now	O
,	O
for	O
any	O
skew-symmetric	O
matrix	O
a	O
the	O
form	O
xtax	O
is	O
identically	O
zero	O
.	O
consequently	O
only	O
the	O
symmetric	B
part	I
of	O
f	O
contributes	O
to	O
xtfx	O
=	O
0	O
,	O
which	O
then	O
reduces	O
to	O
xtfsx	O
=	O
0.	O
as	O
will	O
be	O
seen	O
below	O
the	O
matrix	B
fs	O
may	O
be	O
thought	O
of	O
as	O
a	O
conic	B
in	O
the	O
image	B
plane	I
.	O
geometrically	O
the	O
conic	B
arises	O
as	O
follows	O
.	O
the	O
locus	O
of	O
all	O
points	O
in	O
3-space	O
for	O
which	O
x	O
=	O
x	O
(	O
cid:2	O
)	O
is	O
known	O
as	O
the	O
horopter	B
curve	O
.	O
generally	O
this	O
is	O
a	O
twisted	B
cubic	I
curve	O
in	O
3-space	O
(	O
see	O
section	O
3.3	O
(	O
p75	O
)	O
)	O
passing	O
through	O
the	O
two	O
camera	O
centres	O
[	O
maybank-93	O
]	O
.	O
the	O
image	O
of	O
the	O
horopter	O
is	O
the	O
conic	B
deﬁned	O
by	O
fs	O
.	O
we	O
return	O
to	O
the	O
horopter	B
in	O
chapter	O
22.	O
symmetric	B
part	I
.	O
the	O
matrix	B
fs	O
is	O
symmetric	B
and	O
is	O
of	O
rank	O
3	O
in	O
general	O
.	O
it	O
has	O
5	O
degrees	B
of	I
freedom	I
and	O
is	O
identiﬁed	O
with	O
a	O
point	B
conic	O
,	O
called	O
the	O
steiner	O
conic	B
(	O
the	O
name	O
is	O
explained	O
below	O
)	O
.	O
the	O
epipoles	B
e	O
and	O
e	O
(	O
cid:2	O
)	O
lie	O
on	O
the	O
conic	B
fs	O
.	O
to	O
see	O
that	O
the	O
epipoles	B
lie	O
on	O
the	O
conic	B
,	O
i.e	O
.	O
that	O
etfse	O
=	O
0	O
,	O
start	O
from	O
fe	O
=	O
0.	O
then	O
etfe	O
=	O
0	O
and	O
so	O
etfse	O
+	O
etfae	O
=	O
0.	O
however	O
,	O
etfae	O
=	O
0	O
,	O
since	O
for	O
any	O
skew-symmetric	O
matrix	O
s	O
,	O
xtsx	O
=	O
0.	O
thus	O
etfse	O
=	O
0.	O
the	O
derivation	B
for	O
e	O
(	O
cid:2	O
)	O
follows	O
in	O
a	O
similar	O
manner	O
.	O
skew-symmetric	B
part	I
.	O
the	O
matrix	B
fa	O
is	O
skew-symmetric	O
and	O
may	O
be	O
written	O
as	O
fa	O
=	O
[	O
xa	O
]	O
×	O
,	O
where	O
xa	O
is	O
the	O
null-vector	O
of	O
fa	O
.	O
the	O
skew-symmetric	B
part	I
has	O
2	O
degrees	B
of	I
freedom	I
and	O
is	O
identiﬁed	O
with	O
the	O
point	B
xa	O
.	O
the	O
relation	B
between	O
the	O
point	B
xa	O
and	O
conic	B
fs	O
is	O
shown	O
in	O
ﬁgure	O
9.10a	O
.	O
the	O
polar	O
of	O
xa	O
intersects	O
the	O
steiner	O
conic	B
fs	O
at	O
the	O
epipoles	B
e	O
and	O
e	O
(	O
cid:2	O
)	O
(	O
the	O
pole–polar	O
relation	O
is	O
described	O
in	O
section	O
2.2.3	O
(	O
p30	O
)	O
)	O
.	O
the	O
proof	O
of	O
this	O
result	O
is	O
left	O
as	O
an	O
exercise	O
.	O
epipolar	B
line	I
correspondence	I
.	O
it	O
is	O
a	O
classical	O
theorem	O
of	O
projective	O
geometry	O
due	O
to	O
steiner	O
[	O
semple-79	O
]	O
that	O
for	O
two	O
line	B
pencils	O
related	O
by	O
a	O
homography	B
,	O
the	O
locus	O
of	O
intersections	O
of	O
corresponding	O
lines	B
is	O
a	O
conic	B
.	O
this	O
is	O
precisely	O
the	O
situation	O
here	O
.	O
the	O
pencils	O
are	O
the	O
epipolar	B
pencils	O
,	O
one	O
through	O
e	O
and	O
the	O
other	O
through	O
e	O
(	O
cid:2	O
)	O
.	O
the	O
epipolar	B
lines	I
are	O
related	O
by	O
a	O
1d	O
homography	B
as	O
described	O
in	O
section	O
9.2.5.	O
the	O
locus	O
of	O
intersection	O
is	O
the	O
conic	B
fs	O
.	O
the	O
conic	B
and	O
epipoles	B
enable	O
epipolar	B
lines	I
to	O
be	O
determined	O
by	O
a	O
geometric	B
con-	O
struction	O
as	O
illustrated	O
in	O
ﬁgure	O
9.10b	O
.	O
this	O
construction	O
is	O
based	O
on	O
the	O
ﬁxed	O
point	O
property	O
of	O
the	O
steiner	O
conic	B
fs	O
.	O
the	O
epipolar	B
line	I
l	O
=	O
x	O
×	O
e	O
in	O
the	O
ﬁrst	O
view	O
deﬁnes	O
an	O
epipolar	B
plane	O
in	O
3-space	O
which	O
intersects	O
the	O
horopter	B
in	O
a	O
point	B
,	O
which	O
we	O
will	O
call	O
xc	O
.	O
the	O
point	B
xc	O
is	O
imaged	O
in	O
the	O
ﬁrst	O
view	O
at	O
xc	O
,	O
which	O
is	O
the	O
point	B
at	O
which	O
l	O
intersects	O
the	O
conic	B
fs	O
(	O
since	O
fs	O
is	O
the	O
image	O
of	O
the	O
horopter	O
)	O
.	O
now	O
the	O
image	O
of	O
xc	O
is	O
also	O
xc	O
in	O
the	O
second	O
view	O
due	O
to	O
the	O
ﬁxed-point	O
property	O
of	O
the	O
horopter	O
.	O
so	O
xc	O
is	O
the	O
252	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
f	O
s	O
e	O
/e	O
l	O
a	O
x	O
a	O
a	O
xc	O
fs	O
/	O
l	O
/	O
e	O
x	O
b	O
e	O
fig	O
.	O
9.10.	O
geometric	B
representation	I
of	O
f.	O
(	O
a	O
)	O
the	O
conic	B
fs	O
represents	O
the	O
symmetric	B
part	I
of	O
f	O
,	O
and	O
the	O
point	B
xa	O
the	O
skew-symmetric	B
part	I
.	O
the	O
conic	B
fs	O
is	O
the	O
locus	O
of	O
intersection	O
of	O
corresponding	O
epipolar	B
lines	I
,	O
assuming	O
both	O
images	O
are	O
overlaid	O
on	O
top	O
of	O
each	O
other	O
.	O
it	O
is	O
the	O
image	O
of	O
the	O
horopter	O
curve	O
.	O
the	O
line	B
la	O
is	O
the	O
polar	O
of	O
xa	O
with	O
respect	O
to	O
the	O
conic	B
fs	O
.	O
it	O
intersects	O
the	O
conic	B
at	O
the	O
epipoles	B
e	O
and	O
e	O
(	O
cid:1	O
)	O
.	O
(	O
b	O
)	O
the	O
epipolar	B
line	I
l	O
(	O
cid:1	O
)	O
corresponding	O
to	O
a	O
point	B
x	O
is	O
constructed	O
as	O
follows	O
:	O
intersect	O
the	O
line	B
deﬁned	O
by	O
the	O
points	O
e	O
and	O
x	O
with	O
the	O
conic	B
.	O
this	O
intersection	B
point	O
is	O
xc	O
.	O
then	O
l	O
(	O
cid:1	O
)	O
is	O
the	O
line	B
deﬁned	O
by	O
the	O
points	O
xc	O
and	O
e	O
(	O
cid:1	O
)	O
.	O
image	O
in	O
the	O
second	O
view	O
of	O
a	O
point	O
on	O
the	O
epipolar	B
plane	O
of	O
x.	O
it	O
follows	O
that	O
xc	O
lies	O
on	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
of	O
x	O
,	O
and	O
consequently	O
l	O
(	O
cid:2	O
)	O
may	O
be	O
computed	O
as	O
l	O
(	O
cid:2	O
)	O
=	O
xc	O
×	O
e	O
(	O
cid:2	O
)	O
.	O
the	O
conic	B
together	O
with	O
two	O
points	O
on	O
the	O
conic	B
account	O
for	O
the	O
7	O
degrees	B
of	I
freedom	I
of	O
f	O
:	O
5	O
degrees	B
of	I
freedom	I
for	O
the	O
conic	B
and	O
one	O
each	O
to	O
specify	O
the	O
two	O
epipoles	O
on	O
the	O
conic	B
.	O
given	O
f	O
,	O
then	O
the	O
conic	B
fs	O
,	O
epipoles	B
e	O
,	O
e	O
(	O
cid:2	O
)	O
and	O
skew-symmetric	O
point	O
xa	O
are	O
deﬁned	O
uniquely	O
.	O
however	O
,	O
fs	O
and	O
xa	O
do	O
not	O
uniquely	O
determine	O
f	O
since	O
the	O
identity	O
of	O
the	O
epipoles	O
is	O
not	O
recovered	O
,	O
i.e	O
.	O
the	O
polar	O
of	O
xa	O
determines	O
the	O
epipoles	B
but	O
does	O
not	O
determine	O
which	O
one	O
is	O
e	O
and	O
which	O
one	O
e	O
(	O
cid:2	O
)	O
.	O
9.4.1	O
pure	O
planar	B
motion	I
we	O
return	O
to	O
the	O
case	O
of	O
planar	O
motion	O
discussed	O
above	O
in	O
section	O
9.3.2	O
,	O
where	O
fs	O
has	O
rank	O
2.	O
it	O
is	O
evident	O
that	O
in	O
this	O
case	O
the	O
steiner	O
conic	B
is	O
degenerate	B
and	O
from	O
section	O
2.2.3	O
(	O
p30	O
)	O
is	O
equivalent	B
to	O
two	O
non-coincident	O
lines	B
:	O
s	O
+	O
lslt	O
fs	O
=	O
lhlt	O
as	O
depicted	O
in	O
ﬁgure	O
9.11a	O
.	O
the	O
geometric	B
construction	O
of	O
the	O
epipolar	O
line	B
l	O
(	O
cid:2	O
)	O
corre-	O
sponding	O
to	O
a	O
point	B
x	O
of	O
section	O
9.4	O
has	O
a	O
simple	O
algebraic	O
representation	B
in	O
this	O
case	O
.	O
as	O
in	O
the	O
general	B
motion	I
case	O
,	O
there	O
are	O
three	O
steps	O
,	O
illustrated	O
in	O
ﬁgure	O
9.11b	O
:	O
ﬁrst	O
the	O
line	B
l	O
=	O
e	O
×	O
x	O
joining	O
e	O
and	O
x	O
is	O
computed	O
;	O
second	O
,	O
its	O
intersection	B
point	O
with	O
the	O
“	O
conic	B
”	O
xc	O
=	O
ls	O
×	O
l	O
is	O
determined	O
;	O
third	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
=	O
e	O
(	O
cid:2	O
)	O
×	O
xc	O
is	O
the	O
join	O
of	O
xc	O
and	O
e	O
(	O
cid:2	O
)	O
.	O
putting	O
these	O
steps	O
together	O
we	O
ﬁnd	O
h	O
l	O
(	O
cid:2	O
)	O
=	O
e	O
(	O
cid:2	O
)	O
×	O
[	O
ls	O
×	O
(	O
e	O
×	O
x	O
)	O
]	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
[	O
ls	O
]	O
×	O
[	O
e	O
]	O
×x	O
.	O
it	O
follows	O
that	O
f	O
may	O
be	O
written	O
as	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
[	O
ls	O
]	O
×	O
[	O
e	O
]	O
×	O
.	O
(	O
9.8	O
)	O
the	O
6	O
degrees	B
of	I
freedom	I
of	O
f	O
are	O
accounted	O
for	O
as	O
2	O
degrees	B
of	I
freedom	I
for	O
each	O
of	O
the	O
two	O
epipoles	B
and	O
2	O
degrees	B
of	I
freedom	I
for	O
the	O
line	B
.	O
9.5	O
retrieving	B
the	I
camera	I
matrices	I
253	O
l	O
s	O
e	O
x	O
s	O
/	O
e	O
l	O
h	O
x	O
a	O
image	O
a	O
x	O
c	O
l	O
x	O
l	O
s	O
l	O
/	O
e	O
e/	O
image	O
b	O
fig	O
.	O
9.11.	O
geometric	B
representation	I
of	O
f	O
for	B
planar	I
motion	I
.	O
(	O
a	O
)	O
the	O
lines	B
ls	O
and	O
lh	O
constitute	O
the	O
steiner	O
conic	B
for	O
this	O
motion	O
,	O
which	O
is	O
degenerate	B
.	O
compare	O
this	O
ﬁgure	O
with	O
the	O
conic	B
for	O
general	O
corresponding	O
to	O
a	O
point	B
x	O
is	O
constructed	O
as	O
motion	O
shown	O
in	O
ﬁgure	O
9.10.	O
follows	O
:	O
intersect	O
the	O
line	B
deﬁned	O
by	O
the	O
points	O
e	O
and	O
x	O
with	O
the	O
(	O
conic	B
)	O
line	B
ls	O
.	O
this	O
intersection	B
point	O
is	O
xc	O
.	O
then	O
l	O
(	O
cid:1	O
)	O
(	O
b	O
)	O
the	O
epipolar	B
line	I
l	O
(	O
cid:1	O
)	O
is	O
the	O
line	B
deﬁned	O
by	O
the	O
points	O
xc	O
and	O
e	O
(	O
cid:1	O
)	O
.	O
the	O
geometry	O
of	O
this	O
situation	O
can	O
be	O
easily	O
visualized	O
:	O
the	O
horopter	B
for	O
this	O
motion	O
is	O
a	O
degenerate	B
twisted	O
cubic	O
consisting	O
of	O
a	O
circle	O
in	O
the	O
plane	B
of	O
the	O
motion	O
(	O
the	O
plane	B
orthogonal	O
to	O
the	O
rotation	B
axis	O
and	O
containing	O
the	O
camera	B
centres	O
)	O
,	O
and	O
a	O
line	B
parallel	O
to	O
the	O
rotation	B
axis	O
and	O
intersecting	O
the	O
circle	O
.	O
the	O
line	B
is	O
the	O
screw	B
axis	I
(	O
see	O
section	O
3.4.1	O
(	O
p77	O
)	O
)	O
.	O
the	O
motion	O
is	O
equivalent	B
to	O
a	O
rotation	B
about	O
the	O
screw	B
axis	I
with	O
zero	O
translation	O
.	O
under	O
this	O
motion	O
points	O
on	O
the	O
screw	B
axis	I
are	O
ﬁxed	O
,	O
and	O
consequently	O
their	O
images	O
are	O
ﬁxed	O
.	O
the	O
line	B
ls	O
is	O
the	O
image	O
of	O
the	O
screw	O
axis	O
.	O
the	O
line	B
lh	O
is	O
the	O
intersection	B
of	O
the	O
image	O
with	O
the	O
plane	B
of	O
the	O
motion	O
.	O
this	O
geometry	O
is	O
used	O
for	O
auto-	O
calibration	B
in	O
chapter	O
19	O
.	O
9.5	O
retrieving	B
the	I
camera	I
matrices	I
to	O
this	O
point	B
we	O
have	O
examined	O
the	O
properties	B
of	O
f	O
and	O
of	O
image	O
relations	O
for	O
a	O
point	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
.	O
we	O
now	O
turn	O
to	O
one	O
of	O
the	O
most	O
signiﬁcant	O
properties	B
of	O
f	O
,	O
that	O
the	O
matrix	B
may	O
be	O
used	O
to	O
determine	O
the	O
camera	B
matrices	I
of	O
the	O
two	B
views	I
.	O
9.5.1	O
projective	O
invariance	O
and	O
canonical	O
cameras	O
it	O
is	O
evident	O
from	O
the	O
derivations	O
of	O
section	O
9.2	O
that	O
the	O
map	O
l	O
(	O
cid:2	O
)	O
=	O
fx	O
and	O
the	O
correspon-	O
dence	O
condition	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
are	O
projective	B
relationships	O
:	O
the	O
derivations	O
have	O
involved	O
only	O
projective	B
geometric	O
relationships	O
,	O
such	O
as	O
the	O
intersection	B
of	O
lines	B
and	O
planes	O
,	O
and	O
in	O
the	O
algebraic	B
development	O
only	O
the	O
linear	B
mapping	O
of	O
the	O
projective	O
camera	B
between	O
world	O
and	O
image	O
points	O
.	O
consequently	O
,	O
the	O
relationships	O
depend	O
only	O
on	O
projective	O
co-	O
ordinates	O
in	O
the	O
image	O
,	O
and	O
not	O
,	O
for	O
example	O
on	O
euclidean	O
measurements	O
such	O
as	O
the	O
angle	B
between	O
rays	O
.	O
in	O
other	O
words	O
the	O
image	O
relationships	O
are	O
projectively	O
invariant	O
:	O
under	O
a	O
projective	B
transformation	I
of	O
the	O
image	O
coordinates	O
ˆx	O
=	O
hx	O
,	O
ˆx	O
(	O
cid:2	O
)	O
,	O
there	O
is	O
a	O
(	O
cid:2	O
)	O
=	O
ˆfˆx	O
with	O
ˆf	O
=	O
h	O
(	O
cid:2	O
)	O
−tfh−1	O
the	O
corresponding	O
rank	O
2	O
fundamental	O
corresponding	O
map	O
ˆl	O
matrix	B
.	O
=	O
h	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
similarly	O
,	O
f	O
only	O
depends	O
on	O
projective	O
properties	B
of	O
the	O
cameras	B
p	O
,	O
p	O
(	O
cid:2	O
)	O
.	O
the	O
camera	B
matrix	I
relates	O
3-space	O
measurements	O
to	O
image	O
measurements	O
and	O
so	O
depends	O
on	O
both	O
the	O
image	O
coordinate	O
frame	O
and	O
the	O
choice	B
of	O
world	O
coordinate	O
frame	O
.	O
f	O
does	O
not	O
254	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
depend	O
on	O
the	O
choice	B
of	O
world	O
frame	O
,	O
for	O
example	O
a	O
rotation	B
of	O
world	O
coordinates	B
changes	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
,	O
but	O
not	O
f.	O
in	O
fact	O
,	O
the	O
fundamental	B
matrix	I
is	O
unchanged	O
by	O
a	O
projective	B
transformation	I
of	O
3-space	O
.	O
more	O
precisely	O
,	O
result	O
9.8.	O
if	O
h	O
is	O
a	O
4	O
×	O
4	O
matrix	B
representing	O
a	O
projective	B
transformation	I
of	O
3-space	O
,	O
then	O
the	O
fundamental	O
matrices	O
corresponding	O
to	O
the	O
pairs	O
of	B
camera	I
matrices	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
and	O
(	O
ph	O
,	O
p	O
(	O
cid:2	O
)	O
h	O
)	O
are	O
the	O
same	O
.	O
proof	O
.	O
observe	O
that	O
px	O
=	O
(	O
ph	O
)	O
(	O
h−1x	O
)	O
,	O
and	O
similarly	O
for	O
p	O
(	O
cid:2	O
)	O
are	O
matched	O
points	O
with	O
respect	O
to	O
the	O
pair	O
of	O
cameras	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
,	O
corresponding	O
to	O
a	O
3d	O
point	B
x	O
,	O
then	O
they	O
are	O
also	O
matched	O
points	O
with	O
respect	O
to	O
the	O
pair	O
of	O
cameras	O
(	O
ph	O
,	O
p	O
(	O
cid:2	O
)	O
h	O
)	O
,	O
corresponding	O
to	O
the	O
point	B
h−1x	O
.	O
thus	O
,	O
although	O
from	O
(	O
9.1–p244	O
)	O
a	O
pair	O
of	B
camera	I
matrices	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
uniquely	O
determine	O
a	O
fundamental	B
matrix	I
f	O
,	O
the	O
converse	O
is	O
not	O
true	O
.	O
the	O
fundamental	B
matrix	I
determines	O
the	O
pair	O
of	B
camera	I
matrices	O
at	O
best	O
up	O
to	O
right-multiplication	O
by	O
a	O
3d	O
projective	B
transfor-	O
mation	O
.	O
it	O
will	O
be	O
seen	O
below	O
that	O
this	O
is	O
the	O
full	O
extent	O
of	O
the	O
ambiguity	O
,	O
and	O
indeed	O
the	O
camera	B
matrices	I
are	O
determined	O
up	O
to	O
a	O
projective	B
transformation	I
by	O
the	O
fundamental	B
matrix	I
.	O
.	O
thus	O
if	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
canonical	B
form	I
of	O
camera	B
matrices	I
.	O
given	O
this	O
ambiguity	B
,	O
it	O
is	O
common	O
to	O
deﬁne	O
a	O
speciﬁc	O
canonical	B
form	I
for	O
the	O
pair	O
of	B
camera	I
matrices	O
corresponding	O
to	O
a	O
given	O
fundamental	B
matrix	I
in	O
which	O
the	O
ﬁrst	O
matrix	B
is	O
of	O
the	O
simple	O
form	O
[	O
i	O
|	O
0	O
]	O
,	O
where	O
i	O
is	O
the	O
3	O
×	O
3	O
identity	O
matrix	B
and	O
0	O
a	O
null	O
3-vector	O
.	O
to	O
see	O
that	O
this	O
is	O
always	O
possible	O
,	O
let	O
p	O
be	O
augmented	O
by	O
one	O
row	O
to	O
make	O
a	O
4	O
×	O
4	O
non-singular	O
matrix	B
,	O
denoted	O
p∗	O
.	O
now	O
letting	O
h	O
=	O
p∗−1	O
,	O
one	O
veriﬁes	O
that	O
ph	O
=	O
[	O
i	O
|	O
0	O
]	O
as	O
desired	O
.	O
the	O
following	O
result	O
is	O
very	O
frequently	O
used	O
result	O
9.9.	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
a	O
pair	O
of	B
camera	I
matrices	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
this	O
is	O
easily	O
derived	O
as	O
a	O
special	O
case	O
of	O
(	O
9.1–p244	O
)	O
.	O
=	O
[	O
m	O
|	O
m	O
]	O
is	O
equal	O
to	O
[	O
m	O
]	O
×m	O
.	O
9.5.2	O
projective	B
ambiguity	I
of	O
cameras	B
given	O
f	O
it	O
has	O
been	O
seen	O
that	O
a	O
pair	O
of	B
camera	I
matrices	O
determines	O
a	O
unique	O
fundamental	B
matrix	I
.	O
this	O
mapping	O
is	O
not	O
injective	O
(	O
one-to-one	O
)	O
however	O
,	O
since	O
pairs	O
of	B
camera	I
matrices	O
that	O
differ	O
by	O
a	O
projective	B
transformation	I
give	O
rise	O
to	O
the	O
same	O
fundamental	O
matrix	B
.	O
it	O
will	O
now	O
be	O
shown	O
that	O
this	O
is	O
the	O
only	O
ambiguity	B
.	O
we	O
will	O
show	O
that	O
a	O
given	O
fundamental	B
matrix	I
determines	O
the	O
pair	O
of	B
camera	I
matrices	O
up	O
to	O
right	O
multiplication	O
by	O
a	O
projective	B
transformation	I
.	O
thus	O
,	O
the	O
fundamental	B
matrix	I
captures	O
the	O
projective	B
relationship	O
of	O
the	O
two	O
cameras	B
.	O
theorem	O
9.10.	O
let	O
f	O
be	O
a	O
fundamental	B
matrix	I
and	O
let	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
be	O
two	O
pairs	O
of	B
camera	I
matrices	O
such	O
that	O
f	O
is	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
each	O
of	O
these	O
pairs	O
.	O
then	O
there	O
exists	O
a	O
non-singular	O
4	O
×	O
4	O
matrix	B
h	O
such	O
that	O
˜p	O
=	O
ph	O
and	O
˜p	O
=	O
p	O
(	O
cid:2	O
)	O
h.	O
)	O
and	O
(	O
˜p	O
,	O
˜p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
9.5	O
retrieving	B
the	I
camera	I
matrices	I
255	O
(	O
cid:2	O
)	O
)	O
and	O
(	O
˜p	O
,	O
˜p	O
proof	O
.	O
suppose	O
that	O
a	O
given	O
fundamental	B
matrix	I
f	O
corresponds	O
to	O
two	O
different	O
pairs	O
of	B
camera	I
matrices	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
.	O
as	O
a	O
ﬁrst	O
step	O
,	O
we	O
may	O
simplify	O
the	O
problem	O
by	O
assuming	O
that	O
each	O
of	O
the	O
two	O
pair	O
of	B
camera	I
matrices	O
is	O
in	O
canonical	O
form	O
with	O
p	O
=	O
˜p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
since	O
this	O
may	O
be	O
done	O
by	O
applying	O
projective	B
transformations	O
to	O
each	O
pair	O
as	O
necessary	O
.	O
thus	O
,	O
suppose	O
that	O
p	O
=	O
˜p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
that	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
a	O
|	O
a	O
]	O
=	O
[	O
˜a	O
|	O
˜a	O
]	O
.	O
according	O
to	O
result	O
9.9	O
the	O
fundamental	B
matrix	I
may	O
then	O
be	O
written	O
and	O
˜p	O
f	O
=	O
[	O
a	O
]	O
×a	O
=	O
[	O
˜a	O
]	O
×˜a	O
.	O
we	O
will	O
need	O
the	O
following	O
lemma	O
:	O
(	O
cid:2	O
)	O
lemma	O
9.11.	O
suppose	O
the	O
rank	O
2	O
matrix	B
f	O
can	O
be	O
decomposed	O
in	O
two	O
different	O
ways	O
−1	O
(	O
a	O
+	O
avt	O
)	O
for	O
some	O
non-zero	O
as	O
f	O
=	O
[	O
a	O
]	O
×a	O
and	O
f	O
=	O
[	O
˜a	O
]	O
×˜a	O
;	O
then	O
˜a	O
=	O
ka	O
and	O
˜a	O
=	O
k	O
constant	O
k	O
and	O
3-vector	O
v.	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
k˜a	O
−	O
a	O
=	O
0	O
,	O
and	O
so	O
k˜a	O
−	O
a	O
=	O
avt	O
for	O
some	O
v.	O
hence	O
,	O
˜a	O
=	O
k	O
proof	O
.	O
first	O
,	O
note	O
that	O
atf	O
=	O
at	O
[	O
a	O
]	O
×a	O
=	O
0	O
,	O
and	O
similarly	O
,	O
˜atf	O
=	O
0.	O
since	O
f	O
has	O
rank	O
2	O
,	O
it	O
follows	O
that	O
˜a	O
=	O
ka	O
as	O
required	O
.	O
next	O
,	O
from	O
[	O
a	O
]	O
×a	O
=	O
[	O
˜a	O
]	O
×˜a	O
it	O
follows	O
that	O
−1	O
(	O
a	O
+	O
avt	O
)	O
as	O
[	O
a	O
]	O
×	O
required	O
.	O
=	O
[	O
a	O
|	O
a	O
]	O
and	O
applying	O
this	O
result	O
to	O
the	O
two	O
camera	O
matrices	O
p	O
(	O
cid:2	O
)	O
shows	O
that	O
p	O
(	O
cid:2	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:2	O
)	O
−1	O
(	O
a+avt	O
)	O
|	O
ka	O
]	O
if	O
they	O
are	O
to	O
generate	O
the	O
same	O
f.	O
it	O
only	O
remains	O
now	O
to	O
show	O
˜p	O
.	O
that	O
these	O
camera	B
pairs	O
are	O
projectively	O
related	O
.	O
let	O
h	O
be	O
the	O
matrix	B
h	O
=	O
(	O
cid:2	O
)	O
and	O
˜p	O
=	O
[	O
k	O
−1i	O
0	O
k	O
−1vt	O
k	O
k	O
then	O
one	O
veriﬁes	O
that	O
ph	O
=	O
k	O
−1	O
[	O
i	O
|	O
0	O
]	O
=	O
k	O
−1˜p	O
,	O
and	O
furthermore	O
,	O
p	O
(	O
cid:2	O
)	O
h	O
=	O
[	O
a	O
|	O
a	O
]	O
h	O
=	O
[	O
k	O
−1	O
(	O
a	O
+	O
avt	O
)	O
|	O
ka	O
]	O
=	O
[	O
˜a	O
|	O
˜a	O
]	O
=	O
˜p	O
(	O
cid:2	O
)	O
so	O
that	O
the	O
pairs	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
and	O
˜p	O
,	O
˜p	O
(	O
cid:2	O
)	O
are	O
indeed	O
projectively	O
related	O
.	O
this	O
can	O
be	O
tied	O
precisely	O
to	O
a	O
counting	B
argument	I
:	O
the	O
two	O
cameras	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
each	O
have	O
11	O
degrees	B
of	I
freedom	I
,	O
making	O
a	O
total	O
of	O
22	O
degrees	B
of	I
freedom	I
.	O
to	O
specify	O
a	O
projective	B
world	O
frame	O
requires	O
15	O
degrees	B
of	I
freedom	I
(	O
section	O
3.1	O
(	O
p65	O
)	O
)	O
,	O
so	O
once	O
the	O
degrees	B
of	I
freedom	I
of	O
the	O
world	O
frame	O
are	O
removed	O
from	O
the	O
two	O
cameras	O
22−	O
15	O
=	O
7	O
degrees	B
of	I
freedom	I
remain	O
–	O
which	O
corresponds	O
to	O
the	O
7	O
degrees	B
of	I
freedom	I
of	O
the	O
fundamental	B
matrix	I
.	O
9.5.3	O
canonical	O
cameras	O
given	O
f	O
we	O
have	O
shown	O
that	O
f	O
determines	O
the	O
camera	B
pair	O
up	O
to	O
a	O
projective	B
transformation	I
of	O
3-space	O
.	O
we	O
will	O
now	O
derive	O
a	O
speciﬁc	O
formula	O
for	O
a	O
pair	O
of	O
cameras	O
with	O
canonical	O
form	O
given	O
f.	O
we	O
will	O
make	O
use	O
of	O
the	O
following	O
characterization	O
of	O
the	O
fundamental	O
matrix	B
f	O
corresponding	O
to	O
a	O
pair	O
of	B
camera	I
matrices	O
:	O
if	O
and	O
only	O
if	O
p	O
(	O
cid:2	O
)	O
tfp	O
is	O
skew-symmetric	O
.	O
result	O
9.12.	O
a	O
non-zero	O
matrix	O
f	O
is	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
a	O
pair	O
of	B
camera	I
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
proof	O
.	O
the	O
condition	O
that	O
p	O
(	O
cid:2	O
)	O
tfp	O
is	O
skew-symmetric	O
is	O
equivalent	B
to	O
xtp	O
(	O
cid:2	O
)	O
tfpx	O
=	O
0	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
and	O
x	O
=	O
px	O
,	O
this	O
is	O
equivalent	B
to	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
,	O
which	O
is	O
the	O
for	O
all	O
x.	O
setting	O
x	O
(	O
cid:2	O
)	O
deﬁning	O
equation	O
for	O
the	O
fundamental	B
matrix	I
.	O
256	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
one	O
may	O
write	O
down	O
a	O
particular	O
solution	B
for	O
the	O
pairs	O
of	B
camera	I
matrices	O
in	O
canon-	O
ical	O
form	O
that	O
correspond	O
to	O
a	O
fundamental	B
matrix	I
as	O
follows	O
:	O
result	O
9.13.	O
let	O
f	O
be	O
a	O
fundamental	B
matrix	I
and	O
s	O
any	O
skew-symmetric	O
matrix	O
.	O
deﬁne	O
the	O
pair	O
of	B
camera	I
matrices	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
sf	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
,	O
is	O
the	O
epipole	O
such	O
that	O
e	O
(	O
cid:2	O
)	O
tf	O
=	O
0	O
,	O
and	O
assume	O
that	O
p	O
(	O
cid:2	O
)	O
where	O
e	O
(	O
cid:2	O
)	O
so	O
deﬁned	O
is	O
a	O
valid	O
camera	B
matrix	I
(	O
has	O
rank	O
3	O
)	O
.	O
then	O
f	O
is	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
the	O
pair	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
.	O
to	O
demonstrate	O
this	O
,	O
we	O
invoke	O
result	O
9.12	O
and	O
simply	O
verify	O
that	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
[	O
sf	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
tf	O
[	O
i	O
|	O
0	O
]	O
=	O
ftstf	O
0	O
e	O
(	O
cid:2	O
)	O
tf	O
0	O
=	O
ftstf	O
0	O
0	O
0t	O
(	O
cid:18	O
)	O
(	O
9.9	O
)	O
which	O
is	O
skew-symmetric	O
.	O
the	O
skew-symmetric	O
matrix	O
s	O
may	O
be	O
written	O
in	O
terms	O
of	O
its	O
null-vector	O
as	O
s	O
=	O
[	O
s	O
]	O
×	O
.	O
then	O
[	O
[	O
s	O
]	O
×f	O
|	O
e	O
(	O
cid:2	O
)	O
(	O
cid:5	O
)	O
=	O
0	O
,	O
according	O
to	O
the	O
following	O
argument.	O
]	O
has	O
rank	O
3	O
provided	O
ste	O
(	O
cid:2	O
)	O
since	O
e	O
(	O
cid:2	O
)	O
f	O
=	O
0	O
,	O
the	O
column	O
space	O
(	O
span	O
of	O
the	O
columns	O
)	O
of	O
f	O
is	O
perpendicular	O
to	O
e	O
(	O
cid:2	O
)	O
.	O
but	O
if	O
ste	O
(	O
cid:2	O
)	O
(	O
cid:5	O
)	O
=	O
0	O
,	O
then	O
s	O
is	O
not	O
perpendicular	O
to	O
e	O
(	O
cid:2	O
)	O
,	O
and	O
hence	O
not	O
in	O
the	O
column	O
space	O
of	O
f.	O
now	O
,	O
the	O
column	O
space	O
of	O
[	O
s	O
]	O
×f	O
is	O
spanned	O
by	O
the	O
cross-products	O
of	O
s	O
with	O
the	O
columns	O
of	O
f	O
,	O
and	O
therefore	O
equals	O
the	O
plane	B
perpendicular	O
to	O
s.	O
so	O
[	O
s	O
]	O
×f	O
has	O
rank	O
2.	O
since	O
e	O
(	O
cid:2	O
)	O
is	O
not	O
perpendicular	O
to	O
s	O
,	O
it	O
does	O
not	O
lie	O
in	O
this	O
plane	B
,	O
and	O
so	O
[	O
[	O
s	O
]	O
×f	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
has	O
rank	O
3	O
,	O
as	O
required	O
.	O
as	O
suggested	O
by	O
luong	O
and	O
vi´eville	O
[	O
luong-96	O
]	O
a	O
good	O
choice	B
for	O
s	O
is	O
s	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
in	O
this	O
case	O
e	O
(	O
cid:2	O
)	O
te	O
(	O
cid:2	O
)	O
(	O
cid:5	O
)	O
=	O
0	O
,	O
which	O
leads	O
to	O
the	O
following	O
useful	O
result	O
.	O
]	O
×	O
,	O
for	O
]	O
.	O
=	O
[	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×f	O
|	O
e	O
(	O
cid:2	O
)	O
has	O
left	O
3	O
×	O
3	O
submatrix	O
[	O
e	O
(	O
cid:2	O
)	O
result	O
9.14.	O
the	O
camera	B
matrices	I
corresponding	O
to	O
a	O
fundamental	B
matrix	I
f	O
may	O
be	O
chosen	O
as	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
note	O
that	O
the	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
]	O
×f	O
which	O
has	O
rank	O
2.	O
this	O
corresponds	O
to	O
a	O
camera	B
with	O
centre	B
on	O
π∞	O
.	O
however	O
,	O
there	O
is	O
no	O
particular	O
reason	O
to	O
avoid	O
this	O
situation	O
.	O
the	O
proof	O
of	O
theorem	O
9.10	O
shows	O
that	O
the	O
four	O
parameter	O
family	O
of	B
camera	I
pairs	O
in	O
canonical	O
form	O
˜p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
˜p	O
=	O
[	O
a	O
+	O
avt	O
|	O
ka	O
]	O
have	O
the	O
same	O
fundamental	O
matrix	B
as	O
the	O
canonical	O
pair	O
,	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
a	O
|	O
a	O
]	O
;	O
and	O
that	O
this	O
is	O
the	O
most	O
general	O
solution	O
.	O
to	O
summarize	O
:	O
(	O
cid:2	O
)	O
result	O
9.15.	O
the	O
general	O
formula	O
for	O
a	O
pair	O
of	O
canonic	O
camera	B
matrices	I
corresponding	O
to	O
a	O
fundamental	B
matrix	I
f	O
is	O
given	O
by	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
p	O
(	O
cid:2	O
)	O
]	O
×f	O
+	O
e	O
(	O
cid:2	O
)	O
vt	O
|	O
λe	O
(	O
cid:2	O
)	O
=	O
[	O
[	O
e	O
(	O
cid:2	O
)	O
(	O
9.10	O
)	O
]	O
where	O
v	O
is	O
any	O
3-vector	O
,	O
and	O
λ	O
a	O
non-zero	O
scalar	O
.	O
9.6	O
the	O
essential	B
matrix	I
9.6	O
the	O
essential	B
matrix	I
257	O
the	O
essential	B
matrix	I
is	O
the	O
specialization	O
of	O
the	O
fundamental	O
matrix	B
to	O
the	O
case	O
of	O
normalized	O
image	O
coordinates	O
(	O
see	O
below	O
)	O
.	O
historically	O
,	O
the	O
essential	B
matrix	I
was	O
in-	O
troduced	O
(	O
by	O
longuet-higgins	O
)	O
before	O
the	O
fundamental	B
matrix	I
,	O
and	O
the	O
fundamental	B
matrix	I
may	O
be	O
thought	O
of	O
as	O
the	O
generalization	O
of	O
the	O
essential	O
matrix	B
in	O
which	O
the	O
(	O
inessential	O
)	O
assumption	O
of	O
calibrated	O
cameras	B
is	O
removed	O
.	O
the	O
essential	B
matrix	I
has	O
fewer	O
degrees	B
of	I
freedom	I
,	O
and	O
additional	O
properties	B
,	O
compared	O
to	O
the	O
fundamental	O
ma-	O
trix	O
.	O
these	O
properties	B
are	O
described	O
below	O
.	O
normalized	B
coordinates	I
.	O
consider	O
a	O
camera	B
matrix	I
decomposed	O
as	O
p	O
=	O
k	O
[	O
r	O
|	O
t	O
]	O
,	O
and	O
let	O
x	O
=	O
px	O
be	O
a	O
point	B
in	O
the	O
image	O
.	O
if	O
the	O
calibration	B
matrix	I
k	O
is	O
known	O
,	O
then	O
we	O
may	O
apply	O
its	O
inverse	O
to	O
the	O
point	B
x	O
to	O
obtain	O
the	O
point	B
ˆx	O
=	O
k−1x	O
.	O
then	O
ˆx	O
=	O
[	O
r	O
|	O
t	O
]	O
x	O
,	O
where	O
ˆx	O
is	O
the	O
image	O
point	O
expressed	O
in	O
normalized	O
coordinates	B
.	O
it	O
may	O
be	O
thought	O
of	O
as	O
the	O
image	O
of	O
the	O
point	O
x	O
with	O
respect	O
to	O
a	O
camera	B
[	O
r	O
|	O
t	O
]	O
having	O
the	O
identity	O
matrix	B
i	O
as	O
calibration	O
matrix	B
.	O
the	O
camera	B
matrix	I
k−1p	O
=	O
[	O
r	O
|	O
t	O
]	O
is	O
called	O
a	O
normalized	O
camera	O
matrix	B
,	O
the	O
effect	O
of	O
the	O
known	O
calibration	B
matrix	I
having	O
been	O
removed	O
.	O
now	O
,	O
consider	O
a	O
pair	O
of	O
normalized	O
camera	B
matrices	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
r	O
|	O
t	O
]	O
.	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
the	O
pair	O
of	O
normalized	O
cameras	B
is	O
customarily	O
called	O
the	O
essential	B
matrix	I
,	O
and	O
according	O
to	O
(	O
9.2–p244	O
)	O
it	O
has	O
the	O
form	O
e	O
=	O
[	O
t	O
]	O
×r	O
=	O
r	O
[	O
rtt	O
]	O
×	O
.	O
deﬁnition	B
9.16.	O
the	O
deﬁning	O
equation	O
for	O
the	O
essential	B
matrix	I
is	O
ˆx	O
(	O
cid:2	O
)	O
teˆx	O
=	O
0	O
(	O
9.11	O
)	O
in	O
terms	O
of	O
the	O
normalized	O
image	O
coordinates	O
for	O
corresponding	O
points	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
substituting	O
for	O
ˆx	O
and	O
ˆx	O
(	O
cid:2	O
)	O
gives	O
x	O
(	O
cid:2	O
)	O
tk	O
(	O
cid:2	O
)	O
−tek−1x	O
=	O
0.	O
comparing	O
this	O
with	O
the	O
relation	B
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
for	O
the	O
fundamental	B
matrix	I
,	O
it	O
follows	O
that	O
the	O
relationship	O
between	O
the	O
fundamental	O
and	O
essential	O
matrices	O
is	O
.	O
e	O
=	O
k	O
(	O
cid:2	O
)	O
tfk	O
.	O
(	O
9.12	O
)	O
9.6.1	O
properties	B
of	O
the	O
essential	B
matrix	I
the	O
essential	B
matrix	I
,	O
e	O
=	O
[	O
t	O
]	O
×r	O
,	O
has	O
only	O
ﬁve	O
degrees	B
of	I
freedom	I
:	O
both	O
the	O
rotation	B
matrix	O
r	O
and	O
the	O
translation	O
t	O
have	O
three	O
degrees	B
of	I
freedom	I
,	O
but	O
there	O
is	O
an	O
overall	O
scale	O
ambiguity	B
–	O
like	O
the	O
fundamental	B
matrix	I
,	O
the	O
essential	B
matrix	I
is	O
a	O
homogeneous	O
quantity	O
.	O
the	O
reduced	B
number	O
of	O
degrees	O
of	O
freedom	O
translates	O
into	O
extra	O
constraints	B
that	O
are	O
satisﬁed	O
by	O
an	O
essential	B
matrix	I
,	O
compared	O
with	O
a	O
fundamental	B
matrix	I
.	O
we	O
investigate	O
what	O
these	O
constraints	B
are	O
.	O
result	O
9.17.	O
a	O
3×3	O
matrix	B
is	O
an	O
essential	B
matrix	I
if	O
and	O
only	O
if	O
two	O
of	O
its	O
singular	B
values	I
are	O
equal	O
,	O
and	O
the	O
third	O
is	O
zero	O
.	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
258	O
proof	O
.	O
this	O
is	O
easily	O
deduced	O
from	O
the	O
decomposition	B
of	I
e	O
as	O
[	O
t	O
]	O
×r	O
=	O
sr	O
,	O
where	O
s	O
is	O
skew-symmetric	O
.	O
we	O
will	O
use	O
the	O
matrices	O
	O
0	O
−1	O
0	O
	O
and	O
z	O
=	O
	O
0	O
w	O
=	O
1	O
0	O
0	O
0	O
0	O
1	O
	O
.	O
1	O
0	O
−1	O
0	O
0	O
0	O
0	O
0	O
(	O
9.13	O
)	O
it	O
may	O
be	O
veriﬁed	O
that	O
w	O
is	O
orthogonal	B
and	O
z	O
is	O
skew-symmetric	O
.	O
from	O
result	O
a4.1-	O
(	O
p581	O
)	O
,	O
which	O
gives	O
a	O
block	O
decomposition	B
of	I
a	O
general	O
skew-symmetric	O
matrix	B
,	O
the	O
3	O
×	O
3	O
skew-symmetric	O
matrix	O
s	O
may	O
be	O
written	O
as	O
s	O
=	O
kuzut	O
where	O
u	O
is	O
orthogonal	B
.	O
noting	O
that	O
,	O
up	O
to	O
sign	O
,	O
z	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
w	O
,	O
then	O
up	O
to	O
scale	O
,	O
s	O
=	O
u	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
wut	O
,	O
and	O
e	O
=	O
sr	O
=	O
u	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
(	O
wutr	O
)	O
.	O
this	O
is	O
a	O
singular	O
value	O
decomposition	B
of	I
e	O
with	O
two	O
equal	O
singular	B
values	I
,	O
as	O
required	O
.	O
conversely	O
,	O
a	O
matrix	B
with	O
two	O
equal	O
singular	B
values	I
may	O
be	O
factored	O
as	O
sr	O
in	O
this	O
way	O
.	O
since	O
e	O
=	O
u	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
vt	O
,	O
it	O
may	O
seem	O
that	O
e	O
has	O
six	O
degrees	B
of	I
freedom	I
and	O
not	O
ﬁve	O
,	O
since	O
both	O
u	O
and	O
v	O
have	O
three	O
degrees	B
of	I
freedom	I
.	O
however	O
,	O
be-	O
cause	O
the	O
two	O
singular	O
values	O
are	O
equal	O
,	O
the	O
svd	O
is	O
not	O
unique	O
–	O
in	O
fact	O
there	O
is	O
a	O
one-parameter	O
family	O
of	O
svds	O
for	O
e.	O
indeed	O
,	O
an	O
alternative	O
svd	O
is	O
given	O
by	O
e	O
=	O
(	O
u	O
diag	O
(	O
r2×2	O
,	O
1	O
)	O
)	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
(	O
diag	O
(	O
rt	O
2×2	O
,	O
1	O
)	O
)	O
vt	O
for	O
any	O
2	O
×	O
2	O
rotation	B
matrix	O
r.	O
9.6.2	O
extraction	B
of	I
cameras	I
from	I
the	O
essential	B
matrix	I
the	O
essential	B
matrix	I
may	O
be	O
computed	O
directly	O
from	O
(	O
9.11	O
)	O
using	O
normalized	O
image	O
coordinates	O
,	O
or	O
else	O
computed	O
from	O
the	O
fundamental	B
matrix	I
using	O
(	O
9.12	O
)	O
.	O
(	O
methods	O
of	O
computing	O
the	O
fundamental	B
matrix	I
are	O
deferred	O
to	O
chapter	O
11	O
)	O
.	O
once	O
the	O
essential	B
matrix	I
is	O
known	O
,	O
the	O
camera	B
matrices	I
may	O
be	O
retrieved	O
from	O
e	O
as	O
will	O
be	O
described	O
next	O
.	O
in	O
contrast	O
with	O
the	O
fundamental	B
matrix	I
case	O
,	O
where	O
there	O
is	O
a	O
projective	B
ambiguity	I
,	O
the	O
camera	B
matrices	I
may	O
be	O
retrieved	O
from	O
the	O
essential	B
matrix	I
up	O
to	O
scale	O
and	O
a	O
four-fold	O
ambiguity	B
.	O
that	O
is	O
there	O
are	O
four	O
possible	O
solutions	O
,	O
except	O
for	O
overall	O
scale	O
,	O
which	O
can	O
not	O
be	O
determined	O
.	O
we	O
may	O
assume	O
that	O
the	O
ﬁrst	O
camera	B
matrix	I
is	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
.	O
in	O
order	O
to	O
compute	O
the	O
second	O
camera	B
matrix	I
,	O
p	O
(	O
cid:2	O
)	O
,	O
it	O
is	O
necessary	O
to	O
factor	O
e	O
into	O
the	O
product	O
sr	O
of	O
a	O
skew-	O
symmetric	B
matrix	O
and	O
a	O
rotation	B
matrix	O
.	O
result	O
9.18.	O
suppose	O
that	O
the	O
svd	O
of	O
e	O
is	O
u	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
vt.	O
using	O
the	O
notation	O
of	O
(	O
9.13	O
)	O
,	O
there	O
are	O
(	O
ignoring	O
signs	O
)	O
two	O
possible	O
factorizations	O
e	O
=	O
sr	O
as	O
follows	O
:	O
s	O
=	O
uzut	O
r	O
=	O
uwvt	O
or	O
uwtvt	O
.	O
(	O
9.14	O
)	O
proof	O
.	O
that	O
the	O
given	O
factorization	B
is	O
valid	O
is	O
true	O
by	O
inspection	O
.	O
that	O
there	O
are	O
no	O
other	O
factorizations	O
is	O
shown	O
as	O
follows	O
.	O
suppose	O
e	O
=	O
sr.	O
the	O
form	B
of	I
s	O
is	O
determined	O
by	O
the	O
fact	O
that	O
its	O
left	O
null-space	B
is	O
the	O
same	O
as	O
that	O
of	O
e.	O
hence	O
s	O
=	O
uzut	O
.	O
the	O
rotation	B
r	O
may	O
be	O
written	O
as	O
uxvt	O
,	O
where	O
x	O
is	O
some	O
rotation	B
matrix	O
.	O
then	O
u	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
vt	O
=	O
e	O
=	O
sr	O
=	O
(	O
uzut	O
)	O
(	O
uxvt	O
)	O
=	O
u	O
(	O
zx	O
)	O
vt	O
from	O
which	O
one	O
deduces	O
that	O
zx	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
.	O
since	O
x	O
is	O
a	O
rotation	B
matrix	O
,	O
it	O
follows	O
that	O
x	O
=	O
w	O
or	O
x	O
=	O
wt	O
,	O
as	O
required	O
.	O
9.7	O
closure	O
259	O
√	O
the	O
factorization	B
(	O
9.14	O
)	O
determines	O
the	O
t	O
part	O
of	O
the	O
camera	O
matrix	B
p	O
(	O
cid:2	O
)	O
,	O
up	O
to	O
scale	O
,	O
from	O
s	O
=	O
[	O
t	O
]	O
×	O
.	O
however	O
,	O
the	O
frobenius	O
norm	B
of	O
s	O
=	O
uzut	O
is	O
2	O
,	O
which	O
means	O
that	O
if	O
s	O
=	O
[	O
t	O
]	O
×	O
including	O
scale	O
then	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
which	O
is	O
a	O
convenient	O
normaliza-	O
tion	O
for	O
the	O
baseline	O
of	O
the	O
two	O
camera	B
matrices	I
.	O
since	O
st	O
=	O
0	O
,	O
it	O
follows	O
that	O
t	O
=	O
u	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
=	O
u3	O
,	O
the	O
last	O
column	O
of	O
u.	O
however	O
,	O
the	O
sign	O
of	O
e	O
,	O
and	O
consequently	O
t	O
,	O
can	O
not	O
be	O
determined	O
.	O
thus	O
,	O
corresponding	O
to	O
a	O
given	O
essential	B
matrix	I
,	O
there	O
are	O
four	O
possible	O
choices	O
of	O
the	O
camera	O
matrix	B
p	O
(	O
cid:2	O
)	O
,	O
based	O
on	O
the	O
two	O
possible	O
choices	O
of	O
r	O
and	O
two	O
possible	O
signs	O
of	O
t.	O
to	O
summarize	O
:	O
result	O
9.19.	O
for	O
a	O
given	O
essential	B
matrix	I
e	O
=	O
u	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
vt	O
,	O
and	O
ﬁrst	O
camera	B
matrix	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
there	O
are	O
four	O
possible	O
choices	O
for	O
the	O
second	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
,	O
namely	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
uwvt	O
|	O
+u3	O
]	O
or	O
[	O
uwvt	O
|	O
−u3	O
]	O
or	O
[	O
uwtvt	O
|	O
+u3	O
]	O
or	O
[	O
uwtvt	O
|	O
−u3	O
]	O
.	O
9.6.3	O
geometrical	O
interpretation	O
of	O
the	O
four	O
solutions	O
it	O
is	O
clear	O
that	O
the	O
difference	O
between	O
the	O
ﬁrst	O
two	O
solutions	O
is	O
simply	O
that	O
the	O
direction	O
of	O
the	O
translation	O
vector	O
from	O
the	O
ﬁrst	O
to	O
the	O
second	O
camera	B
is	O
reversed	O
.	O
the	O
relationship	O
of	O
the	O
ﬁrst	O
and	O
third	O
solutions	O
in	O
result	O
9.19	O
is	O
a	O
little	O
more	O
compli-	O
cated	O
.	O
however	O
,	O
it	O
may	O
be	O
veriﬁed	O
that	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
[	O
uwtvt	O
|	O
u3	O
]	O
=	O
[	O
uwvt	O
|	O
u3	O
]	O
vwtwtvt	O
1	O
and	O
vwtwtvt	O
=	O
v	O
diag	O
(	O
−1	O
,	O
−1	O
,	O
1	O
)	O
vt	O
is	O
a	O
rotation	B
through	O
180	O
◦	O
about	O
the	O
line	B
joining	O
the	O
two	O
camera	O
centres	O
.	O
two	O
solutions	O
related	O
in	O
this	O
way	O
are	O
known	O
as	O
a	O
“	O
twisted	B
pair	I
”	O
.	O
the	O
four	B
solutions	I
are	O
illustrated	O
in	O
ﬁgure	O
9.12	O
,	O
where	O
it	O
is	O
shown	O
that	O
a	O
reconstructed	O
point	B
x	O
will	O
be	O
in	O
front	O
of	O
both	O
cameras	B
in	O
one	O
of	O
these	O
four	B
solutions	I
only	O
.	O
thus	O
,	O
testing	O
with	O
a	O
single	O
point	O
to	O
determine	O
if	O
it	O
is	O
in	O
front	O
of	O
both	O
cameras	B
is	O
sufﬁcient	O
to	O
decide	O
between	O
the	O
four	O
different	O
solutions	O
for	O
the	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
note	O
.	O
the	O
point	B
of	O
view	O
has	O
been	O
taken	O
here	O
that	O
the	O
essential	B
matrix	I
is	O
a	O
homogeneous	O
quantity	O
.	O
an	O
alternative	O
point	B
of	O
view	O
is	O
that	O
the	O
essential	B
matrix	I
is	O
deﬁned	O
exactly	O
by	O
the	O
equation	O
e	O
=	O
[	O
t	O
]	O
×r	O
,	O
(	O
i.e	O
.	O
including	O
scale	O
)	O
,	O
and	O
is	O
determined	O
only	O
up	O
to	O
indetermi-	O
nate	O
scale	O
by	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
tex	O
=	O
0.	O
the	O
choice	B
of	O
point	B
of	O
view	O
depends	O
on	O
which	O
of	O
these	O
two	O
equations	O
one	O
regards	O
as	O
the	O
deﬁning	O
property	O
of	O
the	O
essential	O
matrix	B
.	O
.	O
9.7	O
closure	O
9.7.1	O
the	O
literature	O
the	O
essential	B
matrix	I
was	O
introduced	O
to	O
the	O
computer	O
vision	O
community	O
by	O
longuet-	O
higgins	O
[	O
longuethiggins-81	O
]	O
,	O
with	O
a	O
matrix	B
analogous	O
to	O
e	O
appearing	O
in	O
the	O
pho-	O
togrammetry	O
literature	O
,	O
e.g	O
.	O
[	O
vonsanden-08	O
]	O
.	O
many	O
properties	B
of	O
the	O
essential	B
matrix	I
have	O
been	O
elucidated	O
particularly	O
by	O
huang	O
and	O
faugeras	O
[	O
huang-89	O
]	O
,	O
[	O
maybank-93	O
]	O
,	O
and	O
[	O
horn-90	O
]	O
.	O
the	O
realization	B
that	O
the	O
essential	B
matrix	I
could	O
also	O
be	O
applied	O
in	O
uncalibrated	O
situa-	O
tions	O
,	O
as	O
it	O
represented	O
a	O
projective	B
relation	O
,	O
developed	O
in	O
the	O
early	O
part	O
of	O
the	O
1990s	O
,	O
260	O
9	O
epipolar	B
geometry	O
and	O
the	O
fundamental	B
matrix	I
a	O
b	O
b	O
a	O
(	O
a	O
)	O
(	O
b	O
)	O
a	O
b	O
/	O
b	O
/	O
a	O
(	O
c	O
)	O
(	O
d	O
)	O
fig	O
.	O
9.12.	O
the	O
four	O
possible	O
solutions	O
for	O
calibrated	O
reconstruction	O
from	O
e.	O
between	O
the	O
left	O
and	O
right	O
sides	O
there	O
is	O
a	O
baseline	O
reversal	O
.	O
between	O
the	O
top	O
and	O
bottom	O
rows	O
camera	B
b	O
rotates	O
180◦	O
about	O
the	O
baseline	O
.	O
note	O
,	O
only	O
in	O
(	O
a	O
)	O
is	O
the	O
reconstructed	O
point	B
in	O
front	O
of	O
both	O
cameras	B
.	O
and	O
was	O
published	O
simultaneously	O
by	O
faugeras	O
[	O
faugeras-92b	O
,	O
faugeras-92a	O
]	O
,	O
and	O
hartley	O
et	O
al	O
.	O
[	O
hartley-92a	O
,	O
hartley-92c	O
]	O
.	O
the	O
special	O
case	O
of	O
pure	O
planar	B
motion	I
was	O
examined	O
by	O
[	O
maybank-93	O
]	O
for	O
the	O
essential	B
matrix	I
.	O
the	O
corresponding	O
case	O
for	O
the	O
fundamental	B
matrix	I
is	O
investigated	O
by	O
beardsley	O
and	O
zisserman	O
[	O
beardsley-95a	O
]	O
and	O
vi´eville	O
and	O
lingrand	O
[	O
vieville-95	O
]	O
,	O
where	O
further	O
properties	B
are	O
given	O
.	O
9.7.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
fixating	O
cameras	B
.	O
suppose	O
two	O
cameras	O
ﬁxate	O
on	O
a	O
point	O
in	O
space	O
such	O
that	O
their	O
principal	O
axes	O
intersect	O
at	O
that	O
point	B
.	O
show	O
that	O
if	O
the	O
image	O
coordinates	O
are	O
normalized	O
so	O
that	O
the	O
coordinate	O
origin	O
coincides	O
with	O
the	O
principal	B
point	I
then	O
the	O
f33	O
element	O
of	O
the	O
fundamental	O
matrix	B
is	O
zero	O
.	O
(	O
ii	O
)	O
mirror	O
images	O
.	O
suppose	O
that	O
a	O
camera	B
views	O
an	O
object	O
and	O
its	O
reﬂection	O
in	O
a	O
plane	B
mirror	O
.	O
show	O
that	O
this	O
situation	O
is	O
equivalent	B
to	O
two	B
views	I
of	O
the	O
object	O
,	O
and	O
that	O
the	O
fundamental	B
matrix	I
is	O
skew-symmetric	O
.	O
compare	O
the	O
fundamental	B
matrix	I
for	O
this	O
conﬁguration	O
with	O
that	O
of	O
:	O
(	O
a	O
)	O
a	O
pure	O
translation	O
,	O
and	O
(	O
b	O
)	O
a	O
pure	O
planar	B
motion	I
.	O
show	O
that	O
the	O
fundamental	B
matrix	I
is	O
auto-epipolar	B
(	O
as	O
is	O
(	O
a	O
)	O
)	O
.	O
(	O
iii	O
)	O
show	O
that	O
if	O
the	O
vanishing	O
line	O
of	O
a	O
plane	O
contains	O
the	O
epipole	O
then	O
the	O
plane	B
is	O
parallel	B
to	O
the	O
baseline	O
.	O
(	O
iv	O
)	O
steiner	O
conic	B
.	O
show	O
that	O
the	O
polar	O
of	O
xa	O
intersects	O
the	O
steiner	O
conic	B
fs	O
at	O
the	O
epipoles	B
(	O
ﬁgure	O
9.10a	O
)	O
.	O
hint	O
,	O
start	O
from	O
fe	O
=	O
fse	O
+	O
fae	O
=	O
0.	O
since	O
e	O
lies	O
on	O
261	O
the	O
conic	B
fs	O
,	O
then	O
l1	O
=	O
fse	O
is	O
the	O
tangent	B
line	I
at	O
e	O
,	O
and	O
l2	O
=	O
fae	O
=	O
[	O
xa	O
]	O
×e	O
=	O
xa	O
×	O
e	O
is	O
a	O
line	B
through	O
xa	O
and	O
e.	O
9.7	O
closure	O
(	O
v	O
)	O
the	O
afﬁne	B
type	O
of	O
the	O
steiner	O
conic	B
(	O
hyperbola	O
,	O
ellipse	O
or	O
parabola	O
as	O
given	O
in	O
section	O
2.8.2	O
(	O
p59	O
)	O
)	O
depends	O
on	O
the	O
relative	O
conﬁguration	O
of	O
the	O
two	O
cameras	B
.	O
for	O
example	O
,	O
if	O
the	O
two	O
cameras	O
are	O
facing	O
each	O
other	O
then	O
the	O
steiner	O
conic	B
is	O
a	O
hyperbola	O
.	O
this	O
is	O
shown	O
in	O
[	O
chum-03	O
]	O
where	O
further	O
results	O
on	O
oriented	O
epipolar	B
geometry	O
are	O
given	O
.	O
(	O
vi	O
)	O
planar	B
motion	I
.	O
it	O
is	O
shown	O
by	O
[	O
maybank-93	O
]	O
that	O
if	O
the	O
rotation	B
axis	O
direction	O
is	O
orthogonal	B
or	O
parallel	B
to	O
the	O
translation	O
direction	O
then	O
the	O
symmetric	B
part	I
of	O
the	O
essential	B
matrix	I
has	O
rank	O
2.	O
we	O
assume	O
here	O
that	O
k	O
=	O
k	O
(	O
cid:2	O
)	O
.	O
then	O
from	O
(	O
9.12	O
)	O
,	O
f	O
=	O
k−tek−1	O
,	O
and	O
so	O
fs	O
=	O
(	O
f	O
+	O
ft	O
)	O
/2	O
=	O
k−t	O
(	O
e	O
+	O
et	O
)	O
k−1/2	O
=	O
k−tesk−1	O
.	O
it	O
follows	O
from	O
det	O
(	O
fs	O
)	O
=	O
det	O
(	O
k−1	O
)	O
2	O
det	O
(	O
es	O
)	O
that	O
the	O
symmetric	B
part	I
of	O
f	O
is	O
also	O
singular	O
.	O
does	O
this	O
result	O
hold	O
if	O
k	O
(	O
cid:5	O
)	O
=	O
k	O
(	O
cid:2	O
)	O
camera	B
matrices	I
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
for	O
the	O
canonical	O
cameras	O
depends	O
only	O
on	O
the	O
rank	O
2	O
property	O
of	O
f.	O
(	O
vii	O
)	O
any	O
matrix	B
f	O
of	O
rank	O
2	O
is	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
some	O
pair	O
of	O
)	O
this	O
follows	O
directly	O
from	O
result	O
9.14	O
since	O
the	O
solution	B
?	O
(	O
viii	O
)	O
show	O
that	O
the	O
3d	O
points	O
determined	O
from	O
one	O
of	O
the	O
ambiguous	O
reconstructions	O
obtained	O
from	O
e	O
are	O
related	O
to	O
the	O
corresponding	O
3d	O
points	O
determined	O
from	O
another	O
reconstruction	B
by	O
either	O
(	O
i	O
)	O
an	O
inversion	O
through	O
the	O
second	O
camera	B
centre	I
;	O
or	O
(	O
ii	O
)	O
a	O
harmonic	O
homology	B
of	O
3-space	O
(	O
see	O
section	O
a7.2	O
(	O
p629	O
)	O
)	O
,	O
where	O
the	O
homology	B
plane	O
is	O
perpendicular	O
to	O
the	O
baseline	O
and	O
through	O
the	O
second	O
camera	B
centre	I
,	O
and	O
the	O
vertex	O
is	O
the	O
ﬁrst	O
camera	B
centre	I
.	O
(	O
ix	O
)	O
following	O
a	O
similar	O
development	O
to	O
section	O
9.2.2	O
,	O
derive	O
the	O
form	B
of	I
the	O
fun-	O
damental	O
matrix	B
for	O
two	O
linear	O
pushbroom	B
cameras	O
.	O
details	O
of	O
this	O
matrix	B
are	O
given	O
in	O
[	O
gupta-97	O
]	O
where	O
it	O
is	O
shown	O
that	O
afﬁne	B
reconstruction	I
is	O
possible	O
from	O
a	O
pair	O
of	O
images	O
.	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
this	O
chapter	O
describes	O
how	O
and	O
to	O
what	O
extent	O
the	O
spatial	O
layout	O
of	O
a	O
scene	O
and	O
the	O
cameras	B
can	O
be	O
recovered	O
from	O
two	O
views	O
.	O
suppose	O
that	O
a	O
set	O
of	O
image	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
given	O
.	O
it	O
is	O
assumed	O
that	O
these	O
correspondences	B
come	O
from	O
a	O
set	O
of	O
3d	O
points	O
xi	O
,	O
which	O
are	O
unknown	O
.	O
similarly	O
,	O
the	O
position	O
,	O
orientation	B
and	O
calibration	B
of	O
the	O
cameras	B
are	O
not	O
known	O
.	O
the	O
reconstruction	B
task	O
is	O
to	O
ﬁnd	O
the	O
camera	B
matrices	I
p	O
and	O
p	O
(	O
cid:2	O
)	O
,	O
as	O
well	O
as	O
the	O
3d	O
points	O
xi	O
such	O
that	O
xi	O
=	O
pxi	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
p	O
(	O
cid:2	O
)	O
xi	O
for	O
all	O
i.	O
given	O
too	O
few	O
points	O
,	O
this	O
task	O
is	O
not	O
possible	O
.	O
however	O
,	O
if	O
there	O
are	O
sufﬁciently	O
many	O
point	B
correspondences	O
to	O
allow	O
the	O
fundamental	B
matrix	I
to	O
be	O
computed	O
uniquely	O
,	O
then	O
the	O
scene	O
may	O
be	O
reconstructed	O
up	O
to	O
a	O
projective	B
ambiguity	I
.	O
this	O
is	O
a	O
very	O
signiﬁcant	O
result	O
,	O
and	O
one	O
of	O
the	O
major	O
achievements	O
of	O
the	O
uncalibrated	O
approach	O
.	O
the	O
ambiguity	B
in	O
the	O
reconstruction	B
may	O
be	O
reduced	B
if	O
additional	O
information	O
is	O
sup-	O
plied	O
on	O
the	O
cameras	B
or	O
scene	O
.	O
we	O
describe	O
a	O
two-stage	O
approach	O
where	O
the	O
ambiguity	B
is	O
ﬁrst	O
reduced	B
to	O
afﬁne	B
,	O
and	O
second	O
to	O
metric	O
;	O
each	O
stage	O
requiring	O
information	O
of	O
the	O
appropriate	O
class	O
.	O
we	O
describe	O
a	O
method	O
for	O
reconstruction	O
from	O
two	O
views	O
as	O
follows	O
.	O
10.1	O
outline	O
of	O
reconstruction	O
method	O
(	O
i	O
)	O
compute	O
the	O
fundamental	B
matrix	I
from	O
point	B
correspondences	O
.	O
(	O
ii	O
)	O
compute	O
the	O
camera	B
matrices	I
from	O
the	O
fundamental	B
matrix	I
.	O
(	O
iii	O
)	O
for	O
each	O
point	B
correspondence	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
compute	O
the	O
point	B
in	O
space	O
that	O
projects	O
to	O
these	O
two	O
image	O
points	O
.	O
many	O
variants	O
on	O
this	O
method	O
are	O
possible	O
.	O
for	O
instance	O
,	O
if	O
the	O
cameras	B
are	O
calibrated	B
,	O
then	O
one	O
will	O
compute	O
the	O
essential	B
matrix	I
instead	O
of	O
the	O
fundamental	O
matrix	B
.	O
further-	O
more	O
,	O
one	O
may	O
use	O
information	O
about	O
the	O
motion	O
of	O
the	O
camera	O
,	O
scene	B
constraints	I
or	O
partial	O
camera	B
calibration	I
to	O
obtain	O
reﬁnements	O
of	O
the	O
reconstruction	O
.	O
each	O
of	O
the	O
steps	O
of	O
this	O
reconstruction	B
method	O
will	O
be	O
discussed	O
brieﬂy	O
in	O
the	O
fol-	O
lowing	O
paragraphs	O
.	O
the	O
method	O
described	O
is	O
no	O
more	O
than	O
a	O
conceptual	O
approach	O
to	O
reconstruction	O
.	O
the	O
reader	O
is	O
warned	O
not	O
to	O
implement	O
a	O
reconstruction	B
method	O
based	O
solely	O
on	O
the	O
description	O
given	O
in	O
this	O
section	O
.	O
for	O
real	O
images	O
where	O
measurements	O
262	O
10.1	O
outline	O
of	O
reconstruction	O
method	O
263	O
x	O
x	O
/	O
x	O
fig	O
.	O
10.1.	O
triangulation	B
.	O
the	O
image	O
points	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
tfx	O
=	O
0	O
is	O
satisﬁed	O
,	O
then	O
these	O
two	O
rays	O
lie	O
in	O
a	O
plane	B
,	O
and	O
so	O
intersect	O
in	O
a	O
point	B
x	O
in	O
3-space	O
.	O
back	O
project	O
to	O
rays	O
.	O
if	O
the	O
epipolar	B
constraint	O
are	O
“	O
noisy	O
”	O
preferred	O
methods	O
for	O
reconstruction	B
,	O
based	O
on	O
this	O
general	O
outline	O
,	O
are	O
described	O
in	O
chapter	O
11	O
and	O
chapter	O
12.	O
computation	B
of	I
the	O
fundamental	B
matrix	I
.	O
given	O
a	O
set	O
of	O
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
in	O
two	O
images	O
the	O
fundamental	B
matrix	I
f	O
satisﬁes	O
the	O
condition	O
x	O
(	O
cid:2	O
)	O
i	O
fxi	O
=	O
0	O
for	O
all	O
i.	O
with	O
the	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
known	O
,	O
this	O
equation	O
is	O
linear	B
in	O
the	O
(	O
unknown	O
)	O
entries	O
of	O
the	O
matrix	O
f.	O
in	O
fact	O
,	O
each	O
point	B
correspondence	O
generates	O
one	O
linear	B
equation	O
in	O
the	O
entries	O
of	O
f.	O
given	O
at	O
least	O
8	O
point	B
correspondences	O
it	O
is	O
possible	O
to	O
solve	O
linearly	O
for	O
the	O
entries	O
of	O
f	O
up	O
to	O
scale	O
(	O
a	O
non-linear	B
solution	O
is	O
available	O
for	O
7	O
point	B
correspondences	O
)	O
.	O
with	O
more	O
than	O
8	O
equations	O
a	O
least-squares	B
solution	I
is	O
found	O
.	O
this	O
is	O
the	O
general	O
principle	O
of	O
a	O
method	O
for	O
computing	O
the	O
fundamental	B
matrix	I
.	O
i	O
recommended	O
methods	O
of	O
computing	O
the	O
fundamental	B
matrix	I
from	O
a	O
set	O
of	O
point	O
correspondences	B
will	O
be	O
described	O
later	O
in	O
chapter	O
11.	O
computation	B
of	I
the	O
camera	B
matrices	I
.	O
a	O
pair	O
of	B
camera	I
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
corre-	O
sponding	O
to	O
the	O
fundamental	B
matrix	I
f	O
are	O
easily	O
computed	O
using	O
the	O
direct	O
formula	O
in	O
result	O
9.14.	O
,	O
let	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
triangulation	B
.	O
given	O
the	O
camera	B
matrices	I
p	O
and	O
p	O
(	O
cid:2	O
)	O
be	O
two	O
points	O
in	O
the	O
two	O
images	O
that	O
satisfy	O
the	O
epipolar	B
constraint	O
,	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0.	O
as	O
shown	O
in	O
chapter	O
9	O
this	O
constraint	O
may	O
be	O
interpreted	O
geometrically	O
in	O
terms	O
of	O
the	O
rays	O
in	O
space	O
corresponding	O
to	O
the	O
two	O
image	O
points	O
.	O
in	O
particular	O
it	O
means	O
that	O
x	O
(	O
cid:2	O
)	O
lies	O
on	O
the	O
epipolar	B
line	I
fx	O
.	O
in	O
turn	O
this	O
means	O
that	O
the	O
two	O
rays	O
back-projected	O
from	O
image	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
lie	O
in	O
a	O
common	O
epipolar	B
plane	O
,	O
that	O
is	O
,	O
a	O
plane	B
passing	O
through	O
the	O
two	O
camera	O
centres	O
.	O
since	O
the	O
two	O
rays	O
lie	O
in	O
a	O
plane	B
,	O
they	O
will	O
intersect	O
in	O
some	O
point	B
.	O
this	O
point	B
x	O
projects	O
via	O
the	O
two	O
cameras	B
to	O
the	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
in	O
the	O
two	O
images	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
10.1.	O
the	O
only	O
points	O
in	O
3-space	O
that	O
can	O
not	O
be	O
determined	O
from	O
their	O
images	O
are	O
points	O
on	O
the	O
baseline	O
between	O
the	O
two	O
cameras	O
.	O
in	O
this	O
case	O
the	O
back-projected	O
rays	O
are	O
collinear	O
(	O
both	O
being	O
equal	O
to	O
the	O
baseline	O
)	O
and	O
intersect	O
along	O
their	O
whole	O
length	O
.	O
thus	O
,	O
the	O
point	B
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
264	O
x	O
can	O
not	O
be	O
uniquely	O
determined	O
.	O
points	O
on	O
the	O
baseline	O
project	O
to	O
the	O
epipoles	B
in	O
both	B
images	I
.	O
of	O
the	O
two	O
rays	O
back-projected	O
from	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
numerically	O
stable	O
methods	O
of	O
actually	O
determining	O
the	O
point	O
x	O
at	O
the	O
intersection	B
will	O
be	O
described	O
later	O
in	O
chapter	O
12	O
.	O
10.2	O
reconstruction	B
ambiguity	O
in	O
this	O
section	O
we	O
discuss	O
the	O
inherent	O
ambiguities	B
involved	O
in	O
reconstruction	O
of	O
a	O
scene	O
from	O
point	O
correspondences	O
.	O
this	O
topic	O
will	O
be	O
discussed	O
in	O
a	O
general	O
context	O
,	O
without	O
reference	O
to	O
a	O
speciﬁc	O
method	O
of	O
carrying	O
out	O
the	O
reconstruction	B
.	O
without	O
some	O
knowledge	O
of	O
a	O
scene	O
’	O
s	O
placement	O
with	O
respect	O
to	O
a	O
3d	O
coordinate	O
frame	O
,	O
it	O
is	O
generally	O
not	O
possible	O
to	O
reconstruct	O
the	O
absolute	O
position	O
or	O
orientation	B
of	O
a	O
scene	O
from	O
a	O
pair	O
of	O
views	O
(	O
or	O
in	O
fact	O
from	O
any	O
number	O
of	O
views	O
)	O
.	O
this	O
is	O
true	O
independently	O
of	O
any	O
knowledge	O
which	O
may	O
be	O
available	O
about	O
the	O
internal	B
parameters	I
of	O
the	O
cameras	B
,	O
or	O
their	O
relative	O
placement	O
.	O
for	O
instance	O
the	O
exact	O
latitude	O
and	O
longitude	O
of	O
the	O
scene	O
in	O
ﬁgure	O
9.8	O
(	O
p248	O
)	O
(	O
or	O
any	O
scene	O
)	O
can	O
not	O
be	O
computed	O
,	O
nor	O
is	O
it	O
possible	O
to	O
determine	O
whether	O
the	O
corridor	O
runs	O
north-south	O
or	O
east-west	O
.	O
this	O
may	O
be	O
expressed	O
by	O
saying	O
that	O
the	O
scene	O
is	O
determined	O
at	O
best	O
up	O
to	O
a	O
euclidean	O
transformation	O
(	O
rotation	B
and	I
translation	I
)	O
with	O
respect	O
to	O
the	O
world	O
frame	O
.	O
only	O
slightly	O
less	O
obvious	O
is	O
the	O
fact	O
that	O
the	O
overall	O
scale	O
of	O
the	O
scene	O
can	O
not	O
be	O
determined	O
.	O
considering	O
ﬁgure	O
9.8	O
(	O
p248	O
)	O
once	O
more	O
,	O
it	O
is	O
impossible	O
based	O
on	O
the	O
images	O
alone	O
to	O
determine	O
the	O
width	O
of	O
the	O
corridor	O
.	O
it	O
may	O
be	O
two	O
metres	O
,	O
one	O
metre	O
.	O
it	O
is	O
even	O
possible	O
that	O
this	O
is	O
an	O
image	O
of	O
a	O
doll	O
’	O
s	O
house	O
and	O
the	O
corridor	O
is	O
10	O
cm	O
wide	O
.	O
our	O
common	O
experience	O
leads	O
us	O
to	O
expect	O
that	O
ceilings	O
are	O
approximately	O
3m	O
from	O
the	O
ﬂoor	O
,	O
which	O
allows	O
us	O
to	O
perceive	O
the	O
real	O
scale	O
of	O
the	O
scene	O
.	O
this	O
extra	O
information	O
is	O
an	O
example	O
of	O
subsidiary	O
knowledge	O
of	O
the	O
scene	O
not	O
derived	O
from	O
image	O
measurements	O
.	O
without	O
such	O
knowledge	O
therefore	O
the	O
scene	O
is	O
determined	O
by	O
the	O
image	O
only	O
up	O
to	O
a	O
similarity	B
transformation	I
(	O
rotation	B
,	O
translation	O
and	O
scaling	B
)	O
.	O
to	O
give	O
a	O
mathematical	O
basis	O
to	O
this	O
observation	O
,	O
let	O
xi	O
be	O
a	O
set	O
of	B
points	I
and	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
be	O
a	O
pair	O
of	O
cameras	O
projecting	O
xi	O
to	O
image	O
points	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i.	O
the	O
points	O
xi	O
and	O
the	O
camera	B
pair	O
constitute	O
a	O
reconstruction	B
of	O
the	O
scene	O
from	O
the	O
image	O
correspondences	O
.	O
now	O
let	O
hs	O
=	O
t	O
r	O
0t	O
λ	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
be	O
any	O
similarity	B
transformation	I
:	O
r	O
is	O
a	O
rotation	B
,	O
t	O
a	O
translation	O
and	O
λ	O
all	O
scaling	B
.	O
replacing	O
each	O
point	B
xi	O
by	O
hsxi	O
and	O
cameras	B
p	O
and	O
p	O
(	O
cid:2	O
)	O
respectively	O
does	O
not	O
change	O
the	O
observed	O
image	O
points	O
,	O
since	O
pxi	O
=	O
(	O
ph−1	O
furthermore	O
,	O
if	O
p	O
is	O
decomposed	O
as	O
p	O
=	O
k	O
[	O
rp	O
|	O
tp	O
]	O
,	O
then	O
one	O
computes	O
−1	O
represents	O
over-	O
s	O
and	O
p	O
(	O
cid:2	O
)	O
h−1	O
by	O
ph−1	O
s	O
)	O
(	O
hsxi	O
)	O
.	O
s	O
ph−1	O
s	O
=	O
k	O
[	O
rpr−1	O
|	O
t	O
(	O
cid:2	O
)	O
]	O
for	O
some	O
t	O
(	O
cid:2	O
)	O
that	O
we	O
do	O
not	O
need	O
to	O
compute	O
more	O
exactly	O
.	O
this	O
result	O
shows	O
that	O
multi-	O
plying	O
by	O
h−1	O
s	O
does	O
not	O
change	O
the	O
calibration	B
matrix	I
of	O
p.	O
consequently	O
this	O
ambiguity	B
of	O
reconstruction	B
exists	O
even	O
for	O
calibrated	O
cameras	O
.	O
it	O
was	O
shown	O
by	O
longuet-higgins	O
10.2	O
reconstruction	B
ambiguity	O
265	O
similarity	B
projective	O
a	O
b	O
fig	O
.	O
10.2.	O
reconstruction	B
ambiguity	O
.	O
(	O
a	O
)	O
if	O
the	O
cameras	B
are	O
calibrated	B
then	O
any	O
reconstruction	B
must	O
respect	O
the	O
angle	B
between	O
rays	O
measured	O
in	O
the	O
image	O
.	O
a	O
similarity	B
transformation	I
of	O
the	O
structure	B
and	O
camera	B
positions	O
does	O
not	O
change	O
the	O
measured	O
angle	B
.	O
the	O
angle	B
between	O
rays	O
and	O
the	O
baseline	O
(	O
epipoles	B
)	O
is	O
also	O
unchanged	O
.	O
(	O
b	O
)	O
if	O
the	O
cameras	B
are	O
uncalibrated	O
then	O
reconstructions	O
must	O
only	O
respect	O
the	O
image	O
points	O
(	O
the	O
intersection	B
of	O
the	O
rays	O
with	O
the	O
image	B
plane	I
)	O
.	O
a	O
projective	B
transformation	I
of	O
the	O
structure	B
and	O
camera	B
positions	O
does	O
not	O
change	O
the	O
measured	O
points	O
,	O
although	O
the	O
angle	B
between	O
rays	O
is	O
altered	O
.	O
the	O
epipoles	B
are	O
also	O
unchanged	O
(	O
intersection	B
with	O
baseline	O
)	O
.	O
(	O
[	O
longuethiggins-81	O
]	O
)	O
that	O
for	O
calibrated	O
cameras	O
,	O
this	O
is	O
the	O
only	O
ambiguity	B
of	O
recon-	O
struction	O
.	O
thus	O
for	O
calibrated	O
cameras	O
,	O
reconstruction	B
is	O
possible	O
up	O
to	O
a	O
similarity	B
transformation	I
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
10.2a	O
.	O
projective	B
ambiguity	I
.	O
if	O
nothing	O
is	O
known	O
of	O
the	O
calibration	B
of	O
either	O
camera	B
,	O
nor	O
the	O
placement	O
of	O
one	O
camera	B
with	O
respect	O
to	O
the	O
other	O
,	O
then	O
the	O
ambiguity	B
of	O
reconstruction	B
is	O
expressed	O
by	O
an	O
arbitrary	O
projective	B
transformation	I
.	O
in	O
particular	O
,	O
if	O
h	O
is	O
any	O
4	O
×	O
4	O
invertible	O
matrix	B
,	O
representing	O
a	O
projective	B
transformation	I
of	O
ip3	O
,	O
then	O
replacing	O
points	O
xi	O
by	O
hxi	O
and	O
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
by	O
ph−1	O
and	O
p	O
(	O
cid:2	O
)	O
h−1	O
(	O
as	O
in	O
the	O
previous	O
paragraph	O
)	O
does	O
not	O
change	O
the	O
image	O
points	O
.	O
this	O
shows	O
that	O
the	O
points	O
xi	O
and	O
the	O
cameras	B
can	O
be	O
determined	O
at	O
best	O
only	O
up	O
to	O
a	O
projective	B
transformation	I
.	O
it	O
is	O
an	O
important	O
result	O
,	O
proved	O
in	O
this	O
chapter	O
(	O
section	O
10.3	O
)	O
,	O
that	O
this	O
is	O
the	O
only	O
ambiguity	B
in	O
the	O
reconstruction	B
of	O
points	O
from	O
two	O
images	O
.	O
thus	O
reconstruction	B
from	O
uncalibrated	O
cameras	B
is	O
possible	O
up	O
to	O
a	O
projective	B
transformation	I
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
10.2b	O
.	O
other	O
types	O
of	O
reconstruction	O
ambiguity	B
result	O
from	O
certain	O
assumptions	O
on	O
the	O
types	O
of	O
motion	O
,	O
or	O
partial	O
knowledge	O
of	O
the	O
cameras	O
.	O
for	O
instance	O
,	O
(	O
i	O
)	O
if	O
the	O
two	O
cameras	O
are	O
related	O
via	O
a	O
translational	B
motion	I
,	O
without	O
change	O
of	O
calibration	O
,	O
then	O
reconstruction	B
is	O
possible	O
up	O
to	O
an	O
afﬁne	B
transformation	I
.	O
(	O
ii	O
)	O
if	O
the	O
two	O
cameras	O
are	O
calibrated	B
apart	O
from	O
their	O
focal	O
lengths	O
,	O
then	O
reconstruc-	O
tion	O
is	O
still	O
possible	O
up	O
to	O
a	O
similarity	B
transformation	I
.	O
these	O
two	O
cases	O
will	O
be	O
considered	O
later	O
in	O
section	O
10.4.1	O
and	O
example	O
19.8	O
(	O
p472	O
)	O
,	O
respectively	O
.	O
terminology	B
.	O
point	B
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
tual	O
points	O
¯xi	O
and	O
actual	O
cameras	B
¯p	O
,	O
¯p	O
in	O
any	O
reconstruction	B
problem	O
derived	O
from	O
real	O
data	O
,	O
consisting	O
of	O
i	O
,	O
there	O
exists	O
a	O
true	O
reconstruction	B
consisting	O
of	O
the	O
ac-	O
that	O
generated	O
the	O
measured	O
observations	O
.	O
the	O
(	O
cid:2	O
)	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
266	O
reconstructed	O
point	B
set	O
xi	O
and	O
cameras	B
differ	O
from	O
the	O
true	O
reconstruction	B
by	O
a	O
trans-	O
formation	O
belonging	O
to	O
a	O
given	O
class	O
or	O
group	O
(	O
for	O
instance	O
a	O
similarity	B
,	O
projective	B
or	O
afﬁne	B
transformation	I
)	O
.	O
one	O
speaks	O
of	O
projective	O
reconstruction	B
,	O
afﬁne	B
reconstruction	I
,	O
similarity	B
reconstruction	O
,	O
and	O
so	O
on	O
,	O
to	O
indicate	O
the	O
type	O
of	O
transformation	O
involved	O
.	O
however	O
,	O
the	O
term	O
metric	B
reconstruction	I
is	O
normally	O
used	O
in	O
preference	O
to	O
similarity	O
reconstruction	B
,	O
being	O
identical	O
in	O
meaning	O
.	O
the	O
term	O
indicates	O
that	O
metric	B
properties	I
,	O
such	O
as	O
angles	O
between	O
lines	O
and	O
ratios	O
of	O
lengths	O
,	O
can	O
be	O
measured	O
on	O
the	O
reconstruc-	O
tion	O
and	O
have	O
their	O
veridical	O
values	O
(	O
since	O
these	O
are	O
similarity	B
invariants	O
)	O
.	O
in	O
addition	O
,	O
the	O
term	O
euclidean	O
reconstruction	O
is	O
frequently	O
used	O
in	O
the	O
published	O
literature	O
to	O
mean	O
the	O
same	O
thing	O
as	O
a	O
similarity	B
or	O
metric	B
reconstruction	I
,	O
since	O
true	O
euclidean	O
recon-	O
struction	O
(	O
including	O
determination	O
of	O
overall	O
scale	O
)	O
is	O
not	O
possible	O
without	O
extraneous	O
information	O
.	O
10.3	O
the	O
projective	B
reconstruction	I
theorem	O
in	O
this	O
section	O
the	O
basic	O
theorem	O
of	O
projective	O
reconstruction	B
from	O
uncalibrated	O
cameras	B
is	O
proved	O
.	O
informally	O
,	O
the	O
theorem	O
may	O
be	O
stated	O
as	O
follows	O
.	O
•	O
if	O
a	O
set	O
of	O
point	O
correspondences	B
in	O
two	B
views	I
determine	O
the	O
fundamental	B
matrix	I
uniquely	O
,	O
then	O
the	O
scene	O
and	O
cameras	B
may	O
be	O
reconstructed	O
from	O
these	O
correspon-	O
dences	O
alone	O
,	O
and	O
any	O
two	O
such	O
reconstructions	O
from	O
these	O
correspondences	B
are	O
pro-	O
jectively	O
equivalent	B
.	O
points	O
lying	O
on	O
the	O
line	B
joining	O
the	O
two	O
camera	O
centres	O
must	O
be	O
excluded	O
,	O
since	O
such	O
points	O
can	O
not	O
be	O
reconstructed	O
uniquely	O
even	O
if	O
the	O
camera	B
matrices	I
are	O
determined	O
.	O
the	O
formal	O
statement	O
is	O
:	O
theorem	O
10.1	O
(	O
projective	B
reconstruction	I
theorem	O
)	O
.	O
suppose	O
that	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
is	O
a	O
set	O
of	O
correspondences	O
between	O
points	O
in	O
two	O
images	O
and	O
that	O
the	O
fundamental	B
matrix	I
f	O
1	O
,	O
{	O
x1i	O
}	O
)	O
and	O
is	O
uniquely	O
determined	O
by	O
the	O
condition	O
x	O
(	O
cid:2	O
)	O
(	O
p2	O
,	O
p	O
(	O
cid:2	O
)	O
i.	O
then	O
there	O
h−1	O
and	O
x2i	O
=	O
hx1i	O
for	O
exists	O
a	O
non-singular	O
matrix	B
h	O
such	O
that	O
p2	O
=	O
p1h−1	O
,	O
p	O
(	O
cid:2	O
)	O
all	O
i	O
,	O
except	O
for	O
those	O
i	O
such	O
that	O
fxi	O
=	O
x	O
(	O
cid:2	O
)	O
tfxi	O
=	O
0	O
for	O
all	O
i.	O
let	O
(	O
p1	O
,	O
p	O
(	O
cid:2	O
)	O
2	O
,	O
{	O
x2i	O
}	O
)	O
be	O
two	O
reconstructions	O
of	O
the	O
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
2	O
=	O
p	O
(	O
cid:2	O
)	O
tf	O
=	O
0	O
.	O
1	O
i	O
i	O
2	O
=	O
p	O
(	O
cid:2	O
)	O
1	O
)	O
and	O
also	O
to	O
(	O
p2	O
,	O
p	O
(	O
cid:2	O
)	O
proof	O
.	O
since	O
the	O
fundamental	B
matrix	I
is	O
uniquely	O
determined	O
by	O
the	O
point	B
correspon-	O
dences	O
,	O
one	O
deduces	O
that	O
f	O
is	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
the	O
camera	B
pair	O
(	O
p1	O
,	O
p	O
(	O
cid:2	O
)	O
2	O
)	O
.	O
according	O
to	O
theorem	O
9.10	O
(	O
p254	O
)	O
there	O
is	O
a	O
projective	B
transformation	I
h	O
such	O
that	O
p2	O
=	O
p1h−1	O
and	O
p	O
(	O
cid:2	O
)	O
as	O
for	O
the	O
points	O
,	O
one	O
observes	O
that	O
p2	O
(	O
hx1i	O
)	O
=	O
p1h−1hx1i	O
=	O
p1x1i	O
=	O
xi	O
.	O
on	O
the	O
other	O
hand	O
p2x2i	O
=	O
xi	O
,	O
sop	O
2	O
(	O
hx1i	O
)	O
=p	O
2x2i	O
.	O
thus	O
both	O
hx1i	O
and	O
x2i	O
map	O
to	O
the	O
same	O
point	O
xi	O
under	O
the	O
action	O
of	O
the	O
camera	B
p2	O
.	O
it	O
follows	O
that	O
both	O
hx1i	O
and	O
x2i	O
lie	O
on	O
the	O
same	O
ray	O
through	O
the	O
camera	B
centre	I
of	O
p2	O
.	O
similarly	O
,	O
it	O
may	O
be	O
deduced	O
that	O
these	O
two	O
points	O
lie	O
on	O
the	O
same	O
ray	O
through	O
the	O
camera	B
centre	I
of	O
p	O
(	O
cid:2	O
)	O
2.	O
there	O
are	O
two	O
possibilities	O
:	O
either	O
x2i	O
=	O
hx1i	O
as	O
required	O
,	O
or	O
they	O
are	O
distinct	O
points	O
lying	O
on	O
the	O
line	B
joining	O
the	O
two	O
camera	O
centres	O
.	O
in	O
this	O
latter	O
case	O
,	O
the	O
image	O
points	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
coincide	O
with	O
the	O
epipoles	B
in	O
the	O
two	O
images	O
,	O
and	O
so	O
fxi	O
=	O
x	O
(	O
cid:2	O
)	O
h−1	O
as	O
required	O
.	O
tf	O
=	O
0	O
.	O
1	O
i	O
10.4	O
stratiﬁed	B
reconstruction	I
267	O
a	O
b	O
fig	O
.	O
10.3.	O
projective	B
reconstruction	I
.	O
(	O
b	O
)	O
2	O
views	O
of	O
a	O
3d	O
projective	B
re-	O
construction	O
of	O
the	O
scene	O
.	O
the	O
reconstruction	B
requires	O
no	O
information	O
about	O
the	O
camera	B
matrices	I
,	O
or	O
information	O
about	O
the	O
scene	O
geometry	O
.	O
the	O
fundamental	B
matrix	I
f	O
is	O
computed	O
from	O
point	O
correspon-	O
dences	O
between	O
the	O
images	O
,	O
camera	B
matrices	I
are	O
retrieved	O
from	O
f	O
,	O
and	O
then	O
3d	O
points	O
are	O
computed	O
by	O
triangulation	B
from	O
the	O
correspondences	B
.	O
the	O
lines	B
of	O
the	O
wireframe	O
link	O
the	O
computed	O
3d	O
points	O
.	O
(	O
a	O
)	O
original	O
image	O
pair	O
.	O
this	O
is	O
an	O
enormously	O
signiﬁcant	O
result	O
,	O
since	O
it	O
implies	O
that	O
one	O
may	O
compute	O
a	O
projective	B
reconstruction	I
of	O
a	O
scene	O
from	O
two	B
views	I
based	O
on	O
image	O
correspondences	B
alone	O
,	O
without	O
knowing	O
anything	O
about	O
the	O
calibration	B
or	O
pose	O
of	O
the	O
two	O
cameras	B
in-	O
volved	O
.	O
in	O
particular	O
the	O
true	O
reconstruction	B
is	O
within	O
a	O
projective	B
transformation	I
of	O
the	O
projective	B
reconstruction	I
.	O
figure	O
10.3	O
shows	O
an	O
example	O
of	O
3d	O
structure	B
computed	O
as	O
part	O
of	O
a	O
projective	O
reconstruction	B
from	O
two	O
images	O
.	O
e	O
,	O
{	O
xei	O
}	O
)	O
and	O
the	O
,	O
{	O
xi	O
}	O
)	O
,	O
then	O
the	O
reconstructions	O
are	O
related	O
by	O
a	O
non-	O
projective	B
reconstruction	I
is	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
singular	O
matrix	O
h	O
such	O
that	O
in	O
more	O
detail	O
suppose	O
the	O
true	O
euclidean	O
reconstruction	O
is	O
(	O
pe	O
,	O
p	O
(	O
cid:2	O
)	O
pe	O
=	O
ph−1	O
,	O
p	O
(	O
cid:2	O
)	O
e	O
=	O
p	O
(	O
cid:2	O
)	O
h−1	O
,	O
and	O
xei	O
=	O
hxi	O
(	O
10.1	O
)	O
where	O
h	O
is	O
a	O
4	O
×	O
4	O
homography	B
matrix	O
which	O
is	O
unknown	O
but	O
the	O
same	O
for	O
all	O
points	O
.	O
for	O
some	O
applications	O
projective	B
reconstruction	I
is	O
all	O
that	O
is	O
required	O
.	O
for	O
example	O
,	O
questions	O
such	O
as	O
“	O
at	O
what	O
point	B
does	O
a	O
line	B
intersect	O
a	O
plane	B
?	O
”	O
,	O
“	O
what	O
is	O
the	O
mapping	O
between	O
two	B
views	I
induced	O
by	O
particular	O
surfaces	O
,	O
such	O
as	O
a	O
plane	B
or	O
quadric	O
?	O
”	O
can	O
be	O
dealt	O
with	O
directly	O
from	O
the	O
projective	B
reconstruction	I
.	O
furthermore	O
it	O
will	O
be	O
seen	O
in	O
the	O
sequel	O
that	O
obtaining	O
a	O
projective	B
reconstruction	I
of	O
a	O
scene	O
is	O
the	O
ﬁrst	O
step	O
towards	O
afﬁne	B
or	O
metric	B
reconstruction	I
.	O
10.4	O
stratiﬁed	B
reconstruction	I
the	O
“	O
stratiﬁed	O
”	O
approach	O
to	O
reconstruction	O
is	O
to	O
begin	O
with	O
a	O
projective	B
reconstruction	I
and	O
then	O
to	O
reﬁne	O
it	O
progressively	O
to	O
an	O
afﬁne	B
and	O
ﬁnally	O
a	O
metric	B
reconstruction	I
,	O
if	O
268	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
possible	O
.	O
of	O
course	O
,	O
as	O
has	O
just	O
been	O
seen	O
,	O
afﬁne	B
and	O
metric	B
reconstruction	I
are	O
not	O
possible	O
without	O
further	O
information	O
either	O
about	O
the	O
scene	O
,	O
the	O
motion	O
or	O
the	O
camera	B
calibration	I
.	O
10.4.1	O
the	O
step	O
to	O
afﬁne	O
reconstruction	B
the	O
essence	O
of	O
afﬁne	O
reconstruction	B
is	O
to	O
locate	O
the	O
plane	O
at	O
inﬁnity	O
by	O
some	O
means	O
,	O
since	O
this	O
knowledge	O
is	O
equivalent	B
to	O
an	O
afﬁne	B
reconstruction	I
.	O
this	O
equivalence	O
is	O
explained	O
in	O
the	O
2d	O
case	O
in	O
section	O
2.7	O
(	O
p47	O
)	O
.	O
to	O
see	O
this	O
equivalence	O
for	O
reconstruction	B
,	O
suppose	O
we	O
have	O
determined	O
a	O
projective	B
reconstruction	I
of	O
a	O
scene	O
,	O
consisting	O
of	O
a	O
,	O
{	O
xi	O
}	O
)	O
.	O
suppose	O
further	O
that	O
by	O
some	O
means	O
a	O
certain	O
plane	B
π	O
has	O
been	O
triple	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
identiﬁed	O
as	O
the	O
true	O
plane	O
at	O
inﬁnity	O
.	O
the	O
plane	B
π	O
is	O
expressed	O
as	O
a	O
4-vector	O
in	O
the	O
coordinate	O
frame	O
of	O
the	O
projective	O
reconstruction	B
.	O
in	O
the	O
true	O
reconstruction	B
,	O
π	O
has	O
coordinates	B
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
and	O
we	O
may	O
ﬁnd	O
a	O
projective	B
transformation	I
that	O
maps	O
π	O
to	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
considering	O
the	O
way	O
a	O
projective	B
transformation	I
acts	O
on	O
planes	O
,	O
we	O
want	O
to	O
ﬁnd	O
h	O
such	O
that	O
h−tπ	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
such	O
a	O
transformation	B
is	O
given	O
by	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
i	O
|	O
0	O
πt	O
h	O
=	O
.	O
(	O
10.2	O
)	O
it	O
is	O
immediately	O
veriﬁed	O
that	O
ht	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
=	O
π	O
,	O
and	O
thus	O
h−tπ	O
=	O
indeed	O
,	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
as	O
desired	O
.	O
the	O
transformation	B
h	O
is	O
now	O
applied	O
to	O
all	O
points	O
and	O
the	O
two	O
cameras	O
.	O
notice	O
,	O
however	O
that	O
this	O
formula	O
will	O
not	O
work	O
if	O
the	O
ﬁnal	O
coordinate	O
of	O
πt	O
is	O
zero	O
.	O
in	O
this	O
case	O
,	O
one	O
may	O
compute	O
a	O
suitable	O
h	O
by	O
computing	B
h−t	O
as	O
a	O
householder	O
matrix	B
(	O
a4.2–p580	O
)	O
such	O
that	O
h−tπ	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
at	O
this	O
point	B
,	O
the	O
reconstruction	B
that	O
one	O
has	O
is	O
not	O
necessarily	O
the	O
true	O
reconstruction	B
–	O
all	O
one	O
knows	O
is	O
that	O
the	O
plane	O
at	O
inﬁnity	O
is	O
correctly	O
placed	O
.	O
the	O
present	O
reconstruc-	O
tion	O
differs	O
from	O
the	O
true	O
reconstruction	B
by	O
a	O
projective	B
transformation	I
that	O
ﬁxes	O
the	O
plane	O
at	O
inﬁnity	O
.	O
however	O
,	O
according	O
to	O
result	O
3.7	O
(	O
p80	O
)	O
,	O
a	O
projective	B
transformation	I
ﬁxing	O
the	O
plane	O
at	O
inﬁnity	O
is	O
an	O
afﬁne	B
transformation	I
.	O
hence	O
the	O
reconstruction	B
differs	O
by	O
an	O
afﬁne	B
transformation	I
from	O
the	O
true	O
reconstruction	B
–	O
it	O
is	O
an	O
afﬁne	B
reconstruction	I
.	O
an	O
afﬁne	B
reconstruction	I
may	O
well	O
be	O
sufﬁcient	O
for	O
some	O
applications	O
.	O
for	O
example	O
,	O
the	O
mid-point	O
of	O
two	O
points	O
and	O
the	O
centroid	O
of	O
a	O
set	O
of	B
points	I
may	O
now	O
be	O
computed	O
,	O
and	O
lines	B
constructed	O
parallel	B
to	O
other	O
lines	B
and	O
to	O
planes	O
.	O
such	O
computations	O
are	O
not	O
possible	O
from	O
a	O
projective	B
reconstruction	I
.	O
as	O
has	O
been	O
stated	O
,	O
the	O
plane	O
at	O
inﬁnity	O
can	O
not	O
be	O
identiﬁed	O
unless	O
some	O
extra	O
in-	O
formation	O
is	O
given	O
.	O
we	O
will	O
now	O
give	O
several	O
examples	B
of	O
the	O
type	O
of	O
information	O
that	O
sufﬁces	O
for	O
this	O
identiﬁcation	O
.	O
translational	B
motion	I
consider	O
the	O
case	O
where	O
the	O
camera	B
is	O
known	O
to	O
undergo	O
a	O
purely	O
translational	B
motion	I
.	O
in	O
this	O
case	O
,	O
it	O
is	O
possible	O
to	O
carry	O
out	O
afﬁne	B
reconstruction	I
from	O
two	B
views	I
.	O
a	O
simple	O
way	O
of	O
seeing	O
this	O
is	O
to	O
observe	O
that	O
a	O
point	B
x	O
on	O
the	O
plane	O
at	O
inﬁnity	O
will	O
map	O
to	O
the	O
same	O
point	O
in	O
two	O
images	O
related	O
by	O
a	O
translation	O
.	O
this	O
is	O
easily	O
veriﬁed	O
formally	O
.	O
it	O
is	O
also	O
part	O
of	O
our	O
common	O
experience	O
that	O
as	O
one	O
moves	O
in	O
a	O
straight	O
line	B
(	O
for	O
instance	O
in	O
10.4	O
stratiﬁed	B
reconstruction	I
269	O
a	O
car	O
on	O
a	O
straight	O
road	O
)	O
,	O
objects	O
at	O
a	O
great	O
distance	B
(	O
such	O
as	O
the	O
moon	O
)	O
do	O
not	O
appear	O
to	O
move	O
–	O
only	O
the	O
nearby	O
objects	O
move	O
past	O
the	O
ﬁeld	O
of	O
view	O
.	O
this	O
being	O
so	O
,	O
one	O
may	O
invent	O
any	O
number	O
of	O
matched	O
points	O
xi	O
↔	O
xi	O
where	O
a	O
point	B
in	O
one	O
image	O
corresponds	O
with	O
the	O
same	O
point	O
in	O
the	O
other	O
image	O
.	O
note	O
that	O
one	O
does	O
not	O
actually	O
have	O
to	O
observe	O
such	O
a	O
correspondence	B
in	O
the	O
two	O
images	O
–	O
any	O
point	O
and	O
the	O
same	O
point	O
in	O
the	O
other	O
image	O
will	O
do	O
.	O
given	O
a	O
projective	B
reconstruction	I
,	O
one	O
may	O
then	O
reconstruct	O
the	O
point	B
xi	O
corresponding	O
to	O
the	O
match	O
xi	O
↔	O
xi	O
.	O
point	B
xi	O
will	O
lie	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
from	O
three	O
such	O
points	O
one	O
can	O
get	O
three	O
points	O
on	O
the	O
plane	O
at	O
inﬁnity	O
–	O
sufﬁcient	O
to	O
determine	O
it	O
uniquely	O
.	O
although	O
this	O
argument	O
gives	O
a	O
constructive	O
proof	O
that	O
afﬁne	B
reconstruction	I
is	O
pos-	O
sible	O
from	O
a	O
translating	O
camera	B
,	O
this	O
does	O
not	O
mean	O
that	O
this	O
is	O
the	O
best	O
way	O
to	O
pro-	O
ceed	O
numerically	O
.	O
in	O
fact	O
in	O
this	O
case	O
,	O
the	O
assumption	O
of	O
translational	O
motion	O
implies	O
a	O
very	O
restricted	O
form	O
for	O
the	O
fundamental	B
matrix	I
–	O
it	O
is	O
skew-symmetric	O
as	O
shown	O
in	O
section	O
9.3.1.	O
this	O
special	O
form	O
should	O
be	O
taken	O
into	O
account	O
when	O
solving	O
for	O
the	O
fundamental	B
matrix	I
.	O
result	O
10.2.	O
suppose	O
the	O
motion	O
of	O
the	O
cameras	O
is	O
a	O
pure	O
translation	O
with	O
no	O
rotation	O
and	O
no	O
change	O
in	O
the	O
internal	B
parameters	I
.	O
as	O
shown	O
in	O
example	O
9.6	O
(	O
p249	O
)	O
f	O
=	O
[	O
e	O
]	O
×	O
=	O
]	O
×	O
,	O
and	O
for	O
an	O
afﬁne	B
reconstruction	I
one	O
may	O
choose	O
the	O
two	O
cameras	O
as	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
[	O
e	O
(	O
cid:2	O
)	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
i	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
.	O
scene	B
constraints	I
scene	O
constraints	B
or	O
conditions	O
may	O
also	O
be	O
used	O
to	O
obtain	O
an	O
afﬁne	B
reconstruction	I
.	O
as	O
long	O
as	O
three	O
points	O
can	O
be	O
identiﬁed	O
that	O
are	O
known	O
to	O
lie	O
on	O
the	O
plane	O
at	O
inﬁn-	O
ity	O
,	O
then	O
that	O
plane	B
may	O
be	O
identiﬁed	O
,	O
and	O
the	O
reconstruction	B
transformed	O
to	O
an	O
afﬁne	B
reconstruction	I
.	O
parallel	B
lines	I
.	O
the	O
most	O
obvious	O
such	O
condition	O
is	O
the	O
knowledge	O
that	O
3d	O
lines	B
are	O
in	O
reality	O
parallel	B
.	O
the	O
intersection	B
of	O
the	O
two	O
parallel	O
lines	B
in	O
space	O
gives	O
a	O
point	B
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
the	O
image	O
of	O
this	O
point	B
is	O
the	O
vanishing	O
point	O
of	O
the	O
line	O
,	O
and	O
is	O
the	O
point	B
of	O
intersection	B
of	O
the	O
two	O
imaged	O
lines	B
.	O
suppose	O
that	O
three	O
sets	O
of	B
parallel	I
lines	I
can	O
be	O
identiﬁed	O
in	O
the	O
scene	O
.	O
each	O
set	O
intersects	O
in	O
a	O
point	B
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
provided	O
each	O
set	O
has	O
a	O
different	O
direction	O
,	O
the	O
three	O
points	O
will	O
be	O
distinct	O
.	O
since	O
three	O
points	O
determine	O
a	O
plane	B
,	O
this	O
information	O
is	O
sufﬁcient	O
to	O
identify	O
the	O
plane	B
π.	O
the	O
best	O
way	O
of	O
actually	O
computing	B
the	O
intersection	B
of	O
lines	B
in	O
space	O
is	O
a	O
somewhat	O
delicate	O
problem	O
,	O
since	O
in	O
the	O
presence	O
of	O
noise	O
,	O
lines	B
that	O
are	O
intended	O
to	O
intersect	O
rarely	O
do	O
.	O
it	O
is	O
discussed	O
in	O
some	O
detail	O
in	O
chapter	O
12.	O
correct	O
numerical	O
procedures	O
for	O
computing	O
the	O
plane	B
are	O
given	O
in	O
chapter	O
13.	O
an	O
example	O
of	O
an	O
afﬁne	B
reconstruction	I
computed	O
from	O
three	O
sets	O
of	O
parallel	O
scene	O
lines	B
is	O
given	O
in	O
ﬁgure	O
10.4.	O
note	O
that	O
it	O
is	O
not	O
necessary	O
to	O
ﬁnd	O
the	O
vanishing	O
point	O
in	B
both	I
images	I
.	O
suppose	O
the	O
vanishing	O
point	O
v	O
is	O
computed	O
from	O
imaged	O
parallel	B
lines	I
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
l	O
(	O
cid:2	O
)	O
is	O
a	O
corresponding	O
line	B
in	O
the	O
second	O
image	O
.	O
vanishing	B
points	I
satisfy	O
the	O
epipolar	B
constraint	O
,	O
so	O
the	O
corresponding	O
vanishing	O
point	O
v	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
image	O
may	O
be	O
com-	O
puted	O
as	O
the	O
intersection	B
of	O
l	O
(	O
cid:2	O
)	O
and	O
the	O
epipolar	B
line	I
fv	O
of	O
v.	O
the	O
construction	O
of	O
the	O
270	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
a	O
b	O
fig	O
.	O
10.4.	O
afﬁne	B
reconstruction	I
.	O
the	O
projective	B
reconstruction	I
of	O
ﬁgure	O
10.3	O
may	O
be	O
upgraded	O
to	O
afﬁne	O
using	O
parallel	O
scene	O
lines	O
.	O
(	O
a	O
)	O
there	O
are	O
3	O
sets	O
of	B
parallel	I
lines	I
in	O
the	O
scene	O
,	O
each	O
set	O
with	O
a	O
different	O
direction	O
.	O
these	O
3	O
sets	O
enable	O
the	O
position	O
of	O
the	O
plane	O
at	B
inﬁnity	I
,	O
π∞	O
,	O
to	O
be	O
computed	O
in	O
the	O
projective	B
reconstruction	I
.	O
the	O
wireframe	O
projective	B
reconstruction	I
of	O
ﬁgure	O
10.3	O
is	O
then	O
afﬁnely	O
rectiﬁed	O
using	O
the	O
homography	B
(	O
10.2	O
)	O
.	O
(	O
b	O
)	O
shows	O
two	O
orthographic	O
views	O
of	O
the	O
wireframe	O
afﬁne	B
reconstruction	I
.	O
note	O
that	O
parallel	B
scene	O
lines	B
are	O
parallel	B
in	O
the	O
reconstruction	B
,	O
but	O
lines	B
that	O
are	O
perpendicular	O
in	O
the	O
scene	O
are	O
not	O
perpendicular	O
in	O
the	O
reconstruction	B
.	O
3-space	O
point	B
x	O
can	O
be	O
neatly	O
expressed	O
algebraically	O
as	O
the	O
solution	B
of	O
the	O
equations	O
(	O
[	O
v	O
]	O
×p	O
)	O
x	O
=	O
0	O
and	O
(	O
l	O
(	O
cid:2	O
)	O
tp	O
(	O
cid:2	O
)	O
)	O
x	O
=	O
0.	O
these	O
equations	O
expresses	O
the	O
fact	O
that	O
x	O
maps	O
to	O
v	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
to	O
a	O
point	B
on	O
l	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
image	O
.	O
distance	B
ratios	I
on	O
a	O
line	B
.	O
an	O
alternative	O
to	O
computing	O
vanishing	B
points	I
as	O
the	O
in-	O
tersection	O
of	O
imaged	O
parallel	B
scene	O
lines	B
is	O
to	O
use	O
knowledge	O
of	O
afﬁne	O
length	O
ratios	O
in	O
the	O
scene	O
.	O
for	O
example	O
,	O
given	O
two	O
intervals	O
on	B
a	I
line	I
with	O
a	O
known	O
length	O
ratio	O
,	O
the	O
point	B
at	O
inﬁnity	O
on	O
the	O
line	B
may	O
be	O
determined	O
.	O
this	O
means	O
that	O
from	O
an	O
image	O
of	O
a	O
line	B
on	O
which	O
a	O
world	O
distance	B
ratio	I
is	O
known	O
,	O
for	O
example	O
that	O
three	O
points	O
are	O
equally	O
spaced	O
,	O
the	O
vanishing	O
point	O
may	O
be	O
determined	O
.	O
this	O
computation	B
,	O
and	O
other	O
means	O
of	O
computing	O
vanishing	B
points	I
and	O
vanishing	B
lines	I
,	O
are	O
described	O
in	O
section	O
2.7	O
(	O
p47	O
)	O
.	O
the	O
inﬁnite	B
homography	I
once	O
the	O
plane	O
at	O
inﬁnity	O
has	O
been	O
located	O
,	O
so	O
that	O
we	O
have	O
an	O
afﬁne	B
reconstruction	I
,	O
then	O
we	O
also	O
have	O
an	O
image-to-image	O
map	O
called	O
the	O
“	O
inﬁnite	B
homography	I
”	O
.	O
this	O
map	O
,	O
which	O
is	O
a	O
2d	O
homography	B
,	O
is	O
described	O
in	O
greater	O
detail	O
in	O
chapter	O
13.	O
brieﬂy	O
,	O
it	O
is	O
the	O
map	O
that	O
transfers	O
points	O
from	O
the	O
p	O
image	O
to	O
the	O
p	O
(	O
cid:2	O
)	O
image	O
via	O
the	O
plane	O
at	O
inﬁnity	O
as	O
follows	O
:	O
the	O
ray	O
corresponding	O
to	O
a	O
point	B
x	O
is	O
extended	O
to	O
meet	O
the	O
plane	O
at	O
inﬁnity	O
in	O
a	O
point	B
x	O
;	O
this	O
point	B
is	O
projected	O
to	O
a	O
point	B
x	O
(	O
cid:2	O
)	O
in	O
the	O
other	O
image	O
.	O
the	O
homography	B
from	O
x	O
to	O
x	O
(	O
cid:2	O
)	O
having	O
an	O
afﬁne	B
reconstruction	I
is	O
equivalent	B
to	O
knowing	O
the	O
inﬁnite	B
homography	I
as	O
will	O
now	O
be	O
shown	O
.	O
given	O
two	O
cameras	O
p	O
=	O
[	O
m	O
|	O
m	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
]	O
of	O
an	O
afﬁne	B
reconstruction	I
,	O
the	O
inﬁnite	B
homography	I
is	O
given	O
by	O
h∞	O
=	O
m	O
(	O
cid:2	O
)	O
m−1	O
.	O
this	O
is	O
because	O
a	O
=	O
m	O
(	O
cid:2	O
)	O
˜x	O
point	B
x	O
=	O
(	O
˜xt	O
=	O
m	O
(	O
cid:2	O
)	O
m−1x	O
for	O
points	O
on	O
π∞	O
.	O
furthermore	O
,	O
it	O
may	O
be	O
veriﬁed	O
that	O
in	O
the	O
other	O
,	O
so	O
x	O
(	O
cid:2	O
)	O
,	O
0	O
)	O
t	O
on	O
the	O
plane	O
at	O
inﬁnity	O
maps	O
to	O
x	O
=	O
m	O
˜x	O
in	B
one	I
image	I
and	O
x	O
(	O
cid:2	O
)	O
=	O
[	O
m	O
(	O
cid:2	O
)	O
|	O
m	O
(	O
cid:2	O
)	O
is	O
written	O
as	O
x	O
(	O
cid:2	O
)	O
=	O
h∞x	O
.	O
10.4	O
stratiﬁed	B
reconstruction	I
271	O
this	O
is	O
unchanged	O
by	O
a	O
3-space	O
afﬁne	B
transformation	I
of	O
the	O
cameras	B
.	O
hence	O
,	O
the	O
inﬁnite	B
homography	I
may	O
be	O
computed	O
explicitly	O
from	O
an	O
afﬁne	B
reconstruction	I
,	O
and	O
vice	O
versa	O
:	O
=	O
[	O
m	O
(	O
cid:2	O
)	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
.	O
=	O
[	O
h∞	O
|	O
e	O
(	O
cid:2	O
)	O
result	O
10.3.	O
if	O
an	O
afﬁne	B
reconstruction	I
has	O
been	O
obtained	O
in	O
which	O
the	O
camera	B
matrices	I
are	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
]	O
,	O
then	O
the	O
inﬁnite	B
homography	I
is	O
given	O
by	O
h∞	O
=	O
m	O
(	O
cid:2	O
)	O
.	O
conversely	O
,	O
if	O
the	O
inﬁnite	B
homography	I
h∞	O
has	O
been	O
obtained	O
,	O
then	O
the	O
cameras	B
of	O
an	O
afﬁne	B
reconstruction	I
may	O
be	O
chosen	O
as	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
the	O
inﬁnite	B
homography	I
may	O
be	O
computed	O
directly	O
from	O
corresponding	O
image	O
en-	O
tities	O
,	O
rather	O
than	O
indirectly	O
from	O
an	O
afﬁne	B
reconstruction	I
.	O
for	O
example	O
,	O
h∞	O
can	O
be	O
computed	O
from	O
the	O
correspondence	B
of	O
three	O
vanishing	B
points	I
together	O
with	O
f	O
,	O
or	O
the	O
correspondence	B
of	O
a	O
vanishing	O
line	O
and	O
vanishing	O
point	O
,	O
together	O
with	O
f.	O
the	O
correct	O
numerical	O
procedure	O
for	O
these	O
computations	O
is	O
given	O
in	O
chapter	O
13.	O
however	O
,	O
such	O
direct	O
computations	O
are	O
completely	O
equivalent	B
to	O
determining	B
π∞	O
in	O
a	O
projective	B
re-	O
construction	O
.	O
one	O
of	O
the	O
cameras	O
is	O
afﬁne	B
another	O
important	O
case	O
in	O
which	O
afﬁne	B
reconstruction	I
is	O
possible	O
is	O
when	O
one	O
of	O
the	O
cameras	O
is	O
known	O
to	O
be	O
an	O
afﬁne	B
camera	I
as	O
deﬁned	O
in	O
section	O
6.3.1	O
(	O
p166	O
)	O
.	O
to	O
see	O
that	O
this	O
implies	O
that	O
afﬁne	B
reconstruction	I
is	O
possible	O
,	O
refer	O
to	O
section	O
6.3.5	O
(	O
p172	O
)	O
where	O
it	O
was	O
shown	O
that	O
the	O
principal	B
plane	I
of	O
an	O
afﬁne	B
camera	I
is	O
the	O
plane	O
at	O
inﬁnity	O
.	O
hence	O
to	O
convert	O
a	O
projective	B
reconstruction	I
to	O
an	O
afﬁne	B
reconstruction	I
,	O
it	O
is	O
sufﬁcient	O
to	O
ﬁnd	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
supposed	O
to	O
be	O
afﬁne	B
and	O
map	O
it	O
to	O
the	O
plane	B
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
recall	O
(	O
section	O
6.2	O
(	O
p158	O
)	O
)	O
that	O
the	O
principal	B
plane	I
of	O
a	O
camera	B
is	O
simply	O
the	O
third	O
row	O
of	O
the	O
camera	B
matrix	I
.	O
for	O
example	O
,	O
consider	O
a	O
projective	B
reconstruction	I
with	O
camera	B
matrices	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
,	O
for	O
which	O
the	O
ﬁrst	O
camera	B
is	O
supposed	O
to	O
be	O
afﬁne	B
.	O
to	O
map	O
the	O
third	O
row	O
of	O
p	O
to	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
it	O
is	O
sufﬁcient	O
to	O
swap	O
the	O
last	O
two	O
columns	O
of	O
the	O
two	O
camera	B
matrices	I
,	O
while	O
at	O
the	O
same	O
time	O
swapping	O
the	O
3rd	O
and	O
4th	O
coordinates	B
of	O
each	O
xi	O
.	O
this	O
is	O
a	O
projective	B
transformation	I
corresponding	O
to	O
a	O
permutation	O
matrix	B
h.	O
this	O
shows	O
:	O
,	O
{	O
xi	O
}	O
)	O
be	O
a	O
projective	B
reconstruction	I
from	O
a	O
set	O
of	O
point	O
corre-	O
result	O
10.4.	O
let	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
spondences	O
for	O
which	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
.	O
suppose	O
in	O
truth	O
,	O
p	O
is	O
known	O
to	O
be	O
an	O
afﬁne	B
camera	I
,	O
then	O
an	O
afﬁne	B
reconstruction	I
is	O
obtained	O
by	O
swapping	O
the	O
last	O
two	O
columns	O
of	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
and	O
the	O
last	O
two	O
coordinates	O
of	O
each	O
xi	O
.	O
note	O
that	O
the	O
condition	O
that	O
one	O
of	O
the	O
cameras	O
is	O
afﬁne	B
places	O
no	O
restriction	O
on	O
the	O
fundamental	B
matrix	I
,	O
since	O
any	O
canonical	O
camera	O
pair	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
can	O
be	O
transformed	O
to	O
a	O
pair	O
in	O
which	O
p	O
is	O
afﬁne	B
.	O
if	O
both	O
the	O
cameras	B
are	O
known	O
to	O
be	O
afﬁne	B
,	O
then	O
it	O
will	O
be	O
seen	O
that	O
the	O
fundamental	B
matrix	I
has	O
the	O
restricted	O
form	O
given	O
in	O
(	O
14.1–	O
p345	O
)	O
.	O
in	O
this	O
case	O
,	O
for	O
numerical	O
stability	B
,	O
one	O
must	O
solve	O
for	O
the	O
fundamental	B
matrix	I
enforcing	O
this	O
special	O
form	O
of	O
the	O
fundamental	O
matrix	B
.	O
of	O
course	O
there	O
is	O
no	O
such	O
thing	O
as	O
a	O
real	O
afﬁne	B
camera	I
–	O
the	O
afﬁne	B
camera	I
model	O
is	O
an	O
approximation	O
which	O
is	O
only	O
valid	O
when	O
the	O
set	O
of	B
points	I
seen	O
in	O
the	O
image	O
has	O
small	O
depth	O
variation	O
compared	O
with	O
the	O
distance	B
from	O
the	O
camera	B
.	O
nevertheless	O
,	O
an	O
assumption	O
of	O
an	O
afﬁne	B
camera	I
may	O
be	O
useful	O
to	O
effect	O
the	O
signiﬁcant	O
restriction	O
from	O
projective	O
to	O
afﬁne	O
reconstruction	B
.	O
272	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
10.4.2	O
the	O
step	O
to	O
metric	O
reconstruction	B
just	O
as	O
the	O
key	O
to	O
afﬁne	O
reconstruction	B
is	O
the	O
identiﬁcation	O
of	O
the	O
plane	O
at	B
inﬁnity	I
,	O
the	O
key	O
to	O
metric	O
reconstruction	B
is	O
the	O
identiﬁcation	O
of	O
the	O
absolute	O
conic	B
(	O
section	O
3.6-	O
(	O
p81	O
)	O
)	O
.	O
since	O
the	O
absolute	O
conic	O
,	O
ω∞	O
,	O
is	O
a	O
planar	O
conic	O
,	O
lying	O
in	O
the	O
plane	O
at	O
inﬁnity	O
,	O
identifying	O
the	O
absolute	O
conic	O
implies	O
identifying	O
the	O
plane	O
at	O
inﬁnity	O
.	O
in	O
a	O
stratiﬁed	O
approach	O
,	O
one	O
proceeds	O
from	O
projective	O
to	O
afﬁne	O
to	O
metric	O
reconstruc-	O
tion	O
,	O
so	O
one	O
knows	O
the	O
plane	O
at	O
inﬁnity	O
before	O
ﬁnding	O
the	O
absolute	O
conic	O
.	O
suppose	O
one	O
has	O
identiﬁed	O
the	O
absolute	O
conic	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
in	O
principle	O
the	O
next	O
step	O
is	O
to	O
apply	O
an	O
afﬁne	B
transformation	I
to	O
the	O
afﬁne	B
reconstruction	I
such	O
that	O
the	O
identiﬁed	O
absolute	O
conic	O
is	O
mapped	O
to	O
the	O
absolute	O
conic	O
in	O
the	O
standard	O
euclidean	O
frame	O
(	O
it	O
will	O
3	O
=	O
0	O
,	O
on	O
π∞	O
)	O
.	O
the	O
resulting	O
reconstruction	B
is	O
then	O
have	O
the	O
equation	O
x2	O
then	O
related	O
to	O
the	O
true	O
reconstruction	B
by	O
a	O
projective	B
transformation	I
which	O
ﬁxes	O
the	O
absolute	O
conic	O
.	O
it	O
follows	O
from	O
result	O
3.9	O
(	O
p82	O
)	O
that	O
the	O
projective	B
transformation	I
is	O
a	O
similarity	B
transformation	I
,	O
so	O
we	O
have	O
achieved	O
a	O
metric	B
reconstruction	I
.	O
1	O
+	O
x2	O
2	O
+	O
x2	O
in	O
practice	O
the	O
easiest	O
way	O
to	O
accomplish	O
this	O
is	O
to	O
consider	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
in	O
one	O
of	O
the	O
images	O
.	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
(	O
as	O
any	O
conic	B
)	O
is	O
a	O
conic	B
in	O
the	O
image	O
.	O
the	O
back-projection	B
of	O
this	O
conic	B
is	O
a	O
cone	O
,	O
which	O
will	O
meet	O
the	O
plane	O
at	O
inﬁnity	O
in	O
a	O
single	O
conic	O
,	O
which	O
therefore	O
deﬁnes	O
the	O
absolute	O
conic	O
.	O
remember	O
that	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
is	O
a	O
property	O
of	O
the	O
image	O
itself	O
,	O
and	O
like	O
any	O
image	O
point	O
,	O
line	B
or	O
other	O
feature	O
,	O
is	O
not	O
dependent	O
on	O
any	O
particular	O
reconstruction	B
,	O
hence	O
it	O
is	O
unchanged	O
by	O
3d	O
transformations	B
of	I
the	O
reconstruction	B
.	O
suppose	O
that	O
in	O
the	O
afﬁne	B
reconstruction	I
the	O
image	B
of	I
the	I
absolute	I
conic	I
as	O
seen	O
by	O
the	O
camera	B
with	O
matrix	B
p	O
=	O
[	O
m	O
|	O
m	O
]	O
is	O
a	O
conic	B
ω.	O
we	O
will	O
show	O
how	O
ω	O
may	O
be	O
used	O
to	O
deﬁne	O
the	O
homography	B
h	O
which	O
transforms	O
the	O
afﬁne	B
reconstruction	I
to	O
a	O
metric	B
reconstruction	I
:	O
result	O
10.5.	O
suppose	O
that	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
is	O
known	O
in	O
some	O
image	O
to	O
be	O
ω	O
,	O
and	O
one	O
has	O
an	O
afﬁne	B
reconstruction	I
in	O
which	O
the	O
corresponding	O
camera	B
matrix	I
is	O
given	O
by	O
p	O
=	O
[	O
m	O
|	O
m	O
]	O
.	O
then	O
,	O
the	O
afﬁne	B
reconstruction	I
may	O
be	O
transformed	O
to	O
a	O
metric	B
reconstruction	I
by	O
applying	O
a	O
3d	O
transformation	B
of	O
the	O
form	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
h	O
=	O
a−1	O
1	O
where	O
a	O
is	O
obtained	O
by	O
cholesky	O
factorization	B
from	O
the	O
equation	O
aat	O
=	O
(	O
mtωm	O
)	O
−1	O
.	O
proof	O
.	O
under	O
the	O
transformation	B
h	O
,	O
the	O
camera	B
matrix	I
p	O
is	O
transformed	O
to	O
a	O
matrix	B
(	O
cid:17	O
)	O
pm	O
=	O
ph−1	O
=	O
[	O
mm	O
|	O
mm	O
]	O
.	O
if	O
h−1	O
is	O
of	O
the	O
form	O
(	O
cid:18	O
)	O
h−1	O
=	O
a	O
0	O
0t	O
1	O
then	O
mm	O
=	O
ma	O
.	O
however	O
,	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
is	O
related	O
to	O
the	O
camera	B
matrix	I
pm	O
of	O
a	O
euclidean	O
frame	O
by	O
the	O
relationship	O
ω∗	O
=	O
mmmt	O
m	O
.	O
10.4	O
stratiﬁed	B
reconstruction	I
273	O
this	O
is	O
because	O
the	O
camera	B
matrix	I
may	O
be	O
decomposed	O
as	O
mm	O
=	O
kr	O
,	O
and	O
from	O
(	O
8.11–	O
p210	O
)	O
ω∗	O
=	O
ω−1	O
=	O
kkt	O
.	O
combining	O
this	O
with	O
mm	O
=	O
ma	O
gives	O
ω−1	O
=	O
maatmt	O
,	O
which	O
−1	O
.	O
a	O
particular	O
value	O
of	O
a	O
that	O
satisﬁes	O
this	O
may	O
be	O
rearranged	O
as	O
aat	O
=	O
(	O
mtωm	O
)	O
−1	O
.	O
this	O
latter	O
relationship	O
is	O
found	O
by	O
taking	O
the	O
cholesky	O
factorization	B
of	O
(	O
mtωm	O
)	O
matrix	B
is	O
guaranteed	O
to	O
be	O
positive-deﬁnite	O
(	O
see	O
result	O
a4.5	O
(	O
p582	O
)	O
)	O
,	O
otherwise	O
no	O
such	O
matrix	B
a	O
will	O
exist	O
,	O
and	O
metric	B
reconstruction	I
will	O
not	O
be	O
possible	O
.	O
this	O
approach	O
to	O
metric	O
reconstruction	B
relies	O
on	O
identifying	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
.	O
there	O
are	O
various	O
ways	O
of	O
doing	O
this	O
and	O
these	O
are	O
discussed	O
next	O
.	O
three	O
sources	O
of	O
constraint	O
on	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
are	O
given	O
,	O
and	O
in	O
practice	O
a	O
combination	O
of	O
these	O
constraints	B
is	O
used	O
.	O
1.	O
constraints	B
arising	O
from	B
scene	I
orthogonality	I
.	O
pairs	O
of	O
vanishing	O
points	O
,	O
v1	O
and	O
v2	O
,	O
arising	O
from	O
orthogonal	O
scene	O
lines	O
place	O
a	O
single	O
linear	O
constraint	O
on	O
ω	O
:	O
vt	O
1	O
ωv2	O
=	O
0.	O
similarly	O
,	O
a	O
vanishing	O
point	O
v	O
and	O
a	O
vanishing	O
line	O
l	O
arising	O
from	O
a	O
direction	O
and	O
plane	B
which	O
are	O
orthogonal	B
place	O
two	O
constraints	O
on	O
ω	O
:	O
l	O
=	O
ωv	O
.	O
a	O
common	O
example	O
is	O
the	O
vanishing	O
point	O
for	O
the	O
vertical	O
direction	O
and	O
a	O
vanishing	O
line	O
from	O
the	O
horizontal	O
ground	O
plane	O
.	O
finally	O
an	O
imaged	O
scene	O
plane	O
containing	O
metric	B
information	O
,	O
such	O
as	O
a	O
square	O
grid	O
,	O
places	O
two	O
constraints	O
on	O
ω	O
.	O
2.	O
constraints	B
arising	O
from	O
known	O
internal	B
parameters	I
.	O
if	O
the	O
calibration	B
matrix	I
of	O
a	O
camera	B
is	O
equal	O
to	O
k	O
,	O
then	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
is	O
ω	O
=	O
k−tk−1	O
.	O
thus	O
,	O
knowledge	O
of	O
the	O
internal	O
parameters	B
(	O
6.10–p157	O
)	O
contained	O
in	O
k	O
may	O
be	O
used	O
to	O
con-	O
strain	O
or	O
determine	O
the	O
elements	O
of	O
ω.	O
in	O
the	O
case	O
where	O
k	O
is	O
known	O
to	O
have	O
zero	B
skew	I
(	O
s	O
=	O
0	O
)	O
,	O
and	O
if	O
the	O
pixels	O
are	O
square	O
(	O
zero	B
skew	I
and	O
αx	O
=	O
αy	O
)	O
then	O
ω12	O
=	O
ω21	O
=	O
0	O
ω11	O
=	O
ω22	O
.	O
these	O
ﬁrst	O
two	O
sources	O
of	O
constraint	O
are	O
discussed	O
in	O
detail	O
in	O
section	O
8.8	O
(	O
p223	O
)	O
on	O
single	O
view	O
calibration	B
,	O
where	O
examples	B
are	O
given	O
of	O
calibrating	O
a	O
camera	B
solely	O
from	O
such	O
information	O
.	O
here	O
there	O
is	O
an	O
additional	O
source	O
of	O
constraints	O
available	O
arising	O
from	O
the	O
multiple	O
views	O
.	O
3.	O
constraints	B
arising	O
from	O
the	O
same	O
cameras	O
in	O
all	O
images	O
.	O
one	O
of	O
the	O
properties	O
of	O
the	O
absolute	O
conic	B
is	O
that	O
its	O
projection	B
into	O
an	O
image	O
depends	O
only	O
on	O
the	O
calibration	B
matrix	I
of	O
the	O
camera	B
,	O
and	O
not	O
on	O
the	O
position	O
or	O
orientation	B
of	O
the	O
camera	B
.	O
in	O
the	O
case	O
where	O
both	O
cameras	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
have	O
the	O
same	O
calibration	O
matrix	B
(	O
usually	O
meaning	O
that	O
both	O
the	O
images	O
were	O
taken	O
with	O
the	O
same	O
camera	O
with	O
different	O
pose	O
)	O
one	O
has	O
that	O
ω	O
=	O
ω	O
(	O
cid:2	O
)	O
,	O
that	O
is	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
is	O
the	O
same	O
in	O
both	B
images	I
.	O
given	O
274	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
a	O
b	O
fig	O
.	O
10.5.	O
metric	B
reconstruction	I
.	O
the	O
afﬁne	B
reconstruction	I
of	O
ﬁgure	O
10.4	O
is	O
upgraded	O
to	O
metric	O
by	O
computing	B
the	O
image	B
of	I
the	I
absolute	I
conic	I
.	O
the	O
information	O
used	O
is	O
the	O
orthogonality	B
of	O
the	O
directions	O
of	O
the	O
parallel	O
line	B
sets	O
shown	O
in	O
ﬁgure	O
10.4	O
,	O
together	O
with	O
the	O
constraint	O
that	O
both	B
images	I
have	O
square	O
pixels	O
.	O
the	O
square	O
pixel	O
constraint	O
is	O
transferred	O
from	O
one	O
image	O
to	O
the	O
other	O
using	O
h∞	O
.	O
(	O
a	O
)	O
two	B
views	I
of	O
the	O
metric	B
reconstruction	I
.	O
lines	B
which	O
are	O
perpendicular	O
in	O
the	O
scene	O
are	O
perpendicular	O
in	O
the	O
reconstruction	B
and	O
also	O
the	O
aspect	O
ratio	O
of	O
the	O
sides	O
of	O
the	O
house	O
is	O
veridical	O
.	O
(	O
b	O
)	O
two	B
views	I
of	O
a	O
texture	O
mapped	O
piecewise	O
planar	O
model	O
built	O
from	O
the	O
wireframes	O
.	O
sufﬁciently	O
many	O
images	O
,	O
one	O
may	O
use	O
this	O
property	O
to	O
obtain	O
a	O
metric	B
reconstruction	I
from	O
an	O
afﬁne	B
reconstruction	I
.	O
this	O
method	O
of	O
metric	O
reconstruction	B
,	O
and	O
its	O
use	O
for	O
self-calibration	O
of	O
a	O
camera	O
,	O
will	O
be	O
treated	O
in	O
greater	O
detail	O
in	O
chapter	O
19.	O
for	O
now	O
,	O
we	O
give	O
just	O
the	O
general	O
principle	O
.	O
since	O
the	O
absolute	O
conic	O
lies	O
on	O
the	O
plane	O
at	O
inﬁnity	O
,	O
its	O
image	O
may	O
be	O
transferred	O
from	O
one	O
view	O
to	O
the	O
other	O
via	B
the	I
inﬁnite	I
homography	I
.	O
this	O
implies	O
an	O
equation	O
(	O
see	O
result	O
2.13	O
(	O
p37	O
)	O
)	O
ω	O
(	O
cid:2	O
)	O
=	O
h−t∞	O
ωh−1∞	O
(	O
10.3	O
)	O
where	O
ω	O
and	O
ω	O
(	O
cid:2	O
)	O
are	O
images	O
of	O
ω∞	O
in	O
the	O
two	B
views	I
.	O
in	O
forming	O
these	O
equations	O
it	O
is	O
necessary	O
to	O
have	O
an	O
afﬁne	B
reconstruction	I
already	O
,	O
since	O
the	O
inﬁnite	B
homography	I
must	O
be	O
known	O
.	O
if	O
ω	O
=	O
ω	O
(	O
cid:2	O
)	O
,	O
then	O
(	O
10.3	O
)	O
gives	O
a	O
set	O
of	O
linear	O
equations	O
in	O
the	O
entries	O
of	O
ω.	O
in	O
general	O
this	O
set	O
of	O
linear	O
equations	O
places	O
four	O
constraints	O
on	O
ω	O
,	O
and	O
since	O
ω	O
has	O
5	O
de-	O
grees	O
of	O
freedom	O
it	O
is	O
not	O
completely	O
determined	O
.	O
however	O
,	O
by	O
combining	O
these	O
linear	B
equations	I
with	O
those	O
above	O
provided	O
by	O
scene	B
orthogonality	I
or	O
known	O
internal	O
param-	O
eters	O
,	O
ω	O
may	O
be	O
determined	O
uniquely	O
.	O
indeed	O
(	O
10.3	O
)	O
may	O
be	O
used	O
to	O
transfer	O
constraints	B
on	O
ω	O
to	O
constraints	O
on	O
ω	O
(	O
cid:2	O
)	O
.	O
figure	O
10.5	O
shows	O
an	O
example	O
of	O
a	O
metric	O
reconstruction	B
computed	O
by	O
combining	O
constraints	B
in	O
this	O
manner	O
.	O
10.5	O
direct	O
reconstruction	O
–	O
using	O
ground	O
truth	O
275	O
10.4.3	O
direct	O
metric	O
reconstruction	O
using	O
ω	O
the	O
previous	O
discussion	O
showed	O
how	O
knowledge	O
of	O
the	O
image	O
of	O
the	O
absolute	O
conic	B
(	O
iac	O
)	O
may	O
be	O
used	O
to	O
transform	O
an	O
afﬁne	B
to	O
a	O
metric	B
reconstruction	I
.	O
however	O
,	O
knowing	O
ω	O
it	O
is	O
possible	O
to	O
proceed	O
directly	O
to	O
metric	O
reconstruction	B
,	O
given	O
at	O
least	O
two	B
views	I
.	O
this	O
can	O
be	O
accomplished	O
in	O
at	O
least	O
two	O
different	O
ways	O
.	O
the	O
most	O
evident	O
approach	O
is	O
to	O
use	O
the	O
iac	O
to	O
compute	O
calibration	B
of	O
each	O
of	O
the	O
cameras	O
,	O
and	O
then	O
carry	O
out	O
a	O
calibrated	B
reconstruction	O
.	O
this	O
method	O
relies	O
on	O
the	O
connection	O
of	O
ω	O
to	O
the	O
calibration	B
matrix	I
k	O
,	O
namely	O
−1	O
.	O
thus	O
one	O
can	O
compute	O
k	O
from	O
ω	O
by	O
inverting	O
it	O
and	O
then	O
applying	O
ω	O
=	O
(	O
kkt	O
)	O
cholesky	O
factorization	B
to	O
obtain	O
k.	O
if	O
the	O
iac	O
is	O
known	O
in	O
each	O
image	O
,	O
then	O
both	O
cameras	O
may	O
be	O
calibrated	B
in	O
this	O
way	O
.	O
next	O
with	O
calibrated	O
cameras	B
,	O
a	O
metric	B
recon-	O
struction	O
of	O
the	O
scene	O
may	O
be	O
computed	O
using	O
the	O
essential	B
matrix	I
,	O
as	O
in	O
section	O
9.6.	O
note	O
that	O
four	O
possible	O
solutions	O
may	O
result	O
.	O
two	O
of	O
these	O
are	O
just	O
mirror	O
images	O
,	O
but	O
the	O
other	O
two	O
are	O
different	O
,	O
forming	O
a	O
twisted	B
pair	I
.	O
(	O
though	O
all	O
solutions	O
but	O
one	O
may	O
be	O
ruled	B
out	O
by	O
consideration	O
of	B
points	I
lying	O
in	O
front	O
of	O
the	O
cameras	O
.	O
)	O
a	O
more	O
conceptual	O
approach	O
to	O
metric	O
reconstruction	B
is	O
to	O
use	O
knowledge	O
of	O
the	O
iac	O
to	O
directly	O
determine	O
the	O
plane	O
at	O
inﬁnity	O
and	O
the	O
absolute	O
conic	O
.	O
knowing	O
the	O
camera	B
matrices	I
p	O
and	O
p	O
(	O
cid:2	O
)	O
in	O
a	O
projective	B
frame	O
,	O
and	O
a	O
conic	B
(	O
speciﬁcally	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
)	O
in	O
each	O
image	O
,	O
then	O
ω∞	O
may	O
be	O
explicitly	O
computed	O
in	O
3-space	O
.	O
this	O
is	O
achieved	O
by	O
back-projecting	O
the	O
conics	O
to	O
cones	O
,	O
which	O
must	O
intersect	O
in	O
the	O
absolute	O
conic	O
.	O
thus	O
,	O
ω∞	O
and	O
its	O
support	O
plane	B
π∞	O
are	O
determined	O
(	O
see	O
exercise	O
(	O
x	O
)	O
on	O
page	O
342	O
for	O
an	O
algebraic	B
solution	I
)	O
.	O
however	O
,	O
two	O
cones	O
will	O
in	O
general	O
intersect	O
in	O
two	O
different	O
plane	B
conics	O
,	O
each	O
lying	O
in	O
a	O
different	O
support	O
plane	B
.	O
thus	O
there	O
are	O
two	O
possible	O
solutions	O
for	O
the	O
absolute	O
conic	O
,	O
which	O
one	O
can	O
identify	O
as	O
belonging	O
to	O
the	O
two	O
different	O
reconstructions	O
constituting	O
the	O
twisted	B
pair	I
ambiguity	O
.	O
10.5	O
direct	O
reconstruction	O
–	O
using	O
ground	O
truth	O
it	O
is	O
possible	O
to	O
jump	O
directly	O
from	O
a	O
projective	B
reconstruction	I
to	O
a	O
metric	B
reconstruc-	O
tion	O
if	O
“	O
ground	O
control	O
points	O
”	O
(	O
that	O
is	O
points	O
with	O
known	O
3d	O
locations	O
in	O
a	O
euclidean	O
world	O
frame	O
)	O
are	O
given	O
.	O
suppose	O
we	O
have	O
a	O
set	O
of	O
n	O
such	O
ground	O
control	O
points	O
{	O
xei	O
}	O
which	O
are	O
imaged	O
at	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i.	O
we	O
wish	O
to	O
use	O
these	O
points	O
to	O
transform	O
the	O
projective	B
reconstruction	I
to	O
metric	B
.	O
the	O
3d	O
location	O
{	O
xi	O
}	O
of	O
the	O
control	O
points	O
in	O
the	O
projective	B
reconstruction	I
may	O
be	O
computed	O
from	O
their	O
image	O
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i.	O
since	O
the	O
projective	B
reconstruc-	O
tion	O
is	O
related	O
by	O
a	O
homography	B
to	O
the	O
true	O
reconstruction	B
we	O
then	O
have	O
from	O
(	O
10.1	O
)	O
the	O
equations	O
:	O
xei	O
=	O
hxi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n.	O
each	O
point	B
correspondence	O
provides	O
3	O
linearly	O
independent	O
equations	O
on	O
the	O
elements	O
of	O
h	O
,	O
and	O
since	O
h	O
has	O
15	O
degrees	B
of	I
freedom	I
a	O
linear	B
solution	I
is	O
obtained	O
provided	O
n	O
≥	O
5	O
(	O
and	O
no	O
four	O
of	O
the	O
control	O
points	O
are	O
coplanar	O
)	O
.	O
this	O
computation	B
,	O
and	O
the	O
proper	O
numerical	O
procedures	O
,	O
are	O
described	O
in	O
chapter	O
4.	O
alternatively	O
,	O
one	O
may	O
bypass	O
the	O
computation	B
of	I
the	O
xi	O
and	O
compute	O
h	O
by	O
relating	O
276	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
a	O
b	O
c	O
fig	O
.	O
10.6.	O
direct	O
reconstruction	O
.	O
the	O
projective	B
reconstruction	I
of	O
ﬁgure	O
10.3	O
may	O
be	O
upgraded	O
to	O
metric	O
by	O
specifying	O
the	O
position	O
of	O
ﬁve	O
(	O
or	O
more	O
)	O
world	O
points	O
:	O
(	O
a	O
)	O
the	O
ﬁve	O
points	O
used	O
;	O
(	O
b	O
)	O
the	O
cor-	O
responding	O
points	O
on	O
the	O
projective	B
reconstruction	I
of	O
ﬁgure	O
10.3	O
;	O
(	O
c	O
)	O
the	O
reconstruction	B
after	O
the	O
ﬁve	O
points	O
are	O
mapped	O
to	O
their	O
world	O
positions	O
.	O
the	O
known	O
ground	O
control	O
points	O
directly	O
to	O
image	O
measurements	O
.	O
thus	O
as	O
in	O
the	O
dlt	O
algorithm	B
for	O
camera	B
resection	O
(	O
section	O
7.1	O
(	O
p178	O
)	O
)	O
the	O
equation	O
xi	O
=	O
ph−1xei	O
provides	O
two	O
linearly	O
independent	O
equations	O
in	O
the	O
entries	O
of	O
the	O
unknown	O
h−1	O
,	O
all	O
other	O
quantities	O
being	O
known	O
.	O
similarly	O
equations	O
may	O
be	O
derived	O
from	O
the	O
other	O
image	O
if	O
x	O
(	O
cid:2	O
)	O
i	O
is	O
known	O
.	O
it	O
is	O
not	O
necessary	O
for	O
the	O
ground	O
control	O
points	O
to	O
be	O
visible	O
in	B
both	I
images	I
.	O
note	O
however	O
that	O
if	O
both	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
visible	O
for	O
a	O
given	O
control	O
point	B
xei	O
then	O
because	O
of	O
the	O
coplanarity	O
constraint	O
on	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
,	O
the	O
four	O
equations	O
generated	O
in	O
this	O
way	O
contain	O
only	O
three	O
independent	O
ones	O
.	O
once	O
h	O
has	O
been	O
computed	O
it	O
may	O
be	O
used	O
to	O
transform	O
the	O
cameras	B
p	O
,	O
p	O
(	O
cid:2	O
)	O
of	O
the	O
projective	O
reconstruction	B
to	O
their	O
true	O
euclidean	O
counterparts	O
.	O
an	O
example	O
of	O
metric	O
structure	B
computed	O
by	O
this	O
direct	O
method	O
is	O
shown	O
in	O
ﬁgure	O
10.6	O
.	O
10.6	O
closure	O
in	O
this	O
chapter	O
we	O
have	O
overviewed	O
the	O
steps	O
necessary	O
to	O
produce	O
a	O
metric	B
reconstruc-	O
tion	O
from	O
a	O
pair	O
of	O
images	O
.	O
this	O
overview	O
is	O
summarized	O
in	O
algorithm	O
10.1	O
,	O
and	O
the	O
computational	O
procedures	O
for	O
these	O
steps	O
are	O
described	O
in	O
the	O
following	O
chapters	O
.	O
as	O
usual	O
the	O
general	O
discussion	O
has	O
been	O
restricted	O
mainly	O
to	O
points	O
,	O
but	O
the	O
ideas	O
(	O
trian-	O
gulation	O
,	O
ambiguity	B
,	O
stratiﬁcation	B
)	O
apply	O
equally	O
to	O
other	O
image	O
features	O
such	O
as	O
lines	O
,	O
conics	O
etc	O
.	O
it	O
has	O
been	O
seen	O
that	O
for	O
a	O
metric	O
reconstruction	B
it	O
is	O
necessary	O
to	O
identify	O
two	O
enti-	O
ties	O
in	O
the	O
projective	B
frame	O
;	O
these	O
are	O
the	O
plane	O
at	O
inﬁnity	O
π∞	O
(	O
for	O
afﬁne	O
)	O
,	O
together	O
with	O
the	O
absolute	O
conic	O
ω∞	O
(	O
for	O
metric	O
)	O
.	O
conversely	O
,	O
given	O
f	O
and	O
a	O
pair	O
of	O
calibrated	O
cam-	O
eras	O
then	O
π∞	O
and	O
ω∞	O
may	O
be	O
explicitly	O
computed	O
in	O
3-space	O
.	O
these	O
entities	O
each	O
have	O
an	O
image-based	O
counterpart	O
:	O
speciﬁcation	O
of	O
the	O
inﬁnite	O
homography	B
,	O
h∞	O
,	O
is	O
equiva-	O
lent	O
to	O
specifying	O
π∞	O
in	O
3-space	O
;	O
and	O
specifying	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
ω	O
,	O
in	O
each	O
view	O
is	O
equivalent	B
to	O
specifying	O
π∞	O
and	O
ω∞	O
in	O
3-space	O
.	O
this	O
equivalence	O
is	O
summarized	O
in	O
table	O
10.1.	O
finally	O
,	O
it	O
is	O
worth	O
noting	O
that	O
if	O
metric	B
precision	O
is	O
not	O
the	O
goal	O
then	O
an	O
accept-	O
able	O
metric	B
reconstruction	I
is	O
generally	O
obtained	O
directly	O
from	O
the	O
projective	B
if	O
approx-	O
imately	O
correct	O
internal	B
parameters	I
are	O
guessed	O
.	O
such	O
a	O
“	O
quasi-euclidean	O
reconstruc-	O
tion	O
”	O
is	O
often	O
suitable	O
for	O
visualization	O
purposes	O
.	O
10.6	O
closure	O
277	O
objective	O
m	O
,	O
{	O
xmi	O
}	O
)	O
of	O
the	O
cam-	O
given	O
two	O
uncalibrated	O
images	O
compute	O
a	O
metric	B
reconstruction	I
(	O
pm	O
,	O
p	O
(	O
cid:1	O
)	O
eras	O
and	O
scene	O
structure	O
,	O
i.e	O
.	O
a	O
reconstruction	B
that	O
is	O
within	O
a	O
similarity	B
transformation	I
of	O
the	O
true	O
cameras	B
and	O
scene	O
structure	O
.	O
algorithm	B
(	O
i	O
)	O
compute	O
a	O
projective	B
reconstruction	I
(	O
p	O
,	O
p	O
(	O
cid:1	O
)	O
,	O
{	O
xi	O
}	O
)	O
:	O
tween	O
the	O
images	O
.	O
(	O
a	O
)	O
compute	O
the	O
fundamental	B
matrix	I
from	O
point	B
correspondences	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
b	O
)	O
camera	B
retrieval	O
:	O
compute	O
the	O
camera	B
matrices	I
p	O
,	O
p	O
(	O
cid:1	O
)	O
(	O
c	O
)	O
triangulation	B
:	O
for	O
each	O
point	B
correspondence	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
matrix	B
.	O
i	O
,	O
compute	O
the	O
point	B
xi	O
from	O
the	O
fundamental	O
i	O
be-	O
in	O
space	O
that	O
projects	O
to	O
these	O
two	O
image	O
points	O
.	O
(	O
ii	O
)	O
rectify	O
the	O
projective	B
reconstruction	I
to	O
metric	B
:	O
•	O
either	O
direct	O
method	O
:	O
compute	O
the	O
homography	B
h	O
such	O
that	O
xei	O
=	O
hxi	O
from	O
ﬁve	O
or	O
more	O
ground	O
control	O
points	O
xei	O
with	O
known	O
euclidean	O
positions	O
.	O
then	O
the	O
metric	B
reconstruction	I
is	O
pm	O
=	O
ph−1	O
,	O
p	O
(	O
cid:1	O
)	O
m	O
=	O
p	O
(	O
cid:1	O
)	O
h−1	O
,	O
xmi	O
=	O
hxi	O
.	O
•	O
or	O
stratiﬁed	O
method	O
:	O
(	O
a	O
)	O
afﬁne	B
reconstruction	I
:	O
compute	O
the	O
plane	O
at	O
inﬁnity	O
,	O
π∞	O
,	O
as	O
described	O
in	O
section	O
10.4.1	O
,	O
and	O
then	O
upgrade	O
the	O
projective	B
reconstruction	I
to	O
an	O
afﬁne	B
reconstruction	I
with	O
the	O
homography	B
h	O
=	O
i	O
|	O
0	O
πt∞	O
(	O
cid:24	O
)	O
(	O
cid:24	O
)	O
(	O
cid:25	O
)	O
.	O
(	O
cid:25	O
)	O
h	O
=	O
a−1	O
1	O
(	O
b	O
)	O
metric	B
reconstruction	I
:	O
compute	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
ω	O
,	O
as	O
described	O
in	O
section	O
10.4.2	O
,	O
and	O
then	O
upgrade	O
the	O
afﬁne	B
reconstruction	I
to	O
a	O
metric	B
reconstruction	I
with	O
the	O
homography	B
where	O
a	O
is	O
obtained	O
by	O
cholesky	O
factorization	B
from	O
the	O
equation	O
aat	O
=	O
(	O
mtωm	O
)	O
−1	O
,	O
and	O
m	O
is	O
the	O
ﬁrst	O
3	O
×	O
3	O
submatrix	O
of	O
the	O
camera	O
in	O
the	O
afﬁne	B
reconstruction	I
for	O
which	O
ω	O
is	O
computed	O
.	O
algorithm	B
10.1.	O
computation	B
of	I
a	O
metric	B
reconstruction	I
from	O
two	O
uncalibrated	O
images	O
.	O
10.6.1	O
the	O
literature	O
koenderink	O
and	O
van	O
doorn	O
[	O
koenderink-91	O
]	O
give	O
a	O
very	O
elegant	O
discussion	O
of	O
stratiﬁca-	O
tion	O
for	B
afﬁne	I
cameras	I
.	O
this	O
was	O
extended	O
to	O
perspective	O
in	O
[	O
faugeras-95b	O
]	O
,	O
with	O
devel-	O
opments	O
given	O
by	O
luong	O
and	O
vi´eville	O
[	O
luong-94	O
,	O
luong-96	O
]	O
.	O
the	O
possibility	O
of	O
projec-	O
tive	O
reconstruction	B
given	O
f	O
appeared	O
in	O
[	O
faugeras-92b	O
]	O
and	O
hartley	O
et	O
al	O
.	O
[	O
hartley-92c	O
]	O
.	O
the	O
method	O
of	O
computing	O
afﬁne	B
reconstruction	I
from	O
pure	O
translation	O
ﬁrst	O
appeared	O
in	O
moons	O
et	O
al	O
.	O
[	O
moons-94	O
]	O
.	O
combining	O
scene	O
and	O
internal	B
parameter	O
constraints	B
over	O
multiple	O
views	O
is	O
described	O
in	O
[	O
faugeras-95c	O
,	O
liebowitz-99b	O
,	O
sturm-99c	O
]	O
.	O
278	O
10	O
3d	O
reconstruction	B
of	O
cameras	B
and	O
structure	B
image	O
information	O
provided	O
view	O
relations	O
and	O
projective	B
objects	O
3-space	O
reconstruction	B
objects	O
ambiguity	B
point	O
correspondences	B
point	O
correspondences	B
including	O
vanishing	B
points	I
point	O
correspondences	B
and	O
internal	B
camera	O
calibration	B
f	O
f	O
,	O
h∞	O
f	O
,	O
h∞	O
ω	O
,	O
ω	O
(	O
cid:1	O
)	O
projective	B
afﬁne	O
metric	B
π∞	O
π∞	O
ω∞	O
table	O
10.1.	O
the	O
two-view	O
relations	O
,	O
image	O
entities	O
,	O
and	O
their	O
3-space	O
counterparts	O
for	O
various	O
classes	O
of	O
reconstruction	O
ambiguity	B
.	O
10.6.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
using	O
only	O
(	O
implicit	O
)	O
image	O
relations	O
(	O
i.e	O
.	O
without	O
an	O
explicit	O
3d	O
reconstruc-	O
tion	O
)	O
and	O
given	O
the	O
images	O
of	O
a	O
line	O
l	O
and	O
point	B
x	O
(	O
not	O
on	O
l	O
)	O
in	O
two	O
views	O
,	O
together	O
with	O
h∞	O
between	O
the	O
views	O
,	O
compute	O
the	O
image	O
of	O
the	O
line	O
in	O
3-space	O
parallel	B
to	O
l	O
and	O
through	O
x.	O
other	O
examples	B
of	O
this	O
implicit	O
approach	O
to	O
com-	O
putation	O
are	O
given	O
in	O
[	O
zeller-96	O
]	O
.	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
this	O
chapter	O
describes	O
numerical	O
methods	O
for	O
estimating	B
the	O
fundamental	B
matrix	I
given	O
a	O
set	O
of	O
point	O
correspondences	B
between	O
two	O
images	O
.	O
we	O
begin	O
by	O
describing	O
the	O
equa-	O
tions	O
on	O
f	O
generated	O
by	O
point	B
correspondences	O
in	O
two	O
images	O
,	O
and	O
their	O
minimal	O
solu-	O
tion	O
.	O
the	O
following	O
sections	O
then	O
give	O
linear	B
methods	O
for	O
estimating	O
f	O
using	O
algebraic	O
distance	O
,	O
and	O
then	O
various	O
geometric	B
cost	O
functions	O
and	O
solution	B
methods	O
including	O
the	O
mle	O
(	O
“	O
gold	O
standard	O
”	O
)	O
algorithm	B
,	O
and	O
sampson	O
distance	B
.	O
an	O
algorithm	B
is	O
then	O
described	O
for	O
automatically	O
obtaining	O
point	B
correspondences	O
,	O
so	O
that	O
f	O
may	O
be	O
estimated	O
directly	O
from	O
an	O
image	O
pair	O
.	O
we	O
discuss	O
the	O
estimation	B
of	I
f	O
for	O
special	O
camera	B
motions	O
.	O
the	O
chapter	O
also	O
covers	O
a	O
method	O
of	O
image	O
rectiﬁcation	O
based	O
on	O
the	O
computed	O
f.	O
11.1	O
basic	O
equations	O
the	O
fundamental	B
matrix	I
is	O
deﬁned	O
by	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
(	O
11.1	O
)	O
for	O
any	O
pair	O
of	O
matching	O
points	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
in	O
two	O
images	O
.	O
given	O
sufﬁciently	O
many	O
point	B
matches	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
(	O
at	O
least	O
7	O
)	O
,	O
equation	O
(	O
11.1	O
)	O
can	O
be	O
used	O
to	O
compute	O
the	O
unknown	O
matrix	B
f.	O
in	O
particular	O
,	O
writing	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
and	O
x	O
(	O
cid:2	O
)	O
,	O
1	O
)	O
t	O
each	O
point	B
match	O
gives	O
rise	O
to	O
one	O
linear	B
equation	O
in	O
the	O
unknown	O
entries	O
of	O
f.	O
the	O
coefﬁcients	O
of	O
this	O
equation	O
are	O
easily	O
written	O
in	O
terms	O
of	O
the	O
known	O
coordinates	B
x	O
and	O
x	O
(	O
cid:2	O
)	O
.	O
speciﬁcally	O
,	O
(	O
cid:2	O
)	O
the	O
equation	O
corresponding	O
to	O
a	O
pair	O
of	B
points	I
(	O
x	O
,	O
y	O
,	O
1	O
)	O
and	O
(	O
x	O
,	O
1	O
)	O
is	O
=	O
(	O
x	O
,	O
y	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
11.2	O
)	O
x	O
xf11	O
+	O
x	O
denote	O
by	O
f	O
the	O
9-vector	O
made	O
up	O
of	O
the	O
entries	O
of	O
f	O
in	O
row-major	O
order	O
.	O
then	O
(	O
11.2	O
)	O
f23	O
+	O
xf31	O
+	O
yf32	O
+	O
f33	O
=	O
0.	O
yf12	O
+	O
x	O
xf21	O
+	O
y	O
yf22	O
+	O
y	O
f13	O
+	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
can	O
be	O
expressed	O
as	O
a	O
vector	O
inner	O
product	O
(	O
cid:2	O
)	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
y	O
,	O
x	O
x	O
,	O
x	O
x	O
,	O
y	O
(	O
cid:2	O
)	O
y	O
,	O
y	O
(	O
cid:2	O
)	O
,	O
x	O
,	O
y	O
,	O
1	O
)	O
f	O
=	O
0.	O
from	O
a	O
set	O
of	O
n	O
point	B
matches	O
,	O
we	O
obtain	O
a	O
set	O
of	O
linear	O
equations	O
of	O
the	O
form	O
	O
x	O
x	O
af	O
=	O
(	O
cid:2	O
)	O
1x1	O
x	O
...	O
(	O
cid:2	O
)	O
nxn	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1y1	O
x	O
1	O
...	O
...	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
nyn	O
x	O
n	O
y	O
(	O
cid:2	O
)	O
1x1	O
y	O
...	O
(	O
cid:2	O
)	O
nxn	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1y1	O
y	O
y	O
1	O
x1	O
y1	O
1	O
...	O
...	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
nyn	O
y	O
n	O
xn	O
yn	O
1	O
...	O
...	O
279	O
	O
f	O
=	O
0	O
.	O
(	O
11.3	O
)	O
280	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
a	O
b	O
fig	O
.	O
11.1.	O
epipolar	B
lines	I
.	O
(	O
a	O
)	O
the	O
effect	O
of	O
a	O
non-singular	O
fundamental	B
matrix	I
.	O
epipolar	B
lines	I
computed	O
as	O
l	O
(	O
cid:1	O
)	O
=	O
fx	O
for	O
varying	O
x	O
do	O
not	O
meet	O
in	O
a	O
common	O
epipole	O
.	O
(	O
b	O
)	O
the	O
effect	O
of	O
enforcing	O
singularity	O
using	O
the	O
svd	O
method	O
described	O
here	O
.	O
this	O
is	O
a	O
homogeneous	O
set	O
of	O
equations	O
,	O
and	O
f	O
can	O
only	O
be	O
determined	O
up	O
to	O
scale	O
.	O
for	O
a	O
solution	O
to	O
exist	O
,	O
matrix	B
a	O
must	O
have	O
rank	O
at	O
most	O
8	O
,	O
and	O
if	O
the	O
rank	O
is	O
exactly	O
8	O
,	O
then	O
the	O
solution	B
is	O
unique	O
(	O
up	O
to	O
scale	O
)	O
,	O
and	O
can	O
be	O
found	O
by	O
linear	B
methods	O
–	O
the	O
solution	B
is	O
the	O
generator	B
of	O
the	O
right	O
null-space	B
of	O
a.	O
if	O
the	O
data	O
is	O
not	O
exact	O
,	O
because	O
of	O
noise	O
in	O
the	O
point	B
coordinates	O
,	O
then	O
the	O
rank	O
of	O
a	O
may	O
be	O
greater	O
than	O
8	O
(	O
in	O
fact	O
equal	O
to	O
9	O
,	O
since	O
a	O
has	O
9	O
columns	O
)	O
.	O
in	O
this	O
case	O
,	O
one	O
ﬁnds	O
a	O
least-squares	B
solution	I
.	O
apart	O
from	O
the	O
speciﬁc	O
form	B
of	I
the	O
equations	O
(	O
compare	O
(	O
11.3	O
)	O
with	O
(	O
4.3–p89	O
)	O
)	O
the	O
problem	O
is	O
essentially	O
the	O
same	O
as	O
the	O
estimation	B
problem	I
considered	O
in	O
section	O
4.1.1	O
(	O
p90	O
)	O
.	O
refer	O
to	O
the	O
algorithm	B
4.1	O
(	O
p91	O
)	O
.	O
the	O
least-squares	B
solution	I
for	O
f	O
is	O
the	O
singular	O
vector	O
corresponding	O
to	O
the	O
smallest	O
singular	O
value	O
of	O
a	O
,	O
that	O
is	O
,	O
the	O
last	O
column	O
of	O
v	O
in	O
the	O
svd	O
a	O
=	O
udvt	O
.	O
the	O
solution	B
vector	O
f	O
found	O
in	O
this	O
way	O
minimizes	O
(	O
cid:10	O
)	O
af	O
(	O
cid:10	O
)	O
subject	O
to	O
the	O
condition	O
(	O
cid:10	O
)	O
f	O
(	O
cid:10	O
)	O
=	O
1.	O
the	O
algorithm	B
just	O
described	O
is	O
the	O
essence	O
of	O
a	O
method	O
called	O
the	O
8-point	O
algorithm	B
for	O
computation	B
of	I
the	O
fundamental	B
matrix	I
.	O
11.1.1	O
the	O
singularity	B
constraint	I
an	O
important	O
property	O
of	O
the	O
fundamental	O
matrix	B
is	O
that	O
it	O
is	O
singular	O
,	O
in	O
fact	O
of	O
rank	O
2.	O
furthermore	O
,	O
the	O
left	O
and	O
right	O
null-spaces	O
of	O
f	O
are	O
generated	O
by	O
the	O
vectors	O
rep-	O
resenting	O
(	O
in	O
homogeneous	O
coordinates	B
)	O
the	O
two	O
epipoles	O
in	O
the	O
two	O
images	O
.	O
most	O
applications	O
of	O
the	O
fundamental	O
matrix	B
rely	O
on	O
the	O
fact	O
that	O
it	O
has	O
rank	O
2.	O
for	O
instance	O
,	O
if	O
the	O
fundamental	B
matrix	I
is	O
not	O
singular	O
then	O
computed	O
epipolar	O
lines	B
are	O
not	O
coinci-	O
dent	O
,	O
as	O
is	O
demonstrated	O
by	O
ﬁgure	O
11.1.	O
the	O
matrix	B
f	O
found	O
by	O
solving	B
the	O
set	O
of	O
linear	O
equations	O
(	O
11.3	O
)	O
will	O
not	O
in	O
general	O
have	O
rank	O
2	O
,	O
and	O
we	O
should	O
take	O
steps	O
to	O
enforce	O
this	O
constraint	O
.	O
the	O
most	O
convenient	O
way	O
to	O
do	O
this	O
is	O
to	O
correct	O
the	O
matrix	B
f	O
found	O
by	O
the	O
svd	O
solution	B
from	O
a.	O
matrix	B
f	O
is	O
replaced	O
by	O
the	O
matrix	B
f	O
(	O
cid:2	O
)	O
that	O
minimizes	O
the	O
frobenius	O
norm	B
(	O
cid:10	O
)	O
f	O
−	O
f	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
subject	O
to	O
the	O
condition	O
det	O
f	O
(	O
cid:2	O
)	O
=	O
0.	O
a	O
convenient	O
method	O
of	O
11.2	O
the	O
normalized	O
8-point	O
algorithm	B
281	O
doing	O
this	O
is	O
to	O
again	O
use	O
the	O
svd	O
.	O
in	O
particular	O
,	O
let	O
f	O
=	O
udvt	O
be	O
the	O
svd	O
of	O
f	O
,	O
where	O
d	O
is	O
a	O
diagonal	O
matrix	B
d	O
=	O
diag	O
(	O
r	O
,	O
s	O
,	O
t	O
)	O
satisfying	O
r	O
≥	O
s	O
≥	O
t.	O
then	O
f	O
(	O
cid:2	O
)	O
=	O
udiag	O
(	O
r	O
,	O
s	O
,	O
0	O
)	O
vt	O
minimizes	O
the	O
frobenius	O
norm	B
of	O
f	O
−	O
f	O
(	O
cid:2	O
)	O
thus	O
,	O
the	O
8-point	O
algorithm	B
for	O
computation	B
of	I
the	O
fundamental	B
matrix	I
may	O
be	O
for-	O
.	O
mulated	O
as	O
consisting	O
of	O
two	O
steps	O
,	O
as	O
follows	O
.	O
(	O
i	O
)	O
linear	B
solution	I
.	O
a	O
solution	B
f	O
is	O
obtained	O
from	O
the	O
vector	O
f	O
corresponding	O
to	O
(	O
ii	O
)	O
constraint	O
enforcement	O
.	O
replace	O
f	O
by	O
f	O
(	O
cid:2	O
)	O
the	O
smallest	O
singular	O
value	O
of	O
a	O
,	O
where	O
a	O
is	O
deﬁned	O
in	O
(	O
11.3	O
)	O
.	O
,	O
the	O
closest	O
singular	O
matrix	O
to	O
f	O
under	O
a	O
frobenius	O
norm	B
.	O
this	O
correction	B
is	O
done	O
using	O
the	O
svd	O
.	O
the	O
algorithm	B
thus	O
stated	O
is	O
extremely	O
simple	O
,	O
and	O
readily	O
implemented	O
,	O
assuming	O
that	O
appropriate	O
linear	B
algebra	O
routines	O
are	O
available	O
.	O
as	O
usual	O
normalization	B
is	O
re-	O
quired	O
,	O
and	O
we	O
return	O
to	O
this	O
in	O
section	O
11.2.	O
i	O
11.1.2	O
the	O
minimum	O
case	O
–	O
seven	O
point	B
correspondences	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
tfxi	O
=	O
0	O
gives	O
rise	O
to	O
a	O
set	O
of	O
equations	O
of	O
the	O
form	O
af	O
=	O
0.	O
if	O
a	O
has	O
rank	O
8	O
,	O
then	O
it	O
is	O
possible	O
to	O
solve	O
for	O
f	O
up	O
to	O
scale	O
.	O
in	O
the	O
case	O
where	O
the	O
matrix	B
a	O
has	O
rank	O
seven	O
,	O
it	O
is	O
still	O
possible	O
to	O
solve	O
for	O
the	O
fundamental	B
matrix	I
by	O
making	O
use	O
of	O
the	O
singularity	B
constraint	I
.	O
the	O
most	O
important	O
case	O
is	O
when	O
only	O
7	O
point	B
correspondences	O
are	O
known	O
(	O
other	O
cases	O
are	O
discussed	O
in	O
section	O
11.9	O
)	O
.	O
this	O
leads	O
to	O
a	O
7	O
×	O
9	O
matrix	B
a	O
,	O
which	O
generally	O
will	O
have	O
rank	O
7.	O
the	O
solution	B
to	O
the	O
equations	O
af	O
=	O
0	O
in	O
this	O
case	O
is	O
a	O
2-dimensional	O
space	O
of	O
the	O
form	O
αf1	O
+	O
(	O
1−	O
α	O
)	O
f2	O
,	O
where	O
α	O
is	O
a	O
scalar	O
variable	O
.	O
the	O
matrices	O
f1	O
and	O
f2	O
are	O
obtained	O
as	O
the	O
matrices	O
corresponding	O
to	O
the	O
generators	O
f	O
1	O
and	O
f	O
2	O
of	O
the	O
right	O
null-space	B
of	O
a.	O
now	O
,	O
we	O
use	O
the	O
constraint	O
that	O
det	O
f	O
=	O
0.	O
this	O
may	O
be	O
written	O
as	O
det	O
(	O
αf1	O
+	O
(	O
1−	O
α	O
)	O
f2	O
)	O
=	O
0.	O
since	O
f1	O
and	O
f2	O
are	O
known	O
,	O
this	O
leads	O
to	O
a	O
cubic	O
polynomial	O
equation	O
in	O
α.	O
this	O
poly-	O
nomial	O
equation	O
may	O
be	O
solved	O
to	O
ﬁnd	O
the	O
value	O
of	O
α.	O
there	O
will	O
be	O
either	O
one	O
or	O
three	O
real	O
solutions	O
(	O
the	O
complex	O
solutions	O
are	O
discarded	O
[	O
hartley-94c	O
]	O
)	O
.	O
substituting	O
back	O
in	O
the	O
equation	O
f	O
=	O
αf1	O
+	O
(	O
1	O
−	O
α	O
)	O
f2	O
gives	O
one	O
or	O
three	O
possible	O
solutions	O
for	O
the	O
fundamental	B
matrix	I
.	O
this	O
method	O
of	O
computing	O
one	O
or	O
three	O
fundamental	O
matrices	O
for	O
the	O
minimum	O
num-	O
ber	O
of	B
points	I
(	O
seven	O
)	O
is	O
used	O
in	O
the	O
robust	B
algorithm	O
of	O
section	O
11.6.	O
we	O
return	O
to	O
the	O
issue	O
of	O
the	O
number	O
of	O
solutions	O
in	O
section	O
11.9	O
.	O
11.2	O
the	O
normalized	O
8-point	O
algorithm	B
the	O
8-point	O
algorithm	B
is	O
the	O
simplest	O
method	O
of	O
computing	O
the	O
fundamental	B
matrix	I
,	O
involving	O
no	O
more	O
than	O
the	O
construction	O
and	O
(	O
least-squares	O
)	O
solution	B
of	O
a	O
set	O
of	O
linear	O
equations	O
.	O
if	O
care	O
is	O
taken	O
,	O
then	O
it	O
can	O
perform	O
extremely	O
well	O
.	O
the	O
original	O
algo-	O
rithm	O
is	O
due	O
to	O
longuet-higgins	O
[	O
longuethiggins-81	O
]	O
.	O
the	O
key	O
to	O
success	O
with	O
the	O
8-point	O
algorithm	B
is	O
proper	O
careful	O
normalization	B
of	O
the	O
input	O
data	O
before	O
constructing	O
the	O
equations	O
to	O
solve	O
.	O
the	O
subject	O
of	O
normalization	O
of	O
input	O
data	O
has	O
applications	O
to	O
many	O
of	O
the	O
algorithms	O
of	O
this	O
book	O
,	O
and	O
is	O
treated	O
in	O
general	O
terms	O
in	O
section	O
4.4-	O
(	O
p104	O
)	O
.	O
in	O
the	O
case	O
of	O
the	O
8-point	O
algorithm	B
,	O
a	O
simple	O
transformation	O
(	O
translation	O
and	O
282	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
objective	O
given	O
n	O
≥	O
8	O
image	O
point	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
such	O
that	O
x	O
(	O
cid:1	O
)	O
algorithm	B
tfxi	O
=	O
0.	O
i	O
i	O
}	O
,	O
determine	O
the	O
fundamental	B
matrix	I
f	O
(	O
i	O
)	O
normalization	B
:	O
transform	O
the	O
image	O
coordinates	O
according	O
to	O
ˆxi	O
=	O
txi	O
and	O
ˆx	O
(	O
cid:1	O
)	O
i	O
=	O
are	O
normalizing	O
transformations	O
consisting	O
of	O
a	O
translation	O
and	O
i	O
,	O
where	O
t	O
and	O
t	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
ii	O
)	O
find	O
the	O
fundamental	B
matrix	I
ˆf	O
corresponding	O
to	O
the	O
matches	O
ˆxi	O
↔	O
ˆx	O
(	O
cid:1	O
)	O
i	O
by	O
t	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
scaling	B
.	O
(	O
a	O
)	O
linear	B
solution	I
:	O
determine	O
ˆf	O
from	O
the	O
singular	O
vector	O
corresponding	O
to	O
the	O
smallest	O
singular	O
value	O
of	O
ˆa	O
,	O
where	O
ˆa	O
is	O
composed	O
from	O
the	O
matches	O
ˆxi	O
↔	O
ˆx	O
(	O
cid:1	O
)	O
as	O
deﬁned	O
in	O
(	O
11.3	O
)	O
.	O
i	O
(	O
cid:1	O
)	O
(	O
b	O
)	O
constraint	O
enforcement	O
:	O
replace	O
ˆf	O
by	O
ˆf	O
such	O
that	O
det	O
ˆf	O
=	O
0	O
using	O
the	O
svd	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
iii	O
)	O
denormalization	O
:	O
set	O
f	O
=	O
t	O
(	O
cid:1	O
)	O
tˆf	O
(	O
see	O
section	O
11.1.1	O
)	O
.	O
to	O
the	O
original	O
data	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
i.	O
t.	O
matrix	B
f	O
is	O
the	O
fundamental	B
matrix	I
corresponding	O
algorithm	B
11.1.	O
the	O
normalized	O
8-point	O
algorithm	B
for	O
f.	O
scaling	B
)	O
of	O
the	O
points	O
in	O
the	O
image	O
before	O
formulating	O
the	O
linear	B
equations	I
leads	O
to	O
an	O
enormous	O
improvement	O
in	O
the	O
conditioning	O
of	O
the	O
problem	O
and	O
hence	O
in	O
the	O
stability	B
of	O
the	O
result	O
.	O
the	O
added	O
complexity	O
of	O
the	O
algorithm	O
necessary	O
to	O
do	O
this	O
transformation	B
is	O
insigniﬁcant	O
.	O
the	O
suggested	O
normalization	B
is	O
a	O
translation	O
and	O
scaling	B
of	O
each	O
image	O
so	O
that	O
the	O
√	O
centroid	O
of	O
the	O
reference	O
points	O
is	O
at	O
the	O
origin	O
of	O
the	O
coordinates	O
and	O
the	O
rms	O
distance	B
of	O
the	O
points	O
from	O
the	O
origin	O
is	O
equal	O
to	O
2.	O
this	O
is	O
carried	O
out	O
for	O
essentially	O
the	O
same	O
reasons	O
as	O
in	O
chapter	O
4.	O
the	O
basic	O
method	O
is	O
analogous	O
to	O
algorithm	O
4.2	O
(	O
p109	O
)	O
and	O
is	O
summarized	O
in	O
algorithm	O
11.1.	O
note	O
that	O
it	O
is	O
recommended	O
that	O
the	O
singularity	O
condition	O
should	O
be	O
enforced	O
before	O
denormalization	O
.	O
for	O
a	O
justiﬁcation	O
of	O
this	O
,	O
refer	O
to	O
[	O
hartley-97c	O
]	O
.	O
11.3	O
the	O
algebraic	B
minimization	I
algorithm	O
the	O
normalized	O
8-point	O
algorithm	B
includes	O
a	O
method	O
for	O
enforcing	O
the	O
singularity	O
con-	O
straint	O
on	O
the	O
fundamental	B
matrix	I
.	O
the	O
initial	O
estimate	O
f	O
is	O
replaced	O
by	O
the	O
singular	O
that	O
minimizes	O
the	O
difference	O
(	O
cid:10	O
)	O
f	O
(	O
cid:2	O
)	O
−	O
f	O
(	O
cid:10	O
)	O
.	O
this	O
is	O
done	O
using	O
the	O
svd	O
,	O
and	O
has	O
matrix	B
f	O
(	O
cid:2	O
)	O
the	O
advantage	O
of	O
being	O
simple	O
and	O
rapid	O
.	O
numerically	O
,	O
however	O
,	O
this	O
method	O
is	O
not	O
optimal	O
,	O
since	O
all	O
the	O
entries	O
of	O
f	O
do	O
not	O
have	O
equal	O
importance	O
,	O
and	O
indeed	O
some	O
entries	O
are	O
more	O
tightly	O
constrained	O
by	O
the	O
point-correspondence	O
data	O
than	O
others	O
.	O
a	O
more	O
correct	O
procedure	O
would	O
be	O
to	O
compute	O
a	O
covariance	B
matrix	O
from	O
the	O
entries	O
of	O
f	O
in	O
terms	O
of	O
the	O
input	O
data	O
,	O
and	O
then	O
to	O
ﬁnd	O
the	O
singular	O
matrix	O
f	O
(	O
cid:2	O
)	O
closest	O
to	O
f	O
in	O
terms	O
of	O
mahalanobis	O
distance	B
with	O
respect	O
to	O
this	O
covariance	B
.	O
unfortunately	O
,	O
minimization	B
of	O
the	O
mahalanobis	O
distance	B
(	O
cid:10	O
)	O
f−	O
f	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
σ	O
can	O
not	O
be	O
done	O
linearly	O
for	O
a	O
general	O
covariance	B
matrix	O
σ	O
,	O
so	O
this	O
approach	O
is	O
unattractive	O
.	O
an	O
alternative	O
procedure	O
is	O
to	O
ﬁnd	O
the	O
desired	O
singular	O
matrix	O
f	O
(	O
cid:2	O
)	O
directly	O
.	O
thus	O
,	O
just	O
as	O
f	O
is	O
computed	O
by	O
minimizing	O
the	O
norm	O
(	O
cid:10	O
)	O
af	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
f	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
so	O
one	O
should	O
aim	O
11.3	O
the	O
algebraic	B
minimization	I
algorithm	O
283	O
that	O
minimizes	O
(	O
cid:10	O
)	O
af	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
f	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
=	O
1.	O
it	O
turns	O
out	O
to	O
ﬁnd	O
the	O
singular	O
matrix	O
f	O
(	O
cid:2	O
)	O
not	O
to	O
be	O
possible	O
to	O
do	O
this	O
by	O
linear	B
non-iterative	O
means	O
,	O
chieﬂy	O
because	O
det	O
f	O
(	O
cid:2	O
)	O
=	O
0	O
is	O
a	O
cubic	O
,	O
rather	O
than	O
a	O
linear	B
constraint	O
.	O
nevertheless	O
,	O
it	O
will	O
be	O
seen	O
that	O
a	O
simple	O
iterative	O
method	O
is	O
effective	O
.	O
an	O
arbitrary	O
singular	O
3×	O
3	O
matrix	B
,	O
such	O
as	O
the	O
fundamental	B
matrix	I
f	O
,	O
may	O
be	O
written	O
as	O
a	O
product	O
f	O
=	O
m	O
[	O
e	O
]	O
×	O
where	O
m	O
is	O
a	O
non-singular	O
matrix	B
and	O
[	O
e	O
]	O
×	O
is	O
any	O
skew-symmetric	O
matrix	O
,	O
with	O
e	O
corresponding	O
to	O
the	O
epipole	O
in	O
the	O
ﬁrst	O
image	O
.	O
suppose	O
we	O
wish	O
to	O
compute	O
the	O
fundamental	B
matrix	I
f	O
of	O
the	O
form	O
f	O
=	O
m	O
[	O
e	O
]	O
×	O
that	O
minimizes	O
the	O
algebraic	B
error	I
(	O
cid:10	O
)	O
af	O
(	O
cid:10	O
)	O
subject	O
to	O
the	O
condition	O
(	O
cid:10	O
)	O
f	O
(	O
cid:10	O
)	O
=	O
1.	O
let	O
us	O
assume	O
for	O
now	O
that	O
the	O
epipole	O
e	O
is	O
known	O
.	O
later	O
we	O
will	O
let	O
e	O
vary	O
,	O
but	O
for	O
now	O
it	O
is	O
ﬁxed	O
.	O
the	O
equation	O
f	O
=	O
m	O
[	O
e	O
]	O
×	O
can	O
be	O
written	O
in	O
terms	O
of	O
the	O
vectors	O
f	O
and	O
m	O
comprising	O
the	O
entries	O
of	O
f	O
and	O
m	O
as	O
an	O
equation	O
f	O
=	O
em	O
where	O
e	O
is	O
a	O
9	O
×	O
9	O
matrix	B
.	O
supposing	O
that	O
f	O
and	O
m	O
contain	O
the	O
entries	O
of	O
the	O
corresponding	O
matrices	O
in	O
row-major	O
order	O
,	O
then	O
it	O
can	O
be	O
veriﬁed	O
that	O
e	O
has	O
the	O
form	O
	O
[	O
e	O
]	O
×	O
e	O
=	O
	O
.	O
[	O
e	O
]	O
×	O
[	O
e	O
]	O
×	O
(	O
11.4	O
)	O
since	O
f	O
=	O
em	O
,	O
the	O
minimization	B
problem	O
becomes	O
:	O
1	O
minimize	O
(	O
cid:10	O
)	O
aem	O
(	O
cid:10	O
)	O
subject	O
to	O
the	O
condition	O
(	O
cid:10	O
)	O
em	O
(	O
cid:10	O
)	O
=	O
1	O
.	O
(	O
11.5	O
)	O
this	O
minimization	B
problem	O
is	O
solved	O
using	O
algorithm	O
a5.6	O
(	O
p595	O
)	O
.	O
for	O
the	O
purposes	O
of	O
this	O
algorithm	B
one	O
observes	O
that	O
rank	O
(	O
e	O
)	O
=	O
6	O
,	O
since	O
each	O
of	O
its	O
diagonal	O
blocks	O
has	O
rank	O
2	O
.	O
11.3.1	O
iterative	B
estimation	I
the	O
minimization	B
(	O
11.5	O
)	O
gives	O
a	O
way	O
of	O
computing	O
an	O
algebraic	B
error	I
vector	O
af	O
given	O
a	O
value	O
for	O
the	O
epipole	O
e.	O
this	O
mapping	O
e	O
(	O
cid:6	O
)	O
→	O
af	O
is	O
a	O
map	O
from	O
ir3	O
to	O
ir9	O
.	O
note	O
that	O
the	O
value	O
of	O
af	O
is	O
unaffected	O
by	O
scaling	B
e.	O
starting	O
from	O
an	O
estimated	O
value	O
of	O
e	O
derived	O
as	O
the	O
generator	B
of	O
the	O
right	O
null-space	B
of	O
an	O
initial	O
estimate	O
of	O
f	O
,	O
one	O
may	O
iterate	O
to	O
ﬁnd	O
the	O
ﬁnal	O
f	O
that	O
minimizes	O
algebraic	B
error	I
.	O
the	O
initial	O
estimate	O
of	O
f	O
may	O
be	O
obtained	O
from	O
the	O
8-point	O
algorithm	B
,	O
or	O
any	O
other	O
simple	O
algorithm	O
.	O
the	O
complete	O
algorithm	B
for	O
computation	B
of	I
f	O
is	O
given	O
in	O
algorithm	O
11.2.	O
note	O
the	O
advantage	O
of	O
this	O
method	O
of	O
computing	O
f	O
is	O
that	O
the	O
iterative	B
part	O
of	O
the	O
algorithm	O
consists	O
of	O
a	O
very	O
small	O
parameter	B
minimization	I
problem	O
,	O
involving	O
the	O
es-	O
timation	O
of	O
only	O
three	O
parameters	B
(	O
the	O
homogeneous	O
coordinates	O
of	O
e	O
)	O
.	O
despite	O
this	O
,	O
the	O
algorithm	B
ﬁnds	O
the	O
fundamental	B
matrix	I
that	O
minimizes	O
the	O
algebraic	B
error	I
for	O
all	O
matched	O
points	O
.	O
the	O
matched	O
points	O
themselves	O
do	O
not	O
come	O
into	O
the	O
ﬁnal	O
iterative	B
estimation	I
.	O
1	O
it	O
does	O
not	O
do	O
to	O
minimize	O
(	O
cid:5	O
)	O
aem	O
(	O
cid:5	O
)	O
subject	O
to	O
the	O
condition	O
(	O
cid:5	O
)	O
m	O
(	O
cid:5	O
)	O
=	O
1	O
,	O
since	O
a	O
solution	B
to	O
this	O
occurs	O
when	O
m	O
is	O
a	O
unit	O
vector	O
in	O
the	O
right	O
null-space	B
of	O
e.	O
in	O
this	O
case	O
,	O
em	O
=	O
0	O
,	O
and	O
hence	O
(	O
cid:5	O
)	O
aem	O
(	O
cid:5	O
)	O
=	O
0	O
.	O
284	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
objective	O
find	O
the	O
fundamental	B
matrix	I
f	O
that	O
minimizes	O
the	O
algebraic	B
error	I
(	O
cid:10	O
)	O
af	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
f	O
(	O
cid:10	O
)	O
=	O
1	O
and	O
det	O
f	O
=	O
0.	O
algorithm	B
(	O
i	O
)	O
find	O
a	O
ﬁrst	O
approximation	O
f0	O
for	O
the	O
fundamental	B
matrix	I
using	O
the	O
normalized	O
8-point	O
algorithm	B
11.1.	O
then	O
ﬁnd	O
the	O
right	O
null-vector	O
e0	O
of	O
f0	O
.	O
(	O
ii	O
)	O
starting	O
with	O
the	O
estimate	O
ei	O
=	O
e0	O
for	O
the	O
epipole	O
,	O
compute	O
the	O
matrix	B
ei	O
according	O
to	O
(	O
11.4	O
)	O
,	O
then	O
ﬁnd	O
the	O
vector	O
f	O
i	O
=	O
eimi	O
that	O
minimizes	O
(	O
cid:10	O
)	O
af	O
i	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
f	O
i	O
(	O
cid:10	O
)	O
=	O
1.	O
this	O
is	O
done	O
using	O
algorithm	O
a5.6	O
(	O
p595	O
)	O
.	O
(	O
iii	O
)	O
compute	O
the	O
algebraic	B
error	I
i	O
=	O
af	O
i.	O
since	O
f	O
i	O
and	O
hence	O
i	O
is	O
deﬁned	O
only	O
up	O
to	O
sign	O
,	O
i	O
ei−1	O
>	O
0	O
for	O
(	O
iv	O
)	O
the	O
previous	O
two	O
steps	O
deﬁne	O
a	O
mapping	O
ir3	O
→	O
ir9	O
mapping	O
ei	O
(	O
cid:6	O
)	O
→	O
i	O
.	O
now	O
use	O
the	O
levenberg–marquardt	O
algorithm	B
(	O
section	O
a6.2	O
(	O
p600	O
)	O
)	O
to	O
vary	O
ei	O
iteratively	O
so	O
as	O
to	O
minimize	O
(	O
cid:10	O
)	O
i	O
(	O
cid:10	O
)	O
.	O
correct	O
the	O
sign	O
of	O
i	O
(	O
multiplying	O
by	O
minus	O
1	O
if	O
necessary	O
)	O
so	O
that	O
et	O
i	O
>	O
0.	O
this	O
is	O
done	O
to	O
ensure	O
that	O
i	O
varies	O
smoothly	O
as	O
a	O
function	O
of	O
ei	O
.	O
(	O
v	O
)	O
upon	O
convergence	O
,	O
f	O
i	O
represents	O
the	O
desired	O
fundamental	B
matrix	I
.	O
algorithm	B
11.2.	O
computation	B
of	I
f	O
with	O
det	O
f	O
=	O
0	O
by	O
iteratively	O
minimizing	B
algebraic	I
error	O
.	O
11.4	O
geometric	B
distance	I
this	O
section	O
describes	O
three	O
algorithms	O
which	O
minimize	O
a	O
geometric	B
image	O
distance	B
.	O
the	O
one	O
we	O
recommend	O
,	O
which	O
is	O
the	O
gold	O
standard	O
method	O
,	O
unfortunately	O
requires	O
the	O
most	O
effort	O
in	O
implementation	O
.	O
the	O
other	O
algorithms	O
produce	O
extremely	O
good	O
results	O
and	O
are	O
easier	O
to	O
implement	O
,	O
but	O
are	O
not	O
optimal	O
under	O
the	O
assumption	O
that	O
the	O
image	O
errors	O
are	O
gaussian	O
.	O
two	O
important	O
issues	O
for	O
each	O
of	O
the	O
algorithms	O
are	O
the	O
intitial-	O
ization	O
for	O
the	O
non-linear	B
minimization	O
,	O
and	O
the	O
parametrization	B
of	I
the	O
cost	B
function	I
.	O
the	O
algorithms	O
are	O
generally	O
initialized	O
by	O
one	O
of	O
the	O
linear	O
algorithms	O
of	O
the	O
previous	O
section	O
.	O
an	O
alternative	O
,	O
which	O
is	O
used	O
in	O
the	O
automatic	O
algorithm	B
,	O
is	O
to	O
select	O
7	O
corre-	O
spondences	O
and	O
thus	O
generate	O
one	O
or	O
three	O
solutions	O
for	O
f.	O
various	O
parametrizations	O
are	O
discussed	O
in	O
section	O
11.4.2.	O
in	O
all	O
cases	O
we	O
recommend	O
that	O
the	O
image	O
points	O
be	O
normalized	O
by	O
a	O
translation	O
and	O
scaling	B
.	O
this	O
normalization	B
does	O
not	O
skew	O
the	O
noise	B
characteristics	O
,	O
so	O
does	O
not	O
interfere	O
with	O
the	O
optimality	O
of	O
the	O
gold	O
standard	O
algo-	O
rithm	O
,	O
which	O
is	O
described	O
next	O
.	O
11.4.1	O
the	O
gold	O
standard	O
method	O
the	O
maximum	O
likelihood	O
estimate	O
of	O
the	O
fundamental	O
matrix	B
depends	O
on	O
the	O
assump-	O
tion	O
of	O
an	O
error	B
model	O
.	O
we	O
make	O
the	O
assumption	O
that	O
noise	B
in	O
image	O
point	O
measure-	O
ments	O
obeys	O
a	O
gaussian	O
distribution	B
.	O
in	O
that	O
case	O
the	O
ml	O
estimate	O
is	O
the	O
one	O
that	O
minimizes	O
the	O
geometric	B
distance	I
(	O
which	O
is	O
reprojection	B
error	I
)	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
(	O
11.6	O
)	O
(	O
cid:7	O
)	O
i	O
where	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
correspondences	B
that	O
satisfy	O
ˆx	O
(	O
cid:2	O
)	O
mated	O
fundamental	B
matrix	I
.	O
i	O
i	O
are	O
the	O
measured	O
correspondences	B
,	O
and	O
ˆxi	O
and	O
ˆx	O
(	O
cid:2	O
)	O
i	O
are	O
estimated	O
“	O
true	O
”	O
tfˆxi	O
=	O
0	O
exactly	O
for	O
some	O
rank-2	O
matrix	B
f	O
,	O
the	O
esti-	O
11.4	O
geometric	B
distance	I
285	O
objective	O
given	O
n	O
≥	O
8	O
image	O
point	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
estimate	O
ˆf	O
of	O
the	O
fundamental	O
matrix	B
.	O
the	O
mle	O
involves	O
also	O
solving	O
for	O
a	O
set	O
of	O
subsidiary	O
point	B
correspondences	O
{	O
ˆxi	O
↔	O
ˆx	O
(	O
cid:1	O
)	O
that	O
ˆx	O
(	O
cid:1	O
)	O
tˆfˆxi	O
=	O
0	O
,	O
and	O
which	O
minimizes	O
(	O
cid:7	O
)	O
i	O
}	O
,	O
determine	O
the	O
maximum	O
likelihood	O
i	O
}	O
,	O
such	O
i	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
)	O
2.	O
algorithm	B
i	O
from	O
ˆf	O
.	O
(	O
i	O
)	O
compute	O
an	O
initial	O
rank	O
2	O
estimate	O
of	O
ˆf	O
using	O
a	O
linear	B
algorithm	I
such	O
as	O
algorithm	O
11.1	O
.	O
(	O
ii	O
)	O
compute	O
an	O
initial	O
estimate	O
of	O
the	O
subsidiary	O
variables	O
{	O
ˆxi	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
}	O
as	O
follows	O
:	O
(	O
a	O
)	O
choose	O
camera	B
matrices	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:1	O
)	O
=	O
[	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×ˆf	O
|	O
e	O
(	O
cid:1	O
)	O
]	O
,	O
where	O
e	O
(	O
cid:1	O
)	O
(	O
b	O
)	O
from	O
the	O
correspondence	B
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
triangulation	B
method	O
of	O
chapter	O
12.	O
i	O
and	O
ˆf	O
determine	O
an	O
estimate	O
of	O
(	O
cid:23	O
)	O
xi	O
using	O
the	O
(	O
c	O
)	O
the	O
correspondence	B
consistent	O
with	O
ˆf	O
is	O
obtained	O
as	O
ˆxi	O
=	O
p	O
(	O
cid:23	O
)	O
xi	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
=	O
p	O
(	O
cid:1	O
)	O
(	O
cid:23	O
)	O
xi	O
.	O
over	O
ˆf	O
and	O
(	O
cid:23	O
)	O
xi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n.	O
the	O
cost	O
is	O
minimized	O
using	O
the	O
levenberg–marquardt	O
algorithm	B
over	O
3n	O
+	O
12	O
variables	O
:	O
3n	O
for	O
the	O
n	O
3d	O
points	O
(	O
cid:23	O
)	O
xi	O
,	O
and	O
12	O
for	O
the	O
camera	B
matrix	I
p	O
(	O
cid:1	O
)	O
=	O
[	O
m	O
|	O
t	O
]	O
,	O
with	O
ˆf	O
=	O
[	O
t	O
]	O
×m	O
,	O
and	O
ˆxi	O
=	O
p	O
(	O
cid:23	O
)	O
xi	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
=	O
p	O
(	O
cid:1	O
)	O
(	O
cid:23	O
)	O
xi	O
.	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
(	O
iii	O
)	O
minimize	O
the	O
cost	O
(	O
cid:7	O
)	O
is	O
obtained	O
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
)	O
2	O
i	O
algorithm	B
11.3.	O
the	O
gold	O
standard	O
algorithm	B
for	O
estimating	B
f	O
from	O
image	O
correspondences	B
.	O
i	O
will	O
satisfy	O
ˆx	O
(	O
cid:2	O
)	O
i	O
=	O
p	O
(	O
cid:2	O
)	O
xi	O
,	O
one	O
varies	O
p	O
(	O
cid:2	O
)	O
this	O
error	B
function	O
may	O
be	O
minimized	O
in	O
the	O
following	O
manner	O
.	O
a	O
pair	O
of	B
camera	I
matrices	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
m	O
|	O
t	O
]	O
are	O
deﬁned	O
.	O
in	O
addition	O
one	O
deﬁnes	O
3d	O
points	O
xi	O
.	O
now	O
letting	O
ˆxi	O
=	O
pxi	O
and	O
ˆx	O
(	O
cid:2	O
)	O
and	O
the	O
points	O
xi	O
so	O
as	O
to	O
minimize	O
the	O
error	B
expression	O
.	O
subsequently	O
f	O
is	O
computed	O
as	O
f	O
=	O
[	O
t	O
]	O
×m	O
.	O
the	O
vectors	O
ˆxi	O
and	O
ˆx	O
(	O
cid:2	O
)	O
tfˆxi	O
=	O
0.	O
minimization	B
of	O
the	O
error	B
is	O
carried	O
out	O
using	O
the	O
levenberg–marquardt	O
algorithm	B
described	O
in	O
section	O
a6.2	O
(	O
p600	O
)	O
.	O
an	O
initial	O
estimate	O
of	O
the	O
parameters	O
is	O
computed	O
using	O
the	O
normalized	O
8-point	O
algorithm	B
,	O
followed	O
by	O
projective	B
reconstruction	I
,	O
as	O
described	O
in	O
chapter	O
12.	O
thus	O
,	O
estimation	B
of	I
the	O
funda-	O
mental	O
matrix	B
using	O
this	O
method	O
is	O
effectively	O
equivalent	B
to	O
projective	B
reconstruction	I
.	O
the	O
steps	O
of	O
the	O
algorithm	O
are	O
summarized	O
in	O
algorithm	O
11.3.	O
i	O
it	O
may	O
seem	O
that	O
this	O
method	O
for	O
computing	O
f	O
will	O
be	O
expensive	O
in	O
computing	O
cost	O
.	O
however	O
,	O
the	O
use	O
of	O
the	O
sparse	B
lm	O
techniques	O
means	O
that	O
it	O
is	O
not	O
much	O
more	O
expensive	O
than	O
other	O
iterative	B
techniques	O
,	O
and	O
details	O
of	O
this	O
are	O
given	O
in	O
section	O
a6.5	O
(	O
p609	O
)	O
.	O
11.4.2	O
parametrization	B
of	I
rank-2	O
matrices	O
the	O
non-linear	B
minimization	O
of	O
the	O
geometric	O
distance	B
cost	O
functions	O
requires	O
a	O
parametrization	B
of	I
the	O
fundamental	B
matrix	I
which	O
enforces	O
the	O
rank	O
2	O
property	O
of	O
the	O
matrix	O
.	O
we	O
describe	O
three	O
such	O
parametrizations	O
.	O
286	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
over-parametrization	B
.	O
one	O
way	O
that	O
we	O
have	O
already	O
seen	O
for	O
parametrizing	O
f	O
is	O
to	O
write	O
f	O
=	O
[	O
t	O
]	O
×m	O
,	O
where	O
m	O
is	O
an	O
arbitrary	O
3	O
×	O
3	O
matrix	B
.	O
this	O
ensures	O
that	O
f	O
is	O
singular	O
,	O
since	O
[	O
t	O
]	O
×	O
is	O
.	O
this	O
way	O
,	O
f	O
is	O
parametrized	O
by	O
the	O
nine	O
entries	O
of	O
m	O
and	O
the	O
three	O
entries	O
of	O
t	O
–	O
a	O
total	O
of	O
12	O
parameters	B
,	O
more	O
than	O
the	O
minimum	O
number	O
of	O
parameters	O
,	O
which	O
is	O
7.	O
in	O
general	O
this	O
should	O
not	O
cause	O
a	O
signiﬁcant	O
problem	O
.	O
epipolar	B
parametrization	I
.	O
an	O
alternative	O
way	O
of	O
parametrizing	O
f	O
is	O
by	O
specifying	O
the	O
ﬁrst	O
two	O
columns	O
of	O
f	O
,	O
along	O
with	O
two	O
multipliers	O
α	O
and	O
β	O
such	O
that	O
the	O
third	O
column	O
may	O
be	O
written	O
as	O
a	O
linear	B
combination	O
f	O
3	O
=	O
αf	O
1	O
+	O
βf	O
2.	O
thus	O
,	O
the	O
fundamental	B
matrix	I
is	O
parametrized	O
as	O
	O
a	O
b	O
αa	O
+	O
βb	O
c	O
d	O
αc	O
+	O
βd	O
e	O
f	O
αe	O
+	O
βf	O
	O
.	O
f	O
=	O
(	O
11.7	O
)	O
this	O
has	O
a	O
total	O
of	O
8	O
parameters	B
.	O
to	O
achieve	O
a	O
minimum	O
set	O
of	O
parameters	O
,	O
one	O
of	O
the	O
elements	O
,	O
for	O
instance	O
f	O
,	O
may	O
be	O
set	O
to	O
1.	O
in	O
practice	O
whichever	O
of	O
a	O
,	O
.	O
.	O
.	O
,	O
f	O
has	O
greatest	O
absolute	O
value	O
is	O
set	O
to	O
1.	O
this	O
method	O
ensures	O
a	O
singular	O
matrix	O
f	O
,	O
while	O
using	O
the	O
minimum	O
number	O
of	O
parameters	O
.	O
the	O
main	O
disadvantage	O
is	O
that	O
it	O
has	O
a	O
singularity	O
–	O
it	O
does	O
not	O
work	O
when	O
the	O
ﬁrst	O
two	O
columns	O
of	O
f	O
are	O
linearly	O
dependent	O
,	O
for	O
then	O
it	O
is	O
not	O
possible	O
to	O
write	O
column	O
3	O
in	O
terms	O
of	O
the	O
ﬁrst	O
two	O
columns	O
.	O
this	O
problem	O
can	O
be	O
signiﬁcant	O
,	O
since	O
it	O
will	O
occur	O
in	O
the	O
case	O
where	O
the	O
right	O
epipole	O
lies	O
at	B
inﬁnity	I
.	O
for	O
then	O
fe	O
=	O
f	O
(	O
e1	O
,	O
e2	O
,	O
0	O
)	O
t	O
=	O
0	O
and	O
the	O
ﬁrst	O
two	O
columns	O
are	O
linearly	O
dependent	O
.	O
nevertheless	O
,	O
this	O
parametrization	B
is	O
widely	O
used	O
and	O
works	O
well	O
if	O
steps	O
are	O
taken	O
to	O
avoid	O
this	O
singularity	O
.	O
instead	O
of	O
using	O
the	O
ﬁrst	O
two	O
columns	O
as	O
a	O
basis	O
,	O
another	O
pair	O
of	O
columns	O
can	O
be	O
used	O
,	O
in	O
which	O
case	O
the	O
singularity	O
occurs	O
when	O
the	O
epipole	O
is	O
on	O
one	O
of	O
the	O
coordinate	O
axes	O
.	O
in	O
practice	O
such	O
singularities	O
can	O
be	O
detected	O
during	O
the	O
minimization	B
and	O
the	O
parametrization	B
switched	O
to	O
one	O
of	O
the	O
alternative	O
parametrizations	O
.	O
note	O
that	O
(	O
α	O
,	O
β	O
,	O
−1	O
)	O
t	O
is	O
the	O
right	O
epipole	O
for	O
this	O
fundamental	B
matrix	I
–	O
the	O
coor-	O
dinates	O
of	O
the	O
epipole	O
occur	O
explicitly	O
in	O
the	O
parametrization	B
.	O
for	O
best	O
results	O
,	O
the	O
parametrization	B
should	O
be	O
chosen	O
so	O
that	O
the	O
largest	O
entry	O
(	O
in	O
absolute	O
value	O
)	O
of	O
the	O
epipole	O
is	O
the	O
one	O
set	O
to	O
1.	O
note	O
how	O
the	O
complete	O
manifold	O
of	O
possible	O
fundamental	O
matrices	O
is	O
not	O
covered	O
by	O
a	O
single	O
parametrization	O
,	O
but	O
rather	O
by	O
a	O
set	O
of	O
minimally	O
parametrized	O
patches	O
.	O
as	O
a	O
path	O
is	O
traced	O
out	O
through	O
the	O
manifold	O
during	O
a	O
parameter	B
minimization	I
procedure	O
,	O
it	O
is	O
necessary	O
to	O
switch	O
from	O
one	O
patch	O
to	O
another	O
as	O
the	O
boundary	O
between	O
patches	O
is	O
crossed	O
.	O
in	O
this	O
case	O
there	O
are	O
actually	O
18	O
different	O
parameter	O
patches	O
,	O
depending	O
on	O
which	O
of	O
a	O
,	O
.	O
.	O
.	O
,	O
f	O
is	O
greatest	O
,	O
and	O
which	O
pair	O
of	O
columns	O
are	O
taken	O
as	O
the	O
basis	O
.	O
both	B
epipoles	I
as	I
parameters	I
.	O
the	O
previous	O
parametrization	B
uses	O
one	O
of	O
the	O
epipoles	O
as	O
part	O
of	O
the	O
parametrization	O
.	O
for	O
symmetry	O
one	O
may	O
use	O
both	O
the	O
epipoles	B
as	O
param-	O
eters	O
.	O
the	O
resulting	O
form	B
of	I
f	O
is	O
f	O
=	O
a	O
c	O
a	O
+	O
β	O
b	O
d	O
b	O
+	O
β	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
c	O
α	O
(	O
cid:2	O
)	O
α	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
d	O
α	O
αa	O
+	O
α	O
αa	O
+	O
βb	O
αc	O
+	O
βd	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
βb	O
+	O
β	O
αc	O
+	O
β	O
(	O
cid:2	O
)	O
βd	O
(	O
11.8	O
)	O
	O
.	O
	O
11.4	O
geometric	B
distance	I
287	O
,	O
−1	O
)	O
t.	O
as	O
above	O
,	O
one	O
can	O
set	O
one	O
of	O
the	O
two	O
epipoles	B
are	O
(	O
α	O
,	O
β	O
,	O
−1	O
)	O
t	O
and	O
(	O
α	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
to	O
1.	O
to	O
avoid	O
singularities	O
,	O
one	O
must	O
switch	O
between	O
different	O
choices	O
of	O
the	O
two	O
rows	O
and	O
two	O
columns	O
to	O
use	O
as	O
the	O
basis	O
.	O
along	O
with	O
four	O
choices	O
of	O
which	O
of	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
to	O
set	O
to	O
1	O
,	O
there	O
are	O
a	O
total	O
of	O
36	O
parameter	O
patches	O
used	O
to	O
cover	O
the	O
complete	O
manifold	O
of	O
fundamental	O
matrices	O
.	O
,	O
β	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
11.4.3	O
first-order	O
geometric	B
error	I
(	O
sampson	O
distance	B
)	O
the	O
concept	O
of	O
sampson	O
distance	B
was	O
discussed	O
at	O
length	O
in	O
section	O
4.2.6	O
(	O
p98	O
)	O
.	O
here	O
the	O
sampson	O
approximation	O
is	O
used	O
in	O
the	O
case	O
of	O
the	O
variety	O
deﬁned	O
by	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
to	O
provide	O
a	O
ﬁrst-order	O
approximation	O
to	O
the	O
geometric	B
error	I
.	O
the	O
general	O
formula	O
for	O
the	O
sampson	O
cost	B
function	I
is	O
given	O
in	O
(	O
4.13–p100	O
)	O
.	O
in	O
the	O
case	O
of	O
fundamental	O
matrix	B
estimation	O
,	O
the	O
formula	O
is	O
even	O
simpler	O
,	O
since	O
there	O
is	O
only	O
one	O
equation	O
per	O
point	B
correspondence	O
(	O
see	O
also	O
example	O
4.2	O
(	O
p100	O
)	O
)	O
.	O
the	O
partial-	O
derivative	B
matrix	I
j	O
has	O
only	O
one	O
row	O
,	O
and	O
hence	O
jjt	O
is	O
a	O
scalar	O
and	O
(	O
4.12–p99	O
)	O
becomes	O
t	O
jjt	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
tfxi	O
)	O
2	O
i	O
jjt	O
.	O
from	O
the	O
deﬁnition	B
of	O
j	O
and	O
the	O
explicit	O
form	B
of	I
ai	O
=	O
x	O
(	O
cid:2	O
)	O
of	O
(	O
11.2	O
)	O
,	O
we	O
obtain	O
i	O
tfxi	O
given	O
in	O
the	O
left	O
hand	O
side	O
jjt	O
=	O
(	O
fxi	O
)	O
2	O
1	O
+	O
(	O
fxi	O
)	O
2	O
2	O
+	O
(	O
ftx	O
(	O
cid:2	O
)	O
1	O
+	O
(	O
ftx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
i	O
)	O
2	O
2	O
where	O
for	O
instance	O
(	O
fxi	O
)	O
2	O
the	O
cost	B
function	I
is	O
(	O
cid:7	O
)	O
j	O
represents	O
the	O
square	O
of	O
the	O
j-th	O
entry	O
of	O
the	O
vector	O
fxi	O
.	O
thus	O
,	O
(	O
x	O
(	O
cid:2	O
)	O
tfxi	O
)	O
2	O
2	O
+	O
(	O
ftx	O
(	O
cid:2	O
)	O
1	O
+	O
(	O
ftx	O
(	O
cid:2	O
)	O
1	O
+	O
(	O
fxi	O
)	O
2	O
i	O
)	O
2	O
i	O
)	O
2	O
2	O
i	O
(	O
fxi	O
)	O
2	O
.	O
(	O
11.9	O
)	O
i	O
this	O
gives	O
a	O
ﬁrst-order	O
approximation	O
to	O
geometric	O
error	B
,	O
which	O
may	O
be	O
expected	O
to	O
give	O
good	O
results	O
if	O
higher	O
order	O
terms	O
are	O
small	O
in	O
comparison	O
to	O
the	O
ﬁrst	O
.	O
the	O
ap-	O
proximation	O
has	O
been	O
used	O
successfully	O
in	O
estimation	O
algorithms	O
by	O
[	O
torr-97	O
,	O
torr-98	O
,	O
zhang-98	O
]	O
.	O
note	O
that	O
this	O
approximation	O
is	O
undeﬁned	O
at	O
the	O
point	B
in	O
ir4	O
determined	O
by	O
the	O
two	O
epipoles	O
,	O
as	O
here	O
jjt	O
is	O
zero	O
.	O
this	O
point	B
should	O
be	O
avoided	O
in	O
any	O
numerical	O
implementation	B
.	O
the	O
key	O
advantage	O
of	O
approximating	O
the	O
geometric	B
error	I
in	O
this	O
way	O
is	O
that	O
the	O
result-	O
ing	O
cost	B
function	I
only	O
involves	O
the	O
parameters	B
of	O
f.	O
this	O
means	O
that	O
to	O
ﬁrst-order	O
the	O
gold	O
standard	O
cost	B
function	I
(	O
11.6	O
)	O
is	O
minimized	O
without	O
introducing	O
a	O
set	O
of	O
subsidiary	O
variables	O
,	O
namely	O
the	O
coordinates	B
of	O
the	O
n	O
space	O
points	O
xi	O
.	O
consequently	O
a	O
minimiza-	O
tion	O
problem	O
with	O
7	O
+	O
3n	O
degrees	B
of	I
freedom	I
is	O
reduced	B
to	O
one	O
with	O
only	O
7	O
degrees	B
of	I
freedom	I
.	O
symmetric	B
epipolar	I
distance	I
.	O
equation	O
(	O
11.9	O
)	O
is	O
similar	O
in	O
form	O
to	O
another	O
cost	B
function	I
(	O
cid:7	O
)	O
i	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
fxi	O
)	O
2	O
+	O
d	O
(	O
xi	O
,	O
ftx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
288	O
(	O
cid:7	O
)	O
i	O
=	O
(	O
cid:20	O
)	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
(	O
x	O
(	O
cid:2	O
)	O
tfxi	O
)	O
2	O
+	O
1	O
1	O
(	O
ftx	O
(	O
cid:2	O
)	O
1	O
+	O
(	O
ftx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
i	O
)	O
2	O
2	O
i	O
(	O
fxi	O
)	O
2	O
1	O
+	O
(	O
fxi	O
)	O
2	O
2	O
(	O
cid:21	O
)	O
(	O
11.10	O
)	O
which	O
minimizes	O
the	O
distance	B
of	O
a	O
point	B
from	O
its	O
projected	O
epipolar	B
line	I
,	O
computed	O
in	O
each	O
of	O
the	O
images	O
.	O
however	O
,	O
this	O
cost	B
function	I
seems	O
to	O
give	O
slightly	O
inferior	O
results	O
to	O
(	O
11.9	O
)	O
(	O
see	O
[	O
zhang-98	O
]	O
)	O
,	O
and	O
hence	O
is	O
not	O
discussed	O
further	O
.	O
11.5	O
experimental	B
evaluation	I
of	O
the	O
algorithms	O
three	O
of	O
the	O
algorithms	O
of	O
the	O
previous	O
sections	O
are	O
now	O
compared	O
by	O
estimating	B
f	O
from	O
point	O
correspondences	O
for	O
a	O
number	O
of	O
image	O
pairs	O
.	O
the	O
algorithms	O
are	O
:	O
(	O
i	O
)	O
the	O
normalized	O
8-point	O
algorithm	B
(	O
algorithm	B
11.1	O
)	O
.	O
(	O
ii	O
)	O
minimization	B
of	O
algebraic	B
error	I
whilst	O
imposing	O
the	O
singularity	B
constraint	I
(	O
algorithm	B
11.2	O
)	O
.	O
(	O
iii	O
)	O
the	O
gold	O
standard	O
geometric	B
algorithm	O
(	O
algorithm	B
11.3	O
)	O
.	O
the	O
experimental	O
procedure	O
was	O
as	O
follows	O
.	O
for	O
each	O
pair	O
of	O
images	O
,	O
a	O
number	O
n	O
of	O
matched	O
points	O
were	O
chosen	O
randomly	O
from	O
the	O
matches	O
and	O
the	O
fundamental	B
matrix	I
estimated	O
and	O
residual	B
error	O
(	O
see	O
below	O
)	O
computed	O
.	O
this	O
experiment	O
was	O
repeated	O
100	O
times	O
for	O
each	O
value	O
of	O
n	O
and	O
each	O
pair	O
of	O
images	O
,	O
and	O
the	O
average	O
residual	B
error	O
plotted	O
against	O
n.	O
this	O
gives	O
an	O
idea	O
of	O
how	O
the	O
different	O
algorithms	O
behave	O
as	O
the	O
number	O
of	O
points	O
is	O
increased	O
.	O
the	O
number	O
of	O
points	O
used	O
,	O
n	O
,	O
ranged	O
from	O
8	O
up	O
to	O
three-quarters	O
of	O
the	O
total	O
number	O
of	O
matched	O
points	O
.	O
residual	B
error	O
the	O
error	B
is	O
deﬁned	O
as	O
n	O
(	O
cid:7	O
)	O
i	O
1	O
n	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
fxi	O
)	O
2	O
+	O
d	O
(	O
xi	O
,	O
ftx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
where	O
d	O
(	O
x	O
,	O
l	O
)	O
here	O
is	O
the	O
distance	B
(	O
in	O
pixels	O
)	O
between	O
a	O
point	B
x	O
and	O
a	O
line	B
l.	O
the	O
error	B
is	O
the	O
squared	O
distance	O
between	O
a	O
point	B
’	O
s	O
epipolar	B
line	I
and	O
the	O
matching	B
point	O
in	O
the	O
other	O
image	O
(	O
computed	O
for	O
both	O
points	O
of	O
the	O
match	O
)	O
,	O
averaged	O
over	O
all	O
n	O
matches	O
.	O
note	O
the	O
error	B
is	O
evaluated	O
over	O
all	O
n	O
matched	O
points	O
,	O
and	O
not	O
just	O
the	O
n	O
matches	O
used	O
to	O
com-	O
pute	O
f.	O
the	O
residual	B
error	O
corresponds	O
to	O
the	O
epipolar	B
distance	I
deﬁned	O
in	O
(	O
11.10	O
)	O
.	O
note	O
that	O
this	O
particular	O
error	B
is	O
not	O
minimized	O
directly	O
by	O
any	O
of	O
the	O
algorithms	O
evaluated	O
here	O
.	O
the	O
various	O
algorithms	O
were	O
tried	O
with	O
5	O
different	O
pairs	O
of	O
images	O
.	O
the	O
images	O
are	O
presented	O
in	O
ﬁgure	O
11.2	O
and	O
show	O
the	O
diversity	O
of	O
image	O
types	O
,	O
and	O
placement	O
of	O
the	O
epipoles	O
.	O
a	O
few	O
of	O
the	O
epipolar	O
lines	B
are	O
shown	O
in	O
the	O
images	O
.	O
the	O
intersection	B
of	O
the	O
pencil	O
of	B
lines	I
is	O
the	O
epipole	O
.	O
there	O
was	O
a	O
wide	O
variation	O
in	O
the	O
accuracy	O
of	O
the	O
matched	O
points	O
for	O
the	O
different	O
images	O
,	O
though	O
mismatches	O
were	O
removed	O
in	O
a	O
pre-processing	O
step	O
.	O
results	O
.	O
the	O
results	O
of	O
these	O
experiments	O
are	O
shown	O
and	O
explained	O
in	O
ﬁgure	O
11.3.	O
they	O
show	O
that	O
minimizing	B
algebraic	I
error	O
gives	O
essentially	O
indistinguishable	O
results	O
from	O
minimizing	B
geometric	I
error	O
.	O
11.5	O
experimental	B
evaluation	I
of	O
the	O
algorithms	O
289	O
houses	O
images	O
statue	O
image	O
grenoble	O
museum	O
corridor	B
scene	I
calibration	O
rig	O
fig	O
.	O
11.2.	O
image	O
pairs	O
used	O
for	O
the	O
algorithm	B
comparison	O
.	O
in	O
the	O
top	O
two	O
the	O
epipoles	B
are	O
far	O
from	O
the	O
image	O
centres	O
.	O
in	O
the	O
middle	O
two	O
the	O
epipoles	B
are	O
close	O
(	O
grenoble	O
)	O
and	O
in	O
the	O
image	O
(	O
corridor	O
)	O
.	O
for	O
the	O
calibration	B
images	O
the	O
matched	O
points	O
are	O
known	O
extremely	O
accurately	O
.	O
11.5.1	O
recommendations	B
several	O
methods	O
of	O
computing	O
the	O
fundamental	B
matrix	I
have	O
been	O
discussed	O
in	O
this	O
chapter	O
,	O
and	O
some	O
pointers	O
on	O
which	O
method	O
to	O
use	O
are	O
perhaps	O
desirable	O
.	O
brieﬂy	O
,	O
these	O
are	O
our	O
recommendations	B
:	O
•	O
do	O
not	O
use	O
the	O
unnormalized	O
8-point	O
algorithm	B
.	O
•	O
for	O
a	O
quick	O
method	O
,	O
easy	O
to	O
implement	O
,	O
use	O
the	O
normalized	O
8-point	O
algorithm	B
11.1.	O
this	O
often	O
gives	O
adequate	O
results	O
,	O
and	O
is	O
ideal	O
as	O
a	O
ﬁrst	O
step	O
in	O
other	O
algorithms	O
.	O
•	O
if	O
more	O
accuracy	O
is	O
desired	O
,	O
use	O
the	O
algebraic	B
minimization	I
method	O
,	O
either	O
with	O
or	O
without	O
iteration	B
on	O
the	O
position	O
of	O
the	O
epipole	O
.	O
•	O
as	O
an	O
alternative	O
that	O
gives	O
excellent	O
results	O
,	O
use	O
an	O
iterative-minimization	O
method	O
that	O
minimizes	O
the	O
sampson	O
cost	B
function	I
(	O
11.9	O
)	O
.	O
this	O
and	O
the	O
iterative	B
algebraic	O
method	O
give	O
similar	O
results	O
.	O
•	O
to	O
be	O
certain	O
of	O
getting	O
the	O
best	O
results	O
,	O
if	O
gaussian	O
noise	B
is	O
a	O
viable	O
assumption	O
,	O
implement	O
the	O
gold	O
standard	O
algorithm	B
.	O
290	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
5	O
4	O
3	O
2	O
1	O
0	O
r	O
o	O
r	O
r	O
e	O
houses	O
25	O
20	O
15	O
10	O
5	O
0	O
r	O
o	O
r	O
r	O
e	O
statue	O
3	O
2.5	O
2	O
r	O
o	O
r	O
r	O
e	O
1.5	O
1	O
0.5	O
5	O
10	O
20	O
15	O
25	O
number	O
of	O
points	O
30	O
35	O
6	O
8	O
10	O
12	O
14	O
16	O
18	O
20	O
22	O
5	O
10	O
number	O
of	O
points	O
museum	O
20	O
15	O
number	O
of	O
points	O
25	O
30	O
35	O
2	O
1.5	O
r	O
o	O
r	O
r	O
e	O
1	O
0.5	O
0	O
corridor	O
6	O
8	O
10	O
12	O
14	O
16	O
18	O
20	O
22	O
r	O
o	O
r	O
r	O
e	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
0	O
5	O
calibration	B
10	O
15	O
20	O
25	O
30	O
35	O
number	O
of	O
points	O
number	O
of	O
points	O
fig	O
.	O
11.3.	O
results	O
of	O
the	O
experimental	B
evaluation	I
of	O
the	O
algorithms	O
.	O
in	O
each	O
case	O
,	O
three	O
methods	O
of	O
computing	O
f	O
are	O
compared	O
.	O
residual	B
error	O
is	O
plotted	O
against	O
the	O
number	O
of	O
points	O
used	O
to	O
compute	O
f.	O
in	O
each	O
graph	O
,	O
the	O
top	O
(	O
solid	O
line	B
)	O
shows	O
the	O
results	O
of	O
the	O
normalized	O
8-point	O
algorithm	B
.	O
also	O
shown	O
are	O
the	O
results	O
of	O
minimizing	B
geometric	I
error	O
(	O
long	O
dashed	O
line	B
)	O
and	O
iteratively	O
minimizing	B
algebraic	I
error	O
subject	O
to	O
the	O
determinant	O
constraint	O
(	O
short	O
dashed	O
line	B
)	O
.	O
in	O
most	O
cases	O
,	O
the	O
result	O
of	O
iteratively	O
minimizing	B
algebraic	I
error	O
is	O
almost	O
indistinguishable	O
from	O
minimizing	O
geometric	B
error	I
.	O
both	O
are	O
no-	O
ticeably	O
better	O
than	O
the	O
non-iterative	O
normalized	O
8-point	O
algorithm	B
,	O
though	O
that	O
algorithm	B
also	O
gives	O
good	O
results	O
.	O
11.6	O
automatic	O
computation	B
of	I
f	O
this	O
section	O
describes	O
an	O
algorithm	B
to	O
compute	O
the	O
epipolar	B
geometry	O
between	O
two	O
images	O
automatically	O
.	O
the	O
input	O
to	O
the	O
algorithm	B
is	O
simply	O
the	O
pair	O
of	O
images	O
,	O
with	O
no	O
other	O
a	O
priori	O
information	O
required	O
;	O
and	O
the	O
output	O
is	O
the	O
estimated	O
fundamental	B
matrix	I
together	O
with	O
a	O
set	O
of	O
interest	O
points	O
in	O
correspondence	B
.	O
the	O
algorithm	B
uses	O
ransac	O
as	O
a	O
search	O
engine	O
in	O
a	O
similar	O
manner	O
to	O
its	O
use	O
in	O
the	O
automatic	O
computation	B
of	I
a	O
homography	B
described	O
in	O
section	O
4.8	O
(	O
p123	O
)	O
.	O
the	O
ideas	O
and	O
details	O
of	O
the	O
algorithm	O
are	O
given	O
there	O
,	O
and	O
are	O
not	O
repeated	O
here	O
.	O
the	O
method	O
is	O
summarized	O
in	O
algorithm	O
11.4	O
,	O
with	O
an	O
example	O
of	O
its	O
use	O
shown	O
in	O
ﬁgure	O
11.4.	O
a	O
few	O
remarks	O
on	O
the	O
method	O
:	O
(	O
i	O
)	O
the	O
ransac	O
sample	O
.	O
only	O
7	O
point	B
correspondences	O
are	O
used	O
to	O
estimate	O
f.	O
this	O
has	O
the	O
advantage	O
that	O
a	O
rank	O
2	O
matrix	B
is	O
produced	O
,	O
and	O
it	O
is	O
not	O
necessary	O
to	O
coerce	O
the	O
matrix	B
to	O
rank	O
2	O
as	O
in	O
the	O
linear	B
algorithms	O
.	O
a	O
second	O
reason	O
for	O
using	O
7	O
correspondences	B
,	O
rather	O
than	O
8	O
say	O
with	O
a	O
linear	B
algorithm	I
,	O
is	O
that	O
the	O
number	B
of	I
samples	I
that	O
must	O
be	O
tried	O
in	O
order	O
to	O
ensure	O
a	O
high	O
probability	O
of	O
no	O
outliers	O
is	O
exponential	O
in	O
the	O
size	O
of	O
the	O
sample	O
set	O
.	O
for	O
example	O
,	O
from	O
table	O
4.3-	O
(	O
p119	O
)	O
for	O
a	O
99	O
%	O
conﬁdence	O
of	O
no	O
outliers	O
(	O
when	O
drawing	O
from	O
a	O
set	O
containing	O
50	O
%	O
outliers	O
)	O
twice	O
as	O
many	O
samples	O
are	O
required	O
for	O
8	O
correspondences	B
as	O
for	O
7.	O
the	O
slight	O
disadvantage	O
in	O
using	O
7	O
correspondences	B
is	O
that	O
it	O
may	O
result	O
in	O
3	O
real	O
solutions	O
for	O
f	O
,	O
and	O
all	O
3	O
must	O
be	O
tested	O
for	O
support	O
.	O
11.6	O
automatic	O
computation	B
of	I
f	O
291	O
objective	O
compute	O
the	O
fundamental	B
matrix	I
between	O
two	O
images	O
.	O
algorithm	B
(	O
i	O
)	O
interest	B
points	I
:	O
compute	O
interest	B
points	I
in	O
each	O
image	O
.	O
(	O
ii	O
)	O
putative	O
correspondences	B
:	O
compute	O
a	O
set	O
of	O
interest	O
point	B
matches	O
based	O
on	O
proxim-	O
ity	O
and	O
similarity	B
of	O
their	O
intensity	O
neighbourhood	O
.	O
(	O
iii	O
)	O
ransac	O
robust	B
estimation	O
:	O
repeat	O
for	O
n	O
samples	O
,	O
where	O
n	O
is	O
determined	O
adap-	O
tively	O
as	O
in	O
algorithm	B
4.5	O
(	O
p121	O
)	O
:	O
(	O
a	O
)	O
select	O
a	O
random	O
sample	O
of	O
7	O
correspondences	B
and	O
compute	O
the	O
fundamental	B
matrix	I
f	O
as	O
described	O
in	O
section	O
11.1.2.	O
there	O
will	O
be	O
one	O
or	O
three	O
real	O
solutions	O
.	O
(	O
b	O
)	O
calculate	O
the	O
distance	B
d⊥	O
for	O
each	O
putative	O
correspondence	B
.	O
(	O
c	O
)	O
compute	O
the	O
number	O
of	O
inliers	O
consistent	O
with	O
f	O
by	O
the	O
number	O
of	O
correspon-	O
dences	O
for	O
which	O
d⊥	O
<	O
t	O
pixels	O
.	O
(	O
d	O
)	O
if	O
there	O
are	O
three	O
real	O
solutions	O
for	O
f	O
the	O
number	O
of	O
inliers	O
is	O
computed	O
for	O
each	O
solution	B
,	O
and	O
the	O
solution	B
with	O
most	O
inliers	O
retained	O
.	O
choose	O
the	O
f	O
with	O
the	O
largest	O
number	O
of	O
inliers	O
.	O
in	O
the	O
case	O
of	O
ties	O
choose	O
the	O
solution	B
that	O
has	O
the	O
lowest	O
standard	O
deviation	O
of	O
inliers	O
.	O
(	O
iv	O
)	O
non-linear	B
estimation	O
:	O
re-estimate	O
f	O
from	O
all	O
correspondences	B
classiﬁed	O
as	O
inliers	O
by	O
minimizing	B
a	O
cost	B
function	I
,	O
e.g	O
.	O
(	O
11.6	O
)	O
,	O
using	O
the	O
levenberg–marquardt	O
algorithm	B
of	O
section	O
a6.2	O
(	O
p600	O
)	O
.	O
(	O
v	O
)	O
guided	B
matching	I
:	O
further	O
interest	O
point	O
correspondences	B
are	O
now	O
determined	O
using	O
the	O
estimated	O
f	O
to	O
deﬁne	O
a	O
search	O
strip	O
about	O
the	O
epipolar	B
line	I
.	O
the	O
last	O
two	O
steps	O
can	O
be	O
iterated	O
until	O
the	O
number	O
of	O
correspondences	O
is	O
stable	O
.	O
algorithm	B
11.4.	O
algorithm	B
to	O
automatically	O
estimate	O
the	O
fundamental	B
matrix	I
between	O
two	O
images	O
using	O
ransac	O
.	O
(	O
ii	O
)	O
the	O
distance	B
measure	O
.	O
given	O
a	O
current	O
estimate	O
of	O
f	O
(	O
from	O
the	O
ransac	O
sample	O
)	O
the	O
distance	B
d⊥	O
measures	O
how	O
closely	O
a	O
matched	O
pair	O
of	B
points	I
satis-	O
ﬁes	O
the	O
epipolar	B
geometry	O
.	O
there	O
are	O
two	O
clear	O
choices	O
for	O
d⊥	O
:	O
reprojection	B
error	I
,	O
i.e	O
.	O
the	O
distance	B
minimized	O
in	O
the	O
cost	B
function	I
(	O
11.6	O
)	O
(	O
the	O
value	O
may	O
be	O
obtained	O
using	O
the	O
triangulation	B
algorithm	O
of	O
section	O
12.5	O
)	O
;	O
or	O
the	O
sampson	O
approximation	O
to	O
reprojection	O
error	B
(	O
d2⊥	O
is	O
given	O
by	O
(	O
11.9	O
)	O
)	O
.	O
if	O
the	O
sampson	O
approximation	O
is	O
used	O
,	O
then	O
the	O
sampson	O
cost	B
function	I
should	O
be	O
used	O
to	O
itera-	O
tively	O
estimate	O
f.	O
otherwise	O
distances	O
used	O
in	O
ransac	O
and	O
elsewhere	O
in	O
the	O
algorithm	B
will	O
be	O
inconsistent	O
.	O
(	O
iii	O
)	O
guided	B
matching	I
.	O
the	O
current	O
estimate	O
of	O
f	O
deﬁnes	O
a	O
search	O
band	O
in	O
the	O
sec-	O
ond	O
image	O
around	O
the	O
epipolar	B
line	I
fx	O
of	O
x.	O
for	O
each	O
corner	O
x	O
a	O
match	O
is	O
sought	O
within	O
this	O
band	O
.	O
since	O
the	O
search	O
area	O
is	O
restricted	O
a	O
weaker	O
similarity	B
thresh-	O
old	O
can	O
be	O
employed	O
,	O
and	O
it	O
is	O
not	O
necessary	O
to	O
enforce	O
a	O
“	O
winner	O
takes	O
all	O
”	O
scheme	O
.	O
(	O
iv	O
)	O
implementation	B
and	O
run	B
details	I
.	O
for	O
the	O
example	O
of	O
ﬁgure	O
11.4	O
,	O
the	O
search	O
window	O
was	O
±300	O
pixels	O
.	O
the	O
inlier	O
threshold	O
was	O
t	O
=	O
1.25	O
pixels	O
.	O
a	O
total	O
of	O
407	O
samples	O
were	O
required	O
.	O
the	O
rms	O
pixel	O
error	B
after	O
ransac	O
was	O
0.34	O
(	O
for	O
99	O
correspondences	B
)	O
,	O
and	O
after	O
mle	O
and	O
guided	B
matching	I
it	O
was	O
0.33	O
(	O
for	O
157	O
correspondences	B
)	O
.	O
the	O
guided	B
matching	I
mle	O
required	O
10	O
iterations	O
of	O
the	O
levenberg–marquardt	O
algorithm	B
.	O
292	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
a	O
c	O
e	O
g	O
b	O
d	O
f	O
h	O
fig	O
.	O
11.4.	O
automatic	O
computation	B
of	I
the	O
fundamental	B
matrix	I
between	O
two	O
images	O
using	O
ransac	O
.	O
(	O
a	O
)	O
(	O
b	O
)	O
left	O
and	O
right	O
images	O
of	O
keble	O
college	O
,	O
oxford	O
.	O
the	O
motion	O
between	O
views	O
is	O
a	O
translation	O
and	O
rotation	B
.	O
the	O
images	O
are	O
640	O
×	O
480	O
pixels	O
.	O
(	O
c	O
)	O
(	O
d	O
)	O
detected	O
corners	O
superimposed	O
on	O
the	O
images	O
.	O
there	O
are	O
approximately	O
500	O
corners	O
on	O
each	O
image	O
.	O
the	O
following	O
results	O
are	O
superimposed	O
on	O
the	O
left	O
image	O
:	O
(	O
e	O
)	O
188	O
putative	O
matches	O
shown	O
by	O
the	O
line	B
linking	O
corners	O
,	O
note	O
the	O
clear	O
mismatches	O
;	O
(	O
f	O
)	O
outliers	O
–	O
89	O
of	O
the	O
putative	O
matches	O
.	O
(	O
g	O
)	O
inliers	O
–	O
99	O
correspondences	B
consistent	O
with	O
the	O
estimated	O
f	O
;	O
(	O
h	O
)	O
ﬁnal	O
set	O
of	O
157	O
correspondences	B
after	O
guided	B
matching	I
and	O
mle	O
.	O
there	O
are	O
still	O
a	O
few	O
mismatches	O
evident	O
,	O
e.g	O
.	O
the	O
long	O
line	B
on	O
the	O
left	O
.	O
11.7	O
special	O
cases	O
of	O
f-computation	O
293	O
e	O
image	O
fig	O
.	O
11.5.	O
for	O
a	O
pure	O
translation	O
the	O
epipole	O
can	O
be	O
estimated	O
from	O
the	O
image	O
motion	O
of	O
two	O
points	O
.	O
11.7	O
special	O
cases	O
of	O
f-computation	O
certain	O
special	O
cases	O
of	O
motion	O
,	O
or	O
partially	O
known	O
camera	O
calibration	B
,	O
allow	O
computa-	O
tion	O
of	O
the	O
fundamental	O
matrix	B
to	O
be	O
simpliﬁed	O
.	O
in	O
each	O
case	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
fundamental	O
matrix	B
is	O
less	O
than	O
the	O
7	O
of	O
general	O
motion	O
.	O
we	O
give	O
three	O
examples	B
.	O
11.7.1	O
pure	O
translational	B
motion	I
this	O
is	O
the	O
simplest	O
possible	O
case	O
.	O
the	O
matrix	B
can	O
be	O
estimated	O
linearly	O
whilst	O
si-	O
multaneously	O
imposing	O
the	O
constraints	B
that	O
the	O
matrix	B
must	O
satisfy	O
,	O
namely	O
that	O
it	O
is	O
skew-symmetric	O
(	O
see	O
section	O
9.3.1	O
(	O
p247	O
)	O
)	O
,	O
and	O
thus	O
has	O
the	O
required	O
rank	O
of	O
2.	O
in	O
this	O
case	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
,	O
and	O
has	O
two	O
degrees	O
of	O
freedom	O
.	O
it	O
may	O
be	O
parametrized	O
by	O
the	O
three	O
entries	O
of	O
e	O
(	O
cid:2	O
)	O
.	O
each	O
point	B
correspondence	O
provides	O
one	O
linear	B
constraint	O
on	O
the	O
homogeneous	O
pa-	O
rameters	O
,	O
as	O
is	O
clear	O
from	O
ﬁgure	O
11.5.	O
the	O
matrix	B
can	O
be	O
computed	O
uniquely	O
from	O
two	O
point	O
correspondences	B
.	O
note	O
,	O
in	O
the	O
general	B
motion	I
case	O
if	O
all	O
3d	O
points	O
are	O
coplanar	O
,	O
which	O
is	O
a	O
structure	B
degeneracy	O
(	O
see	O
section	O
11.9	O
)	O
,	O
the	O
fundamental	B
matrix	I
can	O
not	O
be	O
determined	O
uniquely	O
from	O
image	O
correspondences	B
.	O
however	O
,	O
for	O
pure	O
translational	B
motion	I
this	O
is	O
not	O
a	O
prob-	O
lem	O
(	O
two	O
3d	O
points	O
are	O
always	O
coplanar	O
)	O
.	O
the	O
only	O
degeneracy	B
is	O
if	O
the	O
two	O
3d	O
points	O
are	O
coplanar	O
with	O
both	O
camera	B
centres	O
.	O
this	O
special	O
form	O
also	O
simpliﬁes	O
the	O
gold	O
standard	O
estimation	B
,	O
and	O
correspondingly	O
triangulation	B
for	O
structure	B
recovery	O
.	O
the	O
gold	O
standard	O
estimation	B
of	I
the	O
epipole	O
from	O
point	O
correspondences	O
under	O
pure	O
translation	O
is	O
identical	O
to	O
the	O
estimation	B
of	I
a	O
vanish-	O
ing	O
point	B
given	O
the	O
end	O
points	O
of	O
a	O
set	O
of	O
imaged	O
parallel	B
lines	I
,	O
see	O
section	O
8.6.1	O
(	O
p213	O
)	O
.	O
11.7.2	O
planar	B
motion	I
in	O
the	O
case	O
of	O
planar	O
motion	O
,	O
described	O
in	O
section	O
9.3.2	O
(	O
p250	O
)	O
,	O
we	O
require	O
that	O
the	O
symmetric	B
part	I
of	O
f	O
has	O
rank	O
2	O
,	O
in	O
addition	O
to	O
the	O
standard	O
rank	O
2	O
condition	O
for	O
the	O
full	O
matrix	O
.	O
it	O
can	O
be	O
veriﬁed	O
that	O
the	O
parametrization	B
of	I
(	O
9.8–p252	O
)	O
,	O
namely	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
[	O
ls	O
]	O
×	O
[	O
e	O
]	O
×	O
,	O
satisﬁes	O
both	O
these	O
conditions	O
.	O
if	O
unconstrained	O
3-vectors	O
are	O
used	O
to	O
represent	O
e	O
(	O
cid:2	O
)	O
,	O
ls	O
and	O
e	O
then	O
9	O
parameters	B
are	O
used	O
,	O
whereas	O
the	O
fundamental	B
matrix	I
for	O
planar	B
motion	I
has	O
only	O
6	O
degrees	B
of	I
freedom	I
.	O
as	O
usual	O
this	O
over-parametrization	B
is	O
not	O
a	O
problem	O
.	O
294	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
an	O
alternative	O
parametrization	B
with	O
similar	O
properties	B
is	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
f	O
=	O
α	O
[	O
xa	O
]	O
×	O
+	O
β	O
lslt	O
h	O
+	O
lhlt	O
s	O
with	O
xt	O
alh	O
=	O
0	O
where	O
α	O
and	O
β	O
are	O
scalars	O
,	O
and	O
the	O
meaning	O
of	O
the	O
3-vectors	O
xa	O
,	O
ls	O
and	O
lh	O
is	O
evident	O
from	O
ﬁgure	O
9.11	O
(	O
p253	O
)	O
(	O
a	O
)	O
.	O
i	O
11.7.3	O
the	O
calibrated	B
case	O
in	O
the	O
case	O
of	O
calibrated	O
cameras	B
normalized	O
image	O
coordinates	O
may	O
be	O
used	O
,	O
and	O
the	O
essential	B
matrix	I
e	O
computed	O
instead	O
of	O
the	O
fundamental	O
matrix	B
.	O
as	O
with	O
the	O
fundamen-	O
tal	O
matrix	B
,	O
the	O
essential	B
matrix	I
may	O
be	O
computed	O
using	O
linear	B
techniques	O
from	O
8	O
points	O
or	O
more	O
,	O
since	O
corresponding	O
points	O
satisfy	O
the	O
deﬁning	O
equation	O
x	O
(	O
cid:2	O
)	O
texi	O
=	O
0.	O
where	O
the	O
method	O
differs	O
from	O
the	O
computation	B
of	I
the	O
fundamental	B
matrix	I
is	O
in	O
the	O
enforcement	O
of	O
the	O
constraints	O
.	O
for	O
,	O
whereas	O
the	O
fundamental	B
matrix	I
satisﬁes	O
det	O
f	O
=	O
0	O
,	O
the	O
essential	B
matrix	I
satisﬁes	O
the	O
additional	O
condition	O
that	O
its	O
two	O
singular	O
values	O
are	O
equal	O
.	O
this	O
constraint	O
may	O
be	O
handled	O
by	O
the	O
following	O
result	O
,	O
which	O
is	O
offered	O
here	O
without	O
proof	O
.	O
result	O
11.1.	O
let	O
e	O
be	O
a	O
3	O
×	O
3	O
matrix	B
with	O
svd	O
given	O
by	O
e	O
=	O
udvt	O
,	O
where	O
d	O
=	O
diag	O
(	O
a	O
,	O
b	O
,	O
c	O
)	O
with	O
a	O
≥	O
b	O
≥	O
c.	O
then	O
the	O
closest	O
essential	B
matrix	I
to	O
e	O
in	O
frobenius	O
norm	B
is	O
given	O
by	O
ˆe	O
=	O
uˆdvt	O
,	O
where	O
ˆd	O
=	O
diag	O
(	O
(	O
a	O
+	O
b	O
)	O
/2	O
,	O
(	O
a	O
+	O
b	O
)	O
/2	O
,	O
0	O
)	O
.	O
if	O
the	O
goal	O
is	O
to	O
compute	O
the	O
two	O
normalized	O
camera	B
matrices	I
p	O
and	O
p	O
(	O
cid:2	O
)	O
as	O
part	O
of	O
a	O
reconstruction	O
process	O
,	O
then	O
it	O
is	O
not	O
actually	O
necessary	O
to	O
compute	O
ˆe	O
by	O
multiplying	O
out	O
ˆe	O
=	O
uˆdvt	O
.	O
matrix	B
p	O
(	O
cid:2	O
)	O
can	O
be	O
computed	O
directly	O
from	O
the	O
svd	O
according	O
to	O
result	O
9.19-	O
(	O
p259	O
)	O
.	O
the	O
choice	B
between	O
the	O
four	B
solutions	I
for	O
p	O
(	O
cid:2	O
)	O
is	O
determined	O
by	O
the	O
consideration	O
that	O
the	O
visible	O
points	O
must	O
lie	O
in	O
front	O
of	O
the	O
two	O
cameras	B
,	O
as	O
explained	O
in	O
section	O
9.6.3-	O
(	O
p259	O
)	O
.	O
11.8	O
correspondence	B
of	O
other	O
entities	O
so	O
far	O
in	O
this	O
chapter	O
only	O
point	B
correspondences	O
have	O
been	O
employed	O
,	O
and	O
the	O
question	O
naturally	O
arises	O
:	O
can	O
f	O
be	O
computed	O
from	O
the	O
correspondence	B
of	O
image	O
entities	O
other	O
than	O
points	O
?	O
the	O
answer	O
is	O
yes	O
,	O
but	O
not	O
from	O
all	O
types	O
of	O
entities	O
.	O
we	O
will	O
now	O
discuss	O
some	O
common	O
examples	B
.	O
lines	B
.	O
the	O
correspondence	B
of	O
image	O
lines	O
between	O
views	O
places	O
no	O
constraint	O
at	O
all	O
on	O
f.	O
here	O
a	O
line	B
is	O
an	O
inﬁnite	O
line	O
,	O
not	O
a	O
line	B
segment	O
.	O
consider	O
the	O
case	O
of	O
corresponding	O
image	O
points	O
:	O
the	O
points	O
in	O
each	O
image	O
back-project	O
to	O
rays	O
,	O
one	O
through	O
each	O
camera	B
centre	I
,	O
and	O
these	O
rays	O
intersect	O
at	O
the	O
3-space	O
point	B
.	O
now	O
in	O
general	O
two	O
lines	O
in	O
3-	O
space	O
are	O
skew	O
(	O
i.e	O
.	O
they	O
do	O
not	O
intersect	O
)	O
;	O
so	O
the	O
condition	O
that	O
the	O
rays	O
intersect	O
places	O
a	O
constraint	O
on	O
the	O
epipolar	B
geometry	O
.	O
in	O
contrast	O
in	O
the	O
case	O
of	O
corresponding	O
image	O
lines	O
,	O
the	O
back-projection	B
is	O
a	O
plane	B
from	O
each	O
view	O
.	O
however	O
,	O
two	O
planes	O
in	O
3-space	O
always	O
intersect	O
so	O
there	O
is	O
no	O
constraint	O
on	O
the	O
epipolar	B
geometry	O
(	O
there	O
is	O
a	O
constraint	O
in	O
the	O
case	O
of	O
3-views	O
)	O
.	O
in	O
the	O
case	O
of	B
parallel	I
lines	I
,	O
the	O
correspondence	B
of	O
vanishing	B
points	I
does	O
provide	O
a	O
11.9	O
degeneracies	B
295	O
x	O
x	O
x/	O
l	O
/	O
l	O
c	O
e	O
e	O
/	O
/	O
c	O
e	O
/	O
e	O
a	O
b	O
fig	O
.	O
11.6.	O
epipolar	B
tangency	O
.	O
(	O
a	O
)	O
for	O
a	O
surface	O
;	O
(	O
b	O
)	O
for	O
a	O
space	O
curve	O
–	O
ﬁgure	O
after	O
porrill	O
and	O
pol-	O
lard	O
[	O
porrill-91	O
]	O
.	O
in	O
(	O
a	O
)	O
the	O
epipolar	B
plane	O
cc	O
(	O
cid:1	O
)	O
x	O
is	O
tangent	O
to	O
the	O
surface	O
at	O
x.	O
the	O
imaged	O
outline	O
is	O
tangent	O
to	O
the	O
epipolar	B
lines	I
at	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
in	O
the	O
two	B
views	I
.	O
the	O
dashed	O
curves	O
on	O
the	O
surface	O
are	O
the	O
contour	B
generators	O
.	O
in	O
(	O
b	O
)	O
the	O
epipolar	B
plane	O
is	O
tangent	O
to	O
the	O
space	B
curve	I
.	O
the	O
corresponding	O
epipolar	B
lines	I
l	O
↔	O
l	O
(	O
cid:1	O
)	O
are	O
tangent	O
to	O
the	O
imaged	O
curve	O
.	O
constraint	O
on	O
f.	O
however	O
,	O
a	O
vanishing	O
point	O
has	O
the	O
same	O
status	O
as	O
any	O
ﬁnite	B
point	O
,	O
i.e	O
.	O
it	O
provides	O
one	O
constraint	O
.	O
space	O
curves	O
and	O
surfaces	O
.	O
as	O
illustrated	O
in	O
ﬁgure	O
11.6	O
,	O
at	O
points	O
at	O
which	O
the	O
epipo-	O
lar	O
plane	B
is	O
tangent	O
to	O
a	O
space	B
curve	I
the	O
imaged	O
curve	O
is	O
tangent	O
to	O
the	O
corresponding	O
epipolar	B
lines	I
.	O
this	O
provides	O
a	O
constraint	O
on	O
the	O
2	O
view	O
geometry	O
,	O
i.e	O
.	O
if	O
an	O
epipolar	B
line	I
is	O
tangent	O
to	O
an	O
imaged	O
curve	O
in	O
one	O
view	O
,	O
then	O
the	O
corresponding	O
epipolar	B
line	I
must	O
be	O
tangent	O
to	O
the	O
imaged	O
curve	O
in	O
the	O
other	O
view	O
.	O
similarly	O
,	O
in	O
the	O
case	O
of	O
surfaces	O
,	O
at	O
points	O
at	O
which	O
the	O
epipolar	B
plane	O
is	O
tangent	O
to	O
the	O
surface	O
the	O
imaged	O
outline	O
is	O
tangent	O
to	O
the	O
corresponding	O
epipolar	B
lines	I
.	O
epipolar	B
tangent	O
points	O
act	O
effectively	O
as	O
point	O
correspondences	B
and	O
may	O
be	O
included	O
in	O
estimation	O
algorithms	O
as	O
described	O
by	O
[	O
porrill-91	O
]	O
.	O
particularly	O
important	O
cases	O
are	O
those	O
of	B
conics	I
and	O
quadrics	B
which	O
are	O
algebraic	B
objects	O
and	O
so	O
algebraic	B
solutions	O
can	O
be	O
developed	O
.	O
examples	B
are	O
given	O
in	O
the	O
notes	O
and	O
exercises	O
at	O
the	O
end	O
of	O
this	O
chapter	O
.	O
11.9	O
degeneracies	B
a	O
set	O
of	O
correspondences	O
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
}	O
is	O
geometrically	O
degenerate	O
with	O
respect	O
to	O
f	O
if	O
it	O
fails	O
to	O
uniquely	O
deﬁne	O
the	O
epipolar	B
geometry	O
,	O
or	O
equivalently	O
if	O
there	O
exist	O
linearly	O
independent	O
rank-2	O
matrices	O
,	O
fj	O
,	O
j	O
=	O
1	O
,	O
2	O
,	O
such	O
that	O
x	O
(	O
cid:2	O
)	O
i	O
tf1xt	O
i	O
=	O
0	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
tf2xi	O
=	O
0	O
(	O
1	O
≤	O
i	O
≤	O
n	O
)	O
.	O
the	O
subject	O
of	O
degeneracy	O
is	O
investigated	O
in	O
detail	O
in	O
chapter	O
22.	O
however	O
,	O
a	O
brief	O
preview	O
is	O
given	O
now	O
for	O
the	O
two	O
important	O
cases	O
of	O
scene	O
points	B
on	I
a	I
ruled	I
quadric	I
,	O
or	O
on	O
a	O
plane	O
.	O
provided	O
the	O
two	O
camera	O
centres	O
are	O
not	O
coincident	O
the	O
epipolar	B
geometry	O
is	O
uniquely	O
deﬁned	O
.	O
it	O
can	O
always	O
be	O
computed	O
from	O
the	O
camera	B
matrices	I
p	O
,	O
p	O
(	O
cid:2	O
)	O
as	O
in	O
(	O
9.1–p244	O
)	O
for	O
example	O
.	O
what	O
is	O
at	O
issue	O
here	O
are	O
conﬁgurations	O
where	O
the	O
epipolar	B
geometry	O
can	O
not	O
be	O
estimated	O
from	O
point	O
correspondences	O
.	O
an	O
awareness	O
of	O
the	O
degeneracies	O
of	O
296	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
dim	O
(	O
n	O
)	O
=	O
1	O
:	O
unique	O
solution	B
–	O
no	O
degeneracy	O
.	O
arises	O
from	O
n	O
≥	O
8	O
point	B
correspondences	O
in	O
general	O
position	O
.	O
if	O
n	O
>	O
8	O
then	O
the	O
point	B
correspondences	O
must	O
be	O
perfect	O
(	O
i.e	O
.	O
noise-free	O
)	O
.	O
dim	O
(	O
n	O
)	O
=	O
2	O
:	O
1	O
or	O
3	O
solutions	O
.	O
arises	O
in	O
the	O
case	O
of	O
seven	O
point	B
correspondences	O
,	O
and	O
also	O
in	O
the	O
case	O
of	O
n	O
>	O
7	O
perfect	O
point	B
correspondences	O
where	O
the	O
3d	O
points	O
and	O
camera	B
centres	O
lie	O
on	O
a	O
ruled	O
quadric	O
referred	O
to	O
as	O
a	O
critical	B
surface	I
.	O
the	O
quadric	O
may	O
be	O
non-degenerate	O
(	O
a	O
hyper-	O
boloid	O
of	O
one	O
sheet	O
)	O
or	O
degenerate	B
.	O
dim	O
(	O
n	O
)	O
=	O
3	O
:	O
two-parameter	O
family	O
of	O
solutions	O
.	O
arises	O
if	O
n	O
≥	O
6	O
perfect	O
point	B
correspondences	O
are	O
related	O
by	O
a	O
homography	B
,	O
x	O
(	O
cid:1	O
)	O
•	O
rotation	B
about	O
the	O
camera	B
centre	I
(	O
a	O
degenerate	B
motion	O
)	O
.	O
•	O
all	O
world	O
points	B
on	I
a	I
plane	I
(	O
a	O
degenerate	B
structure	O
)	O
.	O
i	O
=	O
hxi	O
.	O
table	O
11.1.	O
degeneracies	B
in	O
estimating	B
f	O
from	O
point	O
correspondences	O
,	O
classiﬁed	O
by	O
the	O
dimension	O
of	O
the	O
null-space	O
n	O
of	O
a	O
in	O
(	O
11.3–p279	O
)	O
.	O
estimation	B
algorithms	O
is	O
important	O
because	O
conﬁgurations	O
“	O
close	O
to	O
”	O
degenerate	B
ones	O
are	O
likely	O
to	O
lead	O
to	O
a	O
numerically	O
ill-conditioned	O
estimation	B
.	O
the	O
degeneracies	B
are	O
summarized	O
in	O
table	O
11.1	O
.	O
11.9.1	O
points	B
on	I
a	I
ruled	I
quadric	I
it	O
will	O
be	O
shown	O
in	O
chapter	O
22	O
that	O
degeneracy	B
occurs	O
if	O
both	O
camera	O
centres	O
and	O
all	O
the	O
3d	O
points	O
lie	O
on	O
a	O
(	O
ruled	B
)	O
quadric	O
surface	O
referred	O
to	O
as	O
the	O
critical	O
sur-	O
face	O
[	O
maybank-93	O
]	O
.	O
a	O
ruled	B
quadric	O
may	O
be	O
non-degenerate	O
(	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
–	O
a	O
cooling	O
tower	O
)	O
or	O
degenerate	B
(	O
for	O
instance	O
two	O
planes	O
,	O
cones	O
,	O
and	O
cylinders	O
)	O
–	O
see	O
section	O
3.2.4	O
(	O
p74	O
)	O
;	O
but	O
a	O
critical	B
surface	I
can	O
not	O
be	O
an	O
ellipsoid	O
or	O
hyperboloid	B
of	O
two	O
sheets	O
.	O
for	O
a	O
critical	O
surface	O
conﬁguration	O
there	O
are	O
three	O
possible	O
fundamental	O
matrices	O
.	O
note	O
that	O
in	O
the	O
case	O
of	O
just	O
7	O
point	B
correspondences	O
,	O
together	O
with	O
the	O
two	O
camera	O
centres	O
there	O
are	O
9	O
points	O
in	O
total	O
.	O
a	O
general	O
quadric	O
has	O
9	O
degrees	B
of	I
freedom	I
,	O
and	O
one	O
may	O
always	O
construct	O
a	O
quadric	O
through	O
9	O
points	O
.	O
in	O
the	O
case	O
where	O
this	O
quadric	O
is	O
a	O
ruled	B
quadric	O
it	O
will	O
be	O
a	O
critical	B
surface	I
,	O
and	O
there	O
will	O
be	O
three	O
possible	O
solutions	O
for	O
f.	O
the	O
case	O
where	O
the	O
quadric	O
is	O
not	O
ruled	B
corresponds	O
to	O
the	O
case	O
where	O
there	O
is	O
only	O
one	O
real	O
solution	B
for	O
f.	O
11.9.2	O
points	B
on	I
a	I
plane	I
in	O
this	O
case	O
,	O
all	O
the	O
an	O
important	O
degeneracy	B
is	O
when	O
all	O
the	O
points	O
lie	O
in	O
a	O
plane	B
.	O
points	O
plus	O
the	O
two	O
camera	O
centres	O
lie	O
on	O
a	O
ruled	O
quadric	O
surface	O
,	O
namely	O
the	O
degenerate	B
quadric	O
consisting	O
of	O
two	O
planes	O
–	O
the	O
plane	B
through	O
the	O
points	O
,	O
plus	O
a	O
plane	B
passing	O
through	O
the	O
two	O
camera	O
centres	O
.	O
two	B
views	I
of	O
a	O
planar	O
set	O
of	B
points	I
are	O
related	O
via	O
a	O
2d	O
projective	B
transformation	I
h.	O
thus	O
,	O
suppose	O
that	O
a	O
set	O
of	O
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
hxi	O
.	O
any	O
number	O
of	O
points	O
xi	O
and	O
the	O
corresponding	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
hxi	O
may	O
be	O
given	O
.	O
i	O
is	O
given	O
for	O
which	O
x	O
(	O
cid:2	O
)	O
11.10	O
a	O
geometric	B
interpretation	I
of	O
f-computation	O
297	O
i	O
i	O
t	O
(	O
fh−1	O
)	O
x	O
(	O
cid:2	O
)	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
the	O
pair	O
of	O
cameras	O
satisﬁes	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
tfxi	O
=	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
0.	O
this	O
set	O
of	O
equations	O
is	O
satisﬁed	O
whenever	O
fh−1	O
is	O
skew-	O
symmetric	B
.	O
thus	O
,	O
the	O
solution	B
for	O
f	O
is	O
any	O
matrix	B
of	O
the	O
form	O
f	O
=	O
sh	O
,	O
where	O
s	O
is	O
skew-symmetric	O
.	O
now	O
,	O
a	O
3	O
×	O
3	O
skew-symmetric	O
matrix	O
s	O
may	O
be	O
written	O
in	O
the	O
form	O
s	O
=	O
[	O
t	O
]	O
×	O
,	O
for	O
any	O
3-vector	O
t.	O
thus	O
,	O
s	O
has	O
three	O
degrees	B
of	I
freedom	I
,	O
and	O
consequently	O
so	O
does	O
f.	O
more	O
precisely	O
,	O
the	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
lead	O
to	O
a	O
three-parameter	O
family	O
of	O
possible	O
fundamental	O
matrices	O
f	O
(	O
note	O
,	O
one	O
of	O
the	O
parameters	O
accounts	O
for	O
scaling	O
the	O
matrix	B
so	O
there	O
is	O
only	O
a	O
two-parameter	O
family	O
of	O
homogeneous	O
matrices	O
)	O
.	O
the	O
equation	O
matrix	B
a	O
derived	O
from	O
the	O
set	O
of	O
correspondences	O
must	O
therefore	O
have	O
rank	O
no	O
greater	O
than	O
6.	O
from	O
the	O
decomposition	B
of	I
f	O
=	O
sh	O
,	O
it	O
follows	O
from	O
result	O
9.9	O
(	O
p254	O
)	O
that	O
the	O
pair	O
of	B
camera	I
matrices	O
[	O
i	O
|	O
0	O
]	O
and	O
[	O
h	O
|	O
t	O
]	O
correspond	O
to	O
the	O
fundamental	B
matrix	I
f.	O
here	O
,	O
the	O
vector	O
t	O
may	O
take	O
on	O
any	O
value	O
.	O
if	O
point	B
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
t	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
hxi	O
,	O
then	O
one	O
veriﬁes	O
that	O
the	O
point	B
xi	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
,	O
0	O
)	O
t	O
maps	O
to	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
through	O
the	O
two	O
cameras	O
.	O
thus	O
,	O
the	O
points	O
xi	O
constitute	O
a	O
reconstruction	B
of	O
the	O
scene	O
.	O
11.9.3	O
no	B
translation	I
if	O
the	O
two	O
camera	O
centres	O
are	O
coincident	O
then	O
the	O
epipolar	B
geometry	O
is	O
not	O
deﬁned	O
.	O
in	O
addition	O
,	O
formulae	O
such	O
as	O
result	O
9.9	O
(	O
p254	O
)	O
give	O
a	O
value	O
of	O
0	O
for	O
the	O
fundamental	B
matrix	I
.	O
in	O
this	O
case	O
the	O
two	O
images	O
are	O
related	O
by	O
a	O
2d	O
homography	B
(	O
see	O
section	O
8.4.2	O
(	O
p204	O
)	O
)	O
.	O
if	O
one	O
attempts	O
to	O
ﬁnd	O
the	O
fundamental	B
matrix	I
then	O
,	O
as	O
shown	O
above	O
,	O
there	O
will	O
be	O
at	O
least	O
a	O
2-parameter	O
family	O
of	O
solutions	O
for	O
f.	O
even	O
if	O
the	O
camera	B
motion	I
involves	O
no	B
translation	I
,	O
then	O
a	O
method	O
such	O
as	O
the	O
8-point	O
algorithm	B
used	O
to	O
compute	O
the	O
fun-	O
damental	O
matrix	B
will	O
still	O
produce	O
a	O
matrix	B
f	O
satisfying	O
x	O
(	O
cid:2	O
)	O
tfxi	O
=	O
0	O
,	O
where	O
f	O
has	O
the	O
form	O
f	O
=	O
sh	O
,	O
h	O
is	O
the	O
homography	B
relating	O
the	O
points	O
,	O
and	O
s	O
is	O
an	O
essentially	O
arbitrary	O
skew-symmetric	O
matrix	O
.	O
points	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
related	O
by	O
h	O
will	O
satisfy	O
this	O
relationship	O
.	O
i	O
i	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
11.10	O
a	O
geometric	B
interpretation	I
of	O
f-computation	O
the	O
estimation	B
of	I
f	O
from	O
a	O
set	O
of	O
image	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
has	O
many	O
sim-	O
ilarities	O
with	O
the	O
problem	O
of	O
estimating	B
a	O
conic	B
from	O
a	O
set	O
of	O
2d	O
points	O
{	O
xi	O
,	O
yi	O
}	O
(	O
or	O
a	O
quadric	O
from	O
a	O
set	O
of	O
3d	O
points	O
)	O
.	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
is	O
a	O
single	O
constraint	O
in	O
x	O
,	O
y	O
,	O
x	O
and	O
so	O
deﬁnes	O
a	O
surface	O
(	O
variety	O
)	O
v	O
of	O
codimension	O
1	O
(	O
dimension	O
3	O
)	O
in	O
ir4	O
.	O
the	O
surface	O
is	O
a	O
quadric	O
because	O
the	O
equation	O
is	O
quadratic	O
in	O
the	O
coordinates	B
x	O
,	O
y	O
,	O
x	O
of	O
ir4	O
.	O
there	O
is	O
a	O
natural	O
map-	O
ping	O
from	O
projective	O
3-space	O
to	O
the	O
variety	O
v	O
that	O
takes	O
any	O
3d	O
point	B
to	O
the	O
quadruple	O
)	O
t	O
of	O
the	O
corresponding	O
image	O
points	O
in	O
the	O
two	B
views	I
.	O
the	O
quadric	O
form	O
is	O
(	O
x	O
,	O
y	O
,	O
x	O
evident	O
if	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
is	O
rewritten	O
as	O
0	O
0	O
f31	O
f32	O
0	O
0	O
f13	O
f11	O
f12	O
f23	O
f21	O
f22	O
f31	O
f32	O
f13	O
f23	O
2f33	O
	O
=	O
0	O
.	O
f11	O
f21	O
f12	O
f22	O
0	O
0	O
0	O
0	O
	O
x	O
y	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
y	O
1	O
	O
	O
x	O
y	O
x	O
(	O
cid:15	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
(	O
cid:16	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
1	O
the	O
case	O
of	B
conic	I
ﬁtting	O
is	O
a	O
good	O
(	O
lower-dimensional	O
)	O
model	B
of	O
f	O
estimation	B
.	O
to	O
298	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
tangent	B
line	I
fig	O
.	O
11.7.	O
estimating	B
a	O
conic	B
from	O
point	B
data	O
(	O
shown	O
as	O
•	O
)	O
may	O
be	O
poorly	O
conditioned	O
.	O
all	O
of	O
the	O
conics	O
shown	O
have	O
residuals	B
within	O
the	O
point	B
error	O
distribution	B
.	O
however	O
,	O
even	O
though	O
there	O
is	O
ambiguity	B
in	O
the	O
estimated	O
conic	B
,	O
the	O
tangent	B
line	I
is	O
well	O
deﬁned	O
,	O
and	O
can	O
be	O
computed	O
from	O
the	O
points	O
.	O
bring	O
out	O
the	O
analogy	O
between	O
the	O
two	O
estimation	O
problems	O
:	O
a	O
point	B
(	O
xi	O
,	O
yi	O
)	O
places	O
one	O
constraint	O
on	O
the	O
5	O
degrees	B
of	I
freedom	I
of	O
a	O
conic	B
as	O
described	O
in	O
section	O
2.2.3	O
(	O
p30	O
)	O
:	O
ax2	O
i	O
+	O
bxiyi	O
+	O
cy2	O
i	O
+	O
dxi	O
+	O
eyi	O
+	O
f	O
=	O
0.	O
similarly	O
,	O
a	O
point	B
correspondence	O
(	O
xi	O
,	O
yi	O
,	O
x	O
of	O
freedom	O
of	O
f	O
as	O
(	O
11.2–p279	O
)	O
:	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
(	O
cid:2	O
)	O
i	O
)	O
places	O
one	O
constraint	O
on	O
the	O
(	O
8	O
)	O
degrees	O
(	O
cid:2	O
)	O
ixif11	O
+	O
x	O
(	O
cid:2	O
)	O
iyif12	O
+	O
x	O
x	O
(	O
cid:2	O
)	O
if13	O
+	O
y	O
(	O
cid:2	O
)	O
ixif21	O
+	O
y	O
(	O
cid:2	O
)	O
iyif22	O
+	O
y	O
(	O
cid:2	O
)	O
if23	O
+	O
xif31	O
+	O
yif32	O
+	O
f33	O
=	O
0.	O
it	O
is	O
not	O
quite	O
an	O
exact	O
analogy	O
,	O
since	O
the	O
deﬁning	O
relationship	O
expressed	O
by	O
the	O
fun-	O
damental	O
matrix	B
is	O
bilinear	B
in	O
the	O
two	O
sets	O
of	O
indices	O
,	O
as	O
is	O
also	O
evident	O
from	O
the	O
zeros	O
in	O
the	O
quadric	O
matrix	O
above	O
,	O
whereas	O
in	O
the	O
case	O
of	O
a	O
conic	O
section	O
the	O
equation	O
is	O
an	O
arbitrary	O
quadratic	O
.	O
also	O
the	O
surface	O
deﬁned	O
by	O
f	O
must	O
satisfy	O
an	O
additional	O
constraint	O
arising	O
from	O
det	O
(	O
f	O
)	O
=	O
0	O
,	O
and	O
there	O
is	O
no	O
such	O
constraint	O
in	O
the	O
conic	B
ﬁtting	I
analogue	O
.	O
the	O
problems	O
of	O
extrapolation	O
when	O
data	O
has	O
only	O
been	O
ﬁtted	O
to	O
a	O
small	O
section	O
of	O
a	O
conic	O
are	O
well	O
known	O
,	O
and	O
similar	O
issues	O
arise	O
in	O
ﬁtting	O
the	O
fundamental	B
matrix	I
to	O
data	O
.	O
indeed	O
,	O
there	O
are	O
cases	O
where	O
the	O
data	O
is	O
sufﬁcient	O
to	O
determine	O
an	O
accurate	O
tangent	B
line	I
to	O
the	O
conic	B
,	O
but	O
insufﬁcient	O
to	O
determine	O
the	O
conic	B
itself	O
,	O
see	O
ﬁgure	O
11.7.	O
in	O
the	O
case	O
of	O
the	O
fundamental	O
matrix	B
the	O
tangent	O
plane	O
to	O
the	O
quadric	O
in	O
ir4	O
is	O
the	O
afﬁne	B
fundamental	I
matrix	I
(	O
chapter	O
14	O
)	O
,	O
and	O
this	O
approximation	O
may	O
be	O
ﬁtted	O
when	O
perspective	O
effects	O
are	O
small	O
.	O
11.11	O
the	O
envelope	O
of	B
epipolar	I
lines	I
one	O
of	O
the	O
uses	O
of	O
the	O
fundamental	O
matrix	B
is	O
to	O
determine	O
epipolar	B
lines	I
in	O
a	O
second	O
image	O
corresponding	O
to	O
points	O
in	O
a	O
ﬁrst	O
image	O
.	O
for	O
instance	O
,	O
if	O
one	O
is	O
seeking	O
matched	O
points	O
between	O
two	O
images	O
,	O
the	O
match	O
of	O
a	O
given	O
point	B
x	O
in	O
the	O
ﬁrst	O
image	O
may	O
be	O
found	O
by	O
searching	O
along	O
the	O
epipolar	B
line	I
fx	O
in	O
the	O
second	O
image	O
.	O
in	O
the	O
presence	O
of	O
noise	O
,	O
of	O
course	O
,	O
the	O
matching	B
point	O
will	O
not	O
lie	O
precisely	O
on	O
the	O
line	B
fx	O
because	O
the	O
fundamental	B
matrix	I
will	O
be	O
known	O
only	O
within	O
certain	O
bounds	O
,	O
expressed	O
by	O
its	O
covariance	B
matrix	O
.	O
in	O
general	O
,	O
instead	O
of	O
searching	O
along	O
the	O
epipolar	B
line	I
only	O
,	O
it	O
will	O
be	O
necessary	O
to	O
search	O
in	O
a	O
region	O
on	O
either	O
side	O
of	O
the	O
line	O
fx	O
.	O
we	O
will	O
now	O
consider	O
how	O
the	O
covariance	B
matrix	O
of	O
the	O
fundamental	O
matrix	B
may	O
be	O
used	O
to	O
determine	O
the	O
region	O
in	O
which	O
to	O
search	O
.	O
let	O
x	O
be	O
a	O
point	O
and	O
f	O
be	O
a	O
fundamental	B
matrix	I
for	O
which	O
one	O
has	O
computed	O
a	O
co-	O
variance	B
matrix	O
σf	O
.	O
the	O
point	B
x	O
corresponds	O
to	O
an	O
epipolar	B
line	I
l	O
=	O
fx	O
,	O
and	O
one	O
11.11	O
the	O
envelope	O
of	B
epipolar	I
lines	I
299	O
may	O
transfer	B
the	O
covariance	B
matrix	O
σf	O
to	O
a	O
covariance	B
matrix	O
σl	O
according	O
to	O
result	O
5.6-	O
(	O
p139	O
)	O
.	O
also	O
by	O
result	O
5.6	O
(	O
p139	O
)	O
,	O
the	O
mean	O
value	O
of	O
the	O
epipolar	O
line	B
is	O
given	O
by	O
¯l	O
=	O
¯fx	O
.	O
to	O
avoid	O
singular	O
cases	O
,	O
the	O
vector	O
l	O
representing	O
an	O
epipolar	B
line	I
is	O
normalized	O
so	O
that	O
(	O
cid:10	O
)	O
l	O
(	O
cid:10	O
)	O
=	O
1.	O
then	O
the	O
mapping	O
x	O
(	O
cid:6	O
)	O
→	O
l	O
is	O
given	O
by	O
l	O
=	O
(	O
fx	O
)	O
/	O
(	O
cid:10	O
)	O
fx	O
(	O
cid:10	O
)	O
.	O
if	O
j	O
is	O
the	O
jacobian	O
matrix	B
of	O
this	O
mapping	O
with	O
respect	O
to	O
the	O
entries	O
of	O
f	O
,	O
then	O
j	O
is	O
a	O
3	O
×	O
9	O
matrix	B
,	O
and	O
σl	O
=	O
jσfjt	O
.	O
though	O
the	O
constraint	O
(	O
cid:10	O
)	O
l	O
(	O
cid:10	O
)	O
=	O
1	O
is	O
the	O
most	O
convenient	O
constraint	O
,	O
the	O
following	O
analy-	O
sis	O
applies	O
for	O
any	O
constraint	O
used	O
to	O
conﬁne	O
the	O
vector	O
representing	O
the	O
epipolar	B
line	I
to	O
vary	O
on	O
a	O
2-dimensional	O
surface	O
in	O
ir3	O
.	O
in	O
this	O
case	O
,	O
the	O
covariance	B
matrix	O
σl	O
is	O
singular	O
,	O
having	O
rank	O
2	O
,	O
since	O
no	O
variation	O
is	O
allowed	O
in	O
the	O
direction	O
normal	O
to	O
the	O
constraint	O
surface	O
.	O
for	O
a	O
particular	O
instance	O
of	O
l	O
,	O
the	O
deviation	O
from	O
the	O
mean	O
,	O
¯l	O
−	O
l	O
,	O
must	O
be	O
along	O
the	O
constraint	O
surface	O
,	O
and	O
hence	O
(	O
in	O
the	O
linear	B
approximation	O
)	O
perpendicular	O
to	O
the	O
null-space	B
of	O
σl	O
.	O
for	O
the	O
remainder	O
of	O
this	O
derivation	B
,	O
¯l	O
,	O
the	O
vector	O
representing	O
the	O
mean	O
epipolar	B
line	I
,	O
will	O
be	O
denoted	O
by	O
m	O
,	O
so	O
as	O
to	O
avoid	O
confusing	O
notation	O
.	O
now	O
,	O
assuming	O
a	O
gaussian	O
distribution	B
for	O
the	O
vectors	O
l	O
representing	O
the	O
epipolar	B
line	I
,	O
the	O
set	O
of	O
all	O
lines	B
having	O
a	O
given	O
likelihood	O
is	O
given	O
by	O
the	O
equation	O
(	O
l	O
−	O
m	O
)	O
tς+	O
(	O
11.11	O
)	O
where	O
k	O
is	O
some	O
constant	O
.	O
to	O
analyze	O
this	O
further	O
,	O
we	O
apply	O
an	O
orthogonal	B
change	O
of	O
coordinates	O
such	O
that	O
σl	O
becomes	O
diagonal	O
.	O
thus	O
,	O
one	O
may	O
write	O
l	O
(	O
l	O
−	O
m	O
)	O
=k	O
2	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:2	O
)	O
l	O
0	O
˜σ	O
0t	O
0	O
uσlut	O
=	O
σ	O
(	O
cid:2	O
)	O
l	O
=	O
(	O
cid:2	O
)	O
l	O
is	O
a	O
2	O
×	O
2	O
non-singular	O
diagonal	O
matrix	B
.	O
applying	O
the	O
same	O
transformation	O
where	O
˜σ	O
=	O
ul	O
.	O
since	O
l	O
(	O
cid:2	O
)	O
−	O
m	O
(	O
cid:2	O
)	O
to	O
the	O
lines	B
,	O
one	O
deﬁnes	O
2-vectors	O
m	O
(	O
cid:2	O
)	O
is	O
orthogonal	B
to	O
the	O
null-space	B
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
of	O
σ	O
(	O
cid:2	O
)	O
have	O
the	O
same	O
third	O
coordinate	O
.	O
by	O
multiplying	O
u	O
by	O
a	O
constant	O
as	O
necessary	O
,	O
one	O
may	O
assume	O
that	O
this	O
coordinate	O
is	O
1.	O
and	O
˜m	O
(	O
cid:2	O
)	O
thus	O
we	O
may	O
write	O
l	O
(	O
cid:2	O
)	O
.	O
then	O
,	O
one	O
veriﬁes	O
that	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
(	O
˜m	O
(	O
cid:2	O
)	O
t	O
,	O
1	O
)	O
t	O
for	O
certain	O
2-vectors	O
˜l	O
l	O
,	O
both	O
m	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
,	O
1	O
)	O
t	O
and	O
m	O
(	O
cid:2	O
)	O
=	O
um	O
and	O
l	O
(	O
cid:2	O
)	O
=	O
(	O
˜l	O
l	O
(	O
l	O
−	O
m	O
)	O
k2	O
=	O
(	O
l	O
−	O
m	O
)	O
tς+	O
l	O
(	O
l	O
(	O
cid:2	O
)	O
−	O
m	O
(	O
cid:2	O
)	O
)	O
tς	O
(	O
cid:2	O
)	O
+	O
(	O
cid:2	O
)	O
−	O
˜m	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
−1	O
)	O
t˜ς	O
(	O
˜l	O
l	O
=	O
(	O
l	O
(	O
cid:2	O
)	O
−	O
m	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
−	O
˜m	O
(	O
cid:2	O
)	O
=	O
(	O
˜l	O
)	O
)	O
.	O
(	O
cid:2	O
)	O
−1	O
l	O
˜l	O
(	O
cid:2	O
)	O
t˜ς	O
˜l	O
this	O
equation	O
expands	O
out	O
to	O
(	O
cid:2	O
)	O
−	O
˜m	O
(	O
cid:2	O
)	O
t˜ς	O
(	O
cid:17	O
)	O
which	O
may	O
be	O
written	O
as	O
(	O
cid:2	O
)	O
t	O
1	O
)	O
(	O
˜l	O
(	O
cid:2	O
)	O
−1	O
l	O
˜l	O
(	O
cid:2	O
)	O
−	O
˜l	O
(	O
cid:2	O
)	O
t˜ς	O
(	O
cid:2	O
)	O
−1	O
l	O
˜m	O
(	O
cid:2	O
)	O
+	O
˜m	O
(	O
cid:2	O
)	O
t˜ς	O
(	O
cid:2	O
)	O
−1	O
˜σ	O
l	O
−	O
˜m	O
(	O
cid:2	O
)	O
t˜ς	O
(	O
cid:2	O
)	O
−1	O
−˜σ	O
˜m	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
−1	O
˜m	O
(	O
cid:2	O
)	O
−	O
k2	O
˜m	O
(	O
cid:2	O
)	O
t˜ς	O
l	O
(	O
cid:2	O
)	O
−1	O
l	O
(	O
cid:2	O
)	O
˜l	O
1	O
(	O
cid:2	O
)	O
−1	O
l	O
˜m	O
(	O
cid:2	O
)	O
−	O
k2	O
=	O
0	O
(	O
cid:18	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
=	O
0	O
300	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
or	O
equivalently	O
(	O
as	O
one	O
may	O
verify	O
)	O
(	O
cid:17	O
)	O
(	O
cid:2	O
)	O
t	O
1	O
)	O
(	O
˜l	O
˜m	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
˜m	O
(	O
cid:2	O
)	O
t	O
−	O
k2˜σ	O
l	O
˜m	O
(	O
cid:2	O
)	O
t	O
˜m	O
(	O
cid:2	O
)	O
1	O
(	O
cid:18	O
)	O
−1	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:2	O
)	O
˜l	O
1	O
=	O
0	O
.	O
(	O
11.12	O
)	O
finally	O
,	O
this	O
is	O
equivalent	B
to	O
l	O
(	O
cid:2	O
)	O
t	O
[	O
m	O
(	O
cid:2	O
)	O
m	O
(	O
cid:2	O
)	O
t	O
−	O
k2σ	O
(	O
cid:2	O
)	O
−1l	O
(	O
cid:2	O
)	O
l	O
]	O
=	O
0	O
.	O
(	O
11.13	O
)	O
this	O
shows	O
that	O
the	O
lines	B
satisfying	O
(	O
11.11	O
)	O
form	O
a	O
line	B
conic	O
deﬁned	O
by	O
the	O
matrix	B
(	O
m	O
(	O
cid:2	O
)	O
m	O
(	O
cid:2	O
)	O
t	O
−	O
k2σ	O
(	O
cid:2	O
)	O
−1	O
.	O
the	O
corresponding	O
point	B
conic	O
,	O
which	O
forms	O
the	O
envelope	O
of	O
the	O
l	O
)	O
lines	B
,	O
is	O
deﬁned	O
by	O
the	O
matrix	B
m	O
(	O
cid:2	O
)	O
m	O
(	O
cid:2	O
)	O
t−	O
k2σ	O
(	O
cid:2	O
)	O
l.	O
one	O
may	O
now	O
transform	O
back	O
to	O
the	O
orig-	O
inal	O
coordinate	O
system	O
to	O
determine	O
the	O
envelope	O
of	O
the	O
lines	O
in	O
the	O
original	O
coordinate	O
system	O
.	O
the	O
transformed	O
conic	B
is	O
c	O
=	O
ut	O
(	O
m	O
(	O
cid:2	O
)	O
m	O
(	O
cid:2	O
)	O
t	O
−	O
k2σ	O
(	O
cid:2	O
)	O
l	O
)	O
u	O
=	O
mmt	O
−	O
k2σl	O
.	O
(	O
11.14	O
)	O
(	O
cid:31	O
)	O
k2	O
0	O
χ2	O
n	O
(	O
ξ	O
)	O
dξ	O
represents	O
the	O
probability	O
that	O
the	O
value	O
of	O
a	O
χ2	O
note	O
that	O
when	O
k	O
=	O
0	O
,	O
the	O
conic	B
c	O
degenerates	O
to	O
mmt	O
,	O
which	O
represents	O
the	O
set	O
of	B
points	I
lying	O
on	O
the	O
line	B
m.	O
as	O
k	O
increases	O
,	O
the	O
conic	B
becomes	O
a	O
hyperbola	O
the	O
two	O
branches	O
of	O
which	O
lie	O
on	O
opposite	O
sides	O
of	O
the	O
line	O
m.	O
suppose	O
we	O
want	O
to	O
choose	O
k	O
so	O
that	O
some	O
fraction	O
α	O
of	O
the	O
epipolar	O
lines	B
lie	O
in-	O
side	O
the	O
region	O
bounded	O
by	O
this	O
hyperbola	O
.	O
the	O
value	O
k2	O
=	O
(	O
l	O
−	O
m	O
)	O
tς+	O
l	O
(	O
l	O
−	O
m	O
)	O
of	O
(	O
11.11	O
)	O
follows	O
a	O
χ2	O
n	O
distribution	B
,	O
and	O
the	O
cumulative	O
chi-squared	O
distribution	B
n	O
random	O
vari-	O
fn	O
(	O
k2	O
)	O
=	O
able	O
is	O
less	O
than	O
k2	O
(	O
the	O
χ2	O
n	O
and	O
fn	O
distributions	O
are	O
deﬁned	O
in	O
section	O
a2.2	O
(	O
p566	O
)	O
)	O
.	O
applying	O
this	O
to	O
a	O
random	O
line	B
l	O
,	O
one	O
sees	O
that	O
in	O
order	O
to	O
ensure	O
that	O
a	O
fraction	O
α	O
of	B
lines	I
lie	O
within	O
region	O
bounded	O
by	O
the	O
hyperbola	O
deﬁned	O
by	O
(	O
11.14	O
)	O
,	O
one	O
must	O
choose	O
k2	O
such	O
that	O
f2	O
(	O
k2	O
)	O
=	O
α	O
(	O
n	O
=	O
2	O
since	O
the	O
covariance	B
matrix	O
σl	O
has	O
rank	O
2	O
)	O
.	O
thus	O
,	O
−1	O
2	O
(	O
α	O
)	O
,	O
and	O
for	O
a	O
value	O
of	O
α	O
=	O
0.95	O
,	O
for	O
instance	O
,	O
one	O
ﬁnds	O
that	O
k2	O
=	O
5.9915.	O
k2	O
=	O
f	O
the	O
corresponding	O
hyperbola	O
given	O
by	O
(	O
11.14	O
)	O
is	O
c	O
=	O
mmt	O
−	O
5.9915	O
σl	O
.	O
to	O
sum	O
up	O
this	O
discussion	O
:	O
result	O
11.2.	O
if	O
l	O
is	O
a	O
random	O
line	B
obeying	O
a	O
gaussian	O
distribution	B
with	O
mean	O
¯l	O
and	O
covariance	B
matrix	O
σl	O
of	O
rank	O
2	O
,	O
then	O
the	O
plane	B
conic	O
c	O
=	O
¯l	O
¯lt	O
−	O
k2σl	O
(	O
11.15	O
)	O
represents	O
an	O
equal-likelihood	O
contour	B
bounding	O
some	O
fraction	O
of	O
all	O
instances	O
of	O
l.	O
if	O
−1	O
f2	O
(	O
k2	O
)	O
represents	O
the	O
cumulative	O
χ2	O
2	O
(	O
k2	O
)	O
=	O
α	O
,	O
then	O
a	O
fraction	O
α	O
of	O
all	O
lines	B
lie	O
within	O
the	O
region	O
bounded	O
by	O
c.	O
in	O
other	O
words	O
with	O
probability	O
α	O
the	O
lines	B
lie	O
within	O
this	O
region	O
.	O
2	O
distribution	B
,	O
and	O
k2	O
is	O
chosen	O
such	O
that	O
f	O
in	O
applying	O
this	O
formula	O
,	O
one	O
must	O
be	O
aware	O
that	O
it	O
represents	O
only	O
an	O
approxima-	O
tion	O
,	O
since	O
epipolar	B
lines	I
are	O
not	O
normally	O
distributed	O
.	O
we	O
have	O
consistently	O
made	O
the	O
assumption	O
that	O
the	O
distributions	O
may	O
be	O
correctly	O
transformed	O
using	O
the	O
jacobian	O
,	O
that	O
is	O
an	O
assumption	O
of	O
linearity	O
.	O
this	O
assumption	O
will	O
be	O
most	O
reasonable	O
for	O
distribu-	O
tions	O
with	O
small	O
variance	B
,	O
and	O
close	O
to	O
the	O
mean	O
.	O
here	O
,	O
we	O
are	O
applying	O
it	O
to	O
ﬁnd	O
the	O
region	O
in	O
which	O
as	O
many	O
as	O
95	O
%	O
of	O
samples	O
fall	O
,	O
namely	O
almost	O
the	O
whole	O
of	O
the	O
error	O
11.11	O
the	O
envelope	O
of	B
epipolar	I
lines	I
301	O
distribution	B
.	O
in	O
this	O
case	O
,	O
the	O
assumption	O
of	O
a	O
gaussian	O
distribution	B
of	O
errors	O
is	O
less	O
tenable	O
.	O
11.11.1	O
veriﬁcation	O
of	O
epipolar	O
line	O
covariance	B
we	O
now	O
present	O
some	O
examples	B
of	O
epipolar	B
line	I
envelopes	O
,	O
conﬁrming	O
and	O
illustrating	O
the	O
theory	O
developed	O
above	O
.	O
before	O
doing	O
this	O
,	O
however	O
,	O
a	O
direct	O
veriﬁcation	O
of	O
the	O
theory	O
will	O
be	O
given	O
,	O
concerning	O
the	O
covariance	B
matrix	O
of	B
epipolar	I
lines	I
.	O
since	O
the	O
3	O
×	O
3	O
covariance	B
matrix	O
of	O
a	O
line	O
is	O
not	O
easily	O
understood	O
quantitatively	O
,	O
we	O
consider	O
the	O
variance	B
of	O
the	O
direction	O
of	B
epipolar	I
lines	I
.	O
given	O
a	O
line	B
l	O
=	O
(	O
l1	O
,	O
l2	O
,	O
l3	O
)	O
t	O
,	O
the	O
angle	B
representing	O
its	O
direction	O
is	O
given	O
by	O
θ	O
=	O
arctan	O
(	O
−l1/l2	O
)	O
.	O
letting	O
j	O
equal	O
the	O
1	O
×	O
3	O
jacobian	O
matrix	B
of	O
the	O
mapping	O
l	O
→	O
θ	O
,	O
one	O
ﬁnds	O
the	O
variance	B
of	O
the	O
angle	B
θ	O
to	O
be	O
θ	O
=	O
jσljt	O
.	O
this	O
result	O
may	O
be	O
veriﬁed	O
by	O
simulation	O
,	O
as	O
follows	O
.	O
σ2	O
one	O
considers	O
a	O
pair	O
of	O
images	O
for	O
which	O
point	B
correspondences	O
have	O
been	O
identiﬁed	O
.	O
the	O
fundamental	B
matrix	I
is	O
computed	O
from	O
the	O
point	B
correspondences	O
and	O
the	O
points	O
are	O
then	O
corrected	O
so	O
as	O
to	O
correspond	O
precisely	O
under	O
the	O
epipolar	B
mapping	O
(	O
as	O
described	O
in	O
section	O
12.3	O
)	O
.	O
a	O
set	O
of	O
n	O
of	O
these	O
corrected	O
correspondences	B
are	O
used	O
to	O
compute	O
the	O
covariance	B
matrix	O
of	O
the	O
fundamental	O
matrix	B
f.	O
then	O
,	O
for	O
a	O
further	O
set	O
of	O
“	O
test	O
”	O
corrected	O
points	O
xi	O
in	O
the	O
ﬁrst	O
image	O
,	O
the	O
mean	O
and	O
covariance	B
of	O
the	O
corresponding	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
i	O
=	O
fxi	O
are	O
computed	O
,	O
and	O
subsequently	O
the	O
mean	O
and	O
variance	B
of	O
the	O
orientation	B
direction	O
of	O
this	O
line	B
are	O
computed	O
.	O
this	O
gives	O
the	O
theoretical	O
values	O
of	O
these	O
quantities	O
.	O
next	O
,	O
monte	O
carlo	O
simulation	O
is	O
done	O
,	O
in	O
which	O
gaussian	O
noise	B
is	O
added	O
to	O
the	O
co-	O
ordinates	O
of	O
the	O
points	O
used	O
to	O
compute	O
f.	O
using	O
the	O
computed	O
f	O
,	O
the	O
epipolar	B
lines	I
corresponding	O
to	O
each	O
of	O
the	O
test	O
points	O
are	O
computed	O
,	O
and	O
subsequently	O
their	O
angle	B
,	O
and	O
the	O
deviation	O
of	O
the	O
angle	O
from	O
the	O
mean	O
.	O
this	O
is	O
done	O
many	O
times	O
,	O
and	O
the	O
stan-	O
dard	O
deviation	O
of	O
angle	O
is	O
computed	O
,	O
and	O
ﬁnally	O
compared	O
with	O
the	O
theoretical	O
value	O
.	O
the	O
results	O
of	O
this	O
are	O
shown	O
in	O
ﬁgure	O
11.8	O
for	O
the	O
statue	O
image	O
pair	O
of	O
ﬁgure	O
11.2-	O
(	O
p289	O
)	O
.	O
epipolar	B
envelopes	O
for	O
statue	O
image	O
.	O
the	O
statue	O
image	O
pair	O
of	O
ﬁgure	O
11.2	O
(	O
p289	O
)	O
is	O
interesting	O
because	O
of	O
the	O
large	O
depth	O
variation	O
across	O
the	O
image	O
.	O
there	O
are	O
close	O
points	O
(	O
on	O
the	O
statue	O
)	O
and	O
distant	O
points	O
(	O
on	O
the	O
building	O
behind	O
)	O
in	O
close	O
proximity	O
in	O
the	O
images	O
.	O
the	O
fundamental	B
matrix	I
was	O
computed	O
from	O
several	O
points	O
.	O
a	O
point	B
in	O
the	O
ﬁrst	O
image	O
(	O
see	O
ﬁgure	O
11.9	O
)	O
was	O
selected	O
and	O
monte	O
carlo	O
simulation	O
was	O
used	O
to	O
compute	O
several	O
possible	O
epipolar	B
lines	I
corresponding	O
to	O
a	O
noise	B
level	O
of	O
0.5	O
pixels	O
in	O
each	O
matched	O
point	B
coordinate	O
.	O
to	O
test	O
the	O
theory	O
,	O
the	O
mean	O
and	O
covariance	B
of	O
the	O
epipolar	B
line	I
were	O
next	O
computed	O
theoretically	O
.	O
the	O
95	O
%	O
envelope	O
of	O
the	O
epipolar	O
lines	B
was	O
computed	O
and	O
drawn	O
in	O
the	O
second	O
image	O
.	O
the	O
results	O
are	O
shown	O
in	O
ﬁgure	O
11.10	O
for	O
different	O
numbers	O
of	O
points	O
used	O
to	O
compute	O
f.	O
the	O
95	O
%	O
envelope	O
for	O
n	O
=	O
15	O
corresponds	O
closely	O
to	O
the	O
simulated	O
envelope	O
of	O
the	O
lines	O
.	O
the	O
results	O
shown	O
in	O
ﬁgure	O
11.10	O
show	O
the	O
practical	O
importance	O
of	O
computing	O
the	O
epipolar	B
envelopes	O
in	O
point	O
matching	B
.	O
thus	O
,	O
suppose	O
one	O
is	O
attempting	O
to	O
ﬁnd	O
a	O
match	O
for	O
the	O
foreground	O
point	B
in	O
ﬁgure	O
11.9.	O
if	O
the	O
epipolar	B
line	I
is	O
computed	O
from	O
just	O
10	O
point	B
matches	O
,	O
then	O
epipolar	B
search	O
is	O
unlikely	O
to	O
succeed	O
,	O
given	O
the	O
width	O
of	O
the	O
302	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
10	O
8	O
6	O
4	O
2	O
0	O
0	O
2	O
4	O
a	O
8	O
6	O
10	O
point	B
number	O
0.8	O
0.7	O
0.6	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
0	O
2	O
4	O
12	O
14	O
16	O
12	O
14	O
16	O
8	O
6	O
10	O
point	B
number	O
b	O
fig	O
.	O
11.8.	O
comparison	O
of	O
theoretical	O
and	O
monte	O
carlo	O
simulated	O
values	O
of	O
orientation	O
angle	B
of	O
epipolar	B
lines	I
for	O
15	O
test	O
points	O
form	O
the	O
statue	O
image	O
pair	O
of	O
ﬁgure	O
11.2	O
(	O
p289	O
)	O
.	O
the	O
horizontal	O
axis	O
represents	O
the	O
point	B
number	O
(	O
1	O
to	O
15	O
)	O
and	O
the	O
vertical	O
axis	O
the	O
standard	O
deviation	O
of	O
angle	O
.	O
(	O
a	O
)	O
the	O
results	O
when	O
the	O
epipolar	B
structure	O
(	O
fundamental	B
matrix	I
)	O
is	O
computed	O
from	O
15	O
points	O
.	O
(	O
b	O
)	O
the	O
results	O
when	O
50	O
point	B
matches	O
are	O
used	O
.	O
note	O
:	O
the	O
horizontal	O
axis	O
of	O
these	O
graphs	O
represent	O
discrete	O
points	O
numbered	O
1	O
to	O
15.	O
the	O
graphs	O
are	O
shown	O
as	O
a	O
continuous	O
curve	O
only	O
for	O
visual	O
clarity	O
.	O
envelope	O
.	O
even	O
for	O
n	O
=	O
15	O
,	O
the	O
width	O
of	O
the	O
envelope	O
at	O
the	O
level	O
of	O
the	O
correct	O
match	O
is	O
several	O
tens	O
of	O
pixels	O
.	O
for	O
n	O
=	O
25	O
,	O
the	O
situation	O
is	O
more	O
favourable	O
.	O
note	O
that	O
this	O
instability	O
is	O
inherent	O
in	O
the	O
problem	O
,	O
and	O
not	O
the	O
result	O
of	O
any	O
speciﬁc	O
algorithm	B
for	O
computing	B
f.	O
an	O
interesting	O
point	B
concerns	O
the	O
location	O
of	O
the	O
narrowest	O
point	B
of	O
the	O
envelope	O
.	O
in	O
this	O
case	O
,	O
it	O
appears	O
to	O
be	O
close	O
to	O
the	O
correct	O
match	O
position	O
for	O
the	O
background	O
point	B
in	O
ﬁgure	O
11.9.	O
the	O
match	O
for	O
the	O
foreground	O
point	B
(	O
leg	O
of	O
statue	O
)	O
lies	O
far	O
from	O
the	O
narrowest	O
point	B
of	O
the	O
envelope	O
.	O
though	O
the	O
precise	O
location	O
of	O
the	O
narrow	O
point	B
of	O
the	O
envelope	O
is	O
not	O
fully	O
understood	O
,	O
it	O
appears	O
that	O
in	O
this	O
case	O
,	O
most	O
points	O
used	O
to	O
the	O
computation	B
of	I
f	O
are	O
on	O
the	O
background	O
building	O
.	O
this	O
biases	O
towards	O
the	O
supposition	O
that	O
other	O
matched	O
points	O
lie	O
close	O
to	O
the	O
plane	B
of	O
the	O
building	O
.	O
the	O
match	O
for	O
a	O
point	O
at	O
signiﬁcantly	O
different	O
depth	O
is	O
less	O
precisely	O
known	O
.	O
matching	B
points	O
close	O
to	O
the	O
epipole	O
–	O
the	O
corridor	B
scene	I
.	O
in	O
the	O
case	O
where	O
the	O
points	O
to	O
be	O
matched	O
are	O
close	O
to	O
the	O
epipole	O
,	O
then	O
the	O
determination	O
of	O
the	O
epipolar	O
line	B
is	O
more	O
unstable	O
,	O
since	O
any	O
uncertainty	O
in	O
the	O
position	O
of	O
the	O
epipole	O
results	O
in	O
uncertainty	O
in	O
the	O
slope	O
of	O
the	O
epipolar	O
line	B
.	O
in	O
addition	O
,	O
as	O
one	O
approaches	O
this	O
unstable	O
position	O
,	O
the	O
linear	B
approximations	O
implicit	O
in	O
the	O
derivation	B
of	O
(	O
11.14	O
)	O
become	O
less	O
tenable	O
.	O
in	O
particular	O
,	O
the	O
distribution	B
of	O
the	O
epipolar	B
lines	I
deviates	O
from	O
a	O
normal	O
distribution	O
.	O
11.12	O
image	O
rectiﬁcation	O
this	O
section	O
gives	O
a	O
method	O
for	O
image	O
rectiﬁcation	O
,	O
the	O
process	O
of	O
resampling	O
pairs	O
of	O
stereo	O
images	O
taken	O
from	O
widely	O
differing	O
viewpoints	O
in	O
order	O
to	O
produce	O
a	O
pair	O
of	O
“	O
matched	O
epipolar	B
projections	O
”	O
.	O
these	O
are	O
projections	O
in	O
which	O
the	O
epipolar	B
lines	I
run	O
parallel	B
with	O
the	O
x-axis	O
and	O
match	O
up	O
between	O
views	O
,	O
and	O
consequently	O
disparities	O
between	O
the	O
images	O
are	O
in	O
the	O
x-direction	O
only	O
,	O
i.e	O
.	O
there	O
is	O
no	O
y	O
disparity	O
.	O
11.12	O
image	O
rectiﬁcation	O
303	O
a	O
b	O
fig	O
.	O
11.9	O
.	O
(	O
a	O
)	O
the	O
point	B
in	O
the	O
ﬁrst	O
image	O
used	O
to	O
compute	O
the	O
epipolar	B
envelopes	O
in	O
the	O
second	O
images	O
.	O
note	O
the	O
ambiguity	B
of	O
which	O
point	B
is	O
to	O
be	O
found	O
in	O
the	O
second	O
image	O
.	O
the	O
marked	O
point	B
may	O
represent	O
the	O
point	B
on	O
the	O
statue	O
’	O
s	O
leg	O
(	O
foreground	O
)	O
or	O
the	O
point	B
on	O
the	O
building	O
behind	O
the	O
statue	O
(	O
background	O
)	O
.	O
in	O
the	O
second	O
image	O
,	O
these	O
two	O
points	O
are	O
quite	O
separate	O
,	O
and	O
the	O
epipolar	B
line	I
must	O
pass	O
through	O
them	O
both	O
.	O
(	O
b	O
)	O
computed	O
corresponding	O
epipolar	B
lines	I
computed	O
from	O
n	O
=	O
15	O
point	B
matches	O
.	O
the	O
different	O
lines	B
correspond	O
to	O
different	O
instances	O
of	O
injected	O
noise	B
in	O
the	O
matched	O
points	O
.	O
gaussian	O
noise	B
of	O
0.5	O
pixels	O
in	O
each	O
coordinate	O
was	O
added	O
to	O
the	O
ideal	O
matched	O
point	B
positions	O
before	O
computing	B
the	O
epipolar	B
line	I
corresponding	O
to	O
the	O
selected	O
point	B
.	O
the	O
ml	O
estimator	B
(	O
gold	O
standard	O
algorithm	B
)	O
was	O
used	O
to	O
compute	O
f.	O
this	O
experiment	O
shows	O
the	O
basic	O
instability	O
of	O
the	O
computation	O
of	O
the	O
epipolar	O
lines	B
from	O
small	O
numbers	O
of	O
points	O
.	O
to	O
ﬁnd	O
the	O
point	B
matching	O
the	O
selected	O
point	B
in	O
the	O
image	O
at	O
left	O
,	O
one	O
needs	O
to	O
search	O
over	O
the	O
regions	O
covered	O
by	O
all	O
these	O
epipolar	B
lines	I
.	O
the	O
method	O
is	O
based	O
on	O
the	O
fundamental	B
matrix	I
.	O
a	O
pair	O
of	O
2d	O
projective	B
transfor-	O
mations	O
are	O
applied	O
to	O
the	O
two	O
images	O
in	O
order	O
to	O
match	O
the	O
epipolar	B
lines	I
.	O
it	O
is	O
shown	O
that	O
the	O
two	O
transformations	O
may	O
be	O
chosen	O
in	O
such	O
a	O
way	O
that	O
matching	B
points	O
have	O
approximately	O
the	O
same	O
x-coordinate	O
as	O
well	O
.	O
in	O
this	O
way	O
,	O
the	O
two	O
images	O
,	O
if	O
overlaid	O
on	O
top	O
of	O
each	O
other	O
,	O
will	O
correspond	O
as	O
far	O
as	O
possible	O
,	O
and	O
any	O
disparities	O
will	O
be	O
parallel	B
to	O
the	O
x-axis	O
.	O
since	O
the	O
application	O
of	O
arbitrary	O
2d	O
projective	B
transformations	O
may	O
distort	O
the	O
image	O
substantially	O
,	O
the	O
method	O
for	O
ﬁnding	O
the	O
pair	O
of	O
transformations	O
subjects	O
the	O
images	O
to	O
a	O
minimal	O
distortion	O
.	O
in	O
effect	O
,	O
transforming	O
the	O
two	O
images	O
by	O
the	O
appropriate	O
projective	B
transformations	O
reduces	O
the	O
problem	O
to	O
the	O
epipolar	B
geometry	O
produced	O
by	O
a	O
pair	O
of	O
identical	O
cameras	B
placed	O
side	O
by	O
side	O
with	O
their	O
principal	O
axes	O
parallel	B
.	O
many	O
stereo	O
matching	O
algorithms	O
described	O
in	O
previous	O
literature	O
have	O
assumed	O
this	O
geometry	O
.	O
after	O
this	O
rectiﬁcation	O
the	O
search	O
for	O
matching	O
points	O
is	O
vastly	O
simpliﬁed	O
by	O
the	O
simple	O
epipolar	O
structure	B
and	O
by	O
the	O
near-correspondence	O
of	O
the	O
two	O
images	O
.	O
it	O
may	O
be	O
used	O
as	O
a	O
preliminary	O
step	O
to	O
comprehensive	O
image	O
matching	O
.	O
11.12.1	O
mapping	B
the	I
epipole	I
to	I
inﬁnity	I
in	O
this	O
section	O
we	O
will	O
discuss	O
the	O
question	O
of	O
ﬁnding	O
a	O
projective	B
transformation	I
h	O
of	O
an	O
image	O
that	O
maps	O
the	O
epipole	O
to	O
a	O
point	B
at	O
inﬁnity	O
.	O
in	O
fact	O
,	O
if	O
epipolar	B
lines	I
are	O
to	O
be	O
transformed	O
to	O
lines	O
parallel	B
with	O
the	O
x-axis	O
,	O
then	O
the	O
epipole	O
should	O
be	O
mapped	O
to	O
304	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
n	O
=	O
10	O
n	O
=	O
15	O
n	O
=	O
25	O
n	O
=	O
50	O
fig	O
.	O
11.10.	O
the	O
95	O
%	O
envelopes	O
of	B
epipolar	I
lines	I
are	O
shown	O
for	O
a	O
noise	O
level	O
of	O
0.5	O
pixels	O
,	O
with	O
f	O
being	O
computed	O
from	O
n	O
=	O
10	O
,	O
15	O
,	O
25	O
and	O
50	O
points	O
.	O
in	O
each	O
case	O
,	O
monte	O
carlo	O
simulated	O
results	O
agreed	O
closely	O
with	O
these	O
results	O
(	O
though	O
not	O
shown	O
here	O
)	O
.	O
for	O
the	O
case	O
n	O
=	O
15	O
,	O
compare	O
with	O
ﬁgure	O
11.9.	O
note	O
that	O
for	O
n	O
=	O
10	O
,	O
the	O
epipolar	B
envelope	I
is	O
very	O
wide	O
(	O
>	O
90	O
degrees	O
)	O
,	O
showing	O
that	O
one	O
can	O
have	O
very	O
little	O
conﬁdence	O
in	O
an	O
epipolar	B
line	I
computed	O
from	O
10	O
points	O
in	O
this	O
case	O
.	O
for	O
n	O
=	O
15	O
,	O
the	O
envelope	O
is	O
still	O
quite	O
wide	O
.	O
for	O
n	O
=	O
25	O
and	O
n	O
=	O
50	O
,	O
the	O
epipolar	B
line	I
is	O
known	O
with	O
quite	O
good	O
precision	O
.	O
of	O
course	O
,	O
the	O
precise	O
shape	O
of	O
the	O
envelope	O
depends	O
strongly	O
on	O
just	O
what	O
matched	O
points	O
are	O
used	O
to	O
compute	O
the	O
epipolar	B
structure	O
.	O
the	O
particular	O
inﬁnite	O
point	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t.	O
this	O
leaves	O
many	O
degrees	B
of	I
freedom	I
(	O
in	O
fact	O
four	O
)	O
open	O
for	O
h	O
,	O
and	O
if	O
an	O
inappropriate	O
h	O
is	O
chosen	O
,	O
severe	O
projective	B
distortion	O
of	O
the	O
image	O
can	O
take	O
place	O
.	O
in	O
order	O
that	O
the	O
resampled	O
image	O
should	O
look	O
somewhat	O
like	O
the	O
original	O
image	O
,	O
we	O
may	O
put	O
closer	O
restrictions	O
on	O
the	O
choice	B
of	O
h.	O
one	O
condition	O
that	O
leads	O
to	O
good	O
results	O
is	O
to	O
insist	O
that	O
the	O
transformation	B
h	O
should	O
act	O
as	O
far	O
as	O
possible	O
as	O
a	O
rigid	O
transformation	B
in	O
the	O
neighbourhood	O
of	O
a	O
given	O
selected	O
point	B
x0	O
of	O
the	O
image	O
.	O
by	O
this	O
is	O
meant	O
that	O
to	O
ﬁrst-order	O
the	O
neighbourhood	O
of	O
x0	O
may	O
undergo	O
rotation	B
and	I
translation	I
only	O
,	O
and	O
hence	O
will	O
look	O
the	O
same	O
in	O
the	O
original	O
and	O
resampled	O
images	O
.	O
an	O
appropriate	O
choice	B
of	O
point	B
x0	O
may	O
be	O
the	O
centre	B
of	O
the	O
image	O
.	O
for	O
instance	O
,	O
this	O
would	O
be	O
a	O
good	O
choice	B
in	O
the	O
context	O
of	O
aerial	O
photography	O
if	O
the	O
view	O
is	O
known	O
not	O
to	O
be	O
excessively	O
oblique	O
.	O
for	O
the	O
present	O
,	O
suppose	O
x0	O
is	O
the	O
origin	O
and	O
the	O
epipole	O
e	O
=	O
(	O
f	O
,	O
0	O
,	O
1	O
)	O
t	O
lies	O
on	O
the	O
x-axis	O
.	O
now	O
consider	O
the	O
following	O
transformation	B
11.12	O
image	O
rectiﬁcation	O
	O
.	O
g	O
=	O
1	O
0	O
0	O
0	O
1	O
0	O
−1/f	O
0	O
1	O
305	O
(	O
11.16	O
)	O
	O
(	O
cid:17	O
)	O
this	O
transformation	B
takes	O
the	O
epipole	O
(	O
f	O
,	O
0	O
,	O
1	O
)	O
t	O
to	O
the	O
point	B
at	O
inﬁnity	O
(	O
f	O
,	O
0	O
,	O
0	O
)	O
t	O
as	O
required	O
.	O
a	O
point	B
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
is	O
mapped	O
by	O
g	O
to	O
the	O
point	B
(	O
ˆx	O
,	O
ˆy	O
,	O
1	O
)	O
t	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
−	O
x/f	O
)	O
t.	O
if	O
|x/f|	O
<	O
1	O
then	O
we	O
may	O
write	O
(	O
ˆx	O
,	O
ˆy	O
,	O
1	O
)	O
t	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
−	O
x/f	O
)	O
t	O
=	O
(	O
x	O
(	O
1	O
+	O
x/f	O
+	O
.	O
.	O
.	O
)	O
,	O
y	O
(	O
1	O
+	O
x/f	O
+	O
.	O
.	O
.	O
)	O
,	O
1	O
)	O
t.	O
the	O
jacobian	O
is	O
∂	O
(	O
ˆx	O
,	O
ˆy	O
)	O
∂	O
(	O
x	O
,	O
y	O
)	O
=	O
1	O
+	O
2x/f	O
0	O
y/f	O
1	O
+	O
x/f	O
(	O
cid:18	O
)	O
plus	O
higher	O
order	O
terms	O
in	O
x	O
and	O
y.	O
now	O
if	O
x	O
=	O
y	O
=	O
0	O
then	O
this	O
is	O
the	O
identity	O
map	O
.	O
in	O
other	O
words	O
,	O
g	O
is	O
approximated	O
(	O
to	O
ﬁrst-order	O
)	O
at	O
the	O
origin	O
by	O
the	O
identity	O
mapping	O
.	O
for	O
an	O
arbitrarily	O
placed	O
point	B
of	O
interest	O
x0	O
and	O
epipole	O
e	O
,	O
the	O
required	O
mapping	O
h	O
is	O
a	O
product	O
h	O
=	O
grt	O
where	O
t	O
is	O
a	O
translation	O
taking	O
the	O
point	B
x0	O
to	O
the	O
origin	O
,	O
r	O
is	O
a	O
rotation	B
about	O
the	O
origin	O
taking	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
to	O
a	O
point	B
(	O
f	O
,	O
0	O
,	O
1	O
)	O
t	O
on	O
the	O
x-axis	O
,	O
and	O
g	O
is	O
the	O
mapping	O
just	O
considered	O
taking	O
(	O
f	O
,	O
0	O
,	O
1	O
)	O
t	O
to	O
inﬁnity	O
.	O
the	O
composite	O
mapping	O
is	O
to	O
ﬁrst-order	O
a	O
rigid	O
transformation	B
in	O
the	O
neighbourhood	O
of	O
x0	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
11.12.2	O
matching	B
transformations	O
in	O
the	O
previous	O
section	O
it	O
was	O
shown	O
how	O
the	O
epipole	O
in	B
one	I
image	I
may	O
be	O
mapped	O
to	O
inﬁnity	O
.	O
next	O
,	O
it	O
will	O
be	O
seen	O
how	O
a	O
map	O
may	O
be	O
applied	O
to	O
the	O
other	O
image	O
to	O
match	O
.	O
the	O
intention	O
is	O
to	O
resample	O
up	O
the	O
epipolar	B
lines	I
.	O
we	O
consider	O
two	O
images	O
j	O
and	O
j	O
these	O
two	O
images	O
according	O
to	O
transformations	O
h	O
to	O
be	O
applied	O
to	O
j	O
and	O
h	O
(	O
cid:2	O
)	O
to	O
be	O
applied	O
to	O
j	O
.	O
the	O
resampling	O
is	O
to	O
be	O
done	O
in	O
such	O
a	O
way	O
that	O
an	O
epipolar	B
line	I
in	O
j	O
is	O
matched	O
.	O
more	O
speciﬁcally	O
,	O
if	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
with	O
its	O
corresponding	O
epipolar	B
line	I
in	O
j	O
are	O
any	O
pair	O
of	O
corresponding	O
epipolar	B
lines	I
in	O
the	O
two	O
images	O
,	O
then	O
h−tl	O
=	O
h	O
(	O
cid:2	O
)	O
−tl	O
(	O
cid:2	O
)	O
.	O
(	O
recall	O
that	O
h−t	O
is	O
the	O
line	B
map	O
corresponding	O
to	O
the	O
point	B
map	O
h.	O
)	O
any	O
pair	O
of	O
transformations	O
satisfying	O
this	O
condition	O
will	O
be	O
called	O
a	O
matched	O
pair	O
of	O
transformations	O
.	O
ﬁrst	O
to	O
be	O
some	O
transformation	B
that	O
sends	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
to	O
inﬁnity	O
as	O
described	O
in	O
the	O
previous	O
section	O
.	O
we	O
then	O
seek	O
a	O
matching	B
transformation	O
h	O
chosen	O
so	O
as	O
to	O
minimize	O
the	O
sum-	O
of-squared	O
distances	O
our	O
strategy	O
in	O
choosing	O
a	O
matched	O
pair	O
of	O
transformations	O
is	O
to	O
choose	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:7	O
)	O
d	O
(	O
hxi	O
,	O
h	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
.	O
(	O
11.17	O
)	O
the	O
ﬁrst	O
question	O
to	O
be	O
determined	O
is	O
how	O
to	O
ﬁnd	O
a	O
transformation	B
matching	O
h	O
(	O
cid:2	O
)	O
question	O
is	O
answered	O
in	O
the	O
following	O
result	O
.	O
.	O
that	O
i	O
result	O
11.3.	O
let	O
j	O
and	O
j	O
a	O
projective	B
transformation	I
of	O
j	O
be	O
images	O
with	O
fundamental	O
matrix	B
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×m	O
,	O
and	O
let	O
h	O
(	O
cid:2	O
)	O
.	O
a	O
projective	B
transformation	I
h	O
of	O
j	O
matches	O
h	O
(	O
cid:2	O
)	O
be	O
if	O
and	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
306	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
only	O
if	O
h	O
is	O
of	O
the	O
form	O
h	O
=	O
(	O
i	O
+	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
at	O
)	O
h	O
(	O
cid:2	O
)	O
m	O
(	O
11.18	O
)	O
for	O
some	O
vector	O
a.	O
proof	O
.	O
if	O
x	O
is	O
a	O
point	B
in	O
j	O
,	O
then	O
e×x	O
is	O
the	O
epipolar	B
line	I
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
fx	O
is	O
the	O
epipolar	B
line	I
in	O
the	O
second	O
image	O
.	O
transformations	O
h	O
and	O
h	O
(	O
cid:2	O
)	O
are	O
a	O
matching	B
pair	O
if	O
and	O
only	O
if	O
h−t	O
(	O
e×	O
x	O
)	O
=	O
h	O
(	O
cid:2	O
)	O
−tfx	O
.	O
since	O
this	O
must	O
hold	O
for	O
all	O
x	O
we	O
may	O
write	O
equivalently	O
h−t	O
[	O
e	O
]	O
×	O
=	O
h	O
(	O
cid:2	O
)	O
−tf	O
=	O
h	O
(	O
cid:2	O
)	O
−t	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×m	O
or	O
,	O
applying	O
result	O
a4.3	O
(	O
p582	O
)	O
,	O
[	O
he	O
]	O
×h	O
=	O
[	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
]	O
×h	O
(	O
cid:2	O
)	O
m.	O
(	O
11.19	O
)	O
in	O
view	O
of	O
lemma	O
9.11	O
(	O
p255	O
)	O
,	O
this	O
implies	O
h	O
=	O
(	O
i	O
+	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
at	O
)	O
h	O
(	O
cid:2	O
)	O
m	O
as	O
required	O
.	O
to	O
prove	O
the	O
converse	O
,	O
if	O
(	O
11.18	O
)	O
holds	O
,	O
then	O
he	O
=	O
(	O
i	O
+	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
at	O
)	O
h	O
(	O
cid:2	O
)	O
me	O
=	O
(	O
i	O
+	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
at	O
)	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
=	O
(	O
1	O
+	O
ath	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
)	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
=	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
.	O
this	O
,	O
along	O
with	O
(	O
11.18	O
)	O
,	O
is	O
sufﬁcient	O
for	O
(	O
11.19	O
)	O
to	O
hold	O
,	O
and	O
so	O
h	O
and	O
h	O
(	O
cid:2	O
)	O
transformations	O
.	O
are	O
matching	B
we	O
are	O
particularly	O
interested	O
in	O
the	O
case	O
when	O
h	O
(	O
cid:2	O
)	O
is	O
a	O
transformation	B
taking	O
the	O
to	O
a	O
point	B
at	O
inﬁnity	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t.	O
in	O
this	O
case	O
,	O
i	O
+	O
h	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
at	O
=	O
i	O
+	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
tat	O
is	O
epipole	O
e	O
(	O
cid:2	O
)	O
of	O
the	O
form	O
	O
a	O
b	O
c	O
0	O
1	O
0	O
0	O
0	O
1	O
	O
ha	O
=	O
(	O
11.20	O
)	O
(	O
11.21	O
)	O
which	O
represents	O
an	O
afﬁne	B
transformation	I
.	O
thus	O
,	O
a	O
special	O
case	O
of	O
result	O
11.3	O
is	O
(	O
cid:2	O
)	O
be	O
images	O
with	O
fundamental	O
matrix	B
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
be	O
a	O
projective	B
transformation	I
of	O
j	O
corollary	O
11.4.	O
let	O
j	O
and	O
j	O
h	O
(	O
cid:2	O
)	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t.	O
a	O
transformation	B
h	O
of	O
j	O
matches	O
h	O
(	O
cid:2	O
)	O
where	O
h0	O
=	O
h	O
(	O
cid:2	O
)	O
m	O
and	O
ha	O
is	O
an	O
afﬁne	B
transformation	I
of	O
the	O
form	O
(	O
11.20	O
)	O
.	O
]	O
×m	O
,	O
and	O
let	O
to	O
the	O
inﬁnite	O
point	O
if	O
and	O
only	O
if	O
h	O
is	O
of	O
the	O
form	O
h	O
=	O
hah0	O
,	O
mapping	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
given	O
h	O
(	O
cid:2	O
)	O
mapping	B
the	I
epipole	I
to	I
inﬁnity	I
,	O
we	O
may	O
use	O
this	O
corollary	O
to	O
make	O
the	O
choice	B
of	O
a	O
matching	B
transformation	O
h	O
to	O
minimize	O
the	O
disparity	O
.	O
writing	O
ˆx	O
(	O
cid:2	O
)	O
i	O
=	O
h	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
i	O
and	O
ˆxi	O
=	O
h0xi	O
,	O
the	O
minimization	B
problem	O
(	O
11.17	O
)	O
is	O
to	O
ﬁnd	O
ha	O
of	O
the	O
form	O
(	O
11.20	O
)	O
such	O
that	O
(	O
cid:7	O
)	O
i	O
d	O
(	O
haˆxi	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
is	O
minimized	O
.	O
in	O
particular	O
,	O
let	O
ˆxi	O
=	O
(	O
ˆxi	O
,	O
ˆyi	O
,	O
1	O
)	O
t	O
,	O
and	O
let	O
ˆx	O
(	O
cid:2	O
)	O
these	O
vectors	O
may	O
be	O
computed	O
from	O
the	O
matched	O
points	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
be	O
minimized	O
(	O
11.21	O
)	O
may	O
be	O
written	O
as	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
1	O
)	O
t.	O
since	O
h	O
(	O
cid:2	O
)	O
i	O
,	O
ˆy	O
i	O
=	O
(	O
ˆx	O
and	O
m	O
are	O
known	O
,	O
i.	O
then	O
the	O
quantity	O
to	O
(	O
cid:7	O
)	O
i	O
(	O
aˆxi	O
+	O
bˆyi	O
+	O
c	O
−	O
ˆx	O
i	O
)	O
2	O
+	O
(	O
ˆyi	O
−	O
ˆy	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
)	O
2.	O
since	O
(	O
ˆyi	O
−	O
ˆy	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
is	O
a	O
constant	O
,	O
this	O
is	O
equivalent	B
to	O
minimizing	B
11.12	O
image	O
rectiﬁcation	O
(	O
cid:7	O
)	O
(	O
aˆxi	O
+	O
bˆyi	O
+	O
c	O
−	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
.	O
307	O
i	O
this	O
is	O
a	O
simple	O
linear	O
least-squares	O
parameter	O
minimization	B
problem	O
,	O
and	O
is	O
easily	O
solved	O
using	O
linear	O
techniques	O
(	O
see	O
section	O
a5.1	O
(	O
p588	O
)	O
)	O
to	O
ﬁnd	O
a	O
,	O
b	O
and	O
c.	O
then	O
ha	O
is	O
computed	O
from	O
(	O
11.20	O
)	O
and	O
h	O
from	O
(	O
11.18	O
)	O
.	O
note	O
that	O
a	O
linear	B
solution	I
is	O
possible	O
because	O
ha	O
is	O
an	O
afﬁne	B
transformation	I
.	O
if	O
it	O
were	O
simply	O
a	O
projective	B
transformation	I
,	O
this	O
would	O
not	O
be	O
a	O
linear	B
problem	O
.	O
11.12.3	O
algorithm	B
outline	I
the	O
resampling	O
algorithm	B
will	O
now	O
be	O
summarized	O
.	O
the	O
input	O
is	O
a	O
pair	O
of	O
images	O
containing	O
a	O
common	O
overlap	O
region	O
.	O
the	O
output	O
is	O
a	O
pair	O
of	O
images	O
resampled	O
so	O
that	O
the	O
epipolar	B
lines	I
in	O
the	O
two	O
images	O
are	O
horizontal	O
(	O
parallel	B
with	O
the	O
x-axis	O
)	O
,	O
and	O
such	O
that	O
corresponding	O
points	O
in	O
the	O
two	O
images	O
are	O
as	O
close	O
to	O
each	O
other	O
as	O
possible	O
.	O
any	O
remaining	O
disparity	O
between	O
matching	O
points	O
will	O
be	O
along	O
the	O
the	O
horizontal	O
epipolar	B
lines	I
.	O
a	O
top-level	O
outline	O
of	O
the	O
algorithm	O
is	O
as	O
follows	O
.	O
(	O
i	O
)	O
identify	O
a	O
seed	O
set	O
of	O
image-to-image	O
matches	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
between	O
the	O
two	O
images	O
.	O
seven	O
points	O
at	O
least	O
are	O
needed	O
,	O
though	O
more	O
are	O
preferable	O
.	O
it	O
is	O
possible	O
to	O
ﬁnd	O
such	O
matches	O
by	O
automatic	O
means	O
.	O
images	O
.	O
(	O
ii	O
)	O
compute	O
the	O
fundamental	B
matrix	I
f	O
and	O
ﬁnd	O
the	O
epipoles	B
e	O
and	O
e	O
(	O
cid:2	O
)	O
(	O
iii	O
)	O
select	O
a	O
projective	B
transformation	I
h	O
(	O
cid:2	O
)	O
(	O
cid:7	O
)	O
inﬁnity	O
,	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t.	O
the	O
method	O
of	O
section	O
11.12.1	O
gives	O
good	O
results	O
.	O
that	O
maps	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
distance	B
(	O
iv	O
)	O
find	O
the	O
matching	B
projective	O
transformation	B
h	O
that	O
minimizes	O
the	O
least-squares	O
to	O
the	O
point	B
at	O
in	O
the	O
two	O
d	O
(	O
hxi	O
,	O
h	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
i	O
)	O
.	O
(	O
11.22	O
)	O
i	O
(	O
v	O
)	O
resample	O
the	O
ﬁrst	O
image	O
according	O
to	O
the	O
projective	B
transformation	I
h	O
and	O
the	O
the	O
method	O
used	O
is	O
a	O
linear	B
method	O
described	O
in	O
section	O
11.12.2.	O
second	O
image	O
according	O
to	O
the	O
projective	B
transformation	I
h	O
(	O
cid:2	O
)	O
.	O
example	O
11.5.	O
model	B
house	O
images	O
figure	O
11.11	O
(	O
a	O
)	O
shows	O
a	O
pair	O
of	O
images	O
of	O
some	O
wooden	O
block	O
houses	O
.	O
edges	O
and	O
ver-	O
tices	O
in	O
these	O
two	O
images	O
were	O
extracted	O
automatically	O
and	O
a	O
small	O
number	O
of	O
common	O
vertices	O
were	O
matched	O
by	O
hand	O
.	O
the	O
two	O
images	O
were	O
then	O
resampled	O
according	O
to	O
the	O
methods	O
described	O
here	O
.	O
the	O
results	O
are	O
shown	O
in	O
ﬁgure	O
11.11	O
(	O
b	O
)	O
.	O
in	O
this	O
case	O
,	O
because	O
of	O
the	O
wide	O
difference	O
in	O
viewpoint	O
,	O
and	O
the	O
three-dimensional	O
shape	O
of	O
the	O
objects	O
,	O
the	O
two	O
images	O
even	O
after	O
resampling	O
look	O
quite	O
different	O
.	O
however	O
,	O
it	O
is	O
the	O
case	O
that	O
any	O
point	B
in	O
the	O
ﬁrst	O
image	O
will	O
now	O
match	O
a	O
point	B
in	O
the	O
second	O
image	O
with	O
the	O
same	O
y-	O
coordinate	O
.	O
therefore	O
,	O
in	O
order	O
to	O
ﬁnd	O
further	O
point	B
matches	O
between	O
the	O
images	O
only	O
(	O
cid:2	O
)	O
a	O
1-dimensional	O
search	O
is	O
required	O
.	O
308	O
11	O
computation	B
of	I
the	O
fundamental	B
matrix	I
f	O
a	O
b	O
fig	O
.	O
11.11.	O
image	O
rectiﬁcation	O
.	O
(	O
a	O
)	O
a	O
pair	O
of	O
images	O
of	O
a	O
house	O
.	O
(	O
b	O
)	O
resampled	O
images	O
computed	O
from	O
(	O
a	O
)	O
using	O
a	O
projective	B
transformation	I
computed	O
from	O
f.	O
note	O
,	O
corresponding	O
points	O
in	O
(	O
b	O
)	O
match	O
horizontally	O
.	O
a	O
b	O
fig	O
.	O
11.12.	O
image	O
rectiﬁcation	O
using	O
afﬁnities	O
.	O
(	O
a	O
)	O
a	O
pair	O
of	O
original	O
images	O
and	O
(	O
b	O
)	O
a	O
detail	O
of	O
the	O
images	O
rectiﬁed	O
using	O
afﬁne	O
transformations	O
.	O
the	O
average	O
y-disparity	O
after	O
rectiﬁcation	O
is	O
of	O
the	O
order	O
of	O
3	O
pixels	O
in	O
a	O
512	O
×	O
512	O
image	O
.	O
(	O
for	O
correctly	O
rectiﬁed	O
images	O
the	O
y-disparity	O
should	O
be	O
zero	O
.	O
)	O
11.12.4	O
afﬁne	B
rectiﬁcation	O
the	O
theory	O
discussed	O
in	O
this	O
section	O
can	O
equally	O
be	O
applied	O
to	O
afﬁne	O
resampling	O
.	O
if	O
the	O
two	O
cameras	O
can	O
be	O
well	O
approximated	O
by	O
afﬁne	B
cameras	I
,	O
then	O
one	O
can	O
rectify	O
the	O
images	O
using	O
just	O
afﬁne	B
transformations	O
.	O
to	O
do	O
this	O
,	O
one	O
uses	O
the	O
afﬁne	B
fundamental	I
matrix	I
(	O
see	O
section	O
14.2	O
(	O
p345	O
)	O
)	O
instead	O
of	O
the	O
general	O
fundamental	B
matrix	I
.	O
the	O
above	O
method	O
with	O
only	O
minor	O
variations	O
can	O
then	O
be	O
applied	O
to	O
compute	O
a	O
pair	O
of	O
match-	O
ing	O
afﬁne	B
transformations	O
.	O
figure	O
11.12	O
shows	O
a	O
pair	O
of	O
images	O
rectiﬁed	O
using	O
afﬁne	O
transformations	O
.	O
11.13	O
closure	O
11.13.1	O
the	O
literature	O
the	O
basic	O
idea	O
behind	O
the	O
computation	B
of	I
the	O
fundamental	B
matrix	I
is	O
given	O
in	O
[	O
longuethiggins-81	O
]	O
,	O
which	O
is	O
well	O
worth	O
reading	O
.	O
it	O
addresses	O
the	O
case	O
of	O
calibrated	O
matrices	O
only	O
,	O
but	O
the	O
principles	O
apply	O
to	O
the	O
uncalibrated	O
case	O
as	O
well	O
.	O
a	O
good	O
refer-	O
ence	O
for	O
the	O
uncalibrated	O
case	O
is	O
[	O
zhang-98	O
]	O
which	O
considers	O
most	O
of	O
the	O
best	O
methods	O
.	O
in	O
addition	O
,	O
that	O
paper	O
considers	O
the	O
uncertainty	O
envelopes	O
of	B
epipolar	I
lines	I
,	O
following	O
earlier	O
work	O
by	O
csurka	O
et	O
al	O
.	O
[	O
csurka-97	O
]	O
.	O
a	O
more	O
detailed	O
study	O
of	O
the	O
8-point	O
algo-	O
rithm	O
in	O
the	O
uncalibrated	O
case	O
is	O
given	O
in	O
[	O
hartley-97c	O
]	O
.	O
weng	O
et	O
al	O
.	O
[	O
weng-89	O
]	O
used	O
sampson	O
approximation	O
for	O
the	O
fundamental	B
matrix	I
cost	O
function	O
.	O
the	O
svd	O
method	O
of	O
coercing	O
the	O
estimated	O
f	O
to	O
have	O
rank	O
2	O
was	O
suggested	O
by	O
tsai	O
&	O
huang	O
[	O
tsai-84	O
]	O
.	O
there	O
is	O
a	O
wealth	O
of	O
literature	O
on	O
conic	O
ﬁtting	O
–	O
minimizing	B
algebraic	I
distance	O
[	O
bookstein-79	O
]	O
;	O
approximating	O
geometric	B
distance	I
[	O
sampson-82	O
,	O
pratt-87	O
,	O
taubin-91	O
]	O
;	O
optimal	O
ﬁtting	O
[	O
kanatani-94	O
]	O
;	O
and	O
ﬁtting	O
special	O
forms	O
[	O
fitzgibbon-99	O
]	O
.	O
11.13	O
closure	O
309	O
11.13.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
six	O
point	B
correspondences	O
constrain	O
e	O
and	O
e	O
(	O
cid:2	O
)	O
to	O
a	O
plane	B
cubic	O
in	O
each	O
image	O
(	O
[	O
faugeras-93	O
]	O
,	O
page	O
298	O
)	O
.	O
the	O
cubic	O
also	O
passes	O
through	O
the	O
six	O
points	O
in	O
each	O
image	O
.	O
a	O
sketch	O
derivation	B
of	O
these	O
results	O
follows	O
.	O
given	O
six	O
correspon-	O
dences	O
,	O
the	O
null-space	B
of	O
a	O
in	O
(	O
11.3–p279	O
)	O
will	O
be	O
3-dimensional	O
.	O
then	O
the	O
solution	B
is	O
f	O
=	O
α1f1	O
+	O
α2f2	O
+	O
α3f3	O
,	O
where	O
fi	O
denotes	O
the	O
matrices	O
correspond-	O
ing	O
to	O
the	O
vectors	O
spanning	O
the	O
null-space	B
.	O
the	O
epipole	O
satisﬁes	O
fe	O
=	O
0	O
,	O
so	O
that	O
[	O
(	O
f1e	O
)	O
,	O
(	O
f2e	O
)	O
,	O
(	O
f3e	O
)	O
]	O
(	O
α1	O
,	O
α2	O
,	O
α3	O
)	O
t	O
=	O
0.	O
since	O
this	O
equation	O
has	O
a	O
solution	B
it	O
follows	O
that	O
det	O
[	O
(	O
f1e	O
)	O
,	O
(	O
f2e	O
)	O
,	O
(	O
f3e	O
)	O
]	O
=	O
0	O
which	O
is	O
a	O
cubic	O
in	O
e.	O
(	O
ii	O
)	O
show	O
that	O
the	O
image	O
correspondence	O
of	O
four	O
coplanar	O
points	O
and	O
a	O
quadric	O
outline	O
determines	O
the	O
fundamental	B
matrix	I
up	O
to	O
a	O
two-fold	O
ambiguity	B
(	O
hint	O
,	O
see	O
algorithm	B
13.2	O
(	O
p336	O
)	O
)	O
.	O
(	O
iii	O
)	O
show	O
that	O
the	O
corresponding	O
images	O
of	O
a	O
(	O
plane	B
)	O
conic	B
are	O
equivalent	B
to	O
two	O
constraints	O
on	O
f.	O
see	O
[	O
kahl-98b	O
]	O
for	O
details	O
.	O
(	O
iv	O
)	O
suppose	O
that	O
a	O
stereo	O
pair	O
of	O
images	O
is	O
acquired	O
by	O
a	O
camera	B
translating	O
forward	O
along	O
its	O
principal	O
axis	O
.	O
can	O
the	O
geometry	O
of	O
image	O
rectiﬁcation	O
described	O
in	O
section	O
11.12	O
be	O
applied	O
in	O
this	O
case	O
?	O
see	O
[	O
pollefeys-99a	O
]	O
for	O
an	O
alternative	O
rectiﬁcation	O
geometry	O
.	O
12	O
structure	B
computation	O
this	O
chapter	O
describes	O
how	O
to	O
compute	O
the	O
position	O
of	O
a	O
point	O
in	O
3-space	O
given	O
its	O
image	O
in	O
two	B
views	I
and	O
the	O
camera	B
matrices	I
of	O
those	O
views	O
.	O
it	O
is	O
assumed	O
that	O
there	O
are	O
errors	O
only	O
in	O
the	O
measured	O
image	O
coordinates	O
,	O
not	O
in	O
the	O
projection	B
matrices	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
.	O
under	O
these	O
circumstances	O
na¨ıve	O
triangulation	B
by	O
back-projecting	O
rays	O
from	O
the	O
mea-	O
sured	O
image	O
points	O
will	O
fail	O
,	O
because	O
the	O
rays	O
will	O
not	O
intersect	O
in	O
general	O
.	O
it	O
is	O
thus	O
necessary	O
to	O
estimate	O
a	O
best	O
solution	B
for	O
the	O
point	B
in	O
3-space	O
.	O
a	O
best	O
solution	B
requires	O
the	O
deﬁnition	B
and	O
minimization	B
of	O
a	O
suitable	O
cost	B
function	I
.	O
this	O
problem	O
is	O
especially	O
critical	O
in	O
afﬁne	B
and	O
projective	B
reconstruction	I
in	O
which	O
there	O
is	O
no	O
meaningful	O
metric	B
information	O
about	O
the	O
object	O
space	O
.	O
it	O
is	O
desirable	O
to	O
ﬁnd	O
a	O
triangulation	B
method	O
that	O
is	O
invariant	O
to	O
projective	O
transformations	B
of	I
space	O
.	O
in	O
the	O
following	O
sections	O
we	O
describe	O
the	O
estimation	B
of	I
x	O
and	O
of	O
its	O
covariance	B
.	O
an	O
optimal	O
(	O
mle	O
)	O
estimator	B
for	O
the	O
point	B
is	O
developed	O
,	O
and	O
it	O
is	O
shown	O
that	O
a	O
solution	B
can	O
be	O
obtained	O
without	O
requiring	O
numerical	O
minimization	B
.	O
note	O
,	O
this	O
is	O
the	O
scenario	O
where	O
f	O
is	O
given	O
a	O
priori	O
and	O
then	O
x	O
is	O
determined	O
.	O
an	O
alternative	O
scenario	O
is	O
where	O
f	O
and	O
{	O
xi	O
}	O
are	O
estimated	O
simultaneously	O
from	O
the	O
im-	O
age	O
point	B
correspondences	O
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
,	O
but	O
this	O
is	O
not	O
considered	O
in	O
this	O
chapter	O
.	O
it	O
may	O
be	O
solved	O
using	O
the	O
gold	O
standard	O
algorithm	B
of	O
section	O
11.4.1	O
,	O
using	O
the	O
method	O
considered	O
in	O
this	O
chapter	O
as	O
an	O
initial	O
estimate	O
.	O
i	O
12.1	O
problem	O
statement	O
it	O
is	O
supposed	O
that	O
the	O
camera	B
matrices	I
,	O
and	O
hence	O
the	O
fundamental	B
matrix	I
,	O
are	O
pro-	O
vided	O
;	O
or	O
that	O
the	O
fundamental	B
matrix	I
is	O
provided	O
,	O
and	O
hence	O
a	O
pair	O
of	O
consistent	O
cam-	O
era	O
matrices	O
can	O
be	O
constructed	O
(	O
as	O
in	O
section	O
9.5	O
(	O
p253	O
)	O
)	O
.	O
in	O
either	O
case	O
it	O
is	O
assumed	O
that	O
these	O
matrices	O
are	O
known	O
exactly	O
,	O
or	O
at	O
least	O
with	O
great	O
accuracy	O
compared	O
with	O
a	O
pair	O
of	O
matching	O
points	O
in	O
the	O
two	O
images	O
.	O
since	O
there	O
are	O
errors	O
in	O
the	O
measured	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
,	O
the	O
rays	O
back-projected	O
from	O
the	O
points	O
are	O
skew	O
.	O
this	O
means	O
that	O
there	O
will	O
not	O
be	O
a	O
point	B
x	O
which	O
exactly	O
satisﬁes	O
x	O
=	O
px	O
,	O
x	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
;	O
and	O
that	O
the	O
image	O
points	O
do	O
not	O
satisfy	O
the	O
epipolar	B
constraint	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0.	O
these	O
statements	O
are	O
equivalent	B
since	O
the	O
two	O
rays	O
corresponding	O
to	O
a	O
matching	B
pair	O
of	B
points	I
x	O
↔	O
x	O
(	O
cid:2	O
)	O
will	O
meet	O
in	O
space	O
if	O
and	O
only	O
if	O
the	O
points	O
satisfy	O
the	O
epipolar	B
constraint	O
.	O
see	O
ﬁgure	O
12.1	O
.	O
310	O
12.1	O
problem	O
statement	O
311	O
x	O
c	O
x	O
/	O
/	O
c	O
l	O
=	O
f	O
/x	O
x	O
image	O
1	O
e	O
a	O
b	O
/	O
x	O
/l	O
=	O
f	O
x	O
e	O
/	O
image	O
2	O
fig	O
.	O
12.1	O
.	O
(	O
a	O
)	O
rays	O
back-projected	O
from	O
imperfectly	O
measured	O
points	O
x	O
,	O
x	O
(	O
cid:1	O
)	O
eral	O
.	O
(	O
b	O
)	O
the	O
epipolar	B
geometry	O
for	O
x	O
,	O
x	O
(	O
cid:1	O
)	O
the	O
epipolar	B
line	I
l	O
(	O
cid:1	O
)	O
=	O
fx	O
is	O
the	O
image	O
of	O
the	O
ray	O
through	O
x	O
,	O
and	O
l	O
=	O
ftx	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
.	O
since	O
the	O
rays	O
do	O
not	O
intersect	O
,	O
x	O
(	O
cid:1	O
)	O
are	O
skew	O
in	O
3-space	O
in	O
gen-	O
.	O
the	O
measured	O
points	O
do	O
not	O
satisfy	O
the	O
epipolar	B
constraint	O
.	O
is	O
the	O
image	O
of	O
the	O
ray	O
through	O
,	O
and	O
x	O
does	O
not	O
lie	O
on	O
l.	O
does	O
not	O
lie	O
on	O
l	O
(	O
cid:1	O
)	O
a	O
desirable	O
feature	O
of	O
the	O
method	O
of	B
triangulation	I
used	O
is	O
that	O
it	O
should	O
be	O
invariant	O
under	O
transformations	B
of	I
the	O
appropriate	O
class	O
for	O
the	O
reconstruction	B
–	O
if	O
the	O
camera	B
matrices	I
are	O
known	O
only	O
up	O
to	O
an	O
afﬁne	B
(	O
or	O
projective	B
)	O
transformation	B
,	O
then	O
it	O
is	O
clearly	O
desirable	O
to	O
use	O
an	O
afﬁne	B
(	O
resp	O
.	O
projective	B
)	O
invariant	O
triangulation	B
method	O
to	O
compute	O
the	O
3d	O
space	O
points	O
.	O
thus	O
,	O
denote	O
by	O
τ	O
a	O
triangulation	B
method	O
used	O
to	O
compute	O
a	O
3d	O
space	O
point	O
x	O
from	O
a	O
point	B
correspondence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
and	O
a	O
pair	O
of	B
camera	I
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
.	O
we	O
write	O
)	O
.	O
x	O
=	O
τ	O
(	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
,	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
the	O
triangulation	B
is	O
said	O
to	O
be	O
invariant	O
under	O
a	O
transformation	B
h	O
if	O
τ	O
(	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
,	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
=h	O
−1τ	O
(	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
,	O
ph−1	O
,	O
p	O
(	O
cid:2	O
)	O
h−1	O
)	O
.	O
this	O
means	O
that	O
triangulation	B
using	O
the	O
transformed	O
cameras	B
results	O
in	O
the	O
transformed	O
point	B
.	O
it	O
is	O
clear	O
,	O
particularly	O
for	O
projective	O
reconstruction	B
,	O
that	O
it	O
is	O
inappropriate	O
to	O
min-	O
imize	O
errors	O
in	O
the	O
3d	O
projective	B
space	O
,	O
ip3	O
.	O
for	O
instance	O
,	O
the	O
method	O
that	O
ﬁnds	O
the	O
midpoint	O
of	O
the	O
common	O
perpendicular	O
to	O
the	O
two	O
rays	O
in	O
space	O
is	O
not	O
suitable	O
for	O
projective	O
reconstruction	B
,	O
since	O
concepts	O
such	O
as	O
distance	O
and	O
perpendicularity	O
are	O
not	O
valid	O
in	O
the	O
context	O
of	O
projective	O
geometry	O
.	O
in	O
fact	O
,	O
in	O
projective	O
reconstruction	O
,	O
this	O
method	O
will	O
give	O
different	O
results	O
depending	O
on	O
which	O
particular	O
projective	B
reconstruc-	O
tion	O
is	O
considered	O
–	O
the	O
method	O
is	O
not	O
projective-invariant	O
.	O
here	O
we	O
will	O
give	O
a	O
triangulation	B
method	O
that	O
is	O
projective-invariant	O
.	O
the	O
key	O
idea	O
312	O
projects	O
as	O
ˆx	O
=	O
p	O
(	O
cid:23	O
)	O
x	O
ˆx	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
(	O
cid:23	O
)	O
x	O
12	O
structure	B
computation	O
is	O
to	O
estimate	O
a	O
3d	O
point	B
(	O
cid:23	O
)	O
x	O
which	O
exactly	O
satisﬁes	O
the	O
supplied	O
camera	B
geometry	O
,	O
so	O
it	O
and	O
the	O
aim	O
is	O
to	O
estimate	O
(	O
cid:23	O
)	O
x	O
from	O
the	O
image	O
measurements	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
the	O
point	B
(	O
cid:23	O
)	O
x	O
which	O
minimizes	O
the	O
reprojection	B
error	I
–	O
the	O
(	O
summed	O
squared	O
)	O
distances	O
between	O
the	O
projections	O
of	O
(	O
cid:23	O
)	O
x	O
and	O
the	O
measured	O
image	O
points	O
.	O
which	O
are	O
the	O
projections	O
of	O
(	O
cid:23	O
)	O
x	O
do	O
not	O
depend	O
on	O
the	O
projective	B
frame	O
in	O
which	O
(	O
cid:23	O
)	O
x	O
is	O
deﬁned	O
,	O
i.e	O
.	O
a	O
different	O
projective	B
reconstruction	I
will	O
minimized	O
,	O
and	O
the	O
points	O
ˆx	O
and	O
ˆx	O
(	O
cid:2	O
)	O
.	O
as	O
described	O
in	O
section	O
12.3	O
the	O
maximum	O
likelihood	O
estimate	O
,	O
under	O
gaussian	O
noise	B
,	O
is	O
given	O
by	O
such	O
a	O
triangulation	B
method	O
is	O
projective-invariant	O
because	O
only	O
image	O
distances	O
are	O
project	O
to	O
the	O
same	O
points	O
.	O
in	O
the	O
following	O
sections	O
simple	O
linear	O
triangulation	B
methods	O
are	O
given	O
.	O
then	O
the	O
mle	O
is	O
deﬁned	O
,	O
and	O
it	O
is	O
shown	O
that	O
an	O
optimal	O
solution	B
can	O
be	O
obtained	O
via	O
the	O
root	O
of	O
a	O
sixth-degree	O
polynomial	O
,	O
thus	O
avoiding	O
a	O
non-linear	B
minimization	O
of	O
a	O
cost	O
function	O
.	O
12.2	O
linear	B
triangulation	O
methods	O
in	O
this	O
section	O
,	O
we	O
describe	O
simple	O
linear	O
triangulation	B
methods	O
.	O
as	O
usual	O
the	O
estimated	O
point	B
does	O
not	O
exactly	O
satisfy	O
the	O
geometric	B
relations	O
,	O
and	O
is	O
not	O
an	O
optimal	O
estimate	O
.	O
the	O
linear	B
triangulation	O
method	O
is	O
the	O
direct	O
analogue	O
of	O
the	O
dlt	O
method	O
described	O
in	O
section	O
4.1	O
(	O
p88	O
)	O
.	O
in	O
each	O
image	O
we	O
have	O
a	O
measurement	O
x	O
=	O
px	O
,	O
x	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
,	O
and	O
these	O
equations	O
can	O
be	O
combined	O
into	O
a	O
form	O
ax	O
=	O
0	O
,	O
which	O
is	O
an	O
equation	O
linear	B
in	O
x.	O
first	O
the	O
homogeneous	O
scale	O
factor	O
is	O
eliminated	O
by	O
a	O
cross	B
product	I
to	O
give	O
three	O
equations	O
for	O
each	O
image	O
point	O
,	O
of	O
which	O
two	O
are	O
linearly	O
independent	O
.	O
for	O
example	O
for	O
the	O
ﬁrst	O
image	O
,	O
x	O
×	O
(	O
px	O
)	O
=	O
0	O
and	O
writing	O
this	O
out	O
gives	O
x	O
(	O
p3tx	O
)	O
−	O
(	O
p1tx	O
)	O
=	O
0	O
y	O
(	O
p3tx	O
)	O
−	O
(	O
p2tx	O
)	O
=	O
0	O
x	O
(	O
p2tx	O
)	O
−	O
y	O
(	O
p1tx	O
)	O
=	O
0	O
where	O
pit	O
are	O
the	O
rows	O
of	O
p.	O
these	O
equations	O
are	O
linear	B
in	O
the	O
components	O
of	O
x.	O
an	O
equation	O
of	O
the	O
form	O
ax	O
=	O
0	O
can	O
then	O
be	O
composed	O
,	O
with	O
	O
xp3t	O
−	O
p1t	O
yp3t	O
−	O
p2t	O
(	O
cid:2	O
)	O
p	O
(	O
cid:2	O
)	O
3t	O
−	O
p	O
(	O
cid:2	O
)	O
1t	O
x	O
(	O
cid:2	O
)	O
p	O
(	O
cid:2	O
)	O
3t	O
−	O
p	O
(	O
cid:2	O
)	O
2t	O
y	O
	O
a	O
=	O
where	O
two	O
equations	O
have	O
been	O
included	O
from	O
each	O
image	O
,	O
giving	O
a	O
total	O
of	O
four	O
equa-	O
tions	O
in	O
four	O
homogeneous	O
unknowns	O
.	O
this	O
is	O
a	O
redundant	O
set	O
of	O
equations	O
,	O
since	O
the	O
solution	B
is	O
determined	O
only	O
up	O
to	O
scale	O
.	O
two	O
ways	O
of	O
solving	O
the	O
set	O
of	O
equations	O
of	O
the	O
form	O
ax	O
=	O
0	O
were	O
discussed	O
in	O
section	O
4.1	O
(	O
p88	O
)	O
and	O
will	O
be	O
considered	O
again	O
here	O
.	O
homogeneous	O
method	O
(	O
dlt	O
)	O
.	O
the	O
method	O
of	O
section	O
4.1.1	O
(	O
p90	O
)	O
ﬁnds	O
the	O
solution	B
as	O
the	O
unit	O
singular	O
vector	O
corresponding	O
to	O
the	O
smallest	O
singular	O
value	O
of	O
a	O
,	O
as	O
shown	O
12.3	O
geometric	B
error	I
cost	O
function	O
313	O
in	O
section	O
a5.3	O
(	O
p592	O
)	O
.	O
the	O
discussion	O
in	O
section	O
4.1.1	O
on	O
the	O
merits	O
of	O
normalization	O
,	O
and	O
of	O
including	O
two	O
or	O
three	O
equations	O
from	O
each	O
image	O
,	O
applies	O
equally	O
well	O
here	O
.	O
inhomogeneous	B
method	I
.	O
in	O
section	O
4.1.2	O
(	O
p90	O
)	O
the	O
solution	B
of	O
this	O
system	O
as	O
a	O
set	O
of	O
inhomogeneous	O
equations	O
is	O
discussed	O
.	O
by	O
setting	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
the	O
set	O
of	O
homogeneous	O
equations	O
,	O
ax	O
=	O
0	O
,	O
is	O
reduced	B
to	O
a	O
set	O
of	O
four	O
inhomogeneous	O
equations	O
in	O
three	O
unknowns	O
.	O
the	O
least-squares	B
solution	I
to	O
these	O
inhomogeneous	O
equations	O
is	O
described	O
in	O
section	O
a5.1	O
(	O
p588	O
)	O
.	O
as	O
explained	O
in	O
section	O
4.1.2	O
,	O
however	O
,	O
difﬁculties	O
arise	O
if	O
the	O
true	O
solution	B
x	O
has	O
last	O
coordinate	O
equal	O
or	O
close	O
to	O
0.	O
in	O
this	O
case	O
,	O
it	O
is	O
not	O
legitimate	O
to	O
set	O
it	O
to	O
1	O
and	O
instabilities	O
can	O
occur	O
.	O
discussion	O
.	O
these	O
two	O
methods	O
are	O
quite	O
similar	O
,	O
but	O
in	O
fact	O
have	O
quite	O
different	O
prop-	O
erties	O
in	O
the	O
presence	O
of	O
noise	O
.	O
the	O
inhomogeneous	B
method	I
assumes	O
that	O
the	O
solution	B
point	O
x	O
is	O
not	O
at	B
inﬁnity	I
,	O
for	O
otherwise	O
we	O
could	O
not	O
assume	O
that	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t.	O
this	O
is	O
a	O
disadvantage	O
of	O
this	O
method	O
when	O
we	O
are	O
seeking	O
to	O
carry	O
out	O
a	O
projective	B
re-	O
construction	O
,	O
where	O
reconstructed	O
points	O
may	O
lie	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
furthermore	O
,	O
neither	O
of	O
these	O
two	O
linear	O
methods	O
is	O
quite	O
suitable	O
for	O
projective	O
reconstruction	B
,	O
since	O
they	O
are	O
not	O
projective-invariant	O
.	O
to	O
see	O
this	O
,	O
suppose	O
that	O
camera	B
matrices	I
p	O
and	O
p	O
(	O
cid:2	O
)	O
are	O
replaced	O
by	O
ph−1	O
and	O
p	O
(	O
cid:2	O
)	O
h−1	O
.	O
one	O
sees	O
that	O
in	O
this	O
case	O
the	O
matrix	B
of	O
equations	O
,	O
a	O
,	O
becomes	O
ah−1	O
.	O
a	O
point	B
x	O
such	O
that	O
ax	O
=	O
	O
for	O
the	O
original	O
problem	O
corresponds	O
to	O
a	O
point	B
hx	O
satisfying	O
(	O
ah−1	O
)	O
(	O
hx	O
)	O
=	O
	O
for	O
the	O
transformed	O
problem	O
.	O
thus	O
,	O
there	O
is	O
a	O
one-to-one	O
correspondence	B
between	O
points	O
x	O
and	O
hx	O
giving	O
the	O
same	O
error	O
.	O
how-	O
ever	O
,	O
neither	O
the	O
condition	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1	O
for	O
the	O
homogeneous	O
method	O
,	O
nor	O
the	O
condition	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
for	O
the	O
inhomogeneous	B
method	I
,	O
is	O
invariant	O
under	O
application	O
of	O
the	O
projective	B
transformation	I
h.	O
thus	O
,	O
in	O
general	O
the	O
point	B
x	O
solving	B
the	O
original	O
problem	O
will	O
not	O
correspond	O
to	O
a	O
solution	B
hx	O
for	O
the	O
transformed	O
problem	O
.	O
for	O
afﬁne	O
transformations	O
,	O
on	O
the	O
other	O
hand	O
,	O
the	O
situation	O
is	O
different	O
.	O
in	O
fact	O
,	O
al-	O
though	O
the	O
condition	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1	O
is	O
not	O
preserved	O
under	O
afﬁne	B
transformations	O
,	O
the	O
condi-	O
tion	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
is	O
preserved	O
,	O
since	O
for	O
an	O
afﬁne	B
transformation	I
,	O
h	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
=	O
,	O
1	O
)	O
t.	O
this	O
means	O
that	O
there	O
is	O
a	O
one-to-one	O
correspondence	B
between	O
a	O
vector	O
(	O
x	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
such	O
that	O
a	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
=	O
	O
and	O
the	O
vector	O
hx	O
=	O
(	O
x	O
,	O
1	O
)	O
t	O
such	O
that	O
(	O
ah−1	O
)	O
(	O
x	O
,	O
1	O
)	O
t	O
=	O
	O
.	O
the	O
error	B
is	O
the	O
same	O
for	O
corresponding	O
points	O
.	O
thus	O
,	O
the	O
points	O
that	O
minimize	O
the	O
error	B
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
correspond	O
as	O
well	O
.	O
hence	O
,	O
the	O
inhomogeneous	B
method	I
is	O
afﬁne-invariant	O
,	O
whereas	O
the	O
homogeneous	O
method	O
is	O
not	O
.	O
,	O
y	O
,	O
y	O
,	O
y	O
,	O
z	O
,	O
z	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
z	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
in	O
the	O
remainder	O
of	O
this	O
chapter	O
we	O
will	O
describe	O
a	O
method	O
for	O
triangulation	O
that	O
is	O
invariant	O
to	O
the	O
projective	B
frame	O
of	O
the	O
cameras	O
,	O
and	O
minimizes	O
a	O
geometric	B
image	O
error	B
.	O
this	O
will	O
be	O
the	O
recommended	O
triangulation	O
method	O
.	O
nevertheless	O
,	O
the	O
homogeneous	O
linear	O
method	O
described	O
above	O
often	O
provides	O
acceptable	O
results	O
.	O
furthermore	O
,	O
it	O
has	O
the	O
virtue	O
that	O
it	O
generalizes	O
easily	O
to	O
triangulation	O
when	O
more	O
than	O
two	B
views	I
of	O
the	O
point	B
are	O
available	O
.	O
12.3	O
geometric	B
error	I
cost	O
function	O
a	O
typical	O
observation	O
consists	O
of	O
a	O
noisy	O
point	B
correspondence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
which	O
does	O
not	O
in	O
general	O
satisfy	O
the	O
epipolar	B
constraint	O
.	O
in	O
reality	O
,	O
the	O
correct	O
values	O
of	O
the	O
cor-	O
314	O
12	O
structure	B
computation	O
x	O
x	O
x	O
d	O
x	O
/	O
/	O
d	O
/x	O
c	O
e	O
e	O
/	O
/	O
c	O
satisfy	O
the	O
epipolar	B
constraint	O
,	O
unlike	O
the	O
measured	O
points	O
.	O
the	O
corresponding	O
image	O
points	O
ˆx	O
,	O
ˆx	O
(	O
cid:1	O
)	O
fig	O
.	O
12.2.	O
minimization	B
of	O
geometric	B
error	I
.	O
the	O
estimated	O
3-space	O
point	B
(	O
cid:23	O
)	O
x	O
projects	O
to	O
the	O
two	O
images	O
.	O
the	O
point	B
(	O
cid:23	O
)	O
x	O
is	O
chosen	O
so	O
that	O
the	O
reprojection	B
error	I
d2	O
+	O
d	O
at	O
ˆx	O
,	O
ˆx	O
(	O
cid:1	O
)	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
responding	O
image	O
points	O
should	O
be	O
points	O
¯x	O
↔	O
¯x	O
(	O
cid:2	O
)	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
we	O
seek	O
the	O
points	O
ˆx	O
and	O
ˆx	O
(	O
cid:2	O
)	O
subject	O
to	O
ˆx	O
(	O
cid:2	O
)	O
tfˆx	O
=	O
0	O
(	O
12.1	O
)	O
mizing	O
the	O
reprojection	B
error	I
for	O
a	O
point	B
(	O
cid:23	O
)	O
x	O
which	O
is	O
mapped	O
to	O
ˆx	O
and	O
ˆx	O
(	O
cid:2	O
)	O
where	O
d	O
(	O
∗	O
,	O
∗	O
)	O
is	O
the	O
euclidean	O
distance	O
between	O
the	O
points	O
.	O
this	O
is	O
equivalent	B
to	O
mini-	O
by	O
projection	B
and	O
satisfying	O
the	O
epipolar	B
constraint	O
¯x	O
(	O
cid:2	O
)	O
tf¯x	O
=	O
0	O
exactly	O
.	O
lying	O
close	O
to	O
the	O
measured	O
points	O
that	O
minimize	O
the	O
function	O
(	O
cid:1	O
)	O
2	O
is	O
minimized	O
.	O
c	O
(	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
)	O
=	O
d	O
(	O
x	O
,	O
ˆx	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
,	O
ˆx	O
(	O
cid:2	O
)	O
)	O
2	O
matrices	O
consistent	O
with	O
f	O
,	O
as	O
illustrated	O
in	O
ﬁgure	O
12.2	O
.	O
ˆx	O
(	O
cid:2	O
)	O
spondences	O
.	O
once	O
ˆx	O
(	O
cid:2	O
)	O
method	O
,	O
since	O
the	O
corresponding	O
rays	O
will	O
meet	O
precisely	O
in	O
space	O
.	O
as	O
explained	O
in	O
section	O
4.3	O
(	O
p102	O
)	O
,	O
assuming	O
a	O
gaussian	O
error	B
distribution	O
,	O
the	O
points	O
and	O
ˆx	O
are	O
maximum	O
likelihood	O
estimates	O
(	O
mle	O
)	O
for	O
the	O
true	O
image	O
point	O
corre-	O
and	O
ˆx	O
are	O
found	O
,	O
the	O
point	B
(	O
cid:23	O
)	O
x	O
may	O
be	O
found	O
by	O
any	O
triangulation	B
this	O
cost	B
function	I
could	O
,	O
of	O
course	O
,	O
be	O
minimized	O
using	O
a	O
numerical	O
minimization	B
method	O
such	O
as	O
levenberg–marquardt	O
(	O
section	O
a6.2	O
(	O
p600	O
)	O
)	O
.	O
a	O
close	O
approximation	O
to	O
the	O
minimum	O
may	O
also	O
be	O
found	O
using	O
a	O
ﬁrst-order	O
approximation	O
to	O
the	O
geometric	B
cost	O
function	O
,	O
namely	O
the	O
sampson	O
error	B
,	O
as	O
described	O
in	O
the	O
next	O
section	O
.	O
however	O
,	O
in	O
section	O
12.5	O
it	O
is	O
shown	O
that	O
the	O
minimum	O
can	O
be	O
obtained	O
non-iteratively	O
by	O
the	O
solution	B
of	O
a	O
sixth-degree	O
polynomial	O
.	O
12.4	O
sampson	O
approximation	O
(	O
ﬁrst-order	O
geometric	B
correction	O
)	O
before	O
deriving	O
the	O
exact	O
polynomial	O
solution	B
we	O
develop	O
the	O
sampson	O
approxima-	O
tion	O
,	O
which	O
is	O
valid	O
when	O
the	O
measurement	O
errors	O
are	O
small	O
compared	O
with	O
the	O
mea-	O
surements	O
.	O
the	O
sampson	O
approximation	O
to	O
the	O
geometric	B
cost	O
function	O
in	O
the	O
case	O
of	O
the	O
fundamental	O
matrix	B
has	O
already	O
been	O
discussed	O
in	O
section	O
11.4.3.	O
here	O
we	O
are	O
concerned	O
with	O
computing	O
the	O
correction	B
to	O
the	O
measured	O
points	O
.	O
the	O
sampson	O
correction	B
δx	O
to	O
the	O
measured	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
x	O
)	O
t	O
(	O
note	O
,	O
in	O
this	O
section	O
x	O
does	O
not	O
denote	O
a	O
homogeneous	O
3-space	O
point	B
)	O
is	O
shown	O
in	O
section	O
4.2.6	O
(	O
p98	O
)	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
12.5	O
an	O
optimal	O
solution	B
315	O
l	O
=	O
f	O
/x	O
x	O
d	O
x	O
/	O
d	O
/	O
x	O
/x	O
/l	O
=	O
f	O
x	O
θ	O
(	O
t	O
)	O
e	O
e	O
/	O
(	O
t	O
)	O
θ/	O
image	O
1	O
of	O
an	O
estimated	O
3d	O
point	B
(	O
cid:23	O
)	O
x	O
lie	O
on	O
a	O
pair	O
of	O
corresponding	O
epipolar	B
(	O
cid:23	O
)	O
x	O
is	O
reduced	B
to	O
a	O
one-parameter	O
search	O
for	O
corresponding	O
epipolar	B
lines	I
so	O
as	O
to	O
minimize	O
the	O
squared	O
fig	O
.	O
12.3.	O
the	O
projections	O
ˆx	O
and	O
ˆx	O
(	O
cid:1	O
)	O
lines	B
.	O
the	O
optimal	O
ˆx	O
and	O
ˆx	O
(	O
cid:1	O
)	O
will	O
lie	O
at	O
the	O
foot	O
of	O
the	O
perpendiculars	O
from	O
the	O
measured	O
points	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
.	O
parametrizing	O
the	O
corresponding	O
epipolar	B
lines	I
as	O
a	O
one-parameter	O
family	O
,	O
the	O
optimal	O
estimation	B
of	I
image	O
2	O
sum	O
of	O
perpendicular	O
distances	O
d2	O
+	O
d	O
(	O
cid:1	O
)	O
2.	O
to	O
be	O
(	O
4.11–p99	O
)	O
δx	O
=	O
−jt	O
(	O
jjt	O
)	O
−1	O
and	O
the	O
corrected	O
point	B
is	O
(	O
cid:23	O
)	O
x	O
=	O
x	O
+	O
δx	O
=	O
x	O
−	O
jt	O
(	O
jjt	O
)	O
−1	O
.	O
as	O
shown	O
in	O
section	O
11.4.3	O
in	O
the	O
case	O
of	O
the	O
variety	O
deﬁned	O
by	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
,	O
the	O
error	B
	O
=	O
x	O
(	O
cid:2	O
)	O
tfx	O
,	O
and	O
the	O
jacobian	O
is	O
j	O
=	O
∂/∂x	O
=	O
[	O
(	O
ftx	O
(	O
cid:2	O
)	O
)	O
1	O
,	O
(	O
ftx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
+f31	O
,	O
etc	O
.	O
then	O
the	O
ﬁrst-order	O
approximation	O
+f21y	O
)	O
2	O
,	O
(	O
fx	O
)	O
1	O
,	O
(	O
fx	O
)	O
2	O
]	O
)	O
1	O
=	O
f11x	O
(	O
cid:2	O
)	O
where	O
for	O
instance	O
(	O
ftx	O
(	O
cid:2	O
)	O
to	O
the	O
corrected	O
point	B
is	O
simply	O
	O
ˆx	O
ˆy	O
(	O
cid:2	O
)	O
ˆx	O
(	O
cid:2	O
)	O
ˆy	O
	O
=	O
	O
x	O
y	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
y	O
	O
−	O
x	O
(	O
cid:2	O
)	O
tfx	O
2	O
+	O
(	O
ftx	O
(	O
cid:2	O
)	O
)	O
2	O
1	O
+	O
(	O
ftx	O
(	O
cid:2	O
)	O
)	O
2	O
2	O
(	O
fx	O
)	O
2	O
1	O
+	O
(	O
fx	O
)	O
2	O
	O
.	O
	O
(	O
ftx	O
(	O
cid:2	O
)	O
(	O
ftx	O
(	O
cid:2	O
)	O
(	O
fx	O
)	O
1	O
(	O
fx	O
)	O
2	O
)	O
1	O
)	O
2	O
the	O
approximation	O
is	O
accurate	O
if	O
the	O
correction	B
in	O
each	O
image	O
is	O
small	O
(	O
less	O
than	O
a	O
pixel	O
)	O
,	O
and	O
is	O
cheap	O
to	O
compute	O
.	O
note	O
,	O
however	O
,	O
that	O
the	O
corrected	O
points	O
will	O
not	O
satisfy	O
the	O
epipolar	B
relation	O
ˆx	O
(	O
cid:2	O
)	O
tfˆx	O
=	O
0	O
exactly	O
.	O
the	O
method	O
of	O
the	O
following	O
section	O
computes	O
the	O
points	O
ˆx	O
,	O
ˆx	O
(	O
cid:2	O
)	O
which	O
do	O
exactly	O
satisfy	O
the	O
epipolar	B
constraint	O
,	O
but	O
is	O
more	O
costly	O
.	O
12.5	O
an	O
optimal	O
solution	B
in	O
this	O
section	O
,	O
we	O
describe	O
a	O
method	O
of	B
triangulation	I
that	O
ﬁnds	O
the	O
global	O
minimum	O
of	O
the	O
cost	O
function	O
(	O
12.1	O
)	O
using	O
a	O
non-iterative	O
algorithm	B
.	O
if	O
the	O
gaussian	O
noise	B
model	O
can	O
be	O
assumed	O
to	O
be	O
correct	O
,	O
this	O
triangulation	B
method	O
is	O
then	O
provably	O
optimal	O
.	O
12.5.1	O
reformulation	O
of	O
the	O
minimization	O
problem	O
given	O
a	O
measured	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
and	O
ˆx	O
that	O
mini-	O
mize	O
the	O
sum	O
of	O
squared	O
distances	O
(	O
12.1	O
)	O
subject	O
to	O
the	O
epipolar	B
constraint	O
ˆx	O
(	O
cid:2	O
)	O
tfˆx	O
=	O
0.	O
the	O
following	O
discussion	O
relates	O
to	O
ﬁgure	O
12.3.	O
any	O
pair	O
of	B
points	I
satisfying	O
the	O
,	O
we	O
seek	O
a	O
pair	O
of	B
points	I
ˆx	O
(	O
cid:2	O
)	O
316	O
12	O
structure	B
computation	O
epipolar	B
constraint	O
must	O
lie	O
on	O
a	O
pair	O
of	O
corresponding	O
epipolar	B
lines	I
in	O
the	O
two	O
images	O
.	O
thus	O
,	O
in	O
particular	O
,	O
the	O
optimum	O
point	B
ˆx	O
lies	O
on	O
an	O
epipolar	B
line	I
l	O
and	O
ˆx	O
(	O
cid:2	O
)	O
lies	O
on	O
the	O
corresponding	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
.	O
on	O
the	O
other	O
hand	O
,	O
any	O
other	O
pair	O
of	B
points	I
lying	O
on	O
the	O
lines	B
l	O
and	O
l	O
(	O
cid:2	O
)	O
will	O
also	O
satisfy	O
the	O
epipolar	B
constraint	O
.	O
this	O
is	O
true	O
in	O
particular	O
for	O
the	O
point	B
x⊥	O
on	O
l	O
lying	O
closest	O
to	O
the	O
measured	O
point	B
x	O
,	O
and	O
the	O
correspondingly	O
deﬁned	O
.	O
of	O
all	O
pairs	O
of	B
points	I
on	O
the	O
lines	B
l	O
and	O
l	O
(	O
cid:2	O
)	O
⊥	O
on	O
l	O
(	O
cid:2	O
)	O
point	B
x	O
(	O
cid:2	O
)	O
⊥	O
minimize	O
the	O
squared	O
distance	O
sum	O
of	O
(	O
12.1	O
)	O
.	O
it	O
follows	O
that	O
ˆx	O
(	O
cid:2	O
)	O
⊥	O
and	O
ˆx	O
=	O
x⊥	O
,	O
where	O
x⊥	O
and	O
⊥	O
are	O
deﬁned	O
with	O
respect	O
to	O
a	O
pair	O
of	O
matching	O
epipolar	B
lines	I
l	O
and	O
l	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
.	O
consequently	O
,	O
we	O
may	O
write	O
d	O
(	O
x	O
,	O
ˆx	O
)	O
=d	O
(	O
x	O
,	O
l	O
)	O
,	O
where	O
d	O
(	O
x	O
,	O
l	O
)	O
represents	O
the	O
perpendicular	O
distance	B
from	O
the	O
point	B
x	O
to	O
the	O
line	B
l.	O
a	O
similar	O
expression	O
holds	O
for	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
,	O
the	O
points	O
x⊥	O
and	O
x	O
(	O
cid:2	O
)	O
=	O
x	O
(	O
cid:2	O
)	O
,	O
ˆx	O
(	O
cid:2	O
)	O
)	O
.	O
in	O
view	O
of	O
the	O
previous	O
paragraph	O
,	O
we	O
may	O
formulate	O
the	O
minimization	B
problem	O
dif-	O
ferently	O
as	O
follows	O
.	O
we	O
seek	O
to	O
minimize	O
d	O
(	O
x	O
,	O
l	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
,	O
l	O
(	O
cid:2	O
)	O
)	O
2	O
(	O
12.2	O
)	O
where	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
then	O
the	O
closest	O
point	B
on	O
the	O
line	B
l	O
to	O
the	O
point	B
x	O
and	O
the	O
point	B
ˆx	O
(	O
cid:2	O
)	O
range	O
over	O
all	O
choices	O
of	O
corresponding	O
epipolar	B
lines	I
.	O
the	O
point	B
ˆx	O
is	O
is	O
similarly	O
deﬁned	O
.	O
our	O
strategy	O
for	O
minimizing	O
(	O
12.2	O
)	O
is	O
as	O
follows	O
:	O
an	O
epipolar	B
line	I
in	O
the	O
ﬁrst	O
image	O
may	O
be	O
written	O
as	O
l	O
(	O
t	O
)	O
.	O
(	O
i	O
)	O
parametrize	O
the	O
pencil	O
of	B
epipolar	I
lines	I
in	O
the	O
ﬁrst	O
image	O
by	O
a	O
parameter	O
t.	O
thus	O
(	O
ii	O
)	O
using	O
the	O
fundamental	B
matrix	I
f	O
,	O
compute	O
the	O
corresponding	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
(	O
iii	O
)	O
express	O
the	O
distance	B
function	O
d	O
(	O
x	O
,	O
l	O
(	O
t	O
)	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
t	O
)	O
)	O
2	O
explicitly	O
as	O
a	O
function	O
in	O
the	O
second	O
image	O
.	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
t	O
)	O
of	O
t.	O
(	O
iv	O
)	O
find	O
the	O
value	O
of	O
t	O
that	O
minimizes	O
this	O
function	O
.	O
in	O
this	O
way	O
,	O
the	O
problem	O
is	O
reduced	B
to	O
that	O
of	O
ﬁnding	O
the	O
minimum	O
of	O
a	O
function	O
of	O
a	O
single	O
variable	O
t	O
,	O
i.e	O
.	O
min	O
(	O
cid:23	O
)	O
x	O
c	O
=	O
d	O
(	O
x	O
,	O
ˆx	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
,	O
ˆx	O
(	O
cid:2	O
)	O
)	O
2	O
=	O
min	O
t	O
c	O
=	O
d	O
(	O
x	O
,	O
l	O
(	O
t	O
)	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
t	O
)	O
)	O
2.	O
it	O
will	O
be	O
seen	O
that	O
for	O
a	O
suitable	O
parametrization	B
of	I
the	O
pencil	O
of	B
epipolar	I
lines	I
the	O
distance	B
function	O
is	O
a	O
rational	O
polynomial	O
function	O
of	O
t.	O
using	O
techniques	O
of	O
elementary	O
calculus	O
,	O
the	O
minimization	B
problem	O
reduces	O
to	O
ﬁnding	O
the	O
real	O
roots	O
of	O
a	O
polynomial	O
of	O
degree	O
6	O
.	O
12.5.2	O
details	O
of	O
the	O
minimization	O
if	O
both	O
of	O
the	O
image	O
points	O
correspond	O
with	O
the	O
epipoles	B
,	O
then	O
the	O
point	B
in	O
space	O
lies	O
on	O
the	O
line	B
joining	O
the	O
camera	B
centres	O
.	O
in	O
this	O
case	O
it	O
is	O
impossible	O
to	O
determine	O
the	O
position	O
of	O
the	O
point	O
in	O
space	O
.	O
if	O
only	O
one	O
of	O
the	O
corresponding	O
points	O
lies	O
at	O
an	O
epipole	O
,	O
then	O
we	O
conclude	O
that	O
the	O
point	B
in	O
space	O
must	O
coincide	O
with	O
the	O
other	O
camera	B
centre	I
.	O
consequently	O
,	O
we	O
assume	O
that	O
neither	O
of	O
the	O
two	O
image	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
corresponds	O
with	O
an	O
epipole	O
.	O
image	O
in	O
order	O
to	O
place	O
both	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
in	O
this	O
case	O
,	O
we	O
may	O
simplify	O
the	O
analysis	O
by	O
applying	O
a	O
rigid	O
transformation	B
to	O
each	O
at	O
the	O
origin	O
,	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
in	O
homogeneous	O
(	O
cid:2	O
)	O
12.5	O
an	O
optimal	O
solution	B
317	O
coordinates	B
.	O
furthermore	O
,	O
the	O
epipoles	B
may	O
be	O
placed	O
on	O
the	O
x-axis	O
at	O
points	O
(	O
1	O
,	O
0	O
,	O
f	O
)	O
t	O
)	O
t	O
respectively	O
.	O
a	O
value	O
f	O
equal	O
to	O
0	O
means	O
that	O
the	O
epipole	O
is	O
at	O
inﬁn-	O
and	O
(	O
1	O
,	O
0	O
,	O
f	O
ity	O
.	O
applying	O
these	O
two	O
rigid	O
transforms	O
has	O
no	O
effect	O
on	O
the	O
sum-of-squares	O
distance	B
function	O
in	O
(	O
12.1	O
)	O
,	O
and	O
hence	O
does	O
not	O
change	O
the	O
minimization	B
problem	O
.	O
thus	O
,	O
in	O
future	O
we	O
assume	O
that	O
in	O
homogeneous	O
coordinates	B
,	O
x	O
=	O
x	O
(	O
cid:2	O
)	O
and	O
that	O
the	O
two	O
epipoles	O
are	O
at	O
points	O
(	O
1	O
,	O
0	O
,	O
f	O
)	O
t	O
and	O
(	O
1	O
,	O
0	O
,	O
f	O
f	O
(	O
1	O
,	O
0	O
,	O
f	O
)	O
t	O
=	O
(	O
1	O
,	O
0	O
,	O
f	O
)	O
f	O
=	O
0	O
,	O
the	O
fundamental	B
matrix	I
has	O
a	O
special	O
form	O
(	O
cid:2	O
)	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
)	O
t.	O
in	O
this	O
case	O
,	O
since	O
(	O
cid:2	O
)	O
	O
f	O
f	O
(	O
cid:2	O
)	O
−f	O
b	O
−f	O
d	O
d	O
−f	O
(	O
cid:2	O
)	O
c	O
−f	O
a	O
c	O
(	O
cid:2	O
)	O
d	O
b	O
d	O
	O
.	O
f	O
=	O
(	O
12.3	O
)	O
consider	O
an	O
epipolar	B
line	I
in	O
the	O
ﬁrst	O
image	O
passing	O
through	O
the	O
point	B
(	O
0	O
,	O
t,1	O
)	O
t	O
(	O
still	O
in	O
homogeneous	O
coordinates	B
)	O
and	O
the	O
epipole	O
(	O
1	O
,	O
0	O
,	O
f	O
)	O
t.	O
we	O
denote	O
this	O
epipolar	B
line	I
by	O
l	O
(	O
t	O
)	O
.	O
the	O
vector	O
representing	O
this	O
line	B
is	O
given	O
by	O
the	O
cross	B
product	I
(	O
0	O
,	O
t,1	O
)	O
×	O
(	O
1	O
,	O
0	O
,	O
f	O
)	O
=	O
(	O
tf	O
,	O
1	O
,	O
−t	O
)	O
,	O
so	O
the	O
squared	O
distance	O
from	O
the	O
line	B
to	O
the	O
origin	O
is	O
d	O
(	O
x	O
,	O
l	O
(	O
t	O
)	O
)	O
2	O
=	O
t2	O
1	O
+	O
(	O
tf	O
)	O
2	O
.	O
using	O
the	O
fundamental	B
matrix	I
to	O
ﬁnd	O
the	O
corresponding	O
epipolar	B
line	I
in	O
the	O
other	O
image	O
,	O
we	O
see	O
that	O
l	O
(	O
cid:2	O
)	O
(	O
t	O
)	O
=f	O
(	O
0	O
,	O
t,1	O
)	O
t	O
=	O
(	O
−f	O
(	O
cid:2	O
)	O
(	O
ct	O
+	O
d	O
)	O
,	O
at	O
+	O
b	O
,	O
ct	O
+	O
d	O
)	O
t.	O
(	O
12.4	O
)	O
this	O
is	O
the	O
representation	B
of	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
tance	O
of	O
this	O
line	B
from	O
the	O
origin	O
is	O
equal	O
to	O
(	O
t	O
)	O
as	O
a	O
homogeneous	O
vector	O
.	O
the	O
squared	O
dis-	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
t	O
)	O
)	O
2	O
=	O
(	O
ct	O
+	O
d	O
)	O
2	O
(	O
at	O
+	O
b	O
)	O
2	O
+	O
f	O
(	O
cid:2	O
)	O
2	O
(	O
ct	O
+	O
d	O
)	O
2	O
.	O
the	O
total	O
squared	O
distance	B
is	O
therefore	O
given	O
by	O
s	O
(	O
t	O
)	O
=	O
t2	O
1	O
+	O
f	O
2t2	O
+	O
(	O
ct	O
+	O
d	O
)	O
2	O
(	O
at	O
+	O
b	O
)	O
2	O
+	O
f	O
(	O
cid:2	O
)	O
2	O
(	O
ct	O
+	O
d	O
)	O
2	O
.	O
(	O
12.5	O
)	O
our	O
task	O
is	O
to	O
ﬁnd	O
the	O
minimum	O
of	O
this	O
function	O
.	O
we	O
may	O
ﬁnd	O
the	O
minimum	O
using	O
techniques	O
of	O
elementary	O
calculus	O
,	O
as	O
follows	O
.	O
we	O
compute	O
the	O
derivative	O
(	O
cid:2	O
)	O
s	O
(	O
t	O
)	O
=	O
2t	O
(	O
1	O
+	O
f	O
2t2	O
)	O
2	O
−	O
2	O
(	O
ad	O
−	O
bc	O
)	O
(	O
at	O
+	O
b	O
)	O
(	O
ct	O
+	O
d	O
)	O
(	O
(	O
at	O
+	O
b	O
)	O
2	O
+	O
f	O
(	O
cid:2	O
)	O
2	O
(	O
ct	O
+	O
d	O
)	O
2	O
)	O
2	O
.	O
(	O
12.6	O
)	O
(	O
cid:2	O
)	O
maxima	O
and	O
minima	O
of	O
s	O
(	O
t	O
)	O
will	O
occur	O
when	O
s	O
(	O
cid:2	O
)	O
s	O
(	O
t	O
)	O
over	O
a	O
common	O
denominator	O
and	O
equating	O
the	O
numerator	O
to	O
0	O
gives	O
a	O
condition	O
(	O
t	O
)	O
=	O
0.	O
collecting	O
the	O
two	O
terms	O
in	O
g	O
(	O
t	O
)	O
=t	O
(	O
(	O
at	O
+	O
b	O
)	O
2	O
+	O
f	O
(	O
cid:2	O
)	O
2	O
(	O
ct	O
+	O
d	O
)	O
2	O
)	O
2	O
−	O
(	O
ad	O
−	O
bc	O
)	O
(	O
1	O
+	O
f	O
2t2	O
)	O
2	O
(	O
at	O
+	O
b	O
)	O
(	O
ct	O
+	O
d	O
)	O
=	O
0	O
.	O
(	O
12.7	O
)	O
the	O
minima	O
and	O
maxima	O
of	O
s	O
(	O
t	O
)	O
will	O
occur	O
at	O
the	O
roots	O
of	O
this	O
polynomial	O
.	O
this	O
is	O
a	O
318	O
12	O
structure	B
computation	O
objective	O
given	O
a	O
measured	O
point	B
correspondence	O
x	O
↔	O
x	O
(	O
cid:1	O
)	O
corrected	O
correspondences	B
ˆx	O
↔	O
ˆx	O
(	O
cid:1	O
)	O
epipolar	B
constraint	O
ˆx	O
(	O
cid:1	O
)	O
tfˆx	O
=	O
0.	O
algorithm	B
(	O
cid:17	O
)	O
(	O
i	O
)	O
deﬁne	O
transformation	B
matrices	O
(	O
cid:18	O
)	O
,	O
and	O
a	O
fundamental	B
matrix	I
f	O
,	O
compute	O
the	O
that	O
minimize	O
the	O
geometric	B
error	I
(	O
12.1	O
)	O
subject	O
to	O
the	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
.	O
(	O
cid:1	O
)	O
(	O
cid:18	O
)	O
1	O
1	O
−x	O
(	O
cid:1	O
)	O
1	O
−y	O
(	O
cid:1	O
)	O
1	O
these	O
are	O
the	O
translations	O
that	O
take	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
1	O
)	O
t	O
and	O
x	O
(	O
cid:1	O
)	O
=	O
(	O
x	O
(	O
cid:1	O
)	O
−x	O
1	O
−y	O
1	O
and	O
t	O
(	O
cid:1	O
)	O
t	O
=	O
=	O
1	O
,	O
y	O
(	O
ii	O
)	O
replace	O
f	O
by	O
t	O
(	O
cid:1	O
)	O
−tft−1	O
.	O
the	O
new	O
f	O
corresponds	O
to	O
translated	O
coordinates	B
.	O
(	O
iii	O
)	O
compute	O
the	O
right	O
and	O
left	O
epipoles	B
e	O
=	O
(	O
e1	O
,	O
e2	O
,	O
e3	O
)	O
t	O
and	O
e	O
(	O
cid:1	O
)	O
=	O
(	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
3	O
)	O
t	O
such	O
that	O
2	O
,	O
e	O
1	O
+	O
e2	O
2	O
=	O
1	O
and	O
do	O
,	O
1	O
)	O
t	O
to	O
the	O
origin	O
.	O
(	O
cid:1	O
)	O
1	O
,	O
e	O
e	O
(	O
cid:1	O
)	O
tf	O
=	O
0	O
and	O
fe	O
=	O
0.	O
normalize	O
(	O
multiply	O
by	O
a	O
scale	O
)	O
e	O
such	O
that	O
e2	O
the	O
same	O
to	O
e	O
(	O
cid:1	O
)	O
.	O
(	O
iv	O
)	O
form	O
matrices	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
r	O
=	O
e1	O
−e2	O
e2	O
e1	O
1	O
and	O
r	O
(	O
cid:1	O
)	O
=	O
(	O
cid:1	O
)	O
e	O
−e	O
(	O
cid:1	O
)	O
1	O
2	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
2	O
1	O
e	O
e	O
and	O
observe	O
that	O
r	O
and	O
r	O
(	O
cid:1	O
)	O
r	O
(	O
cid:1	O
)	O
e	O
(	O
cid:1	O
)	O
=	O
(	O
1	O
,	O
0	O
,	O
e	O
(	O
cid:1	O
)	O
3	O
)	O
t.	O
(	O
cid:1	O
)	O
=	O
e	O
(	O
v	O
)	O
replace	O
f	O
by	O
r	O
(	O
cid:1	O
)	O
frt	O
.	O
the	O
resulting	O
f	O
must	O
have	O
the	O
form	O
(	O
12.3	O
)	O
.	O
(	O
cid:1	O
)	O
(	O
vi	O
)	O
set	O
f	O
=	O
e3	O
,	O
f	O
3	O
,	O
a	O
=	O
f22	O
,	O
b	O
=	O
f23	O
,	O
c	O
=	O
f32	O
and	O
d	O
=	O
f33	O
.	O
(	O
vii	O
)	O
form	O
the	O
polynomial	O
g	O
(	O
t	O
)	O
as	O
a	O
polynomial	O
in	O
t	O
according	O
to	O
(	O
12.7	O
)	O
.	O
solve	O
for	O
t	O
to	O
get	O
6	O
are	O
rotation	B
matrices	O
,	O
and	O
re	O
=	O
(	O
1	O
,	O
0	O
,	O
e3	O
)	O
t	O
and	O
roots	O
.	O
(	O
ix	O
)	O
evaluate	O
the	O
two	O
lines	O
l	O
=	O
(	O
tf	O
,	O
1	O
,	O
−t	O
)	O
and	O
l	O
(	O
cid:1	O
)	O
(	O
viii	O
)	O
evaluate	O
the	O
cost	B
function	I
(	O
12.5	O
)	O
at	O
the	O
real	O
part	O
of	O
each	O
of	O
the	O
roots	O
of	O
g	O
(	O
t	O
)	O
(	O
alterna-	O
tively	O
evaluate	O
at	O
only	O
the	O
real	O
roots	O
of	O
g	O
(	O
t	O
)	O
)	O
.	O
also	O
,	O
ﬁnd	O
the	O
asymptotic	O
value	O
of	O
(	O
12.1	O
)	O
for	O
t	O
=	O
∞	O
,	O
namely	O
1/f	O
2	O
+	O
c2/	O
(	O
a2	O
+	O
f	O
(	O
cid:1	O
)	O
2c2	O
)	O
.	O
select	O
the	O
value	O
tmin	O
of	O
t	O
that	O
gives	O
the	O
smallest	O
value	O
of	O
the	O
cost	O
function	O
.	O
given	O
by	O
(	O
12.4	O
)	O
at	O
tmin	O
and	O
ﬁnd	O
ˆx	O
and	O
ˆx	O
(	O
cid:1	O
)	O
as	O
the	O
closest	O
points	O
on	O
these	O
lines	B
to	O
the	O
origin	O
.	O
for	O
a	O
general	O
line	B
(	O
λ	O
,	O
µ	O
,	O
ν	O
)	O
,	O
the	O
formula	O
for	O
the	O
closest	O
point	B
on	O
the	O
line	B
to	O
the	O
origin	O
is	O
(	O
−λν	O
,	O
−µν	O
,	O
λ2	O
+	O
µ2	O
)	O
.	O
(	O
xi	O
)	O
the	O
3-space	O
point	B
(	O
cid:23	O
)	O
x	O
may	O
then	O
be	O
obtained	O
by	O
the	O
homogeneous	O
method	O
of	O
section	O
12.2.	O
t	O
(	O
cid:1	O
)	O
−1r	O
(	O
cid:1	O
)	O
tˆx	O
(	O
cid:1	O
)	O
(	O
x	O
)	O
transfer	B
back	O
to	O
the	O
original	O
coordinates	B
by	O
replacing	O
ˆx	O
by	O
t−1rtˆx	O
and	O
ˆx	O
(	O
cid:1	O
)	O
by	O
.	O
algorithm	B
12.1.	O
the	O
optimal	O
triangulation	B
method	O
.	O
polynomial	O
of	O
degree	O
6	O
,	O
which	O
may	O
have	O
up	O
to	O
6	O
real	O
roots	O
,	O
corresponding	O
to	O
3	O
minima	O
and	O
3	O
maxima	O
of	O
the	O
function	O
s	O
(	O
t	O
)	O
.	O
the	O
absolute	O
minimum	O
of	O
the	O
function	O
s	O
(	O
t	O
)	O
may	O
be	O
found	O
by	O
ﬁnding	O
the	O
roots	O
of	O
g	O
(	O
t	O
)	O
and	O
evaluating	O
the	O
function	O
s	O
(	O
t	O
)	O
given	O
by	O
(	O
12.5	O
)	O
at	O
each	O
of	O
the	O
real	O
roots	O
.	O
more	O
simply	O
,	O
one	O
checks	O
the	O
value	O
of	O
s	O
(	O
t	O
)	O
at	O
the	O
real	O
part	O
of	O
each	O
root	O
(	O
complex	O
or	O
real	O
)	O
of	O
g	O
(	O
t	O
)	O
,	O
which	O
saves	O
the	O
trouble	O
of	O
determining	O
if	O
a	O
root	O
is	O
real	O
or	O
complex	O
.	O
one	O
should	O
also	O
check	O
the	O
asymptotic	O
value	O
of	O
s	O
(	O
t	O
)	O
as	O
t	O
→	O
∞	O
to	O
see	O
if	O
the	O
minimum	O
distance	B
occurs	O
when	O
t	O
=	O
∞	O
,	O
corresponding	O
to	O
an	O
epipolar	B
line	I
f	O
x	O
=	O
1	O
in	O
the	O
ﬁrst	O
image	O
.	O
the	O
overall	O
method	O
is	O
summarized	O
in	O
algorithm	O
12.1	O
.	O
12.5	O
an	O
optimal	O
solution	B
319	O
1.6	O
1.4	O
1.2	O
-1.5	O
-1	O
-0.5	O
0.5	O
1	O
1.5	O
0.8	O
a	O
1.2	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
-1.5	O
-1	O
-0.5	O
0.5	O
1	O
1.5	O
b	O
fig	O
.	O
12.4	O
.	O
(	O
a	O
)	O
example	O
of	O
a	O
cost	O
function	O
with	O
three	O
minima	O
.	O
(	O
b	O
)	O
this	O
is	O
the	O
cost	B
function	I
for	O
a	O
perfect	O
point	B
match	O
,	O
which	O
nevertheless	O
has	O
two	O
minima	O
.	O
12.5.3	O
local	B
minima	I
the	O
fact	O
that	O
g	O
(	O
t	O
)	O
in	O
(	O
12.7	O
)	O
has	O
degree	O
6	O
means	O
that	O
s	O
(	O
t	O
)	O
may	O
have	O
as	O
many	O
as	O
three	O
minima	O
.	O
in	O
fact	O
,	O
this	O
is	O
indeed	O
possible	O
,	O
as	O
the	O
following	O
case	O
shows	O
.	O
setting	O
f	O
=	O
f	O
=	O
1	O
and	O
(	O
cid:2	O
)	O
	O
4	O
−3	O
−4	O
	O
2	O
3	O
3	O
4	O
−3	O
−4	O
f	O
=	O
gives	O
a	O
function	O
s	O
(	O
t	O
)	O
=	O
t2	O
1	O
+	O
t2	O
+	O
(	O
3t	O
+	O
4	O
)	O
2	O
(	O
2t	O
+	O
3	O
)	O
2	O
+	O
(	O
3t	O
+	O
4	O
)	O
2	O
with	O
graph	O
as	O
shown	O
in	O
ﬁgure	O
12.4a1	O
.	O
the	O
three	O
minima	O
are	O
clearly	O
shown	O
.	O
as	O
a	O
second	O
example	O
,	O
we	O
consider	O
the	O
case	O
where	O
f	O
=	O
f	O
=	O
1	O
,	O
and	O
(	O
cid:2	O
)	O
	O
0	O
−1	O
1	O
0	O
0	O
2	O
−1	O
0	O
1	O
	O
.	O
f	O
=	O
in	O
this	O
case	O
,	O
the	O
function	O
s	O
(	O
t	O
)	O
is	O
given	O
by	O
s	O
(	O
t	O
)	O
=	O
t2	O
t2	O
+	O
1	O
+	O
t2	O
t2	O
+	O
(	O
2t	O
−	O
1	O
)	O
2	O
and	O
both	O
terms	O
of	O
the	O
cost	O
function	O
vanish	O
for	O
a	O
value	O
of	O
t	O
=	O
0	O
,	O
which	O
means	O
that	O
the	O
corresponding	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
exactly	O
satisfy	O
the	O
epipolar	B
constraint	O
.	O
this	O
can	O
be	O
veriﬁed	O
by	O
observing	O
that	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0.	O
thus	O
the	O
two	O
points	O
are	O
exactly	O
matched	O
.	O
a	O
graph	O
of	O
the	O
cost	O
function	O
s	O
(	O
t	O
)	O
is	O
shown	O
in	O
ﬁgure	O
12.4b	O
.	O
apart	O
from	O
the	O
absolute	O
minimum	O
at	O
t	O
=	O
0	O
there	O
is	O
also	O
a	O
local	O
minimum	O
at	O
t	O
=	O
1.	O
thus	O
,	O
even	O
in	O
the	O
case	O
of	O
perfect	O
matches	O
local	B
minima	I
may	O
occur	O
.	O
this	O
example	O
shows	O
that	O
an	O
algorithm	B
that	O
attempts	O
to	O
minimize	O
the	O
cost	B
function	I
in	O
(	O
12.1	O
)	O
,	O
or	O
equivalently	O
(	O
12.2	O
)	O
,	O
by	O
an	O
iterative	B
1	O
in	O
this	O
graph	O
and	O
also	O
ﬁgure	O
12.4b	O
we	O
make	O
the	O
substitution	O
t	O
=	O
tan	O
(	O
θ	O
)	O
and	O
plot	O
for	O
θ	O
in	O
the	O
range	O
−π/2	O
≤	O
θ	O
≤	O
π/2	O
,	O
so	O
as	O
to	O
show	O
the	O
whole	O
inﬁnite	O
range	O
for	O
t.	O
320	O
12	O
structure	B
computation	O
search	O
beginning	O
from	O
an	O
arbitrary	O
initial	O
point	O
is	O
in	O
danger	O
of	O
ﬁnding	O
a	O
local	O
minimum	O
,	O
even	O
in	O
the	O
case	O
of	O
perfect	O
point	B
matches	O
.	O
12.5.4	O
evaluation	B
on	I
real	I
images	I
an	O
experiment	O
was	O
carried	O
out	O
using	O
the	O
calibration	B
cube	O
images	O
shown	O
in	O
ﬁgure	O
11.2-	O
(	O
p289	O
)	O
with	O
the	O
goal	O
of	O
determining	O
how	O
the	O
triangulation	B
method	O
effects	O
the	O
accuracy	O
of	O
reconstruction	O
.	O
a	O
euclidean	O
model	O
of	O
the	O
cubes	O
,	O
to	O
be	O
used	O
as	O
ground	O
truth	O
,	O
was	O
es-	O
timated	O
and	O
reﬁned	O
using	O
accurate	O
image	O
measurements	O
.	O
the	O
measured	O
pixel	O
locations	O
were	O
corrected	O
to	O
correspond	O
exactly	O
to	O
the	O
euclidean	O
model	O
,	O
requiring	O
coordinate	O
cor-	O
rections	O
averaging	O
0.02	O
pixels	O
.	O
at	O
this	O
stage	O
we	O
had	O
a	O
model	B
and	O
a	O
set	O
of	O
matched	O
points	O
corresponding	O
exactly	O
to	O
the	O
model	B
.	O
next	O
,	O
a	O
projective	B
reconstruction	I
of	O
the	O
points	O
was	O
computed	O
and	O
a	O
projective	B
transformation	I
h	O
computed	O
that	O
brought	O
the	O
projective	B
reconstruction	I
into	O
agreement	O
with	O
the	O
euclidean	O
model	O
.	O
controlled	O
zero-mean	O
gaussian	O
noise	B
was	O
introduced	O
into	O
the	O
point	B
coordinates	O
,	O
and	O
triangulation	B
using	O
two	O
methods	O
was	O
carried	O
out	O
in	O
the	O
pro-	O
jective	O
frame	O
,	O
the	O
transformation	B
h	O
applied	O
,	O
and	O
the	O
error	B
of	O
each	O
method	O
was	O
measured	O
in	O
the	O
euclidean	O
frame	O
.	O
figure	O
12.5	O
shows	O
the	O
results	O
of	O
this	O
experiment	O
for	O
the	O
two	O
tri-	O
angulation	O
methods	O
.	O
the	O
graph	O
shows	O
the	O
average	O
reconstruction	B
error	O
over	O
all	O
points	O
in	O
10	O
separate	O
runs	O
at	O
each	O
chosen	O
noise	B
level	O
.	O
it	O
clearly	O
shows	O
that	O
the	O
optimal	O
method	O
gives	O
superior	O
reconstruction	B
results	O
.	O
in	O
this	O
pair	O
of	O
images	O
the	O
two	O
epipoles	O
are	O
distant	O
from	O
the	O
image	O
.	O
for	O
cases	O
where	O
the	O
epipoles	B
are	O
close	O
to	O
the	O
images	O
,	O
results	O
on	O
synthetic	O
images	O
show	O
that	O
the	O
advantage	O
of	O
the	O
polynomial	O
method	O
will	O
be	O
more	O
pronounced	O
.	O
r	O
o	O
r	O
r	O
e	O
n	O
o	O
i	O
t	O
c	O
u	O
r	O
t	O
s	O
n	O
o	O
c	O
e	O
r	O
0.6	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
0	O
0	O
0.05	O
0.1	O
0.15	O
noise	B
fig	O
.	O
12.5.	O
reconstruction	B
error	O
comparison	O
of	O
triangulation	B
methods	O
.	O
the	O
graph	O
shows	O
the	O
recon-	O
struction	O
error	B
obtained	O
using	O
two	O
triangulation	B
methods	O
:	O
(	O
i	O
)	O
selection	O
of	O
the	O
midpoint	O
of	O
the	O
common	O
perpendicular	O
to	O
the	O
rays	O
in	O
the	O
projective	B
frame	O
(	O
top	O
curve	O
)	O
,	O
and	O
(	O
ii	O
)	O
the	O
optimal	O
polynomial	O
method	O
(	O
lower	O
curve	O
)	O
.	O
on	O
the	O
horizontal	O
axis	O
is	O
the	O
noise	B
,	O
on	O
the	O
vertical	O
axis	O
the	O
reconstruction	B
error	O
.	O
the	O
units	O
for	O
reconstruction	O
error	B
are	O
relative	O
to	O
a	O
unit	O
distance	B
equal	O
to	O
the	O
side	O
of	O
one	O
of	O
the	O
dark	O
squares	O
in	O
the	O
calibration	B
cube	O
image	O
ﬁgure	O
11.2	O
(	O
p289	O
)	O
.	O
even	O
for	O
the	O
best	O
method	O
the	O
error	B
is	O
large	O
for	O
higher	O
noise	B
levels	O
,	O
because	O
there	O
is	O
little	O
movement	O
between	O
the	O
images	O
.	O
12.6	O
probability	O
distribution	O
of	O
the	O
estimated	O
3d	O
point	B
321	O
fig	O
.	O
12.6.	O
uncertainty	O
of	O
reconstruction	O
.	O
the	O
shaded	O
region	O
in	O
each	O
case	O
illustrates	O
the	O
shape	O
of	O
the	O
uncertainty	O
region	O
,	O
which	O
depends	O
on	O
the	O
angle	B
between	O
the	O
rays	O
.	O
points	O
are	O
less	O
precisely	O
localized	O
along	O
the	O
ray	O
as	O
the	O
rays	O
become	O
more	O
parallel	O
.	O
forward	O
motion	O
in	O
particular	O
can	O
give	O
poor	O
reconstruc-	O
tions	O
since	O
rays	O
are	O
almost	O
parallel	B
for	O
much	O
of	O
the	O
ﬁeld	O
of	O
view	O
.	O
12.6	O
probability	O
distribution	O
of	O
the	O
estimated	O
3d	O
point	B
an	O
illustration	O
of	O
the	O
distribution	O
of	O
the	O
reconstructed	O
point	B
is	O
given	O
in	O
ﬁgure	O
12.6.	O
a	O
good	O
rule	O
of	O
thumb	O
is	O
that	O
the	O
angle	B
between	O
the	O
rays	O
determines	O
the	O
accuracy	O
of	O
reconstruction	O
.	O
this	O
is	O
a	O
better	O
guide	O
than	O
simply	O
considering	O
the	O
baseline	O
,	O
which	O
is	O
the	O
more	O
commonly	O
used	O
measure	O
.	O
more	O
formally	O
the	O
probability	O
of	O
a	O
particular	O
3d	O
point	B
x	O
depends	O
on	O
the	O
probability	O
of	O
obtaining	O
its	O
image	O
in	O
each	O
view	O
.	O
we	O
will	O
consider	O
a	O
simpliﬁed	O
example	O
where	O
the	O
objective	O
is	O
to	O
estimate	O
the	O
probability	O
that	O
a	O
point	B
on	O
a	O
plane	B
has	O
position	O
x	O
=	O
(	O
x	O
,	O
y	O
)	O
t	O
(	O
x	O
)	O
in	O
two	O
line	B
cameras	O
.	O
(	O
the	O
projections	O
f	O
and	O
given	O
its	O
images	O
x	O
=	O
f	O
(	O
x	O
)	O
and	O
x	O
(	O
cid:2	O
)	O
2×3	O
respectively	O
–	O
f	O
see	O
section	O
6.4.2	O
(	O
p175	O
)	O
)	O
.	O
the	O
imaging	O
geometry	O
is	O
shown	O
in	O
ﬁgure	O
12.7	O
(	O
a	O
)	O
.	O
are	O
expressible	O
in	O
terms	O
of	O
2	O
×	O
3	O
projection	B
matrices	O
p2×3	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
f	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
suppose	O
that	O
the	O
measured	O
image	O
point	O
is	O
at	O
x	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
the	O
measure-	O
ment	O
process	O
is	O
corrupted	O
by	O
gaussian	O
noise	B
with	O
mean	O
zero	O
and	O
variance	B
σ2	O
,	O
then	O
the	O
probability	O
of	O
obtaining	O
x	O
,	O
given	O
that	O
the	O
true	O
image	O
point	O
is	O
f	O
(	O
x	O
)	O
,	O
is	O
given	O
by	O
p	O
(	O
x|x	O
)	O
=	O
(	O
2πσ2	O
)	O
−1/2	O
exp	O
(	O
cid:15	O
)	O
−|f	O
(	O
x	O
)	O
−	O
x|2/	O
(	O
2σ2	O
)	O
(	O
cid:16	O
)	O
.	O
with	O
a	O
similar	O
expression	O
for	O
p	O
(	O
x	O
p	O
(	O
x|x	O
,	O
x	O
(	O
cid:2	O
)	O
|x	O
)	O
.	O
we	O
wish	O
to	O
compute	O
the	O
a	O
posteriori	O
distribution	B
:	O
(	O
cid:2	O
)	O
)	O
=	O
p	O
(	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
|x	O
)	O
p	O
(	O
x	O
)	O
/p	O
(	O
x	O
,	O
x	O
)	O
.	O
(	O
cid:2	O
)	O
assuming	O
a	O
uniform	O
prior	O
probability	O
p	O
(	O
x	O
)	O
,	O
and	O
independent	O
image	O
measurements	O
in	O
the	O
two	O
images	O
,	O
it	O
follows	O
that	O
p	O
(	O
x|x	O
,	O
x	O
(	O
cid:2	O
)	O
|x	O
)	O
=	O
p	O
(	O
x|x	O
)	O
p	O
(	O
x	O
)	O
∼	O
p	O
(	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
|x	O
)	O
.	O
(	O
cid:2	O
)	O
figure	O
12.7	O
shows	O
an	O
example	O
of	O
this	O
probability	B
density	I
function	I
(	O
pdf	O
)	O
.	O
the	O
bias	B
and	O
variance	B
of	O
this	O
example	O
is	O
discussed	O
in	O
appendix	O
3	O
(	O
p568	O
)	O
.	O
12.7	O
line	B
reconstruction	I
suppose	O
a	O
line	B
in	O
3-space	O
is	O
projected	O
to	O
lines	O
in	O
two	O
views	O
as	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
.	O
the	O
line	B
in	O
3-space	O
can	O
be	O
reconstructed	O
by	O
back-projecting	O
each	O
line	B
to	O
give	O
a	O
plane	B
in	O
3-space	O
,	O
and	O
intersecting	O
the	O
planes	O
.	O
12	O
structure	B
computation	O
322	O
1c	O
c	O
2	O
a	O
b	O
c	O
fig	O
.	O
12.7.	O
pdf	O
for	O
a	O
triangulated	O
point	B
.	O
(	O
a	O
)	O
the	O
camera	B
conﬁguration	O
.	O
there	O
are	O
two	O
line	O
cameras	B
with	O
centres	O
at	O
c1	O
and	O
c2	O
.	O
the	O
image	O
lines	O
are	O
the	O
left	O
and	O
lower	O
edge	O
of	O
the	O
square	O
.	O
the	O
bar	O
indicates	O
the	O
2σ	O
range	O
of	O
the	O
noise	O
.	O
the	O
plots	O
show	O
the	O
pdf	O
for	O
a	O
triangulated	O
point	B
computed	O
from	O
the	O
two	O
perspective	O
projections	O
.	O
a	O
large	O
noise	B
variance	O
σ2	O
is	O
chosen	O
to	O
emphasize	O
the	O
effect	O
.	O
(	O
b	O
)	O
the	O
pdf	O
shown	O
as	O
an	O
image	O
with	O
white	O
representing	O
a	O
higher	O
value	O
.	O
(	O
b	O
)	O
a	O
contour	B
plot	O
of	O
the	O
pdf	O
.	O
note	O
that	O
the	O
pdf	O
is	O
not	O
a	O
gaussian	O
.	O
π	O
l	O
e	O
c	O
l	O
π	O
/	O
l	O
/	O
/	O
e	O
/	O
c	O
epipolar	B
plane	O
fig	O
.	O
12.8.	O
line	B
reconstruction	I
.	O
the	O
image	O
lines	O
l	O
,	O
l	O
(	O
cid:1	O
)	O
respectively	O
.	O
the	O
plane	B
intersection	O
determines	O
the	O
line	B
l	O
in	O
3-space	O
.	O
if	O
the	O
line	B
in	O
3-space	O
lies	O
on	O
an	O
epipolar	B
plane	O
then	O
its	O
position	O
in	O
3-space	O
can	O
not	O
be	O
determined	O
from	O
its	O
images	O
.	O
in	O
this	O
case	O
the	O
epipoles	B
lie	O
on	O
the	O
image	O
lines	O
.	O
back-project	O
to	O
planes	O
π	O
,	O
π	O
(	O
cid:1	O
)	O
the	O
planes	O
deﬁned	O
by	O
the	O
lines	B
are	O
π	O
=	O
ptl	O
and	O
π	O
(	O
cid:2	O
)	O
.	O
it	O
is	O
often	O
quite	O
con-	O
venient	O
in	O
practice	O
to	O
parametrize	O
the	O
line	B
in	O
3-space	O
by	O
the	O
two	O
planes	O
deﬁned	O
by	O
the	O
image	O
lines	O
,	O
i.e	O
.	O
to	O
represent	O
the	O
line	B
as	O
the	O
2	O
×	O
4	O
matrix	B
=	O
p	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
l	O
=	O
ltp	O
l	O
(	O
cid:2	O
)	O
tp	O
(	O
cid:2	O
)	O
as	O
described	O
in	O
the	O
span	B
representation	I
of	O
section	O
3.2.2	O
(	O
p68	O
)	O
.	O
then	O
for	O
example	O
a	O
point	B
x	O
lies	O
on	O
the	O
line	B
if	O
lx	O
=	O
0.	O
in	O
the	O
case	O
of	O
corresponding	O
points	O
the	O
pre-image	O
(	O
i.e	O
.	O
the	O
point	B
in	O
3-space	O
that	O
projects	O
to	O
the	O
image	O
points	O
)	O
is	O
over-determined	B
since	O
there	O
are	O
four	O
measurements	O
12.8	O
closure	O
323	O
on	O
the	O
three	O
degrees	B
of	I
freedom	I
of	O
the	O
3-space	O
point	B
.	O
in	O
contrast	O
in	O
the	O
case	O
of	B
lines	I
the	O
pre-image	O
is	O
exactly	O
determined	O
because	O
a	O
line	B
in	O
3-space	O
has	O
four	O
degrees	O
of	O
free-	O
dom	O
,	O
and	O
the	O
image	O
line	O
provides	O
two	O
measurements	O
in	O
each	O
view	O
.	O
note	O
,	O
here	O
we	O
are	O
considering	O
the	O
lines	B
as	O
inﬁnite	O
,	O
and	O
not	O
using	O
their	O
endpoints	O
.	O
degeneracy	B
.	O
as	O
illustrated	O
in	O
ﬁgure	O
12.8	O
lines	B
in	O
3-space	O
lying	O
on	O
epipolar	O
planes	O
can	O
not	O
be	O
determined	O
from	O
their	O
images	O
in	O
two	O
views	O
.	O
such	O
lines	B
intersect	O
the	O
cam-	O
era	O
baseline	O
.	O
in	O
practice	O
,	O
when	O
there	O
is	O
measurement	O
error	O
,	O
lines	B
which	O
are	O
close	O
to	O
intersecting	O
the	O
baseline	O
can	O
be	O
poorly	O
localized	O
in	O
a	O
reconstruction	B
.	O
the	O
degeneracy	B
for	O
lines	B
is	O
far	O
more	O
severe	O
than	O
for	O
points	O
:	O
in	O
the	O
case	O
of	B
points	I
there	O
is	O
a	O
one-parameter	O
family	O
of	B
points	I
on	O
the	O
baseline	O
which	O
can	O
not	O
be	O
recovered	O
.	O
for	B
lines	I
there	O
is	O
a	O
three-parameter	O
family	O
:	O
one	O
parameter	O
for	O
position	O
on	O
the	O
baseline	O
,	O
and	O
the	O
other	O
two	O
for	O
the	O
star	O
of	B
lines	I
through	O
each	O
point	B
on	O
the	O
baseline	O
.	O
intersection	B
of	O
more	O
than	O
two	O
planes	O
in	O
later	O
chapters	O
(	O
particularly	O
chapter	O
15	O
)	O
we	O
will	O
be	O
considering	O
reconstruction	B
from	O
three	O
or	O
more	O
views	O
.	O
to	O
reconstruct	O
the	O
line	B
that	O
results	O
from	O
the	O
intersection	B
of	O
several	O
planes	O
it	O
is	O
appropriate	O
to	O
proceed	O
as	O
follows	O
.	O
represent	O
each	O
plane	B
πi	O
by	O
a	O
4-vector	O
and	O
form	O
an	O
n	O
×	O
4	O
matrix	B
a	O
for	O
n	O
planes	O
with	O
rows	O
πt	O
i	O
.	O
let	O
a	O
=	O
udvt	O
be	O
the	O
singular	O
value	O
decomposition	B
.	O
the	O
two	O
columns	O
of	O
v	O
corresponding	O
to	O
the	O
two	O
largest	O
singular	B
values	I
span	O
the	O
best	O
rank	O
2	O
approximation	O
to	O
a	O
and	O
may	O
be	O
used	O
to	O
deﬁne	O
the	O
line	B
of	O
intersection	B
of	O
the	O
planes	O
.	O
if	O
the	O
planes	O
are	O
deﬁned	O
by	O
back-projecting	O
image	O
lines	O
,	O
then	O
the	O
maximum	O
likelihood	O
estimate	O
of	O
the	O
line	O
l	O
in	O
3-space	O
is	O
found	O
by	O
minimizing	B
a	O
geometric	B
image	O
distance	B
between	O
l	O
projected	O
into	O
each	O
image	O
and	O
the	O
measured	O
line	B
in	O
that	O
image	O
.	O
this	O
is	O
discussed	O
in	O
section	O
16.4.1	O
(	O
p396	O
)	O
.	O
12.8	O
closure	O
it	O
is	O
not	O
evident	O
how	O
to	O
extend	O
the	O
polynomial	O
method	O
of	B
triangulation	I
to	O
3	O
or	O
more	O
views	O
.	O
however	O
,	O
the	O
linear	B
method	O
extends	O
in	O
an	O
obvious	O
manner	O
.	O
more	O
interestingly	O
,	O
the	O
sampson	O
method	O
also	O
may	O
be	O
extended	O
to	O
3	O
or	O
more	O
views	O
,	O
as	O
is	O
described	O
in	O
[	O
torr-97	O
]	O
.	O
the	O
disadvantage	O
is	O
that	O
the	O
computational	O
cost	O
(	O
and	O
also	O
coding	O
effort	O
)	O
increases	O
noticeably	O
with	O
more	O
views	O
.	O
12.8.1	O
the	O
literature	O
the	O
optimal	O
triangulation	B
method	O
was	O
given	O
by	O
hartley	O
&	O
sturm	O
[	O
hartley-97b	O
]	O
.	O
12.8.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
derive	O
a	O
method	O
for	O
triangulation	O
in	O
the	O
case	O
of	O
pure	O
translational	B
motion	I
of	O
the	O
cameras	B
.	O
hint	O
,	O
see	O
ﬁgure	O
12.9.	O
a	O
closed	O
form	O
solution	O
for	O
the	O
parameter	O
θ	O
is	O
possible	O
.	O
this	O
method	O
was	O
used	O
in	O
[	O
armstrong-94	O
]	O
.	O
(	O
ii	O
)	O
adapt	O
the	O
polynomial	O
triangulation	B
method	O
to	O
a	O
pair	O
of	O
afﬁne	O
cameras	B
(	O
or	O
more	O
generally	O
,	O
to	O
cameras	O
with	O
the	O
same	O
principal	O
plane	B
)	O
.	O
in	O
this	O
case	O
,	O
the	O
funda-	O
mental	O
matrix	B
has	O
a	O
simple	O
form	O
,	O
(	O
14.1–p345	O
)	O
,	O
and	O
the	O
method	O
reduces	O
to	O
a	O
linear	B
algorithm	I
.	O
324	O
12	O
structure	B
computation	O
/	O
d	O
x	O
/	O
/x	O
x	O
d	O
x	O
images	O
1	O
&	O
2	O
e	O
=	O
e	O
/	O
θ	O
fig	O
.	O
12.9.	O
the	O
epipolar	B
geometry	O
for	O
pure	O
translation	O
.	O
in	O
this	O
case	O
,	O
corresponding	O
epipolar	B
lines	I
are	O
(	O
cid:1	O
)	O
2	O
can	O
identical	O
(	O
see	O
section	O
11.7.1	O
(	O
p293	O
)	O
)	O
.	O
the	O
epipolar	B
line	I
(	O
parametrized	O
by	O
θ	O
)	O
that	O
minimizes	O
d2	O
+	O
d	O
be	O
computed	O
directly	O
.	O
(	O
iii	O
)	O
show	O
that	O
the	O
sampson	O
method	O
(	O
section	O
12.4	O
)	O
is	O
invariant	O
under	O
euclidean	O
co-	O
(	O
iv	O
)	O
derive	O
the	O
analogue	O
of	O
the	O
polynomial	O
solution	B
for	O
triangulation	B
in	O
the	O
case	O
of	O
,	O
compute	O
ordinate	O
changes	O
in	O
the	O
images	O
(	O
and	O
the	O
corresponding	O
change	O
in	O
f	O
)	O
.	O
a	O
planar	O
homography	O
,	O
i.e	O
.	O
given	O
a	O
measured	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
points	O
ˆx	O
and	O
ˆx	O
(	O
cid:2	O
)	O
that	O
minimize	O
the	O
function	O
,	O
ˆx	O
(	O
cid:2	O
)	O
)	O
=	O
d	O
(	O
x	O
,	O
ˆx	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
c	O
(	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
subject	O
to	O
ˆx	O
(	O
cid:2	O
)	O
)	O
2	O
=	O
hˆx	O
.	O
see	O
[	O
sturm-97b	O
]	O
,	O
where	O
it	O
is	O
shown	O
that	O
the	O
solution	B
is	O
a	O
degree	O
8	O
polynomial	O
in	O
one	O
variable	O
.	O
13	O
scene	O
planes	O
and	O
homographies	B
this	O
chapter	O
describes	O
the	O
projective	B
geometry	O
of	O
two	O
cameras	B
and	O
a	O
world	O
plane	B
.	O
images	O
of	B
points	I
on	O
a	O
plane	B
are	O
related	O
to	O
corresponding	O
image	O
points	O
in	O
a	O
second	O
view	O
by	O
a	O
(	O
planar	O
)	O
homography	B
as	O
shown	O
in	O
ﬁgure	O
13.1.	O
this	O
is	O
a	O
projective	B
relation	O
since	O
it	O
depends	O
only	O
on	O
the	O
intersections	O
of	O
planes	O
with	O
lines	O
.	O
it	O
is	O
said	O
that	O
the	O
plane	B
induces	O
a	O
homography	B
between	O
the	O
views	O
.	O
the	O
homography	B
map	O
transfers	O
points	O
from	O
one	O
view	O
to	O
the	O
other	O
as	O
if	O
they	O
were	O
images	O
of	B
points	I
on	O
the	O
plane	B
.	O
there	O
are	O
then	O
two	O
relations	O
between	O
the	O
two	B
views	I
:	O
ﬁrst	O
,	O
through	O
the	O
epipolar	B
ge-	O
ometry	O
a	O
point	B
in	O
one	O
view	O
determines	O
a	O
line	B
in	O
the	O
other	O
which	O
is	O
the	O
image	O
of	O
the	O
ray	O
through	O
that	O
point	B
;	O
and	O
second	O
,	O
through	O
the	O
homography	B
a	O
point	B
in	O
one	O
view	O
determines	O
a	O
point	B
in	O
the	O
other	O
which	O
is	O
the	O
image	O
of	O
the	O
intersection	O
of	O
the	O
ray	O
with	O
a	O
plane	B
.	O
this	O
chapter	O
ties	O
together	O
these	O
two	O
relations	O
of	O
2-view	O
geometry	O
.	O
two	O
other	O
important	O
notions	O
are	O
described	O
here	O
:	O
the	O
parallax	B
with	O
respect	O
to	O
a	O
plane	B
,	O
and	O
the	O
inﬁnite	B
homography	I
.	O
π	O
x	O
π	O
h	O
/	O
x	O
/	O
c	O
x	O
c	O
fig	O
.	O
13.1.	O
the	O
homography	B
induced	O
by	O
a	O
plane	B
.	O
the	O
ray	O
corresponding	O
to	O
a	O
point	B
x	O
is	O
extended	O
to	O
meet	O
the	O
plane	B
π	O
in	O
a	O
point	B
xπ	O
;	O
this	O
point	B
is	O
projected	O
to	O
a	O
point	B
x	O
(	O
cid:1	O
)	O
in	O
the	O
other	O
image	O
.	O
the	O
map	O
from	O
x	O
to	O
x	O
(	O
cid:1	O
)	O
is	O
the	O
homography	B
induced	O
by	O
the	O
plane	B
π.	O
there	O
is	O
a	O
perspectivity	O
,	O
x	O
=	O
h1πxπ	O
,	O
between	O
the	O
world	O
plane	B
π	O
and	O
the	O
ﬁrst	O
image	B
plane	I
;	O
and	O
a	O
perspectivity	O
,	O
x	O
(	O
cid:1	O
)	O
=	O
h2πxπ	O
,	O
between	O
the	O
world	O
plane	B
and	O
second	O
image	B
plane	I
.	O
the	O
composition	O
of	O
the	O
two	O
perspectivities	O
is	O
a	O
homography	B
,	O
x	O
(	O
cid:1	O
)	O
=	O
h2πh−1	O
1π	O
x	O
=	O
hx	O
,	O
between	O
the	O
image	O
planes	O
.	O
325	O
326	O
13	O
scene	O
planes	O
and	O
homographies	B
13.1	O
homographies	B
given	O
the	O
plane	B
and	O
vice	O
versa	O
we	O
start	O
by	O
showing	O
that	O
for	O
planes	O
in	O
general	O
position	O
the	O
homography	B
is	O
determined	O
uniquely	O
by	O
the	O
plane	B
and	O
vice	O
versa	O
.	O
general	B
position	I
in	O
this	O
case	O
means	O
that	O
the	O
plane	B
does	O
not	O
contain	O
either	O
of	O
the	O
camera	O
centres	O
.	O
if	O
the	O
plane	B
does	O
contain	O
one	O
of	O
the	O
camera	O
centres	O
then	O
the	O
induced	O
homography	O
is	O
degenerate	B
.	O
suppose	O
a	O
plane	B
π	O
in	O
3-space	O
is	O
speciﬁed	O
by	O
its	O
coordinates	B
in	O
the	O
world	O
frame	O
.	O
we	O
ﬁrst	O
derive	O
an	O
explicit	O
expression	O
for	O
the	O
induced	O
homography	O
.	O
result	O
13.1.	O
given	O
the	O
projection	B
matrices	O
for	O
the	O
two	B
views	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
a	O
|	O
a	O
]	O
and	O
a	O
plane	B
deﬁned	O
by	O
πtx	O
=	O
0	O
with	O
π	O
=	O
(	O
vt	O
,	O
1	O
)	O
t	O
,	O
then	O
the	O
homography	B
induced	O
by	O
the	O
plane	B
is	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
with	O
h	O
=	O
a	O
−	O
avt	O
.	O
(	O
13.1	O
)	O
we	O
may	O
assume	O
that	O
π4	O
=	O
1	O
since	O
the	O
plane	B
does	O
not	O
pass	O
through	O
the	O
centre	B
of	O
the	O
ﬁrst	O
camera	B
at	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
note	O
,	O
there	O
is	O
a	O
three-parameter	O
family	O
of	O
planes	O
in	O
3-space	O
,	O
and	O
correspondingly	O
a	O
three-parameter	O
family	O
of	O
homographies	O
between	O
two	O
views	O
induced	O
by	O
planes	O
in	O
3-	O
space	O
.	O
these	O
three	O
parameters	B
are	O
speciﬁed	O
by	O
the	O
elements	O
of	O
the	O
vector	O
v	O
,	O
which	O
is	O
not	O
a	O
homogeneous	O
3-vector	O
.	O
proof	O
.	O
to	O
compute	O
h	O
we	O
back-project	O
a	O
point	B
x	O
in	O
the	O
ﬁrst	O
view	O
and	O
determine	O
the	O
intersection	B
point	O
x	O
of	O
this	O
ray	O
with	O
the	O
plane	B
π.	O
the	O
3d	O
point	B
x	O
is	O
then	O
projected	O
into	O
the	O
second	O
view	O
.	O
for	O
the	O
ﬁrst	O
view	O
x	O
=	O
px	O
=	O
[	O
i	O
|	O
0	O
]	O
x	O
and	O
so	O
any	O
point	B
on	O
the	O
ray	O
x	O
=	O
(	O
xt	O
,	O
ρ	O
)	O
t	O
projects	O
to	O
x	O
,	O
where	O
ρ	O
parametrizes	O
the	O
point	B
on	O
the	O
ray	O
.	O
since	O
the	O
3d	O
point	B
x	O
is	O
on	O
π	O
it	O
satisﬁes	O
πtx	O
=	O
0.	O
this	O
determines	O
ρ	O
,	O
and	O
x	O
=	O
(	O
xt	O
,	O
−vtx	O
)	O
t.	O
the	O
3d	O
point	B
x	O
projects	O
into	O
the	O
second	O
view	O
as	O
x	O
(	O
cid:2	O
)	O
(	O
cid:15	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
=	O
[	O
a	O
|	O
a	O
]	O
x	O
a−avt	O
=	O
ax	O
−	O
avtx	O
=	O
(	O
cid:16	O
)	O
x	O
as	O
required	O
.	O
example	O
13.2.	O
a	O
calibrated	B
stereo	O
rig	O
.	O
suppose	O
the	O
camera	B
matrices	I
are	O
those	O
of	O
a	O
calibrated	O
stereo	O
rig	O
with	O
the	O
world	O
origin	O
at	O
the	O
ﬁrst	O
camera	B
pe	O
=	O
k	O
[	O
i	O
|	O
0	O
]	O
p	O
(	O
cid:2	O
)	O
e	O
=	O
k	O
(	O
cid:2	O
)	O
[	O
r	O
|	O
t	O
]	O
,	O
and	O
the	O
world	O
plane	B
πe	O
has	O
coordinates	B
πe	O
=	O
(	O
nt	O
,	O
d	O
)	O
t	O
so	O
that	O
for	O
points	O
on	O
the	O
plane	B
nt	O
(	O
cid:22	O
)	O
x	O
+	O
d	O
=	O
0.	O
we	O
wish	O
to	O
compute	O
an	O
expression	O
for	O
the	O
homography	B
induced	O
by	O
the	O
plane	B
.	O
13.1	O
homographies	B
given	O
the	O
plane	B
and	O
vice	O
versa	O
327	O
from	O
result	O
13.1	O
,	O
with	O
v	O
=	O
n/d	O
,	O
the	O
homography	B
for	O
the	O
cameras	B
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
r	O
|	O
t	O
]	O
is	O
applying	O
the	O
transformations	O
k	O
and	O
k	O
(	O
cid:2	O
)	O
k	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
[	O
r	O
|	O
t	O
]	O
and	O
the	O
resulting	O
induced	O
homography	O
is	O
e	O
=	O
k	O
(	O
cid:2	O
)	O
to	O
the	O
images	O
we	O
obtain	O
the	O
cameras	B
pe	O
=	O
k−1	O
.	O
(	O
13.2	O
)	O
h	O
=	O
r	O
−	O
tnt/d	O
.	O
(	O
cid:16	O
)	O
r	O
−	O
tnt/d	O
h	O
=	O
k	O
(	O
cid:2	O
)	O
(	O
cid:15	O
)	O
this	O
is	O
a	O
three-parameter	O
family	O
of	O
homographies	O
,	O
parametrized	O
by	O
n/d	O
.	O
it	O
is	O
deﬁned	O
(	O
cid:2	O
)	O
by	O
the	O
plane	B
,	O
and	O
the	O
camera	B
internal	O
and	O
relative	O
external	O
parameters	B
.	O
13.1.1	O
homographies	B
compatible	O
with	O
epipolar	O
geometry	O
suppose	O
four	O
points	O
xi	O
are	O
chosen	O
on	O
a	O
scene	O
plane	B
.	O
then	O
the	O
correspondence	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
of	O
their	O
images	O
between	O
two	O
views	O
deﬁnes	O
a	O
homography	B
h	O
,	O
which	O
is	O
the	O
homography	B
induced	O
by	O
the	O
plane	B
.	O
these	O
image	O
correspondences	O
also	O
obey	O
the	O
epipolar	B
constraint	O
,	O
i.e	O
.	O
x	O
(	O
cid:2	O
)	O
tfxi	O
=	O
0	O
,	O
since	O
they	O
arise	O
from	O
images	O
of	O
scene	O
points	O
.	O
indeed	O
,	O
the	O
correspon-	O
dence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
are	O
images	O
of	O
a	O
scene	O
point	B
,	O
in	O
this	O
case	O
the	O
point	B
given	O
by	O
intersecting	O
the	O
scene	O
plane	O
with	O
the	O
ray	O
back-projected	O
from	O
x.	O
the	O
homography	B
h	O
is	O
said	O
to	O
be	O
consistent	O
or	O
compatible	O
with	O
f.	O
=	O
hx	O
obeys	O
the	O
epipolar	B
constraint	O
for	O
any	O
x	O
,	O
since	O
again	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
now	O
suppose	O
four	O
arbitrary	O
image	O
points	O
are	O
chosen	O
in	O
the	O
ﬁrst	O
view	O
and	O
four	O
ar-	O
bitrary	O
image	O
points	O
chosen	O
in	O
the	O
second	O
.	O
then	O
a	O
homography	B
˜h	O
may	O
be	O
computed	O
which	O
maps	O
one	O
set	O
of	B
points	I
into	O
the	O
other	O
(	O
provided	O
no	O
three	O
are	O
collinear	O
in	O
either	O
view	O
)	O
.	O
however	O
,	O
correspondences	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
=	O
˜hx	O
may	O
not	O
obey	O
the	O
epipolar	B
constraint	O
.	O
if	O
the	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
=	O
˜hx	O
does	O
not	O
obey	O
the	O
epipolar	B
constraint	O
then	O
there	O
does	O
not	O
exist	O
a	O
scene	O
plane	O
which	O
induces	O
˜h	O
.	O
the	O
epipolar	B
geometry	O
determines	O
the	O
projective	B
geometry	O
between	O
two	O
views	O
,	O
and	O
can	O
be	O
used	O
to	O
deﬁne	O
conditions	O
on	O
homographies	O
which	O
are	O
induced	O
by	O
actual	O
scene	O
planes	O
.	O
figure	O
13.2	O
illustrates	O
several	O
relations	O
between	O
epipolar	O
geometry	O
and	O
scene	O
planes	O
which	O
can	O
be	O
used	O
to	O
deﬁne	O
such	O
conditions	O
.	O
for	O
example	O
,	O
since	O
correspon-	O
dences	O
x	O
↔	O
hx	O
obey	O
the	O
epipolar	B
constraint	O
if	O
h	O
is	O
induced	B
by	I
a	I
plane	I
,	O
then	O
from	O
x	O
(	O
cid:2	O
)	O
tfx	O
=	O
0	O
(	O
hx	O
)	O
tfx	O
=	O
xthtfx	O
=	O
0.	O
this	O
is	O
true	O
for	O
all	O
x	O
,	O
so	O
:	O
•	O
a	O
homography	B
h	O
is	O
compatible	O
with	O
a	O
fundamental	B
matrix	I
f	O
if	O
and	O
only	O
if	O
the	O
matrix	B
htf	O
is	O
skew-symmetric	O
:	O
htf	O
+	O
fth	O
=	O
0	O
(	O
13.3	O
)	O
the	O
argument	O
above	O
showed	O
that	O
the	O
condition	O
was	O
necessary	O
.	O
the	O
fact	O
that	O
this	O
is	O
a	O
sufﬁcient	O
condition	O
was	O
shown	O
by	O
luong	O
and	O
vi´eville	O
[	O
luong-96	O
]	O
.	O
counting	O
degrees	O
of	O
freedom	O
,	O
(	O
13.3	O
)	O
places	O
six	O
homogeneous	O
(	O
ﬁve	O
inhomogeneous	O
)	O
constraints	B
on	O
the	O
8	O
degrees	B
of	I
freedom	I
of	O
h.	O
there	O
are	O
therefore	O
8	O
−	O
5	O
=	O
3	O
degrees	B
of	I
freedom	I
remaining	O
328	O
13	O
scene	O
planes	O
and	O
homographies	B
π	O
baseline	O
e	O
a	O
e	O
/	O
l	O
e	O
π	O
x	O
e	O
π	O
l	O
e	O
l	O
/	O
e	O
e	O
/	O
e	O
b	O
l	O
/	O
e	O
/	O
x	O
hx	O
e	O
/	O
c	O
fig	O
.	O
13.2.	O
compatibility	O
constraints	O
.	O
the	O
homography	B
induced	O
by	O
a	O
plane	B
is	O
coupled	O
to	O
the	O
epipolar	B
geometry	O
and	O
satisﬁes	O
constraints	B
.	O
(	O
a	O
)	O
the	O
epipole	O
is	O
mapped	O
by	O
the	O
homography	B
,	O
as	O
e	O
(	O
cid:1	O
)	O
=	O
he	O
,	O
since	O
the	O
epipoles	B
are	O
images	O
of	O
the	O
point	O
on	O
the	O
plane	B
where	O
the	O
baseline	O
intersects	O
π	O
.	O
(	O
b	O
)	O
epipolar	B
lines	I
are	O
mapped	O
by	O
the	O
homography	B
as	O
htl	O
(	O
cid:1	O
)	O
e	O
=	O
le	O
.	O
(	O
c	O
)	O
any	O
point	B
x	O
mapped	O
by	O
the	O
homography	B
lies	O
on	O
its	O
corresponding	O
epipolar	B
line	I
l	O
(	O
cid:1	O
)	O
e	O
=	O
fx	O
=	O
x	O
(	O
cid:1	O
)	O
×	O
(	O
hx	O
)	O
.	O
e	O
,	O
sol	O
(	O
cid:1	O
)	O
for	O
h	O
;	O
these	O
3	O
degrees	B
of	I
freedom	I
correspond	O
to	O
the	O
three-parameter	O
family	O
of	O
planes	O
in	O
3-space	O
.	O
the	O
compatibility	O
constraint	O
(	O
13.3	O
)	O
is	O
an	O
implicit	O
equation	O
in	O
h	O
and	O
f.	O
we	O
now	O
de-	O
velop	O
an	O
explicit	O
expression	O
for	O
a	O
homography	O
h	O
induced	B
by	I
a	I
plane	I
given	O
f	O
which	O
is	O
more	O
suitable	O
for	O
a	O
computational	O
algorithm	B
.	O
result	O
13.3.	O
given	O
the	O
fundamental	B
matrix	I
f	O
between	O
two	O
views	O
,	O
the	O
three-parameter	O
family	O
of	O
homographies	O
induced	O
by	O
a	O
world	O
plane	B
is	O
h	O
=	O
a	O
−	O
e	O
(	O
cid:2	O
)	O
vt	O
(	O
13.4	O
)	O
where	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×a	O
=	O
f	O
is	O
any	O
decomposition	B
of	I
the	O
fundamental	B
matrix	I
.	O
proof	O
.	O
result	O
13.1	O
has	O
shown	O
that	O
given	O
the	O
camera	B
matrices	I
for	O
the	O
view	O
pair	O
p	O
=	O
=	O
[	O
a	O
|	O
a	O
]	O
a	O
plane	B
π	O
induces	O
a	O
homography	B
h	O
=	O
a−	O
avt	O
where	O
π	O
=	O
(	O
vt	O
,	O
1	O
)	O
t.	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
however	O
,	O
according	O
to	O
result	O
9.9	O
(	O
p254	O
)	O
,	O
for	O
the	O
fundamental	B
matrix	I
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×a	O
one	O
can	O
choose	O
the	O
two	O
cameras	O
to	O
be	O
[	O
i	O
|	O
0	O
]	O
and	O
[	O
a	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
.	O
remark	O
.	O
the	O
above	O
derivation	B
,	O
which	O
is	O
based	O
on	O
the	O
projection	B
of	O
points	B
on	I
a	I
plane	I
,	O
ensures	O
that	O
the	O
homographies	B
are	O
compatible	O
with	O
the	O
epipolar	B
geometry	O
.	O
al-	O
gebraically	O
,	O
the	O
homography	B
(	O
13.4	O
)	O
is	O
compatible	O
with	O
the	O
fundamental	B
matrix	I
since	O
it	O
obeys	O
the	O
necessary	O
and	O
sufﬁcient	O
condition	O
(	O
13.3	O
)	O
that	O
fth	O
is	O
skew-symmetric	O
.	O
this	O
13.2	O
plane	O
induced	O
homographies	O
given	O
f	O
and	O
image	O
correspondences	O
329	O
(	O
cid:15	O
)	O
a	O
−	O
e	O
(	O
cid:2	O
)	O
vt	O
(	O
cid:16	O
)	O
=	O
at	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×a	O
follows	O
from	O
fth	O
=	O
at	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
using	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×e	O
(	O
cid:2	O
)	O
=	O
0	O
,	O
since	O
at	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×a	O
is	O
skew-symmetric	O
.	O
comparing	O
(	O
13.4	O
)	O
with	O
the	O
general	O
decomposition	O
of	O
the	O
fundamental	O
matrix	B
,	O
as	O
given	O
in	O
lemma	O
9.11	O
(	O
p255	O
)	O
or	O
(	O
9.10–p256	O
)	O
it	O
is	O
evident	O
that	O
they	O
involve	O
an	O
iden-	O
tical	O
formula	O
(	O
except	O
for	O
signs	O
)	O
.	O
in	O
fact	O
there	O
is	O
a	O
one-to-one	O
correspondence	B
be-	O
tween	O
decompositions	O
of	O
the	O
fundamental	O
matrix	B
(	O
up	O
to	O
the	O
scale	O
factor	O
ambiguity	B
k	O
in	O
lemma	O
9.11	O
)	O
and	O
homographies	B
induced	O
by	O
world	O
planes	O
,	O
as	O
stated	O
here	O
.	O
corollary	O
13.4.	O
a	O
transformation	B
h	O
is	O
the	O
homography	B
between	O
two	O
images	O
induced	O
by	O
some	O
world	O
plane	B
if	O
and	O
only	O
if	O
the	O
fundamental	B
matrix	I
f	O
for	O
the	O
two	O
images	O
has	O
a	O
decomposition	B
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
this	O
choice	B
in	O
the	O
decomposition	B
simply	O
corresponds	O
to	O
the	O
choice	B
of	O
projective	B
world	O
in	O
fact	O
,	O
h	O
is	O
the	O
transformation	B
with	O
respect	O
to	O
the	O
plane	B
with	O
coordinates	B
frame	O
.	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
in	O
the	O
reconstruction	B
with	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
finding	O
the	O
plane	B
that	O
induces	O
a	O
given	O
homography	B
is	O
a	O
simple	O
matter	O
given	O
a	O
pair	O
of	O
=	O
[	O
h	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
×h	O
.	O
]	O
.	O
camera	B
matrices	I
,	O
as	O
follows	O
.	O
result	O
13.5.	O
given	O
the	O
cameras	B
in	O
the	O
canonical	B
form	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
a	O
|	O
a	O
]	O
,	O
then	O
the	O
plane	B
π	O
that	O
induces	O
a	O
given	O
homography	B
h	O
between	O
the	O
views	O
has	O
coordinates	B
π	O
=	O
(	O
vt	O
,	O
1	O
)	O
t	O
where	O
v	O
may	O
be	O
obtained	O
linearly	O
by	O
solving	B
the	O
equations	O
λh	O
=	O
a−avt	O
,	O
which	O
are	O
linear	B
in	O
the	O
entries	O
of	O
v	O
and	O
λ.	O
note	O
,	O
these	O
equations	O
have	O
an	O
exact	O
solution	B
only	O
if	O
h	O
satisﬁes	O
the	O
compatibility	O
con-	O
straint	O
(	O
13.3	O
)	O
with	O
f.	O
for	O
a	O
homography	O
computed	O
numerically	O
from	O
noisy	O
data	O
this	O
will	O
not	O
normally	O
be	O
true	O
,	O
and	O
the	O
linear	B
system	O
is	O
over-determined	B
.	O
13.2	O
plane	O
induced	O
homographies	O
given	O
f	O
and	O
image	O
correspondences	O
a	O
plane	B
in	O
3-space	O
can	O
be	O
speciﬁed	O
by	O
three	O
points	O
,	O
or	O
by	O
a	O
line	B
and	O
a	O
point	B
,	O
and	O
so	O
forth	O
.	O
in	O
turn	O
these	O
3d	O
elements	O
can	O
be	O
speciﬁed	O
by	O
image	O
correspondences	O
.	O
in	O
section	O
13.1	O
the	O
homography	B
was	O
computed	O
from	O
the	O
coordinates	B
of	O
the	O
plane	B
.	O
in	O
the	O
following	O
the	O
homography	B
will	O
be	O
computed	O
directly	O
from	O
the	O
corresponding	O
image	O
elements	O
that	O
specify	O
the	O
plane	B
.	O
this	O
is	O
a	O
quite	O
natural	O
mechanism	O
to	O
use	O
in	O
applications	O
.	O
we	O
will	O
consider	O
two	O
cases	O
:	O
(	O
i	O
)	O
three	O
points	O
;	O
(	O
ii	O
)	O
a	O
line	B
and	O
a	O
point	B
.	O
in	O
each	O
case	O
the	O
corresponding	O
elements	O
are	O
sufﬁcient	O
to	O
determine	O
a	O
plane	B
in	O
3-space	O
uniquely	O
.	O
it	O
will	O
be	O
seen	O
that	O
in	O
each	O
case	O
:	O
(	O
i	O
)	O
the	O
corresponding	O
image	O
entities	O
have	O
to	O
satisfy	O
consistency	O
constraints	O
with	O
the	O
epipolar	B
geometry	O
.	O
(	O
ii	O
)	O
there	O
are	O
degenerate	B
conﬁgurations	I
of	O
the	O
3d	O
elements	O
and	O
cameras	B
for	O
which	O
the	O
homography	B
is	O
not	O
deﬁned	O
.	O
such	O
degeneracies	B
arise	O
from	O
collinearities	O
and	O
coplanarities	O
of	O
the	O
3d	O
elements	O
and	O
the	O
epipolar	B
geometry	O
.	O
there	O
may	O
also	O
be	O
degeneracies	B
of	O
the	O
solution	B
method	O
,	O
but	O
these	O
can	O
be	O
avoided	O
.	O
the	O
three-point	O
case	O
is	O
covered	O
in	O
more	O
detail	O
.	O
330	O
13	O
scene	O
planes	O
and	O
homographies	B
l	O
e	O
π	O
x	O
1	O
x	O
3	O
x	O
2	O
e	O
/	O
e	O
/	O
e	O
l	O
fig	O
.	O
13.3.	O
degenerate	B
geometry	O
for	O
an	O
implicit	O
computation	B
of	I
the	O
homography	B
.	O
the	O
line	B
deﬁned	O
by	O
the	O
points	O
x1	O
and	O
x2	O
lies	O
in	O
an	O
epipolar	B
plane	O
,	O
and	O
thus	O
intersects	O
the	O
baseline	O
.	O
the	O
images	O
of	O
x1	O
and	O
x2	O
are	O
collinear	O
with	O
the	O
epipole	O
,	O
and	O
h	O
can	O
not	O
be	O
computed	O
uniquely	O
from	O
the	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
.	O
this	O
conﬁguration	O
is	O
not	O
degenerate	B
for	O
the	O
explicit	O
method	O
.	O
i	O
,	O
i	O
∈	O
{	O
1	O
,	O
.	O
.	O
.	O
,	O
3	O
}	O
,	O
e	O
↔	O
e	O
(	O
cid:1	O
)	O
13.2.1	O
three	O
points	O
we	O
suppose	O
that	O
we	O
have	O
the	O
images	O
in	O
two	O
views	O
of	O
three	O
(	O
non-collinear	O
)	O
points	O
xi	O
,	O
and	O
the	O
fundamental	B
matrix	I
f.	O
the	O
homography	B
h	O
induced	O
by	O
the	O
plane	B
of	O
the	O
points	O
may	O
be	O
computed	O
in	O
principle	O
in	O
two	O
ways	O
:	O
first	O
,	O
=	O
he	O
,	O
from	O
which	O
h	O
may	O
be	O
computed	O
.	O
the	O
position	O
of	O
the	O
points	O
xi	O
is	O
recovered	O
in	O
a	O
projective	B
reconstruction	I
(	O
chapter	O
12	O
)	O
.	O
then	O
the	O
plane	B
π	O
through	O
the	O
points	O
is	O
determined	O
(	O
3.3–p66	O
)	O
,	O
and	O
the	O
homography	B
computed	O
from	O
the	O
plane	B
as	O
in	O
result	O
13.1.	O
second	O
,	O
the	O
homography	B
may	O
be	O
computed	O
from	O
four	O
corresponding	O
points	O
,	O
the	O
four	O
points	O
in	O
this	O
case	O
being	O
the	O
images	O
of	O
the	O
three	O
points	O
xi	O
on	O
the	O
plane	B
together	O
with	O
the	O
epipole	O
in	O
each	O
view	O
.	O
the	O
epipole	O
may	O
be	O
used	O
as	O
the	O
fourth	O
point	B
since	O
it	O
is	O
mapped	O
between	O
the	O
views	O
by	O
the	O
homography	B
as	O
shown	O
in	O
ﬁgure	O
13.2.	O
thus	O
we	O
have	O
four	O
correspondences	O
,	O
i	O
=	O
hxi	O
,	O
i	O
∈	O
{	O
1	O
,	O
.	O
.	O
.	O
,3	O
}	O
,	O
e	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
we	O
thus	O
have	O
two	O
alternative	O
methods	O
to	O
compute	O
h	O
from	O
three	O
point	O
correspon-	O
dences	O
,	O
the	O
ﬁrst	O
involving	O
an	O
explicit	O
reconstruction	B
,	O
the	O
second	O
an	O
implicit	O
one	O
where	O
the	O
epipole	O
provides	O
a	O
point	B
correspondence	O
.	O
it	O
is	O
natural	O
to	O
ask	O
if	O
one	O
has	O
an	O
advantage	O
over	O
the	O
other	O
,	O
and	O
the	O
answer	O
is	O
that	O
the	O
implicit	O
method	O
should	O
not	O
be	O
used	O
for	O
com-	O
putation	O
as	O
it	O
has	O
signiﬁcant	O
degeneracies	B
which	O
are	O
not	O
present	O
in	O
the	O
explicit	O
method	O
.	O
consider	O
the	O
case	O
when	O
two	O
of	O
the	O
image	O
points	O
are	O
collinear	O
with	O
the	O
epipole	O
(	O
we	O
assume	O
for	O
the	O
moment	O
that	O
the	O
measurements	O
are	O
noise-free	O
)	O
.	O
a	O
homography	B
h	O
can	O
not	O
be	O
computed	O
from	O
four	O
correspondences	B
if	O
three	O
of	O
the	O
points	O
are	O
collinear	O
(	O
see	O
section	O
4.1.3	O
(	O
p91	O
)	O
)	O
,	O
so	O
the	O
implicit	O
method	O
fails	O
in	O
this	O
case	O
.	O
similarly	O
if	O
the	O
image	O
points	O
are	O
close	O
to	O
collinear	O
with	O
the	O
epipole	O
then	O
the	O
implicit	O
method	O
will	O
give	O
a	O
poorly	O
con-	O
ditioned	O
estimate	O
for	O
h.	O
the	O
explicit	O
method	O
has	O
no	O
problems	O
when	O
two	O
points	O
are	O
collinear	O
or	O
close	O
to	O
collinear	O
with	O
the	O
epipole	O
–	O
the	O
corresponding	O
image	O
points	O
deﬁne	O
points	O
in	O
3-space	O
(	O
the	O
world	O
points	O
are	O
on	O
the	O
same	O
epipolar	O
plane	B
,	O
but	O
this	O
is	O
not	O
a	O
degenerate	B
situation	O
)	O
and	O
the	O
plane	B
π	O
and	O
hence	O
homography	B
can	O
be	O
computed	O
.	O
the	O
conﬁguration	O
is	O
illustrated	O
in	O
ﬁgure	O
13.3.	O
we	O
now	O
develop	O
the	O
algebra	O
of	O
the	O
explicit	O
method	O
in	O
more	O
detail	O
.	O
it	O
is	O
not	O
neces-	O
13.2	O
plane	O
induced	O
homographies	O
given	O
f	O
and	O
image	O
correspondences	O
331	O
sary	O
to	O
actually	O
determine	O
the	O
coordinates	B
of	O
the	O
points	O
xi	O
,	O
all	O
that	O
is	O
important	O
is	O
the	O
constraint	O
they	O
place	O
on	O
the	O
three-parameter	O
family	O
of	O
homographies	O
compatible	O
with	O
f	O
(	O
13.4	O
)	O
,	O
h	O
=	O
a	O
−	O
e	O
(	O
cid:2	O
)	O
vt	O
,	O
parametrized	O
by	O
v.	O
the	O
problem	O
is	O
reduced	B
to	O
that	O
of	O
solving	O
for	O
v	O
from	O
the	O
three	O
point	B
correspondences	O
.	O
the	O
solution	B
may	O
be	O
obtained	O
as	O
:	O
result	O
13.6.	O
given	O
f	O
and	O
the	O
three	O
image	O
point	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
raphy	O
induced	O
by	O
the	O
plane	B
of	O
the	O
3d	O
points	O
is	O
h	O
=	O
a	O
−	O
e	O
(	O
cid:2	O
)	O
i	O
,	O
the	O
homog-	O
where	O
a	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
(	O
m−1b	O
)	O
t	O
,	O
]	O
×f	O
and	O
b	O
is	O
a	O
3-vector	O
with	O
components	O
)	O
/	O
(	O
cid:10	O
)	O
x	O
(	O
cid:2	O
)	O
×	O
(	O
axi	O
)	O
)	O
t	O
(	O
x	O
(	O
cid:2	O
)	O
bi	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
×	O
e	O
(	O
cid:2	O
)	O
i	O
i	O
×	O
e	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
2	O
,	O
i	O
and	O
m	O
is	O
a	O
3	O
×	O
3	O
matrix	B
with	O
rows	O
xt	O
i	O
.	O
proof	O
.	O
according	O
to	O
result	O
9.14	O
(	O
p256	O
)	O
,	O
f	O
may	O
be	O
decomposed	O
as	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
(	O
13.4	O
)	O
gives	O
h	O
=	O
a	O
−	O
e	O
(	O
cid:2	O
)	O
vt	O
,	O
and	O
each	O
correspondence	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
constraint	O
on	O
v	O
as	O
]	O
×a	O
.	O
then	O
i	O
generates	O
a	O
linear	B
from	O
(	O
13.5	O
)	O
the	O
vectors	O
x	O
(	O
cid:2	O
)	O
zero	O
:	O
×	O
(	O
axi	O
−	O
e	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
i	O
i	O
=	O
hxi	O
=	O
axi	O
−	O
e	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
i	O
and	O
axi	O
−	O
e	O
(	O
cid:2	O
)	O
(	O
vtxi	O
)	O
)	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
forming	O
the	O
scalar	O
product	O
with	O
the	O
vector	O
x	O
(	O
cid:2	O
)	O
(	O
13.5	O
)	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
(	O
vtxi	O
)	O
,	O
(	O
vtxi	O
)	O
are	O
parallel	B
,	O
so	O
their	O
vector	O
product	O
is	O
×	O
axi	O
)	O
−	O
(	O
x	O
(	O
cid:2	O
)	O
gives	O
×	O
e	O
(	O
cid:2	O
)	O
×	O
e	O
(	O
cid:2	O
)	O
)	O
)	O
(	O
vtxi	O
)	O
=0	O
.	O
×	O
e	O
(	O
cid:2	O
)	O
(	O
13.6	O
)	O
=	O
bi	O
)	O
i	O
×	O
e	O
(	O
cid:2	O
)	O
×	O
(	O
axi	O
)	O
)	O
t	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
x	O
(	O
cid:2	O
)	O
×	O
e	O
(	O
cid:2	O
)	O
)	O
t	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
i	O
i	O
i	O
i	O
xt	O
i	O
v	O
=	O
which	O
is	O
linear	B
in	O
v.	O
note	O
,	O
the	O
equation	O
is	O
independent	O
of	O
the	O
scale	O
of	O
x	O
(	O
cid:2	O
)	O
occurs	O
the	O
same	O
number	O
of	O
times	O
in	O
the	O
numerator	O
and	O
denominator	O
.	O
each	O
correspondence	B
generates	O
an	O
equation	O
xt	O
i	O
v	O
=	O
bi	O
,	O
and	O
collecting	O
these	O
together	O
we	O
have	O
mv	O
=	O
b.	O
,	O
since	O
x	O
(	O
cid:2	O
)	O
note	O
,	O
a	O
solution	B
can	O
not	O
be	O
obtained	O
if	O
mt	O
=	O
[	O
x1	O
,	O
x2	O
,	O
x3	O
]	O
is	O
not	O
of	O
full	O
rank	O
.	O
alge-	O
braically	O
,	O
det	O
m	O
=	O
0	O
if	O
the	O
three	O
image	O
points	O
xi	O
are	O
collinear	O
.	O
geometrically	O
,	O
three	O
collinear	O
image	O
points	O
arise	O
from	O
collinear	O
world	O
points	O
,	O
or	O
coplanar	O
world	O
points	O
where	O
the	O
plane	B
contains	O
the	O
ﬁrst	O
camera	B
centre	I
.	O
in	O
either	O
case	O
a	O
full	O
rank	O
homography	O
is	O
not	O
deﬁned	O
.	O
consistency	B
conditions	I
.	O
equation	O
(	O
13.5	O
)	O
is	O
equivalent	B
to	O
six	O
constraints	B
since	O
each	O
point	B
correspondence	O
places	O
two	O
constraints	O
on	O
a	O
homography	O
.	O
determining	B
v	O
requires	O
only	O
three	O
constraints	B
,	O
so	O
there	O
are	O
three	O
constraints	B
remaining	O
which	O
must	O
be	O
satisﬁed	O
for	O
a	O
valid	O
solution	B
.	O
these	O
constraints	B
are	O
obtained	O
by	O
taking	O
the	O
cross	B
product	I
of	O
(	O
13.5	O
)	O
with	O
e	O
(	O
cid:2	O
)	O
,	O
which	O
gives	O
e	O
(	O
cid:2	O
)	O
×	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
e	O
(	O
cid:2	O
)	O
×	O
axi	O
=	O
fxi	O
.	O
332	O
13	O
scene	O
planes	O
and	O
homographies	B
objective	O
given	O
f	O
and	O
three	O
point	B
correspondences	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
determine	O
the	O
homography	B
x	O
(	O
cid:1	O
)	O
=	O
hx	O
induced	O
by	O
the	O
plane	B
of	O
xi	O
.	O
algorithm	B
i	O
which	O
are	O
the	O
images	O
of	O
3d	O
points	O
xi	O
,	O
(	O
i	O
)	O
for	O
each	O
correspondence	B
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
i	O
compute	O
the	O
corrected	O
correspondence	B
ˆxi	O
↔	O
ˆx	O
(	O
cid:1	O
)	O
i	O
using	O
algorithm	O
12.1	O
(	O
p318	O
)	O
.	O
(	O
ii	O
)	O
choose	O
a	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×f	O
and	O
solve	O
linearly	O
for	O
v	O
from	O
mv	O
=	O
b	O
as	O
in	O
result	O
13.6	O
.	O
(	O
iii	O
)	O
then	O
h	O
=	O
a	O
−	O
e	O
(	O
cid:1	O
)	O
vt.	O
algorithm	B
13.1.	O
the	O
optimal	O
estimate	O
of	O
the	O
homography	O
induced	B
by	I
a	I
plane	I
deﬁned	O
by	O
three	O
points	O
.	O
i	O
=	O
fxi	O
is	O
a	O
consistency	O
constraint	O
between	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
the	O
equation	O
e	O
(	O
cid:2	O
)	O
×	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
since	O
it	O
is	O
independent	O
of	O
v.	O
it	O
is	O
simply	O
a	O
(	O
disguised	O
)	O
epipolar	B
constraint	O
on	O
the	O
correspon-	O
dence	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
and	O
the	O
rhs	O
is	O
fxi	O
which	O
is	O
the	O
epipolar	B
line	I
for	O
xi	O
in	O
the	O
second	O
image	O
,	O
i.e	O
.	O
the	O
equation	O
enforces	O
that	O
x	O
(	O
cid:2	O
)	O
i	O
lie	O
on	O
the	O
epipolar	B
line	I
of	O
xi	O
,	O
and	O
hence	O
the	O
correspondence	B
is	O
consistent	O
with	O
the	O
epipolar	B
geometry	O
.	O
i	O
:	O
the	O
lhs	O
is	O
the	O
epipolar	B
line	I
through	O
x	O
(	O
cid:2	O
)	O
estimation	B
from	O
noisy	O
points	O
.	O
the	O
three	O
point	B
correspondences	O
which	O
determine	O
the	O
plane	B
and	O
homography	B
must	O
satisfy	O
the	O
consistency	O
constraint	O
arising	O
from	O
the	O
epipo-	O
lar	O
geometry	O
.	O
generally	O
measured	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
will	O
not	O
exactly	O
satisfy	O
this	O
constraint	O
.	O
we	O
therefore	O
require	O
a	O
procedure	O
for	O
optimally	O
correcting	O
the	O
measured	O
points	O
so	O
that	O
the	O
estimated	O
points	O
ˆxi	O
↔	O
ˆx	O
(	O
cid:2	O
)	O
i	O
satisfy	O
the	O
epipolar	B
constraint	O
.	O
fortunately	O
,	O
such	O
a	O
procedure	O
has	O
already	O
been	O
given	O
in	O
the	O
triangulation	B
algorithm	O
12.1	O
(	O
p318	O
)	O
,	O
which	O
can	O
be	O
adopted	O
here	O
directly	O
.	O
we	O
then	O
have	O
a	O
maximum	O
likelihood	O
estimate	O
of	O
h	O
and	O
the	O
3d	O
points	O
under	O
gaussian	O
image	O
noise	O
assumptions	O
.	O
the	O
method	O
is	O
summa-	O
rized	O
in	O
algorithm	O
13.1	O
.	O
13.2.2	O
a	O
point	O
and	O
line	O
in	O
this	O
section	O
an	O
expression	O
is	O
derived	O
for	O
a	O
plane	O
speciﬁed	O
by	O
a	O
point	O
and	O
line	O
corre-	O
spondence	O
.	O
we	O
start	O
by	O
considering	O
only	O
the	O
line	B
correspondence	O
and	O
show	O
that	O
this	O
reduces	O
the	O
three-parameter	O
family	O
of	O
homographies	O
compatible	O
with	O
f	O
(	O
13.4	O
)	O
to	O
a	O
1-	O
parameter	O
family	O
.	O
it	O
is	O
then	O
shown	O
that	O
the	O
point	B
correspondence	O
uniquely	O
determines	O
the	O
plane	B
and	O
corresponding	O
homography	B
.	O
the	O
correspondence	B
of	O
two	O
image	O
lines	B
determines	O
a	O
line	B
in	O
3-space	O
,	O
and	O
a	O
line	B
in	O
3-space	O
lies	O
on	O
a	O
one	O
parameter	O
family	O
(	O
a	O
pencil	O
)	O
of	O
planes	O
,	O
see	O
ﬁgure	O
13.4.	O
this	O
pencil	O
of	O
planes	O
induces	O
a	O
pencil	O
of	O
homographies	O
between	O
the	O
two	O
images	O
,	O
and	O
any	O
member	O
of	O
this	O
family	O
will	O
map	O
the	O
corresponding	O
lines	B
to	O
each	O
other	O
.	O
result	O
13.7.	O
the	O
homography	B
for	O
the	O
pencil	O
of	O
planes	O
deﬁned	O
by	O
a	O
line	B
correspondence	O
l	O
↔	O
l	O
(	O
cid:2	O
)	O
is	O
given	O
by	O
]	O
×f	O
+	O
µe	O
(	O
cid:2	O
)	O
lt	O
provided	O
l	O
(	O
cid:2	O
)	O
te	O
(	O
cid:2	O
)	O
(	O
cid:5	O
)	O
=	O
0	O
,	O
where	O
µ	O
is	O
a	O
projective	B
parameter	O
.	O
h	O
(	O
µ	O
)	O
=	O
[	O
l	O
(	O
cid:2	O
)	O
(	O
13.7	O
)	O
13.2	O
plane	O
induced	O
homographies	O
given	O
f	O
and	O
image	O
correspondences	O
(	O
µ	O
)	O
l	O
π	O
l	O
e	O
c	O
π	O
π	O
/	O
/l	O
/	O
e	O
/	O
c	O
c	O
a	O
l	O
e	O
l	O
b	O
333	O
/l	O
/	O
e	O
/	O
c	O
fig	O
.	O
13.4	O
.	O
(	O
a	O
)	O
image	O
lines	O
l	O
and	O
l	O
(	O
cid:1	O
)	O
respectively	O
.	O
the	O
intersection	B
of	O
these	O
planes	O
deﬁnes	O
the	O
line	B
l	O
in	O
3-space	O
.	O
(	O
b	O
)	O
the	O
line	B
l	O
in	O
3-space	O
is	O
contained	O
in	O
a	O
one	O
parameter	O
family	O
of	O
planes	O
π	O
(	O
µ	O
)	O
.	O
this	O
family	O
of	O
planes	O
induces	O
a	O
one	O
parameter	O
family	O
of	O
homographies	O
between	O
the	O
images	O
.	O
determine	O
planes	O
π	O
and	O
π	O
(	O
cid:1	O
)	O
proof	O
.	O
from	O
result	O
8.2	O
(	O
p197	O
)	O
the	O
line	B
l	O
back-projects	O
to	O
a	O
plane	B
ptl	O
through	O
the	O
ﬁrst	O
camera	B
centre	I
,	O
and	O
l	O
(	O
cid:2	O
)	O
through	O
the	O
second	O
,	O
see	O
ﬁgure	O
13.4a	O
.	O
these	O
two	O
planes	O
are	O
the	O
basis	O
for	O
a	O
pencil	O
of	O
planes	O
parametrized	O
by	O
µ.	O
as	O
in	O
the	O
proof	O
of	O
result	O
13.3	O
we	O
may	O
choose	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:20	O
)	O
back-projects	O
to	O
a	O
plane	B
p	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
=	O
[	O
a	O
|	O
e	O
(	O
cid:2	O
)	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
π	O
(	O
µ	O
)	O
=	O
µptl	O
+	O
p	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
]	O
,	O
then	O
the	O
pencil	O
of	O
planes	O
is	O
(	O
cid:21	O
)	O
=	O
µ	O
+	O
l	O
0	O
atl	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
from	O
result	O
13.1	O
the	O
induced	O
homography	O
is	O
h	O
(	O
µ	O
)	O
=a	O
−	O
e	O
(	O
cid:2	O
)	O
v	O
(	O
µ	O
)	O
t	O
,	O
with	O
(	O
cid:15	O
)	O
=	O
−	O
using	O
the	O
decomposition	B
a	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
h	O
=	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
e	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
i	O
−	O
e	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
t	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×f	O
+	O
µe	O
(	O
cid:2	O
)	O
lt	O
[	O
l	O
(	O
cid:2	O
)	O
]	O
×f	O
−	O
µe	O
(	O
cid:2	O
)	O
lt	O
/	O
(	O
e	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
)	O
v	O
(	O
µ	O
)	O
=	O
(	O
µl	O
+	O
atl	O
(	O
cid:2	O
)	O
]	O
×f	O
we	O
obtain	O
/	O
(	O
e	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
(	O
cid:16	O
)	O
)	O
/	O
(	O
e	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
(	O
cid:15	O
)	O
)	O
=	O
−	O
)	O
(	O
cid:16	O
)	O
(	O
13.8	O
)	O
/	O
(	O
e	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
)	O
]	O
×	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×f	O
+	O
µe	O
(	O
cid:2	O
)	O
lt	O
[	O
l	O
(	O
cid:2	O
)	O
where	O
the	O
last	O
equality	O
follows	O
from	O
result	O
a4.4	O
(	O
p582	O
)	O
that	O
[	O
e	O
(	O
cid:2	O
)	O
equivalent	B
to	O
(	O
13.7	O
)	O
up	O
to	O
scale	O
.	O
]	O
×	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×f	O
=	O
f.	O
this	O
is	O
the	O
homography	B
for	O
a	O
corresponding	O
point	O
and	O
line	O
.	O
from	O
the	O
line	B
correspondence	O
we	O
have	O
that	O
h	O
(	O
µ	O
)	O
=	O
[	O
l	O
(	O
cid:2	O
)	O
]	O
×f+µe	O
(	O
cid:2	O
)	O
lt	O
,	O
and	O
now	O
solve	O
for	O
µ	O
using	O
the	O
point	B
correspondence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
result	O
13.8.	O
given	O
f	O
and	O
a	O
corresponding	O
point	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
phy	O
induced	O
by	O
the	O
plane	B
of	O
the	O
3-space	O
point	O
and	O
line	O
is	O
and	O
line	B
l	O
↔	O
l	O
(	O
cid:2	O
)	O
,	O
the	O
homogra-	O
.	O
h	O
=	O
[	O
l	O
(	O
cid:2	O
)	O
]	O
×f	O
+	O
(	O
x	O
(	O
cid:2	O
)	O
×	O
e	O
(	O
cid:2	O
)	O
t	O
(	O
x	O
(	O
cid:2	O
)	O
×	O
(	O
(	O
fx	O
)	O
×	O
l	O
(	O
cid:2	O
)	O
)	O
(	O
cid:10	O
)	O
x	O
(	O
cid:2	O
)	O
×	O
e	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
2	O
(	O
ltx	O
)	O
)	O
)	O
e	O
(	O
cid:2	O
)	O
lt.	O
the	O
derivation	B
is	O
analogous	O
to	O
that	O
of	O
result	O
13.6.	O
as	O
in	O
the	O
three-point	O
case	O
,	O
the	O
im-	O
age	O
point	B
correspondence	O
must	O
be	O
consistent	O
with	O
the	O
epipolar	B
geometry	O
.	O
this	O
means	O
334	O
13	O
scene	O
planes	O
and	O
homographies	B
l	O
l	O
e	O
x	O
e	O
/	O
e	O
/	O
l	O
x/	O
/	O
l	O
e	O
image	O
1	O
image	O
2	O
fig	O
.	O
13.5.	O
the	O
epipolar	B
geometry	O
induces	O
a	O
homography	B
between	O
corresponding	O
lines	B
l	O
↔	O
l	O
(	O
cid:1	O
)	O
the	O
images	O
of	O
a	O
line	O
l	O
in	O
3-space	O
.	O
the	O
points	O
on	O
l	O
are	O
mapped	O
to	O
points	O
on	O
l	O
(	O
cid:1	O
)	O
and	O
x	O
(	O
cid:1	O
)	O
are	O
the	O
images	O
of	O
the	O
intersection	O
of	O
l	O
with	O
the	O
epipolar	B
plane	O
corresponding	O
to	O
le	O
and	O
l	O
(	O
cid:1	O
)	O
e.	O
which	O
are	O
as	O
x	O
(	O
cid:1	O
)	O
=	O
[	O
l	O
(	O
cid:1	O
)	O
]	O
×fx	O
,	O
where	O
x	O
that	O
the	O
measured	O
(	O
noisy	O
)	O
points	O
must	O
be	O
corrected	O
using	O
algorithm	O
12.1	O
(	O
p318	O
)	O
be-	O
fore	O
result	O
13.8	O
is	O
applied	O
.	O
there	O
is	O
no	O
consistency	O
constraint	O
on	O
the	O
line	B
,	O
and	O
no	O
cor-	O
rection	O
is	O
available	O
.	O
geometric	B
interpretation	I
of	O
the	O
point	B
map	O
h	O
(	O
µ	O
)	O
.	O
it	O
is	O
worth	O
exploring	O
the	O
map	O
h	O
(	O
µ	O
)	O
further	O
.	O
since	O
h	O
(	O
µ	O
)	O
is	O
compatible	O
with	O
the	O
epipolar	B
geometry	O
,	O
a	O
point	B
x	O
in	O
the	O
ﬁrst	O
view	O
is	O
mapped	O
to	O
a	O
point	B
x	O
(	O
cid:2	O
)	O
=	O
h	O
(	O
µ	O
)	O
x	O
in	O
the	O
second	O
view	O
on	O
the	O
epipolar	B
line	I
fx	O
corresponding	O
to	O
x.	O
in	O
general	O
the	O
position	O
of	O
the	O
point	O
x	O
(	O
cid:2	O
)	O
=	O
h	O
(	O
µ	O
)	O
x	O
on	O
the	O
epipolar	B
line	I
varies	O
with	O
µ.	O
however	O
,	O
if	O
the	O
point	B
x	O
lies	O
on	O
l	O
(	O
so	O
that	O
ltx	O
=	O
0	O
)	O
then	O
x	O
(	O
cid:2	O
)	O
=	O
h	O
(	O
µ	O
)	O
x	O
=	O
(	O
[	O
l	O
(	O
cid:2	O
)	O
]	O
×f	O
+	O
µe	O
(	O
cid:2	O
)	O
lt	O
)	O
x	O
=	O
[	O
l	O
(	O
cid:2	O
)	O
]	O
×fx	O
which	O
is	O
independent	O
of	O
the	O
value	O
of	O
µ	O
,	O
depending	O
only	O
on	O
f.	O
thus	O
as	O
shown	O
in	O
ﬁgure	O
13.5	O
the	O
epipolar	B
geometry	O
deﬁnes	O
a	O
point-to-point	O
map	O
for	O
points	O
on	O
the	O
line	B
.	O
degenerate	B
homographies	I
.	O
as	O
has	O
already	O
been	O
stated	O
,	O
if	O
the	O
world	O
plane	B
contains	O
one	O
of	O
the	O
camera	O
centres	O
,	O
then	O
the	O
induced	O
homography	O
is	O
degenerate	B
.	O
the	O
matrix	B
representing	O
the	O
homography	B
does	O
not	O
have	O
full	O
rank	O
,	O
and	O
points	O
on	O
one	O
plane	B
are	O
mapped	O
to	O
a	O
line	B
(	O
if	O
rank	O
h	O
=	O
2	O
)	O
or	O
a	O
point	B
(	O
if	O
rank	O
h	O
=	O
1	O
)	O
.	O
however	O
,	O
an	O
explicit	O
expression	O
can	O
be	O
obtained	O
for	O
a	O
degenerate	O
homography	B
from	O
(	O
13.7	O
)	O
.	O
the	O
degenerate	B
(	O
singular	O
)	O
homographies	B
in	O
this	O
pencil	O
are	O
at	O
µ	O
=	O
∞	O
and	O
µ	O
=	O
0.	O
these	O
correspond	O
to	O
planes	O
through	O
the	O
ﬁrst	O
and	O
second	O
camera	B
centres	O
respectively	O
.	O
figure	O
13.6	O
shows	O
the	O
case	O
where	O
the	O
plane	B
contains	O
the	O
second	O
camera	B
centre	I
,	O
and	O
intersects	O
the	O
image	B
plane	I
in	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
at	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
where	O
.	O
a	O
point	B
x	O
in	O
the	O
ﬁrst	O
view	O
is	O
imaged	O
on	O
l	O
(	O
cid:2	O
)	O
]	O
×fx	O
.	O
=	O
l	O
(	O
cid:2	O
)	O
×	O
fx	O
=	O
[	O
l	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
]	O
×f	O
.	O
this	O
is	O
a	O
rank	O
2	O
matrix	B
.	O
the	O
homography	B
is	O
thus	O
h	O
=	O
[	O
l	O
(	O
cid:2	O
)	O
13.3	O
computing	B
f	O
given	O
the	O
homography	B
induced	O
by	O
a	O
plane	B
up	O
to	O
now	O
it	O
has	O
been	O
assumed	O
that	O
f	O
is	O
given	O
,	O
and	O
the	O
objective	O
is	O
to	O
compute	O
h	O
when	O
various	O
additional	O
information	O
is	O
provided	O
.	O
we	O
now	O
reverse	O
this	O
,	O
and	O
show	O
that	O
if	O
h	O
is	O
given	O
then	O
f	O
may	O
be	O
computed	O
when	O
additional	O
information	O
is	O
provided	O
.	O
we	O
start	O
by	O
introducing	O
an	O
important	O
geometric	B
idea	O
,	O
that	O
of	O
parallax	O
relative	O
to	O
a	O
plane	B
,	O
which	O
will	O
make	O
the	O
algebraic	B
development	O
straightforward	O
.	O
13.3	O
computing	B
f	O
given	O
the	O
homography	B
induced	O
by	O
a	O
plane	B
335	O
/	O
π	O
x	O
/	O
l	O
/	O
x	O
x	O
c	O
/	O
c	O
c	O
x	O
e	O
/	O
l	O
/	O
x	O
e	O
/	O
fx	O
/	O
c	O
a	O
b	O
fig	O
.	O
13.6.	O
a	O
degenerate	B
homography	O
.	O
(	O
a	O
)	O
the	O
map	O
induced	B
by	I
a	I
plane	I
through	O
the	O
second	O
camera	B
centre	I
is	O
a	O
degenerate	B
homography	O
h	O
=	O
[	O
l	O
(	O
cid:1	O
)	O
]	O
×f	O
.	O
the	O
plane	B
π	O
(	O
cid:1	O
)	O
intersects	O
the	O
second	O
image	B
plane	I
in	O
the	O
line	B
l	O
(	O
cid:1	O
)	O
in	O
the	O
second	O
.	O
(	O
b	O
)	O
a	O
point	B
x	O
in	O
the	O
ﬁrst	O
view	O
is	O
imaged	O
at	O
x	O
(	O
cid:1	O
)	O
with	O
the	O
epipolar	B
line	I
fx	O
of	O
x	O
,	O
so	O
that	O
x	O
(	O
cid:1	O
)	O
=	O
l	O
(	O
cid:1	O
)	O
×	O
fx	O
.	O
.	O
all	O
points	O
in	O
the	O
ﬁrst	O
view	O
are	O
mapped	O
to	O
points	O
on	O
l	O
(	O
cid:1	O
)	O
,	O
the	O
intersection	B
of	O
l	O
(	O
cid:1	O
)	O
x	O
π	O
xπ	O
x	O
h	O
l	O
/	O
x	O
/x	O
/x	O
c	O
e	O
/	O
e	O
/	O
c	O
fig	O
.	O
13.7.	O
plane	B
induced	I
parallax	I
.	O
the	O
ray	O
through	O
x	O
intersects	O
the	O
plane	B
π	O
at	O
the	O
point	B
xπ	O
.	O
the	O
images	O
of	O
x	O
and	O
xπ	O
are	O
coincident	O
points	O
at	O
x	O
in	O
the	O
ﬁrst	O
view	O
.	O
in	O
the	O
second	O
view	O
the	O
images	O
are	O
the	O
points	O
x	O
(	O
cid:1	O
)	O
=	O
hx	O
respectively	O
.	O
these	O
points	O
are	O
not	O
coincident	O
(	O
unless	O
x	O
is	O
on	O
π	O
)	O
,	O
but	O
both	O
are	O
on	O
the	O
epipolar	B
line	I
l	O
(	O
cid:1	O
)	O
is	O
the	O
parallax	B
relative	O
to	O
the	O
homography	B
induced	O
by	O
the	O
plane	B
π.	O
note	O
that	O
if	O
x	O
is	O
on	O
the	O
other	O
side	O
of	O
the	O
plane	O
,	O
then	O
˜x	O
(	O
cid:1	O
)	O
will	O
be	O
on	O
the	O
other	O
side	O
of	O
x	O
(	O
cid:1	O
)	O
x	O
of	O
x.	O
the	O
vector	O
between	O
the	O
points	O
x	O
(	O
cid:1	O
)	O
and	O
˜x	O
(	O
cid:1	O
)	O
.	O
and	O
˜x	O
(	O
cid:1	O
)	O
plane	B
induced	I
parallax	I
.	O
the	O
homography	B
induced	O
by	O
a	O
plane	B
generates	O
a	O
virtual	O
par-	O
allax	O
(	O
see	O
section	O
8.4.5	O
(	O
p207	O
)	O
)	O
as	O
illustrated	O
schematically	O
in	O
ﬁgure	O
13.7	O
and	O
by	O
exam-	O
ple	O
in	O
ﬁgure	O
13.8.	O
the	O
important	O
point	B
here	O
is	O
that	O
in	O
the	O
second	O
view	O
x	O
(	O
cid:2	O
)	O
,	O
the	O
image	O
of	O
the	O
3d	O
point	B
x	O
,	O
and	O
˜x	O
(	O
cid:2	O
)	O
=	O
hx	O
,	O
the	O
point	B
mapped	O
by	O
the	O
homography	B
,	O
are	O
on	O
the	O
epipolar	B
line	I
of	O
x	O
;	O
since	O
both	O
are	O
images	O
of	B
points	I
on	O
the	O
ray	O
through	O
x.	O
consequently	O
,	O
the	O
line	B
x	O
(	O
cid:2	O
)	O
×	O
(	O
hx	O
)	O
is	O
an	O
epipolar	B
line	I
in	O
the	O
second	O
view	O
and	O
provides	O
a	O
constraint	O
on	O
the	O
position	O
of	O
the	O
epipole	O
.	O
once	O
the	O
epipole	O
is	O
determined	O
(	O
two	O
such	O
constraints	B
sufﬁce	O
)	O
,	O
then	O
as	O
shown	O
in	O
result	O
9.1	O
(	O
p243	O
)	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×h	O
where	O
h	O
is	O
the	O
homography	B
induced	O
by	O
any	O
plane	B
.	O
similarly	O
it	O
can	O
be	O
shown	O
that	O
f	O
=	O
h−t	O
[	O
e	O
]	O
×	O
.	O
as	O
an	O
application	O
of	O
virtual	O
parallax	B
it	O
is	O
shown	O
in	O
algorithm	O
13.2	O
that	O
f	O
can	O
be	O
computed	O
uniquely	O
from	O
the	O
images	O
of	O
six	O
points	O
,	O
four	O
of	O
which	O
are	O
coplanar	O
and	O
two	O
are	O
off	O
the	O
plane	B
.	O
the	O
images	O
of	O
the	O
four	O
coplanar	O
points	O
deﬁne	O
the	O
homography	B
,	O
and	O
the	O
two	O
points	O
off	O
the	O
plane	B
provide	O
constraints	B
sufﬁcient	O
to	O
determine	O
the	O
epipole	O
.	O
the	O
336	O
13	O
scene	O
planes	O
and	O
homographies	B
a	O
b	O
c	O
fig	O
.	O
13.8.	O
plane	B
induced	I
parallax	I
.	O
(	O
a	O
)	O
(	O
b	O
)	O
left	O
and	O
right	O
images	O
.	O
(	O
c	O
)	O
the	O
left	O
image	O
is	O
superimposed	O
on	O
the	O
right	O
using	O
the	O
homography	B
induced	O
by	O
the	O
plane	B
of	O
the	O
chinese	O
text	O
.	O
the	O
transferred	O
and	O
imaged	O
planes	O
exactly	O
coincide	O
.	O
however	O
,	O
points	O
off	O
the	O
plane	B
(	O
such	O
as	O
the	O
mug	O
)	O
do	O
not	O
coincide	O
.	O
lines	B
joining	O
corresponding	O
points	O
off	O
the	O
plane	B
in	O
the	O
“	O
superimposed	O
”	O
image	O
intersect	O
at	O
the	O
epipole	O
.	O
six-point	O
result	O
is	O
quite	O
surprising	O
since	O
for	O
seven	O
points	O
in	O
general	B
position	I
there	O
are	O
3	O
solutions	O
for	O
f	O
(	O
see	O
section	O
11.1.2	O
(	O
p281	O
)	O
)	O
.	O
objective	O
given	O
six	O
point	B
correspondences	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
four	O
3-space	O
points	O
i	O
∈	O
{	O
1	O
,	O
.	O
.	O
.	O
,	O
4	O
}	O
coplanar	O
,	O
determine	O
the	O
fundamental	B
matrix	I
f.	O
algorithm	B
i	O
which	O
are	O
the	O
images	O
of	O
3-space	O
xi	O
,	O
with	O
the	O
ﬁrst	O
(	O
i	O
)	O
compute	O
the	O
homography	B
h	O
,	O
such	O
that	O
x	O
(	O
cid:1	O
)	O
(	O
ii	O
)	O
determine	O
the	O
epipole	O
e	O
(	O
cid:1	O
)	O
(	O
iii	O
)	O
then	O
f	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×h	O
.	O
i	O
=	O
hxi	O
,	O
i	O
∈	O
{	O
1	O
,	O
.	O
.	O
.	O
,	O
4	O
}	O
.	O
as	O
the	O
intersection	B
of	O
the	O
lines	B
(	O
hx5	O
)	O
×	O
x	O
(	O
cid:1	O
)	O
5	O
and	O
(	O
hx6	O
)	O
×	O
x	O
(	O
cid:1	O
)	O
6.	O
see	O
ﬁgure	O
13.9.	O
algorithm	B
13.2.	O
computing	B
f	O
given	O
the	O
correspondences	B
of	O
six	O
points	O
of	O
which	O
four	O
are	O
coplanar	O
.	O
x	O
2	O
x	O
1	O
π	O
x	O
3	O
x	O
4	O
x	O
2	O
x1	O
x	O
c	O
x	O
x	O
3	O
e	O
x	O
4	O
a	O
e/	O
x	O
/	O
3	O
x	O
/	O
4	O
/	O
c	O
x/	O
/	O
x2	O
x/	O
/	O
e	O
1x	O
/	O
/x	O
5	O
/x	O
5	O
/x	O
6	O
/x	O
6	O
b	O
fig	O
.	O
13.9.	O
the	O
fundamental	B
matrix	I
is	O
deﬁned	O
uniquely	O
by	O
the	O
image	O
of	O
six	O
3d	O
points	O
,	O
of	O
which	O
four	O
are	O
coplanar	O
.	O
(	O
a	O
)	O
the	O
parallax	B
for	O
one	O
point	B
x	O
.	O
(	O
b	O
)	O
the	O
epipole	O
determined	O
by	O
the	O
intersection	B
of	O
two	O
parallax	O
lines	B
:	O
the	O
line	B
joining	O
˜x	O
(	O
cid:1	O
)	O
5	O
,	O
and	O
the	O
join	O
of	O
˜x	O
(	O
cid:1	O
)	O
6	O
=	O
hx6	O
to	O
x	O
(	O
cid:1	O
)	O
6	O
.	O
5	O
=	O
hx5	O
to	O
x	O
(	O
cid:1	O
)	O
13.3	O
computing	B
f	O
given	O
the	O
homography	B
induced	O
by	O
a	O
plane	B
337	O
a	O
d	O
b	O
e	O
c	O
f	O
fig	O
.	O
13.10.	O
binary	O
space	O
partition	O
.	O
(	O
a	O
)	O
(	O
b	O
)	O
left	O
and	O
right	O
images	O
.	O
(	O
c	O
)	O
points	O
whose	O
correspondence	B
is	O
known	O
.	O
(	O
d	O
)	O
a	O
triplet	O
of	B
points	I
selected	O
from	O
(	O
c	O
)	O
.	O
this	O
triplet	O
deﬁnes	O
a	O
plane	B
.	O
the	O
points	O
in	O
(	O
c	O
)	O
can	O
then	O
be	O
classiﬁed	O
according	O
to	O
their	O
side	O
of	O
the	O
plane	O
.	O
(	O
e	O
)	O
points	O
on	O
one	O
side	O
.	O
(	O
f	O
)	O
points	O
on	O
the	O
other	O
side	O
.	O
projective	B
depth	I
.	O
a	O
world	O
point	B
x	O
=	O
(	O
xt	O
,	O
ρ	O
)	O
t	O
is	O
imaged	O
at	O
x	O
in	O
the	O
ﬁrst	O
view	O
and	O
at	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
+	O
ρe	O
(	O
cid:2	O
)	O
(	O
13.9	O
)	O
,	O
e	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
.	O
note	O
that	O
x	O
(	O
cid:2	O
)	O
and	O
hx	O
are	O
collinear	O
.	O
the	O
scalar	O
ρ	O
is	O
the	O
parallax	B
relative	O
to	O
the	O
homography	B
h	O
,	O
and	O
may	O
be	O
interpreted	O
as	O
a	O
“	O
depth	O
”	O
relative	O
to	O
the	O
plane	B
π.	O
if	O
ρ	O
=	O
0	O
then	O
the	O
3d	O
point	B
x	O
is	O
on	O
the	O
plane	B
,	O
otherwise	O
the	O
“	O
sign	O
”	O
of	O
ρ	O
indicates	O
which	O
‘	O
side	O
’	O
of	O
the	O
plane	O
π	O
the	O
point	B
x	O
is	O
(	O
see	O
ﬁgure	O
13.7	O
and	O
ﬁgure	O
13.8	O
)	O
.	O
these	O
statements	O
should	O
be	O
taken	O
with	O
care	O
because	O
in	O
the	O
absence	O
of	O
oriented	O
projective	B
geometry	O
the	O
sign	O
of	O
a	O
homogeneous	O
object	O
,	O
and	O
the	O
side	O
of	O
a	O
plane	O
have	O
no	O
meaning	O
.	O
example	O
13.9.	O
binary	O
space	O
partition	O
.	O
the	O
sign	O
of	O
the	O
virtual	O
parallax	B
(	O
sign	O
(	O
ρ	O
)	O
)	O
may	O
be	O
used	O
to	O
compute	O
a	O
partition	O
of	O
3-space	O
by	O
the	O
plane	B
π.	O
suppose	O
we	O
are	O
given	O
f	O
and	O
three	O
space	O
points	O
are	O
speciﬁed	O
by	O
their	O
corresponding	O
image	O
points	O
.	O
then	O
the	O
plane	B
deﬁned	O
by	O
the	O
three	O
points	O
can	O
be	O
used	O
to	O
partition	O
all	O
other	O
correspondences	B
into	O
sets	O
on	O
either	O
side	O
of	O
(	O
or	O
on	O
)	O
the	O
plane	B
.	O
figure	O
13.10	O
shows	O
an	O
example	O
.	O
note	O
,	O
the	O
three	O
points	O
need	O
not	O
actually	O
correspond	O
to	O
images	O
of	O
physical	O
points	O
so	O
the	O
method	O
can	O
be	O
applied	O
to	O
virtual	O
planes	O
.	O
by	O
combining	O
several	O
planes	O
a	O
region	O
of	O
3-space	O
can	O
be	O
(	O
cid:2	O
)	O
identiﬁed	O
.	O
two	O
planes	O
.	O
suppose	O
there	O
are	O
two	O
planes	O
,	O
π1	O
,	O
π2	O
,	O
in	O
the	O
scene	O
which	O
induce	O
ho-	O
mographies	O
h1	O
,	O
h2	O
respectively	O
.	O
with	O
the	O
idea	O
of	O
parallax	O
in	O
mind	O
it	O
is	O
clear	O
that	O
be-	O
cause	O
each	O
plane	B
provides	O
off-plane	O
information	O
about	O
the	O
other	O
,	O
the	O
two	O
homographies	O
338	O
13	O
scene	O
planes	O
and	O
homographies	B
π	O
1	O
x	O
2	O
x	O
1	O
π	O
2	O
x	O
hx	O
c	O
/	O
x	O
c	O
/	O
h	O
1	O
h	O
2	O
fig	O
.	O
13.11.	O
the	O
action	O
of	O
the	O
map	O
h	O
=	O
h−1	O
as	O
though	O
it	O
were	O
the	O
image	O
of	O
the	O
3d	O
point	B
x1	O
,	O
and	O
then	O
map	O
it	O
back	O
to	O
the	O
ﬁrst	O
image	O
as	O
though	O
it	O
were	O
the	O
image	O
of	O
the	O
3d	O
point	B
x2	O
.	O
points	O
in	O
the	O
ﬁrst	O
view	O
which	O
lie	O
on	O
the	O
imaged	O
line	B
of	O
intersection	B
of	O
the	O
two	O
planes	O
will	O
be	O
mapped	O
to	O
themselves	O
,	O
so	O
are	O
ﬁxed	B
points	I
under	O
this	O
action	O
.	O
the	O
epipole	O
e	O
is	O
also	O
a	O
ﬁxed	O
point	O
under	O
this	O
map	O
.	O
2	O
h1	O
on	O
a	O
point	O
x	O
in	O
the	O
ﬁrst	O
image	O
is	O
ﬁrst	O
to	O
transfer	O
it	O
to	O
x	O
(	O
cid:1	O
)	O
should	O
be	O
sufﬁcient	O
to	O
determine	O
f.	O
indeed	O
f	O
is	O
over-determined	B
by	O
this	O
conﬁguration	O
which	O
means	O
that	O
the	O
two	O
homographies	O
must	O
satisfy	O
consistency	O
constraints	O
.	O
consider	O
ﬁgure	O
13.11.	O
the	O
homography	B
h	O
=	O
h−1	O
h1	O
is	O
a	O
mapping	O
from	O
the	O
ﬁrst	O
image	O
onto	O
itself	O
.	O
under	O
this	O
mapping	O
the	O
epipole	O
e	O
is	O
a	O
ﬁxed	O
point	O
,	O
i.e	O
.	O
he	O
=	O
e	O
,	O
so	O
may	O
be	O
determined	O
from	O
the	O
(	O
non-degenerate	O
)	O
eigenvector	O
of	O
h.	O
the	O
fundamental	B
matrix	I
may	O
then	O
be	O
computed	O
from	O
result	O
9.1	O
(	O
p243	O
)	O
as	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
=	O
hie	O
for	O
i	O
=	O
1	O
or	O
2.	O
the	O
map	O
h	O
has	O
further	O
properties	B
which	O
may	O
be	O
seen	O
from	O
ﬁgure	O
13.11.	O
the	O
map	O
has	O
a	O
line	B
of	O
ﬁxed	B
points	I
and	O
a	O
ﬁxed	O
point	O
not	O
on	O
the	O
line	B
(	O
see	O
section	O
2.9	O
(	O
p61	O
)	O
for	O
ﬁxed	O
points	O
and	O
lines	B
)	O
.	O
this	O
means	O
that	O
two	O
of	O
the	O
eigenvalues	O
of	O
h	O
are	O
equal	O
.	O
in	O
fact	O
h	O
is	O
a	O
planar	B
homology	I
(	O
see	O
section	O
a7.2	O
(	O
p629	O
)	O
)	O
.	O
in	O
turn	O
,	O
these	O
properties	B
of	O
h	O
=	O
h−1	O
h1	O
deﬁne	O
consistency	O
constraints	O
on	O
h1	O
and	O
h2	O
in	O
order	O
that	O
their	O
composition	O
has	O
these	O
properties	B
.	O
2	O
2	O
]	O
×hi	O
,	O
where	O
e	O
(	O
cid:2	O
)	O
up	O
to	O
this	O
point	B
the	O
results	O
of	O
this	O
chapter	O
have	O
been	O
entirely	O
projective	B
.	O
now	O
an	O
afﬁne	B
element	O
is	O
introduced	O
.	O
13.4	O
the	O
inﬁnite	B
homography	I
h∞	O
the	O
plane	O
at	O
inﬁnity	O
is	O
a	O
particularly	O
important	O
plane	B
,	O
and	O
the	O
homography	B
induced	O
by	O
this	O
plane	B
is	O
distinguished	O
by	O
a	O
special	O
name	O
:	O
deﬁnition	B
13.10.	O
the	O
inﬁnite	B
homography	I
,	O
h∞	O
,	O
is	O
the	O
homography	B
induced	O
by	O
the	O
plane	O
at	O
inﬁnity	O
,	O
π∞	O
.	O
the	O
form	B
of	I
the	O
homography	B
may	O
be	O
derived	O
by	O
a	O
limiting	O
process	O
starting	O
from	O
(	O
13.2–	O
p327	O
)	O
,	O
h	O
=	O
k	O
(	O
cid:2	O
)	O
k−1	O
,	O
where	O
d	O
is	O
the	O
orthogonal	B
distance	O
of	O
the	O
plane	O
from	O
(	O
cid:15	O
)	O
r	O
−	O
tnt/d	O
(	O
cid:16	O
)	O
13.4	O
the	O
inﬁnite	B
homography	I
h∞	O
339	O
v1	O
h	O
v	O
/	O
1	O
v2	O
image	O
1	O
h	O
image	O
2	O
fig	O
.	O
13.12.	O
the	O
inﬁnite	B
homography	I
h∞	O
maps	O
vanishing	B
points	I
between	O
the	O
images	O
.	O
/v	O
2	O
the	O
ﬁrst	O
camera	B
:	O
h∞	O
=	O
lim	O
d→∞	O
h	O
=	O
k	O
(	O
cid:2	O
)	O
rk−1	O
.	O
this	O
means	O
that	O
h∞	O
does	O
not	O
depend	O
on	O
the	O
translation	O
between	O
views	O
,	O
only	O
on	O
the	O
rotation	O
and	O
camera	O
internal	B
parameters	I
.	O
alternatively	O
,	O
from	O
(	O
9.7–p250	O
)	O
corresponding	O
image	O
points	O
are	O
related	O
as	O
x	O
(	O
cid:2	O
)	O
=	O
k	O
(	O
cid:2	O
)	O
rk−1x	O
+	O
k	O
(	O
cid:2	O
)	O
t/z	O
=	O
h∞x	O
+	O
k	O
(	O
cid:2	O
)	O
t/z	O
(	O
13.10	O
)	O
where	O
z	O
is	O
the	O
depth	O
measured	O
from	O
the	O
ﬁrst	O
camera	B
.	O
again	O
it	O
can	O
be	O
seen	O
that	O
points	O
at	O
inﬁnity	O
(	O
z	O
=	O
∞	O
)	O
are	O
mapped	O
by	O
h∞	O
.	O
note	O
also	O
that	O
h∞	O
is	O
obtained	O
if	O
the	O
translation	O
t	O
is	O
zero	O
in	O
(	O
13.10	O
)	O
,	O
which	O
corresponds	O
to	O
a	O
rotation	B
about	O
the	O
camera	B
centre	I
.	O
thus	O
h∞	O
is	O
the	O
homography	B
that	O
relates	O
image	O
points	O
of	O
any	O
depth	O
if	O
the	O
camera	B
rotates	O
about	O
its	O
centre	B
(	O
see	O
section	O
8.4	O
(	O
p202	O
)	O
)	O
.	O
since	O
e	O
(	O
cid:2	O
)	O
=	O
k	O
(	O
cid:2	O
)	O
t	O
,	O
(	O
13.10	O
)	O
can	O
be	O
written	O
as	O
x	O
(	O
cid:2	O
)	O
/z	O
,	O
and	O
comparison	O
with	O
(	O
13.9	O
)	O
shows	O
that	O
(	O
1/z	O
)	O
plays	O
the	O
role	O
of	O
ρ.	O
thus	O
euclidean	O
inverse	O
depth	O
can	O
be	O
interpreted	O
as	O
parallax	O
relative	O
to	O
π∞	O
.	O
=	O
h∞x	O
+	O
e	O
(	O
cid:2	O
)	O
vanishing	B
points	I
and	O
lines	B
.	O
images	O
of	B
points	I
on	O
π∞	O
are	O
mapped	O
by	O
h∞	O
.	O
these	O
images	O
are	O
vanishing	B
points	I
,	O
and	O
so	O
h∞	O
maps	O
vanishing	B
points	I
between	O
images	O
,	O
i.e	O
.	O
v	O
(	O
cid:2	O
)	O
=	O
h∞v	O
,	O
where	O
v	O
(	O
cid:2	O
)	O
and	O
v	O
are	O
corresponding	O
vanishing	B
points	I
.	O
see	O
ﬁgure	O
13.12.	O
consequently	O
,	O
h∞	O
can	O
be	O
computed	O
from	O
the	O
correspondence	B
of	O
three	O
(	O
non-collinear	O
)	O
vanishing	B
points	I
together	O
with	O
f	O
using	O
result	O
13.6.	O
alternatively	O
,	O
h∞	O
can	O
be	O
computed	O
from	O
the	O
corre-	O
spondence	O
of	O
a	O
vanishing	O
line	B
and	O
the	O
correspondence	B
of	O
a	O
vanishing	O
point	O
(	O
not	O
on	O
the	O
line	B
)	O
,	O
together	O
with	O
f	O
,	O
as	O
described	O
in	O
section	O
13.2.2.	O
afﬁne	B
and	O
metric	B
reconstruction	I
.	O
as	O
we	O
have	O
seen	O
in	O
chapter	O
10	O
,	O
specifying	O
π∞	O
enables	O
a	O
projective	B
reconstruction	I
to	O
be	O
upgraded	O
to	O
an	O
afﬁne	B
reconstruction	I
.	O
not	O
surprisingly	O
,	O
because	O
of	O
its	O
association	O
with	O
π∞	O
,	O
h∞	O
arises	O
naturally	O
in	O
the	O
rectiﬁcation	O
.	O
indeed	O
,	O
if	O
the	O
camera	B
matrices	I
are	O
chosen	O
as	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
]	O
then	O
the	O
reconstruction	B
is	O
afﬁne	B
.	O
=	O
[	O
h∞	O
|	O
λe	O
(	O
cid:2	O
)	O
conversely	O
,	O
suppose	O
the	O
world	O
coordinate	O
system	O
is	O
afﬁne	B
(	O
i.e	O
.	O
π∞	O
has	O
its	O
canonical	O
position	O
at	O
π∞	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
)	O
;	O
then	O
h∞	O
may	O
be	O
determined	O
directly	O
from	O
the	O
camera	B
projection	O
matrices	O
.	O
suppose	O
m	O
,	O
m	O
(	O
cid:2	O
)	O
respectively	O
.	O
are	O
the	O
ﬁrst	O
3×	O
3	O
submatrix	O
of	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
340	O
13	O
scene	O
planes	O
and	O
homographies	B
π	O
x	O
x	O
e	O
c	O
correspondence	B
on	O
this	O
segment	O
h	O
x	O
/	O
/e	O
/	O
c	O
fig	O
.	O
13.13.	O
reducing	O
the	O
search	O
region	O
using	O
h∞	O
.	O
points	O
in	O
3-space	O
are	O
no	O
‘	O
further	O
’	O
away	O
than	O
π∞	O
.	O
h∞	O
captures	O
this	O
constraint	O
and	O
limits	O
the	O
search	O
on	O
the	O
epipolar	B
line	I
in	O
one	O
direction	O
.	O
the	O
baseline	O
between	O
the	O
cameras	B
partitions	O
each	O
epipolar	B
plane	O
into	O
two	O
.	O
a	O
point	B
on	O
one	O
“	O
side	O
”	O
of	O
the	O
epipolar	O
line	B
in	O
the	O
left	O
image	O
will	O
be	O
imaged	O
on	O
the	O
corresponding	O
“	O
side	O
”	O
of	O
the	O
epipolar	O
line	B
in	O
the	O
right	O
image	O
(	O
indicated	O
by	O
the	O
solid	O
line	B
in	O
the	O
ﬁgure	O
)	O
.	O
the	O
epipole	O
thus	O
bounds	O
the	O
search	O
region	O
in	O
the	O
other	O
direction	O
.	O
then	O
a	O
point	B
x	O
=	O
(	O
xt∞	O
,	O
0	O
)	O
t	O
on	O
π∞	O
is	O
imaged	O
at	O
x	O
=	O
px	O
=	O
mx∞	O
and	O
x	O
(	O
cid:2	O
)	O
in	O
the	O
two	B
views	I
.	O
consequently	O
x	O
(	O
cid:2	O
)	O
=	O
m	O
(	O
cid:2	O
)	O
m−1x	O
and	O
so	O
h∞	O
=	O
m	O
(	O
cid:2	O
)	O
m−1	O
.	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
=	O
m	O
(	O
cid:2	O
)	O
x∞	O
(	O
13.11	O
)	O
the	O
homography	B
h∞	O
may	O
be	O
used	O
to	O
propagate	O
camera	B
calibration	I
from	O
one	O
view	O
to	O
another	O
.	O
the	O
absolute	O
conic	O
ω∞	O
resides	O
on	O
π∞	O
,	O
and	O
its	O
image	O
,	O
ω	O
,	O
is	O
mapped	O
between	O
images	O
by	O
h∞	O
according	O
to	O
result	O
2.13	O
(	O
p37	O
)	O
:	O
ω	O
(	O
cid:2	O
)	O
−1	O
is	O
speciﬁed	O
in	O
one	O
view	O
,	O
then	O
ω	O
(	O
cid:2	O
)	O
,	O
the	O
image	O
of	O
ω∞	O
in	O
a	O
second	O
view	O
,	O
can	O
be	O
computed	O
via	O
h∞	O
,	O
and	O
the	O
calibration	B
for	O
that	O
view	O
determined	O
from	O
ω	O
(	O
cid:2	O
)	O
−1	O
.	O
section	O
19.5.2	O
(	O
p475	O
)	O
describes	O
applications	O
of	O
h∞	O
to	O
camera	O
auto-calibration	B
.	O
=	O
h−t∞	O
ωh−1∞	O
.	O
thus	O
if	O
ω	O
=	O
(	O
kkt	O
)	O
=	O
(	O
k	O
(	O
cid:2	O
)	O
k	O
(	O
cid:2	O
)	O
t	O
)	O
stereo	B
correspondence	I
.	O
h∞	O
limits	O
the	O
search	O
region	O
when	O
searching	O
for	O
correspon-	O
dences	O
.	O
the	O
region	O
is	O
reduced	B
from	O
the	O
entire	O
epipolar	B
line	I
to	O
a	O
bounded	O
line	B
.	O
see	O
ﬁgure	O
13.13.	O
however	O
,	O
a	O
correct	O
application	O
of	O
this	O
constraint	O
requires	O
oriented	O
projective	B
geometry	O
.	O
13.5	O
closure	O
this	O
chapter	O
has	O
illustrated	O
a	O
raft	O
of	O
projective	O
techniques	O
for	O
a	O
plane	O
that	O
may	O
be	O
ap-	O
plied	O
to	O
many	O
other	O
surfaces	O
.	O
a	O
plane	B
is	O
a	O
simple	O
parametrized	O
surface	O
with	O
3	O
degrees	B
of	I
freedom	I
.	O
a	O
very	O
similar	O
development	O
can	O
be	O
given	O
for	O
other	O
surfaces	O
where	O
the	O
degrees	B
of	I
freedom	I
are	O
determined	O
from	O
images	O
of	B
points	I
on	O
the	O
surface	O
.	O
for	O
exam-	O
ple	O
in	O
the	O
case	O
of	O
a	O
quadric	O
the	O
surface	O
can	O
be	O
determined	O
both	O
from	O
images	O
of	B
points	I
on	O
its	O
surface	O
,	O
and/or	O
(	O
an	O
extension	O
not	O
possible	O
for	O
planes	O
)	O
from	O
its	O
outline	O
in	O
each	O
view	O
[	O
cross-98	O
,	O
shashua-97	O
]	O
.	O
the	O
ideas	O
of	O
surface	O
induced	O
transfer	O
,	O
families	O
of	O
sur-	O
faces	O
when	O
the	O
surface	O
is	O
not	O
fully	O
determined	O
from	O
its	O
images	O
,	O
surface	O
induced	O
paral-	O
lax	O
,	O
consistency	O
constraints	O
,	O
implicit	O
computations	O
,	O
degenerate	B
geometries	O
etc	O
.	O
all	O
carry	O
over	O
to	O
other	O
surfaces	O
.	O
13.5	O
closure	O
341	O
13.5.1	O
the	O
literature	O
the	O
compatibility	O
of	O
epipolar	B
geometry	O
and	O
induced	O
homographies	O
is	O
investigated	O
thor-	O
oughly	O
by	O
luong	O
&	O
vi´eville	O
[	O
luong-96	O
]	O
.	O
the	O
six-point	O
solution	B
for	O
f	O
appeared	O
in	O
beardsley	O
et	O
al	O
.	O
[	O
beardsley-92	O
]	O
and	O
[	O
mohr-92	O
]	O
.	O
the	O
solution	B
for	O
f	O
given	O
two	O
planes	O
appeared	O
in	O
sinclair	O
[	O
sinclair-92	O
]	O
.	O
[	O
zeller-96	O
]	O
gives	O
many	O
examples	B
of	O
conﬁgurations	O
whose	O
properties	B
may	O
be	O
determined	O
using	O
only	O
epipolar	B
geometry	O
and	O
their	O
image	O
projections	O
.	O
he	O
also	O
catalogues	O
their	O
degenerate	B
cases	O
.	O
13.5.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
homography	B
induced	O
by	O
a	O
plane	B
(	O
13.1–p326	O
)	O
.	O
(	O
a	O
)	O
the	O
inverse	O
of	O
the	O
homography	O
h	O
is	O
given	O
by	O
(	O
cid:20	O
)	O
h−1	O
=	O
a−1	O
i	O
+	O
avta−1	O
1	O
−	O
vta−1a	O
(	O
cid:21	O
)	O
provided	O
a−1	O
exists	O
.	O
this	O
is	O
sometimes	O
called	O
the	O
sherman-morrison	O
formula	O
.	O
(	O
b	O
)	O
show	O
that	O
the	O
homography	B
h	O
is	O
degenerate	B
if	O
the	O
plane	B
contains	O
the	O
second	O
camera	B
centre	I
.	O
hint	O
,	O
in	O
this	O
case	O
vta−1a	O
=	O
1	O
,	O
and	O
note	O
that	O
h	O
=	O
a	O
(	O
i	O
−	O
a−1avt	O
)	O
.	O
(	O
ii	O
)	O
show	O
that	O
if	O
the	O
camera	B
undergoes	O
planar	B
motion	I
,	O
i.e	O
.	O
the	O
translation	O
is	O
parallel	B
to	O
the	O
plane	B
and	O
the	O
rotation	B
is	O
parallel	B
to	O
the	O
plane	B
normal	O
,	O
then	O
the	O
homog-	O
raphy	O
induced	O
by	O
the	O
plane	B
is	O
conjugate	O
to	O
a	O
planar	O
euclidean	O
transformation	B
.	O
show	O
that	O
the	O
ﬁxed	O
points	O
of	O
the	O
homography	B
are	O
the	O
images	O
of	O
the	O
plane	O
’	O
s	O
circular	B
points	I
.	O
(	O
iii	O
)	O
using	O
(	O
13.2–p327	O
)	O
show	O
that	O
if	O
a	O
camera	B
undergoes	O
a	O
pure	O
translation	O
then	O
the	O
homography	B
induced	O
by	O
the	O
plane	B
is	O
a	O
planar	B
homology	I
(	O
as	O
deﬁned	O
in	O
section	O
a7.2	O
(	O
p629	O
)	O
)	O
,	O
with	O
a	O
line	B
of	O
ﬁxed	B
points	I
corresponding	O
to	O
the	O
vanishing	O
line	O
of	O
the	O
plane	O
.	O
show	O
further	O
that	O
if	O
the	O
translation	O
is	O
parallel	B
to	O
the	O
plane	B
then	O
the	O
homography	B
is	O
an	O
elation	B
(	O
as	O
deﬁned	O
in	O
section	O
a7.3	O
(	O
p631	O
)	O
)	O
.	O
coplanar	O
is	O
(	O
l	O
(	O
cid:2	O
)	O
2	O
)	O
tf	O
(	O
l1	O
×	O
l2	O
)	O
=	O
0.	O
why	O
is	O
it	O
not	O
a	O
sufﬁcient	O
condition	O
?	O
(	O
iv	O
)	O
show	O
that	O
a	O
necessary	O
,	O
but	O
not	O
sufﬁcient	O
,	O
condition	O
for	O
two	O
space	O
lines	O
to	O
be	O
×	O
l	O
(	O
cid:2	O
)	O
(	O
v	O
)	O
intersections	O
of	B
lines	I
and	O
planes	O
.	O
verify	O
each	O
of	O
the	O
following	O
results	O
by	O
sketching	O
the	O
conﬁguration	O
assuming	O
general	O
position	O
.	O
in	O
each	O
case	O
determine	O
the	O
degenerate	B
conﬁgurations	I
for	O
which	O
the	O
result	O
is	O
not	O
valid	O
.	O
(	O
a	O
)	O
suppose	O
the	O
line	B
l	O
in	O
3-space	O
is	O
imaged	O
as	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
1	O
,	O
and	O
the	O
plane	B
π	O
=	O
hx	O
.	O
then	O
the	O
point	B
of	O
intersection	B
of	O
=	O
)	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
at	O
x	O
(	O
cid:2	O
)	O
induces	O
the	O
homography	B
x	O
(	O
cid:2	O
)	O
l	O
with	O
π	O
is	O
imaged	O
at	O
x	O
=	O
l	O
×	O
(	O
htl	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
×	O
(	O
h−tl	O
)	O
in	O
the	O
second	O
.	O
a	O
line	B
seen	O
in	O
two	O
images	O
.	O
if	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
images	O
,	O
and	O
v	O
,	O
v	O
(	O
cid:2	O
)	O
(	O
ht∞l	O
(	O
cid:2	O
)	O
=	O
l	O
(	O
cid:2	O
)	O
×	O
(	O
h−t∞	O
l	O
)	O
.	O
)	O
,	O
v	O
(	O
cid:2	O
)	O
(	O
b	O
)	O
the	O
inﬁnite	B
homography	I
may	O
be	O
used	O
to	O
ﬁnd	O
the	O
vanishing	O
point	O
of	O
are	O
corresponding	O
lines	B
in	O
two	O
their	O
vanishing	B
points	I
in	O
each	O
image	O
,	O
then	O
v	O
=	O
l	O
×	O
342	O
13	O
scene	O
planes	O
and	O
homographies	B
(	O
c	O
)	O
suppose	O
the	O
planes	O
π1	O
and	O
π2	O
induce	O
homographies	B
x	O
(	O
cid:2	O
)	O
=	O
h2x	O
respectively	O
.	O
then	O
the	O
image	O
of	O
the	O
line	O
of	O
intersection	O
of	O
π1	O
with	O
π2	O
in	O
the	O
ﬁrst	O
image	O
obeys	O
ht	O
l	O
=	O
l	O
and	O
may	O
be	O
determined	O
from	O
the	O
1	O
real	O
eigenvector	O
of	O
the	O
planar	O
homology	B
ht	O
1	O
=	O
h1x	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
see	O
ﬁgure	O
13.11	O
)	O
.	O
h−t	O
h−t	O
2	O
2	O
(	O
vi	O
)	O
coplanarity	O
of	O
four	O
points	O
.	O
suppose	O
f	O
is	O
known	O
,	O
and	O
four	O
corresponding	O
image	O
points	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
supplied	O
.	O
how	O
can	O
it	O
be	O
determined	O
whether	O
their	O
pre-images	O
are	O
coplanar	O
?	O
one	O
possibility	O
is	O
to	O
use	O
three	O
of	O
the	O
points	O
to	O
deter-	O
mine	O
a	O
homography	B
via	O
result	O
13.6	O
(	O
p331	O
)	O
,	O
and	O
then	O
measure	O
the	O
transfer	B
error	O
of	O
the	O
fourth	O
point	B
.	O
a	O
second	O
possibility	O
is	O
to	O
compute	O
lines	B
joining	O
the	O
im-	O
age	O
points	O
,	O
and	O
determine	O
if	O
the	O
line	B
intersection	O
obeys	O
the	O
epipolar	B
constraint	O
(	O
see	O
[	O
faugeras-92b	O
]	O
)	O
.	O
a	O
third	O
possibility	O
is	O
to	O
compute	O
the	O
cross-ratio	O
of	O
the	O
four	O
lines	B
from	O
the	O
epipole	O
to	O
the	O
image	O
points	O
–	O
if	O
the	O
four	O
scene	O
points	O
are	O
copla-	O
nar	O
then	O
this	O
cross-ratio	O
will	O
be	O
the	O
same	O
in	O
both	B
images	I
.	O
thus	O
this	O
equality	O
is	O
a	O
necessary	O
condition	O
for	O
co-planarity	O
,	O
but	O
is	O
it	O
a	O
sufﬁcient	O
condition	O
also	O
?	O
what	O
statistical	O
tests	O
should	O
be	O
applied	O
when	O
there	O
is	O
measurement	O
error	O
(	O
noise	B
)	O
?	O
=	O
hx	O
induced	B
by	I
a	I
plane	I
π	O
=	O
(	O
˜πt	O
,	O
π4	O
)	O
t	O
is	O
given	O
by	O
(	O
viii	O
)	O
starting	O
from	O
the	O
camera	B
matrices	I
p	O
=	O
[	O
m	O
|	O
m	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
vii	O
)	O
show	O
that	O
the	O
epipolar	B
geometry	O
can	O
be	O
computed	O
uniquely	O
from	O
the	O
images	O
of	O
four	O
coplanar	O
lines	B
and	O
two	O
points	O
off	O
the	O
plane	B
of	O
the	O
lines	B
.	O
if	O
two	O
of	O
the	O
lines	B
are	O
replaced	O
by	O
points	O
can	O
the	O
epipolar	B
geometry	O
still	O
be	O
computed	O
?	O
homography	B
x	O
(	O
cid:2	O
)	O
h	O
=	O
m	O
(	O
cid:2	O
)	O
(	O
i−tvt	O
)	O
m−1	O
with	O
t	O
=	O
(	O
m	O
(	O
cid:2	O
)	O
−1m	O
(	O
cid:2	O
)	O
−m−1m	O
)	O
,	O
and	O
v	O
=	O
˜π/	O
(	O
π4−	O
˜πtm−1m	O
)	O
.	O
(	O
ix	O
)	O
show	O
that	O
the	O
homography	B
computed	O
as	O
in	O
result	O
13.6	O
(	O
p331	O
)	O
is	O
independent	O
of	O
the	O
scale	O
of	O
f.	O
start	O
by	O
choosing	O
an	O
arbitrary	O
ﬁxed	O
scale	O
for	O
f	O
,	O
so	O
that	O
f	O
is	O
no	O
longer	O
a	O
homogeneous	O
quantity	O
,	O
but	O
a	O
matrix	B
˜f	O
with	O
ﬁxed	O
scale	O
.	O
show	O
that	O
if	O
h	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
t	O
(	O
˜fxi	O
)	O
,	O
then	O
replacing	O
˜f	O
by	O
λ˜f	O
simply	O
scales	O
h	O
by	O
λ	O
.	O
(	O
m−1	O
˜b	O
)	O
t	O
with	O
˜bi	O
=	O
c	O
(	O
cid:2	O
)	O
=	O
[	O
m	O
(	O
cid:2	O
)	O
|	O
m	O
(	O
cid:2	O
)	O
]	O
show	O
that	O
the	O
]	O
×˜f	O
−	O
e	O
(	O
cid:2	O
)	O
i	O
(	O
x	O
)	O
given	O
two	O
perspective	O
images	O
of	O
a	O
(	O
plane	B
)	O
conic	B
and	O
the	O
fundamental	B
matrix	I
be-	O
tween	O
the	O
views	O
,	O
then	O
the	O
plane	B
of	O
the	O
conic	B
(	O
and	O
consequently	O
the	O
homography	B
induced	O
by	O
this	O
plane	B
)	O
is	O
deﬁned	O
up	O
to	O
a	O
two-fold	O
ambiguity	B
.	O
suppose	O
the	O
image	O
conics	O
are	O
c	O
and	O
c	O
(	O
cid:2	O
)	O
(	O
ce	O
)	O
t	O
,	O
with	O
the	O
two	O
values	O
of	O
µ	O
obtained	O
from	O
,	O
then	O
the	O
induced	O
homography	O
is	O
h	O
(	O
µ	O
)	O
=	O
[	O
c	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
]	O
×f−µe	O
(	O
cid:2	O
)	O
#	O
''	O
(	O
etce	O
)	O
c	O
−	O
(	O
ce	O
)	O
(	O
ce	O
)	O
t	O
details	O
are	O
given	O
in	O
[	O
schmid-98	O
]	O
.	O
µ2	O
(	O
e	O
(	O
cid:2	O
)	O
tc	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
)	O
=−f	O
t	O
[	O
c	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
]	O
×c	O
(	O
cid:2	O
)	O
[	O
c	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
]	O
×f	O
.	O
(	O
a	O
)	O
by	O
considering	O
the	O
geometry	O
,	O
show	O
that	O
to	O
be	O
compatible	O
with	O
the	O
epipolar	B
geometry	O
the	O
conics	O
must	O
satisfy	O
the	O
consistency	O
constraint	O
that	O
epipolar	B
tangents	O
are	O
corresponding	O
epipolar	B
lines	I
(	O
see	O
ﬁgure	O
11.6-	O
(	O
p295	O
)	O
)	O
.	O
now	O
derive	O
this	O
result	O
algebraically	O
starting	O
from	O
h	O
(	O
µ	O
)	O
above	O
.	O
(	O
b	O
)	O
the	O
algebraic	B
expressions	O
are	O
not	O
valid	O
if	O
the	O
epipole	O
lies	O
on	O
the	O
conic	B
(	O
since	O
then	O
etce	O
=	O
e	O
(	O
cid:2	O
)	O
tc	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
=	O
0	O
)	O
.	O
is	O
this	O
a	O
degeneracy	B
of	O
the	O
geometry	O
or	O
of	O
the	O
expression	O
alone	O
?	O
13.5	O
closure	O
343	O
(	O
xi	O
)	O
fixed	O
points	O
of	O
a	O
homography	B
induced	O
by	O
a	O
plane	B
.	O
a	O
planar	O
homography	O
h	O
has	O
up	O
to	O
three	O
distinct	O
ﬁxed	B
points	I
corresponding	O
to	O
the	O
three	O
eigenvectors	O
of	O
the	O
3	O
×	O
3	O
matrix	B
(	O
see	O
section	O
2.9	O
(	O
p61	O
)	O
)	O
.	O
the	O
ﬁxed	B
points	I
are	O
images	O
of	B
points	I
on	O
the	O
plane	B
for	O
which	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
=	O
x.	O
the	O
horopter	B
is	O
the	O
locus	O
of	O
all	O
points	O
in	O
3-space	O
for	O
which	O
x	O
=	O
x	O
(	O
cid:2	O
)	O
.	O
it	O
is	O
a	O
twisted	B
cubic	I
curve	O
passing	O
through	O
the	O
two	O
camera	O
centres	O
.	O
a	O
twisted	B
cubic	I
intersects	O
a	O
plane	B
in	O
three	O
points	O
,	O
and	O
these	O
are	O
the	O
three	O
ﬁxed	O
points	O
of	O
the	O
homography	B
induced	O
by	O
that	O
plane	B
.	O
(	O
xii	O
)	O
estimation	B
.	O
suppose	O
n	O
>	O
3	O
points	O
xi	O
lie	O
on	O
a	O
plane	O
in	O
3-space	O
and	O
we	O
wish	O
to	O
optimally	O
estimate	O
the	O
homography	B
induced	O
by	O
the	O
plane	B
given	O
f	O
and	O
their	O
image	O
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i.	O
then	O
the	O
ml	O
estimate	O
of	O
the	O
homography	O
estimating	B
the	O
plane	B
ˆπ	O
(	O
3	O
dof	O
)	O
and	O
the	O
n	O
points	O
(	O
cid:23	O
)	O
xi	O
(	O
2	O
dof	O
each	O
,	O
since	O
they	O
lie	O
on	O
(	O
assuming	O
independent	O
gaussian	O
measurement	O
noise	O
as	O
usual	O
)	O
is	O
obtained	O
by	O
a	O
plane	B
)	O
which	O
minimizes	O
reprojection	B
error	I
for	O
the	O
n	O
points	O
.	O
14	O
afﬁne	B
epipolar	O
geometry	O
this	O
chapter	O
recapitulates	O
the	O
developments	O
and	O
objectives	O
of	O
the	O
previous	O
chapters	O
on	O
two-view	O
geometry	O
,	O
but	O
here	O
with	O
afﬁne	O
cameras	B
replacing	O
projective	B
cameras	O
.	O
the	O
afﬁne	B
camera	I
is	O
an	O
extremely	O
usable	O
and	O
well	O
conditioned	O
approximation	O
in	O
many	O
prac-	O
tical	O
situations	O
.	O
its	O
great	O
advantage	O
is	O
that	O
,	O
because	O
of	O
its	O
linearity	O
,	O
many	O
of	O
the	O
optimal	O
algorithms	O
can	O
be	O
implemented	O
by	O
linear	B
algebra	O
(	O
matrix	B
inverses	O
,	O
svd	O
etc	O
.	O
)	O
,	O
whereas	O
in	O
the	O
projective	B
case	O
solutions	O
either	O
involve	O
high	O
order	O
polynomials	O
(	O
such	O
as	O
for	O
trian-	O
gulation	O
)	O
or	O
are	O
only	O
possible	O
by	O
numerical	O
minimization	B
(	O
such	O
as	O
in	O
the	O
gold	O
standard	O
estimation	B
of	I
f	O
)	O
.	O
we	O
ﬁrst	O
describe	O
properties	B
of	O
the	O
epipolar	B
geometry	O
of	O
two	O
afﬁne	B
cameras	I
,	O
and	O
its	O
optimal	O
computation	O
from	O
point	O
correspondences	B
.	O
this	O
is	O
followed	O
by	O
triangulation	B
,	O
and	O
afﬁne	B
reconstruction	I
.	O
finally	O
the	O
ambiguities	B
in	O
reconstruction	B
that	O
result	O
from	O
parallel	O
projection	B
are	O
sketched	O
,	O
and	O
the	O
non-ambiguous	O
motion	O
parameters	B
are	O
com-	O
puted	O
from	O
the	O
epipolar	B
geometry	O
.	O
14.1	O
afﬁne	B
epipolar	O
geometry	O
in	O
many	O
respects	O
the	O
epipolar	B
geometry	O
of	O
two	O
afﬁne	B
cameras	I
is	O
identical	O
to	O
that	O
of	O
two	O
perspective	O
cameras	B
,	O
for	O
example	O
a	O
point	B
in	O
one	O
view	O
deﬁnes	O
an	O
epipolar	B
line	I
in	O
the	O
other	O
view	O
,	O
and	O
the	O
pencil	O
of	O
such	O
epipolar	B
lines	I
intersect	O
at	O
the	O
epipole	O
.	O
the	O
difference	O
is	O
that	O
because	O
the	O
cameras	B
are	O
afﬁne	B
their	O
centres	O
are	O
at	B
inﬁnity	I
,	O
and	O
there	O
is	O
parallel	B
projection	I
from	O
scene	O
to	O
image	O
.	O
this	O
leads	O
to	O
certain	O
simpliﬁcations	O
in	O
the	O
afﬁne	B
epipolar	O
geometry	O
:	O
epipolar	B
lines	I
.	O
consider	O
two	O
points	O
,	O
x1	O
,	O
x2	O
,	O
in	O
the	O
ﬁrst	O
view	O
.	O
these	O
points	O
back-	O
project	O
to	O
rays	O
which	O
are	O
parallel	B
in	O
3-space	O
,	O
since	O
all	O
projection	B
rays	O
are	O
parallel	B
.	O
in	O
the	O
second	O
view	O
an	O
epipolar	B
line	I
is	O
the	O
image	O
of	O
a	O
back-projected	O
ray	O
.	O
the	O
images	O
of	O
these	O
two	O
rays	O
in	O
the	O
second	O
view	O
are	O
also	O
parallel	B
since	O
an	O
afﬁne	B
camera	I
maps	O
parallel	B
scene	O
lines	B
to	O
parallel	B
images	O
lines	B
.	O
consequently	O
,	O
all	O
epipolar	B
lines	I
are	O
parallel	B
,	O
as	O
are	O
the	O
epipolar	B
planes	O
.	O
the	O
epipoles	B
.	O
since	O
epipolar	B
lines	I
intersect	O
in	O
the	O
epipole	O
,	O
and	O
all	O
epipolar	B
lines	I
are	O
parallel	B
,	O
it	O
follows	O
that	O
the	O
epipole	O
is	O
at	B
inﬁnity	I
.	O
344	O
14.2	O
the	O
afﬁne	B
fundamental	I
matrix	I
345	O
x	O
1	O
x	O
2	O
3x	O
x	O
?	O
?	O
?	O
x	O
/	O
l	O
x	O
/	O
x	O
1	O
x	O
2	O
x	O
3	O
parallel	B
epipolar	O
planes	O
x	O
/	O
3	O
/	O
3	O
l	O
l	O
/	O
2	O
/	O
l	O
1	O
centre	B
lies	O
at	O
infinity	O
a	O
b	O
fig	O
.	O
14.1.	O
afﬁne	B
epipolar	O
geometry	O
.	O
(	O
a	O
)	O
correspondence	B
geometry	O
:	O
projection	B
rays	O
are	O
parallel	B
and	O
intersect	O
at	B
inﬁnity	I
.	O
a	O
point	B
x	O
back-projects	O
to	O
a	O
ray	O
in	O
3-space	O
deﬁned	O
by	O
the	O
ﬁrst	O
camera	B
centre	I
(	O
at	B
inﬁnity	I
)	O
and	O
x.	O
this	O
ray	O
is	O
imaged	O
as	O
a	O
line	B
l	O
(	O
cid:1	O
)	O
in	O
the	O
second	O
view	O
.	O
the	O
3-space	O
point	B
x	O
which	O
projects	O
to	O
x	O
lies	O
on	O
this	O
ray	O
,	O
so	O
the	O
image	O
of	O
x	O
in	O
the	O
second	O
view	O
lies	O
on	O
l	O
(	O
cid:1	O
)	O
.	O
(	O
b	O
)	O
epipolar	B
lines	I
and	O
planes	O
are	O
parallel	B
.	O
these	O
points	O
are	O
illustrated	O
schematically	O
in	O
ﬁgure	O
14.1	O
,	O
and	O
examples	B
on	O
images	O
are	O
shown	O
in	O
ﬁgure	O
14.2	O
.	O
14.2	O
the	O
afﬁne	B
fundamental	I
matrix	I
the	O
afﬁne	B
epipolar	O
geometry	O
is	O
represented	O
algebraically	O
by	O
a	O
matrix	B
termed	O
the	O
afﬁne	B
fundamental	I
matrix	I
,	O
fa	O
.	O
it	O
will	O
be	O
seen	O
in	O
the	O
following	O
that	O
:	O
result	O
14.1.	O
the	O
fundamental	B
matrix	I
resulting	O
from	O
two	O
cameras	O
with	O
the	O
afﬁne	B
form	O
(	O
i.e	O
.	O
the	O
third	O
row	O
is	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
)	O
has	O
the	O
form	O
	O
0	O
0	O
∗	O
0	O
0	O
∗	O
∗	O
∗	O
∗	O
fa	O
=	O
	O
0	O
0	O
a	O
0	O
0	O
b	O
c	O
d	O
e	O
	O
	O
.	O
where	O
∗	O
indicates	O
a	O
non-zero	O
entry	O
.	O
it	O
will	O
be	O
convenient	O
to	O
write	O
the	O
ﬁve	O
non-zero	O
entries	O
as	O
fa	O
=	O
note	O
that	O
in	O
general	O
fa	O
has	O
rank	O
2	O
.	O
(	O
14.1	O
)	O
14.2.1	O
derivation	B
geometric	O
derivation	B
.	O
this	O
derivation	B
is	O
the	O
analogue	O
of	O
that	O
given	O
in	O
section	O
9.2.1-	O
(	O
p242	O
)	O
for	O
a	O
pair	O
of	O
projective	O
cameras	B
.	O
the	O
map	O
from	O
a	O
point	B
in	O
one	O
image	O
to	O
the	O
corresponding	O
epipolar	B
line	I
in	O
the	O
other	O
image	O
is	O
decomposed	O
into	O
two	O
steps	O
,	O
as	O
illus-	O
trated	O
in	O
ﬁgure	O
14.5	O
on	O
page	O
352	O
:	O
346	O
14	O
afﬁne	B
epipolar	O
geometry	O
a	O
c	O
e	O
b	O
d	O
f	O
fig	O
.	O
14.2.	O
afﬁne	B
epipolar	O
lines	B
.	O
(	O
a	O
)	O
,	O
(	O
b	O
)	O
two	B
views	I
of	O
a	O
hole	O
punch	O
acquired	O
under	O
afﬁne	B
imaging	I
con-	O
ditions	O
.	O
for	O
the	O
points	O
marked	O
in	O
(	O
c	O
)	O
the	O
epipolar	B
lines	I
are	O
superimposed	O
on	O
(	O
d	O
)	O
.	O
note	O
that	O
corresponding	O
points	O
lie	O
on	O
their	O
epipolar	B
lines	I
,	O
and	O
that	O
all	O
epipolar	B
lines	I
are	O
parallel	B
.	O
the	O
epipolar	B
geometry	O
is	O
com-	O
puted	O
from	O
point	O
correspondences	O
using	O
algorithm	O
14.1	O
.	O
(	O
e	O
)	O
and	O
(	O
f	O
)	O
show	O
the	O
“	O
ﬂow	O
”	O
for	O
selected	O
points	O
in	O
the	O
image	O
(	O
the	O
lines	B
link	O
a	O
point	B
in	O
one	O
image	O
to	O
the	O
point	B
’	O
s	O
position	O
in	O
the	O
other	O
image	O
)	O
.	O
this	O
demon-	O
strates	O
that	O
even	O
though	O
the	O
epipolar	B
lines	I
are	O
parallel	B
the	O
movement	O
of	O
imaged	O
points	O
between	O
the	O
views	O
contains	O
both	O
rotational	O
and	O
translational	O
components	O
.	O
(	O
i	O
)	O
point	B
transfer	I
via	O
a	O
plane	B
π.	O
since	O
both	O
cameras	O
are	O
afﬁne	B
,	O
points	O
are	O
mapped	O
between	O
an	O
image	O
and	O
a	O
scene	O
plane	O
by	O
parallel	B
projection	I
,	O
so	O
the	O
map	O
between	O
π	O
and	O
the	O
images	O
is	O
a	O
planar	O
afﬁne	O
transformation	B
;	O
the	O
composition	O
of	O
the	O
afﬁne	O
transformations	O
between	O
the	O
ﬁrst	O
view	O
and	O
π	O
,	O
and	O
π	O
and	O
the	O
second	O
view	O
,	O
is	O
also	O
an	O
afﬁne	B
transformation	I
,	O
i.e	O
.	O
x	O
(	O
cid:2	O
)	O
=	O
hax	O
.	O
(	O
ii	O
)	O
constructing	O
the	O
epipolar	B
line	I
.	O
the	O
epipolar	B
line	I
is	O
obtained	O
as	O
the	O
line	B
=	O
e	O
(	O
cid:2	O
)	O
×	O
hax	O
=	O
fax	O
,	O
so	O
that	O
fa	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×ha	O
.	O
through	O
x	O
(	O
cid:2	O
)	O
and	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
,	O
i.e	O
.	O
l	O
(	O
cid:2	O
)	O
14.3	O
estimating	B
fa	O
from	O
image	O
point	B
correspondences	O
347	O
we	O
now	O
take	O
note	O
of	O
the	O
special	O
forms	O
of	O
the	O
afﬁne	O
matrix	B
ha	O
,	O
and	O
the	O
skew	O
matrix	B
[	O
e	O
(	O
cid:2	O
)	O
is	O
at	B
inﬁnity	I
,	O
and	O
so	O
has	O
a	O
zero	O
last	O
element	O
:	O
]	O
×	O
when	O
e	O
(	O
cid:2	O
)	O
	O
0	O
0	O
∗	O
0	O
0	O
∗	O
∗	O
∗	O
0	O
	O
	O
∗	O
∗	O
∗	O
∗	O
∗	O
∗	O
0	O
0	O
1	O
	O
=	O
	O
0	O
0	O
∗	O
0	O
0	O
∗	O
∗	O
∗	O
∗	O
	O
fa	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×ha	O
=	O
(	O
14.2	O
)	O
where	O
∗	O
indicates	O
a	O
non-zero	O
entry	O
.	O
this	O
derives	O
the	O
afﬁne	B
form	O
of	O
f	O
using	O
only	O
the	O
geometric	B
properties	O
that	O
the	O
camera	B
centres	O
are	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
algebraic	B
derivation	I
.	O
in	O
the	O
case	O
that	O
the	O
cameras	B
are	O
both	O
afﬁne	O
,	O
the	O
afﬁne	B
form	O
of	O
the	O
fundamental	O
matrix	B
is	O
obtained	O
directly	O
from	O
the	O
expression	O
(	O
9.1–p244	O
)	O
for	O
f	O
in	O
=	O
p	O
(	O
cid:2	O
)	O
c	O
,	O
with	O
c	O
the	O
camera	B
terms	O
of	O
the	O
pseudo-inverse	O
,	O
namely	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
centre	B
which	O
is	O
the	O
null-vector	O
of	O
p.	O
details	O
are	O
left	O
as	O
an	O
exercise	O
.	O
an	O
elegant	O
deriva-	O
tion	O
of	O
fa	O
in	O
terms	O
of	O
determinants	O
formed	O
from	O
rows	O
of	O
the	O
afﬁne	O
camera	B
matrices	I
is	O
given	O
in	O
section	O
17.1.2	O
(	O
p413	O
)	O
.	O
]	O
×p	O
(	O
cid:2	O
)	O
p+	O
,	O
where	O
e	O
(	O
cid:2	O
)	O
14.2.2	O
properties	B
the	O
afﬁne	B
fundamental	I
matrix	I
is	O
a	O
homogeneous	O
matrix	O
with	O
ﬁve	O
non-zero	O
elements	O
,	O
it	O
thus	O
has	O
4	O
degrees	B
of	I
freedom	I
.	O
these	O
are	O
accounted	O
as	O
:	O
one	O
for	O
each	O
of	O
the	O
two	O
epipoles	B
(	O
the	O
epipoles	B
lie	O
on	O
l∞	O
,	O
so	O
only	O
their	O
direction	O
need	O
be	O
speciﬁed	O
)	O
;	O
and	O
two	O
for	O
the	O
1d	O
afﬁne	B
transformation	I
mapping	O
the	O
pencil	O
of	B
epipolar	I
lines	I
from	O
one	O
view	O
to	O
the	O
other	O
.	O
the	O
geometric	B
entities	O
(	O
epipoles	B
etc	O
.	O
)	O
are	O
encoded	O
in	O
fa	O
in	O
the	O
same	O
manner	O
as	O
their	O
encoding	O
in	O
f.	O
however	O
,	O
often	O
the	O
expressions	O
are	O
far	O
simpler	O
and	O
so	O
can	O
be	O
given	O
explicitly	O
.	O
the	O
epipoles	B
.	O
the	O
epipole	O
in	O
the	O
ﬁrst	O
view	O
is	O
the	O
right	O
null-vector	O
of	O
fa	O
,	O
i.e	O
.	O
fae	O
=	O
0.	O
this	O
determines	O
e	O
=	O
(	O
−d	O
,	O
c	O
,	O
0	O
)	O
t	O
,	O
which	O
is	O
a	O
point	B
(	O
direction	O
)	O
on	O
l∞	O
.	O
since	O
all	O
epipolar	B
lines	I
intersect	O
the	O
epipole	O
this	O
shows	O
that	O
all	O
epipolar	B
lines	I
are	O
parallel	B
.	O
epipolar	B
lines	I
.	O
the	O
epipolar	B
line	I
in	O
the	O
second	O
view	O
corresponding	O
to	O
x	O
in	O
the	O
ﬁrst	O
is	O
l	O
(	O
cid:2	O
)	O
=	O
fax	O
=	O
(	O
a	O
,	O
b	O
,	O
cx	O
+	O
dy	O
+	O
e	O
)	O
t.	O
again	O
it	O
is	O
evident	O
that	O
all	O
epipolar	B
lines	I
are	O
parallel	B
since	O
the	O
line	B
orientation	O
,	O
(	O
a	O
,	O
b	O
)	O
,	O
is	O
independent	O
of	O
(	O
x	O
,	O
y	O
)	O
.	O
these	O
properties	B
,	O
and	O
others	O
,	O
are	O
summarized	O
in	O
table	O
14.1	O
.	O
14.3	O
estimating	B
fa	O
from	O
image	O
point	B
correspondences	O
in	O
two	O
images	O
.	O
given	O
sufﬁciently	O
many	O
point	B
matches	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
the	O
fundamental	B
matrix	I
is	O
deﬁned	O
by	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
tfax	O
=	O
0	O
for	O
any	O
pair	O
of	O
matching	O
points	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
this	O
equation	O
can	O
be	O
used	O
to	O
compute	O
the	O
unknown	O
matrix	B
fa	O
.	O
in	O
particular	O
,	O
writing	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
t	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
1	O
)	O
t	O
each	O
point	B
match	O
gives	O
rise	O
to	O
one	O
linear	B
equation	O
i	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
(	O
cid:2	O
)	O
i	O
+	O
by	O
(	O
cid:2	O
)	O
i	O
+	O
cxi	O
+	O
dyi	O
+	O
e	O
=	O
0	O
ax	O
(	O
14.3	O
)	O
in	O
the	O
unknown	O
entries	O
{	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
,	O
e	O
}	O
of	O
fa	O
.	O
348	O
14	O
afﬁne	B
epipolar	O
geometry	O
•	O
fa	O
is	O
a	O
rank	O
2	O
homogeneous	O
matrix	O
with	O
4	O
degrees	B
of	I
freedom	I
.	O
it	O
has	O
the	O
form	O
(	O
cid:17	O
)	O
fa	O
=	O
0	O
a	O
0	O
0	O
0	O
b	O
c	O
d	O
e	O
(	O
cid:18	O
)	O
.	O
are	O
corresponding	O
image	O
points	O
under	O
an	O
afﬁne	B
camera	I
,	O
•	O
point	B
correspondence	O
:	O
if	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
then	O
x	O
(	O
cid:1	O
)	O
tfax	O
=	O
0.	O
for	O
ﬁnite	O
points	O
(	O
cid:1	O
)	O
ax	O
•	O
epipolar	B
lines	I
:	O
+	O
by	O
(	O
cid:1	O
)	O
+	O
cx	O
+	O
dy	O
+	O
e	O
=	O
0	O
.	O
(	O
cid:21	O
)	O
l	O
(	O
cid:1	O
)	O
=	O
fax	O
=	O
(	O
a	O
,	O
b	O
,	O
cx	O
+	O
dy	O
+	O
e	O
)	O
t	O
is	O
the	O
epipolar	B
line	I
corresponding	O
to	O
x	O
.	O
(	O
cid:21	O
)	O
l	O
=	O
fa	O
tx	O
(	O
cid:1	O
)	O
=	O
(	O
c	O
,	O
d	O
,	O
ax	O
+	O
by	O
+	O
e	O
)	O
t	O
is	O
the	O
epipolar	B
line	I
corresponding	O
to	O
x	O
(	O
cid:1	O
)	O
•	O
epipoles	B
:	O
.	O
(	O
cid:21	O
)	O
from	O
fae	O
=	O
0	O
,	O
e	O
=	O
(	O
−d	O
,	O
c	O
,	O
0	O
)	O
t.	O
(	O
cid:21	O
)	O
from	O
fa	O
te	O
(	O
cid:1	O
)	O
=	O
0	O
,	O
e	O
(	O
cid:1	O
)	O
=	O
(	O
−b	O
,	O
a	O
,	O
0	O
)	O
t.	O
•	O
computation	B
from	I
camera	I
matrices	I
pa	O
,	O
p	O
(	O
cid:1	O
)	O
a	O
:	O
(	O
cid:21	O
)	O
general	O
cameras	O
,	O
ap+	O
ac	O
,	O
where	O
c	O
is	O
the	O
centre	B
of	O
the	O
ﬁrst	O
camera	B
.	O
a	O
is	O
the	O
pseudo-inverse	B
of	O
pa	O
,	O
and	O
e	O
(	O
cid:1	O
)	O
fa	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×p	O
(	O
cid:1	O
)	O
e	O
(	O
cid:1	O
)	O
=	O
p	O
(	O
cid:1	O
)	O
a	O
,	O
where	O
p+	O
(	O
cid:21	O
)	O
canonical	O
cameras	O
,	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:24	O
)	O
(	O
cid:25	O
)	O
pa	O
=	O
1	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
0	O
1	O
p	O
(	O
cid:1	O
)	O
a	O
=	O
m2×3	O
0	O
t	O
0	O
1	O
0	O
is	O
the	O
epipole	O
deﬁned	O
by	O
c	O
=	O
m13m21	O
−	O
m11m23	O
a	O
=	O
m23	O
,	O
d	O
=	O
m13m22	O
−	O
m12m23	O
,	O
e	O
=	O
m13t2	O
−	O
m23t1	O
b	O
=	O
−m13	O
,	O
table	O
14.1.	O
summary	B
of	O
afﬁne	B
fundamental	I
matrix	I
properties	O
.	O
14.3.1	O
the	O
linear	B
algorithm	I
in	O
the	O
usual	O
manner	O
a	O
solution	B
for	O
fa	O
may	O
be	O
obtained	O
by	O
rewriting	O
(	O
14.3	O
)	O
as	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
(	O
cid:2	O
)	O
i	O
,	O
xi	O
,	O
yi	O
,	O
1	O
)	O
f	O
=	O
0	O
(	O
x	O
with	O
f	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
,	O
e	O
)	O
t.	O
from	O
a	O
set	O
of	O
n	O
point	B
matches	O
,	O
we	O
obtain	O
a	O
set	O
of	O
linear	O
equations	O
of	O
the	O
form	O
af	O
=	O
0	O
,	O
where	O
a	O
is	O
a	O
n	O
×	O
5	O
matrix	B
:	O
	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1	O
x1	O
y1	O
1	O
1	O
y	O
...	O
...	O
...	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
n	O
y	O
n	O
xn	O
yn	O
1	O
x	O
...	O
...	O
	O
f	O
=	O
0.	O
a	O
minimal	B
solution	I
is	O
obtained	O
for	O
n	O
=	O
4	O
point	B
correspondences	O
as	O
the	O
right	O
null-	O
space	O
of	O
the	O
4	O
×	O
5	O
matrix	B
a.	O
thus	O
fa	O
can	O
be	O
computed	O
uniquely	O
from	O
only	O
4	O
point	B
14.3	O
estimating	B
fa	O
from	O
image	O
point	B
correspondences	O
349	O
correspondences	B
,	O
provided	O
the	O
3-space	O
points	O
are	O
in	O
general	O
position	O
.	O
the	O
conditions	O
for	O
general	O
position	O
are	O
described	O
in	O
section	O
14.3.3	O
below	O
.	O
if	O
there	O
are	O
more	O
than	O
4	O
correspondences	B
,	O
and	O
the	O
data	O
is	O
not	O
exact	O
,	O
then	O
the	O
rank	O
of	O
a	O
may	O
be	O
greater	O
than	O
4.	O
in	O
this	O
case	O
,	O
one	O
may	O
ﬁnd	O
a	O
least-squares	B
solution	I
,	O
sub-	O
ject	O
to	O
(	O
cid:10	O
)	O
f	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
in	O
essentially	O
the	O
same	O
manner	O
as	O
that	O
of	O
section	O
4.1.1	O
(	O
p90	O
)	O
,	O
as	O
the	O
singular	O
vector	O
corresponding	O
to	O
the	O
smallest	O
singular	O
value	O
of	O
a.	O
refer	O
to	O
algorithm	O
4.2	O
(	O
p109	O
)	O
for	O
details	O
.	O
this	O
linear	B
solution	I
is	O
the	O
equivalent	B
of	O
the	O
8-point	O
algorithm	B
11.1	O
(	O
p282	O
)	O
for	O
the	O
computation	B
of	I
a	O
general	O
fundamental	O
matrix	B
.	O
we	O
do	O
not	O
recom-	O
mend	O
this	O
approach	O
for	O
estimating	O
fa	O
because	O
the	O
gold	O
standard	O
algorithm	B
described	O
below	O
may	O
be	O
implemented	O
with	O
equal	O
computational	O
ease	O
,	O
and	O
in	O
general	O
will	O
have	O
superior	O
performance	B
.	O
the	O
singularity	B
constraint	I
.	O
the	O
form	O
(	O
14.1	O
)	O
of	O
fa	O
ensures	O
that	O
the	O
matrix	B
has	O
rank	O
no	O
greater	O
than	O
2.	O
consequently	O
,	O
if	O
fa	O
is	O
estimated	O
by	O
the	O
linear	B
method	O
above	O
it	O
is	O
not	O
necessary	O
to	O
subsequently	O
impose	O
a	O
singularity	B
constraint	I
.	O
this	O
is	O
a	O
considerable	O
advantage	O
over	O
the	O
estimation	B
of	I
a	O
general	O
f	O
by	O
the	O
linear	B
8-point	O
algorithm	B
,	O
where	O
the	O
estimated	O
matrix	B
is	O
not	O
guaranteed	O
to	O
have	O
rank	O
2	O
,	O
and	O
thus	O
must	O
be	O
subsequently	O
corrected	O
.	O
geometric	B
interpretation	I
.	O
as	O
has	O
been	O
seen	O
at	O
several	O
points	O
in	O
this	O
book	O
,	O
comput-	O
ing	O
a	O
two-view	O
relation	B
from	O
point	B
correspondences	O
is	O
equivalent	B
to	O
ﬁtting	O
a	O
surface	O
in	O
ir4	O
.	O
in	O
the	O
case	O
of	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
tfax	O
=	O
0	O
the	O
relation	B
(	O
variety	O
)	O
to	O
points	O
x	O
,	O
y	O
,	O
x	O
i	O
+	O
cxi	O
+	O
dyi	O
+	O
e	O
=	O
0	O
is	O
linear	B
in	O
the	O
coordinates	B
,	O
and	O
the	O
variety	O
vfa	O
deﬁned	O
(	O
cid:2	O
)	O
ax	O
by	O
the	O
afﬁne	B
fundamental	I
matrix	I
is	O
a	O
hyperplane	O
.	O
(	O
cid:2	O
)	O
i	O
+	O
by	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
this	O
results	O
in	O
two	O
simpliﬁcations	O
:	O
ﬁrst	O
,	O
ﬁnding	O
the	O
best	O
estimate	O
of	O
fa	O
may	O
be	O
for-	O
mulated	O
as	O
a	O
(	O
familiar	O
)	O
plane-ﬁtting	O
problem	O
;	O
second	O
,	O
the	O
sampson	O
error	B
is	O
identical	O
to	O
the	O
geometric	B
error	I
,	O
whereas	O
in	O
the	O
case	O
of	O
a	O
general	O
(	O
non-afﬁne	O
)	O
fundamental	O
ma-	O
trix	O
(	O
11.9–p287	O
)	O
it	O
is	O
only	O
a	O
ﬁrst-order	O
approximation	O
.	O
as	O
discussed	O
in	O
section	O
4.2.6-	O
(	O
p98	O
)	O
this	O
latter	O
property	O
arises	O
generally	O
with	O
afﬁne	O
(	O
linear	B
)	O
relations	O
because	O
the	O
tan-	O
gent	O
plane	B
of	O
the	O
sampson	O
approximation	O
is	O
equivalent	B
to	O
the	O
surface	O
.	O
14.3.2	O
the	O
gold	O
standard	O
algorithm	B
given	O
a	O
set	O
of	O
n	O
corresponding	O
image	O
points	O
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
}	O
,	O
we	O
seek	O
the	O
maximum	O
like-	O
lihood	O
estimate	O
of	O
fa	O
under	O
the	O
assumption	O
that	O
the	O
noise	B
in	O
the	O
image	O
measurements	O
obeys	O
an	O
isotropic	B
,	O
homogeneous	O
gaussian	O
distribution	B
.	O
this	O
estimate	O
is	O
obtained	O
by	O
minimizing	B
a	O
cost	B
function	I
on	O
geometric	B
image	O
distances	O
:	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:7	O
)	O
(	O
14.4	O
)	O
i	O
min	O
{	O
fa	O
,	O
ˆxi	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
}	O
i	O
i	O
are	O
the	O
measured	O
correspondences	B
,	O
and	O
ˆxi	O
and	O
ˆx	O
(	O
cid:2	O
)	O
where	O
as	O
usual	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
are	O
estimated	O
“	O
true	O
”	O
correspondences	B
that	O
satisfy	O
ˆx	O
(	O
cid:2	O
)	O
tfaˆxi	O
=	O
0	O
exactly	O
for	O
the	O
estimated	O
afﬁne	B
fun-	O
damental	O
matrix	B
.	O
the	O
distances	O
are	O
illustrated	O
in	O
ﬁgure	O
14.3.	O
the	O
true	O
correspondences	B
are	O
subsidiary	O
variables	O
that	O
must	O
also	O
be	O
estimated	O
.	O
i	O
as	O
discussed	O
above	O
,	O
and	O
in	O
section	O
4.2.5	O
(	O
p96	O
)	O
,	O
minimizing	B
the	I
cost	I
function	I
(	O
14.4	O
)	O
14	O
afﬁne	B
epipolar	O
geometry	O
(	O
n	O
=	O
c	O
d	O
)	O
/	O
y	O
350	O
y	O
d	O
x	O
x	O
epipolar	B
line	I
for	O
x	O
/	O
/	O
n	O
=	O
(	O
a	O
b	O
)	O
/	O
x	O
d/	O
/	O
x	O
epipolar	B
line	I
for	O
x	O
x	O
/	O
x	O
fig	O
.	O
14.3.	O
the	O
mle	O
of	O
fa	O
from	O
a	O
set	O
of	O
measured	O
corresponding	O
points	O
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
the	O
ﬁve	O
parameters	B
a	O
,	O
b	O
,	O
c	O
,	O
d	O
,	O
e	O
together	O
with	O
a	O
set	O
of	O
correspondences	O
{	O
ˆxi	O
↔	O
ˆx	O
(	O
cid:1	O
)	O
ˆx	O
(	O
cid:1	O
)	O
tfaˆxi	O
=	O
0.	O
there	O
is	O
a	O
linear	B
solution	I
to	O
this	O
problem	O
.	O
i	O
i	O
}	O
involves	O
estimating	B
i	O
}	O
which	O
exactly	O
satisfy	O
y	O
n	O
x	O
d	O
x	O
x	O
fig	O
.	O
14.4.	O
in	O
2d	O
a	O
line	B
is	O
the	O
analogue	O
of	O
the	O
hyperplane	O
deﬁned	O
by	O
fa	O
,	O
and	O
the	O
problem	O
of	O
estimating	B
the	O
true	O
correspondence	B
given	O
a	O
measured	O
correspondence	B
,	O
is	O
the	O
problem	O
of	O
determining	O
the	O
closest	O
point	B
(	O
ˆx	O
,	O
ˆy	O
)	O
on	O
the	O
line	B
ax	O
+	O
by	O
+	O
c	O
to	O
a	O
measurement	O
point	O
(	O
x	O
,	O
y	O
)	O
.	O
the	O
normal	O
to	O
the	O
line	B
has	O
direction	O
(	O
a	O
,	O
b	O
)	O
,	O
and	O
the	O
perpendicular	O
distance	B
of	O
the	O
point	B
(	O
x	O
,	O
y	O
)	O
from	O
the	O
line	B
is	O
d⊥	O
=	O
(	O
ax	O
+	O
by	O
+	O
c	O
)	O
/	O
a2	O
+	O
b2	O
,	O
so	O
that	O
(	O
ˆx	O
,	O
ˆy	O
)	O
t	O
=	O
(	O
x	O
,	O
y	O
)	O
t	O
−	O
d⊥ˆn	O
,	O
where	O
ˆn	O
=	O
(	O
a	O
,	O
b	O
)	O
/	O
a2	O
+	O
b2	O
.	O
√	O
√	O
estimated	O
points	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
ˆx	O
(	O
cid:2	O
)	O
written	O
as	O
(	O
(	O
cid:23	O
)	O
xt	O
i	O
,	O
ˆy	O
(	O
cid:2	O
)	O
is	O
equivalent	B
to	O
ﬁtting	O
a	O
hyperplane	O
to	O
set	O
of	B
points	I
xi	O
=	O
(	O
x	O
i	O
)	O
t	O
satisfy	O
the	O
equation	O
ˆx	O
(	O
cid:2	O
)	O
i	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
xi	O
,	O
yi	O
)	O
t	O
in	O
ir4	O
.	O
the	O
i	O
,	O
y	O
tfaˆxi	O
=	O
0	O
which	O
may	O
be	O
i	O
,	O
1	O
)	O
f	O
=	O
0	O
,	O
where	O
f	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
,	O
e	O
)	O
t.	O
this	O
is	O
the	O
equation	O
of	O
a	O
point	O
in	O
ir4	O
on	O
the	O
plane	B
f.	O
we	O
seek	O
the	O
plane	B
f	O
which	O
minimizes	O
the	O
squared	O
distance	O
between	O
the	O
measured	O
and	O
estimated	O
points	O
,	O
and	O
consequently	O
which	O
minimizes	O
the	O
sum	O
of	O
squared	O
perpendicular	O
distances	O
to	O
the	O
points	O
xi	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
xi	O
,	O
yi	O
)	O
t.	O
i	O
,	O
ˆxi	O
,	O
ˆy	O
geometrically	O
the	O
solution	B
is	O
very	O
simple	O
,	O
and	O
an	O
analogue	O
for	O
line	O
ﬁtting	O
in	O
2d	O
is	O
(	O
cid:2	O
)	O
i	O
)	O
t	O
illustrated	O
in	O
ﬁgure	O
14.4.	O
the	O
perpendicular	O
distance	B
of	O
a	O
point	B
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
x	O
from	O
the	O
plane	B
f	O
is	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
(	O
cid:2	O
)	O
i	O
,	O
y	O
d⊥	O
(	O
xi	O
,	O
f	O
)	O
=	O
ax	O
(	O
cid:2	O
)	O
√	O
i	O
+	O
by	O
(	O
cid:2	O
)	O
i	O
+	O
cxi	O
+	O
dyi	O
+	O
e	O
a2	O
+	O
b2	O
+	O
c2	O
+	O
d2	O
.	O
then	O
the	O
matrix	B
fa	O
which	O
minimizes	O
(	O
14.4	O
)	O
is	O
determined	O
by	O
minimizing	O
the	O
cost	O
func-	O
tion	O
d⊥	O
(	O
xi	O
,	O
f	O
)	O
2	O
=	O
1	O
a2	O
+	O
b2	O
+	O
c2	O
+	O
d2	O
i	O
(	O
cid:2	O
)	O
i	O
+	O
by	O
(	O
cid:2	O
)	O
i	O
+	O
cxi	O
+	O
dyi	O
+	O
e	O
)	O
2	O
(	O
ax	O
(	O
14.5	O
)	O
(	O
cid:7	O
)	O
i	O
c	O
=	O
(	O
cid:7	O
)	O
14.3	O
estimating	B
fa	O
from	O
image	O
point	B
correspondences	O
351	O
objective	O
given	O
n	O
≥	O
4	O
image	O
point	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
likelihood	O
estimate	O
fa	O
of	O
the	O
afﬁne	O
fundamental	B
matrix	I
.	O
i	O
}	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
,	O
determine	O
the	O
maximum	O
algorithm	B
a	O
correspondence	B
is	O
represented	O
as	O
xi	O
=	O
(	O
x	O
(	O
cid:1	O
)	O
i	O
,	O
y	O
(	O
cid:1	O
)	O
i	O
,	O
xi	O
,	O
yi	O
)	O
t.	O
(	O
cid:27	O
)	O
(	O
i	O
)	O
compute	O
the	O
centroid	O
x	O
=	O
1	O
(	O
ii	O
)	O
compute	O
the	O
n	O
×	O
4	O
matrix	B
a	O
with	O
rows	O
∆xt	O
i	O
.	O
(	O
iii	O
)	O
then	O
n	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
t	O
is	O
the	O
singular	O
vector	O
corresponding	O
to	O
the	O
smallest	O
singular	O
i	O
xi	O
and	O
centre	B
the	O
vectors	O
∆xi	O
=	O
xi	O
−	O
x.	O
value	O
of	O
a	O
,	O
and	O
e	O
=	O
−ntx	O
.	O
the	O
matrix	B
fa	O
has	O
the	O
form	O
(	O
14.1	O
)	O
.	O
n	O
algorithm	B
14.1.	O
the	O
gold	O
standard	O
algorithm	B
for	O
estimating	B
fa	O
from	O
image	O
correspondences	B
.	O
over	O
the	O
5	O
parameters	B
{	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
,	O
e	O
}	O
of	O
f.	O
writing	O
n	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
t	O
for	O
the	O
normal	O
to	O
the	O
hyperplane	O
then	O
(	O
cid:7	O
)	O
(	O
cid:15	O
)	O
i	O
c	O
=	O
1	O
(	O
cid:10	O
)	O
n	O
(	O
cid:10	O
)	O
2	O
ntxi	O
+	O
e	O
2	O
.	O
this	O
cost	B
function	I
can	O
be	O
minimized	O
by	O
a	O
very	O
simple	O
linear	O
algorithm	B
,	O
equivalent	B
to	O
the	O
classical	O
problem	O
of	O
orthogonal	B
regression	I
to	O
a	O
plane	B
.	O
there	O
are	O
two	O
steps	O
:	O
the	O
ﬁrst	O
step	O
is	O
to	O
minimize	O
c	O
over	O
the	O
parameter	O
e.	O
we	O
obtain	O
(	O
cid:16	O
)	O
(	O
cid:16	O
)	O
2	O
∂c	O
∂e	O
=	O
2	O
(	O
ntxi	O
+	O
e	O
)	O
=	O
0	O
(	O
cid:7	O
)	O
1	O
(	O
cid:10	O
)	O
n	O
(	O
cid:10	O
)	O
2	O
(	O
cid:7	O
)	O
(	O
ntxi	O
)	O
=−	O
ntx	O
i	O
e	O
=	O
−	O
1	O
n	O
i	O
(	O
cid:7	O
)	O
(	O
cid:15	O
)	O
i	O
c	O
=	O
1	O
(	O
cid:10	O
)	O
n	O
(	O
cid:10	O
)	O
2	O
nt∆xi	O
and	O
hence	O
so	O
the	O
solution	B
hyperplane	O
passes	O
through	O
the	O
data	O
centroid	O
x.	O
substituting	O
for	O
e	O
in	O
the	O
cost	B
function	I
reduces	O
c	O
to	O
where	O
∆xi	O
=	O
xi	O
−	O
x	O
is	O
the	O
vector	O
xi	O
relative	O
to	O
the	O
data	O
centroid	O
x.	O
the	O
second	O
step	O
is	O
to	O
minimize	O
this	O
reduced	B
cost	O
function	O
over	O
n.	O
writing	O
a	O
for	O
the	O
matrix	B
with	O
rows	O
∆xt	O
i	O
,	O
it	O
is	O
evident	O
that	O
c	O
=	O
(	O
cid:10	O
)	O
an	O
(	O
cid:10	O
)	O
2/	O
(	O
cid:10	O
)	O
n	O
(	O
cid:10	O
)	O
2.	O
minimizing	B
this	O
expression	O
is	O
equivalent	B
to	O
minimizing	B
(	O
cid:10	O
)	O
an	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
n	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
which	O
is	O
our	O
usual	O
homogeneous	O
minimization	O
problem	O
solved	O
by	O
the	O
svd	O
.	O
these	O
steps	O
are	O
summarized	O
in	O
algorithm	O
14.1.	O
it	O
is	O
worth	O
noting	O
that	O
the	O
gold	O
standard	O
algorithm	B
produces	O
an	O
identical	O
estimate	O
of	O
fa	O
to	O
that	O
obtained	O
by	O
the	O
factorization	B
algorithm	O
18.1	O
(	O
p437	O
)	O
for	O
an	O
afﬁne	B
reconstruc-	O
tion	O
from	O
n	O
point	B
correspondences	O
.	O
352	O
14	O
afﬁne	B
epipolar	O
geometry	O
x	O
2	O
x	O
1	O
x	O
4	O
x3	O
π	O
x	O
/	O
2	O
x/	O
3	O
x	O
/	O
4	O
4axh	O
h	O
a	O
/	O
x	O
1	O
x	O
2	O
x1	O
x4	O
x3	O
fig	O
.	O
14.5.	O
computing	B
the	O
afﬁne	B
epipolar	O
line	B
for	O
a	O
minimal	B
conﬁguration	I
of	O
four	O
points	O
.	O
the	O
line	B
is	O
computed	O
by	O
the	O
virtual	O
parallax	B
induced	O
by	O
the	O
plane	B
π.	O
compare	O
ﬁgure	O
13.7	O
(	O
p335	O
)	O
.	O
objective	O
given	O
four	O
image	O
point	B
correspondences	O
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
mental	O
matrix	B
.	O
i	O
}	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
4	O
,	O
compute	O
the	O
afﬁne	B
funda-	O
algorithm	B
the	O
ﬁrst	O
three	O
3-space	O
points	O
xi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
3	O
deﬁne	O
a	O
plane	B
π.	O
see	O
ﬁgure	O
14.5	O
.	O
(	O
i	O
)	O
compute	O
the	O
afﬁne	B
transformation	I
matrix	O
ha	O
,	O
such	O
that	O
x	O
(	O
cid:1	O
)	O
(	O
ii	O
)	O
determine	O
the	O
epipolar	B
line	I
in	O
the	O
second	O
view	O
from	O
l	O
(	O
cid:1	O
)	O
=	O
(	O
hax4	O
)	O
×	O
x	O
(	O
cid:1	O
)	O
4.	O
the	O
epipole	O
(	O
iii	O
)	O
then	O
for	O
any	O
point	B
x	O
the	O
epipolar	B
line	I
in	O
the	O
second	O
view	O
is	O
e	O
(	O
cid:1	O
)	O
×	O
(	O
hax	O
)	O
=	O
fax	O
.	O
hence	O
i	O
=	O
haxi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
3.	O
e	O
(	O
cid:1	O
)	O
=	O
(	O
−l	O
(	O
cid:1	O
)	O
2	O
,	O
l	O
fa	O
=	O
[	O
(	O
−l	O
(	O
cid:1	O
)	O
2	O
,	O
l	O
(	O
cid:1	O
)	O
1	O
,	O
0	O
)	O
t.	O
(	O
cid:1	O
)	O
1	O
,	O
0	O
)	O
t	O
]	O
×ha	O
.	O
algorithm	B
14.2.	O
the	O
computation	B
of	I
fa	O
for	O
a	O
minimal	O
conﬁguration	O
of	O
four	O
point	B
correspondences	O
.	O
14.3.3	O
the	O
minimal	B
conﬁguration	I
we	O
return	O
to	O
the	O
minimal	B
conﬁguration	I
for	O
estimating	B
fa	O
,	O
namely	O
the	O
corresponding	O
images	O
of	O
four	O
points	O
in	O
3-space	O
in	O
general	O
position	O
.	O
a	O
geometric	B
computation	O
method	O
of	O
fa	O
for	O
this	O
conﬁguration	O
is	O
described	O
in	O
algorithm	O
14.2.	O
this	O
minimal	B
solution	I
is	O
useful	O
in	O
the	O
case	O
of	O
robust	O
estimation	B
algorithms	O
,	O
such	O
as	O
ransac	O
,	O
and	O
will	O
be	O
used	O
here	O
to	O
illustrate	O
degenerate	B
conﬁgurations	I
.	O
note	O
that	O
for	O
this	O
minimal	B
conﬁguration	I
an	O
exact	O
solution	B
is	O
obtained	O
for	O
fa	O
,	O
and	O
the	O
linear	B
algorithm	I
of	O
section	O
14.3.1	O
,	O
the	O
gold	O
standard	O
algorithm	B
14.1	O
,	O
and	O
the	O
minimal	O
algorithm	O
14.2	O
give	O
an	O
identical	O
result	O
.	O
general	B
position	I
.	O
the	O
conﬁguration	O
of	O
four	O
points	O
shown	O
in	O
ﬁgure	O
14.5	O
demonstrates	O
the	O
conditions	O
necessary	O
for	O
general	O
position	O
of	O
the	O
3-space	O
points	O
when	O
computing	B
fa	O
.	O
conﬁgurations	O
for	O
which	O
fa	O
can	O
not	O
be	O
computed	O
are	O
degenerate	B
.	O
these	O
fall	O
into	O
two	O
classes	O
:	O
ﬁrst	O
,	O
degenerate	B
conﬁgurations	I
depending	O
only	O
on	O
the	O
structure	B
,	O
for	O
example	O
if	O
the	O
four	O
points	O
are	O
coplanar	O
(	O
so	O
there	O
is	O
no	O
parallax	O
)	O
,	O
or	O
if	O
the	O
ﬁrst	O
three	O
points	O
are	O
collinear	O
(	O
so	O
that	O
ha	O
can	O
’	O
t	O
be	O
computed	O
)	O
;	O
second	O
,	O
those	O
degeneracies	B
which	O
depend	O
14.4	O
triangulation	B
353	O
only	O
on	O
the	O
cameras	B
,	O
for	O
example	O
if	O
the	O
two	O
cameras	O
have	O
the	O
same	O
viewing	O
direction	O
(	O
and	O
so	O
have	O
common	O
centres	O
on	O
the	O
plane	O
at	O
inﬁnity	O
)	O
.	O
note	O
once	O
again	O
the	O
importance	O
of	O
parallax	O
–	O
as	O
the	O
point	B
x4	O
approaches	O
the	O
plane	B
deﬁned	O
by	O
the	O
other	O
three	O
points	O
in	O
ﬁgure	O
14.5	O
the	O
parallax	B
vector	O
,	O
which	O
determines	O
the	O
epipolar	B
line	I
direction	O
,	O
is	O
monotonically	O
reduced	B
in	O
length	O
.	O
consequently	O
,	O
the	O
accuracy	O
of	O
the	O
line	O
direction	O
is	O
correspondingly	O
reduced	B
.	O
this	O
result	O
for	O
the	O
minimal	O
conﬁgura-	O
tion	O
is	O
true	O
also	O
of	O
the	O
gold	O
standard	O
algorithm	B
14.1	O
:	O
as	O
relief	O
reduces	O
to	O
zero	O
,	O
i.e	O
.	O
the	O
point	B
set	O
approaches	O
coplanarity	O
,	O
the	O
covariance	B
of	O
the	O
estimated	O
fa	O
will	O
increase	O
.	O
14.4	O
triangulation	B
suppose	O
we	O
have	O
a	O
measured	O
correspondence	B
(	O
x	O
,	O
y	O
)	O
↔	O
(	O
x	O
)	O
and	O
the	O
afﬁne	B
funda-	O
mental	O
matrix	B
fa	O
.	O
we	O
wish	O
to	O
determine	O
the	O
maximum	O
likelihood	O
estimate	O
of	O
the	O
true	O
correspondence	B
,	O
(	O
ˆx	O
,	O
ˆy	O
)	O
↔	O
(	O
ˆx	O
)	O
,	O
under	O
the	O
usual	O
assumption	O
that	O
image	O
measure-	O
ment	O
error	B
is	O
gaussian	O
.	O
the	O
3d	O
point	B
may	O
then	O
be	O
determined	O
from	O
the	O
ml	O
estimate	O
correspondence	B
.	O
(	O
cid:2	O
)	O
,	O
ˆy	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
as	O
we	O
have	O
seen	O
earlier	O
the	O
mle	O
involves	O
determining	B
a	O
i.e	O
.	O
,	O
1	O
)	O
fa	O
(	O
ˆx	O
,	O
ˆy	O
,	O
1	O
)	O
t	O
=	O
0	O
,	O
and	O
also	O
minimizes	O
the	O
image	O
distance	O
to	O
the	O
measured	O
“	O
true	O
”	O
correspondence	B
which	O
exactly	O
obeys	O
the	O
afﬁne	B
epipolar	O
geometry	O
,	O
(	O
cid:2	O
)	O
(	O
ˆx	O
,	O
ˆy	O
points	O
,	O
in	O
chapter	O
12	O
,	O
(	O
cid:2	O
)	O
(	O
x	O
−	O
ˆx	O
)	O
2	O
+	O
(	O
y	O
−	O
ˆy	O
)	O
2	O
+	O
(	O
x	O
(	O
cid:2	O
)	O
−	O
ˆx	O
(	O
cid:2	O
)	O
)	O
2	O
+	O
(	O
y	O
(	O
cid:2	O
)	O
−	O
ˆy	O
(	O
cid:2	O
)	O
)	O
2	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
geometrically	O
the	O
solution	B
is	O
very	O
simple	O
,	O
and	O
is	O
illustrated	O
in	O
2d	O
in	O
ﬁgure	O
14.4.	O
we	O
seek	O
the	O
closest	O
point	B
on	O
the	O
hyperplane	O
deﬁned	O
by	O
fa	O
to	O
the	O
measured	O
correspondence	B
,	O
x	O
,	O
y	O
)	O
t	O
in	O
ir4	O
.	O
again	O
,	O
the	O
sampson	O
correction	B
(	O
4.11–p99	O
)	O
is	O
exact	O
in	O
this	O
x	O
=	O
(	O
x	O
case	O
.	O
algebraically	O
,	O
the	O
normal	O
to	O
the	O
hyperplane	O
has	O
direction	O
n	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
t	O
and	O
the	O
perpendicular	O
distance	B
of	O
a	O
point	B
x	O
to	O
the	O
hyperplane	O
is	O
given	O
by	O
d⊥	O
=	O
(	O
ntx+e	O
)	O
/	O
(	O
cid:10	O
)	O
n	O
(	O
cid:10	O
)	O
,	O
so	O
that	O
,	O
y	O
n	O
(	O
cid:10	O
)	O
n	O
(	O
cid:10	O
)	O
(	O
cid:23	O
)	O
x	O
=	O
x	O
−	O
d⊥	O
	O
−	O
(	O
ax	O
+	O
by	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
+	O
cx	O
+	O
dy	O
+	O
e	O
)	O
(	O
a2	O
+	O
b2	O
+	O
c2	O
+	O
d2	O
)	O
or	O
in	O
its	O
full	O
detail	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ˆy	O
ˆx	O
ˆy	O
	O
=	O
	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
x	O
y	O
	O
.	O
	O
a	O
b	O
c	O
d	O
14.5	O
afﬁne	B
reconstruction	I
suppose	O
we	O
have	O
n	O
≥	O
4	O
image	O
point	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
,	O
i	O
=	O
0	O
,	O
.	O
.	O
.	O
,	O
n−1	O
,	O
which	O
for	O
the	O
moment	O
will	O
be	O
assumed	O
noise-free	O
,	O
then	O
we	O
may	O
compute	O
a	O
reconstruction	B
of	O
the	O
3d	O
points	O
and	O
cameras	B
.	O
in	O
the	O
case	O
of	O
projective	O
cameras	B
(	O
with	O
n	O
≥	O
7	O
points	O
)	O
the	O
reconstruction	B
was	O
projective	B
.	O
in	O
the	O
afﬁne	B
case	O
,	O
not	O
surprisingly	O
,	O
the	O
reconstruction	B
is	O
afﬁne	B
.	O
we	O
will	O
now	O
give	O
a	O
simple	O
constructive	O
derivation	B
of	O
this	O
result	O
.	O
an	O
afﬁne	B
coordinate	O
frame	O
in	O
3-space	O
may	O
be	O
speciﬁed	O
by	O
four	O
ﬁnite	O
non-coplanar	O
basis	O
points	O
xi	O
,	O
i	O
=	O
0	O
,	O
.	O
.	O
.	O
,3	O
.	O
as	O
illustrated	O
in	O
ﬁgure	O
14.6	O
one	O
point	B
x0	O
is	O
chosen	O
as	O
the	O
354	O
14	O
afﬁne	B
epipolar	O
geometry	O
x	O
3	O
e	O
3	O
x	O
2	O
2e	O
x	O
0	O
1e	O
x	O
1	O
a	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
y	O
2e	O
e3	O
x	O
z	O
e1	O
b	O
fig	O
.	O
14.6.	O
afﬁne	B
coordinates	O
.	O
(	O
a	O
)	O
four	O
non-coplanar	O
points	O
in	O
3-space	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
and	O
origin	O
x0	O
)	O
deﬁne	O
a	O
set	O
of	O
axes	O
in	O
terms	O
of	O
which	O
other	O
points	O
x	O
can	O
be	O
assigned	O
afﬁne	B
coordinates	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
.	O
(	O
b	O
)	O
each	O
afﬁne	B
coordinate	O
is	O
deﬁned	O
by	O
a	O
ratio	O
of	O
lengths	O
in	O
parallel	O
directions	O
(	O
which	O
is	O
an	O
afﬁne	B
invariant	O
)	O
.	O
for	O
example	O
,	O
x	O
may	O
be	O
computed	O
by	O
the	O
following	O
two	O
operations	O
:	O
ﬁrst	O
,	O
x	O
is	O
projected	O
parallel	B
to	O
(	O
cid:22	O
)	O
e2	O
onto	O
the	O
plane	B
spanned	O
by	O
(	O
cid:22	O
)	O
e1	O
and	O
(	O
cid:22	O
)	O
e3	O
.	O
second	O
,	O
this	O
projected	O
point	B
is	O
projected	O
parallel	B
to	O
(	O
cid:22	O
)	O
e3	O
onto	O
the	O
(	O
cid:22	O
)	O
e1	O
axis	O
.	O
the	O
value	O
of	O
the	O
coordinate	O
x	O
is	O
the	O
ratio	O
of	O
the	O
length	O
from	O
the	O
origin	O
of	O
this	O
ﬁnal	O
projected	O
point	B
to	O
the	O
length	O
of	O
(	O
cid:22	O
)	O
e1	O
.	O
x	O
0	O
e	O
1	O
x	O
e	O
3	O
x	O
3	O
image	O
1	O
e	O
2	O
x	O
1	O
x	O
2	O
x	O
/	O
1	O
x	O
/	O
2	O
/	O
x	O
/	O
e	O
1	O
/	O
e2	O
x	O
/	O
3	O
x	O
/	O
0	O
/e	O
3	O
image	O
2	O
fig	O
.	O
14.7.	O
reconstruction	B
from	O
two	O
images	O
.	O
the	O
afﬁne	B
coordinates	O
of	O
the	O
3d	O
point	B
x	O
with	O
image	O
x	O
,	O
x	O
(	O
cid:1	O
)	O
in	O
two	O
views	O
may	O
be	O
computed	O
linearly	O
from	O
the	O
projection	B
of	O
the	O
basis	O
points	O
xi	O
and	O
basis	O
vectors	O
˜ei	O
of	O
ﬁgure	O
14.6.	O
origin	O
,	O
and	O
the	O
three	O
other	O
points	O
then	O
deﬁne	O
basis	O
vectors	O
(	O
cid:22	O
)	O
ei	O
=	O
(	O
cid:22	O
)	O
xi	O
−	O
(	O
cid:22	O
)	O
x0	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
,	O
where	O
(	O
cid:22	O
)	O
xi	O
is	O
the	O
inhomogeneous	O
3-vector	O
corresponding	O
to	O
xi	O
.	O
the	O
position	O
of	O
a	O
point	O
and	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
are	O
the	O
afﬁne	B
coordinates	O
of	O
(	O
cid:22	O
)	O
x	O
with	O
respect	O
to	O
this	O
basis	O
.	O
this	O
means	O
that	O
x	O
may	O
then	O
be	O
speciﬁed	O
by	O
simple	O
vector	O
addition	O
as	O
(	O
cid:22	O
)	O
x	O
=	O
(	O
cid:22	O
)	O
x0	O
+	O
x	O
(	O
cid:22	O
)	O
e1	O
+	O
y	O
(	O
cid:22	O
)	O
e2	O
+	O
z	O
(	O
cid:22	O
)	O
e3	O
	O
0	O
	O
1	O
	O
(	O
cid:22	O
)	O
x1	O
=	O
	O
(	O
cid:22	O
)	O
x2	O
=	O
	O
(	O
cid:22	O
)	O
x3	O
=	O
the	O
basis	O
points	O
xi	O
have	O
the	O
canonical	O
coordinates	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
:	O
(	O
cid:22	O
)	O
x0	O
=	O
	O
0	O
0	O
0	O
	O
.	O
	O
0	O
0	O
1	O
0	O
0	O
1	O
0	O
(	O
14.6	O
)	O
given	O
the	O
afﬁne	B
projection	O
of	O
the	O
four	O
basis	O
points	O
in	O
two	B
views	I
,	O
the	O
3d	O
afﬁne	B
co-	O
ordinates	O
of	O
any	O
other	O
point	B
can	O
be	O
directly	O
recovered	O
from	O
its	O
image	O
,	O
as	O
will	O
now	O
be	O
demonstrated	O
(	O
see	O
ﬁgure	O
14.7	O
)	O
.	O
14.6	O
necker	O
reversal	O
and	O
the	O
bas-relief	B
ambiguity	I
355	O
projection	B
with	O
an	O
afﬁne	B
camera	I
may	O
be	O
represented	O
as	O
(	O
6.26–p172	O
)	O
(	O
cid:22	O
)	O
x	O
+	O
˜t	O
˜x	O
=	O
m2×3	O
where	O
˜x	O
=	O
(	O
x	O
,	O
y	O
)	O
t	O
is	O
the	O
inhomogeneous	O
2-vector	O
corresponding	O
to	O
x.	O
differences	O
of	O
vectors	O
eliminate	O
˜t	O
.	O
for	O
example	O
the	O
basis	O
vectors	O
project	O
as	O
˜ei	O
=	O
m2×3	O
consequently	O
for	O
any	O
point	B
x	O
,	O
its	O
image	O
in	O
the	O
ﬁrst	O
view	O
is	O
˜x	O
−	O
˜x0	O
=	O
x˜e1	O
+	O
y˜e2	O
+	O
z˜e3	O
(	O
cid:22	O
)	O
x	O
+	O
˜t	O
=	O
m	O
(	O
cid:2	O
)	O
2×3	O
˜x	O
(	O
cid:2	O
)	O
−	O
˜x	O
(	O
cid:2	O
)	O
0	O
=	O
x˜e	O
(	O
cid:2	O
)	O
)	O
in	O
the	O
second	O
view	O
is	O
1	O
+	O
y˜e	O
(	O
cid:2	O
)	O
and	O
similarly	O
the	O
image	O
(	O
˜x	O
(	O
cid:2	O
)	O
2	O
+	O
z˜e	O
(	O
cid:2	O
)	O
3	O
.	O
(	O
14.7	O
)	O
(	O
14.8	O
)	O
(	O
cid:2	O
)	O
(	O
cid:22	O
)	O
ei	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
each	O
equation	O
(	O
14.7	O
)	O
and	O
(	O
14.8	O
)	O
imposes	O
two	O
linear	O
constraints	B
on	O
the	O
unknown	O
afﬁne	B
coordinates	O
x	O
,	O
y	O
,	O
z	O
of	O
the	O
space	O
point	B
x.	O
all	O
the	O
other	O
terms	O
in	O
the	O
equations	O
are	O
known	O
from	O
the	O
projection	B
of	O
the	O
four	O
basis	O
points	O
(	O
cid:22	O
)	O
xi	O
,	O
i	O
=	O
0	O
,	O
.	O
.	O
.	O
,3	O
)	O
.	O
thus	O
,	O
there	O
are	O
four	O
lin-	O
from	O
image	O
measurements	O
(	O
for	O
example	O
the	O
image	O
basis	O
vectors	O
˜ei	O
,	O
˜e	O
(	O
cid:2	O
)	O
i	O
are	O
computed	O
ear	O
simultaneous	O
equations	O
in	O
the	O
three	O
unknowns	O
x	O
,	O
y	O
,	O
z	O
,	O
and	O
the	O
solution	B
is	O
straight-	O
forward	O
.	O
this	O
demonstrates	O
that	O
the	O
afﬁne	B
coordinates	O
of	O
a	O
point	O
x	O
may	O
be	O
computed	O
from	O
its	O
image	O
in	O
two	B
views	I
.	O
between	O
the	O
3-space	O
points	O
(	O
cid:22	O
)	O
xi	O
,	O
with	O
coordinates	O
given	O
in	O
(	O
14.6	O
)	O
,	O
and	O
their	O
measured	O
images	O
.	O
for	O
example	O
,	O
pa	O
is	O
computed	O
from	O
the	O
correspondence	B
˜xi	O
↔	O
(	O
cid:22	O
)	O
xi	O
,	O
i	O
=	O
0	O
,	O
.	O
.	O
.	O
,3	O
.	O
the	O
cameras	B
for	O
the	O
two	B
views	I
,	O
pa	O
,	O
p	O
(	O
cid:2	O
)	O
a	O
,	O
may	O
be	O
computed	O
from	O
the	O
correspondences	B
the	O
above	O
development	O
is	O
not	O
optimal	O
,	O
because	O
the	O
basis	O
points	O
are	O
treated	O
as	O
exact	O
,	O
and	O
all	O
measurement	O
error	O
associated	O
with	O
the	O
ﬁfth	O
point	B
x.	O
an	O
optimal	O
reconstruction	B
algorithm	O
,	O
where	O
reprojection	B
error	I
is	O
minimized	O
over	O
all	O
points	O
,	O
is	O
very	O
straightforward	O
in	O
the	O
afﬁne	B
case	O
.	O
however	O
,	O
its	O
description	O
is	O
postponed	O
until	O
section	O
18.2	O
(	O
p436	O
)	O
be-	O
cause	O
the	O
factorization	B
algorithm	O
described	O
there	O
is	O
applicable	O
to	O
any	O
number	O
of	O
views	O
.	O
example	O
14.2.	O
afﬁne	B
reconstruction	I
a	O
3d	O
reconstruction	B
is	O
computed	O
for	O
the	O
hole	O
punch	O
images	O
of	O
ﬁgure	O
14.2	O
by	O
choosing	O
four	O
points	O
as	O
the	O
afﬁne	B
basis	O
,	O
and	O
then	O
computing	B
the	O
afﬁne	B
coordinates	O
of	O
each	O
of	O
the	O
remaining	O
points	O
in	O
turn	O
by	O
the	O
linear	B
method	O
above	O
.	O
two	B
views	I
of	O
the	O
resulting	O
reconstruction	B
are	O
shown	O
in	O
ﬁgure	O
14.8.	O
note	O
,	O
however	O
,	O
that	O
this	O
ﬁve-point	O
method	O
is	O
not	O
recommended	O
.	O
instead	O
the	O
optimal	O
afﬁne	B
reconstruction	I
algorithm	O
18.1	O
(	O
p437	O
)	O
(	O
cid:2	O
)	O
should	O
be	O
used	O
.	O
14.6	O
necker	O
reversal	O
and	O
the	O
bas-relief	B
ambiguity	I
we	O
have	O
seen	O
in	O
the	O
previous	O
section	O
that	O
in	O
the	O
absence	O
of	O
any	O
calibration	B
informa-	O
tion	O
,	O
an	O
afﬁne	B
reconstruction	I
is	O
obtained	O
from	O
point	O
correspondences	O
alone	O
.	O
in	O
this	O
section	O
we	O
show	O
that	O
even	O
if	O
the	O
camera	B
calibration	I
is	O
known	O
there	O
remains	O
a	O
family	O
of	O
reconstruction	O
ambiguities	B
which	O
can	O
not	O
be	O
resolved	O
in	O
the	O
two-view	O
case	O
.	O
this	O
situation	O
differs	O
from	O
that	O
of	O
perspective	O
projection	B
where	O
once	O
the	O
internal	B
calibration	O
is	O
determined	O
the	O
camera	B
motion	I
is	O
determined	O
up	O
to	O
a	O
ﬁnite	B
number	O
of	O
356	O
14	O
afﬁne	B
epipolar	O
geometry	O
a	O
b	O
c	O
fig	O
.	O
14.8.	O
afﬁne	B
reconstruction	I
.	O
(	O
a	O
)	O
(	O
b	O
)	O
wireframe	O
outline	O
of	O
the	O
hole	O
punch	O
from	O
the	O
two	O
images	O
of	O
ﬁgure	O
14.2.	O
the	O
circles	O
show	O
the	O
points	O
selected	O
as	O
the	O
afﬁne	B
basis	O
.	O
the	O
lines	B
are	O
for	O
visualization	O
only	O
.	O
(	O
c	O
)	O
two	B
views	I
of	O
the	O
3d	O
afﬁne	B
structure	O
computed	O
from	O
the	O
vertices	O
of	O
the	O
wireframe	O
.	O
ambiguities	B
(	O
from	O
the	O
essential	B
matrix	I
,	O
see	O
section	O
9.6	O
(	O
p257	O
)	O
)	O
.	O
for	O
parallel	O
projection	B
there	O
are	O
two	O
important	O
additional	O
ambiguities	B
:	O
a	O
ﬁnite	B
reﬂection	O
ambiguity	B
(	O
necker	O
reversal	O
)	O
;	O
and	O
a	O
one-parameter	O
family	O
rotation	B
ambiguity	O
(	O
the	O
bas-relief	B
ambiguity	I
)	O
.	O
necker	O
reversal	O
ambiguity	B
.	O
this	O
arises	O
because	O
an	O
object	O
rotating	O
by	O
ρ	O
and	O
its	O
mirror	O
image	O
rotating	O
by	O
−ρ	O
generate	O
the	O
same	O
image	O
under	O
parallel	B
projection	I
,	O
see	O
ﬁgure	O
14.9	O
(	O
a	O
)	O
.	O
thus	O
,	O
structure	B
is	O
only	O
recovered	O
up	O
to	O
a	O
reﬂection	O
about	O
the	O
frontal	O
plane	B
.	O
this	O
ambiguity	B
is	O
absent	O
in	O
the	O
perspective	O
case	O
because	O
the	O
points	O
have	O
differ-	O
ent	O
depths	O
in	O
the	O
two	O
interpretations	O
and	O
so	O
do	O
not	O
project	O
to	O
coincident	O
image	O
points	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
14.9	O
(	O
b	O
)	O
.	O
the	O
bas-relief	B
ambiguity	I
.	O
imagine	O
a	O
set	O
of	O
parallel	O
rays	O
from	O
one	O
camera	B
,	O
and	O
consider	O
adjusting	O
a	O
set	O
of	O
parallel	O
rays	O
from	O
a	O
second	O
camera	B
until	O
each	O
ray	O
intersects	O
its	O
corresponding	O
ray	O
.	O
the	O
rays	O
lie	O
in	O
a	O
family	O
of	O
parallel	O
epipolar	O
planes	O
,	O
and	O
there	O
remains	O
the	O
freedom	O
to	O
rotate	O
one	O
camera	B
about	O
the	O
normal	O
to	O
these	O
planes	O
whilst	O
maintaining	O
incidence	O
of	O
the	O
rays	O
.	O
this	O
bas-relief	B
(	O
or	O
depth–turn	O
)	O
ambiguity	B
is	O
a	O
one-parameter	O
family	O
of	O
solutions	O
for	O
the	O
rotation	B
angle	O
and	O
depth	O
.	O
the	O
parameters	B
of	O
depth	O
,	O
∆z	O
,	O
and	O
rotation	B
,	O
sin	O
ρ	O
,	O
are	O
confounded	O
and	O
can	O
not	O
be	O
determined	O
individually	O
–	O
only	O
their	O
product	O
can	O
be	O
computed	O
.	O
consequently	O
,	O
a	O
shallow	O
object	O
experiencing	O
a	O
large	O
turn	O
(	O
i.e	O
.	O
small	O
∆z	O
and	O
large	O
ρ	O
)	O
generates	O
the	O
same	O
image	O
as	O
a	O
deep	O
object	O
experiencing	O
a	O
small	O
turn	O
(	O
i.e	O
.	O
large	O
∆z	O
and	O
small	O
ρ	O
)	O
.	O
the	O
name	O
arises	O
from	O
bas-relief	O
sculptures	O
.	O
fixing	O
the	O
depth	O
or	O
the	O
angle	B
ρ	O
determines	O
the	O
structure	B
and	O
the	O
motion	O
uniquely	O
.	O
extra	O
points	O
can	O
not	O
resolve	O
this	O
ambiguity	B
,	O
but	O
an	O
additional	O
view	O
(	O
i.e	O
.	O
three	O
views	O
)	O
will	O
in	O
general	O
resolve	O
it	O
.	O
14.7	O
computing	B
the	O
motion	O
357	O
z	O
z	O
−ρ	O
ρ	O
frontal	O
plane	B
−ρ	O
ρ	O
parallel	B
ρ	O
z∆	O
1	O
b	O
x	O
?	O
?	O
?	O
x	O
perspective	O
a	O
ρ	O
l	O
l	O
a	O
a	O
’	O
x	O
/	O
x	O
x	O
c	O
fig	O
.	O
14.9.	O
motion	O
ambiguities	B
under	O
parallel	B
projection	I
.	O
(	O
a	O
)	O
necker	O
reversal	O
:	O
a	O
rotating	O
object	O
gen-	O
erates	O
the	O
same	O
image	O
as	O
its	O
mirror	O
object	O
rotating	O
in	O
the	O
opposite	O
sense	O
.	O
under	O
perspective	O
projection	B
the	O
images	O
are	O
different	O
.	O
(	O
b	O
)	O
the	O
cameras	B
can	O
rotate	O
(	O
by	O
ρ	O
)	O
and	O
still	O
preserve	O
ray	O
intersections	O
.	O
this	O
can	O
not	O
happen	O
for	O
perspective	O
cameras	B
.	O
(	O
c	O
)	O
the	O
bas-relief	B
ambiguity	I
:	O
consider	O
a	O
rod	O
of	O
length	O
l	O
,	O
which	O
(	O
cid:1	O
)	O
−	O
x	O
=	O
l	O
sin	O
ρ.	O
this	O
bas–relief	O
(	O
or	O
depth–turn	O
)	O
ambiguity	B
is	O
so-	O
rotates	O
through	O
an	O
angle	B
ρ.	O
that	O
is	O
x	O
named	O
because	O
a	O
shallow	O
object	O
experiencing	O
a	O
large	O
turn	O
(	O
i.e	O
.	O
small	O
l	O
and	O
big	O
ρ	O
)	O
generates	O
the	O
same	O
image	O
as	O
a	O
deep	O
object	O
experiencing	O
a	O
small	O
turn	O
(	O
i.e	O
.	O
large	O
l	O
and	O
small	O
ρ	O
)	O
.	O
this	O
ambiguity	B
casts	O
light	O
on	O
the	O
stability	B
of	O
reconstruction	B
from	O
two	O
perspective	O
cameras	B
:	O
as	O
imaging	O
conditions	O
approach	O
afﬁne	B
the	O
rotation	B
angle	O
will	O
be	O
poorly	O
esti-	O
mated	O
,	O
but	O
the	O
product	O
of	O
the	O
rotation	O
angle	B
and	O
depth	O
will	O
be	O
stable	O
.	O
14.7	O
computing	B
the	O
motion	O
in	O
this	O
section	O
expressions	O
for	O
computing	O
the	O
camera	B
motion	I
from	O
fa	O
will	O
be	O
given	O
for	O
the	O
case	O
of	O
two	O
weak	B
perspective	I
cameras	O
(	O
section	O
6.3.4	O
(	O
p170	O
)	O
)	O
.	O
these	O
cameras	B
may	O
be	O
chosen	O
as	O
	O
α	O
(	O
cid:2	O
)	O
x	O
p	O
(	O
cid:2	O
)	O
=	O
	O
	O
r1t	O
t1	O
r2t	O
t2	O
0t	O
1	O
	O
(	O
cid:2	O
)	O
α	O
y	O
1	O
	O
αx	O
p	O
=	O
	O
	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
1	O
	O
αy	O
1	O
where	O
r1	O
and	O
r2	O
are	O
the	O
ﬁrst	O
and	O
second	O
rows	O
of	O
the	O
rotation	O
matrix	B
r	O
between	O
the	O
views	O
.	O
we	O
will	O
assume	O
that	O
the	O
aspect	O
ratio	O
αy/αx	O
is	O
known	O
in	O
both	O
cameras	O
,	O
but	O
that	O
(	O
cid:2	O
)	O
the	O
relative	O
scaling	B
s	O
=	O
α	O
x/αx	O
is	O
unknown	O
.	O
s	O
>	O
1	O
for	O
a	O
“	O
looming	O
”	O
object	O
and	O
s	O
<	O
1	O
for	O
one	O
that	O
is	O
“	O
receding	O
”	O
.	O
as	O
has	O
been	O
seen	O
,	O
the	O
complete	O
rotation	B
r	O
can	O
not	O
be	O
computed	O
from	O
two	O
weak	B
perspective	I
views	O
,	O
resulting	O
in	O
the	O
bas-relief	B
ambiguity	I
.	O
nevertheless	O
358	O
14	O
afﬁne	B
epipolar	O
geometry	O
y	O
y	O
z	O
θ	O
z	O
image	O
a	O
x	O
ρ	O
φ	O
φ	O
image	O
x	O
b	O
fig	O
.	O
14.10.	O
the	O
rotation	B
representation	O
.	O
(	O
a	O
)	O
rotation	B
by	O
θ	O
about	O
the	O
z-axis	O
;	O
(	O
b	O
)	O
subsequent	O
rotation	B
by	O
ρ	O
about	O
a	O
fronto–parallel	O
axis	O
φ	O
angled	O
at	O
φ	O
to	O
the	O
x-axis	O
.	O
the	O
φ-axis	O
has	O
components	O
(	O
cos	O
φ	O
,	O
sin	O
φ	O
,	O
0	O
)	O
t.	O
ρ	O
axisφ	O
π	O
i1	O
l	O
x	O
i	O
2	O
/	O
l	O
φ	O
l	O
a	O
i	O
1	O
φ	O
/	O
l	O
2i	O
ρ	O
axis	O
φ	O
π	O
x	O
i	O
2	O
/	O
l	O
φ−θ	O
l	O
φ	O
l	O
/	O
2i	O
b	O
i1	O
l	O
i	O
1	O
fig	O
.	O
14.11.	O
the	O
camera	B
rotates	O
about	O
the	O
axis	O
φ	O
which	O
is	O
parallel	B
to	O
the	O
image	B
plane	I
.	O
the	O
intersection	B
of	O
the	O
epipolar	B
plane	O
π	O
with	O
the	O
image	O
planes	O
gives	O
epipolar	B
lines	I
l	O
and	O
l	O
(	O
cid:1	O
)	O
,	O
and	O
the	O
projections	O
of	O
φ	O
in	O
the	O
images	O
are	O
orthogonal	B
to	O
these	O
epipolar	B
lines	I
:	O
(	O
a	O
)	O
no	O
cyclotorsion	O
occurs	O
(	O
θ	O
=	O
0◦	O
)	O
;	O
(	O
b	O
)	O
the	O
camera	B
counter-rotates	O
by	O
θ	O
in	O
i1	O
,	O
so	O
the	O
orientation	B
of	O
the	O
epipolar	B
lines	I
changes	O
by	O
θ.	O
the	O
remaining	O
motion	O
parameters	B
can	O
be	O
computed	O
from	O
fa	O
,	O
and	O
their	O
computation	B
is	O
straightforward	O
.	O
to	O
represent	O
the	O
motion	O
we	O
will	O
use	O
a	O
rotation	B
representation	O
introduced	O
by	O
koen-	O
derink	O
and	O
van	O
doorn	O
[	O
koenderink-91	O
]	O
.	O
as	O
will	O
be	O
seen	O
,	O
this	O
has	O
the	O
advantage	O
that	O
it	O
isolates	O
the	O
parameter	O
ρ	O
of	O
the	O
bas-relief	O
ambiguity	B
,	O
which	O
can	O
not	O
be	O
computed	O
from	O
the	O
afﬁne	B
epipolar	O
geometry	O
.	O
in	O
this	O
representation	B
the	O
rotation	B
r	O
between	O
the	O
views	O
is	O
decomposed	O
into	O
two	O
rotations	O
(	O
see	O
ﬁgure	O
14.10	O
)	O
,	O
r	O
=	O
rρ	O
rθ	O
.	O
(	O
14.9	O
)	O
first	O
,	O
there	O
is	O
a	O
cyclo-rotation	O
rθ	O
in	O
the	O
image	B
plane	I
through	O
an	O
angle	B
θ	O
(	O
i.e	O
.	O
about	O
the	O
line	B
of	O
sight	O
)	O
.	O
this	O
is	O
followed	O
by	O
a	O
rotation	B
rρ	O
through	O
an	O
angle	B
ρ	O
about	O
an	O
axis	O
φ	O
with	O
direction	O
parallel	B
to	O
the	O
image	B
plane	I
,	O
and	O
angled	O
at	O
φ	O
to	O
the	O
positive	O
x-axis	O
,	O
i.e	O
.	O
a	O
pure	O
rotation	B
out	O
of	O
the	O
image	O
plane	B
.	O
14.7	O
computing	B
the	O
motion	O
359	O
ι	O
1	O
parallel	B
epipolar	O
planes	O
ι	O
2b	O
axis	O
ρ	O
b	O
ι	O
2a	O
ρ	O
a	O
π1	O
π2	O
π3	O
fig	O
.	O
14.12.	O
the	O
scene	O
can	O
be	O
sliced	O
into	O
parallel	B
epipolar	O
planes	O
.	O
the	O
magnitude	O
of	O
ρ	O
has	O
no	O
effect	O
on	O
the	O
epipolar	B
geometry	O
(	O
provided	O
ρ	O
(	O
cid:5	O
)	O
=	O
0	O
)	O
,	O
so	O
it	O
is	O
indeterminate	O
from	O
two	O
views	O
.	O
θ	O
ρ	O
a	O
b	O
φ	O
c	O
d	O
fig	O
.	O
14.13.	O
the	O
effect	O
of	O
scale	O
and	O
rotation	B
angles	O
on	O
the	O
epipolar	B
lines	I
for	O
an	O
object	O
moving	B
relative	O
to	O
a	O
stationary	O
camera	B
.	O
this	O
also	O
illustrates	O
the	O
assumed	O
sequence	O
of	O
events	O
accounting	O
for	O
the	O
transition	O
from	O
i1	O
to	O
i2	O
:	O
(	O
a	O
)	O
i1	O
;	O
(	O
b	O
)	O
cyclotorsion	O
(	O
θ	O
)	O
;	O
(	O
c	O
)	O
rotation	B
out	O
of	O
the	O
plane	O
(	O
φ	O
and	O
ρ	O
)	O
;	O
(	O
d	O
)	O
scaling	B
,	O
giving	O
i2	O
.	O
solving	O
for	O
s	O
,	O
φ	O
and	O
θ.	O
it	O
is	O
now	O
shown	O
that	O
the	O
scale	O
factor	O
(	O
s	O
)	O
,	O
the	O
projection	B
of	O
the	O
axis	O
of	O
rotation	B
(	O
φ	O
)	O
and	O
the	O
cyclo-rotation	O
angle	B
(	O
θ	O
)	O
may	O
be	O
computed	O
directly	O
from	O
the	O
afﬁne	B
epipolar	O
geometry	O
.	O
the	O
solution	B
is	O
preceded	O
by	O
a	O
geometric	B
explanation	O
of	O
how	O
the	O
epipolar	B
lines	I
relate	O
to	O
the	O
unknown	O
motion	O
parameters	B
.	O
.	O
consequently	O
:	O
consider	O
a	O
camera	B
rotating	O
about	O
an	O
axis	O
φ	O
lying	O
parallel	B
to	O
the	O
image	B
plane	I
(	O
ﬁgure	O
14.11	O
(	O
a	O
)	O
)	O
.	O
the	O
epipolar	B
plane	O
π	O
is	O
perpendicular	O
to	O
both	O
this	O
axis	O
and	O
the	O
two	O
images	O
,	O
and	O
intersects	O
the	O
images	O
in	O
the	O
epipolar	B
lines	I
l	O
and	O
l	O
(	O
cid:2	O
)	O
•	O
the	O
projection	B
of	O
the	O
axis	O
of	O
rotation	B
φ	O
is	O
perpendicular	O
to	O
the	O
epipolar	B
lines	I
.	O
this	O
relation	B
still	O
holds	O
if	O
there	O
is	O
additionally	O
a	O
cyclotorsion	O
θ	O
in	O
the	O
image	B
plane	I
(	O
ﬁgure	O
14.11	O
(	O
b	O
)	O
)	O
;	O
the	O
axis	O
φ	O
and	O
intersection	B
l	O
(	O
cid:2	O
)	O
remain	O
ﬁxed	O
in	O
space	O
,	O
and	O
are	O
sim-	O
ply	O
observed	O
at	O
a	O
new	O
angle	B
in	O
the	O
image	O
,	O
maintaining	O
the	O
orthogonality	B
between	O
the	O
epipolar	B
lines	I
and	O
the	O
projected	O
axis	O
.	O
the	O
orientations	O
of	O
the	O
epipolar	O
lines	B
in	O
the	O
two	O
images	O
therefore	O
differ	O
by	O
θ.	O
importantly	O
,	O
changing	O
the	O
magnitude	O
of	O
the	O
turn	O
angle	B
ρ	O
doesn	O
’	O
t	O
alter	O
the	O
epipolar	B
geometry	O
in	O
any	O
way	O
(	O
ﬁgure	O
14.12	O
)	O
.	O
this	O
angle	B
is	O
therefore	O
indeterminate	O
from	O
two	O
views	O
,	O
a	O
consequence	O
of	O
the	O
bas-relief	O
ambiguity	B
.	O
360	O
14	O
afﬁne	B
epipolar	O
geometry	O
a	O
b	O
fig	O
.	O
14.14.	O
computing	B
motion	O
from	O
afﬁne	O
epipolar	O
geometry	O
.	O
(	O
a	O
)	O
(	O
b	O
)	O
two	B
views	I
of	O
a	O
buggy	O
rotating	O
on	O
a	O
turntable	O
.	O
the	O
computed	O
rotation	O
axis	O
is	O
superimposed	O
on	O
the	O
image	O
,	O
drawn	O
to	O
pass	O
through	O
the	O
image	O
centre	O
.	O
the	O
ground	B
truth	I
axis	O
is	O
,	O
of	O
course	O
,	O
perpendicular	O
to	O
the	O
turntable	O
in	O
the	O
world	O
.	O
figure	O
14.13	O
illustrates	O
the	O
effect	O
of	O
scale	O
.	O
consider	O
a	O
3d	O
object	O
to	O
be	O
sliced	O
into	O
parallel	B
epipolar	O
planes	O
,	O
with	O
each	O
plane	B
constraining	O
how	O
a	O
particular	O
slice	O
of	O
the	O
object	O
moves	O
.	O
altering	O
the	O
effective	O
size	O
of	O
the	O
object	O
(	O
e.g	O
.	O
by	O
moving	B
closer	O
to	O
it	O
)	O
simply	O
changes	O
the	O
relative	O
spacing	O
between	O
successive	O
epipolar	B
planes	O
.	O
in	O
summary	O
,	O
cyclotorsion	O
simply	O
rotates	O
the	O
epipolar	B
lines	I
,	O
rotation	B
out	O
of	O
the	O
plane	O
causes	O
foreshortening	O
along	O
the	O
epipolar	B
lines	I
(	O
orthogonal	B
to	O
φ	O
)	O
,	O
and	O
a	O
scale	O
change	O
uniformly	O
alters	O
the	O
epipolar	B
line	I
spacing	O
(	O
ﬁgure	O
14.13	O
)	O
.	O
it	O
can	O
be	O
shown	O
(	O
and	O
is	O
left	O
as	O
exercise	O
)	O
that	O
s	O
,	O
θ	O
and	O
φ	O
can	O
be	O
computed	O
directly	O
from	O
the	O
afﬁne	B
epipolar	O
geometry	O
as	O
tan	O
φ	O
=	O
b	O
a	O
,	O
d	O
c	O
and	O
s2	O
=	O
tan	O
(	O
φ	O
−	O
θ	O
)	O
=	O
c2	O
+	O
d2	O
a2	O
+	O
b2	O
,	O
with	O
s	O
>	O
0	O
(	O
by	O
deﬁnition	B
)	O
.	O
note	O
that	O
φ	O
is	O
the	O
angle	B
of	O
projection	B
in	O
i2	O
of	O
the	O
axis	O
of	B
rotation	I
out	O
of	O
the	O
plane	O
,	O
while	O
(	O
φ	O
−	O
θ	O
)	O
is	O
its	O
angle	B
of	O
projection	B
in	O
i1	O
.	O
example	O
14.3.	O
motion	O
computed	O
from	O
the	O
afﬁne	B
fundamental	I
matrix	I
ﬁgure	O
14.14	O
shows	O
two	O
images	O
of	O
a	O
buggy	O
rotating	O
on	O
a	O
turntable	O
.	O
the	O
image	O
is	O
256	O
×	O
256	O
pixels	O
with	O
an	O
aspect	O
ratio	O
of	O
0.65.	O
the	O
afﬁne	B
fundamental	I
matrix	I
is	O
com-	O
puted	O
using	O
algorithm	O
14.1	O
,	O
and	O
the	O
motion	O
parameters	B
computed	O
from	O
fa	O
using	O
(	O
14.10	O
)	O
(	O
cid:2	O
)	O
above	O
.	O
the	O
computed	O
rotation	O
axis	O
is	O
superimposed	O
on	O
the	O
image	O
.	O
(	O
14.10	O
)	O
14.8	O
closure	O
14.8.1	O
the	O
literature	O
koenderink	O
and	O
van	O
doorn	O
[	O
koenderink-91	O
]	O
set	O
the	O
scene	O
for	O
afﬁne	B
reconstruction	I
from	O
two	O
afﬁne	O
cameras	B
.	O
this	O
paper	O
should	O
be	O
read	O
by	O
all	O
.	O
the	O
afﬁne	B
fundamental	I
matrix	I
was	O
ﬁrst	O
deﬁned	O
in	O
[	O
zisserman-92	O
]	O
.	O
the	O
computation	B
of	I
the	O
motion	O
parameters	B
from	O
fa	O
is	O
described	O
in	O
shapiro	O
et	O
al	O
.	O
[	O
shapiro-95	O
]	O
,	O
and	O
in	O
particular	O
the	O
cases	O
where	O
a	O
third	O
view	O
does	O
not	O
resolve	O
the	O
bas–relief	O
ambiguity	B
.	O
a	O
helpful	O
eigenvector	O
analysis	O
of	O
the	O
ambiguity	O
is	O
given	O
in	O
[	O
szeliski-96	O
]	O
.	O
the	O
three	O
view	O
afﬁne	B
motion	O
case	O
is	O
treated	O
quite	O
elegantly	O
in	O
[	O
shimshoni-99	O
]	O
.	O
14.8.2	O
notes	O
and	O
exercises	O
14.8	O
closure	O
361	O
(	O
i	O
)	O
a	O
scene	O
plane	O
induces	O
an	O
afﬁne	B
transformation	I
between	O
two	O
afﬁne	O
cameras	B
.	O
there	O
is	O
a	O
three-parameter	O
family	O
of	O
such	O
afﬁnities	O
deﬁned	O
by	O
the	O
three-	O
parameter	O
family	O
of	O
planes	O
in	O
ir3	O
.	O
given	O
fa	O
,	O
this	O
family	O
of	O
afﬁnities	O
may	O
be	O
written	O
as	O
(	O
result	O
13.3	O
(	O
p328	O
)	O
)	O
ha	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
=	O
0	O
,	O
and	O
the	O
3-vector	O
v	O
parametrizes	O
the	O
family	O
of	O
planes	O
.	O
conversely	O
,	O
show	O
that	O
given	O
ha	O
,	O
the	O
homography	B
induced	O
by	O
a	O
scene	O
plane	O
,	O
then	O
fa	O
is	O
determined	O
up	O
to	O
a	O
one-parameter	O
ambiguity	B
.	O
]	O
×fa	O
+	O
e	O
(	O
cid:2	O
)	O
vt	O
,	O
where	O
fa	O
te	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
consider	O
a	O
perspective	O
camera	B
,	O
i.e	O
.	O
the	O
matrix	B
does	O
not	O
have	O
the	O
afﬁne	B
form	O
.	O
show	O
that	O
if	O
the	O
camera	B
motion	I
consists	O
of	O
a	O
translation	O
parallel	B
to	O
the	O
image	B
plane	I
,	O
and	O
a	O
rotation	B
about	O
the	O
principal	O
axis	O
,	O
then	O
f	O
has	O
the	O
afﬁne	B
form	O
.	O
this	O
shows	O
that	O
a	O
fundamental	B
matrix	I
with	O
afﬁne	B
form	O
does	O
not	O
imply	O
that	O
the	O
imag-	O
ing	O
conditions	O
are	O
afﬁne	B
.	O
are	O
there	O
other	O
camera	B
motions	O
which	O
generate	O
a	O
fundamental	B
matrix	I
with	O
the	O
afﬁne	B
form	O
?	O
(	O
iii	O
)	O
two	O
afﬁne	O
cameras	B
,	O
pa	O
,	O
p	O
(	O
cid:2	O
)	O
a	O
,	O
uniquely	O
deﬁne	O
an	O
afﬁne	B
fundamental	I
matrix	I
fa	O
by	O
(	O
9.1–p244	O
)	O
.	O
show	O
that	O
if	O
the	O
cameras	B
are	O
transformed	O
on	O
the	O
right	O
by	O
a	O
common	O
afﬁne	B
transformation	I
,	O
i.e	O
.	O
pa	O
(	O
cid:6	O
)	O
→	O
paha	O
,	O
p	O
(	O
cid:2	O
)	O
aha	O
,	O
the	O
transformed	O
cameras	B
deﬁne	O
the	O
original	O
fa	O
.	O
this	O
shows	O
that	O
the	O
afﬁne	B
fundamental	I
matrix	I
is	O
invariant	O
to	O
an	O
afﬁne	B
transformation	I
of	O
the	O
world	O
coordinates	B
.	O
a	O
(	O
cid:6	O
)	O
→	O
p	O
(	O
cid:2	O
)	O
(	O
iv	O
)	O
suppose	O
one	O
of	O
the	O
cameras	O
is	O
afﬁne	B
and	O
the	O
other	O
is	O
a	O
perspective	O
camera	B
.	O
(	O
v	O
)	O
the	O
4	O
×	O
4	O
permutation	O
homography	B
show	O
that	O
in	O
general	O
in	O
this	O
case	O
the	O
epipoles	B
in	O
both	O
views	O
are	O
ﬁnite	B
.	O
	O
1	O
0	O
0	O
0	O
h	O
=	O
	O
0	O
0	O
0	O
1	O
0	O
0	O
1	O
0	O
0	O
1	O
0	O
0	O
(	O
cid:17	O
)	O
maps	O
the	O
canonical	O
matrix	O
of	O
a	O
ﬁnite	O
projective	B
camera	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
into	O
the	O
canonical	O
matrix	O
of	O
parallel	O
projection	O
pa	O
:	O
pa	O
=	O
[	O
i	O
|	O
0	O
]	O
h	O
=	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
0	O
1	O
(	O
cid:18	O
)	O
.	O
show	O
,	O
by	O
applying	O
this	O
transformation	B
to	O
a	O
pair	O
of	O
ﬁnite	O
projective	B
camera	I
ma-	O
trices	O
,	O
that	O
the	O
results	O
of	O
this	O
chapter	O
(	O
such	O
as	O
the	O
properties	B
listed	O
in	O
table	O
14.1-	O
(	O
p348	O
)	O
)	O
can	O
be	O
generated	O
directly	O
from	O
their	O
non-afﬁne	O
counterparts	O
of	O
the	O
pre-	O
vious	O
chapters	O
.	O
in	O
particular	O
derive	O
an	O
expression	O
for	O
a	O
pair	O
of	O
afﬁne	O
cameras	B
pa	O
,	O
p	O
(	O
cid:2	O
)	O
a	O
consistent	O
with	O
fa	O
.	O
part	O
iii	O
three-view	O
geometry	O
lord	O
shiva	O
,	O
c.	O
1920-40	O
(	O
print	O
)	O
.	O
shiva	O
is	O
depicted	O
as	O
having	O
three	O
eyes	O
.	O
the	O
third	O
eye	O
in	O
the	O
centre	B
of	O
the	O
forehead	O
symbolizes	O
spiritual	O
knowledge	O
and	O
power	O
.	O
image	O
courtesy	O
of	O
http	O
:	O
//www.healthyplanetonline.com	O
outline	O
this	O
part	O
contains	O
two	O
chapters	O
on	O
the	O
geometry	O
of	O
three-views	O
.	O
the	O
scene	O
is	O
imaged	O
with	O
three	O
cameras	B
perhaps	O
simultaneously	O
in	O
a	O
trinocular	O
rig	O
,	O
or	O
sequentially	O
from	O
a	O
moving	B
camera	O
.	O
chapter	O
15	O
introduces	O
a	O
new	O
multiple	O
view	O
object	O
–	O
the	O
trifocal	B
tensor	I
.	O
this	O
has	O
anal-	O
ogous	O
properties	B
to	O
the	O
fundamental	B
matrix	I
of	O
two-view	O
geometry	O
:	O
it	O
is	O
independent	O
of	O
scene	O
structure	B
depending	O
only	O
on	O
the	O
(	O
projective	B
)	O
relations	O
between	O
the	O
cameras	B
.	O
the	O
camera	B
matrices	I
may	O
be	O
retrieved	O
from	O
the	O
trifocal	B
tensor	I
up	O
to	O
a	O
common	O
projec-	O
tive	O
transformation	B
of	O
3-space	O
,	O
and	O
the	O
fundamental	O
matrices	O
for	O
view-pairs	O
may	O
be	O
retrieved	O
uniquely	O
.	O
the	O
new	O
geometry	O
compared	O
with	O
the	O
two-view	O
case	O
is	O
the	O
ability	O
to	O
transfer	O
from	O
two	O
views	O
to	O
a	O
third	O
:	O
given	O
a	O
point	B
correspondence	O
over	O
two	B
views	I
the	O
position	O
of	O
the	O
point	O
in	O
the	O
third	O
view	O
is	O
determined	O
;	O
and	O
similarly	O
,	O
given	O
a	O
line	B
correspondence	O
over	O
two	B
views	I
the	O
position	O
of	O
the	O
line	O
in	O
the	O
third	O
view	O
is	O
determined	O
.	O
this	O
transfer	B
property	O
is	O
of	O
great	O
beneﬁt	O
when	O
establishing	O
correspondences	B
over	O
multiple	O
views	O
.	O
if	O
the	O
essence	O
of	O
the	O
epipolar	O
constraint	O
over	O
two	B
views	I
is	O
that	O
rays	O
back-projected	O
from	O
corresponding	O
points	O
are	O
coplanar	O
,	O
then	O
the	O
essence	O
of	O
the	O
trifocal	O
constraint	O
over	O
three	O
views	O
is	O
the	O
geometry	O
of	O
a	O
point–line–line	O
correspondence	B
arising	O
from	O
the	O
image	O
of	O
a	O
point	B
on	O
a	O
line	B
in	O
3-space	O
:	O
corresponding	O
image	O
lines	O
in	O
two	O
views	O
back-project	O
to	O
planes	O
which	O
intersect	O
in	O
a	O
line	B
in	O
3-space	O
,	O
and	O
the	O
ray	O
back-projected	O
from	O
a	O
corre-	O
sponding	O
image	O
point	O
in	O
a	O
third	O
view	O
must	O
intersect	O
this	O
line	B
.	O
chapter	O
16	O
describes	O
the	O
computation	B
of	I
the	O
trifocal	B
tensor	I
from	O
point	O
and	O
line	O
cor-	O
respondences	O
over	O
three-views	O
.	O
given	O
the	O
tensor	B
,	O
and	O
thus	O
the	O
retrieved	O
camera	B
matri-	O
ces	O
,	O
a	O
projective	B
reconstruction	I
may	O
be	O
computed	O
from	O
correspondences	O
over	O
multiple	O
views	O
.	O
the	O
reconstruction	B
may	O
be	O
upgraded	O
to	O
similarity	O
or	O
metric	B
as	O
additional	O
infor-	O
mation	O
is	O
provided	O
in	O
the	O
same	O
manner	O
as	O
in	O
the	O
two	O
view	O
case	O
.	O
it	O
is	O
in	O
reconstruction	O
that	O
there	O
is	O
another	O
gain	O
over	O
two-view	O
geometry	O
.	O
given	O
the	O
cameras	B
,	O
in	O
the	O
two-view	O
case	O
each	O
point	B
correspondence	O
provided	O
four	O
measurements	O
on	O
the	O
three	O
degrees	B
of	I
freedom	I
(	O
the	O
position	O
)	O
of	O
the	O
point	O
in	O
3-space	O
.	O
in	O
three	O
views	O
there	O
are	O
six	O
measurements	O
on	O
,	O
again	O
,	O
three	O
degrees	B
of	I
freedom	I
.	O
however	O
,	O
it	O
is	O
for	B
lines	I
that	O
there	O
is	O
the	O
more	O
signiﬁcant	O
gain	O
.	O
in	O
two-views	O
the	O
number	O
of	O
measurements	O
equals	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
line	O
in	O
3-space	O
,	O
namely	O
four	O
.	O
consequently	O
,	O
there	O
is	O
no	O
possibility	O
of	O
removing	O
the	O
effects	O
of	O
measurement	O
errors	O
.	O
however	O
,	O
in	O
three	O
views	O
there	O
are	O
six	O
measurements	O
on	O
four	O
degrees	B
of	I
freedom	I
,	O
so	O
a	O
scene	O
line	O
is	O
over-determined	B
and	O
can	O
be	O
estimated	O
by	O
a	O
suitable	O
minimization	B
over	O
measurement	O
errors	O
.	O
364	O
15	O
the	O
trifocal	B
tensor	I
the	O
trifocal	B
tensor	I
plays	O
an	O
analogous	O
role	O
in	O
three	O
views	O
to	O
that	O
played	O
by	O
the	O
funda-	O
mental	O
matrix	B
in	O
two	O
.	O
it	O
encapsulates	O
all	O
the	O
(	O
projective	B
)	O
geometric	B
relations	O
between	O
three	O
views	O
that	O
are	O
independent	O
of	O
scene	O
structure	B
.	O
we	O
begin	O
this	O
chapter	O
with	O
a	O
simple	O
introduction	O
to	O
the	O
main	O
geometric	B
and	O
algebraic	B
properties	I
of	O
the	O
trifocal	B
tensor	I
.	O
a	O
formal	O
development	O
of	O
the	O
trifocal	O
tensor	B
and	O
its	O
properties	B
involves	O
the	O
use	O
of	O
tensor	B
notation	I
.	O
to	O
start	O
,	O
however	O
,	O
it	O
is	O
convenient	O
to	O
use	O
standard	O
vector	O
and	O
matrix	B
notation	O
,	O
thus	O
obtaining	O
some	O
geometric	B
insight	O
into	O
the	O
trifocal	B
tensor	I
without	O
the	O
additional	O
burden	O
of	O
dealing	O
with	O
a	O
(	O
possibly	O
)	O
unfamiliar	O
notation	O
.	O
the	O
use	O
of	O
tensor	B
notation	I
will	O
therefore	O
be	O
deferred	O
until	O
section	O
15.2.	O
the	O
three	O
principal	O
geometric	O
properties	B
of	O
the	O
tensor	B
are	O
introduced	O
in	O
section	O
15.1.	O
these	O
are	O
the	O
homography	B
between	O
two	O
of	O
the	O
views	O
induced	B
by	I
a	I
plane	I
back-projected	O
from	O
a	O
line	B
in	O
the	O
other	O
view	O
;	O
the	O
relations	O
between	O
image	O
correspondences	B
for	O
points	O
and	O
lines	B
which	O
arise	O
from	O
incidence	O
relations	O
in	O
3-space	O
;	O
and	O
the	O
retrieval	O
of	O
the	O
fun-	O
damental	O
and	O
camera	B
matrices	I
from	O
the	O
tensor	B
.	O
the	O
tensor	B
may	O
be	O
used	O
to	O
transfer	O
points	O
from	O
a	O
correspondence	B
in	O
two	B
views	I
to	O
the	O
corresponding	O
point	B
in	O
a	O
third	O
view	O
.	O
the	O
tensor	B
also	O
applies	O
to	O
lines	O
,	O
and	O
the	O
image	O
of	O
a	O
line	B
in	O
one	O
view	O
may	O
be	O
computed	O
from	O
its	O
corresponding	O
images	O
in	O
two	O
other	O
views	O
.	O
transfer	B
is	O
described	O
in	O
section	O
15.3.	O
the	O
tensor	B
only	O
depends	O
on	O
the	O
motion	O
between	O
views	O
and	O
the	O
internal	B
parameters	I
of	O
the	O
cameras	B
and	O
is	O
deﬁned	O
uniquely	O
by	O
the	O
camera	B
matrices	I
of	O
the	O
views	O
.	O
however	O
,	O
it	O
can	O
be	O
computed	O
from	O
image	O
correspondences	B
alone	O
without	O
requiring	O
knowledge	O
of	O
the	O
motion	O
or	O
calibration	B
.	O
this	O
computation	B
is	O
described	O
in	O
chapter	O
16	O
.	O
15.1	O
the	O
geometric	B
basis	O
for	O
the	O
trifocal	B
tensor	I
there	O
are	O
several	O
ways	O
that	O
the	O
trifocal	B
tensor	I
may	O
be	O
approached	O
,	O
but	O
in	O
this	O
section	O
the	O
starting	O
point	B
is	O
taken	O
to	O
be	O
the	O
incidence	O
relationship	O
of	O
three	O
corresponding	O
lines	B
.	O
incidence	B
relations	I
for	O
lines	B
.	O
suppose	O
a	O
line	B
in	O
3-space	O
is	O
imaged	O
in	O
three	O
views	O
,	O
as	O
in	O
ﬁgure	O
15.1	O
,	O
what	O
constraints	O
are	O
there	O
on	O
the	O
corresponding	O
image	O
lines	O
?	O
the	O
planes	O
back-projected	O
from	O
the	O
lines	B
in	O
each	O
view	O
must	O
all	O
meet	O
in	O
a	O
single	O
line	O
in	O
space	O
,	O
the	O
3d	O
line	B
that	O
projects	O
to	O
the	O
matched	O
lines	B
in	O
the	O
three	O
images	O
.	O
since	O
in	O
general	O
three	O
arbitrary	O
planes	O
in	O
space	O
do	O
not	O
meet	O
in	O
a	O
single	O
line	O
,	O
this	O
geometric	B
incidence	O
condition	O
365	O
366	O
15	O
the	O
trifocal	B
tensor	I
l	O
l	O
c	O
l	O
/	O
/	O
c	O
l	O
/	O
/	O
/	O
/	O
c	O
fig	O
.	O
15.1.	O
a	O
line	B
l	O
in	O
3-space	O
is	O
imaged	O
as	O
the	O
corresponding	O
triplet	O
l	O
↔	O
l	O
(	O
cid:1	O
)	O
↔	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
by	O
their	O
centres	O
,	O
c	O
,	O
c	O
(	O
cid:1	O
)	O
ﬁrst	O
,	O
second	O
and	O
third	O
images	O
all	O
intersect	O
in	O
a	O
single	O
3d	O
line	B
in	O
space	O
.	O
in	O
three	O
views	O
indicated	O
,	O
and	O
image	O
planes	O
.	O
conversely	O
,	O
corresponding	O
lines	B
back-projected	O
from	O
the	O
,	O
c	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
↔	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
=	O
[	O
a	O
|	O
a4	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
provides	O
a	O
genuine	O
constraint	O
on	O
sets	O
of	O
corresponding	O
lines	B
.	O
we	O
will	O
now	O
translate	O
this	O
geometric	B
constraint	O
into	O
an	O
algebraic	B
constraint	O
on	O
the	O
three	O
lines	B
.	O
we	O
denote	O
a	O
set	O
of	O
corresponding	O
lines	B
as	O
li	O
↔	O
l	O
(	O
cid:2	O
)	O
i	O
.	O
let	O
the	O
camera	B
matrices	I
for	O
the	O
three	O
views	O
be	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
as	O
usual	O
,	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
b	O
|	O
b4	O
]	O
,	O
where	O
a	O
and	O
b	O
are	O
3	O
×	O
3	O
matrices	O
,	O
and	O
the	O
vectors	O
ai	O
and	O
bi	O
are	O
the	O
i-th	O
columns	O
of	O
the	O
respective	O
camera	B
matrices	I
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
.	O
•	O
a4	O
and	O
b4	O
are	O
the	O
epipoles	B
in	O
views	O
two	O
and	O
three	O
respectively	O
,	O
arising	O
from	O
the	O
ﬁrst	O
camera	B
.	O
these	O
epipoles	B
will	O
be	O
denoted	O
by	O
e	O
(	O
cid:2	O
)	O
throughout	O
this	O
chapter	O
,	O
with	O
e	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
c	O
,	O
where	O
c	O
is	O
the	O
ﬁrst	O
camera	B
centre	I
.	O
(	O
for	O
the	O
most	O
part	O
we	O
will	O
not	O
be	O
concerned	O
with	O
the	O
epipoles	B
between	O
the	O
second	O
and	O
third	O
views	O
)	O
.	O
•	O
a	O
and	O
b	O
are	O
the	O
inﬁnite	O
homographies	O
from	O
the	O
ﬁrst	O
to	O
the	O
second	O
and	O
third	O
cameras	B
respectively	O
.	O
=	O
p	O
(	O
cid:2	O
)	O
c	O
,	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
as	O
has	O
been	O
seen	O
in	O
chapter	O
9	O
,	O
any	O
set	O
of	O
three	O
cameras	B
is	O
equivalent	B
to	O
a	O
set	O
with	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
under	O
projective	B
transformations	O
of	O
space	O
.	O
in	O
this	O
chapter	O
we	O
will	O
be	O
con-	O
cerned	O
with	O
properties	O
(	O
such	O
as	O
image	O
coordinates	B
and	O
3d	O
incidence	B
relations	I
)	O
that	O
are	O
invariant	O
under	O
3d	O
projective	B
transforms	O
,	O
so	O
we	O
are	O
free	O
to	O
choose	O
the	O
cameras	B
in	O
this	O
form	O
.	O
now	O
,	O
each	O
image	O
line	O
back-projects	O
to	O
a	O
plane	B
,	O
as	O
shown	O
in	O
ﬁgure	O
15.1.	O
from	O
result	O
8.2	O
(	O
p197	O
)	O
these	O
three	O
planes	O
are	O
π	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
=	O
π	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
l	O
0	O
π	O
=	O
ptl	O
=	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
atl	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
at	O
4	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
.	O
btl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
bt	O
4	O
since	O
the	O
three	O
image	O
lines	O
are	O
derived	O
from	O
a	O
single	O
line	O
in	O
space	O
,	O
it	O
follows	O
that	O
these	O
three	O
planes	O
are	O
not	O
independent	O
but	O
must	O
meet	O
in	O
this	O
common	O
line	B
in	O
3-space	O
.	O
this	O
intersection	B
constraint	O
can	O
be	O
expressed	O
algebraically	O
by	O
the	O
requirement	O
that	O
the	O
4	O
×	O
3	O
matrix	B
m	O
=	O
[	O
π	O
,	O
π	O
(	O
cid:2	O
)	O
]	O
has	O
rank	O
2.	O
this	O
may	O
be	O
seen	O
as	O
follows	O
.	O
points	O
on	O
the	O
line	B
of	O
intersection	B
may	O
be	O
represented	O
as	O
x	O
=	O
αx1	O
+	O
βx2	O
,	O
with	O
x1	O
and	O
x2	O
linearly	O
independent	O
.	O
such	O
points	O
lie	O
on	O
all	O
three	O
planes	O
and	O
so	O
πtx	O
=	O
π	O
(	O
cid:2	O
)	O
tx	O
=	O
π	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
tx	O
=	O
0.	O
it	O
,	O
π	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
367	O
follows	O
that	O
mtx	O
=	O
0.	O
consequently	O
m	O
has	O
a	O
2-dimensional	O
null-space	B
since	O
mtx1	O
=	O
0	O
and	O
mtx2	O
=	O
0	O
.	O
15.1	O
the	O
geometric	B
basis	O
for	O
the	O
trifocal	B
tensor	I
this	O
intersection	B
constraint	O
induces	O
a	O
relation	B
amongst	O
the	O
image	O
lines	O
l	O
,	O
l	O
(	O
cid:2	O
)	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
rank	O
of	O
m	O
is	O
2	O
,	O
there	O
is	O
a	O
linear	B
dependence	O
between	O
its	O
columns	O
mi	O
.	O
denoting	O
.	O
since	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
l	O
atl	O
(	O
cid:2	O
)	O
btl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
bt	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
0	O
at	O
4	O
4	O
m	O
=	O
[	O
m1	O
,	O
m2	O
,	O
m3	O
]	O
=	O
the	O
linear	B
relation	O
may	O
be	O
written	O
m1	O
=	O
αm2	O
+	O
βm3	O
.	O
then	O
noting	O
that	O
the	O
bottom	O
left	O
hand	O
element	O
of	O
m	O
is	O
zero	O
,	O
it	O
follows	O
that	O
α	O
=	O
k	O
(	O
bt	O
)	O
for	O
4	O
some	O
scalar	O
k.	O
applying	O
this	O
to	O
the	O
top	O
3-vectors	O
of	O
each	O
column	O
shows	O
that	O
(	O
up	O
to	O
a	O
homogeneous	O
scale	O
factor	O
)	O
)	O
and	O
β	O
=	O
−k	O
(	O
at	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
4	O
l	O
=	O
(	O
bt	O
4	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
)	O
atl	O
(	O
cid:2	O
)	O
−	O
(	O
at	O
l	O
(	O
cid:2	O
)	O
)	O
btl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
tb4	O
)	O
atl	O
(	O
cid:2	O
)	O
−	O
(	O
l	O
(	O
cid:2	O
)	O
ta4	O
)	O
btl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
4	O
the	O
i-th	O
coordinate	O
li	O
of	O
l	O
may	O
therefore	O
be	O
written	O
as	O
=	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
aibt	O
i	O
)	O
l	O
(	O
cid:2	O
)	O
−	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
a4bt	O
i	O
)	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
li	O
=	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
(	O
b4at	O
and	O
introducing	O
the	O
notation	O
4	O
)	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
−	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
a4bt	O
i	O
)	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ti	O
=	O
aibt	O
4	O
−	O
a4bt	O
i	O
(	O
15.1	O
)	O
the	O
incidence	O
relation	O
can	O
be	O
written	O
(	O
15.2	O
)	O
deﬁnition	B
15.1.	O
the	O
set	O
of	O
three	O
matrices	O
{	O
t1	O
,	O
t2	O
,	O
t3	O
}	O
constitute	O
the	O
trifocal	B
tensor	I
in	O
matrix	B
notation	O
.	O
.	O
li	O
=	O
l	O
(	O
cid:2	O
)	O
ttil	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
we	O
introduce	O
a	O
further	O
notation1	O
.	O
denoting	O
the	O
ensemble	O
of	O
the	O
three	O
matrices	O
ti	O
by	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
,	O
or	O
more	O
brieﬂy	O
[	O
ti	O
]	O
,	O
this	O
last	O
relation	B
may	O
be	O
written	O
as	O
lt	O
=	O
l	O
(	O
cid:2	O
)	O
t	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
15.3	O
)	O
)	O
.	O
i	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
l	O
(	O
cid:2	O
)	O
tt3l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
]	O
and	O
[	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
l	O
(	O
cid:2	O
)	O
tt2l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
]	O
l	O
(	O
cid:2	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
=	O
lt	O
[	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
is	O
understood	O
to	O
represent	O
the	O
vector	O
(	O
l	O
(	O
cid:2	O
)	O
tt1l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
where	O
l	O
(	O
cid:2	O
)	O
t	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
of	O
course	O
there	O
is	O
no	O
intrinsic	O
difference	O
between	O
the	O
three	O
views	O
,	O
and	O
so	O
by	O
analogy	O
with	O
(	O
15.3	O
)	O
there	O
will	O
exist	O
similar	O
relations	O
l	O
(	O
cid:2	O
)	O
t	O
=	O
lt	O
[	O
t	O
(	O
cid:2	O
)	O
.	O
the	O
three	O
tensors	O
[	O
ti	O
]	O
,	O
[	O
t	O
(	O
cid:2	O
)	O
i	O
]	O
exist	O
,	O
but	O
are	O
distinct	O
.	O
in	O
fact	O
,	O
although	O
all	O
three	O
tensors	O
may	O
be	O
computed	O
from	O
any	O
one	O
of	O
them	O
,	O
there	O
is	O
no	O
very	O
simple	O
relationship	O
between	O
them	O
.	O
thus	O
,	O
in	O
fact	O
there	O
are	O
three	O
trifocal	B
tensors	O
existing	O
for	O
a	O
given	O
triple	O
of	O
views	O
.	O
usually	O
one	O
will	O
be	O
content	O
to	O
consider	O
only	O
one	O
of	O
them	O
.	O
however	O
,	O
a	O
method	O
of	O
computing	O
the	O
other	O
trifocal	B
tensors	O
[	O
t	O
(	O
cid:2	O
)	O
i	O
]	O
given	O
[	O
ti	O
]	O
is	O
outlined	O
in	O
exercise	O
(	O
viii	O
)	O
on	O
page	O
389.	O
note	O
that	O
(	O
15.3	O
)	O
is	O
a	O
relationship	O
between	O
image	O
coordinates	O
only	O
,	O
not	O
involving	O
3d	O
coordinates	B
.	O
hence	O
(	O
as	O
remarked	O
previously	O
)	O
,	O
although	O
it	O
was	O
derived	O
under	O
the	O
as-	O
sumption	O
of	O
a	O
canonical	O
camera	B
set	O
(	O
that	O
is	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
)	O
,	O
the	O
value	O
of	O
the	O
matrix	O
ele-	O
ments	O
[	O
ti	O
]	O
is	O
independent	O
of	O
the	O
form	O
of	O
the	O
cameras	O
.	O
the	O
particular	O
simple	O
formula	O
(	O
15.1	O
)	O
for	O
the	O
trifocal	B
tensor	I
given	O
the	O
camera	B
matrices	I
holds	O
only	O
in	O
the	O
case	O
where	O
i	O
]	O
and	O
[	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1	O
this	O
notation	O
is	O
somewhat	O
cumbersome	O
,	O
and	O
its	O
meaning	O
is	O
not	O
quite	O
self-evident	O
.	O
it	O
is	O
for	O
this	O
reason	O
that	O
tensor	B
notation	I
is	O
introduced	O
in	O
section	O
15.2	O
.	O
368	O
15	O
the	O
trifocal	B
tensor	I
/	O
c	O
image	O
2	O
/	O
l	O
c	O
x	O
image	O
1	O
x	O
//	O
//	O
c	O
x	O
image	O
3	O
π	O
/	O
fig	O
.	O
15.2.	O
point	B
transfer	I
.	O
a	O
line	B
l	O
(	O
cid:1	O
)	O
x	O
in	O
the	O
ﬁrst	O
image	O
deﬁnes	O
a	O
ray	O
in	O
3-space	O
which	O
intersects	O
π	O
(	O
cid:1	O
)	O
imaged	O
as	O
the	O
point	B
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
third	O
views	O
,	O
deﬁned	O
by	O
its	O
back-projected	O
plane	B
π	O
(	O
cid:1	O
)	O
in	O
the	O
third	O
view	O
.	O
thus	O
,	O
any	O
line	B
l	O
(	O
cid:1	O
)	O
.	O
in	O
the	O
second	O
view	O
back-projects	O
to	O
a	O
plane	B
π	O
(	O
cid:1	O
)	O
in	O
3-space	O
.	O
a	O
point	B
in	O
the	O
point	B
x.	O
this	O
point	B
x	O
is	O
then	O
induces	O
a	O
homography	B
between	O
the	O
ﬁrst	O
and	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
but	O
a	O
general	O
formula	O
(	O
17.12–p415	O
)	O
for	O
the	O
trifocal	B
tensor	I
corresponding	O
to	O
any	O
three	O
cameras	B
will	O
be	O
derived	O
later	O
.	O
degrees	B
of	I
freedom	I
.	O
the	O
trifocal	B
tensor	I
consists	O
of	O
three	O
3	O
×	O
3	O
matrices	O
,	O
and	O
thus	O
has	O
27	O
elements	O
.	O
there	O
are	O
therefore	O
26	O
independent	O
ratios	O
apart	O
from	O
the	O
(	O
common	O
)	O
overall	O
scaling	B
of	O
the	O
matrices	O
.	O
however	O
,	O
the	O
tensor	B
has	O
only	O
18	O
independent	O
degrees	B
of	I
freedom	I
.	O
in	O
other	O
words	O
once	O
18	O
parameters	B
are	O
speciﬁed	O
,	O
all	O
27	O
elements	O
of	O
the	O
tensor	O
are	O
determined	O
up	O
to	O
a	O
common	O
scale	O
.	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
may	O
be	O
computed	O
as	O
follows	O
.	O
each	O
of	O
3	O
camera	B
matrices	I
has	O
11	O
degrees	B
of	I
freedom	I
,	O
which	O
makes	O
33	O
in	O
total	O
.	O
however	O
,	O
15	O
degrees	B
of	I
freedom	I
must	O
be	O
subtracted	O
to	O
account	O
for	O
the	O
projective	B
world	O
frame	O
,	O
thus	O
leaving	O
18	O
degrees	B
of	I
freedom	I
.	O
the	O
tensor	B
therefore	O
satisﬁes	O
26	O
−	O
18	O
=	O
8	O
independent	O
algebraic	B
constraints	O
.	O
we	O
return	O
to	O
this	O
point	B
in	O
chapter	O
16	O
.	O
15.1.1	O
homographies	B
induced	O
by	O
a	O
plane	B
a	O
fundamental	O
geometric	O
property	O
encoded	O
in	O
the	O
trifocal	B
tensor	I
is	O
the	O
homography	B
between	O
the	O
ﬁrst	O
view	O
and	O
the	O
third	O
induced	O
by	O
a	O
line	O
in	O
the	O
second	O
image	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
15.2	O
and	O
ﬁgure	O
15.3.	O
a	O
line	B
in	O
the	O
second	O
view	O
deﬁnes	O
(	O
by	O
back-	O
projection	B
)	O
a	O
plane	B
in	O
3-space	O
,	O
and	O
this	O
plane	B
induces	O
a	O
homography	B
between	O
the	O
ﬁrst	O
and	O
third	O
views	O
.	O
we	O
now	O
derive	O
the	O
algebraic	B
representation	O
of	O
this	O
geometry	O
in	O
terms	O
of	O
the	O
trifocal	O
tensor	B
.	O
the	O
homography	B
map	O
between	O
the	O
ﬁrst	O
and	O
third	O
images	O
,	O
deﬁned	O
by	O
the	O
plane	B
π	O
(	O
cid:2	O
)	O
=	O
hx	O
and	O
(	O
2.6–p36	O
)	O
l	O
=	O
htl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
in	O
ﬁgure	O
15.2	O
and	O
ﬁgure	O
15.3	O
,	O
may	O
be	O
written	O
as	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
respectively	O
.	O
notice	O
that	O
the	O
three	O
lines	B
l	O
,	O
l	O
(	O
cid:2	O
)	O
in	O
ﬁgure	O
15.3	O
are	O
a	O
corresponding	O
line	B
triple	O
,	O
the	O
projections	O
of	O
the	O
3d	O
line	B
l.	O
therefore	O
,	O
they	O
satisfy	O
the	O
line	B
incidence	O
relationship	O
li	O
=	O
l	O
(	O
cid:2	O
)	O
ttil	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
shows	O
that	O
of	O
(	O
15.2	O
)	O
.	O
comparison	O
of	O
this	O
formula	O
and	O
l	O
=	O
htl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
h	O
=	O
[	O
h1	O
,	O
h2	O
,	O
h3	O
]	O
with	O
hi	O
=	O
tt	O
i	O
l	O
(	O
cid:2	O
)	O
.	O
15.1	O
the	O
geometric	B
basis	O
for	O
the	O
trifocal	B
tensor	I
369	O
/	O
c	O
image	O
2	O
/	O
l	O
l	O
l//	O
//	O
c	O
image	O
3	O
π	O
/	O
c	O
l	O
image	O
1	O
fig	O
.	O
15.3.	O
line	B
transfer	I
.	O
the	O
action	B
on	I
lines	I
of	O
the	O
homography	B
deﬁned	O
by	O
ﬁgure	O
15.2	O
may	O
similarly	O
be	O
visualized	O
geometrically	O
.	O
a	O
line	B
,	O
l	O
,	O
in	O
the	O
ﬁrst	O
image	O
deﬁnes	O
a	O
plane	B
in	O
3-space	O
,	O
which	O
intersects	O
π	O
(	O
cid:1	O
)	O
in	O
the	O
line	B
l.	O
this	O
line	B
l	O
is	O
then	O
imaged	O
as	O
the	O
line	B
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
in	O
the	O
third	O
view	O
.	O
thus	O
,	O
h	O
deﬁned	O
by	O
the	O
above	O
formula	O
represents	O
the	O
(	O
point	B
)	O
homography	B
h13	O
between	O
views	O
one	O
and	O
three	O
speciﬁed	O
by	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
in	O
view	O
two	O
.	O
the	O
second	O
and	O
third	O
views	O
play	O
similar	O
roles	O
,	O
and	O
the	O
homography	B
between	O
the	O
ﬁrst	O
and	O
second	O
views	O
deﬁned	O
by	O
a	O
line	B
in	O
the	O
third	O
can	O
be	O
derived	O
in	O
a	O
similar	O
manner	O
.	O
these	O
ideas	O
are	O
formalized	O
in	O
the	O
following	O
result	O
.	O
result	O
15.2.	O
the	O
homography	B
from	O
the	O
ﬁrst	O
to	O
the	O
third	O
image	O
induced	O
by	O
a	O
line	B
l	O
(	O
cid:2	O
)	O
the	O
second	O
image	O
(	O
see	O
ﬁgure	O
15.2	O
)	O
is	O
given	O
by	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1	O
,	O
tt	O
=	O
h13	O
(	O
l	O
(	O
cid:2	O
)	O
3	O
]	O
l	O
(	O
cid:2	O
)	O
2	O
,	O
tt	O
)	O
x	O
,	O
where	O
in	O
h13	O
(	O
l	O
(	O
cid:2	O
)	O
)	O
=	O
[	O
tt	O
.	O
similarly	O
,	O
a	O
line	B
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ﬁrst	O
to	O
the	O
second	O
views	O
,	O
given	O
by	O
in	O
the	O
third	O
image	O
deﬁnes	O
a	O
homography	B
x	O
(	O
cid:2	O
)	O
=	O
h12	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
)	O
x	O
from	O
the	O
h12	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
)	O
=	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
once	O
this	O
mapping	O
is	O
understood	O
the	O
algebraic	B
properties	I
of	O
the	O
tensor	B
are	O
straight-	O
forward	O
and	O
can	O
easily	O
be	O
generated	O
.	O
in	O
the	O
following	O
section	O
we	O
deduce	O
a	O
number	O
of	O
incidence	O
relations	O
between	O
points	O
and	O
lines	B
based	O
on	O
(	O
15.3	O
)	O
and	O
result	O
15.2	O
.	O
15.1.2	O
point	O
and	O
line	O
incidence	O
relations	O
it	O
is	O
easy	O
to	O
deduce	O
various	O
linear	B
relationships	O
between	O
lines	O
and	O
points	O
in	O
three	O
im-	O
ages	O
involving	O
the	O
trifocal	B
tensor	I
.	O
we	O
have	O
seen	O
one	O
such	O
relationship	O
already	O
,	O
namely	O
(	O
15.3	O
)	O
.	O
this	O
relation	B
holds	O
only	O
up	O
to	O
scale	O
since	O
it	O
involves	O
homogeneous	O
quantities	O
.	O
we	O
may	O
eliminate	O
the	O
scale	O
factor	O
by	O
taking	O
the	O
vector	O
cross	O
product	O
of	O
both	O
sides	O
,	O
which	O
must	O
be	O
zero	O
.	O
this	O
leads	O
to	O
the	O
formula	O
(	O
l	O
(	O
cid:2	O
)	O
t	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
)	O
[	O
l	O
]	O
×	O
=	O
0t	O
,	O
(	O
15.4	O
)	O
where	O
we	O
have	O
used	O
the	O
matrix	B
[	O
l	O
]	O
×	O
to	O
denote	O
the	O
cross	B
product	I
(	O
see	O
(	O
a4.5–p581	O
)	O
)	O
,	O
or	O
more	O
brieﬂy	O
(	O
l	O
(	O
cid:2	O
)	O
t	O
[	O
ti	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
–	O
swapping	O
the	O
)	O
[	O
l	O
]	O
×	O
=	O
0t	O
.	O
note	O
the	O
symmetry	O
between	O
l	O
(	O
cid:2	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
370	O
15	O
the	O
trifocal	B
tensor	I
)	O
[	O
l	O
]	O
×	O
=	O
0t	O
.	O
roles	O
of	O
these	O
two	O
lines	O
is	O
accounted	O
for	O
by	O
transposing	O
each	O
ti	O
,	O
resulting	O
in	O
a	O
relation	B
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
[	O
tt	O
i	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:27	O
)	O
now	O
,	O
a	O
point	B
x	O
on	O
the	O
line	B
l	O
must	O
satisfy	O
i	O
xili	O
=	O
0	O
(	O
using	O
upper	O
indices	O
for	O
the	O
point	B
coordinates	O
,	O
foreshadowing	O
the	O
consider	O
again	O
ﬁgure	O
15.3.	O
xtl	O
=	O
(	O
cid:7	O
)	O
use	O
of	O
tensor	B
notation	I
)	O
.	O
since	O
li	O
=	O
l	O
(	O
cid:2	O
)	O
ttil	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
this	O
may	O
be	O
written	O
as	O
xiti	O
)	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
0	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
i	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:27	O
)	O
(	O
15.5	O
)	O
i	O
xiti	O
)	O
is	O
simply	O
a	O
3	O
×	O
3	O
matrix	B
)	O
.	O
this	O
is	O
an	O
incidence	O
relation	O
in	O
the	O
(	O
note	O
that	O
(	O
ﬁrst	O
image	O
:	O
the	O
relationship	O
will	O
hold	O
for	O
a	O
point–line–line	O
correspondence	B
–	O
that	O
is	O
whenever	O
some	O
3d	O
line	B
l	O
maps	O
to	O
l	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
and	O
third	O
images	O
,	O
and	O
to	O
a	O
line	B
passing	O
through	O
x	O
in	O
the	O
ﬁrst	O
image	O
.	O
an	O
important	O
equivalent	B
deﬁnition	O
of	O
a	O
point–	O
line–line	O
correspondence	B
for	O
which	O
(	O
15.5	O
)	O
holds	O
results	O
from	O
an	O
incidence	O
relation	O
in	O
3-space	O
–	O
there	O
exists	O
a	O
3d	O
point	B
x	O
mapping	O
to	O
x	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
to	O
points	O
on	O
the	O
lines	B
l	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
and	O
third	O
images	O
as	O
shown	O
in	O
ﬁgure	O
15.4	O
(	O
a	O
)	O
.	O
in	O
the	O
second	O
and	O
third	O
images	O
.	O
consider	O
a	O
point–line–point	O
correspondence	B
as	O
in	O
ﬁgure	O
15.4	O
(	O
b	O
)	O
so	O
that	O
from	O
result	O
15.2	O
we	O
may	O
obtain	O
relations	O
involving	O
points	O
x	O
(	O
cid:2	O
)	O
(	O
cid:7	O
)	O
=	O
h13	O
(	O
l	O
(	O
cid:2	O
)	O
which	O
is	O
valid	O
for	O
any	O
line	B
l	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
image	O
.	O
the	O
homogeneous	O
scale	O
factor	O
may	O
be	O
eliminated	O
by	O
(	O
post-	O
)	O
multiplying	O
the	O
transpose	O
of	O
both	O
sides	O
by	O
[	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
)	O
x	O
=	O
[	O
tt	O
1	O
passing	O
through	O
x	O
(	O
cid:2	O
)	O
(	O
cid:7	O
)	O
i	O
)	O
l	O
(	O
cid:2	O
)	O
xitt	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
×	O
to	O
give	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
x	O
=	O
(	O
,	O
tt	O
2	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
,	O
tt	O
3	O
i	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
[	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
×	O
=	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
xiti	O
)	O
[	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
×	O
=	O
0t	O
,	O
(	O
15.6	O
)	O
i	O
a	O
similar	O
analysis	O
may	O
be	O
undertaken	O
with	O
the	O
roles	O
of	O
the	O
second	O
and	O
third	O
images	O
swapped	O
.	O
finally	O
,	O
for	O
a	O
3-point	O
correspondence	B
as	O
shown	O
in	O
ﬁgure	O
15.4	O
(	O
c	O
)	O
,	O
there	O
is	O
a	O
relation	B
(	O
cid:7	O
)	O
i	O
]	O
×	O
(	O
]	O
×	O
=	O
03×3	O
.	O
xiti	O
)	O
[	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
[	O
x	O
(	O
cid:2	O
)	O
(	O
cid:27	O
)	O
i	O
xiti	O
)	O
[	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
so	O
is	O
independent	O
of	O
y	O
(	O
cid:2	O
)	O
in	O
(	O
15.6	O
)	O
passes	O
through	O
x	O
(	O
cid:2	O
)	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
]	O
×y	O
(	O
cid:2	O
)	O
for	O
some	O
point	B
y	O
(	O
cid:2	O
)	O
]	O
×	O
(	O
through	O
x	O
(	O
cid:2	O
)	O
=	O
[	O
x	O
(	O
cid:2	O
)	O
]	O
×	O
=	O
y	O
(	O
cid:2	O
)	O
t	O
[	O
x	O
(	O
cid:2	O
)	O
on	O
l	O
(	O
cid:2	O
)	O
and	O
so	O
may	O
be	O
written	O
from	O
(	O
15.6	O
)	O
]	O
×	O
=	O
0t	O
.	O
however	O
,	O
the	O
relation	B
(	O
15.6	O
)	O
is	O
.	O
the	O
relation	B
(	O
15.7	O
)	O
then	O
consequently	O
,	O
.	O
(	O
15.7	O
)	O
(	O
cid:27	O
)	O
proof	O
.	O
=	O
x	O
(	O
cid:2	O
)	O
×	O
y	O
(	O
cid:2	O
)	O
as	O
l	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
i	O
xiti	O
)	O
[	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
true	O
for	O
all	O
lines	B
l	O
(	O
cid:2	O
)	O
follows	O
.	O
the	O
various	O
relationships	O
between	O
lines	O
and	O
points	O
in	O
three	O
views	O
are	O
summarized	O
in	O
table	O
15.1	O
,	O
and	O
their	O
properties	B
are	O
investigated	O
further	O
in	O
section	O
15.2.1	O
,	O
once	O
tensor	B
notation	I
has	O
been	O
introduced	O
.	O
note	O
that	O
there	O
are	O
no	O
relations	O
listed	O
for	O
point–line–line	O
correspondence	B
in	O
which	O
the	O
point	B
is	O
in	O
the	O
second	O
or	O
third	O
view	O
.	O
such	O
simple	O
relations	O
do	O
not	O
exist	O
in	O
terms	O
of	O
the	O
trifocal	O
tensor	B
in	O
which	O
the	O
ﬁrst	O
view	O
is	O
the	O
special	O
view	O
.	O
it	O
is	O
also	O
worth	O
noting	O
that	O
satisfying	O
an	O
image	O
incidence	O
relation	B
does	O
not	O
guarantee	O
incidence	O
in	O
3-space	O
,	O
as	O
illustrated	O
in	O
ﬁgure	O
15.5	O
.	O
15.1	O
the	O
geometric	B
basis	O
for	O
the	O
trifocal	B
tensor	I
371	O
x	O
x	O
x	O
c	O
c	O
c	O
l//	O
x//	O
x//	O
x	O
/	O
/	O
l	O
x	O
/	O
l	O
/x	O
/	O
c	O
(	O
a	O
)	O
point–line–line	O
l/	O
x/	O
/	O
c	O
(	O
b	O
)	O
point–line–point	O
l	O
x	O
x	O
x	O
/	O
/	O
c	O
(	O
c	O
)	O
point–point–point	O
/	O
/	O
c	O
/	O
/	O
c	O
/	O
/	O
c	O
are	O
any	O
two	O
lines	O
through	O
x	O
(	O
cid:1	O
)	O
and	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
a	O
)	O
consider	O
a	O
3-view	O
point	B
correspondence	O
x	O
↔	O
x	O
(	O
cid:1	O
)	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
.	O
if	O
l	O
(	O
cid:1	O
)	O
fig	O
.	O
15.4.	O
incidence	B
relations	I
.	O
and	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
forms	O
a	O
point–line–line	O
correspondence	B
,	O
corresponding	O
to	O
a	O
3d	O
line	B
l.	O
consequently	O
,	O
(	O
15.5	O
)	O
holds	O
for	O
any	O
choice	B
of	O
lines	B
l	O
(	O
cid:1	O
)	O
through	O
x	O
(	O
cid:1	O
)	O
.	O
(	O
b	O
)	O
the	O
space	O
point	O
x	O
is	O
incident	O
with	O
the	O
space	O
line	O
l.	O
this	O
deﬁnes	O
an	O
incidence	O
relation	O
x	O
↔	O
l	O
(	O
cid:1	O
)	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
arising	O
from	O
the	O
image	O
of	O
a	O
space	O
point	O
x.	O
between	O
their	O
images	O
.	O
(	O
c	O
)	O
the	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:1	O
)	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
respectively	O
,	O
then	O
x	O
↔	O
l	O
(	O
cid:1	O
)	O
↔	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
and	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
through	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
we	O
now	O
begin	O
to	O
extract	O
the	O
two-view	O
geometry	O
,	O
the	O
epipoles	B
and	O
fundamental	O
ma-	O
trix	O
,	O
from	O
the	O
trifocal	B
tensor	I
.	O
15.1.3	O
epipolar	B
lines	I
a	O
special	O
case	O
of	O
a	O
point–line–line	O
correspondence	B
occurs	O
when	O
the	O
plane	B
π	O
(	O
cid:2	O
)	O
projected	O
from	O
l	O
(	O
cid:2	O
)	O
back-	O
is	O
an	O
epipolar	B
plane	O
with	O
respect	O
to	O
the	O
ﬁrst	O
two	O
cameras	O
,	O
and	O
hence	O
372	O
15	O
the	O
trifocal	B
tensor	I
(	O
i	O
)	O
line–line–line	O
correspondence	B
l	O
(	O
cid:1	O
)	O
t	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
ii	O
)	O
point–line–line	O
correspondence	B
xiti	O
)	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
l	O
(	O
cid:1	O
)	O
t	O
(	O
(	O
iii	O
)	O
point–line–point	O
correspondence	B
$	O
l	O
(	O
cid:1	O
)	O
t	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
%	O
=	O
lt	O
or	O
[	O
l	O
]	O
×	O
=	O
0t	O
=	O
0	O
for	O
a	O
correspondence	O
x	O
↔	O
l	O
(	O
cid:1	O
)	O
↔	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
i	O
i	O
(	O
cid:7	O
)	O
i	O
l	O
(	O
cid:1	O
)	O
t	O
(	O
xiti	O
)	O
[	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
]	O
×	O
=	O
0t	O
for	O
a	O
correspondence	O
x	O
↔	O
l	O
(	O
cid:1	O
)	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
iv	O
)	O
point–point–line	O
correspondence	B
xiti	O
)	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
[	O
x	O
(	O
cid:1	O
)	O
]	O
×	O
(	O
(	O
v	O
)	O
point–point–point	O
correspondence	B
=	O
0	O
for	O
a	O
correspondence	O
x	O
↔	O
x	O
(	O
cid:1	O
)	O
↔	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:7	O
)	O
[	O
x	O
(	O
cid:1	O
)	O
]	O
×	O
(	O
xiti	O
)	O
[	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
]	O
×	O
=	O
03×3	O
i	O
table	O
15.1.	O
summary	B
of	O
trifocal	B
tensor	I
incidence	O
relations	O
using	O
matrix	O
notation	O
.	O
l	O
x	O
x	O
c	O
/	O
l	O
/	O
c	O
x//	O
/	O
/	O
c	O
fig	O
.	O
15.5.	O
non-incident	O
conﬁguration	O
.	O
the	O
imaged	O
points	O
and	O
lines	B
of	O
this	O
conﬁguration	O
satisfy	O
the	O
point–line–point	O
incidence	O
relation	O
of	O
table	O
15.1.	O
however	O
,	O
the	O
space	O
point	O
x	O
and	O
line	B
l	O
are	O
not	O
incident	O
.	O
compare	O
with	O
ﬁgure	O
15.4.	O
back-projected	O
from	O
a	O
line	B
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
;	O
then	O
the	O
ray	O
deﬁned	O
by	O
x	O
and	O
c	O
lies	O
in	O
this	O
plane	B
,	O
and	O
l	O
(	O
cid:2	O
)	O
passes	O
through	O
the	O
camera	B
centre	I
c	O
of	O
the	O
ﬁrst	O
camera	B
.	O
suppose	O
x	O
is	O
a	O
point	B
on	O
the	O
plane	B
π	O
(	O
cid:2	O
)	O
is	O
the	O
epipolar	B
line	I
corresponding	O
to	O
the	O
point	B
x	O
,	O
the	O
image	O
of	O
x.	O
this	O
is	O
shown	O
in	O
ﬁgure	O
15.6.	O
the	O
plane	B
π	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
in	O
the	O
third	O
image	O
will	O
intersect	O
the	O
plane	B
in	O
a	O
line	B
l.	O
further	O
,	O
since	O
the	O
ray	O
corresponding	O
to	O
x	O
lies	O
entirely	O
in	O
the	O
plane	B
π	O
(	O
cid:2	O
)	O
π	O
(	O
cid:2	O
)	O
it	O
must	O
intersect	O
the	O
line	B
l.	O
this	O
gives	O
a	O
3-way	O
intersection	B
between	O
the	O
ray	O
and	O
planes	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
back-projected	O
from	O
point	O
x	O
and	O
lines	B
l	O
(	O
cid:2	O
)	O
(	O
cid:27	O
)	O
,	O
and	O
so	O
they	O
constitute	O
a	O
point–line–line	O
correspondence	B
,	O
satisfying	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
i	O
xiti	O
)	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
0.	O
the	O
important	O
point	B
now	O
is	O
that	O
this	O
is	O
,	O
and	O
it	O
follows	O
that	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
true	O
for	O
any	O
line	B
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
xiti	O
)	O
=0	O
t.	O
the	O
same	O
argument	O
holds	O
with	O
the	O
roles	O
of	O
l	O
(	O
cid:2	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
reversed	O
.	O
to	O
summarize	O
:	O
(	O
cid:27	O
)	O
15.1	O
the	O
geometric	B
basis	O
for	O
the	O
trifocal	B
tensor	I
373	O
/	O
π	O
x	O
x	O
c	O
/	O
l	O
c	O
/	O
e	O
/	O
/	O
l	O
/	O
c	O
/	O
/	O
fig	O
.	O
15.6.	O
if	O
the	O
plane	B
π	O
(	O
cid:1	O
)	O
third	O
view	O
gives	O
a	O
point–line–line	O
incidence	O
.	O
deﬁned	O
by	O
l	O
(	O
cid:1	O
)	O
is	O
an	O
epipolar	B
plane	O
for	O
the	O
ﬁrst	O
two	B
views	I
,	O
then	O
any	O
line	B
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
in	O
the	O
are	O
the	O
corresponding	O
epipolar	B
lines	I
in	O
the	O
result	O
15.3.	O
if	O
x	O
is	O
a	O
point	O
and	O
l	O
(	O
cid:2	O
)	O
second	O
and	O
third	O
images	O
,	O
then	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:7	O
)	O
xiti	O
)	O
=	O
0t	O
and	O
(	O
xiti	O
)	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
0	O
.	O
(	O
cid:7	O
)	O
i	O
l	O
(	O
cid:2	O
)	O
t	O
(	O
consequently	O
,	O
the	O
epipolar	B
lines	I
l	O
(	O
cid:2	O
)	O
left	O
and	O
right	O
null-vectors	O
of	O
the	O
matrix	O
(	O
cid:27	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
corresponding	O
to	O
x	O
may	O
be	O
computed	O
as	O
the	O
i	O
xiti	O
.	O
(	O
cid:27	O
)	O
as	O
the	O
point	B
x	O
varies	O
,	O
the	O
corresponding	O
epipolar	B
lines	I
vary	O
,	O
but	O
all	O
epipolar	B
lines	I
in	O
one	O
image	O
pass	O
through	O
the	O
epipole	O
.	O
thus	O
,	O
one	O
may	O
compute	O
this	O
epipole	O
by	O
computing	B
the	O
intersection	B
of	O
the	O
epipolar	B
lines	I
for	O
varying	O
values	O
of	O
x.	O
three	O
convenient	O
choices	O
of	O
x	O
are	O
the	O
points	O
represented	O
by	O
homogeneous	O
coordinates	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
and	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
with	O
i	O
xiti	O
equal	O
to	O
t1	O
,	O
t2	O
and	O
t3	O
respectively	O
for	O
these	O
three	O
choices	O
of	O
x.	O
from	O
this	O
we	O
deduce	O
the	O
following	O
important	O
result	O
:	O
result	O
15.4.	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
image	O
is	O
the	O
common	O
intersection	B
of	O
the	O
epipolar	B
lines	I
represented	O
by	O
the	O
left	O
null-vectors	O
of	O
the	O
matrices	O
ti	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
similarly	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
is	O
the	O
common	O
intersection	B
of	O
lines	B
represented	O
by	O
the	O
right	O
null-vectors	O
of	O
the	O
ti	O
.	O
note	O
that	O
the	O
epipoles	B
involved	O
here	O
are	O
the	O
epipoles	B
in	O
the	O
second	O
and	O
third	O
images	O
corresponding	O
to	O
the	O
ﬁrst	O
image	O
centre	O
c.	O
the	O
usefulness	O
of	O
this	O
result	O
may	O
not	O
be	O
apparent	B
at	O
present	O
.	O
however	O
,	O
it	O
will	O
be	O
seen	O
below	O
that	O
it	O
is	O
an	O
important	O
step	O
in	O
computing	O
the	O
camera	B
matrices	I
from	O
the	O
trifocal	B
tensor	I
,	O
and	O
in	O
chapter	O
16	O
in	O
the	O
accurate	O
computation	B
of	I
the	O
trifocal	B
tensor	I
.	O
algebraic	B
properties	I
of	O
the	O
ti	O
matrices	O
.	O
this	O
section	O
has	O
established	O
a	O
number	O
of	O
algebraic	O
properties	B
of	O
the	O
ti	O
matrices	O
.	O
we	O
summarize	O
these	O
here	O
:	O
•	O
each	O
matrix	B
ti	O
has	O
rank	O
2.	O
this	O
is	O
evident	O
from	O
(	O
15.1	O
)	O
since	O
ti	O
=	O
aie	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
−	O
e	O
(	O
cid:2	O
)	O
bt	O
sum	O
of	O
two	O
outer	O
products	O
.	O
•	O
the	O
right	O
null-vector	O
of	O
ti	O
is	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
for	O
the	O
point	B
x	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
or	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
as	O
i	O
=	O
1	O
,	O
2	O
or	O
3	O
respectively	O
.	O
i	O
is	O
the	O
i	O
=	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
×	O
bi	O
,	O
and	O
is	O
the	O
epipolar	B
line	I
in	O
the	O
third	O
view	O
374	O
15	O
the	O
trifocal	B
tensor	I
i	O
for	O
i	O
=	O
1	O
,	O
2	O
,	O
3.	O
is	O
the	O
common	O
intersection	B
of	O
the	O
epipolar	B
lines	I
l	O
(	O
cid:2	O
)	O
is	O
the	O
common	O
intersection	B
of	O
the	O
epipolar	B
lines	I
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
=	O
e	O
(	O
cid:2	O
)	O
×	O
ai	O
,	O
and	O
is	O
the	O
epipolar	B
line	I
in	O
the	O
second	O
view	O
•	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
•	O
the	O
left	O
null-vector	O
of	O
ti	O
is	O
l	O
(	O
cid:2	O
)	O
for	O
the	O
point	B
x	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
or	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
as	O
i	O
=	O
1	O
,	O
2	O
or	O
3	O
respectively	O
.	O
•	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
i	O
for	O
i	O
=	O
1	O
,	O
2	O
,	O
3	O
.	O
•	O
the	O
sum	O
of	O
the	O
matrices	O
m	O
(	O
x	O
)	O
=	O
(	O
of	O
m	O
(	O
x	O
)	O
is	O
the	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
epipolar	B
line	I
l	O
(	O
cid:2	O
)	O
it	O
’	O
s	O
worth	O
emphasizing	O
again	O
that	O
although	O
a	O
particular	O
canonical	B
form	I
of	O
the	O
camera	B
is	O
used	O
in	O
the	O
derivation	B
,	O
the	O
epipolar	B
properties	O
of	O
the	O
ti	O
matrices	O
i	O
xiti	O
)	O
also	O
has	O
rank	O
2.	O
the	O
right	O
null-vector	O
of	O
x	O
in	O
the	O
third	O
view	O
,	O
and	O
its	O
left	O
null-vector	O
is	O
the	O
of	O
x	O
in	O
the	O
second	O
view	O
.	O
(	O
cid:27	O
)	O
matrices	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
are	O
independent	O
of	O
this	O
choice	B
.	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
15.1.4	O
extracting	B
the	I
fundamental	I
matrices	I
it	O
is	O
simple	O
to	O
compute	O
the	O
fundamental	O
matrices	O
f21	O
and	O
f31	O
between	O
the	O
ﬁrst1	O
and	O
the	O
other	O
views	O
from	O
the	O
trifocal	B
tensor	I
.	O
it	O
was	O
seen	O
in	O
section	O
9.2.1	O
(	O
p242	O
)	O
that	O
the	O
epipolar	B
line	I
corresponding	O
to	O
some	O
point	B
can	O
be	O
derived	O
by	O
transferring	O
the	O
point	B
to	O
the	O
other	O
view	O
via	O
a	O
homography	B
and	O
joining	O
the	O
transferred	O
point	B
to	O
the	O
epipole	O
.	O
consider	O
a	O
point	B
x	O
in	O
the	O
ﬁrst	O
view	O
.	O
according	O
to	O
ﬁgure	O
15.2	O
and	O
result	O
15.2	O
,	O
a	O
line	B
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
in	O
the	O
third	O
view	O
induces	O
a	O
homography	B
from	O
the	O
ﬁrst	O
to	O
the	O
second	O
view	O
given	O
by	O
x	O
(	O
cid:2	O
)	O
=	O
)	O
x.	O
the	O
epipolar	B
line	I
corresponding	O
to	O
x	O
is	O
then	O
found	O
by	O
joining	O
x	O
(	O
cid:2	O
)	O
(	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
to	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
.	O
this	O
gives	O
l	O
(	O
cid:2	O
)	O
)	O
x	O
,	O
from	O
which	O
it	O
follows	O
that	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
(	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
f21	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
this	O
formula	O
holds	O
for	O
any	O
vector	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
generate	O
condition	O
where	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
since	O
as	O
has	O
been	O
seen	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
formula	O
,	O
but	O
it	O
is	O
important	O
to	O
choose	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
to	O
avoid	O
the	O
de-	O
lies	O
in	O
the	O
null-space	B
of	O
any	O
of	O
the	O
ti	O
.	O
a	O
good	O
choice	B
is	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
is	O
perpendicular	O
to	O
the	O
right	O
null-space	B
of	O
each	O
ti	O
.	O
this	O
gives	O
f21	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
a	O
similar	O
formula	O
holds	O
for	O
f31	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
×	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
3	O
]	O
e	O
(	O
cid:2	O
)	O
1	O
,	O
tt	O
]	O
×	O
[	O
tt	O
.	O
2	O
,	O
tt	O
.	O
(	O
15.8	O
)	O
15.1.5	O
retrieving	B
the	I
camera	I
matrices	I
it	O
was	O
remarked	O
that	O
the	O
trifocal	B
tensor	I
,	O
since	O
it	O
expresses	O
a	O
relationship	O
between	O
im-	O
age	O
entities	O
only	O
,	O
is	O
independent	O
of	O
3d	O
projective	B
transformations	O
.	O
conversely	O
,	O
this	O
implies	O
that	O
the	O
camera	B
matrices	I
may	O
be	O
computed	O
from	O
the	O
trifocal	B
tensor	I
only	O
up	O
to	O
a	O
projective	B
ambiguity	I
.	O
it	O
will	O
now	O
be	O
shown	O
how	O
this	O
may	O
be	O
done	O
.	O
just	O
as	O
in	O
the	O
case	O
of	O
reconstruction	O
from	O
two	O
views	O
,	O
because	O
of	O
the	O
projective	O
am-	O
biguity	O
,	O
the	O
ﬁrst	O
camera	B
may	O
be	O
chosen	O
as	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
.	O
now	O
,	O
since	O
f21	O
is	O
known	O
(	O
from	O
(	O
15.8	O
)	O
)	O
,	O
we	O
can	O
make	O
use	O
of	O
result	O
9.9	O
(	O
p254	O
)	O
to	O
derive	O
the	O
form	B
of	I
the	O
second	O
camera	B
as	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
and	O
the	O
camera	B
pair	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
}	O
then	O
has	O
the	O
fundamental	B
matrix	I
f21	O
.	O
it	O
might	O
be	O
thought	O
1	O
the	O
fundamental	B
matrix	I
f21	O
satisﬁes	O
x	O
(	O
cid:1	O
)	O
tf21x	O
=	O
0	O
for	O
corresponding	O
points	O
x	O
↔	O
x	O
(	O
cid:1	O
)	O
.	O
the	O
subscript	O
notation	O
refers	O
to	O
ﬁgure	O
15.8	O
.	O
15.1	O
the	O
geometric	B
basis	O
for	O
the	O
trifocal	B
tensor	I
375	O
given	O
the	O
trifocal	B
tensor	I
written	O
in	O
matrix	O
notation	O
as	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
.	O
(	O
i	O
)	O
retrieve	O
the	O
epipoles	B
e	O
(	O
cid:1	O
)	O
,	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
let	O
ui	O
and	O
vi	O
be	O
the	O
left	O
and	O
right	O
null-vectors	O
respectively	O
of	O
ti	O
,	O
i.e	O
.	O
ut	O
i	O
ti	O
=	O
0t	O
,	O
tivi	O
=	O
0.	O
then	O
the	O
epipoles	B
are	O
obtained	O
as	O
the	O
null-vectors	O
to	O
the	O
following	O
3	O
×	O
3	O
matrices	O
:	O
e	O
(	O
cid:1	O
)	O
t	O
[	O
u1	O
,	O
u2	O
,	O
u3	O
]	O
=	O
0	O
and	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
t	O
[	O
v1	O
,	O
v2	O
,	O
v3	O
]	O
=	O
0	O
.	O
(	O
ii	O
)	O
retrieve	O
the	O
fundamental	O
matrices	O
f21	O
,	O
f31	O
f21	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
]	O
×	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
and	O
f31	O
=	O
[	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
with	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
)	O
]	O
×	O
[	O
tt	O
1	O
,	O
tt	O
2	O
,	O
tt	O
3	O
]	O
e	O
(	O
cid:1	O
)	O
.	O
(	O
iii	O
)	O
retrieve	O
the	O
camera	B
matrices	I
p	O
(	O
cid:1	O
)	O
,	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
normalize	O
the	O
epipoles	B
to	O
unit	O
norm	B
.	O
then	O
]	O
and	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
=	O
[	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
|	O
e	O
(	O
cid:1	O
)	O
p	O
(	O
cid:1	O
)	O
=	O
[	O
(	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
t	O
−	O
i	O
)	O
[	O
tt	O
1	O
,	O
tt	O
2	O
,	O
tt	O
3	O
]	O
e	O
(	O
cid:1	O
)	O
|	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
]	O
.	O
algorithm	B
15.1.	O
summary	B
of	O
f	O
and	O
p	O
retrieval	O
from	O
the	O
trifocal	B
tensor	I
.	O
note	O
,	O
f21	O
and	O
f31	O
are	O
determined	O
uniquely	O
.	O
however	O
,	O
p	O
(	O
cid:1	O
)	O
are	O
determined	O
only	O
up	O
to	O
a	O
common	O
projective	B
transformation	I
of	O
3-space	O
.	O
and	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
2	O
,	O
tt	O
1	O
,	O
tt	O
=	O
[	O
[	O
tt	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
}	O
is	O
inconsistent	O
.	O
3	O
]	O
e	O
(	O
cid:2	O
)	O
|	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
that	O
the	O
third	O
camera	B
could	O
be	O
chosen	O
in	O
a	O
similar	O
manner	O
as	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
,	O
but	O
this	O
is	O
incorrect	O
.	O
this	O
is	O
because	O
the	O
two	O
camera	O
pairs	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
}	O
and	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
}	O
do	O
not	O
necessarily	O
deﬁne	O
the	O
same	O
projective	O
world	O
frame	O
;	O
although	O
each	O
pair	O
is	O
correct	O
by	O
itself	O
,	O
the	O
triple	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
the	O
third	O
camera	B
can	O
not	O
be	O
chosen	O
independently	O
of	O
the	O
projective	B
frame	O
of	O
the	O
ﬁrst	O
two	O
.	O
to	O
see	O
this	O
,	O
suppose	O
the	O
camera	B
pair	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
}	O
is	O
chosen	O
and	O
points	O
xi	O
reconstructed	O
from	O
their	O
image	O
correspondences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i.	O
then	O
the	O
coordinates	B
of	O
xi	O
are	O
speciﬁed	O
in	O
the	O
projective	B
world	O
frame	O
deﬁned	O
by	O
by	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
}	O
,	O
and	O
a	O
consistent	O
camera	B
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
may	O
be	O
computed	O
from	O
the	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
depends	O
on	O
the	O
frame	O
deﬁned	O
by	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
}	O
.	O
however	O
,	O
it	O
is	O
not	O
necessary	O
to	O
explicitly	O
reconstruct	O
3d	O
structure	B
,	O
a	O
consistent	O
camera	B
triplet	O
can	O
be	O
recovered	O
from	O
the	O
trifocal	B
tensor	I
directly	O
.	O
the	O
pair	O
of	B
camera	I
matrices	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
]	O
are	O
not	O
the	O
only	O
ones	O
compatible	O
with	O
the	O
given	O
fundamental	B
matrix	I
f21	O
.	O
according	O
to	O
(	O
9.10–p256	O
)	O
,	O
the	O
most	O
general	O
form	O
for	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
|	O
e	O
(	O
cid:2	O
)	O
i	O
.	O
clearly	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
is	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
+	O
e	O
(	O
cid:2	O
)	O
vt|λe	O
(	O
cid:2	O
)	O
]	O
for	O
some	O
vector	O
v	O
and	O
scalar	O
λ.	O
a	O
similar	O
choice	B
holds	O
for	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
matrices	O
compatible	O
with	O
the	O
trifocal	B
tensor	I
,	O
we	O
need	O
to	O
ﬁnd	O
the	O
correct	O
values	O
of	O
p	O
(	O
cid:2	O
)	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
to	O
ﬁnd	O
a	O
triple	O
of	B
camera	I
and	O
from	O
these	O
families	O
so	O
as	O
to	O
be	O
compatible	O
with	O
the	O
form	O
(	O
15.1	O
)	O
of	O
the	O
trifocal	O
tensor	B
.	O
=	O
[	O
[	O
t1	O
,	O
t2	O
,	O
t3	O
]	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
|e	O
(	O
cid:2	O
)	O
because	O
of	O
the	O
projective	O
ambiguity	B
,	O
we	O
are	O
free	O
to	O
choose	O
p	O
(	O
cid:2	O
)	O
]	O
,	O
is	O
now	O
deﬁned	O
and	O
b4	O
=	O
.	O
this	O
choice	B
ﬁxes	O
the	O
projective	B
world	O
frame	O
so	O
that	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
thus	O
ai	O
=	O
tie	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
uniquely	O
(	O
up	O
to	O
scale	O
)	O
.	O
then	O
substituting	O
into	O
(	O
15.1	O
)	O
(	O
observing	O
that	O
a4	O
=	O
e	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
)	O
from	O
which	O
it	O
follows	O
that	O
e	O
(	O
cid:2	O
)	O
bt	O
ti	O
=	O
tie	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
−	O
e	O
(	O
cid:2	O
)	O
bt	O
i	O
=	O
ti	O
(	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
−	O
i	O
)	O
.	O
since	O
the	O
scale	O
may	O
be	O
chosen	O
such	O
i	O
376	O
that	O
(	O
cid:10	O
)	O
e	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
=	O
e	O
(	O
cid:2	O
)	O
te	O
(	O
cid:2	O
)	O
15	O
the	O
trifocal	B
tensor	I
=	O
1	O
,	O
we	O
may	O
multiply	O
on	O
the	O
left	O
by	O
e	O
(	O
cid:2	O
)	O
t	O
and	O
transpose	O
to	O
get	O
=	O
[	O
(	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
−	O
i	O
)	O
[	O
tt	O
so	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
camera	B
matrices	I
from	O
the	O
trifocal	B
tensor	I
is	O
given	O
in	O
algorithm	O
15.1	O
.	O
1	O
,	O
tt	O
2	O
,	O
tt	O
]	O
.	O
a	O
summary	B
of	O
the	O
steps	O
involved	O
in	O
extracting	O
bi	O
=	O
(	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
t	O
−	O
i	O
)	O
tt	O
3	O
]	O
e	O
(	O
cid:2	O
)	O
|e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
e	O
(	O
cid:2	O
)	O
we	O
have	O
seen	O
that	O
the	O
trifocal	B
tensor	I
may	O
be	O
computed	O
from	O
the	O
three	O
camera	B
matri-	O
ces	O
,	O
and	O
that	O
conversely	O
the	O
three	O
camera	B
matrices	I
may	O
be	O
computed	O
,	O
up	O
to	O
projective	O
equivalence	O
,	O
from	O
the	O
trifocal	B
tensor	I
.	O
thus	O
,	O
the	O
trifocal	B
tensor	I
completely	O
captures	O
the	O
three	O
cameras	B
up	O
to	O
projective	O
equivalence	O
.	O
15.2	O
the	O
trifocal	B
tensor	I
and	O
tensor	B
notation	I
the	O
style	O
of	O
notation	O
that	O
has	O
been	O
used	O
up	O
to	O
now	O
for	O
the	O
trifocal	B
tensor	I
is	O
derived	O
from	O
the	O
standard	O
matrix–vector	O
notation	O
.	O
since	O
a	O
matrix	B
has	O
two	O
indices	O
only	O
,	O
it	O
is	O
possible	O
to	O
distinguish	O
between	O
the	O
two	O
indices	O
using	O
the	O
devices	O
of	O
matrix	O
transposi-	O
tion	O
and	O
right	O
or	O
left	O
multiplication	O
,	O
and	O
in	O
dealing	O
with	O
matrices	O
and	O
vectors	O
,	O
one	O
can	O
do	O
without	O
writing	O
the	O
indices	O
explicitly	O
.	O
because	O
the	O
trifocal	B
tensor	I
has	O
three	O
indices	O
,	O
instead	O
of	O
the	O
two	O
indices	O
that	O
a	O
matrix	B
has	O
,	O
it	O
becomes	O
increasingly	O
cumbersome	O
to	O
persevere	O
with	O
this	O
style	O
of	O
matrix	O
notation	O
,	O
and	O
we	O
now	O
turn	O
to	O
using	O
standard	O
tensor	B
notation	I
when	O
dealing	O
with	O
the	O
trifocal	B
tensor	I
.	O
for	O
those	O
unfamiliar	O
with	O
tensor	O
nota-	O
tion	O
a	O
gentle	O
introduction	O
is	O
given	O
in	O
appendix	O
1	O
(	O
p562	O
)	O
.	O
this	O
appendix	O
should	O
be	O
read	O
before	O
proceeding	O
with	O
this	O
chapter	O
.	O
image	O
points	O
and	O
lines	B
are	O
represented	O
by	O
homogeneous	O
column	O
and	O
row	O
3-vectors	O
,	O
respectively	O
,	O
i.e	O
.	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
and	O
l	O
=	O
(	O
l1	O
,	O
l2	O
,	O
l3	O
)	O
.	O
the	O
ij-th	O
entry	O
of	O
a	O
matrix	O
a	O
is	O
denoted	O
by	O
ai	O
j	O
,	O
index	O
i	O
being	O
the	O
contravariant	O
(	O
row	O
)	O
index	O
and	O
j	O
being	O
the	O
covariant	O
(	O
column	O
)	O
index	O
.	O
we	O
observe	O
the	O
convention	O
that	O
indices	O
repeated	O
in	O
the	O
contravariant	O
and	O
covariant	O
positions	O
imply	O
summation	O
over	O
the	O
range	O
(	O
1	O
,	O
.	O
.	O
.	O
,3	O
)	O
of	O
the	O
index	O
.	O
for	O
example	O
,	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
jxj	O
,	O
which	O
may	O
be	O
written	O
(	O
cid:2	O
)	O
i	O
=	O
ai	O
x	O
we	O
begin	O
with	O
the	O
deﬁnition	B
of	O
the	O
trifocal	B
tensor	I
given	O
in	O
(	O
15.1	O
)	O
.	O
using	O
tensor	O
=	O
ax	O
is	O
equivalent	B
to	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
(	O
cid:27	O
)	O
jxj	O
.	O
j	O
ai	O
notation	O
,	O
this	O
becomes	O
t	O
jk	O
i	O
=	O
aj	O
i	O
bk	O
4	O
−	O
aj	O
4bk	O
i	O
.	O
(	O
15.9	O
)	O
the	O
positions	O
of	O
the	O
indices	O
in	O
t	O
jk	O
(	O
two	O
contravariant	O
and	O
one	O
covariant	O
)	O
are	O
dictated	O
by	O
the	O
positions	O
of	O
the	O
indices	O
on	O
the	O
right	O
side	O
of	O
the	O
equation	O
.	O
thus	O
,	O
the	O
trifocal	B
tensor	I
is	O
a	O
mixed	O
contravariant–covariant	O
tensor	B
.	O
in	O
tensor	O
notation	O
,	O
the	O
basic	O
incidence	O
relation	B
(	O
15.3	O
)	O
becomes	O
i	O
.	O
(	O
15.10	O
)	O
li	O
=	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
i	O
t	O
jk	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
note	O
that	O
when	O
multiplying	O
tensors	O
the	O
order	O
of	O
the	O
entries	O
does	O
not	O
matter	O
,	O
in	O
contrast	O
with	O
standard	O
matrix	B
notation	O
.	O
for	O
instance	O
the	O
right	O
side	O
of	O
the	O
above	O
expression	O
is	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
jl	O
k	O
t	O
jk	O
i	O
=	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
jl	O
k	O
t	O
jk	O
i	O
=	O
(	O
cid:2	O
)	O
l	O
j	O
t	O
jk	O
i	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
k	O
=	O
l	O
j	O
t	O
jk	O
i	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
k	O
.	O
j	O
,	O
k	O
j	O
,	O
k	O
15.2	O
the	O
trifocal	B
tensor	I
and	O
tensor	B
notation	I
377	O
deﬁnition	B
.	O
the	O
trifocal	B
tensor	I
t	O
is	O
a	O
valency	O
3	O
tensor	B
t	O
jk	O
i	O
with	O
two	O
contravariant	O
and	O
one	O
covariant	O
indices	O
.	O
it	O
is	O
represented	O
by	O
a	O
homogeneous	O
3	O
×	O
3	O
×	O
3	O
array	O
(	O
i.e	O
.	O
27	O
elements	O
)	O
.	O
it	O
has	O
18	O
degrees	B
of	I
freedom	I
.	O
computation	B
from	I
camera	I
matrices	I
.	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:1	O
)	O
if	O
the	O
canonical	O
3	O
×	O
4	O
camera	B
matrices	I
are	O
j	O
]	O
,	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
=	O
[	O
bi	O
j	O
]	O
=	O
[	O
ai	O
then	O
t	O
jk	O
i	O
=	O
a	O
4	O
−	O
a	O
j	O
i	O
bk	O
j	O
4bk	O
i	O
.	O
see	O
(	O
17.12–p415	O
)	O
for	O
computation	O
from	O
three	O
general	O
camera	B
matrices	I
.	O
line	B
transfer	I
from	O
corresponding	O
lines	B
in	O
the	O
second	O
and	O
third	O
views	O
to	O
the	O
ﬁrst	O
.	O
transfer	B
by	O
a	O
homography	B
.	O
li	O
=	O
l	O
(	O
cid:1	O
)	O
jl	O
kt	O
jk	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
(	O
i	O
)	O
point	B
transfer	I
from	O
ﬁrst	O
to	O
third	O
view	O
via	O
a	O
plane	B
in	O
the	O
second	O
the	O
contraction	O
l	O
induced	B
by	I
a	I
plane	I
deﬁned	O
by	O
the	O
back-projection	B
of	O
the	O
line	B
l	O
(	O
cid:1	O
)	O
is	O
a	O
homography	B
mapping	O
between	O
the	O
ﬁrst	O
and	O
third	O
views	O
in	O
the	O
second	O
view	O
.	O
i	O
jt	O
jk	O
(	O
cid:1	O
)	O
kt	O
jk	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
k	O
=	O
hk	O
i	O
xi	O
where	O
hk	O
i	O
=	O
l	O
x	O
j	O
t	O
jk	O
(	O
cid:1	O
)	O
i	O
(	O
ii	O
)	O
point	B
transfer	I
from	O
ﬁrst	O
to	O
second	O
view	O
via	O
a	O
plane	B
in	O
the	O
third	O
the	O
contraction	O
l	O
induced	B
by	I
a	I
plane	I
deﬁned	O
by	O
the	O
back-projection	B
of	O
the	O
line	B
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
is	O
a	O
homography	B
mapping	O
between	O
the	O
ﬁrst	O
and	O
second	O
views	O
in	O
the	O
third	O
view	O
.	O
(	O
cid:1	O
)	O
j	O
=	O
h	O
x	O
j	O
j	O
i	O
xi	O
where	O
h	O
i	O
=	O
l	O
k	O
t	O
jk	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
table	O
15.2.	O
deﬁnition	B
and	O
transfer	B
properties	O
of	O
the	O
trifocal	O
tensor	B
.	O
the	O
homography	B
maps	O
of	O
ﬁgure	O
15.2	O
and	O
ﬁgure	O
15.3	O
may	O
be	O
deduced	O
from	O
the	O
in-	O
cidence	O
relation	B
(	O
15.10	O
)	O
.	O
in	O
the	O
case	O
of	O
the	O
plane	O
deﬁned	O
by	O
back-projecting	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
,	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
t	O
jk	O
i	O
=	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
(	O
l	O
j	O
t	O
jk	O
i	O
li	O
=	O
l	O
)	O
=	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
hk	O
i	O
where	O
hk	O
(	O
cid:2	O
)	O
i	O
=	O
l	O
j	O
t	O
jk	O
i	O
i	O
are	O
the	O
elements	O
of	O
the	O
homography	O
matrix	B
h.	O
this	O
homography	B
maps	O
points	O
and	O
hk	O
between	O
the	O
ﬁrst	O
and	O
third	O
view	O
as	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
=	O
hk	O
i	O
xi	O
.	O
x	O
note	O
that	O
the	O
homography	B
is	O
obtained	O
from	O
the	O
tensor	B
by	O
contraction	O
with	O
a	O
line	B
(	O
i.e	O
.	O
a	O
summation	O
over	O
one	O
contravariant	O
(	O
upper	O
)	O
index	O
of	O
the	O
tensor	O
,	O
and	O
the	O
covariant	O
(	O
lower	O
)	O
extracts	O
a	O
3	O
×	O
3	O
matrix	B
from	O
the	O
tensor	B
–	O
think	O
of	O
the	O
trifocal	O
index	O
of	O
the	O
line	O
)	O
,	O
i.e	O
.	O
l	O
(	O
cid:2	O
)	O
tensor	B
as	O
an	O
operator	O
which	O
takes	O
a	O
line	B
and	O
produces	O
a	O
homography	B
matrix	O
.	O
table	O
15.2	O
summarizes	O
the	O
deﬁnition	B
and	O
transfer	B
properties	O
of	O
the	O
trifocal	O
tensor	B
.	O
a	O
pair	O
of	O
particularly	O
important	O
tensors	O
are	O
ijk	O
and	O
its	O
contravariant	O
counterpart	O
ijk	O
,	O
deﬁned	O
in	O
section	O
a1.1	O
(	O
p563	O
)	O
.	O
this	O
tensor	B
is	O
used	O
to	O
represent	O
the	O
vector	O
product	O
.	O
for	O
378	O
15	O
the	O
trifocal	B
tensor	I
(	O
i	O
)	O
line–line–line	O
correspondence	B
(	O
ii	O
)	O
point–line–line	O
correspondence	B
(	O
lrris	O
)	O
l	O
(	O
cid:1	O
)	O
jl	O
kt	O
jk	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
=	O
0s	O
(	O
cid:1	O
)	O
jl	O
kt	O
jk	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
=	O
0	O
xil	O
(	O
iii	O
)	O
point–line–point	O
correspondence	B
xil	O
(	O
iv	O
)	O
point–point–line	O
correspondence	B
(	O
cid:1	O
)	O
j	O
(	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
k	O
kqs	O
)	O
t	O
jq	O
i	O
=	O
0s	O
xi	O
(	O
x	O
(	O
cid:1	O
)	O
jjpr	O
)	O
l	O
k	O
t	O
pk	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
=	O
0r	O
(	O
v	O
)	O
point–point–point	O
correspondence	B
(	O
cid:1	O
)	O
j	O
jpr	O
)	O
(	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
k	O
kqs	O
)	O
t	O
pq	O
xi	O
(	O
x	O
i	O
=	O
0rs	O
table	O
15.3.	O
summary	B
of	O
trifocal	B
tensor	I
incidence	O
relations	O
–	O
the	O
trilinearities	B
.	O
instance	O
,	O
the	O
line	B
joining	O
two	O
points	O
xi	O
and	O
yj	O
is	O
equal	O
to	O
the	O
cross	B
product	I
xiyjijk	O
=	O
lk	O
,	O
and	O
the	O
skew-symmetric	O
matrix	O
[	O
x	O
]	O
×	O
is	O
written	O
as	O
xiirs	O
in	O
tensor	O
notation	O
.	O
it	O
is	O
now	O
relatively	O
straightforward	O
to	O
write	O
down	O
the	O
basic	O
incidence	O
results	O
involving	O
the	O
trifocal	B
tensor	I
given	O
in	O
table	O
15.1.	O
the	O
results	O
are	O
summarized	O
in	O
table	O
15.3.	O
in	O
this	O
table	O
,	O
a	O
notation	O
such	O
as	O
0r	O
represents	O
an	O
array	O
of	O
zeros	O
.	O
the	O
form	B
of	I
the	O
relations	O
in	O
table	O
15.3	O
is	O
more	O
easily	O
understood	O
if	O
one	O
observes	O
that	O
three	O
indices	O
i	O
,	O
j	O
and	O
k	O
in	O
t	O
jk	O
correspond	O
to	O
entities	O
in	O
the	O
ﬁrst	O
,	O
second	O
and	O
third	O
views	O
respectively	O
.	O
thus	O
for	O
instance	O
a	O
partial	O
expression	O
such	O
as	O
l	O
can	O
not	O
occur	O
,	O
because	O
the	O
index	O
j	O
belongs	O
to	O
the	O
second	O
view	O
,	O
and	O
hence	O
does	O
not	O
belong	O
on	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
in	O
the	O
third	O
view	O
.	O
repeated	O
indices	O
(	O
indicating	O
summation	O
)	O
must	O
occur	O
once	O
as	O
a	O
contravariant	O
(	O
upper	O
)	O
index	O
and	O
once	O
as	O
a	O
covariant	O
(	O
lower	O
)	O
index	O
.	O
thus	O
,	O
we	O
can	O
not	O
write	O
x	O
,	O
since	O
the	O
index	O
j	O
occurs	O
twice	O
in	O
the	O
upper	O
position	O
.	O
think	O
of	O
the	O
	O
tensor	B
as	O
being	O
used	O
to	O
raise	O
or	O
lower	O
indices	O
,	O
for	O
instance	O
by	O
replacing	O
l	O
(	O
cid:2	O
)	O
j	O
by	O
xiijk	O
.	O
however	O
,	O
this	O
may	O
not	O
be	O
done	O
arbitrarily	O
,	O
as	O
pointed	O
out	O
in	O
exercise	O
(	O
x	O
)	O
on	O
page	O
389	O
.	O
(	O
cid:2	O
)	O
jt	O
jk	O
t	O
jk	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
j	O
i	O
i	O
i	O
15.2.1	O
the	O
trilinearities	B
the	O
incidence	B
relations	I
in	O
table	O
15.3	O
are	O
trilinear	B
relations	O
or	O
trilinearities	B
in	O
the	O
co-	O
ordinates	O
of	O
the	O
image	O
elements	O
(	O
points	O
and	O
lines	B
)	O
.	O
tri-	O
since	O
every	O
monomial	O
in	O
the	O
relation	B
involves	O
a	O
coordinate	O
from	O
each	O
of	O
the	O
three	O
image	O
elements	O
involved	O
;	O
and	O
linear	B
because	O
the	O
relations	O
are	O
linear	B
in	O
each	O
of	O
the	O
algebraic	O
entities	O
(	O
i.e	O
.	O
the	O
three	O
“	O
arguments	O
”	O
of	O
the	O
tensor	O
)	O
.	O
for	O
example	O
in	O
the	O
point–point–point	O
relation	B
,	O
i	O
=	O
0rs	O
,	O
suppose	O
both	O
x1	O
and	O
x2	O
satisfy	O
the	O
relation	B
,	O
then	O
so	O
xi	O
(	O
x	O
does	O
x	O
=	O
αx1	O
+	O
βx2	O
,	O
i.e	O
.	O
the	O
relation	B
is	O
linear	B
in	O
its	O
ﬁrst	O
argument	O
.	O
similarly	O
,	O
the	O
relation	B
is	O
linear	B
in	O
the	O
second	O
and	O
third	O
argument	O
.	O
this	O
multi-linearity	O
is	O
a	O
standard	O
t	O
jk	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
property	O
of	O
tensors	O
,	O
and	O
follows	O
directly	O
from	O
the	O
form	O
xil	O
i	O
=	O
0	O
which	O
is	O
a	O
con-	O
jl	O
k	O
traction	O
of	O
the	O
tensor	O
over	O
all	O
three	O
of	O
its	O
indices	O
(	O
arguments	O
)	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
kqs	O
)	O
t	O
pq	O
(	O
cid:2	O
)	O
j	O
jpr	O
)	O
(	O
x	O
we	O
will	O
now	O
describe	O
the	O
point–point–point	O
trilinearities	B
in	O
more	O
detail	O
.	O
there	O
are	O
15.3	O
transfer	B
379	O
nine	O
of	O
these	O
trilinearities	B
arising	O
from	O
the	O
three	O
choices	O
of	O
r	O
and	O
s.	O
geometrically	O
these	O
trilinearities	B
arise	O
from	O
special	O
choices	O
of	O
the	O
lines	O
in	O
the	O
second	O
and	O
third	O
image	O
for	O
the	O
point–line–line	O
relation	B
(	O
see	O
ﬁgure	O
15.4	O
(	O
a	O
)	O
)	O
.	O
choosing	O
r	O
=	O
1	O
,	O
2	O
or	O
3	O
corresponds	O
to	O
a	O
line	B
parallel	O
to	O
the	O
image	O
x-axis	O
,	O
parallel	B
to	O
the	O
image	O
y-axis	O
,	O
or	O
through	O
the	O
image	O
coordinate	O
origin	O
(	O
the	O
point	B
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
)	O
,	O
respectively	O
.	O
for	O
example	O
,	O
choosing	O
r	O
=	O
1	O
and	O
expanding	O
x	O
(	O
cid:2	O
)	O
jjpr	O
results	O
in	O
(	O
cid:2	O
)	O
p	O
=	O
x	O
l	O
(	O
cid:2	O
)	O
jjp1	O
=	O
(	O
0	O
,	O
−x	O
(	O
cid:2	O
)	O
2	O
)	O
which	O
is	O
a	O
horizontal	O
line	B
in	O
the	O
second	O
view	O
through	O
x	O
(	O
cid:2	O
)	O
y	O
(	O
cid:2	O
)	O
third	O
view	O
results	O
in	O
the	O
vertical	O
line	B
through	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kkq2	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
3	O
)	O
t	O
satisfy	O
y	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
3	O
,	O
0	O
,	O
−x	O
(	O
cid:2	O
)	O
1	O
+	O
λ	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
q	O
=	O
x	O
(	O
cid:2	O
)	O
3	O
,	O
x	O
(	O
cid:2	O
)	O
2	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1	O
)	O
=	O
(	O
x	O
(	O
since	O
points	O
of	O
the	O
form	O
=	O
0	O
for	O
any	O
λ	O
)	O
.	O
similarly	O
,	O
choosing	O
s	O
=	O
2	O
in	O
the	O
and	O
the	O
trilinear	B
point	O
relation	B
expands	O
to	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
jp1kq2t	O
pq	O
−	O
x	O
(	O
cid:2	O
)	O
3	O
(	O
x	O
(	O
cid:2	O
)	O
jx	O
=	O
xi	O
[	O
−x	O
0	O
=	O
xix	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
3	O
t	O
21	O
i	O
i	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1	O
t	O
23	O
i	O
(	O
cid:2	O
)	O
2	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
3	O
t	O
31	O
i	O
−	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
1	O
t	O
33	O
i	O
)	O
]	O
.	O
)	O
+x	O
of	O
these	O
nine	O
trilinearities	B
,	O
four	O
are	O
linearly	O
independent	O
.	O
this	O
means	O
that	O
from	O
a	O
basis	O
of	O
four	O
trilinearities	B
all	O
nine	O
can	O
be	O
generated	O
by	O
linear	B
combinations	O
.	O
the	O
four	O
degrees	O
of	O
freedom	O
may	O
be	O
traced	O
back	O
to	O
those	O
of	O
the	O
point-line-line	O
relation	B
t	O
jk	O
i	O
=	O
0	O
and	O
are	O
counted	O
as	O
follows	O
.	O
there	O
is	O
a	O
one-parameter	O
family	O
of	B
lines	I
xil	O
through	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
are	O
two	O
members	O
of	O
this	O
family	O
,	O
then	O
any	O
other	O
line	B
through	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
can	O
be	O
obtained	O
from	O
a	O
linear	B
combination	O
of	O
these	O
:	O
in	O
the	O
third	O
view	O
.	O
if	O
m	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
n	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
incidence	O
relation	O
is	O
linear	B
in	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
jm	O
k	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
jn	O
k	O
+	O
βn	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
αm	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
so	O
that	O
given	O
.	O
t	O
jk	O
i	O
xi	O
=	O
0	O
t	O
jk	O
i	O
xi	O
=	O
0	O
then	O
the	O
incidence	O
relation	O
for	O
any	O
other	O
line	B
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
can	O
be	O
generated	O
by	O
a	O
linear	B
combi-	O
nation	O
of	O
these	O
two	O
.	O
consequently	O
,	O
there	O
are	O
only	O
two	O
linearly	O
independent	O
incidence	B
relations	I
for	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
and	O
the	O
incidence	O
relation	O
is	O
also	O
linear	B
in	O
lines	B
l	O
(	O
cid:2	O
)	O
.	O
thus	O
,	O
there	O
are	O
a	O
total	O
of	O
four	O
linearly	O
independent	O
incidence	B
relations	I
between	O
a	O
point	B
in	O
the	O
ﬁrst	O
view	O
and	O
lines	B
in	O
the	O
second	O
and	O
third	O
.	O
.	O
similarly	O
there	O
is	O
a	O
one-parameter	O
family	O
of	B
lines	I
through	O
x	O
(	O
cid:2	O
)	O
through	O
x	O
(	O
cid:2	O
)	O
the	O
main	O
virtue	O
of	O
the	O
trilinearities	O
is	O
that	O
they	O
are	O
linear	B
,	O
otherwise	O
their	O
properties	B
are	O
often	O
subsumed	O
by	O
transfer	B
,	O
as	O
described	O
in	O
the	O
following	O
section	O
.	O
15.3	O
transfer	B
given	O
three	O
views	O
of	O
a	O
scene	O
and	O
a	O
pair	O
of	O
matched	O
points	O
in	O
two	B
views	I
one	O
may	O
wish	O
to	O
determine	O
the	O
position	O
of	O
the	O
point	O
in	O
the	O
third	O
view	O
.	O
given	O
sufﬁcient	O
information	O
about	O
the	O
placement	O
of	O
the	O
cameras	O
,	O
it	O
is	O
usually	O
possible	O
to	O
determine	O
the	O
location	O
of	O
380	O
image	O
1	O
x	O
f31	O
epipolar	B
line	I
from	O
image	O
1	O
15	O
the	O
trifocal	B
tensor	I
image	O
2	O
image	O
3	O
a	O
x/	O
f	O
32	O
epipolar	B
line	I
from	O
image	O
2	O
/	O
f	O
x	O
32	O
f	O
x	O
31	O
/	O
/	O
x	O
e	O
31	O
b	O
e	O
32	O
image	O
3	O
fig	O
.	O
15.7.	O
epipolar	B
transfer	I
.	O
(	O
a	O
)	O
the	O
image	O
of	O
x	O
in	O
the	O
ﬁrst	O
two	B
views	I
is	O
the	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:1	O
)	O
.	O
the	O
image	O
of	O
x	O
in	O
the	O
third	O
view	O
may	O
be	O
computed	O
by	O
intersecting	O
the	O
epipolar	B
lines	I
f31x	O
and	O
f32x	O
(	O
cid:1	O
)	O
.	O
(	O
b	O
)	O
the	O
conﬁguration	O
of	O
the	O
epipoles	O
and	O
transferred	O
point	B
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
as	O
seen	O
in	O
the	O
third	O
image	O
.	O
point	B
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
is	O
computed	O
as	O
the	O
intersection	B
of	O
epipolar	B
lines	I
passing	O
through	O
the	O
two	O
epipoles	O
e31	O
and	O
e32	O
.	O
however	O
,	O
if	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
lies	O
on	O
the	O
line	B
through	O
the	O
two	O
epipoles	O
,	O
then	O
its	O
position	O
can	O
not	O
be	O
determined	O
.	O
points	O
close	O
to	O
the	O
line	B
through	O
the	O
epipoles	B
will	O
be	O
estimated	O
with	O
poor	O
precision	O
.	O
the	O
point	B
in	O
the	O
third	O
view	O
without	O
reference	O
to	O
image	O
content	O
.	O
this	O
is	O
the	O
point	B
transfer	I
problem	O
.	O
a	O
similar	O
transfer	B
problem	O
arises	O
for	B
lines	I
.	O
in	O
principle	O
the	O
problem	O
can	O
generally	O
be	O
solved	O
given	O
the	O
cameras	B
for	O
the	O
three	O
views	O
.	O
rays	O
back-projected	O
from	O
corresponding	O
points	O
in	O
the	O
ﬁrst	O
and	O
second	O
view	O
intersect	O
and	O
thus	O
determine	O
the	O
3d	O
point	B
.	O
the	O
position	O
of	O
the	O
corresponding	O
point	B
in	O
the	O
third	O
view	O
is	O
computed	O
by	O
projecting	O
this	O
3d	O
point	B
onto	O
the	O
image	O
.	O
similarly	O
lines	B
back-projected	O
from	O
the	O
ﬁrst	O
and	O
second	O
image	O
intersect	O
in	O
the	O
3d	O
line	B
,	O
and	O
the	O
projection	B
of	O
this	O
line	B
in	O
3-space	O
to	O
the	O
third	O
image	O
determines	O
its	O
image	O
position	O
.	O
15.3.1	O
point	B
transfer	I
using	O
fundamental	O
matrices	O
the	O
transfer	B
problem	O
may	O
be	O
solved	O
using	O
knowledge	O
of	O
the	O
fundamental	O
matrices	O
only	O
.	O
thus	O
,	O
suppose	O
we	O
know	O
the	O
three	O
fundamental	O
matrices	O
f21	O
,	O
f31	O
and	O
f32	O
relating	O
the	O
three	O
views	O
,	O
and	O
let	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
in	O
the	O
ﬁrst	O
two	B
views	I
be	O
a	O
matched	O
pair	O
.	O
we	O
wish	O
to	O
ﬁnd	O
the	O
corresponding	O
point	B
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
in	O
the	O
third	O
image	O
.	O
matches	O
point	B
x	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
consequently	O
must	O
lie	O
on	O
the	O
epipolar	B
line	I
corresponding	O
to	O
x.	O
since	O
we	O
know	O
f31	O
,	O
this	O
epipolar	B
line	I
may	O
be	O
computed	O
,	O
and	O
is	O
equal	O
to	O
f31x	O
.	O
by	O
a	O
similar	O
argument	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
must	O
lie	O
on	O
the	O
epipolar	B
line	I
f32x	O
(	O
cid:2	O
)	O
.	O
taking	O
the	O
intersection	B
of	O
the	O
epipolar	B
lines	I
gives	O
the	O
required	O
point	B
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
(	O
f31x	O
)	O
×	O
(	O
f32x	O
(	O
cid:2	O
)	O
)	O
.	O
see	O
ﬁgure	O
15.7a	O
.	O
note	O
that	O
the	O
fundamental	B
matrix	I
f21	O
is	O
not	O
used	O
in	O
this	O
expression	O
.	O
the	O
question	O
naturally	O
arises	O
whether	O
we	O
can	O
gain	O
anything	O
by	O
knowledge	O
of	O
f21	O
,	O
and	O
the	O
answer	O
is	O
yes	O
.	O
in	O
the	O
presence	O
of	O
noise	O
,	O
the	O
points	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
will	O
not	O
form	O
an	O
exact	O
matched	O
pair	O
,	O
meaning	O
that	O
they	O
will	O
not	O
satisfy	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
tf21x	O
=	O
0	O
exactly	O
.	O
given	O
f21	O
one	O
may	O
use	O
optimal	O
triangulation	B
as	O
in	O
algorithm	O
12.1	O
(	O
p318	O
)	O
to	O
correct	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
,	O
resulting	O
in	O
a	O
pair	O
ˆx	O
↔	O
ˆx	O
(	O
cid:2	O
)	O
that	O
satisﬁes	O
this	O
relation	B
.	O
the	O
transferred	O
point	B
may	O
then	O
be	O
computed	O
as	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
)	O
.	O
this	O
method	O
of	O
point	O
transfer	B
using	O
the	O
fundamental	O
matrices	O
will	O
be	O
called	O
epipolar	B
transfer	I
.	O
=	O
(	O
f31ˆx	O
)	O
×	O
(	O
f32ˆx	O
(	O
cid:2	O
)	O
15.3	O
transfer	B
image	O
2	O
c	O
2	O
e23	O
e	O
21	O
381	O
c	O
1	O
e13	O
12e	O
image	O
1	O
e32	O
image	O
3	O
c	O
3	O
e31	O
fig	O
.	O
15.8.	O
the	O
trifocal	B
plane	O
is	O
deﬁned	O
by	O
the	O
three	O
camera	B
centres	O
.	O
the	O
notation	O
for	O
the	O
epipoles	B
is	O
eij	O
=	O
picj	O
.	O
epipolar	B
transfer	I
fails	O
for	O
any	O
point	B
x	O
on	O
the	O
trifocal	B
plane	O
.	O
if	O
the	O
three	O
camera	B
centres	O
are	O
collinear	O
then	O
there	O
is	O
a	O
one-parameter	O
family	O
of	O
planes	O
containing	O
the	O
three	O
centres	O
.	O
though	O
at	O
one	O
time	O
used	O
for	O
point	O
transfer	B
,	O
epipolar	B
transfer	I
has	O
a	O
serious	O
deﬁciency	O
that	O
rules	O
it	O
out	O
as	O
a	O
practical	O
method	O
.	O
this	O
deﬁciency	O
is	O
due	O
to	O
the	O
degeneracy	B
that	O
can	O
be	O
seen	O
from	O
ﬁgure	O
15.7	O
(	O
b	O
)	O
:	O
epipolar	B
transfer	I
fails	O
when	O
the	O
two	O
epipolar	O
lines	B
in	O
the	O
third	O
image	O
are	O
coincident	O
(	O
and	O
becomes	O
increasingly	O
ill-conditioned	O
as	O
the	O
lines	B
become	O
less	O
“	O
transverse	O
”	O
)	O
.	O
the	O
degeneracy	B
condition	O
that	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
e31	O
and	O
e32	O
are	O
collinear	O
in	O
the	O
third	O
image	O
means	O
that	O
the	O
camera	B
centres	O
c	O
and	O
c	O
(	O
cid:2	O
)	O
and	O
the	O
3d	O
point	B
x	O
lie	O
in	O
a	O
plane	B
through	O
the	O
centre	B
c	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
of	O
the	O
third	O
camera	B
;	O
thus	O
x	O
lies	O
on	O
the	O
trifocal	B
plane	O
deﬁned	O
by	O
the	O
three	O
camera	B
centres	O
,	O
see	O
ﬁgure	O
15.8.	O
epipolar	B
transfer	I
will	O
fail	O
for	O
points	O
x	O
lying	O
on	O
the	O
trifocal	B
plane	O
and	O
will	O
be	O
inaccurate	O
for	O
points	O
lying	O
near	O
that	O
plane	B
.	O
note	O
,	O
in	O
the	O
special	O
case	O
that	O
the	O
three	O
camera	B
centres	O
are	O
collinear	O
the	O
trifocal	B
plane	O
is	O
not	O
uniquely	O
deﬁned	O
,	O
and	O
epipolar	B
transfer	I
fails	O
for	O
all	O
points	O
.	O
in	O
this	O
case	O
e31	O
=	O
e32	O
.	O
15.3.2	O
point	B
transfer	I
using	O
the	O
trifocal	B
tensor	I
the	O
degeneracy	B
of	O
epipolar	B
transfer	I
is	O
avoided	O
by	O
use	O
of	O
the	O
trifocal	B
tensor	I
.	O
consider	O
a	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
is	O
chosen	O
in	O
the	O
second	O
view	O
,	O
then	O
the	O
corresponding	O
point	B
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
may	O
be	O
computed	O
by	O
transferring	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
=	O
xil	O
from	O
the	O
ﬁrst	O
to	O
the	O
third	O
view	O
using	O
x	O
,	O
from	O
table	O
15.2.	O
it	O
is	O
clear	O
from	O
ﬁgure	O
15.4	O
(	O
p371	O
)	O
(	O
b	O
)	O
that	O
this	O
transfer	B
is	O
not	O
degenerate	B
for	O
general	O
points	O
x	O
lying	O
on	O
the	O
trifocal	B
plane	O
.	O
passing	O
through	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
.	O
if	O
a	O
line	B
l	O
(	O
cid:2	O
)	O
t	O
jk	O
(	O
cid:2	O
)	O
j	O
i	O
however	O
,	O
note	O
from	O
result	O
15.3	O
and	O
ﬁgure	O
15.6	O
that	O
if	O
l	O
(	O
cid:2	O
)	O
t	O
jk	O
i	O
=	O
0k	O
,	O
so	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
is	O
the	O
epipolar	B
line	I
corre-	O
(	O
cid:2	O
)	O
sponding	O
to	O
x	O
,	O
then	O
xil	O
is	O
undeﬁned	O
.	O
consequently	O
,	O
the	O
choice	B
of	O
line	B
l	O
(	O
cid:2	O
)	O
j	O
is	O
important	O
.	O
to	O
avoid	O
choosing	O
only	O
an	O
epipolar	B
line	I
,	O
one	O
possibility	O
(	O
cid:2	O
)	O
rrjp	O
for	O
the	O
is	O
to	O
use	O
two	O
or	O
three	O
different	O
lines	B
passing	O
through	O
x	O
(	O
cid:2	O
)	O
three	O
choices	O
of	O
p	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
for	O
each	O
such	O
line	B
,	O
one	O
computes	O
the	O
value	O
of	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
retains	O
the	O
one	O
that	O
has	O
the	O
largest	O
norm	B
(	O
i.e	O
.	O
is	O
furthest	O
from	O
being	O
zero	O
)	O
.	O
an	O
alternative	O
method	O
entirely	O
for	O
ﬁnding	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
is	O
as	O
the	O
least-squares	B
solution	I
of	O
the	O
system	O
of	O
linear	O
equations	O
xi	O
(	O
x	O
i	O
=	O
0rs	O
,	O
but	O
this	O
method	O
is	O
probably	O
an	O
overkill	O
.	O
the	O
method	O
we	O
recommend	O
is	O
the	O
following	O
.	O
before	O
attempting	O
to	O
compute	O
the	O
point	B
transferred	O
from	O
a	O
pair	O
of	B
points	I
x	O
↔	O
x	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
ﬁrst	O
correct	O
the	O
pair	O
of	B
points	I
using	O
the	O
fundamental	B
matrix	I
f21	O
,	O
as	O
described	O
above	O
in	O
the	O
case	O
of	O
epipolar	O
transfer	O
.	O
if	O
ˆx	O
and	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
kqs	O
)	O
t	O
pq	O
(	O
cid:2	O
)	O
j	O
jpr	O
)	O
(	O
x	O
(	O
cid:2	O
)	O
jp	O
=	O
x	O
,	O
namely	O
l	O
382	O
15	O
the	O
trifocal	B
tensor	I
b12	O
e	O
21	O
c	O
2	O
l	O
/	O
image	O
2	O
b	O
23	O
c	O
3	O
//	O
x	O
x	O
π	O
/	O
image	O
3	O
e	O
12	O
c	O
1	O
x	O
image	O
1	O
fig	O
.	O
15.9.	O
degeneracy	B
for	O
point	B
transfer	I
using	O
the	O
trifocal	B
tensor	I
.	O
the	O
3d	O
point	B
x	O
is	O
deﬁned	O
by	O
the	O
intersection	B
of	O
the	O
ray	O
through	O
x	O
with	O
the	O
plane	B
π	O
(	O
cid:1	O
)	O
.	O
a	O
point	B
x	O
on	O
the	O
baseline	O
b12	O
between	O
the	O
ﬁrst	O
and	O
second	O
views	O
can	O
not	O
be	O
deﬁned	O
in	O
this	O
manner	O
.	O
so	O
a	O
3d	O
point	B
on	O
the	O
line	B
b12	O
can	O
not	O
be	O
transferred	O
to	O
the	O
third	O
view	O
via	O
a	O
homography	B
deﬁned	O
by	O
a	O
line	B
in	O
the	O
second	O
view	O
.	O
note	O
that	O
a	O
point	B
on	O
the	O
line	B
b12	O
projects	O
to	O
e12	O
in	O
the	O
ﬁrst	O
image	O
and	O
e21	O
in	O
the	O
second	O
image	O
.	O
apart	O
from	O
the	O
line	B
b12	O
any	O
point	B
can	O
be	O
transferred	O
.	O
in	O
particular	O
there	O
is	O
not	O
a	O
degeneracy	B
problem	O
for	O
points	O
on	O
the	O
baseline	O
b23	O
,	O
between	O
views	O
two	O
and	O
three	O
,	O
or	O
for	O
any	O
other	O
point	B
on	O
the	O
trifocal	B
plane	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
=	O
ˆxil	O
(	O
cid:2	O
)	O
j	O
t	O
jk	O
chosen	O
passing	O
through	O
ˆx	O
(	O
cid:2	O
)	O
does	O
not	O
depend	O
on	O
the	O
are	O
an	O
exact	O
match	O
,	O
then	O
the	O
transferred	O
point	B
x	O
line	B
l	O
(	O
cid:2	O
)	O
(	O
as	O
long	O
as	O
it	O
is	O
not	O
the	O
epipolar	B
line	I
)	O
.	O
this	O
may	O
be	O
veriﬁed	O
geometrically	O
by	O
referring	O
to	O
ﬁgure	O
15.2	O
(	O
p368	O
)	O
.	O
a	O
good	O
choice	B
is	O
always	O
given	O
by	O
the	O
line	B
perpendicular	O
to	O
f21ˆx	O
.	O
to	O
summarize	O
,	O
a	O
measured	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
steps	O
:	O
is	O
transferred	O
by	O
the	O
following	O
i	O
(	O
i	O
)	O
compute	O
f21	O
from	O
the	O
trifocal	B
tensor	I
(	O
by	O
the	O
method	O
given	O
in	O
algorithm	O
15.1	O
)	O
,	O
using	O
algorithm	O
12.1-	O
to	O
the	O
exact	O
correspondence	B
ˆx	O
↔	O
ˆx	O
(	O
cid:2	O
)	O
and	O
correct	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
p318	O
)	O
.	O
(	O
ii	O
)	O
compute	O
the	O
line	B
l	O
(	O
cid:2	O
)	O
e	O
=	O
(	O
l1	O
,	O
l2	O
,	O
l3	O
)	O
t	O
and	O
ˆx	O
(	O
cid:2	O
)	O
l	O
(	O
cid:2	O
)	O
(	O
iii	O
)	O
the	O
transferred	O
point	B
is	O
x	O
through	O
ˆx	O
(	O
cid:2	O
)	O
=	O
(	O
ˆx1	O
,	O
ˆx2	O
,	O
1	O
)	O
t	O
,	O
then	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
=	O
ˆxil	O
j	O
and	O
perpendicular	O
to	O
l	O
(	O
cid:2	O
)	O
t	O
jk	O
e	O
=	O
f21ˆx	O
.	O
=	O
(	O
l2	O
,	O
−l1	O
,	O
−ˆx1l2	O
+	O
ˆx2l1	O
)	O
t.	O
.	O
i	O
if	O
degenerate	B
conﬁgurations	I
.	O
consider	O
transfer	B
to	O
the	O
third	O
view	O
via	O
a	O
plane	B
,	O
as	O
shown	O
in	O
ﬁgure	O
15.9.	O
the	O
3d	O
point	B
x	O
is	O
only	O
undeﬁned	O
if	O
it	O
lies	O
on	O
the	O
baseline	O
joining	O
the	O
ﬁrst	O
and	O
second	O
camera	B
centres	O
.	O
this	O
is	O
because	O
rays	O
through	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
are	O
collinear	O
for	O
such	O
3d	O
points	O
and	O
so	O
their	O
intersection	B
is	O
not	O
deﬁned	O
.	O
in	O
such	O
a	O
case	O
,	O
the	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
correspond	O
with	O
the	O
epipoles	B
in	O
the	O
two	O
images	O
.	O
however	O
,	O
there	O
is	O
no	O
problem	O
transferring	O
a	O
point	B
lying	O
on	O
the	O
baseline	O
between	O
views	O
two	O
and	O
three	O
,	O
or	O
anywhere	O
else	O
on	O
the	O
trifocal	B
plane	O
.	O
this	O
is	O
the	O
key	O
difference	O
between	O
epipolar	O
transfer	B
and	O
transfer	B
using	O
the	O
trifocal	B
tensor	I
.	O
the	O
former	O
is	O
undeﬁned	O
for	O
any	O
point	B
on	O
the	O
trifocal	B
plane	O
.	O
15.3.3	O
line	B
transfer	I
using	O
the	O
trifocal	B
tensor	I
using	O
the	O
trifocal	B
tensor	I
,	O
it	O
is	O
possible	O
to	O
transfer	O
lines	B
from	O
a	O
pair	O
of	O
images	O
to	O
a	O
third	O
t	O
jk	O
according	O
to	O
the	O
line-transfer	O
equation	O
li	O
=	O
l	O
i	O
of	O
table	O
15.2.	O
this	O
gives	O
an	O
explicit	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
15.4	O
the	O
fundamental	O
matrices	O
for	B
three	I
views	I
383	O
are	O
known	O
in	O
the	O
ﬁrst	O
and	O
second	O
views	O
then	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
formula	O
for	O
the	O
line	B
in	O
the	O
ﬁrst	O
view	O
,	O
given	O
lines	B
in	O
the	O
other	O
two	B
views	I
.	O
note	O
however	O
that	O
if	O
the	O
lines	B
l	O
and	O
l	O
(	O
cid:2	O
)	O
may	O
be	O
computed	O
t	O
jk	O
by	O
solving	B
the	O
set	O
of	O
linear	O
equations	O
(	O
lrris	O
)	O
l	O
i	O
=	O
0s	O
,	O
thereby	O
transferring	O
it	O
into	O
the	O
third	O
image	O
.	O
similarly	O
one	O
may	O
transfer	B
lines	O
into	O
the	O
second	O
image	O
.	O
line	B
transfer	I
is	O
not	O
possible	O
using	O
only	O
the	O
fundamental	O
matrices	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
degeneracies	B
.	O
consider	O
the	O
geometry	O
of	O
ﬁgure	O
12.8	O
(	O
p322	O
)	O
.	O
the	O
line	B
l	O
in	O
3-space	O
is	O
deﬁned	O
by	O
the	O
intersection	B
of	O
the	O
planes	O
through	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
,	O
namely	O
π	O
and	O
π	O
(	O
cid:2	O
)	O
respectively	O
.	O
this	O
line	B
is	O
clearly	O
undeﬁned	O
when	O
the	O
planes	O
π	O
and	O
π	O
(	O
cid:2	O
)	O
are	O
coincident	O
,	O
i.e	O
.	O
in	O
the	O
case	O
of	O
epipolar	O
planes	O
.	O
consequently	O
,	O
lines	B
can	O
not	O
be	O
transferred	O
between	O
the	O
ﬁrst	O
and	O
third	O
image	O
if	O
both	O
l	O
and	O
l	O
(	O
cid:2	O
)	O
are	O
corresponding	O
epipolar	B
lines	I
for	O
the	O
ﬁrst	O
and	O
second	O
views	O
.	O
t	O
jk	O
i	O
=	O
0	O
,	O
and	O
the	O
equation	O
algebraically	O
,	O
the	O
line-transfer	O
equation	O
gives	O
li	O
=	O
l	O
t	O
jk	O
used	O
to	O
solve	O
for	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
becomes	O
zero	O
.	O
it	O
is	O
quite	O
common	O
for	B
lines	I
to	O
matrix	B
(	O
lrris	O
)	O
l	O
j	O
be	O
near	O
epipolar	B
,	O
and	O
their	O
transfer	B
is	O
then	O
inaccurate	O
,	O
so	O
this	O
condition	O
should	O
always	O
be	O
checked	O
for	O
.	O
there	O
is	O
an	O
equivalent	B
degeneracy	O
for	O
line	O
transfer	B
between	O
views	O
one	O
and	O
two	O
deﬁned	O
by	O
a	O
line	B
in	O
view	O
three	O
.	O
again	O
,	O
it	O
occurs	O
if	O
the	O
lines	B
in	O
views	O
one	O
and	O
three	O
are	O
corresponding	O
epipolar	B
lines	I
for	O
these	O
two	B
views	I
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
i	O
in	O
general	O
the	O
epipolar	B
geometries	O
between	O
views	O
one	O
and	O
two	O
,	O
and	O
one	O
and	O
three	O
will	O
differ	O
,	O
for	O
instance	O
the	O
epipole	O
e12	O
arising	O
in	O
the	O
ﬁrst	O
view	O
from	O
view	O
two	O
will	O
not	O
coincide	O
with	O
the	O
epipole	O
e13	O
arising	O
in	O
the	O
ﬁrst	O
view	O
from	O
view	O
three	O
.	O
thus	O
an	O
epipolar	B
line	I
in	O
the	O
ﬁrst	O
view	O
for	O
views	O
one	O
and	O
two	O
will	O
not	O
coincide	O
with	O
an	O
epipolar	B
line	I
for	O
views	O
one	O
and	O
three	O
.	O
consequently	O
,	O
when	O
line	B
transfer	I
into	O
the	O
third	O
view	O
is	O
degenerate	B
,	O
line	B
transfer	I
into	O
the	O
second	O
view	O
will	O
not	O
in	O
general	O
be	O
degenerate	B
.	O
however	O
,	O
for	B
lines	I
in	O
the	O
trifocal	B
plane	O
transfer	B
is	O
degenerate	B
(	O
i.e	O
.	O
undeﬁned	O
)	O
always	O
.	O
15.4	O
the	O
fundamental	O
matrices	O
for	B
three	I
views	I
the	O
three	O
fundamental	O
matrices	O
f21	O
,	O
f31	O
,	O
f32	O
are	O
not	O
independent	O
,	O
but	O
satisfy	O
three	O
rela-	O
tions	O
:	O
et	O
23	O
31	O
32	O
f21	O
e13	O
=	O
et	O
f31	O
e12	O
=	O
0.	O
these	O
relations	O
are	O
easily	O
seen	O
from	O
ﬁgure	O
15.8.	O
for	O
example	O
,	O
et	O
f31	O
e12	O
=	O
0	O
follows	O
32	O
from	O
the	O
observation	O
that	O
e32	O
and	O
e12	O
are	O
matching	B
points	O
,	O
corresponding	O
to	O
the	O
centre	B
of	O
camera	B
number	O
2.	O
f32	O
e21	O
=	O
et	O
(	O
15.11	O
)	O
projectively	O
,	O
the	O
three-camera	O
conﬁguration	O
has	O
18	O
degrees	B
of	I
freedom	I
counting	O
11	O
for	O
each	O
camera	B
less	O
15	O
for	O
an	O
overall	O
projective	B
ambiguity	I
.	O
alternatively	O
,	O
this	O
may	O
be	O
accounted	O
for	O
as	O
21	O
for	O
the	O
3	O
×	O
7	O
degrees	B
of	I
freedom	I
of	O
the	O
fundamental	O
matrices	O
less	O
3	O
for	O
the	O
relations	O
.	O
the	O
trifocal	B
tensor	I
also	O
has	O
18	O
degrees	B
of	I
freedom	I
and	O
fundamental	O
matrices	O
computed	O
from	O
the	O
trifocal	B
tensor	I
will	O
automatically	O
satisfy	O
the	O
three	O
relations	O
.	O
the	O
counting	B
argument	I
implies	O
that	O
the	O
three	O
relations	O
of	O
(	O
15.11	O
)	O
are	O
sufﬁcient	O
to	O
ensure	O
consistency	O
of	O
three	O
fundamental	O
matrices	O
.	O
the	O
counting	B
argument	I
alone	O
is	O
not	O
a	O
convincing	O
proof	O
of	O
this	O
,	O
however	O
,	O
so	O
a	O
proof	O
is	O
given	O
below	O
.	O
deﬁnition	B
15.5.	O
three	O
fundamental	O
matrices	O
f21	O
,	O
f31	O
and	O
f32	O
are	O
said	O
to	O
be	O
compatible	O
if	O
they	O
satisfy	O
the	O
conditions	O
(	O
15.11	O
)	O
.	O
384	O
15	O
the	O
trifocal	B
tensor	I
in	O
most	O
cases	O
,	O
these	O
conditions	O
are	O
sufﬁcient	O
to	O
ensure	O
that	O
the	O
three	O
fundamental	O
ma-	O
trices	O
correspond	O
to	O
some	O
geometric	B
conﬁguration	O
of	O
cameras	O
.	O
theorem	O
15.6.	O
let	O
a	O
set	O
of	O
three	O
fundamental	O
matrices	O
f21	O
,	O
f31	O
and	O
f32	O
be	O
given	O
sat-	O
isfying	O
the	O
conditions	O
(	O
15.11	O
)	O
.	O
assume	O
also	O
that	O
e12	O
(	O
cid:5	O
)	O
=	O
e13	O
,	O
e21	O
(	O
cid:5	O
)	O
=	O
e23	O
,	O
and	O
e31	O
(	O
cid:5	O
)	O
=	O
e32	O
.	O
then	O
there	O
exist	O
three	O
camera	B
matrices	I
p1	O
,	O
p2	O
,	O
p3	O
such	O
that	O
fij	O
is	O
the	O
fundamental	B
matrix	I
corresponding	O
to	O
the	O
pair	O
(	O
pi	O
,	O
pj	O
)	O
.	O
(	O
cid:5	O
)	O
=	O
eik	O
in	O
this	O
theorem	O
ensure	O
that	O
the	O
three	O
cameras	B
are	O
non-collinear	O
.	O
for	O
this	O
reason	O
they	O
will	O
be	O
referred	O
to	O
here	O
as	O
the	O
non-collinearity	B
conditions	I
.	O
one	O
may	O
show	O
by	O
example	O
(	O
left	O
to	O
the	O
reader	O
)	O
that	O
these	O
conditions	O
are	O
necessary	O
for	O
the	O
truth	O
of	O
the	O
theorem	O
.	O
note	O
that	O
the	O
conditions	O
eij	O
proof	O
.	O
in	O
this	O
proof	O
,	O
the	O
indices	O
i	O
,	O
j	O
and	O
k	O
are	O
intended	O
to	O
be	O
distinct	O
.	O
we	O
begin	O
by	O
choosing	O
three	O
points	O
xi	O
;	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
,	O
consistent	O
with	O
the	O
three	O
fundamental	O
matrices	O
.	O
in	O
other	O
words	O
,	O
we	O
require	O
that	O
xt	O
fijxj	O
=	O
0	O
for	O
all	O
pairs	O
(	O
i	O
,	O
j	O
)	O
.	O
this	O
is	O
easily	O
done	O
i	O
by	O
choosing	O
ﬁrst	O
x1	O
and	O
x2	O
to	O
satisfy	O
xt	O
f21x1	O
=	O
0	O
,	O
and	O
then	O
deﬁning	O
x3	O
to	O
be	O
the	O
2	O
intersection	B
of	O
the	O
two	O
epipolar	O
lines	B
f32x2	O
and	O
f31x1	O
.	O
in	O
a	O
similar	O
manner	O
,	O
we	O
choose	O
a	O
second	O
set	O
of	B
points	I
yi	O
;	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
satisfying	O
yt	O
fijyj	O
=	O
0.	O
this	O
is	O
done	O
in	O
such	O
a	O
way	O
that	O
the	O
four	O
points	O
xi	O
,	O
yi	O
,	O
eij	O
,	O
eik	O
in	O
each	O
i	O
image	O
i	O
are	O
in	O
general	O
position	O
–	O
that	O
is	O
no	O
three	O
are	O
collinear	O
.	O
this	O
is	O
possible	O
by	O
the	O
assumption	O
that	O
the	O
two	O
epipoles	O
in	O
each	O
image	O
are	O
distinct	O
.	O
next	O
we	O
choose	O
ﬁve	O
world	O
points	O
c1	O
,	O
c2	O
,	O
c3	O
,	O
x	O
,	O
y	O
in	O
general	O
position	O
.	O
for	O
example	O
,	O
one	O
could	O
take	O
the	O
usual	O
projective	B
basis	O
.	O
we	O
may	O
now	O
deﬁne	O
the	O
three	O
camera	B
matri-	O
ces	O
.	O
let	O
the	O
i-th	O
camera	B
matrix	I
pi	O
satisfy	O
the	O
conditions	O
pici	O
=	O
0	O
;	O
picj	O
=	O
eij	O
;	O
pick	O
=	O
eik	O
;	O
pix	O
=	O
xi	O
;	O
piy	O
=	O
yi	O
.	O
in	O
other	O
words	O
,	O
the	O
i-th	O
camera	B
has	O
centre	B
at	O
ci	O
and	O
maps	O
the	O
four	O
other	O
world	O
points	O
cj	O
,	O
ck	O
,	O
x	O
,	O
y	O
to	O
the	O
four	O
image	O
points	O
eij	O
,	O
eik	O
,	O
xi	O
,	O
yi	O
.	O
this	O
uniquely	O
determines	O
the	O
cam-	O
era	O
matrix	B
since	O
the	O
points	O
are	O
in	O
general	O
position	O
.	O
to	O
see	O
this	O
,	O
recall	O
that	O
the	O
camera	B
matrix	I
deﬁnes	O
a	O
homography	B
between	O
the	O
image	O
and	O
the	O
rays	O
through	O
the	O
camera	B
cen-	O
tre	O
(	O
a	O
2d	O
projective	B
space	O
)	O
.	O
the	O
images	O
of	O
four	O
points	O
specify	O
this	O
homography	B
com-	O
pletely	O
.	O
let	O
ˆfij	O
be	O
the	O
fundamental	B
matrix	I
deﬁned	O
by	O
the	O
pair	O
of	B
camera	I
matrices	O
pi	O
and	O
pj	O
.	O
the	O
proof	O
is	O
completed	O
by	O
proving	O
that	O
ˆfij	O
=	O
fij	O
for	O
all	O
i	O
,	O
j.	O
the	O
epipoles	B
of	O
ˆfij	O
and	O
fij	O
are	O
the	O
same	O
,	O
by	O
the	O
way	O
that	O
pi	O
and	O
pj	O
are	O
constructed	O
.	O
consider	O
the	O
pencil	O
of	B
epipolar	I
lines	I
through	O
eij	O
in	O
image	O
i.	O
this	O
pencil	O
forms	O
a	O
1-	O
dimensional	O
projective	B
space	O
of	B
lines	I
,	O
and	O
the	O
fundamental	B
matrix	I
fij	O
induces	O
a	O
one-	O
to-one	O
correspondence	B
(	O
in	O
fact	O
a	O
homography	B
)	O
between	O
this	O
pencil	O
and	O
the	O
pencil	O
of	B
lines	I
through	O
eji	O
in	O
image	O
j.	O
the	O
fundamental	B
matrix	I
ˆfij	O
also	O
induces	O
a	O
homography	B
between	O
the	O
same	O
pencils	O
.	O
the	O
two	O
fundamental	O
matrices	O
are	O
the	O
same	O
if	O
the	O
homogra-	O
phies	O
they	O
induce	O
are	O
the	O
same	O
.	O
two	O
1-dimensional	O
homographies	B
are	O
the	O
same	O
if	O
they	O
agree	O
on	O
three	O
points	O
(	O
or	O
in	O
this	O
case	O
epipolar	B
lines	I
)	O
.	O
the	O
relation	B
xt	O
fijxj	O
=	O
0	O
means	O
that	O
the	O
epipolar	B
lines	I
through	O
i	O
xi	O
in	O
image	O
i	O
and	O
xj	O
in	O
image	O
j	O
correspond	O
under	O
the	O
homography	B
induced	O
by	O
fij	O
.	O
by	O
construction	O
xiˆfijxj	O
=	O
0	O
as	O
well	O
,	O
since	O
xi	O
and	O
xj	O
are	O
the	O
projections	O
of	O
the	O
point	O
x	O
in	O
15.4	O
the	O
fundamental	O
matrices	O
for	B
three	I
views	I
385	O
the	O
two	O
images	O
.	O
thus	O
,	O
both	O
homographies	O
agree	O
on	O
this	O
pair	O
of	B
epipolar	I
lines	I
.	O
in	O
the	O
same	O
way	O
,	O
the	O
homographies	B
induced	O
by	O
fij	O
and	O
ˆfij	O
agree	O
on	O
the	O
epipolar	B
lines	I
corre-	O
sponding	O
to	O
the	O
pairs	O
yi	O
↔	O
yj	O
and	O
eik	O
↔	O
ejk	O
.	O
the	O
two	O
homographies	O
therefore	O
agree	O
on	O
three	O
lines	B
in	O
the	O
pencil	O
and	O
hence	O
are	O
equal	O
;	O
so	O
are	O
the	O
corresponding	O
fundamental	O
matrices	O
.	O
(	O
we	O
are	O
grateful	O
to	O
frederik	O
schaffalitzky	O
for	O
this	O
proof	O
)	O
.	O
15.4.1	O
uniqueness	B
of	O
camera	B
matrices	I
given	O
three	O
fundamental	O
matrices	O
the	O
proof	O
just	O
given	O
shows	O
that	O
there	O
is	O
at	O
least	O
one	O
set	O
of	O
cameras	O
corresponding	O
to	O
three	O
compatible	O
fundamental	O
matrices	O
(	O
provided	O
they	O
satisfying	O
the	O
non-collinearity	O
condition	O
)	O
.	O
it	O
is	O
important	O
to	O
know	O
that	O
the	O
three	O
fundamental	O
matrices	O
determine	O
the	O
conﬁguration	O
of	O
the	O
three	O
cameras	B
uniquely	O
,	O
at	O
least	O
up	O
to	O
the	O
unavoidable	O
projective	B
ambiguity	I
.	O
this	O
will	O
be	O
shown	O
next	O
.	O
the	O
ﬁrst	O
two	O
camera	O
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
may	O
be	O
determined	O
from	O
the	O
fundamental	B
matrix	I
f21	O
by	O
two-view	O
techniques	O
(	O
chapter	O
9	O
)	O
.	O
it	O
remains	O
to	O
determine	O
the	O
third	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
in	O
the	O
same	O
projective	O
frame	O
.	O
in	O
principle	O
,	O
this	O
may	O
be	O
done	O
as	O
follows	O
.	O
(	O
i	O
)	O
select	O
a	O
set	O
of	O
matching	O
points	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
in	O
the	O
ﬁrst	O
two	O
images	O
,	O
satisfying	O
tf21xi	O
=	O
0	O
,	O
and	O
use	O
triangulation	O
to	O
determine	O
the	O
corresponding	O
3d	O
points	O
(	O
ii	O
)	O
use	O
epipolar	O
transfer	B
to	O
determine	O
the	O
corresponding	O
points	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
in	O
the	O
third	O
im-	O
x	O
(	O
cid:2	O
)	O
i	O
xi	O
.	O
(	O
iii	O
)	O
solve	O
for	O
the	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
age	O
,	O
using	O
the	O
fundamental	O
matrices	O
f31	O
and	O
f32	O
.	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
.	O
from	O
the	O
set	O
of	O
3d–2d	O
correspondences	B
the	O
second	O
step	O
in	O
this	O
algorithm	B
will	O
fail	O
in	O
the	O
case	O
where	O
the	O
point	B
xi	O
lies	O
in	O
the	O
trifocal	B
plane	O
.	O
such	O
a	O
point	B
xi	O
is	O
easily	O
detected	O
and	O
discarded	O
,	O
since	O
it	O
projects	O
into	O
the	O
ﬁrst	O
image	O
as	O
a	O
point	B
xi	O
lying	O
on	O
the	O
line	B
joining	O
the	O
two	O
epipoles	O
e12	O
and	O
e13	O
.	O
since	O
there	O
are	O
inﬁnitely	O
many	O
possible	O
matched	O
points	O
,	O
we	O
can	O
compute	O
sufﬁciently	O
many	O
such	O
points	O
to	O
compute	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
the	O
only	O
situation	O
in	O
which	O
this	O
method	O
will	O
fail	O
is	O
when	O
all	O
space	O
points	O
xi	O
lie	O
in	O
a	O
trifocal	B
plane	O
.	O
this	O
can	O
occur	O
only	O
in	O
the	O
degenerate	B
situation	O
in	O
which	O
the	O
three	O
camera	B
centres	O
are	O
collinear	O
,	O
in	O
which	O
case	O
the	O
trifocal	B
plane	O
is	O
not	O
uniquely	O
determined	O
.	O
thus	O
,	O
we	O
see	O
that	O
unless	O
the	O
three	O
camera	B
centres	O
are	O
collinear	O
,	O
the	O
three	O
camera	B
matrices	I
may	O
be	O
determined	O
from	O
the	O
fundamental	O
matrices	O
.	O
on	O
the	O
other	O
hand	O
,	O
if	O
the	O
three	O
cameras	B
are	O
collinear	O
,	O
then	O
there	O
is	O
no	O
way	O
to	O
determine	O
the	O
relative	O
spacings	O
of	O
the	O
cameras	O
along	O
the	O
line	B
of	O
their	O
centres	O
.	O
this	O
is	O
because	O
the	O
length	O
of	O
the	O
baseline	O
can	O
not	O
be	O
determined	O
from	O
the	O
fundamental	O
matrices	O
,	O
and	O
the	O
three	O
baselines	O
(	O
distances	O
between	O
the	O
camera	B
centres	O
)	O
may	O
be	O
arbitrarily	O
chosen	O
and	O
remain	O
consistent	O
with	O
the	O
fundamental	O
matrices	O
.	O
thus	O
we	O
have	O
demonstrated	O
the	O
following	O
fact	O
:	O
result	O
15.7.	O
given	O
three	O
compatible	O
fundamental	O
matrices	O
f21	O
,	O
f31	O
and	O
f32	O
satisfying	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
non-collinearity	O
condition	O
,	O
the	O
three	O
corresponding	O
camera	B
matrices	I
p	O
,	O
p	O
(	O
cid:2	O
)	O
are	O
unique	O
up	O
to	O
the	O
choice	B
of	O
a	O
3d	O
projective	B
coordinate	O
frame	O
.	O
386	O
15	O
the	O
trifocal	B
tensor	I
15.4.2	O
computation	B
of	I
camera	O
matrices	O
from	O
three	O
fundamental	O
matrices	O
given	O
three	O
compatible	O
fundamental	O
matrices	O
,	O
there	O
exists	O
a	O
simple	O
method	O
for	O
com-	O
puting	O
a	O
corresponding	O
set	O
of	O
three	O
camera	B
matrices	I
.	O
from	O
the	O
fundamental	B
matrix	I
f21	O
,	O
one	O
can	O
compute	O
a	O
corresponding	O
pair	O
of	B
camera	I
matrices	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
using	O
result	O
9.14-	O
(	O
p256	O
)	O
.	O
next	O
,	O
according	O
to	O
result	O
9.12	O
(	O
p255	O
)	O
the	O
third	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
must	O
satisfy	O
the	O
condition	O
that	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
tf31p	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
tf32p	O
(	O
cid:2	O
)	O
be	O
skew-symmetric	O
.	O
each	O
of	O
these	O
matrices	O
gives	O
rise	O
to	O
10	O
linear	B
equations	I
in	O
the	O
entries	O
of	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
a	O
total	O
of	O
20	O
equations	O
in	O
the	O
12	O
entries	O
of	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
may	O
be	O
computed	O
linearly	O
.	O
.	O
from	O
these	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
if	O
the	O
three	O
fundamental	O
matrices	O
are	O
compatible	O
in	O
the	O
sense	O
of	O
deﬁnition	O
15.5	O
and	O
the	O
non-collinearity	O
condition	O
of	O
theorem	O
15.6	O
holds	O
,	O
then	O
there	O
will	O
exist	O
a	O
solution	B
,	O
and	O
it	O
will	O
be	O
unique	O
.	O
if	O
however	O
the	O
three	O
fundamental	O
matrices	O
are	O
computed	O
in-	O
dependently	O
from	O
point	O
correspondences	O
,	O
then	O
they	O
will	O
not	O
satisfy	O
the	O
compatibility	B
conditions	I
exactly	O
.	O
in	O
this	O
case	O
it	O
will	O
be	O
necessary	O
to	O
compute	O
a	O
least-squares	B
solution	I
to	O
ﬁnd	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
the	O
error	B
being	O
minimized	O
is	O
not	O
geometrically	O
based	O
.	O
it	O
is	O
best	O
to	O
use	O
this	O
algorithm	B
only	O
when	O
the	O
fundamental	O
matrices	O
are	O
known	O
to	O
be	O
compatible	O
.	O
one	O
can	O
think	O
of	O
doing	O
three-view	O
reconstruction	B
by	O
estimating	B
the	O
three	O
fundamen-	O
tal	O
matrices	O
using	O
pairwise	O
point	B
correspondences	O
,	O
then	O
using	O
the	O
above	O
algorithm	B
to	O
estimate	O
the	O
three	O
camera	B
matrices	I
.	O
this	O
is	O
not	O
a	O
very	O
good	O
strategy	O
,	O
for	O
the	O
following	O
reasons	O
.	O
(	O
i	O
)	O
the	O
method	O
for	O
computing	O
the	O
three	O
camera	B
matrices	I
from	O
the	O
fundamental	O
matrices	O
assumes	O
that	O
the	O
fundamental	O
matrices	O
are	O
compatible	O
.	O
otherwise	O
,	O
a	O
least-squares	O
problem	O
involving	O
a	O
non-geometrically	O
justiﬁed	O
cost	B
function	I
is	O
involved	O
.	O
(	O
ii	O
)	O
although	O
result	O
15.7	O
shows	O
that	O
three	O
fundamental	O
matrices	O
may	O
determine	O
the	O
camera	B
geometry	O
,	O
and	O
hence	O
the	O
trifocal	B
tensor	I
,	O
this	O
is	O
only	O
true	O
when	O
the	O
cam-	O
eras	O
are	O
not	O
collinear	O
.	O
as	O
they	O
approach	O
collinearity	O
,	O
the	O
estimate	O
of	O
the	O
relative	O
camera	B
placement	O
becomes	O
unstable	O
.	O
the	O
trifocal	B
tensor	I
is	O
preferable	O
to	O
a	O
triple	O
of	O
compatible	O
fundamental	O
matrices	O
as	O
a	O
means	O
of	O
determining	O
the	O
geometry	O
of	O
three	O
views	O
.	O
this	O
is	O
because	O
the	O
difﬁculty	O
with	O
the	O
views	O
being	O
collinear	O
is	O
not	O
an	O
issue	O
with	O
the	O
trifocal	B
tensor	I
.	O
it	O
is	O
well	O
deﬁned	O
and	O
uniquely	O
determines	O
the	O
geometry	O
even	O
for	O
collinear	O
cameras	B
.	O
the	O
difference	O
is	O
that	O
the	O
fundamental	O
matrices	O
do	O
not	O
contain	O
a	O
direct	O
constraint	O
on	O
the	O
relative	O
displacements	O
between	O
the	O
three	O
cameras	B
,	O
whereas	O
this	O
is	O
built	O
into	O
the	O
trifocal	B
tensor	I
.	O
since	O
the	O
projective	B
structure	O
of	O
the	O
three	O
cameras	B
may	O
be	O
computed	O
explicitly	O
from	O
the	O
trifocal	B
tensor	I
,	O
it	O
follows	O
that	O
all	O
three	O
fundamental	O
matrices	O
for	O
the	O
three	O
view	O
pairs	O
are	O
determined	O
by	O
the	O
trifocal	B
tensor	I
.	O
in	O
fact	O
simple	O
formulae	O
,	O
given	O
in	O
algorithm	O
15.1-	O
(	O
p375	O
)	O
exist	O
for	O
the	O
two	O
fundamental	O
matrices	O
f21	O
and	O
f31	O
.	O
the	O
fundamental	O
matrices	O
determined	O
from	O
the	O
trifocal	B
tensor	I
will	O
satisfy	O
the	O
compatibility	B
conditions	I
(	O
15.11	O
)	O
.	O
15.4.3	O
camera	B
matrices	I
compatible	O
with	O
two	O
fundamental	O
matrices	O
suppose	O
we	O
are	O
given	O
only	O
two	O
fundamental	O
matrices	O
f21	O
and	O
f31	O
.	O
to	O
what	O
extent	O
do	O
these	O
ﬁx	O
the	O
geometry	O
of	O
the	O
three	O
cameras	B
?	O
it	O
will	O
be	O
shown	O
here	O
that	O
there	O
are	O
four	O
15.5	O
closure	O
387	O
)	O
compatible	O
with	O
the	O
pair	O
of	O
fundamental	O
matrices	O
.	O
from	O
f21	O
one	O
may	O
compute	O
a	O
pair	O
of	B
camera	I
matrices	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
,	O
and	O
from	O
f31	O
the	O
pair	O
)	O
.	O
in	O
both	O
cases	O
we	O
may	O
choose	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
resulting	O
in	O
a	O
triple	O
of	B
camera	I
matrices	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
degrees	B
of	I
freedom	I
in	O
the	O
solution	B
for	O
the	O
camera	B
matrices	I
,	O
beyond	O
the	O
usual	O
projective	B
ambiguity	I
.	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
however	O
,	O
the	O
choice	B
of	O
the	O
three	O
camera	B
matrices	I
is	O
not	O
unique	O
,	O
since	O
for	O
any	O
matrices	O
h1	O
and	O
h2	O
representing	O
3d	O
projective	B
transforms	O
,	O
the	O
pairs	O
(	O
ph1	O
,	O
p	O
(	O
cid:2	O
)	O
h1	O
)	O
and	O
(	O
ph2	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
h2	O
)	O
are	O
also	O
compatible	O
with	O
the	O
same	O
fundamental	O
matrices	O
.	O
in	O
order	O
to	O
pre-	O
serve	O
the	O
condition	O
that	O
p	O
is	O
equal	O
to	O
[	O
i	O
|	O
0	O
]	O
in	O
each	O
case	O
,	O
the	O
form	B
of	I
hi	O
must	O
be	O
re-	O
stricted	O
to	O
:	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
.	O
hi	O
=	O
i	O
vt	O
i	O
0	O
ki	O
)	O
and	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
we	O
may	O
now	O
ﬁx	O
on	O
a	O
particular	O
choice	B
of	O
the	O
ﬁrst	O
two	O
camera	O
matrices	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
com-	O
patible	O
with	O
f21	O
.	O
this	O
is	O
equivalent	B
to	O
ﬁxing	O
on	O
a	O
speciﬁc	O
projective	B
coordinate	O
frame	O
.	O
the	O
general	O
solution	O
for	O
the	O
camera	B
matrices	I
is	O
then	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
h2	O
)	O
,	O
where	O
h2	O
is	O
of	O
the	O
form	O
given	O
above	O
and	O
the	O
two	O
pairs	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
are	O
compatible	O
with	O
the	O
two	O
fundamental	O
matrices	O
.	O
allowing	O
also	O
for	O
the	O
overall	O
projective	B
ambiguity	I
,	O
the	O
most	O
general	O
solution	O
is	O
(	O
ph	O
,	O
p	O
(	O
cid:2	O
)	O
h	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
h2h	O
)	O
,	O
which	O
gives	O
a	O
total	O
of	O
19	O
degrees	B
of	I
freedom	I
,	O
15	O
for	O
the	O
projective	B
transformation	I
h	O
and	O
4	O
for	O
the	O
degrees	B
of	I
freedom	I
of	O
h2	O
.	O
the	O
same	O
number	O
of	O
degrees	O
of	O
freedom	O
may	O
be	O
found	O
using	O
a	O
counting	B
argument	I
as	O
follows	O
:	O
two	O
fundamental	O
ma-	O
trices	O
have	O
7	O
degrees	B
of	I
freedom	I
each	O
,	O
for	O
a	O
total	O
of	O
14.	O
three	O
arbitrary	O
camera	B
matrices	I
on	O
the	O
other	O
hand	O
have	O
3	O
×	O
11	O
=	O
33	O
degrees	B
of	I
freedom	I
.	O
the	O
14	O
constraints	B
imposed	O
by	O
the	O
two	O
fundamental	O
matrices	O
leave	O
19	O
remaining	O
degrees	B
of	I
freedom	I
for	O
the	O
three	O
camera	B
matrices	I
.	O
15.5	O
closure	O
the	O
development	O
of	O
three-view	O
geometry	O
proceeds	O
in	O
an	O
analogous	O
manner	O
to	O
that	O
of	O
two-view	O
geometry	O
covered	O
in	O
part	O
ii	O
of	O
this	O
book	O
.	O
the	O
trifocal	B
tensor	I
may	O
be	O
computed	O
from	O
image	O
correspondences	B
over	O
three	O
views	O
,	O
and	O
a	O
projective	B
reconstruction	I
of	O
the	O
cameras	B
and	O
3d	O
scene	O
then	O
follows	O
.	O
this	O
computation	B
is	O
described	O
in	O
chapter	O
16.	O
the	O
projective	B
ambiguity	I
may	O
be	O
reduced	B
to	O
afﬁne	B
or	O
metric	B
by	O
supplying	O
additional	O
information	O
on	O
the	O
scene	O
or	O
cameras	B
in	O
the	O
same	O
manner	O
as	O
that	O
of	O
chapter	O
10.	O
a	O
similar	O
development	O
to	O
that	O
of	O
chapter	O
13	O
may	O
be	O
given	O
for	O
the	O
relations	O
between	O
homographies	O
induced	O
by	O
scene	O
planes	O
and	O
the	O
trifocal	B
tensor	I
.	O
15.5.1	O
the	O
literature	O
with	O
hindsight	O
,	O
the	O
discovery	O
of	O
the	O
trifocal	O
tensor	B
may	O
be	O
traced	O
to	O
[	O
spetsakis-91	O
]	O
and	O
[	O
weng-88	O
]	O
,	O
where	O
it	O
was	O
used	O
for	O
scene	O
reconstruction	B
from	O
lines	B
in	O
the	O
case	O
of	O
calibrated	O
cameras	B
.	O
it	O
was	O
later	O
shown	O
in	O
[	O
hartley-94d	O
]	O
to	O
be	O
equally	O
applicable	O
to	O
projective	O
scene	O
reconstruction	O
in	O
the	O
uncalibrated	O
case	O
.	O
at	O
this	O
stage	O
matrix	B
notation	O
was	O
used	O
,	O
but	O
[	O
vieville-93	O
]	O
used	O
tensor	B
notation	I
for	O
this	O
problem	O
.	O
388	O
15	O
the	O
trifocal	B
tensor	I
meanwhile	O
in	O
independent	O
work	O
,	O
shashua	O
introduced	O
trilinearity	O
conditions	O
relat-	O
ing	O
the	O
coordinates	B
of	O
corresponding	O
points	O
in	O
three	O
views	O
with	O
uncalibrated	O
cameras	B
[	O
shashua-94	O
,	O
shashua-95a	O
]	O
.	O
[	O
hartley-95b	O
,	O
hartley-97a	O
]	O
then	O
showed	O
that	O
shashua	O
’	O
s	O
re-	O
lation	O
for	O
points	O
and	O
scene	O
reconstruction	O
from	O
lines	O
both	O
arise	O
from	O
a	O
common	O
tensor	B
,	O
and	O
the	O
trifocal	B
tensor	I
was	O
explicitly	O
identiﬁed	O
.	O
in	O
subsequent	O
work	O
properties	B
of	O
the	O
tensor	B
have	O
been	O
investigated	O
,	O
e.g	O
.	O
[	O
shashua-95b	O
]	O
.	O
in	O
particular	O
[	O
triggs-95	O
]	O
described	O
the	O
mixed	O
covariant–contravariant	O
behaviour	O
of	O
the	O
indices	O
,	O
and	O
[	O
zisserman-96	O
]	O
described	O
the	O
geometry	O
of	O
the	O
homogra-	O
phies	O
encoded	O
by	O
the	O
tensor	B
.	O
faugeras	O
and	O
mourrain	O
[	O
faugeras-95a	O
]	O
gave	O
enlightening	O
new	O
derivations	O
of	O
the	O
trifocal	O
tensor	B
equations	O
and	O
considered	O
the	O
trifocal	B
tensor	I
in	O
the	O
context	O
of	O
general	O
linear	B
constraints	O
involving	O
multiple	O
views	O
.	O
this	O
approach	O
will	O
be	O
discussed	O
in	O
chapter	O
17.	O
further	O
geometric	B
properties	O
of	O
the	O
tensor	O
were	O
given	O
in	O
faugeras	O
&	O
papadopoulo	O
[	O
faugeras-97	O
]	O
.	O
epipolar	B
point	O
transfer	B
was	O
described	O
by	O
[	O
barrett-92	O
,	O
faugeras-94	O
]	O
,	O
and	O
its	O
deﬁcien-	O
cies	O
pointed	O
out	O
by	O
[	O
zisserman-94	O
]	O
,	O
amongst	O
others	O
.	O
the	O
trifocal	B
tensor	I
has	O
been	O
used	O
for	O
various	O
applications	O
including	O
establish-	O
ing	O
correspondences	B
in	O
image	O
sequences	O
[	O
beardsley-96	O
]	O
,	O
independent	O
motion	O
detec-	O
tion	O
[	O
torr-95a	O
]	O
,	O
and	O
camera	B
self-calibration	O
[	O
armstrong-96a	O
]	O
.	O
15.5.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
the	O
trifocal	B
tensor	I
is	O
invariant	O
to	O
3d	O
projective	B
transforms	O
.	O
verify	O
explicitly	O
that	O
if	O
h4×4	O
is	O
a	O
transform	O
preserving	O
the	O
ﬁrst	O
camera	B
matrix	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
then	O
the	O
tensor	B
deﬁned	O
by	O
(	O
15.1–p367	O
)	O
is	O
unchanged	O
.	O
=	O
[	O
a	O
|	O
a4	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
in	O
this	O
chapter	O
the	O
starting	O
point	B
for	O
the	O
trifocal	B
tensor	I
derivation	O
was	O
the	O
inci-	O
dence	O
property	O
of	O
three	O
corresponding	O
lines	B
.	O
show	O
that	O
alternatively	O
the	O
starting	O
point	B
may	O
be	O
the	O
homography	B
induced	O
by	O
a	O
plane	B
.	O
here	O
is	O
a	O
sketch	O
derivation	B
:	O
choose	O
the	O
camera	B
matrices	I
to	O
be	O
a	O
canonical	O
set	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
b	O
|	O
b4	O
]	O
and	O
start	O
from	O
the	O
homography	B
h13	O
be-	O
tween	O
the	O
ﬁrst	O
and	O
third	O
views	O
induced	B
by	I
a	I
plane	I
π	O
(	O
cid:2	O
)	O
.	O
from	O
result	O
13.1	O
(	O
p326	O
)	O
this	O
homography	B
may	O
be	O
written	O
as	O
h13	O
=	O
b	O
−	O
b4vt	O
,	O
where	O
π	O
(	O
cid:2	O
)	O
t	O
=	O
(	O
vt	O
,	O
1	O
)	O
.	O
in	O
this	O
case	O
the	O
plane	B
is	O
deﬁned	O
by	O
a	O
line	B
l	O
(	O
cid:2	O
)	O
.	O
show	O
that	O
result	O
15.2	O
(	O
p369	O
)	O
follows	O
.	O
(	O
iii	O
)	O
homographies	B
involving	O
the	O
ﬁrst	O
view	O
are	O
simply	O
expressed	O
in	O
terms	O
of	O
the	O
trifocal	O
tensor	B
t	O
jk	O
as	O
given	O
by	O
result	O
15.2	O
(	O
p369	O
)	O
.	O
investigate	O
whether	O
a	O
sim-	O
ple	O
formula	O
exists	O
for	O
the	O
homography	B
h23	O
from	O
the	O
second	O
to	O
the	O
third	O
view	O
,	O
induced	O
by	O
a	O
line	O
l	O
in	O
the	O
ﬁrst	O
image	O
.	O
is	O
a	O
3	O
×	O
3	O
matrix	B
.	O
show	O
that	O
this	O
may	O
be	O
interpreted	O
as	O
a	O
correlation	B
(	O
see	O
deﬁnition	B
2.29	O
(	O
p59	O
)	O
)	O
mapping	O
between	O
the	O
second	O
and	O
third	O
views	O
induced	O
by	O
the	O
line	B
which	O
is	O
the	O
back-projection	B
of	O
the	O
point	B
x	O
in	O
the	O
ﬁrst	O
view	O
.	O
(	O
iv	O
)	O
the	O
contraction	O
xit	O
jk	O
in	O
the	O
second	O
view	O
as	O
π	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
tl	O
(	O
cid:2	O
)	O
i	O
i	O
(	O
v	O
)	O
plane	B
plus	I
parallax	I
over	O
three	O
views	O
.	O
there	O
is	O
a	O
rich	O
geometry	O
associated	O
with	O
the	O
plane	O
plus	O
two	O
points	O
conﬁguration	O
(	O
see	O
ﬁgure	O
13.9	O
(	O
p336	O
)	O
)	O
over	O
three	O
views	O
:	O
suppose	O
the	O
points	O
off	O
the	O
(	O
reference	O
)	O
plane	B
are	O
x	O
and	O
y.	O
project	O
the	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
15.5	O
closure	O
,	O
and	O
similarly	O
project	O
the	O
point	B
y	O
to	O
the	O
triangle	O
y	O
,	O
y	O
(	O
cid:2	O
)	O
389	O
point	B
x	O
onto	O
the	O
reference	O
plane	B
from	O
each	O
of	O
the	O
three	O
camera	B
centres	O
to	O
form	O
a	O
triangle	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
then	O
the	O
two	O
triangles	O
form	O
a	O
desargues	O
’	O
s	O
conﬁguration	O
and	O
are	O
related	O
by	O
a	O
planar	B
homology	I
(	O
see	O
section	O
a7.2	O
(	O
p629	O
)	O
)	O
.	O
a	O
simple	O
sketch	O
shows	O
that	O
the	O
lines	B
joining	O
corresponding	O
triangle	O
vertices	O
,	O
(	O
x	O
,	O
y	O
)	O
,	O
(	O
x	O
(	O
cid:2	O
)	O
)	O
,	O
are	O
con-	O
current	O
,	O
and	O
their	O
intersection	B
is	O
the	O
point	B
at	O
which	O
the	O
line	B
joining	O
x	O
and	O
y	O
pierces	O
the	O
reference	O
plane	B
.	O
similarly	O
the	O
intersection	B
points	O
of	O
corresponding	O
triangle	O
sides	O
are	O
collinear	O
,	O
and	O
the	O
line	B
so	O
formed	O
is	O
the	O
intersection	B
of	O
the	O
tri-	O
focal	O
plane	O
of	O
the	O
cameras	O
with	O
the	O
reference	O
plane	B
.	O
further	O
details	O
are	O
given	O
in	O
[	O
criminisi-98	O
,	O
irani-98	O
,	O
triggs-00b	O
]	O
.	O
,	O
y	O
(	O
cid:2	O
)	O
)	O
,	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
vi	O
)	O
in	O
the	O
case	O
where	O
two	O
of	O
the	O
three	O
cameras	B
have	O
the	O
same	O
camera	O
centre	O
,	O
the	O
trifocal	B
tensor	I
may	O
be	O
related	O
to	O
simpler	O
entities	O
.	O
there	O
are	O
two	O
cases	O
.	O
the	O
second	O
and	O
third	O
camera	B
have	O
the	O
same	O
centre	O
,	O
then	O
(	O
a	O
)	O
if	O
t	O
jk	O
i	O
=	O
frihk	O
s	O
rjs	O
,	O
where	O
fri	O
is	O
the	O
fundamental	B
matrix	I
for	O
the	O
ﬁrst	O
two	B
views	I
,	O
and	O
h	O
is	O
the	O
homography	B
from	O
the	O
second	O
to	O
the	O
third	O
view	O
in-	O
duced	O
by	O
the	O
fact	O
that	O
they	O
have	O
the	O
same	O
centre	O
.	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
,	O
i	O
=	O
hj	O
where	O
h	O
is	O
the	O
homography	B
from	O
the	O
ﬁrst	O
to	O
the	O
second	O
view	O
and	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
is	O
the	O
epipole	O
in	O
the	O
third	O
image	O
.	O
(	O
b	O
)	O
if	O
the	O
ﬁrst	O
and	O
the	O
second	O
views	O
have	O
the	O
same	O
centre	O
,	O
then	O
t	O
jk	O
i	O
prove	O
these	O
relationships	O
using	O
the	O
approach	O
of	O
chapter	O
17	O
.	O
(	O
vii	O
)	O
consider	O
the	O
case	O
of	O
a	O
small	O
baseline	O
between	O
the	O
cameras	B
and	O
derive	O
a	O
differ-	O
ential	O
form	B
of	I
the	O
trifocal	B
tensor	I
,	O
see	O
[	O
astrom-98	O
,	O
triggs-99b	O
]	O
.	O
(	O
viii	O
)	O
there	O
are	O
actually	O
three	O
different	O
trifocal	B
tensors	O
relating	O
three	O
views	O
,	O
depend-	O
ing	O
on	O
which	O
of	O
the	O
three	O
cameras	B
corresponds	O
to	O
the	O
covariant	O
index	O
.	O
given	O
one	O
such	O
tensor	B
[	O
ti	O
]	O
,	O
verify	O
that	O
the	O
tensor	B
[	O
t	O
(	O
cid:2	O
)	O
i	O
]	O
may	O
be	O
computed	O
in	O
several	O
steps	O
,	O
as	O
follows	O
:	O
(	O
a	O
)	O
extract	O
the	O
three	O
camera	B
matrices	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
from	O
the	O
trifocal	B
tensor	I
.	O
(	O
b	O
)	O
find	O
a	O
3d	O
projective	B
transformation	I
h	O
such	O
that	O
p	O
(	O
cid:2	O
)	O
h	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
and	O
apply	O
it	O
to	O
each	O
of	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
c	O
)	O
compute	O
the	O
tensor	B
[	O
t	O
(	O
cid:2	O
)	O
as	O
well	O
.	O
i	O
]	O
by	O
applying	O
(	O
15.1–p367	O
)	O
.	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
ix	O
)	O
investigate	O
the	O
form	O
and	O
properties	B
(	O
e.g	O
.	O
rank	O
of	O
the	O
matrices	O
ti	O
)	O
of	O
the	O
trifocal	O
tensor	B
for	O
the	O
special	O
motions	O
(	O
pure	O
translation	O
,	O
planar	B
motion	I
)	O
described	O
in	O
section	O
9.3	O
(	O
p247	O
)	O
for	O
the	O
fundamental	B
matrix	I
.	O
(	O
x	O
)	O
comparison	O
of	O
the	O
incidence	O
relationships	O
of	O
table	O
15.3	O
(	O
p378	O
)	O
indicates	O
that	O
(	O
cid:2	O
)	O
one	O
may	O
replace	O
a	O
line	B
l	O
r	O
,	O
and	O
proceed	O
similarly	O
with	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k.	O
also	O
,	O
one	O
gets	O
a	O
three-view	O
line	B
equation	O
by	O
replacing	O
xi	O
by	O
irsli	O
.	O
can	O
both	O
l	O
of	O
these	O
operations	O
be	O
carried	O
out	O
at	O
once	O
to	O
obtain	O
an	O
equation	O
(	O
cid:2	O
)	O
j	O
by	O
the	O
expression	O
jrsx	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
(	O
cid:2	O
)	O
j	O
iruli	O
jsvx	O
why	O
,	O
or	O
why	O
not	O
?	O
(	O
cid:16	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
ktwx	O
t	O
st	O
r	O
=	O
0u	O
vw	O
?	O
390	O
15	O
the	O
trifocal	B
tensor	I
(	O
xi	O
)	O
afﬁne	B
trifocal	O
tensor	B
.	O
if	O
the	O
three	O
cameras	B
p	O
,	O
p	O
(	O
cid:2	O
)	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
are	O
all	O
afﬁne	B
(	O
deﬁnition	B
6.3	O
(	O
p166	O
)	O
)	O
,	O
then	O
the	O
corresponding	O
tensor	B
ta	O
is	O
the	O
afﬁne	B
trifocal	O
tensor	B
.	O
this	O
afﬁne	B
specialization	O
of	O
the	O
tensor	O
has	O
12	O
degrees	B
of	I
freedom	I
and	O
16	O
non-zero	O
entries	O
.	O
the	O
afﬁne	B
trifocal	O
tensor	B
was	O
ﬁrst	O
deﬁned	O
in	O
[	O
torr-95b	O
]	O
,	O
and	O
has	O
been	O
studied	O
in	O
[	O
kahl-98a	O
,	O
quan-97a	O
,	O
thorhallsson-99	O
]	O
.	O
it	O
shares	O
with	O
the	O
afﬁne	B
fundamental	I
matrix	I
(	O
chapter	O
14	O
)	O
very	O
stable	O
numerical	O
estimation	B
behaviour	O
.	O
it	O
has	O
been	O
shown	O
to	O
perform	O
very	O
well	O
in	O
tracking	O
applications	O
where	O
the	O
object	O
of	O
interest	O
(	O
for	O
example	O
a	O
car	O
)	O
has	O
small	O
relief	O
compared	O
to	O
the	O
depth	O
of	O
the	O
scene	O
[	O
hayman-03	O
,	O
tordoff-01	O
]	O
.	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
this	O
chapter	O
describes	O
numerical	O
methods	O
for	O
estimating	B
the	O
trifocal	B
tensor	I
given	O
a	O
set	O
of	O
point	O
and	O
line	B
correspondences	I
across	O
three	O
views	O
.	O
the	O
development	O
will	O
be	O
very	O
similar	O
to	O
that	O
for	O
the	O
fundamental	B
matrix	I
,	O
using	O
much	O
the	O
same	O
techniques	O
as	O
those	O
of	O
chapter	O
11.	O
in	O
particular	O
,	O
ﬁve	O
methods	O
will	O
be	O
discussed	O
:	O
(	O
i	O
)	O
a	O
linear	B
method	O
based	O
on	O
direct	O
solution	B
of	O
a	O
set	O
of	O
linear	O
equations	O
(	O
after	O
ap-	O
propriate	O
data	O
normalization	B
)	O
(	O
section	O
16.2	O
)	O
.	O
(	O
ii	O
)	O
an	O
iterative	B
method	O
,	O
that	O
minimizes	O
the	O
algebraic	B
error	I
,	O
while	O
satisfying	O
all	O
appropriate	O
constraints	B
on	O
the	O
tensor	B
(	O
section	O
16.3	O
)	O
.	O
(	O
iii	O
)	O
an	O
iterative	B
method	O
that	O
minimizes	O
geometric	B
error	I
(	O
the	O
“	O
gold	O
standard	O
”	O
method	O
)	O
(	O
section	O
16.4.1	O
)	O
.	O
(	O
iv	O
)	O
an	O
iterative	B
method	O
that	O
minimizes	O
the	O
sampson	O
approximation	O
to	O
geometric	O
error	B
(	O
section	O
16.4.3	O
)	O
.	O
(	O
v	O
)	O
robust	B
estimation	O
based	O
on	O
ransac	O
(	O
section	O
16.6	O
)	O
.	O
16.1	O
basic	O
equations	O
a	O
complete	O
set	O
of	O
the	O
(	O
tri-	O
)	O
linear	B
equations	I
involving	O
the	O
trifocal	B
tensor	I
is	O
given	O
in	O
table	O
16.1.	O
all	O
of	O
these	O
equations	O
are	O
linear	B
in	O
the	O
entries	O
of	O
the	O
trifocal	O
tensor	B
t	O
.	O
correspondence	B
three	O
points	O
two	O
points	O
,	O
one	O
line	B
one	O
point	B
,	O
two	O
lines	O
xix	O
(	O
cid:1	O
)	O
jx	O
xix	O
three	O
lines	B
lpl	O
(	O
cid:1	O
)	O
ql	O
i	O
=	O
0st	O
relation	B
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
kjqskrtt	O
qr	O
r	O
jqst	O
qr	O
(	O
cid:1	O
)	O
jl	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
rt	O
qr	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
xil	O
ql	O
r	O
piwt	O
qr	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
=	O
0	O
i	O
=	O
0w	O
i	O
=	O
0s	O
number	O
of	O
equations	O
4	O
2	O
1	O
2	O
table	O
16.1.	O
trilinear	B
relations	O
between	O
point	O
and	O
line	B
coordinates	I
in	O
three	O
views	O
.	O
the	O
ﬁnal	O
column	O
denotes	O
the	O
number	O
of	O
linearly	O
independent	O
equations	O
.	O
the	O
notation	O
0st	O
means	O
a	O
2-dimensional	O
tensor	B
with	O
all	O
zero	O
entries	O
.	O
thus	O
,	O
the	O
ﬁrst	O
line	B
in	O
this	O
table	O
corresponds	O
to	O
a	O
set	O
of	O
9	O
equations	O
,	O
one	O
for	O
each	O
choice	B
of	O
s	O
and	O
t.	O
however	O
,	O
among	O
this	O
set	O
of	O
9	O
equations	O
,	O
only	O
4	O
are	O
linearly	O
independent	O
.	O
391	O
392	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
given	O
several	O
point	B
or	O
line	B
correspondences	I
between	O
three	O
images	O
,	O
the	O
complete	O
set	O
of	O
equations	O
generated	O
is	O
of	O
the	O
form	O
at	O
=	O
0	O
,	O
where	O
t	O
is	O
the	O
27-vector	O
made	O
up	O
of	O
the	O
entries	O
of	O
the	O
trifocal	O
tensor	B
.	O
from	O
these	O
equations	O
,	O
one	O
may	O
solve	O
for	O
the	O
entries	O
of	O
the	O
tensor	O
.	O
note	O
that	O
equations	O
involving	O
points	O
may	O
be	O
combined	O
with	O
those	O
involving	O
lines	B
–	O
in	O
general	O
all	O
available	O
equations	O
from	O
table	O
16.1	O
may	O
be	O
used	O
simultaneously	O
.	O
since	O
t	O
has	O
27	O
entries	O
,	O
26	O
equations	O
are	O
needed	O
to	O
solve	O
for	O
t	O
up	O
to	O
scale	O
.	O
with	O
more	O
than	O
26	O
equations	O
,	O
a	O
least-squares	B
solution	I
is	O
computed	O
.	O
as	O
with	O
the	O
fundamental	O
ma-	O
trix	O
,	O
one	O
minimizes	O
(	O
cid:10	O
)	O
at	O
(	O
cid:10	O
)	O
subject	O
to	O
the	O
constraint	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
1	O
using	O
algorithm	O
a5.4	O
(	O
p593	O
)	O
.	O
this	O
gives	O
a	O
bare	O
outline	O
of	O
a	O
linear	O
algorithm	B
for	O
computing	B
the	O
trifocal	B
tensor	I
.	O
however	O
,	O
in	O
order	O
to	O
build	O
a	O
practical	O
algorithm	B
out	O
of	O
this	O
several	O
issues	O
,	O
such	O
as	O
normalization	O
,	O
need	O
to	O
be	O
addressed	O
.	O
in	O
particular	O
the	O
tensor	B
that	O
is	O
estimated	O
must	O
obey	O
various	O
constraints	B
,	O
and	O
we	O
consider	O
these	O
next	O
.	O
16.1.1	O
the	O
internal	B
constraints	O
the	O
most	O
notable	O
difference	O
between	O
the	O
fundamental	B
matrix	I
and	O
the	O
trifocal	B
tensor	I
is	O
the	O
greater	O
number	O
of	O
constraints	O
that	O
apply	O
to	O
the	O
trifocal	B
tensor	I
.	O
the	O
fundamental	B
matrix	I
has	O
a	O
single	O
constraint	O
,	O
namely	O
det	O
(	O
f	O
)	O
=	O
0	O
,	O
leaving	O
7	O
degrees	B
of	I
freedom	I
,	O
dis-	O
counting	O
the	O
arbitrary	O
scale	O
factor	O
.	O
the	O
trifocal	B
tensor	I
,	O
on	O
the	O
other	O
hand	O
,	O
has	O
27	O
entries	O
,	O
but	O
18	O
parameters	B
only	O
are	O
required	O
to	O
specify	O
the	O
equivalent	B
camera	O
conﬁguration	O
,	O
up	O
to	O
projectivity	O
.	O
the	O
elements	O
of	O
the	O
tensor	O
therefore	O
satisfy	O
8	O
independent	O
algebraic	B
constraints	O
.	O
this	O
condition	O
is	O
conveniently	O
stated	O
as	O
follows	O
.	O
deﬁnition	B
16.1.	O
a	O
trifocal	B
tensor	I
t	O
jk	O
internal	B
constraints	O
”	O
if	O
there	O
exist	O
three	O
camera	B
matrices	I
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
t	O
jk	O
corresponds	O
to	O
the	O
three	O
camera	B
matrices	I
according	O
to	O
(	O
15.9–p376	O
)	O
.	O
is	O
said	O
to	O
be	O
“	O
geometrically	B
valid	I
”	O
or	O
“	O
satisfy	O
all	O
such	O
that	O
i	O
i	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
just	O
as	O
with	O
the	O
fundamental	B
matrix	I
it	O
is	O
important	O
to	O
enforce	O
these	O
constraints	B
in	O
some	O
way	O
so	O
as	O
to	O
arrive	O
at	O
a	O
geometrically	B
valid	I
trifocal	O
tensor	B
.	O
if	O
the	O
tensor	B
does	O
not	O
satisfy	O
the	O
constraints	B
,	O
there	O
are	O
consequences	O
similar	O
to	O
a	O
fundamental	B
matrix	I
which	O
is	O
not	O
of	O
rank	O
2	O
–	O
where	O
epipolar	B
lines	I
,	O
computed	O
as	O
fx	O
for	O
varying	O
x	O
,	O
do	O
not	O
intersect	O
in	O
a	O
single	O
point	O
(	O
see	O
ﬁgure	O
11.1	O
(	O
p280	O
)	O
)	O
.	O
for	O
example	O
,	O
if	O
the	O
tensor	B
does	O
not	O
satisfy	O
the	O
internal	B
constraints	O
and	O
is	O
used	O
to	O
transfer	O
a	O
point	B
to	O
a	O
third	O
view	O
,	O
given	O
a	O
correspon-	O
dence	O
over	O
two	B
views	I
as	O
described	O
in	O
section	O
15.3	O
,	O
then	O
the	O
position	O
of	O
the	O
transferred	O
point	B
will	O
vary	O
depending	O
on	O
which	O
set	O
of	O
equations	O
from	O
table	O
16.1	O
is	O
used	O
.	O
in	O
the	O
following	O
the	O
objective	O
is	O
always	O
to	O
estimate	O
a	O
geometrically	B
valid	I
tensor	O
.	O
the	O
constraints	B
satisﬁed	O
by	O
the	O
trifocal	B
tensor	I
elements	O
are	O
not	O
so	O
simply	O
expressed	O
(	O
as	O
det	O
=	O
0	O
)	O
,	O
and	O
some	O
have	O
thought	O
this	O
an	O
impediment	O
to	O
accurate	O
computation	B
of	I
the	O
trifocal	B
tensor	I
.	O
however	O
,	O
in	O
reality	O
,	O
in	O
order	O
to	O
work	O
with	O
or	O
compute	O
the	O
trifocal	B
tensor	I
it	O
is	O
not	O
necessary	O
to	O
express	O
these	O
constraints	B
explicitly	O
–	O
rather	O
they	O
are	O
im-	O
plicitly	O
enforced	O
by	O
an	O
appropriate	O
parametrization	B
of	I
the	O
trifocal	B
tensor	I
,	O
and	O
rarely	O
cause	O
any	O
trouble	O
.	O
we	O
will	O
return	O
to	O
the	O
issue	O
of	O
parametrization	O
in	O
section	O
16.3	O
and	O
section	O
16.4.2	O
.	O
16.2	O
the	O
normalized	O
linear	O
algorithm	B
393	O
16.1.2	O
the	O
minimum	O
case	O
–	O
6	O
point	B
correspondences	O
a	O
geometrically	B
valid	I
trifocal	O
tensor	B
may	O
be	O
computed	O
from	O
images	O
of	O
a	O
6	O
point	B
con-	O
ﬁguration	O
,	O
provided	O
the	O
scene	O
points	O
are	O
in	O
general	O
position	O
.	O
there	O
are	O
one	O
or	O
three	O
real	O
solutions	O
.	O
the	O
tensor	B
is	O
computed	O
from	O
the	O
three	O
camera	B
matrices	I
which	O
are	O
obtained	O
using	O
algorithm	O
20.1	O
(	O
p511	O
)	O
,	O
as	O
described	O
in	O
section	O
20.2.4	O
(	O
p510	O
)	O
.	O
this	O
minimal	O
six	O
point	B
solution	O
is	O
used	O
in	O
the	O
robust	B
algorithm	O
of	O
section	O
16.6	O
.	O
16.2	O
the	O
normalized	O
linear	O
algorithm	B
in	O
forming	O
the	O
matrix	B
equation	O
at	O
=	O
0	O
from	O
the	O
equations	O
on	O
t	O
in	O
table	O
16.1	O
it	O
is	O
not	O
necessary	O
to	O
use	O
the	O
complete	O
set	O
of	O
equations	O
derived	O
from	O
each	O
correspondence	B
,	O
since	O
not	O
all	O
of	O
these	O
equations	O
are	O
linearly	O
independent	O
.	O
for	O
instance	O
in	O
the	O
case	O
of	O
a	O
point–point–point	O
correspondence	B
(	O
ﬁrst	O
row	O
of	O
table	O
16.1	O
)	O
all	O
choices	O
of	O
s	O
and	O
t	O
lead	O
to	O
a	O
set	O
of	O
9	O
equations	O
,	O
but	O
only	O
4	O
of	O
these	O
equations	O
are	O
linearly	O
independent	O
,	O
and	O
these	O
may	O
be	O
obtained	O
by	O
choosing	O
two	O
values	O
for	O
each	O
of	O
s	O
and	O
t	O
,	O
for	O
instance	O
1	O
and	O
2.	O
this	O
point	B
is	O
discussed	O
in	O
more	O
detail	O
in	O
section	O
17.7	O
(	O
p431	O
)	O
.	O
the	O
reader	O
may	O
verify	O
that	O
the	O
three	O
points	O
equation	O
obtained	O
from	O
table	O
16.1	O
for	O
a	O
given	O
choice	B
of	O
s	O
and	O
t	O
may	O
be	O
expanded	O
as	O
(	O
cid:2	O
)	O
ix	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
mt	O
jl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
mt	O
il	O
−	O
x	O
−	O
x	O
(	O
cid:2	O
)	O
jx	O
(	O
cid:2	O
)	O
ix	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
lt	O
jm	O
k	O
k	O
xk	O
(	O
x	O
k	O
+	O
x	O
(	O
16.1	O
)	O
when	O
i	O
,	O
j	O
(	O
cid:5	O
)	O
=	O
s	O
and	O
l	O
,	O
m	O
(	O
cid:5	O
)	O
=	O
t.	O
equation	O
(	O
16.1	O
)	O
collapses	O
for	O
i	O
=	O
j	O
or	O
l	O
=	O
m	O
,	O
and	O
swapping	O
i	O
and	O
j	O
(	O
or	O
l	O
and	O
m	O
)	O
simply	O
changes	O
the	O
sign	O
of	O
the	O
equation	O
.	O
one	O
choice	B
of	O
the	O
four	O
independent	O
equations	O
is	O
obtained	O
by	O
setting	O
j	O
=	O
m	O
=	O
3	O
,	O
and	O
letting	O
i	O
and	O
l	O
range	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
3	O
may	O
be	O
set	O
to	O
1	O
to	O
obtain	O
a	O
relationship	O
between	O
freely	O
.	O
the	O
coordinates	B
x3	O
,	O
x	O
the	O
observed	O
image	O
coordinates	O
.	O
equation	O
(	O
16.1	O
)	O
then	O
becomes	O
k	O
)	O
=	O
0ijlm	O
.	O
(	O
cid:2	O
)	O
3	O
and	O
x	O
(	O
cid:2	O
)	O
jx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
lt	O
im	O
xk	O
(	O
x	O
(	O
cid:2	O
)	O
ix	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
lt	O
33	O
k	O
−	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
lt	O
i3	O
k	O
−	O
x	O
(	O
cid:2	O
)	O
it	O
3l	O
k	O
+	O
t	O
il	O
k	O
)	O
=	O
0	O
.	O
(	O
16.2	O
)	O
the	O
four	O
different	O
choices	O
of	O
i	O
,	O
l	O
=	O
1	O
,	O
2	O
give	O
four	O
different	O
equations	O
in	O
terms	O
of	O
the	O
observed	O
image	O
coordinates	O
.	O
how	O
to	O
represent	O
lines	B
the	O
three	O
lines	B
correspondence	O
equation	O
of	O
table	O
16.1	O
may	O
be	O
written	O
in	O
the	O
form	O
li	O
=	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
t	O
jk	O
i	O
,	O
where	O
,	O
as	O
usual	O
with	O
homogeneous	O
entities	O
,	O
the	O
equality	O
is	O
up	O
to	O
scale	O
.	O
in	O
the	O
presence	O
of	O
noise	O
,	O
this	O
relationship	O
will	O
only	O
be	O
approximately	O
satisﬁed	O
by	O
the	O
measured	O
lines	B
l	O
,	O
l	O
(	O
cid:2	O
)	O
that	O
are	O
close	O
to	O
the	O
measured	O
lines	B
.	O
(	O
cid:2	O
)	O
,	O
but	O
will	O
be	O
satisﬁed	O
exactly	O
for	O
three	O
lines	O
ˆl	O
,	O
ˆl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
ˆl	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
question	O
is	O
whether	O
two	O
sets	O
of	O
homogeneous	O
coordinates	O
that	O
differ	O
by	O
a	O
small	O
amount	O
represent	O
lines	B
that	O
are	O
close	O
to	O
each	O
other	O
in	O
some	O
geometric	B
sense	O
.	O
consider	O
the	O
two	O
vectors	O
l1	O
=	O
(	O
0.01	O
,	O
0	O
,	O
1	O
)	O
t	O
and	O
l2	O
=	O
(	O
0	O
,	O
0.01	O
,	O
1	O
)	O
t.	O
clearly	O
as	O
vectors	O
they	O
are	O
not	O
very	O
different	O
,	O
and	O
in	O
fact	O
(	O
cid:10	O
)	O
l1	O
−	O
l2	O
(	O
cid:10	O
)	O
is	O
small	O
.	O
on	O
the	O
other	O
hand	O
,	O
l1	O
represents	O
the	O
line	B
x	O
=	O
100	O
,	O
and	O
l2	O
represents	O
the	O
line	B
y	O
=	O
100.	O
thus	O
in	O
a	O
geometric	B
sense	O
,	O
these	O
lines	B
are	O
totally	O
different	O
.	O
note	O
that	O
this	O
problem	O
is	O
alleviated	O
by	O
scaling	B
.	O
if	O
coordinates	B
are	O
394	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
objective	O
given	O
n	O
≥	O
7	O
image	O
point	O
correspondences	B
across	O
3	O
images	O
,	O
or	O
at	O
least	O
13	O
line	B
correspondences	I
,	O
or	O
a	O
mixture	O
of	O
point	O
and	O
line	B
correspondences	I
,	O
compute	O
the	O
trifocal	B
tensor	I
.	O
algorithm	B
and	O
h	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
to	O
apply	O
to	O
the	O
three	O
images	O
.	O
i	O
lj	O
.	O
points	O
and	O
lines	B
in	O
the	O
second	O
and	O
third	O
image	O
transform	O
in	O
the	O
same	O
way	O
.	O
(	O
i	O
)	O
find	O
transformation	B
matrices	O
h	O
,	O
h	O
(	O
cid:1	O
)	O
jxj	O
,	O
and	O
lines	B
according	O
to	O
li	O
(	O
cid:6	O
)	O
→	O
ˆli	O
=	O
(	O
ii	O
)	O
transform	O
points	O
according	O
to	O
xi	O
(	O
cid:6	O
)	O
→	O
ˆxi	O
=	O
hi	O
(	O
iii	O
)	O
compute	O
the	O
trifocal	B
tensor	I
ˆt	O
linearly	O
in	O
terms	O
of	O
the	O
transformed	O
points	O
and	O
lines	B
using	O
the	O
equations	O
in	O
table	O
16.1	O
by	O
solving	B
a	O
set	O
of	O
equation	O
of	O
the	O
form	O
at	O
=	O
0	O
,	O
using	O
algorithm	O
a5.4	O
(	O
p593	O
)	O
.	O
t	O
ˆt	O
st	O
i	O
(	O
h	O
(	O
cid:1	O
)	O
−1	O
)	O
j	O
hr	O
r	O
.	O
(	O
iv	O
)	O
compute	O
the	O
trifocal	B
tensor	I
corresponding	O
to	O
the	O
original	O
data	O
according	O
to	O
t	O
jk	O
(	O
h−1	O
)	O
j	O
s	O
(	O
h	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
−1	O
)	O
k	O
i	O
=	O
algorithm	B
16.1.	O
the	O
normalized	O
linear	O
algorithm	B
for	O
computation	B
of	I
t	O
.	O
scaled	O
by	O
a	O
factor	O
of	O
0.01	O
,	O
then	O
the	O
coordinates	B
for	O
the	O
lines	B
become	O
l1	O
=	O
(	O
1	O
,	O
0	O
,	O
1	O
)	O
t	O
and	O
l2	O
=	O
(	O
0	O
,	O
1	O
,	O
1	O
)	O
t	O
,	O
which	O
are	O
quite	O
different	O
.	O
nevertheless	O
,	O
this	O
observation	O
indicates	O
that	O
care	O
is	O
needed	O
when	O
representing	O
lines	B
.	O
suppose	O
one	O
is	O
given	O
a	O
correspondence	B
between	O
three	O
lines	B
l	O
,	O
l	O
(	O
cid:2	O
)	O
.	O
two	O
points	O
x1	O
and	O
x2	O
lying	O
on	O
l	O
are	O
selected	O
.	O
each	O
of	O
these	O
points	O
provides	O
a	O
correspondence	B
xs	O
↔	O
l	O
(	O
cid:2	O
)	O
↔	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
for	O
s	O
=	O
1	O
,	O
2	O
,	O
between	O
the	O
three	O
views	O
,	O
in	O
the	O
sense	O
that	O
there	O
exists	O
a	O
3d	O
line	B
that	O
maps	O
to	O
l	O
(	O
cid:2	O
)	O
in	O
the	O
second	O
and	O
third	O
images	O
and	O
to	O
a	O
line	B
(	O
namely	O
l	O
)	O
t	O
jk	O
passing	O
through	O
xs	O
in	O
the	O
ﬁrst	O
image	O
.	O
two	O
equations	O
of	O
the	O
form	O
xi	O
i	O
=	O
0s	O
for	O
sl	O
s	O
=	O
1	O
,	O
2	O
result	O
from	O
these	O
correspondences	B
.	O
in	O
this	O
way	O
one	O
avoids	O
the	O
use	O
of	O
lines	B
in	O
the	O
ﬁrst	O
image	O
,	O
though	O
not	O
the	O
other	O
images	O
.	O
often	O
lines	B
in	O
images	O
are	O
deﬁned	O
naturally	O
by	O
a	O
pair	O
of	B
points	I
,	O
possibly	O
the	O
two	O
endpoints	O
of	O
the	O
lines	O
.	O
even	O
lines	B
that	O
are	O
deﬁned	O
as	O
the	O
best	O
ﬁt	O
to	O
a	O
set	O
of	O
edge	O
points	O
in	O
an	O
image	O
may	O
be	O
treated	O
as	O
if	O
they	O
were	O
deﬁned	O
by	O
just	O
two	O
points	O
,	O
as	O
will	O
be	O
described	O
in	O
section	O
16.7.2.	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jl	O
k	O
normalization	B
as	O
in	O
all	O
algorithms	O
of	O
this	O
type	O
,	O
it	O
is	O
necessary	O
to	O
carry	O
out	O
prenormalization	O
of	O
the	O
input	O
data	O
before	O
forming	O
and	O
solving	B
the	O
linear	B
equation	O
system	O
.	O
subsequently	O
,	O
it	O
is	O
necessary	O
to	O
correct	O
for	O
this	O
normalization	B
to	O
ﬁnd	O
the	O
trifocal	B
tensor	I
for	O
the	O
original	O
data	O
.	O
the	O
recommended	O
normalization	O
is	O
much	O
the	O
same	O
as	O
that	O
given	O
for	O
the	O
compu-	O
tation	O
of	O
the	O
fundamental	O
matrix	B
.	O
a	O
translation	O
is	O
applied	O
to	O
each	O
image	O
such	O
that	O
the	O
√	O
centroid	O
of	O
the	O
points	O
is	O
at	O
the	O
origin	O
,	O
and	O
then	O
a	O
scaling	B
is	O
applied	O
so	O
that	O
the	O
average	O
(	O
rms	O
)	O
distance	B
of	O
the	O
points	O
from	O
the	O
origin	O
is	O
2.	O
in	O
the	O
case	O
of	B
lines	I
,	O
the	O
transforma-	O
tion	O
should	O
be	O
deﬁned	O
by	O
considering	O
each	O
line	B
’	O
s	O
two	O
endpoints	O
(	O
or	O
some	O
representative	O
line	B
points	O
visible	O
in	O
the	O
image	O
)	O
.	O
the	O
transformation	B
rule	I
for	O
the	O
trifocal	B
tensor	I
under	O
these	O
normalizing	O
transformations	O
is	O
given	O
in	O
section	O
a1.2	O
(	O
p563	O
)	O
.	O
the	O
normalized	O
linear	O
algorithm	B
for	O
computing	B
t	O
is	O
summarized	O
in	O
algorithm	O
16.1.	O
this	O
algorithm	B
does	O
not	O
consider	O
the	O
constraints	B
discussed	O
in	O
section	O
16.1.1	O
that	O
should	O
be	O
applied	O
to	O
t	O
.	O
these	O
constraints	B
ought	O
to	O
be	O
enforced	O
before	O
the	O
denormal-	O
16.3	O
the	O
algebraic	B
minimization	I
algorithm	O
395	O
ization	O
step	O
(	O
ﬁnal	O
step	O
)	O
in	O
the	O
above	O
algorithm	B
.	O
methods	O
of	O
enforcing	O
these	O
constraints	B
will	O
be	O
considered	O
next	O
.	O
16.3	O
the	O
algebraic	B
minimization	I
algorithm	O
the	O
linear	B
algorithm	I
16.1	O
will	O
give	O
a	O
tensor	B
not	O
necessarily	O
corresponding	O
to	O
any	O
ge-	O
ometric	O
conﬁguration	O
,	O
as	O
discussed	O
in	O
section	O
16.1.1.	O
the	O
next	O
task	O
is	O
to	O
correct	O
the	O
tensor	B
to	O
satisfy	O
all	O
required	O
constraints	B
.	O
our	O
task	O
will	O
be	O
to	O
compute	O
a	O
geometrically	B
valid	I
trifocal	O
tensor	B
t	O
jk	O
from	O
a	O
set	O
of	O
image	O
correspondences	B
.	O
the	O
tensor	B
computed	O
will	O
minimize	O
the	O
algebraic	B
error	I
asso-	O
ciated	O
with	O
the	O
input	O
data	O
.	O
that	O
is	O
,	O
we	O
minimize	O
(	O
cid:10	O
)	O
aˆt	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
ˆt	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
where	O
ˆt	O
is	O
the	O
vector	O
of	O
entries	O
of	O
a	O
geometrically	O
valid	O
trifocal	B
tensor	I
.	O
the	O
algorithm	B
is	O
quite	O
similar	O
to	O
the	O
algebraic	B
algorithm	O
(	O
section	O
11.3	O
(	O
p282	O
)	O
)	O
for	O
computation	O
of	O
the	O
funda-	O
mental	O
matrix	B
.	O
just	O
as	O
with	O
the	O
fundamental	B
matrix	I
,	O
the	O
ﬁrst	O
step	O
is	O
the	O
computation	B
of	I
the	O
epipoles	B
.	O
i	O
retrieving	O
the	O
epipoles	O
let	O
e	O
(	O
cid:2	O
)	O
and	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
be	O
the	O
epipoles	B
in	O
the	O
second	O
and	O
third	O
images	O
corresponding	O
to	O
(	O
that	O
is	O
being	O
images	O
of	O
)	O
the	O
ﬁrst	O
camera	B
centre	I
.	O
recall	O
from	O
result	O
15.4	O
(	O
p373	O
)	O
that	O
the	O
two	O
epipoles	O
e	O
(	O
cid:2	O
)	O
and	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
are	O
the	O
common	O
perpendicular	O
to	O
the	O
left	O
(	O
respectively	O
right	O
)	O
null-vectors	O
of	O
the	O
three	O
ti	O
.	O
in	O
principle	O
then	O
,	O
the	O
epipoles	B
may	O
be	O
computed	O
from	O
the	O
trifocal	B
tensor	I
using	O
the	O
algorithm	B
outlined	O
in	O
algorithm	O
15.1	O
(	O
p375	O
)	O
.	O
however	O
,	O
in	O
the	O
presence	O
of	O
noise	O
,	O
this	O
translates	O
easily	O
into	O
an	O
algorithm	B
for	O
computing	B
the	O
epipoles	B
based	O
on	O
four	O
applications	O
of	O
algorithm	O
a5.4	O
(	O
p593	O
)	O
.	O
(	O
i	O
)	O
for	O
each	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
ﬁnd	O
the	O
unit	O
vector	O
vi	O
that	O
minimizes	O
(	O
cid:10	O
)	O
tivi	O
(	O
cid:10	O
)	O
,	O
where	O
(	O
ii	O
)	O
compute	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
as	O
the	O
unit	O
vector	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ve	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
.	O
i	O
.	O
form	O
the	O
matrix	B
v	O
,	O
the	O
i-th	O
row	O
of	O
which	O
is	O
vt	O
i	O
.	O
ti	O
=	O
t	O
··	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
is	O
computed	O
similarly	O
,	O
using	O
tt	O
i	O
instead	O
of	O
ti	O
.	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
4	O
and	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
=	O
bk	O
algebraic	B
minimization	I
having	O
computed	O
the	O
epipoles	B
the	O
next	O
step	O
is	O
to	O
determine	O
the	O
remaining	O
elements	O
of	O
the	O
camera	O
matrices	O
p	O
(	O
cid:2	O
)	O
from	O
which	O
the	O
trifocal	B
tensor	I
can	O
be	O
calculated	O
.	O
this	O
step	O
is	O
linear	B
.	O
from	O
the	O
form	O
(	O
15.9–p376	O
)	O
of	O
the	O
trifocal	O
tensor	B
,	O
it	O
may	O
be	O
seen	O
that	O
once	O
the	O
epipoles	B
e	O
(	O
cid:2	O
)	O
j	O
=	O
aj	O
4	O
are	O
known	O
,	O
the	O
trifocal	B
tensor	I
may	O
be	O
expressed	O
linearly	O
in	O
terms	O
of	O
the	O
remaining	O
entries	O
of	O
the	O
matrices	O
aj	O
i	O
.	O
this	O
relationship	O
may	O
be	O
written	O
linearly	O
as	O
t	O
=	O
ea	O
where	O
a	O
is	O
the	O
vector	O
of	O
the	O
remaining	O
entries	O
ai	O
j	O
,	O
t	O
is	O
the	O
vector	O
of	O
entries	O
of	O
the	O
trifocal	O
tensor	B
,	O
and	O
e	O
is	O
the	O
linear	B
relationship	O
expressed	O
by	O
(	O
15.9–p376	O
)	O
.	O
we	O
wish	O
to	O
minimize	O
the	O
algebraic	B
error	I
(	O
cid:10	O
)	O
at	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
aea	O
(	O
cid:10	O
)	O
over	O
all	O
choices	O
of	O
a	O
constrained	O
such	O
that	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
that	O
is	O
(	O
cid:10	O
)	O
ea	O
(	O
cid:10	O
)	O
=	O
1.	O
this	O
minimization	B
problem	O
is	O
solved	O
by	O
algorithm	B
a5.6	O
(	O
p595	O
)	O
.	O
the	O
solution	B
t	O
=	O
ea	O
represents	O
a	O
trifocal	B
tensor	I
sat-	O
isfying	O
all	O
constraints	B
,	O
and	O
minimizing	O
the	O
algebraic	O
error	B
,	O
subject	O
to	O
the	O
given	O
choice	B
of	O
epipoles	B
.	O
i	O
and	O
bk	O
j	O
and	O
bi	O
396	O
objective	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
given	O
a	O
set	O
of	O
point	O
and	O
line	B
correspondences	I
in	O
three	O
views	O
,	O
compute	O
the	O
trifocal	B
tensor	I
.	O
algorithm	B
i	O
and	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
i	O
(	O
i	O
)	O
from	O
the	O
set	O
of	O
point	O
and	O
line	B
correspondences	I
compute	O
the	O
set	O
of	O
equations	O
of	O
the	O
form	O
at	O
=	O
0	O
,	O
from	O
the	O
relations	O
given	O
in	O
table	O
16.1.	O
trifocal	B
tensor	I
t	O
jk	O
.	O
from	O
t	O
jk	O
,	O
a	O
is	O
the	O
vector	O
representing	O
entries	O
of	O
a	O
(	O
ii	O
)	O
solve	O
these	O
equations	O
using	O
algorithm	O
a5.4	O
(	O
p593	O
)	O
to	O
ﬁnd	O
an	O
initial	O
estimate	O
of	O
the	O
(	O
iii	O
)	O
find	O
the	O
two	O
epipoles	O
e	O
(	O
cid:1	O
)	O
as	O
the	O
common	O
perpendicular	O
to	O
the	O
left	O
(	O
respectively	O
right	O
)	O
null-vectors	O
of	O
the	O
three	O
ti	O
.	O
(	O
iv	O
)	O
construct	O
the	O
27	O
×	O
18	O
matrix	B
e	O
such	O
that	O
t	O
=	O
ea	O
where	O
t	O
is	O
the	O
vector	O
of	O
entries	O
of	O
t	O
jk	O
i	O
,	O
and	O
where	O
e	O
expresses	O
the	O
linear	B
relationship	O
t	O
jk	O
(	O
v	O
)	O
solve	O
the	O
minimization	B
problem	O
:	O
minimize	O
(	O
cid:10	O
)	O
aea	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
ea	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
using	O
algorithm	O
a5.6	O
(	O
p595	O
)	O
.	O
compute	O
the	O
error	B
vector	O
	O
=	O
aea	O
.	O
,	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
)	O
(	O
cid:6	O
)	O
→	O
	O
is	O
a	O
mapping	O
from	O
ir6	O
to	O
ir27	O
.	O
iterate	O
on	O
the	O
(	O
vi	O
)	O
iteration	B
:	O
the	O
mapping	O
(	O
e	O
(	O
cid:1	O
)	O
last	O
two	O
steps	O
with	O
varying	O
e	O
(	O
cid:1	O
)	O
and	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
using	O
the	O
levenberg–marquardt	O
algorithm	B
to	O
ﬁnd	O
the	O
optimal	O
e	O
(	O
cid:1	O
)	O
.	O
hence	O
ﬁnd	O
the	O
optimal	O
t	O
=	O
ea	O
containing	O
the	O
entries	O
of	O
t	O
jk	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
k	O
−	O
e	O
(	O
cid:1	O
)	O
jbk	O
i	O
.	O
i	O
=	O
a	O
j	O
i	O
e	O
j	O
i	O
and	O
bk	O
,	O
e	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
.	O
i	O
algorithm	B
16.2.	O
computing	B
the	O
trifocal	B
tensor	I
minimizing	O
algebraic	B
error	I
.	O
the	O
computation	B
should	O
be	O
carried	O
out	O
on	O
data	O
normalized	O
in	O
the	O
manner	O
of	O
algorithm	O
16.1.	O
normalization	B
and	O
denormalization	O
steps	O
are	O
omitted	O
here	O
for	O
simplicity	O
.	O
this	O
algorithm	B
ﬁnds	O
the	O
geometrically	B
valid	I
trifocal	O
tensor	B
that	O
minimizes	O
algebraic	B
error	I
.	O
at	O
the	O
cost	O
of	O
a	O
slightly	O
inferior	O
solution	B
,	O
the	O
last	O
iteration	B
step	O
may	O
be	O
omitted	O
,	O
providing	O
a	O
fast	O
non-iterative	O
algorithm	B
.	O
iterative	B
method	O
the	O
two	O
epipoles	O
used	O
to	O
compute	O
a	O
geometrically	B
valid	I
tensor	O
t	O
jk	O
are	O
determined	O
using	O
the	O
estimate	O
of	O
t	O
jk	O
obtained	O
from	O
the	O
linear	B
algorithm	I
.	O
analogous	O
to	O
the	O
case	O
)	O
(	O
cid:6	O
)	O
→	O
aea	O
is	O
a	O
mapping	O
ir6	O
→	O
ir27	O
.	O
of	O
the	O
fundamental	O
matrix	B
,	O
the	O
mapping	O
(	O
e	O
(	O
cid:2	O
)	O
an	O
application	O
of	O
the	O
levenberg–marquardt	O
algorithm	B
to	O
optimize	O
the	O
choice	B
of	O
the	O
epipoles	B
will	O
result	O
in	O
an	O
optimal	O
(	O
in	O
terms	O
of	O
algebraic	O
error	B
)	O
estimate	O
of	O
the	O
trifocal	O
tensor	B
.	O
note	O
that	O
the	O
iteration	B
problem	O
is	O
of	O
modest	O
size	O
,	O
since	O
only	O
6	O
parameters	B
,	O
the	O
homogeneous	O
coordinates	O
of	O
the	O
epipoles	O
,	O
are	O
involved	O
in	O
the	O
iteration	B
problem	O
.	O
,	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
i	O
this	O
contrasts	O
with	O
an	O
iterative	B
estimation	I
of	O
the	O
optimal	O
trifocal	B
tensor	I
in	O
terms	O
of	O
geometric	O
error	B
,	O
considered	O
later	O
.	O
this	O
latter	O
problem	O
requires	O
estimating	B
the	O
param-	O
eters	O
of	O
the	O
three	O
cameras	B
,	O
plus	O
the	O
coordinates	B
of	O
all	O
the	O
points	O
,	O
a	O
large	O
estimation	B
problem	I
.	O
the	O
complete	O
algebraic	B
method	O
for	O
estimating	O
the	O
trifocal	B
tensor	I
is	O
summarized	O
in	O
algorithm	O
16.2	O
.	O
16.4	O
geometric	B
distance	I
16.4.1	O
the	O
gold	O
standard	O
method	O
for	O
the	O
trifocal	B
tensor	I
as	O
with	O
the	O
computation	B
of	I
the	O
fundamental	B
matrix	I
,	O
best	O
results	O
may	O
be	O
expected	O
from	O
the	O
maximum	O
likelihood	O
(	O
or	O
“	O
gold	O
standard	O
”	O
)	O
solution	B
.	O
since	O
this	O
has	O
been	O
adequately	O
described	O
for	O
the	O
case	O
of	O
the	O
fundamental	O
matrix	B
computation	O
,	O
little	O
needs	O
to	O
be	O
added	O
for	O
the	O
three-view	O
case	O
.	O
16.4	O
geometric	B
distance	I
397	O
objective	O
given	O
n	O
≥	O
7	O
image	O
point	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
likelihood	O
estimate	O
of	O
the	O
trifocal	O
tensor	B
.	O
the	O
mle	O
involves	O
also	O
solving	O
for	O
a	O
set	O
of	O
subsidiary	O
point	B
correspondences	O
{	O
ˆxi	O
↔	O
ˆx	O
(	O
cid:1	O
)	O
which	O
exactly	O
satisfy	O
the	O
trilinear	B
relations	O
of	O
the	O
estimated	O
tensor	B
and	O
which	O
minimize	O
i	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
}	O
,	O
determine	O
the	O
maximum	O
i	O
↔	O
ˆx	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
}	O
,	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
)	O
2	O
(	O
cid:7	O
)	O
i	O
algorithm	B
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
algorithm	B
16.2.	O
and	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
i	O
)	O
compute	O
an	O
initial	O
geometrically	O
valid	O
estimate	O
of	O
t	O
using	O
a	O
linear	B
algorithm	I
such	O
as	O
(	O
ii	O
)	O
compute	O
an	O
initial	O
estimate	O
of	O
the	O
subsidiary	O
variables	O
{	O
ˆxi	O
,	O
ˆx	O
(	O
cid:1	O
)	O
i	O
}	O
as	O
follows	O
:	O
i	O
=	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:23	O
)	O
xi	O
.	O
from	O
t	O
.	O
i	O
and	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:1	O
)	O
i	O
=	O
p	O
(	O
cid:1	O
)	O
(	O
cid:23	O
)	O
xi	O
,	O
ˆx	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
a	O
)	O
retrieve	O
the	O
camera	B
matrices	I
p	O
(	O
cid:1	O
)	O
(	O
b	O
)	O
from	O
the	O
correspondence	B
xi	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
c	O
)	O
the	O
correspondence	B
consistent	O
with	O
t	O
is	O
obtained	O
as	O
estimate	O
of	O
(	O
cid:23	O
)	O
xi	O
using	O
the	O
triangulation	B
method	O
of	O
chapter	O
12	O
.	O
ˆxi	O
=	O
p	O
(	O
cid:23	O
)	O
xi	O
,	O
ˆx	O
(	O
cid:1	O
)	O
(	O
iii	O
)	O
minimize	O
the	O
cost	O
(	O
cid:7	O
)	O
over	O
t	O
and	O
(	O
cid:23	O
)	O
xi	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n.	O
the	O
cost	O
is	O
minimized	O
using	O
the	O
levenberg–marquardt	O
algorithm	B
over	O
3n	O
+	O
24	O
variables	O
:	O
3n	O
for	O
the	O
n	O
3d	O
points	O
(	O
cid:23	O
)	O
xi	O
,	O
and	O
24	O
for	O
the	O
elements	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
i	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
determine	O
an	O
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
)	O
2	O
i	O
,	O
ˆx	O
(	O
cid:1	O
)	O
,	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
of	O
the	O
camera	O
matrices	O
p	O
(	O
cid:1	O
)	O
,	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
.	O
algorithm	B
16.3.	O
the	O
gold	O
standard	O
algorithm	B
for	O
estimating	B
t	O
from	O
image	O
correspondences	B
.	O
given	O
a	O
set	O
of	O
point	O
correspondences	B
{	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
function	O
to	O
be	O
minimized	O
is	O
(	O
cid:7	O
)	O
i	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
}	O
in	O
three	O
views	O
,	O
the	O
cost	O
d	O
(	O
xi	O
,	O
ˆxi	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
+	O
d	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
(	O
16.3	O
)	O
i	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
where	O
the	O
points	O
ˆxi	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
satisfy	O
a	O
trifocal	B
constraint	O
(	O
as	O
in	O
table	O
16.1	O
)	O
exactly	O
for	O
the	O
estimated	O
trifocal	B
tensor	I
.	O
as	O
in	O
the	O
case	O
of	O
the	O
fundamental	O
matrix	B
one	O
needs	O
to	O
introduce	O
further	O
variables	O
corresponding	O
to	O
3d	O
points	O
xi	O
and	O
parametrize	O
the	O
trifocal	B
tensor	I
by	O
the	O
entries	O
of	O
the	O
matrices	O
p	O
(	O
cid:2	O
)	O
(	O
see	O
below	O
)	O
.	O
the	O
cost	B
function	I
is	O
then	O
minimized	O
over	O
the	O
position	O
of	O
the	O
3d	O
points	O
xi	O
and	O
the	O
two	O
camera	O
matrices	O
p	O
(	O
cid:2	O
)	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
=	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
xi	O
.	O
essentially	O
one	O
is	O
carrying	O
out	O
bundle	B
adjustment	I
over	O
three	O
views	O
.	O
the	O
sparse	B
matrix	O
techniques	O
of	O
section	O
a6.3-	O
(	O
p602	O
)	O
should	O
be	O
used	O
.	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
=	O
p	O
(	O
cid:2	O
)	O
xi	O
,	O
and	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
with	O
ˆxi	O
=	O
[	O
i	O
|	O
0	O
]	O
xi	O
,	O
ˆx	O
(	O
cid:2	O
)	O
a	O
good	O
way	O
to	O
ﬁnd	O
an	O
initial	O
estimate	O
is	O
the	O
algebraic	B
algorithm	O
16.2	O
,	O
though	O
the	O
ﬁnal	O
iterative	B
step	O
can	O
be	O
omitted	O
.	O
this	O
algorithm	B
gives	O
a	O
direct	O
estimate	O
of	O
the	O
entries	O
of	O
p	O
(	O
cid:2	O
)	O
.	O
the	O
initial	O
estimate	O
of	O
the	O
3d	O
points	O
xi	O
may	O
be	O
obtained	O
using	O
the	O
linear	B
triangulation	O
method	O
of	O
section	O
12.2	O
(	O
p312	O
)	O
.	O
the	O
steps	O
of	O
the	O
algorithm	O
are	O
summarized	O
in	O
algorithm	O
16.3.	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
398	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
the	O
technique	O
can	O
be	O
extended	O
to	O
include	O
line	B
correspondences	I
.	O
to	O
do	O
this	O
,	O
one	O
needs	O
to	O
ﬁnd	O
a	O
representation	B
of	O
a	O
3d	O
line	B
convenient	O
for	O
computation	O
.	O
given	O
a	O
3-view	O
line	B
correspondence	O
l	O
↔	O
l	O
(	O
cid:2	O
)	O
↔	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
the	O
lines	B
being	O
perhaps	O
deﬁned	O
by	O
their	O
endpoints	O
in	O
each	O
image	O
,	O
a	O
very	O
convenient	O
way	O
to	O
represent	O
the	O
3d	O
line	B
during	O
the	O
lm	O
parameter	O
(	O
cid:2	O
)	O
minimization	B
is	O
by	O
its	O
projections	O
ˆl	O
in	O
the	O
second	O
and	O
third	O
views	O
.	O
given	O
a	O
candidate	O
trifocal	B
tensor	I
,	O
one	O
can	O
easily	O
compute	O
the	O
projection	B
of	O
the	O
3d	O
line	B
into	O
(	O
cid:2	O
)	O
the	O
ﬁrst	O
view	O
using	O
the	O
line	B
transfer	I
equation	O
ˆli	O
=	O
ˆl	O
.	O
then	O
one	O
minimizes	O
the	O
j	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
ˆl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ˆl	O
k	O
sum-of-squares	O
line	B
distance	O
(	O
cid:7	O
)	O
t	O
jk	O
i	O
d	O
(	O
li	O
,	O
ˆli	O
)	O
2	O
+	O
d	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
)	O
2	O
+	O
d	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
ˆl	O
i	O
,	O
ˆl	O
i	O
)	O
2	O
i	O
(	O
cid:2	O
)	O
for	O
some	O
appropriate	O
interpretation	O
of	O
the	O
distance	O
d	O
(	O
l	O
(	O
cid:2	O
)	O
i	O
,	O
ˆl	O
i	O
)	O
2	O
between	O
the	O
measured	O
and	O
estimated	O
line	B
.	O
if	O
the	O
measured	O
line	B
is	O
speciﬁed	O
by	O
its	O
endpoints	O
,	O
then	O
the	O
obvious	O
distance	B
metric	O
to	O
use	O
is	O
the	O
distance	B
of	O
the	O
estimated	O
line	B
from	O
the	O
measured	O
endpoints	O
.	O
in	O
general	O
a	O
mahalanobis	O
distance	B
may	O
be	O
used	O
.	O
16.4.2	O
parametrization	B
of	I
the	O
trifocal	B
tensor	I
if	O
the	O
tensor	B
is	O
parametrized	O
simply	O
by	O
its	O
27	O
entries	O
,	O
then	O
the	O
estimated	O
tensor	B
will	O
not	O
satisfy	O
the	O
internal	B
constraints	O
.	O
a	O
parametrization	B
which	O
ensures	O
that	O
the	O
tensor	B
does	O
satisfy	O
its	O
constraints	B
,	O
and	O
so	O
is	O
geometrically	B
valid	I
,	O
is	O
termed	O
consistent	O
.	O
since	O
,	O
from	O
deﬁnition	O
16.1	O
,	O
a	O
tensor	B
is	O
geometrically	B
valid	I
if	O
it	O
is	O
generated	O
from	O
three	O
camera	O
matrices	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
by	O
(	O
15.9–p376	O
)	O
,	O
it	O
follows	O
that	O
the	O
three	O
cam-	O
era	O
matrices	O
give	O
a	O
consistent	O
parametrization	B
.	O
note	O
that	O
this	O
is	O
an	O
overparametrization	O
since	O
it	O
requires	O
24	O
parameters	B
to	O
be	O
speciﬁed	O
,	O
namely	O
the	O
12	O
entries	O
each	O
of	O
the	O
ma-	O
=	O
[	O
b|b4	O
]	O
.	O
there	O
is	O
no	O
need	O
to	O
attempt	O
to	O
deﬁne	O
a	O
minimal	O
trices	O
p	O
(	O
cid:2	O
)	O
set	O
of	O
(	O
18	O
)	O
parameters	B
,	O
which	O
is	O
a	O
difﬁcult	O
task	O
.	O
any	O
choice	B
of	O
cameras	B
is	O
a	O
consistent	O
parametrization	B
,	O
the	O
particular	O
projective	B
reconstruction	I
has	O
no	O
effect	O
on	O
the	O
tensor	B
.	O
=	O
[	O
a|a4	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
another	O
consistent	O
parametrization	B
is	O
obtained	O
by	O
computing	B
the	O
tensor	B
from	O
six	O
point	B
correspondences	O
across	O
three	O
views	O
as	O
in	O
section	O
20.2	O
(	O
p508	O
)	O
.	O
then	O
the	O
position	O
of	O
the	O
points	O
in	O
each	O
image	O
is	O
the	O
parametrization	B
–	O
a	O
total	O
of	O
6	O
(	O
points	O
)	O
×2	O
(	O
for	O
x	O
,	O
y	O
)	O
×	O
3	O
(	O
images	O
)	O
=	O
36	O
parameters	B
.	O
however	O
,	O
only	O
a	O
subset	O
of	O
the	O
points	O
need	O
be	O
varied	O
during	O
the	O
minimization	B
,	O
or	O
the	O
movement	O
of	O
the	O
points	O
can	O
be	O
restricted	O
to	O
be	O
perpendicular	O
to	O
the	O
variety	O
of	O
trifocal	O
tensors	O
.	O
16.4.3	O
first-order	O
geometric	B
error	I
(	O
sampson	O
distance	B
)	O
the	O
trifocal	B
tensor	I
may	O
be	O
computed	O
using	O
a	O
geometric	B
cost	O
function	O
based	O
on	O
the	O
sampson	O
approximation	O
in	O
a	O
manner	O
entirely	O
analogous	O
to	O
the	O
sampson	O
method	O
used	O
to	O
compute	O
the	O
fundamental	B
matrix	I
(	O
section	O
11.4.3	O
(	O
p287	O
)	O
)	O
.	O
again	O
the	O
advantage	O
is	O
that	O
it	O
is	O
not	O
necessary	O
to	O
introduce	O
a	O
set	O
of	O
subsidiary	O
variables	O
,	O
as	O
this	O
ﬁrst-order	O
geometric	B
error	I
requires	O
a	O
minimization	B
only	O
over	O
the	O
parametrization	B
of	I
the	O
tensor	B
(	O
e.g	O
.	O
only	O
24	O
parameters	B
if	O
p	O
(	O
cid:2	O
)	O
is	O
used	O
as	O
above	O
)	O
.	O
the	O
minimization	B
can	O
be	O
carried	O
out	O
with	O
a	O
simple	O
iterative	O
levenberg–marquardt	O
algorithm	B
,	O
and	O
the	O
method	O
initialized	O
by	O
the	O
iterative	B
algebraic	O
algorithm	B
16.2.	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
16.5	O
experimental	B
evaluation	I
of	O
the	O
algorithms	O
399	O
the	O
sampson	O
cost	B
function	I
is	O
a	O
little	O
more	O
complex	O
computationally	O
than	O
the	O
cor-	O
responding	O
cost	B
function	I
for	O
the	O
fundamental	B
matrix	I
(	O
11.9–p287	O
)	O
,	O
because	O
each	O
point	B
correspondence	O
gives	O
four	O
equations	O
,	O
instead	O
of	O
just	O
one	O
for	O
the	O
fundamental	B
matrix	I
.	O
the	O
more	O
general	O
case	O
was	O
discussed	O
in	O
section	O
4.2.6	O
(	O
p98	O
)	O
.	O
the	O
error	B
function	O
(	O
4.13–	O
p100	O
)	O
in	O
the	O
present	O
case	O
is	O
i	O
(	O
jijt	O
t	O
i	O
)	O
−1i	O
(	O
16.4	O
)	O
(	O
cid:7	O
)	O
i	O
i	O
where	O
i	O
is	O
the	O
algebraic	B
error	I
vector	O
ait	O
corresponding	O
to	O
a	O
single	O
3-view	O
correspon-	O
dence	O
(	O
a	O
4-vector	O
in	O
the	O
case	O
of	O
4	O
equations	O
per	O
point	B
)	O
,	O
and	O
j	O
is	O
the	O
4	O
×	O
6	O
matrix	B
of	O
partial	O
derivatives	O
of	O
	O
with	O
respect	O
to	O
the	O
coordinates	B
of	O
each	O
of	O
the	O
corresponding	O
points	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
.	O
as	O
in	O
the	O
programming	B
hint	I
given	O
in	O
exercise	O
(	O
vii	O
)	O
on	O
page	O
129	O
,	O
the	O
computation	B
of	I
the	O
partial	O
derivative	B
matrix	I
j	O
may	O
be	O
simpliﬁed	O
by	O
observing	O
that	O
the	O
cost	B
function	I
is	O
multilinear	O
in	O
the	O
coordinates	B
of	O
the	O
points	O
xi	O
,	O
x	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
.	O
the	O
sampson	O
error	B
method	O
has	O
various	O
advantages	O
:	O
•	O
it	O
gives	O
a	O
good	O
approximation	O
to	O
actual	O
geometric	B
error	I
(	O
the	O
optimum	O
)	O
,	O
using	O
a	O
rela-	O
tively	O
simple	O
iterative	O
algorithm	B
.	O
•	O
as	O
in	O
the	O
case	O
of	O
actual	O
geometric	B
error	I
,	O
non-isotropic	B
and	O
unequal	O
error	B
distribu-	O
tions	O
may	O
be	O
speciﬁed	O
for	O
each	O
of	O
the	O
points	O
without	O
signiﬁcantly	O
complicating	O
the	O
algorithm	B
.	O
see	O
exercises	O
in	O
chapter	O
4	O
.	O
16.5	O
experimental	B
evaluation	I
of	O
the	O
algorithms	O
a	O
brief	O
comparison	O
is	O
now	O
given	O
of	O
the	O
results	O
of	O
the	O
(	O
iterative	B
)	O
algebraic	B
algorithm	O
16.2	O
along	O
with	O
the	O
gold	O
standard	O
algorithm	B
16.3	O
for	O
computing	O
the	O
trifocal	B
tensor	I
.	O
the	O
algorithms	O
are	O
run	O
on	O
synthetic	B
data	I
with	O
controlled	O
levels	O
of	O
noise	O
.	O
this	O
allows	O
a	O
comparison	O
with	O
the	O
theoretically	O
optimal	O
ml	O
results	O
,	O
and	O
a	O
determination	O
of	O
how	O
well	O
these	O
algorithms	O
are	O
able	O
to	O
approximate	O
the	O
theoretical	O
lower	O
bound	O
on	O
residual	O
error	B
,	O
achieved	O
by	O
an	O
optimal	O
ml	O
algorithm	B
.	O
computer-generated	O
data	O
sets	O
of	O
10	O
,	O
15	O
and	O
20	O
points	O
were	O
used	O
to	O
test	O
the	O
algorithm	B
,	O
and	O
the	O
cameras	B
were	O
placed	O
at	O
random	O
angles	O
around	O
the	O
cloud	O
of	B
points	I
.	O
the	O
camera	B
parameters	I
were	O
chosen	O
to	O
approximate	O
a	O
standard	O
35mm	O
camera	B
,	O
and	O
the	O
scale	O
was	O
chosen	O
so	O
that	O
the	O
size	O
of	O
the	O
image	O
was	O
600	O
×	O
600	O
pixels	O
.	O
for	O
a	O
given	O
level	O
of	O
added	O
gaussian	O
noise	B
in	O
the	O
image	O
measurement	O
,	O
one	O
may	O
com-	O
pute	O
the	O
expected	O
residual	B
achieved	O
by	O
an	O
ml	O
algorithm	B
,	O
according	O
to	O
result	O
5.2	O
(	O
p136	O
)	O
.	O
in	O
this	O
case	O
,	O
if	O
n	O
is	O
the	O
number	O
of	O
points	O
,	O
then	O
the	O
number	O
of	O
measurements	O
is	O
n	O
=	O
6n	O
,	O
and	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
in	O
the	O
ﬁtting	O
is	O
d	O
=	O
18	O
+	O
3n	O
,	O
where	O
18	O
represents	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
three	O
cameras	B
(	O
3	O
×	O
11	O
less	O
15	O
to	O
account	O
for	O
projective	O
ambiguity	B
)	O
and	O
3n	O
represents	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
n	O
points	O
in	O
space	O
.	O
hence	O
the	O
ml	O
residual	B
is	O
res	O
=	O
σ	O
(	O
1	O
−	O
d/n	O
)	O
1/2	O
=	O
σ	O
(	O
cid:28	O
)	O
n	O
−	O
6	O
2n	O
(	O
cid:29	O
)	O
1/2	O
.	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
15	O
points	O
r	O
o	O
r	O
r	O
e	O
7	O
6	O
5	O
4	O
3	O
2	O
1	O
0	O
20	O
points	O
7	O
6	O
5	O
4	O
3	O
2	O
1	O
0	O
r	O
o	O
r	O
r	O
e	O
0	O
2	O
4	O
6	O
8	O
10	O
12	O
noise	B
400	O
r	O
o	O
r	O
r	O
e	O
6	O
5	O
4	O
3	O
2	O
1	O
0	O
10	O
points	O
0	O
2	O
4	O
6	O
noise	B
8	O
10	O
12	O
0	O
2	O
4	O
6	O
noise	B
8	O
10	O
12	O
fig	O
.	O
16.1.	O
comparison	O
of	O
trifocal	B
tensor	I
estimation	O
algorithms	O
.	O
the	O
residual	B
error	O
rms-averaged	O
over	O
100	O
runs	O
is	O
plotted	O
against	O
the	O
noise	B
level	O
,	O
for	O
computation	O
of	O
the	O
trifocal	O
tensor	B
using	O
10	O
,	O
15	O
and	O
20	O
points	O
.	O
each	O
graph	O
contains	O
three	O
curves	O
.	O
the	O
top	O
curve	O
is	O
the	O
result	O
of	O
the	O
algebraic	O
error	B
minimization	O
,	O
whereas	O
the	O
lower	O
two	O
curves	O
,	O
actually	O
indistinguishable	O
in	O
the	O
graphs	O
,	O
represent	O
the	O
theoretical	O
minimum	O
error	B
,	O
and	O
the	O
error	B
obtained	O
by	O
the	O
gold	O
standard	O
algorithm	B
using	O
the	O
algebraic	B
minimization	I
as	O
a	O
starting	O
point	B
.	O
note	O
that	O
the	O
residual	B
errors	O
are	O
almost	O
exactly	O
proportional	O
to	O
added	O
noise	B
,	O
as	O
they	O
should	O
be	O
.	O
16.5.1	O
results	B
and	I
recommendations	I
the	O
results	O
are	O
shown	O
in	O
ﬁgure	O
16.1.	O
we	O
learn	O
two	O
things	O
from	O
these	O
results	O
.	O
minimiza-	O
tion	O
of	O
the	O
algebraic	O
error	B
achieves	O
residual	B
errors	O
within	O
about	O
15	O
%	O
of	O
the	O
optimal	O
and	O
using	O
this	O
estimate	O
as	O
a	O
starting	O
point	B
for	O
minimizing	B
geometric	I
error	O
achieves	O
a	O
virtu-	O
ally	O
optimal	O
estimate	O
.	O
all	O
the	O
algorithms	O
developed	O
above	O
,	O
except	O
the	O
linear	B
method	O
of	O
section	O
16.1	O
,	O
enforce	O
the	O
internal	B
constraints	O
on	O
the	O
tensor	B
.	O
the	O
linear	B
method	O
is	O
not	O
recommended	O
for	O
use	O
on	O
its	O
own	O
,	O
but	O
is	O
necessary	O
for	O
initialization	O
in	O
most	O
of	O
the	O
other	O
methods	O
.	O
as	O
in	O
the	O
case	O
of	O
estimating	O
the	O
fundamental	B
matrix	I
our	O
recommendations	B
are	O
to	O
use	O
the	O
iterative	B
algebraic	O
algorithm	B
16.2	O
or	O
the	O
sampson	O
geometric	B
approximation	O
of	O
section	O
16.4.3.	O
both	O
give	O
excellent	O
results	O
.	O
again	O
to	O
be	O
certain	O
of	O
getting	O
the	O
best	O
results	O
,	O
if	O
gaussian	O
noise	B
is	O
a	O
viable	O
assumption	O
,	O
implement	O
the	O
gold	O
standard	O
algorithm	B
16.3	O
.	O
16.6	O
automatic	O
computation	B
of	I
t	O
this	O
section	O
describes	O
an	O
algorithm	B
to	O
compute	O
the	O
trifocal	B
geometry	O
between	O
three	O
images	O
automatically	O
.	O
the	O
input	O
to	O
the	O
algorithm	B
is	O
simply	O
the	O
triplet	O
of	O
images	O
,	O
with	O
no	O
other	O
a	O
priori	O
information	O
required	O
;	O
and	O
the	O
output	O
is	O
the	O
estimated	O
trifocal	B
tensor	I
together	O
with	O
a	O
set	O
of	O
interest	O
points	O
in	O
correspondence	B
across	O
the	O
three	O
images	O
.	O
the	O
fact	O
that	O
the	O
trifocal	B
tensor	I
may	O
be	O
used	O
to	O
determine	O
the	O
exact	O
image	O
position	O
of	O
a	O
point	O
in	O
a	O
third	O
view	O
,	O
given	O
its	O
image	O
position	O
in	O
the	O
other	O
two	B
views	I
,	O
means	O
that	O
there	O
are	O
fewer	O
mismatches	O
over	O
three	O
views	O
than	O
there	O
are	O
over	O
two	O
.	O
in	O
the	O
two	O
view	O
case	O
there	O
is	O
only	O
the	O
weaker	O
geometric	B
constraint	O
of	O
an	O
epipolar	B
line	I
against	O
which	O
to	O
verify	O
a	O
possible	O
match	O
.	O
the	O
three-view	O
algorithm	B
uses	O
ransac	O
as	O
a	O
search	O
engine	O
in	O
a	O
similar	O
manner	O
to	O
its	O
use	O
in	O
the	O
automatic	O
computation	B
of	I
a	O
homography	B
described	O
in	O
section	O
4.8-	O
(	O
p123	O
)	O
.	O
the	O
ideas	O
and	O
details	O
of	O
the	O
algorithm	O
are	O
given	O
there	O
,	O
and	O
are	O
not	O
repeated	O
here	O
.	O
the	O
method	O
is	O
summarized	O
in	O
algorithm	O
16.4	O
,	O
with	O
an	O
example	O
of	O
its	O
use	O
shown	O
16.6	O
automatic	O
computation	B
of	I
t	O
401	O
objective	O
compute	O
the	O
trifocal	B
tensor	I
between	O
three	O
images	O
.	O
algorithm	B
(	O
i	O
)	O
interest	B
points	I
:	O
compute	O
interest	B
points	I
in	O
each	O
image	O
.	O
(	O
ii	O
)	O
two-view	O
correspondences	B
:	O
compute	O
interest	O
point	O
correspondences	B
(	O
and	O
f	O
)	O
between	O
views	O
1	O
&	O
2	O
,	O
and	O
2	O
&	O
3	O
using	O
algorithm	O
11.4	O
(	O
p291	O
)	O
.	O
(	O
iii	O
)	O
putative	O
three-view	O
correspondences	B
:	O
compute	O
a	O
set	O
of	O
interest	O
point	B
correspon-	O
dences	O
over	O
three	O
views	O
by	O
joining	O
the	O
two-view	O
match	O
sets	O
.	O
(	O
iv	O
)	O
ransac	O
robust	B
estimation	O
:	O
repeat	O
for	O
n	O
samples	O
,	O
where	O
n	O
is	O
determined	O
adap-	O
tively	O
as	O
in	O
algorithm	B
4.5	O
(	O
p121	O
)	O
:	O
(	O
a	O
)	O
select	O
a	O
random	O
sample	O
of	O
6	O
correspondences	B
and	O
compute	O
the	O
trifocal	B
tensor	I
using	O
algorithm	B
20.1	O
(	O
p511	O
)	O
.	O
there	O
will	O
be	O
one	O
or	O
three	O
real	O
solutions	O
.	O
ety	O
described	O
by	O
t	O
,	O
as	O
in	O
section	O
16.6.	O
dences	O
for	O
which	O
d⊥	O
<	O
t.	O
(	O
b	O
)	O
calculate	O
the	O
distance	B
d⊥	O
in	O
ir6	O
from	O
each	O
putative	O
correspondence	B
to	O
the	O
vari-	O
(	O
c	O
)	O
compute	O
the	O
number	O
of	O
inliers	O
consistent	O
with	O
t	O
by	O
the	O
number	O
of	O
correspon-	O
(	O
d	O
)	O
if	O
there	O
are	O
three	O
real	O
solutions	O
for	O
t	O
the	O
number	O
of	O
inliers	O
is	O
computed	O
for	O
each	O
choose	O
the	O
t	O
with	O
the	O
largest	O
number	O
of	O
inliers	O
.	O
in	O
the	O
case	O
of	O
ties	O
choose	O
the	O
solution	B
that	O
has	O
the	O
lowest	O
standard	O
deviation	O
of	O
inliers	O
.	O
(	O
v	O
)	O
optimal	O
estimation	B
:	O
re-estimate	O
t	O
from	O
all	O
correspondences	B
classiﬁed	O
as	O
inliers	O
us-	O
solution	B
,	O
and	O
the	O
solution	B
with	O
most	O
inliers	O
retained	O
.	O
(	O
vi	O
)	O
guided	B
matching	I
:	O
further	O
interest	O
point	O
correspondences	B
are	O
now	O
determined	O
using	O
ing	O
the	O
gold	O
standard	O
algorithm	B
16.3	O
or	O
the	O
sampson	O
approximation	O
to	O
this	O
.	O
the	O
estimated	O
t	O
as	O
described	O
in	O
the	O
text	O
.	O
the	O
last	O
two	O
steps	O
can	O
be	O
iterated	O
until	O
the	O
number	O
of	O
correspondences	O
is	O
stable	O
.	O
algorithm	B
16.4.	O
algorithm	B
to	O
automatically	O
estimate	O
the	O
trifocal	B
tensor	I
over	O
three	O
images	O
using	O
ransac	O
.	O
in	O
ﬁgure	O
16.2	O
,	O
and	O
additional	O
explanation	O
of	O
the	O
steps	O
given	O
below	O
.	O
figure	O
16.3	O
shows	O
a	O
second	O
example	O
which	O
includes	O
automatically	O
computed	O
line	O
matches	O
.	O
the	O
distance	B
measure	O
–	O
reprojection	B
error	I
.	O
given	O
the	O
match	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
the	O
current	O
estimate	O
of	O
t	O
we	O
need	O
to	O
determine	O
the	O
minimum	O
of	O
the	O
reprojection	O
error	B
–	O
d2⊥	O
=	O
d2	O
(	O
x	O
,	O
ˆx	O
)	O
+	O
d2	O
(	O
x	O
(	O
cid:2	O
)	O
are	O
consistent	O
a	O
3-space	O
point	B
(	O
cid:23	O
)	O
x	O
with	O
t	O
.	O
as	O
usual	O
the	O
consistent	O
images	O
points	O
may	O
be	O
obtained	O
from	O
the	O
projection	B
of	O
by	O
determining	O
the	O
point	O
(	O
cid:23	O
)	O
x	O
which	O
minimizes	O
the	O
image	O
distance	O
between	O
the	O
measured	O
are	O
extracted	O
from	O
t	O
.	O
the	O
distance	B
d2⊥	O
is	O
then	O
obtained	O
,	O
ˆx	O
(	O
cid:2	O
)	O
,	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ˆx	O
=	O
[	O
i	O
|	O
0	O
]	O
(	O
cid:23	O
)	O
x	O
,	O
)	O
,	O
where	O
the	O
image	O
points	O
ˆx	O
,	O
ˆx	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
(	O
cid:23	O
)	O
x	O
,	O
=	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:23	O
)	O
x	O
)	O
+	O
d2	O
(	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
where	O
the	O
camera	B
matrices	I
p	O
(	O
cid:2	O
)	O
points	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
the	O
projected	O
points	O
.	O
ˆx	O
(	O
cid:2	O
)	O
another	O
way	O
of	O
obtaining	O
this	O
distance	B
is	O
to	O
use	O
the	O
sampson	O
error	B
(	O
16.4	O
)	O
,	O
which	O
is	O
a	O
ﬁrst-order	O
approximation	O
to	O
the	O
geometric	B
error	I
.	O
however	O
,	O
in	O
practice	O
it	O
is	O
quicker	O
to	O
estimate	O
the	O
error	B
directly	O
by	O
non-linear	B
least-squares	O
iteration	B
(	O
a	O
small	O
levenberg–	O
marquardt	O
problem	O
)	O
.	O
starting	O
from	O
an	O
initial	O
estimate	O
of	O
(	O
cid:23	O
)	O
x	O
,	O
one	O
iterates	O
varying	O
the	O
coordinates	B
of	O
(	O
cid:23	O
)	O
x	O
to	O
minimize	O
the	O
reprojection	B
error	I
.	O
402	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
a	O
d	O
b	O
e	O
c	O
f	O
g	O
i	O
h	O
j	O
fig	O
.	O
16.2.	O
automatic	O
computation	B
of	I
the	O
trifocal	B
tensor	I
between	O
three	O
images	O
using	O
ransac	O
.	O
(	O
a	O
-	O
c	O
)	O
raw	O
images	O
of	O
keble	O
college	O
,	O
oxford	O
.	O
the	O
motion	O
between	O
views	O
consists	O
of	O
a	O
translation	O
and	O
rotation	B
.	O
the	O
images	O
are	O
640	O
×	O
480	O
pixels	O
.	O
(	O
d	O
-	O
f	O
)	O
detected	O
corners	O
superimposed	O
on	O
the	O
images	O
.	O
there	O
are	O
approximately	O
500	O
corners	O
on	O
each	O
image	O
.	O
the	O
following	O
results	O
are	O
superimposed	O
on	O
the	O
(	O
a	O
)	O
image	O
:	O
(	O
g	O
)	O
106	O
putative	O
matches	O
shown	O
by	O
the	O
line	B
linking	O
corners	O
,	O
note	O
the	O
clear	O
mismatches	O
;	O
(	O
h	O
)	O
outliers	O
–	O
18	O
of	O
the	O
putative	O
matches	O
.	O
(	O
i	O
)	O
inliers	O
–	O
88	O
correspondences	B
consistent	O
with	O
the	O
estimated	O
t	O
;	O
(	O
j	O
)	O
ﬁnal	O
set	O
of	O
95	O
correspondences	B
after	O
guided	B
matching	I
and	O
mle	O
.	O
there	O
are	O
no	O
mismatches	O
.	O
guided	B
matching	I
.	O
we	O
have	O
an	O
initial	O
estimate	O
of	O
t	O
and	O
wish	O
to	O
use	O
this	O
to	O
generate	O
and	O
assess	O
additional	O
point	B
correspondences	O
across	O
the	O
three-views	O
.	O
the	O
ﬁrst	O
step	O
is	O
to	O
extract	O
the	O
fundamental	B
matrix	I
f12	O
between	O
views	O
1	O
&	O
2	O
from	O
t	O
.	O
then	O
two-view	O
16.6	O
automatic	O
computation	B
of	I
t	O
403	O
a	O
b	O
fig	O
.	O
16.3.	O
image	O
triplet	O
matching	B
.	O
the	O
trifocal	B
tensor	I
is	O
computed	O
automatically	O
from	O
interest	O
points	O
using	O
algorithm	B
16.4	O
,	O
and	O
subsequently	O
used	O
to	O
match	O
line	B
features	O
across	O
views	O
.	O
(	O
a	O
)	O
three	O
images	O
of	O
a	O
corridor	O
sequence	O
.	O
(	O
b	O
)	O
automatically	O
matched	O
line	B
segments	O
.	O
the	O
matching	B
algorithm	O
is	O
described	O
in	O
[	O
schmid-97	O
]	O
.	O
guided	O
matches	O
are	O
computed	O
using	O
loose	O
thresholds	O
on	O
matching	O
.	O
each	O
two-view	O
match	O
is	O
corrected	O
using	O
f12	O
to	O
give	O
points	O
ˆx	O
,	O
ˆx	O
(	O
cid:2	O
)	O
which	O
are	O
consistent	O
with	O
f12	O
.	O
these	O
corrected	O
two-view	O
matches	O
(	O
together	O
with	O
t	O
)	O
deﬁne	O
a	O
small	O
search	O
window	O
in	O
the	O
third	O
view	O
in	O
which	O
the	O
corresponding	O
point	B
is	O
sought	O
.	O
any	O
three-view	O
point	B
correspondence	O
is	O
assessed	O
by	O
computing	B
d⊥	O
,	O
as	O
described	O
above	O
.	O
the	O
match	O
accepted	O
if	O
d⊥	O
is	O
less	O
than	O
the	O
threshold	O
t.	O
note	O
,	O
the	O
same	O
threshold	O
is	O
used	O
for	O
inlier	O
detection	O
within	O
the	O
ransac	O
stage	O
and	O
guided	B
matching	I
.	O
in	O
practice	O
it	O
is	O
found	O
that	O
the	O
stage	O
of	O
guided	O
matching	B
is	O
more	O
signiﬁcant	O
here	O
,	O
in	O
that	O
it	O
generates	O
additional	O
correspondences	B
,	O
than	O
in	O
the	O
case	O
of	O
homography	O
estima-	O
tion	O
.	O
implementation	B
and	O
run	B
details	I
.	O
for	O
the	O
example	O
of	O
ﬁgure	O
16.2	O
,	O
the	O
search	O
window	O
was	O
±300	O
pixels	O
.	O
the	O
inlier	O
threshold	O
was	O
t	O
=	O
1.25	O
pixels	O
.	O
a	O
total	O
of	O
26	O
samples	O
were	O
required	O
.	O
the	O
rms	O
pixel	O
error	B
after	O
ransac	O
was	O
0.43	O
(	O
for	O
88	O
correspondences	B
)	O
,	O
after	O
mle	O
it	O
was	O
0.23	O
(	O
for	O
88	O
correspondences	B
)	O
,	O
and	O
after	O
mle	O
and	O
guided	B
matching	I
it	O
was	O
0.19	O
(	O
for	O
95	O
correspondences	B
)	O
.	O
the	O
mle	O
required	O
10	O
iterations	O
of	O
the	O
levenberg–	O
marquardt	O
algorithm	B
.	O
note	O
,	O
ransac	O
has	O
to	O
do	O
far	O
less	O
work	O
than	O
in	O
algorithm	O
11.4	O
(	O
p291	O
)	O
to	O
estimate	O
f	O
and	O
correspondences	B
,	O
because	O
the	O
two-view	O
algorithm	B
has	O
already	O
removed	O
many	O
outliers	O
before	O
the	O
putative	O
correspondences	B
over	O
three	O
views	O
are	O
generated	O
.	O
404	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
16.7	O
special	O
cases	O
of	O
t	O
-computation	O
i	O
from	O
a	O
plane	B
plus	I
parallax	I
16.7.1	O
computing	B
t	O
jk	O
we	O
describe	O
here	O
the	O
computation	B
of	I
t	O
jk	O
from	O
the	O
image	O
of	O
a	O
special	O
conﬁguration	O
consisting	O
of	O
a	O
world	O
plane	B
(	O
from	O
which	O
a	O
homography	B
between	O
views	O
can	O
be	O
com-	O
puted	O
)	O
and	O
two	O
points	O
off	O
the	O
plane	B
.	O
of	O
course	O
,	O
it	O
is	O
not	O
necessary	O
for	O
the	O
plane	B
to	O
actually	O
be	O
present	O
.	O
it	O
may	O
be	O
virtual	O
,	O
or	O
the	O
homography	B
may	O
simply	O
be	O
speciﬁed	O
by	O
the	O
images	O
of	O
four	O
coplanar	O
points	O
or	O
four	O
coplanar	O
lines	B
.	O
the	O
method	O
is	O
the	O
analogue	O
of	O
algorithm	O
13.2	O
(	O
p336	O
)	O
for	O
the	O
fundamental	B
matrix	I
.	O
i	O
the	O
solution	B
is	O
obtained	O
by	O
constructing	O
the	O
three	O
camera	B
matrices	I
(	O
up	O
to	O
a	O
common	O
projective	B
transformation	I
of	O
3-space	O
)	O
and	O
then	O
computing	B
the	O
trifocal	B
tensor	I
from	O
these	O
matrices	O
according	O
to	O
(	O
15.9–p376	O
)	O
.	O
the	O
homography	B
induced	O
by	O
the	O
world	O
(	O
reference	O
)	O
plane	B
between	O
the	O
ﬁrst	O
and	O
second	O
view	O
is	O
h12	O
,	O
and	O
between	O
the	O
ﬁrst	O
and	O
third	O
views	O
is	O
h13	O
.	O
as	O
shown	O
in	O
section	O
13.3	O
(	O
p334	O
)	O
the	O
epipole	O
e	O
(	O
cid:2	O
)	O
may	O
be	O
computed	O
directly	O
from	O
the	O
two	O
point	O
correspondences	B
off	O
the	O
plane	B
for	O
the	O
ﬁrst	O
and	O
second	O
views	O
,	O
and	O
the	O
camera	B
matrices	I
chosen	O
as	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
]	O
,	O
where	O
µ	O
is	O
a	O
scalar	O
.	O
note	O
the	O
scale	O
of	O
both	O
h12	O
and	O
e	O
(	O
cid:2	O
)	O
is	O
considered	O
ﬁxed	O
here	O
,	O
so	O
they	O
are	O
no	O
longer	O
homogeneous	O
quantities	O
.	O
similarly	O
,	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
may	O
be	O
determined	O
from	O
the	O
two	O
point	O
correspondences	B
for	O
views	O
one	O
and	O
three	O
and	O
the	O
camera	B
matrices	I
chosen	O
as	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
,	O
where	O
λ	O
is	O
a	O
scalar	O
.	O
=	O
[	O
h13	O
|	O
λe	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
[	O
h12	O
|	O
µe	O
(	O
cid:2	O
)	O
it	O
is	O
then	O
easily	O
veriﬁed	O
that	O
a	O
consistent	O
set	O
of	O
cameras	O
for	O
the	O
three	O
views	O
(	O
see	O
the	O
discussion	O
on	O
consistent	O
camera	B
triplets	O
on	O
page	O
375	O
)	O
is	O
given	O
by	O
=	O
[	O
h13	O
|	O
λe	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
=	O
[	O
h12	O
|	O
e	O
(	O
cid:2	O
)	O
p	O
(	O
cid:2	O
)	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
,	O
]	O
(	O
16.5	O
)	O
where	O
µ	O
has	O
been	O
set	O
to	O
unity	O
.	O
the	O
value	O
of	O
λ	O
is	O
determined	O
from	O
one	O
of	O
the	O
point	O
correspondences	B
over	O
three	O
views	O
,	O
and	O
this	O
is	O
left	O
as	O
an	O
exercise	O
.	O
for	O
more	O
on	O
plane-	O
plus-parallax	O
reconstruction	B
,	O
see	O
section	O
18.5.2	O
(	O
p450	O
)	O
.	O
note	O
that	O
the	O
estimation	B
of	I
the	O
trifocal	B
tensor	I
for	O
this	O
conﬁguration	O
is	O
over-	O
determined	O
.	O
in	O
the	O
case	O
of	O
the	O
fundamental	O
matrix	B
over	O
two	B
views	I
the	O
homographies	B
determine	O
all	O
but	O
2	O
degrees	B
of	I
freedom	I
(	O
the	O
epipole	O
)	O
,	O
and	O
each	O
of	O
the	O
point	O
correspon-	O
dence	O
provides	O
one	O
constraint	O
,	O
so	O
that	O
the	O
number	O
of	O
constraints	O
equals	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
matrix	O
.	O
in	O
the	O
case	O
of	O
the	O
trifocal	O
tensor	B
the	O
homography	B
determines	O
all	O
but	O
5	O
degrees	B
of	I
freedom	I
(	O
the	O
two	O
epipoles	O
and	O
their	O
relative	O
scaling	B
)	O
.	O
however	O
,	O
each	O
point	B
correspondence	O
provides	O
three	O
constraints	B
(	O
there	O
are	O
six	O
coordi-	O
nate	O
measurements	O
less	O
three	O
for	O
the	O
point	B
’	O
s	O
position	O
in	O
3-space	O
)	O
,	O
so	O
that	O
there	O
are	O
six	O
constraints	B
on	O
5	O
degrees	B
of	I
freedom	I
.	O
since	O
there	O
are	O
more	O
measurements	O
than	O
degrees	B
of	I
freedom	I
in	O
this	O
case	O
,	O
the	O
tensor	B
should	O
be	O
estimated	O
by	O
minimizing	B
a	O
cost	B
function	I
based	O
on	O
geometric	O
error	B
.	O
16.7.2	O
lines	B
speciﬁed	O
by	O
several	O
points	O
in	O
describing	O
the	O
reconstruction	B
algorithm	O
from	O
lines	O
,	O
we	O
have	O
considered	O
the	O
case	O
where	O
lines	B
are	O
speciﬁed	O
by	O
their	O
two	O
endpoints	O
.	O
another	O
common	O
way	O
that	O
lines	B
may	O
16.7	O
special	O
cases	O
of	O
t	O
-computation	O
405	O
be	O
speciﬁed	O
in	O
an	O
image	O
is	O
as	O
the	O
best	O
line	B
ﬁt	O
to	O
several	O
points	O
.	O
it	O
will	O
be	O
shown	O
now	O
how	O
that	O
case	O
may	O
easily	O
be	O
reduced	B
to	O
the	O
case	O
of	O
a	O
line	O
deﬁned	O
by	O
two	O
endpoints	O
.	O
consider	O
a	O
set	O
of	B
points	I
xi	O
in	O
an	O
image	O
,	O
normalized	O
to	O
have	O
third	O
component	O
equal	O
to	O
1.	O
let	O
l	O
=	O
(	O
l1	O
,	O
l2	O
,	O
l3	O
)	O
t	O
be	O
a	O
line	B
,	O
which	O
we	O
suppose	O
is	O
normalized	O
such	O
that	O
l2	O
2	O
=	O
1.	O
in	O
this	O
case	O
,	O
the	O
distance	B
from	O
a	O
point	B
xi	O
to	O
the	O
line	B
l	O
is	O
equal	O
to	O
xt	O
l.	O
the	O
squared	O
distance	O
i	O
may	O
be	O
written	O
as	O
d2	O
=	O
ltxixt	O
i	O
1	O
+	O
l2	O
l	O
,	O
and	O
the	O
sum-of-squares	O
of	O
all	O
distances	O
is	O
ltxixt	O
l	O
=	O
lt	O
(	O
xixt	O
i	O
)	O
l	O
.	O
i	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
i	O
i	O
(	O
cid:27	O
)	O
xixt	O
the	O
matrix	B
e	O
=	O
(	O
lemma	O
16.2.	O
matrix	B
(	O
e	O
−	O
0j	O
)	O
is	O
positive-semideﬁnite	O
,	O
where	O
j	O
is	O
the	O
matrix	B
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
and	O
0	O
is	O
the	O
smallest	O
solution	B
to	O
the	O
equation	O
det	O
(	O
e	O
−	O
j	O
)	O
=	O
0.	O
i	O
)	O
is	O
positive-deﬁnite	O
and	O
symmetric	B
.	O
i	O
1	O
+x2	O
1	O
+	O
x2	O
proof	O
.	O
we	O
start	O
by	O
computing	B
the	O
vector	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
that	O
minimizes	O
xtex	O
subject	O
to	O
the	O
condition	O
x2	O
2	O
=	O
1.	O
using	O
the	O
method	O
of	O
lagrange	O
multipliers	O
,	O
this	O
comes	O
down	O
to	O
ﬁnding	O
the	O
extrema	O
of	O
xtex−ξ	O
(	O
x2	O
2	O
)	O
,	O
where	O
ξ	O
denotes	O
the	O
lagrange	O
coefﬁcient	O
.	O
taking	O
the	O
derivative	O
with	O
respect	O
to	O
x	O
and	O
setting	O
it	O
to	O
zero	O
,	O
we	O
ﬁnd	O
that	O
2ex−	O
ξ	O
(	O
2x1	O
,	O
2x2	O
,	O
0	O
)	O
t	O
=	O
0.	O
this	O
may	O
be	O
written	O
as	O
(	O
e−	O
ξj	O
)	O
x	O
=	O
0.	O
it	O
follows	O
that	O
ξ	O
is	O
a	O
root	O
of	O
the	O
equation	O
det	O
(	O
e−	O
ξj	O
)	O
=	O
0	O
and	O
x	O
is	O
the	O
generator	B
of	O
the	O
null-space	B
of	O
e−	O
ξj	O
.	O
since	O
xtex	O
=	O
ξxtjx	O
=	O
ξ	O
(	O
x2	O
2	O
)	O
=	O
ξ	O
,	O
it	O
follows	O
that	O
to	O
minimize	O
xtex	O
one	O
must	O
choose	O
ξ	O
to	O
be	O
the	O
minimum	O
root	O
ξ0	O
of	O
the	O
equation	O
det	O
(	O
e−ξj	O
)	O
=	O
0.	O
in	O
this	O
case	O
one	O
has	O
ex0	O
−	O
ξ0	O
=	O
0	O
for	O
the	O
minimizing	B
vector	O
x0	O
.	O
for	O
any	O
other	O
vector	O
x	O
,	O
not	O
necessarily	O
xt	O
the	O
minimizing	B
vector	O
,	O
one	O
has	O
xtex−	O
ξ0	O
≥	O
0.	O
then	O
,	O
xt	O
(	O
e−	O
ξ0j	O
)	O
x	O
=	O
xtex−	O
ξ0	O
≥	O
0	O
,	O
0	O
and	O
so	O
e	O
−	O
ξ0j	O
is	O
positive-semideﬁnite	O
.	O
since	O
the	O
matrix	B
e	O
−	O
ξ0j	O
is	O
symmetric	B
it	O
may	O
be	O
written	O
in	O
the	O
form	O
e	O
−	O
ξ0j	O
=	O
vdiag	O
(	O
r	O
,	O
s	O
,	O
0	O
)	O
vt	O
where	O
v	O
is	O
an	O
orthogonal	B
matrix	O
and	O
r	O
and	O
s	O
are	O
positive	O
.	O
it	O
follows	O
that	O
1	O
+	O
x2	O
e	O
−	O
ξ0j	O
=	O
vdiag	O
(	O
r	O
,	O
0	O
,	O
0	O
)	O
vt	O
+	O
vdiag	O
(	O
0	O
,	O
s,0	O
)	O
v	O
t	O
=	O
rv1vt	O
1	O
+	O
sv2vt	O
2	O
where	O
vi	O
is	O
the	O
i-th	O
column	O
of	O
v.	O
therefore	O
e	O
=	O
ξ0j	O
+	O
rv1vt	O
line	B
l	O
satisfying	O
l2	O
2	O
=	O
1	O
we	O
have	O
1	O
+	O
l2	O
1	O
+	O
sv2vt	O
2	O
.	O
then	O
for	O
any	O
(	O
cid:7	O
)	O
(	O
xt	O
i	O
l	O
)	O
2	O
=	O
ltel	O
i	O
=	O
ξ0	O
+	O
r	O
(	O
vt	O
1	O
l	O
)	O
2	O
+	O
s	O
(	O
vt	O
2	O
l	O
)	O
2.	O
thus	O
,	O
we	O
have	O
replaced	O
the	O
sum-of-squares	O
of	O
several	O
points	O
by	O
a	O
constant	O
value	O
ξ0	O
,	O
which	O
is	O
not	O
capable	O
of	O
being	O
minimized	O
,	O
plus	O
the	O
weighted	B
sum-of-squares	O
of	O
the	O
distances	O
to	O
two	O
points	O
v1	O
and	O
v2	O
.	O
to	O
summarize	O
:	O
when	O
forming	O
the	O
trifocal	B
tensor	I
equations	O
involving	O
a	O
line	B
deﬁned	O
by	O
points	O
xi	O
,	O
formulate	O
two	O
point	O
equations	O
expressed	O
in	O
terms	O
of	O
the	O
points	O
v1	O
and	O
v2	O
with	O
weights	O
√	O
r	O
and	O
s	O
respectively	O
.	O
√	O
406	O
16	O
computation	B
of	I
the	O
trifocal	B
tensor	I
t	O
(	O
cid:27	O
)	O
orthogonal	B
regression	I
.	O
in	O
the	O
proof	O
of	O
lemma	O
16.2	O
above	O
,	O
it	O
was	O
shown	O
that	O
the	O
line	B
l	O
that	O
minimizes	O
the	O
sum	O
of	O
squared	O
distances	O
to	O
the	O
set	O
of	O
all	O
points	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
t	O
is	O
obtained	O
as	O
follows	O
.	O
xixt	O
i	O
i	O
and	O
j	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
.	O
(	O
i	O
)	O
deﬁne	O
matrices	O
e	O
=	O
(	O
ii	O
)	O
let	O
ξ0	O
be	O
the	O
minimum	O
root	O
of	O
the	O
equation	O
det	O
(	O
e	O
−	O
ξj	O
)	O
=	O
0	O
.	O
(	O
iii	O
)	O
the	O
required	O
line	B
l	O
is	O
the	O
right	O
null-vector	O
of	O
the	O
matrix	O
e	O
−	O
ξ0j	O
.	O
this	O
gives	O
a	O
least-squares	O
best	O
ﬁt	O
of	O
a	O
line	O
to	O
a	O
set	O
of	B
points	I
.	O
this	O
process	O
is	O
known	O
as	O
orthogonal	B
regression	I
and	O
it	O
extends	O
in	O
an	O
obvious	O
way	O
to	O
higher-dimensional	O
ﬁtting	O
of	O
a	O
hyperplane	O
to	O
a	O
set	O
of	B
points	I
in	O
a	O
way	O
that	O
minimizes	O
the	O
sum	O
of	O
squared	O
distances	O
to	O
the	O
points	O
.	O
16.8	O
closure	O
16.8.1	O
the	O
literature	O
a	O
linear	B
method	O
for	O
computing	O
the	O
trifocal	B
tensor	I
was	O
ﬁrst	O
given	O
in	O
[	O
hartley-97a	O
]	O
,	O
where	O
further	O
experimental	O
results	O
of	B
estimation	I
using	O
both	O
point	O
and	O
line	B
correspon-	O
dences	O
on	O
real	O
data	O
are	O
reported	O
.	O
an	O
iterative	B
algebraic	O
method	O
for	O
estimating	O
a	O
consis-	O
tent	O
tensor	B
was	O
given	O
in	O
[	O
hartley-98d	O
]	O
.	O
torr	O
and	O
zisserman	O
[	O
torr-97	O
]	O
developed	O
an	O
automatic	O
algorithm	B
for	O
estimating	B
a	O
consistent	O
tensor	B
t	O
from	O
three	O
images	O
.	O
this	O
paper	O
also	O
compared	O
several	O
parametriza-	O
tions	O
of	O
the	O
iterative	O
minimization	B
.	O
several	O
methods	O
of	O
representing	O
and	O
imposing	O
the	O
constraints	B
on	O
the	O
tensor	B
are	O
given	O
by	O
faugeras	O
and	O
papadopoulo	O
[	O
faugeras-97	O
]	O
.	O
[	O
oskarsson-02	O
]	O
gives	O
minimal	O
solutions	O
for	O
reconstruction	O
for	O
the	O
two	O
cases	O
of	O
“	O
four	O
points	O
and	O
three	O
lines	B
in	O
three	O
views	O
”	O
,	O
and	O
“	O
two	O
points	O
and	O
six	O
lines	B
in	O
three	O
views	O
”	O
.	O
16.8.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
consider	O
the	O
problem	O
of	O
estimating	B
the	O
3-space	O
point	B
x	O
which	O
minimizes	O
re-	O
projection	B
error	O
from	O
measured	O
image	O
points	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
,	O
given	O
the	O
trifocal	B
tensor	I
.	O
this	O
is	O
the	O
analogue	O
of	O
the	O
triangulation	O
problem	O
of	O
chapter	O
12.	O
show	O
that	O
for	O
general	O
motion	O
the	O
one	O
parameter	O
family	O
parametrization	B
of	I
epipolar	O
lines	B
de-	O
veloped	O
in	O
chapter	O
12	O
does	O
not	O
extend	O
from	O
two	O
views	O
to	O
three	O
.	O
however	O
,	O
in	O
the	O
case	O
that	O
the	O
three	O
camera	B
centres	O
are	O
collinear	O
the	O
two-view	O
parametrization	B
can	O
be	O
extended	O
to	O
three	O
and	O
a	O
minimum	O
determined	O
by	O
solving	B
a	O
polynomial	O
in	O
one	O
variable	O
.	O
what	O
is	O
the	O
degree	O
of	O
this	O
polynomial	O
?	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
an	O
afﬁne	B
trifocal	O
tensor	B
may	O
be	O
computed	O
from	O
a	O
minimal	B
conﬁguration	I
of	O
4	O
points	O
in	O
general	B
position	I
.	O
the	O
computation	B
is	O
similar	O
to	O
that	O
of	O
algorithm	O
14.2-	O
(	O
p352	O
)	O
,	O
and	O
the	O
resulting	O
tensor	B
satisﬁes	O
the	O
internal	B
constraints	O
for	O
an	O
afﬁne	B
trifocal	O
tensor	B
.	O
how	O
many	O
constraints	B
are	O
there	O
in	O
the	O
afﬁne	B
case	O
?	O
if	O
more	O
than	O
4	O
point	B
correspondences	O
are	O
used	O
in	O
the	O
estimation	B
then	O
a	O
geo-	O
metrically	O
valid	O
tensor	B
is	O
estimated	O
using	O
the	O
factorization	B
algorithm	O
of	O
section	O
18.2	O
(	O
p436	O
)	O
.	O
(	O
iii	O
)	O
the	O
transformation	B
rule	I
for	O
tensors	O
is	O
t	O
jk	O
i	O
=	O
ar	O
i	O
(	O
b−1	O
)	O
j	O
s	O
(	O
c−1	O
)	O
k	O
t	O
ˆt	O
st	O
r	O
.	O
this	O
may	O
be	O
computed	O
easily	O
as	O
16.8	O
closure	O
407	O
binv	O
=	O
b.inverse	O
(	O
)	O
;	O
cinv	O
=	O
c.inverse	O
(	O
)	O
;	O
for	O
(	O
i=1	O
;	O
i	O
<	O
=3	O
;	O
i++	O
)	O
for	O
(	O
j=1	O
;	O
j	O
<	O
=3	O
;	O
j++	O
)	O
for	O
(	O
k=1	O
;	O
k	O
<	O
=3	O
;	O
k++	O
)	O
{	O
t	O
[	O
i	O
]	O
[	O
j	O
]	O
[	O
k	O
]	O
=	O
0.0	O
;	O
for	O
(	O
r=1	O
;	O
r	O
<	O
=3	O
;	O
r++	O
)	O
for	O
(	O
s=1	O
;	O
s	O
<	O
=3	O
;	O
s++	O
)	O
for	O
(	O
t=1	O
;	O
t	O
<	O
=3	O
;	O
t++	O
)	O
t	O
[	O
i	O
]	O
[	O
j	O
]	O
[	O
k	O
]	O
+=	O
a	O
[	O
r	O
]	O
[	O
i	O
]	O
*	O
binv	O
[	O
j	O
]	O
[	O
s	O
]	O
*	O
cinv	O
[	O
k	O
]	O
[	O
t	O
]	O
*	O
t_hat	O
[	O
r	O
]	O
[	O
s	O
]	O
[	O
t	O
]	O
;	O
}	O
how	O
many	O
multiplications	O
and	O
loop	O
iterations	O
does	O
this	O
involve	O
?	O
find	O
a	O
better	O
way	O
of	O
computing	O
this	O
transformation	B
.	O
(	O
iv	O
)	O
in	O
the	O
computation	B
of	I
tensor	O
using	O
plane	O
plus	O
parallax	B
(	O
section	O
16.7.1	O
)	O
,	O
show	O
that	O
if	O
ρ	O
is	O
the	O
projective	B
depth	I
of	O
one	O
of	O
the	O
points	O
off	O
the	O
plane	B
(	O
i.e	O
.	O
x	O
(	O
cid:2	O
)	O
see	O
(	O
13.9–p337	O
)	O
)	O
,	O
then	O
the	O
scalar	O
λ	O
in	O
(	O
16.5	O
)	O
may	O
be	O
computed	O
from	O
the	O
equation	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
h12x	O
+	O
ρe	O
(	O
cid:2	O
)	O
the	O
trifocal	B
=	O
h13x	O
+	O
ρλe	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
part	O
iv	O
n-view	O
geometry	O
untitled	O
1947	O
,	O
(	O
oil	O
on	O
sackcloth	O
)	O
by	O
asger	O
jorn	O
(	O
1914-1973	O
)	O
c	O
(	O
cid:4	O
)	O
2003	O
artists	O
rights	O
society	O
(	O
ars	O
)	O
,	O
new	O
york	O
/	O
copy-dan	O
,	O
copenhagen	O
outline	O
this	O
part	O
is	O
partly	O
a	O
recapitulation	O
and	O
partly	O
new	O
material	O
.	O
chapter	O
17	O
is	O
the	O
recapitulation	O
.	O
we	O
return	O
to	O
two-	O
and	O
three-view	O
geometry	O
but	O
now	O
within	O
a	O
more	O
general	O
framework	O
which	O
naturally	O
extends	O
to	O
four-	O
and	O
n-views	O
.	O
the	O
fundamental	O
projective	O
relations	O
over	O
multiple	O
views	O
arise	O
from	O
the	O
intersection	B
of	O
lines	B
(	O
back-projected	O
from	O
points	O
)	O
and	O
planes	O
(	O
back-	O
projected	O
from	O
lines	O
)	O
.	O
these	O
intersection	B
properties	O
are	O
represented	O
by	O
the	O
vanishing	O
of	O
determinants	O
formed	O
from	O
the	O
camera	B
matrices	I
of	O
the	O
views	O
.	O
the	O
fundamental	B
matrix	I
,	O
the	O
trifocal	B
tensor	I
,	O
and	O
a	O
new	O
tensor	B
for	O
four	O
views	O
–	O
the	O
quadrifocal	B
tensor	I
–	O
arise	O
naturally	O
from	O
these	O
determinants	O
as	O
the	O
multiple	O
view	O
tensors	O
for	O
two	O
,	O
three	O
,	O
and	O
four	O
views	O
respectively	O
.	O
the	O
tensors	O
are	O
what	O
remains	O
when	O
the	O
3d	O
structure	B
and	O
non-essential	O
part	O
of	O
the	O
camera	O
matrices	O
are	O
eliminated	O
.	O
the	O
tensors	O
stop	O
at	O
four	O
views	O
.	O
these	O
tensors	O
are	O
unique	O
for	O
each	O
set	O
of	O
views	O
,	O
and	O
generate	O
relationships	O
which	O
are	O
multi-linear	O
in	O
the	O
coordinates	B
of	O
the	O
image	O
measurements	O
.	O
the	O
tensors	O
can	O
be	O
computed	O
from	O
sets	O
of	O
image	O
correspon-	O
dences	O
,	O
and	O
subsequently	O
a	O
camera	B
matrix	I
for	O
each	O
view	O
can	O
be	O
computed	O
from	O
the	O
tensor	B
.	O
finally	O
,	O
the	O
3d	O
structure	B
can	O
be	O
computed	O
from	O
the	O
retrieved	O
cameras	B
and	O
image	O
correspondences	O
.	O
chapter	O
18	O
covers	O
the	O
computation	B
of	I
a	O
reconstruction	B
from	O
multiple	O
views	O
.	O
in	O
particular	O
the	O
impor-	O
tant	O
factorization	B
algorithm	O
is	O
given	O
for	O
reconstruction	O
from	O
afﬁne	O
views	O
.	O
it	O
is	O
important	O
because	O
the	O
algorithm	B
is	O
optimal	O
,	O
but	O
is	O
also	O
non-iterative	O
.	O
chapter	O
19	O
describes	O
the	O
auto-calibration	B
of	O
a	O
camera	B
.	O
these	O
are	O
a	O
set	O
of	O
methods	O
for	O
computing	O
the	O
internal	B
parameters	I
of	O
a	O
camera	B
based	O
on	O
constraints	O
over	O
multiple	O
images	O
.	O
in	O
contrast	O
to	O
the	O
traditional	O
approach	O
to	O
calibration	O
described	O
in	O
chapter	O
7	O
,	O
no	O
explicit	O
scene	O
calibration	O
object	O
is	O
used	O
,	O
but	O
simply	O
constraints	B
such	O
as	O
that	O
the	O
internal	B
parameters	I
are	O
common	O
across	O
the	O
images	O
,	O
or	O
that	O
the	O
camera	B
rotates	O
about	O
its	O
centre	B
and	O
does	O
not	O
change	O
aspect	O
ratio	O
.	O
chapter	O
20	O
emphasises	O
the	O
duality	B
between	O
points	O
and	O
cameras	B
,	O
and	O
how	O
this	O
links	O
various	O
conﬁgura-	O
tions	O
and	O
algorithms	O
that	O
have	O
been	O
given	O
throughout	O
this	O
book	O
.	O
this	O
chapter	O
contains	O
an	O
algorithm	B
for	O
computing	O
a	O
reconstruction	O
of	O
six	O
points	O
imaged	O
in	O
3-views	O
.	O
chapter	O
21	O
investigates	O
the	O
issue	O
of	O
whether	O
points	O
are	O
in	O
front	O
of	O
or	O
behind	O
one	O
or	O
more	O
cameras	O
.	O
this	O
is	O
an	O
issue	O
that	O
goes	O
beyond	O
the	O
homogeneous	B
representation	I
used	O
throughout	O
the	O
book	O
which	O
does	O
not	O
distinguish	O
the	O
direction	O
of	O
a	O
ray	O
.	O
chapter	O
22	O
covers	O
the	O
important	O
topic	O
of	O
those	O
conﬁgurations	O
for	O
which	O
the	O
estimation	B
algorithms	O
described	O
in	O
this	O
book	O
will	O
fail	O
.	O
an	O
example	O
is	O
for	B
resectioning	I
,	O
where	O
the	O
camera	B
matrix	I
can	O
not	O
be	O
computed	O
if	O
all	O
the	O
3d	O
points	O
and	O
the	O
camera	B
centre	I
lie	O
on	O
a	O
twisted	O
cubic	O
.	O
410	O
17	O
n	O
-linearities	O
and	O
multiple	O
view	O
tensors	O
this	O
chapter	O
introduces	O
the	O
quadrifocal	B
tensor	I
qijkl	O
between	O
four	O
views	O
,	O
which	O
is	O
the	O
analogue	O
of	O
the	O
fundamental	O
matrix	B
for	O
two	O
and	O
the	O
trifocal	B
tensor	I
for	O
three	O
views	O
.	O
the	O
quadrifocal	B
tensor	I
encapsulates	O
the	O
relationships	O
between	O
imaged	O
points	O
and	O
lines	B
seen	O
in	O
four	O
views	O
.	O
it	O
is	O
shown	O
that	O
multiple	O
view	O
relations	O
may	O
be	O
derived	O
directly	O
and	O
uniformly	O
from	O
the	O
intersection	B
properties	O
of	O
back-projected	O
lines	B
and	O
points	O
.	O
from	O
this	O
analysis	O
the	O
fundamental	B
matrix	I
f	O
,	O
trifocal	B
tensor	I
t	O
jk	O
,	O
and	O
quadrifocal	B
tensor	I
qijkl	O
appear	O
in	O
a	O
common	O
framework	O
involving	O
matrix	B
determinants	O
.	O
speciﬁc	O
formulae	O
are	O
given	O
for	O
each	O
of	O
these	O
tensors	O
in	O
terms	O
of	O
the	O
camera	O
matrices	O
.	O
i	O
we	O
also	O
develop	O
general	O
counting	O
arguments	O
for	O
the	O
degrees	B
of	I
freedom	I
of	O
the	O
tensors	O
and	O
the	O
number	O
of	O
point	O
and	O
line	B
correspondences	I
required	O
for	O
tensor	O
computation	B
.	O
these	O
are	O
given	O
for	O
conﬁgurations	O
in	O
general	O
position	O
and	O
for	O
the	O
important	O
special	O
case	O
where	O
four	O
or	O
more	O
of	O
the	O
elements	O
are	O
coplanar	O
.	O
17.1	O
bilinear	B
relations	O
we	O
consider	O
ﬁrst	O
the	O
relationship	O
that	O
holds	O
between	O
the	O
coordinates	B
of	O
a	O
point	B
seen	O
in	O
two	O
separate	O
views	O
.	O
thus	O
,	O
let	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
be	O
a	O
pair	O
of	O
corresponding	O
points	O
which	O
are	O
the	O
images	O
of	O
the	O
same	O
point	B
x	O
in	O
space	O
as	O
seen	O
in	O
the	O
two	O
separate	O
views	O
.	O
it	O
will	O
be	O
convenient	O
,	O
for	O
clarity	O
of	O
notation	O
,	O
to	O
represent	O
the	O
two	O
camera	O
matrices	O
by	O
a	O
and	O
b	O
,	O
instead	O
of	O
the	O
usual	O
notation	O
,	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
.	O
the	O
projection	B
from	O
space	O
to	O
image	O
can	O
now	O
be	O
expressed	O
as	O
kx	O
=	O
ax	O
and	O
k	O
are	O
two	O
undetermined	O
constants	O
.	O
this	O
pair	O
of	O
equations	O
may	O
be	O
written	O
down	O
as	O
one	O
equation	O
=	O
bx	O
where	O
k	O
and	O
k	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:17	O
)	O
a	O
x	O
0	O
b	O
0	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
	O
=	O
0	O
(	O
cid:18	O
)	O
	O
x−k−k	O
(	O
cid:2	O
)	O
and	O
it	O
may	O
easily	O
be	O
veriﬁed	O
that	O
this	O
is	O
equivalent	B
to	O
the	O
two	O
equations	O
.	O
this	O
can	O
be	O
written	O
in	O
a	O
more	O
detailed	O
form	O
by	O
denoting	O
the	O
i-th	O
row	O
of	O
the	O
matrix	B
a	O
by	O
ai	O
,	O
and	O
similarly	O
the	O
i-th	O
row	O
of	O
the	O
matrix	B
b	O
by	O
bi	O
.	O
we	O
also	O
write	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
and	O
411	O
412	O
x	O
(	O
cid:2	O
)	O
=	O
(	O
x	O
(	O
cid:2	O
)	O
1	O
,	O
x	O
(	O
cid:2	O
)	O
2	O
,	O
x	O
(	O
cid:2	O
)	O
3	O
)	O
t.	O
the	O
set	O
of	O
equations	O
is	O
now	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
	O
a1	O
x1	O
a2	O
x2	O
a3	O
x3	O
b1	O
b2	O
b3	O
(	O
cid:2	O
)	O
1	O
(	O
cid:2	O
)	O
2	O
(	O
cid:2	O
)	O
3	O
x	O
x	O
x	O
	O
	O
=	O
0	O
.	O
	O
x−k−k	O
(	O
cid:2	O
)	O
(	O
17.1	O
)	O
(	O
cid:2	O
)	O
now	O
,	O
this	O
is	O
a	O
6	O
×	O
6	O
set	O
of	O
equations	O
which	O
by	O
hypothesis	O
has	O
a	O
non-zero	O
solution	O
,	O
the	O
vector	O
(	O
xt	O
,	O
−k	O
,	O
−k	O
)	O
t.	O
it	O
follows	O
that	O
the	O
matrix	B
of	O
coefﬁcients	O
in	O
(	O
17.1	O
)	O
must	O
have	O
zero	O
determinant	O
.	O
it	O
will	O
be	O
seen	O
that	O
this	O
condition	O
leads	O
to	O
a	O
bilinear	B
relationship	O
between	O
the	O
entries	O
of	O
the	O
vectors	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
expressed	O
by	O
the	O
fundamental	B
matrix	I
f.	O
we	O
will	O
now	O
look	O
speciﬁcally	O
at	O
the	O
form	B
of	I
this	O
relationship	O
.	O
consider	O
the	O
matrix	B
appearing	O
in	O
(	O
17.1	O
)	O
.	O
denote	O
it	O
by	O
x.	O
the	O
determinant	O
of	O
x	O
may	O
(	O
cid:2	O
)	O
i.	O
notice	O
that	O
the	O
entries	O
(	O
cid:2	O
)	O
i	O
appear	O
in	O
only	O
two	O
columns	O
of	O
x.	O
this	O
implies	O
that	O
the	O
determinant	O
of	O
x	O
may	O
(	O
cid:2	O
)	O
i.	O
in	O
fact	O
,	O
since	O
all	O
the	O
(	O
cid:2	O
)	O
j	O
.	O
(	O
cid:2	O
)	O
ix	O
(	O
cid:2	O
)	O
i	O
,	O
the	O
determinant	O
of	O
x	O
is	O
a	O
bilinear	B
expression	O
.	O
the	O
be	O
written	O
as	O
an	O
expression	O
in	O
terms	O
of	O
the	O
quantities	O
xi	O
and	O
x	O
xi	O
and	O
x	O
be	O
expressed	O
as	O
a	O
quadratic	O
expression	O
in	O
terms	O
of	O
the	O
xi	O
and	O
x	O
entries	O
xi	O
appear	O
in	O
the	O
same	O
column	O
,	O
there	O
can	O
be	O
no	O
terms	O
of	O
the	O
form	O
xixj	O
or	O
x	O
brieﬂy	O
,	O
in	O
terms	O
of	O
the	O
xi	O
and	O
x	O
fact	O
that	O
the	O
determinant	O
is	O
zero	O
may	O
be	O
written	O
as	O
an	O
equation	O
(	O
cid:2	O
)	O
ixjfij	O
=	O
0	O
(	O
cid:2	O
)	O
3	O
)	O
f	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t	O
=	O
x	O
where	O
f	O
is	O
a	O
3	O
×	O
3	O
matrix	B
,	O
the	O
fundamental	B
matrix	I
.	O
we	O
may	O
compute	O
a	O
speciﬁc	O
formula	O
for	O
the	O
entries	O
of	O
the	O
matrix	O
f	O
as	O
follows	O
.	O
the	O
(	O
cid:2	O
)	O
ixj	O
in	O
the	O
expansion	O
of	O
the	O
determinant	O
entry	O
fij	O
of	O
f	O
is	O
the	O
coefﬁcient	O
of	O
the	O
term	O
x	O
of	O
x.	O
in	O
order	O
to	O
ﬁnd	O
this	O
coefﬁcient	O
,	O
we	O
must	O
eliminate	O
the	O
rows	O
and	O
columns	O
of	O
the	O
(	O
cid:2	O
)	O
i	O
and	O
xj	O
,	O
take	O
the	O
determinant	O
of	O
the	O
resulting	O
matrix	B
and	O
multiply	O
matrix	B
containing	O
x	O
by	O
±1	O
as	O
appropriate	O
.	O
for	O
instance	O
,	O
the	O
coefﬁcient	O
of	O
x	O
(	O
cid:2	O
)	O
1x1	O
is	O
obtained	O
by	O
eliminating	O
two	O
rows	O
and	O
the	O
last	O
two	O
columns	O
of	O
the	O
matrix	O
x.	O
the	O
remaining	O
matrix	B
is	O
(	O
cid:2	O
)	O
2	O
,	O
x	O
(	O
cid:2	O
)	O
1	O
,	O
x	O
(	O
17.2	O
)	O
(	O
x	O
	O
	O
a2	O
a3	O
b2	O
b3	O
(	O
cid:2	O
)	O
1x1	O
is	O
equal	O
to	O
the	O
determinant	O
of	O
this	O
4	O
×	O
4	O
matrix	B
.	O
in	O
general	O
,	O
and	O
the	O
coefﬁcient	O
of	O
x	O
we	O
may	O
write	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
∼ai	O
∼bj	O
fji	O
=	O
(	O
−1	O
)	O
i+j	O
det	O
(	O
17.3	O
)	O
in	O
this	O
expression	O
,	O
the	O
notation	O
∼ai	O
has	O
been	O
used	O
to	O
denote	O
the	O
matrix	B
obtained	O
from	O
a	O
by	O
omitting	O
the	O
row	O
ai	O
.	O
thus	O
the	O
symbol	O
∼	O
may	O
be	O
read	O
as	O
omit	O
,	O
and	O
∼ai	O
represents	O
two	O
rows	O
of	O
a.	O
the	O
determinant	O
appearing	O
on	O
the	O
right	O
side	O
of	O
(	O
17.3	O
)	O
is	O
therefore	O
a	O
4×	O
4	O
determinant	O
.	O
.	O
a	O
different	O
way	O
of	O
writing	O
the	O
expression	O
for	O
fji	O
makes	O
use	O
of	O
the	O
tensor	B
rst	O
(	O
deﬁned	O
17.1	O
bilinear	B
relations	O
413	O
in	O
section	O
a1.1	O
(	O
p563	O
)	O
)	O
as	O
follows:1	O
(	O
cid:28	O
)	O
fji	O
=	O
(	O
cid:29	O
)	O
1	O
4	O
ipqjrs	O
det	O
	O
.	O
	O
ap	O
aq	O
br	O
bs	O
(	O
17.4	O
)	O
to	O
see	O
this	O
,	O
note	O
that	O
fji	O
is	O
deﬁned	O
in	O
(	O
17.4	O
)	O
in	O
terms	O
of	O
a	O
sum	O
of	O
determinants	O
over	O
all	O
values	O
of	O
p	O
,	O
q	O
,	O
r	O
and	O
s.	O
however	O
,	O
for	O
a	O
given	O
value	O
of	O
i	O
,	O
the	O
tensor	B
ipq	O
is	O
zero	O
unless	O
p	O
and	O
q	O
are	O
different	O
from	O
i	O
and	O
from	O
each	O
other	O
.	O
this	O
leaves	O
only	O
two	O
remaining	O
choices	O
of	O
p	O
and	O
q	O
(	O
for	O
example	O
if	O
i	O
=	O
1	O
,	O
then	O
we	O
may	O
choose	O
p	O
=	O
2	O
,	O
q	O
=	O
3	O
or	O
p	O
=	O
3	O
,	O
q	O
=	O
2	O
)	O
.	O
similarly	O
,	O
there	O
are	O
only	O
two	O
different	O
choices	O
of	O
r	O
and	O
s	O
giving	O
rise	O
to	O
non-zero	O
terms	O
.	O
thus	O
the	O
sum	O
consists	O
of	O
four	O
non-zero	O
terms	O
only	O
.	O
furthermore	O
,	O
the	O
determinants	O
appearing	O
in	O
these	O
four	O
terms	O
consist	O
of	O
the	O
same	O
four	O
rows	O
of	O
the	O
matrices	O
a	O
and	O
b	O
and	O
hence	O
have	O
equal	O
values	O
,	O
except	O
for	O
sign	O
.	O
however	O
,	O
the	O
value	O
of	O
ipqjrs	O
is	O
such	O
that	O
the	O
four	O
terms	O
all	O
have	O
the	O
same	O
sign	O
and	O
are	O
equal	O
.	O
thus	O
,	O
the	O
sum	O
(	O
17.4	O
)	O
is	O
equal	O
to	O
the	O
single	O
term	O
appearing	O
in	O
(	O
17.3	O
)	O
.	O
17.1.1	O
epipoles	B
as	O
tensors	O
the	O
expression	O
(	O
17.3	O
)	O
for	O
the	O
fundamental	B
matrix	I
involves	O
determinants	O
of	O
matrices	O
containing	O
two	O
rows	O
from	O
each	O
of	O
a	O
and	O
b.	O
if	O
we	O
consider	O
instead	O
the	O
determinants	O
of	O
matrices	O
containing	O
all	O
three	O
rows	O
from	O
one	O
matrix	B
and	O
one	O
row	O
from	O
the	O
other	O
matrix	B
,	O
the	O
resulting	O
determinants	O
represent	O
the	O
epipoles	B
.	O
speciﬁcally	O
we	O
have	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
ei	O
=	O
det	O
(	O
cid:2	O
)	O
j	O
=	O
det	O
e	O
a	O
bj	O
(	O
17.5	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
ai	O
b	O
where	O
e	O
and	O
e	O
(	O
cid:2	O
)	O
are	O
the	O
epipoles	B
in	O
the	O
two	O
images	O
.	O
to	O
see	O
this	O
,	O
note	O
that	O
the	O
epipole	O
is	O
deﬁned	O
by	O
ei	O
=	O
aic	O
(	O
cid:2	O
)	O
=	O
0.	O
the	O
formula	O
(	O
17.5	O
)	O
is	O
now	O
obtained	O
by	O
expanding	O
the	O
determinant	O
by	O
cofactors	O
along	O
the	O
ﬁrst	O
row	O
(	O
in	O
a	O
similar	O
manner	O
to	O
the	O
derivation	B
of	O
(	O
3.4–p67	O
)	O
)	O
.	O
is	O
the	O
centre	B
of	O
the	O
second	O
camera	B
,	O
deﬁned	O
by	O
bc	O
(	O
cid:2	O
)	O
,	O
where	O
c	O
(	O
cid:2	O
)	O
17.1.2	O
afﬁne	B
specialization	O
in	O
the	O
case	O
where	O
both	O
the	O
cameras	B
are	O
afﬁne	B
cameras	I
,	O
the	O
fundamental	B
matrix	I
has	O
a	O
particularly	O
simple	O
form	O
.	O
recall	O
that	O
an	O
afﬁne	B
camera	I
matrix	O
is	O
one	O
for	O
which	O
the	O
ﬁnal	O
row	O
is	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
now	O
,	O
note	O
from	O
(	O
17.3	O
)	O
that	O
if	O
neither	O
i	O
nor	O
j	O
is	O
equal	O
to	O
3	O
,	O
then	O
the	O
third	O
rows	O
of	O
both	O
a	O
and	O
b	O
are	O
present	O
in	O
this	O
expression	O
for	O
fij	O
.	O
the	O
determinant	O
has	O
two	O
equal	O
rows	O
,	O
and	O
hence	O
equals	O
zero	O
.	O
thus	O
,	O
f	O
is	O
of	O
the	O
form	O
	O
fa	O
=	O
a	O
b	O
c	O
d	O
e	O
	O
1	O
of	O
course	O
the	O
factor	O
1/4	O
is	O
inessential	O
since	O
f	O
is	O
deﬁned	O
only	O
up	O
to	O
scale	O
.	O
it	O
is	O
included	O
here	O
just	O
to	O
show	O
the	O
relationship	O
to	O
(	O
17.3	O
)	O
.	O
414	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
with	O
all	O
other	O
entries	O
being	O
zero	O
.	O
thus	O
the	O
afﬁne	B
fundamental	I
matrix	I
has	O
just	O
5	O
non-	O
zero	O
entries	O
,	O
and	O
hence	O
4	O
degrees	B
of	I
freedom	I
.	O
its	O
properties	B
are	O
described	O
in	O
section	O
14.2	O
(	O
p345	O
)	O
.	O
note	O
that	O
this	O
argument	O
relies	O
solely	O
on	O
the	O
fact	O
that	O
both	O
cameras	O
have	O
the	O
same	O
third	O
row	O
.	O
since	O
the	O
third	O
row	O
of	O
a	O
camera	B
matrix	I
represents	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
(	O
see	O
section	O
6.2.1	O
(	O
p158	O
)	O
)	O
,	O
it	O
follows	O
that	O
the	O
fundamental	B
matrix	I
for	O
two	O
cameras	O
sharing	O
the	O
same	O
principal	O
plane	B
is	O
of	O
the	O
above	O
form	O
.	O
17.2	O
trilinear	B
relations	O
the	O
determinant	O
method	O
of	O
deriving	O
the	O
fundamental	B
matrix	I
can	O
be	O
used	O
to	O
derive	O
rela-	O
tionships	O
between	O
the	O
coordinates	B
of	O
points	O
seen	O
in	O
three	O
views	O
.	O
this	O
analysis	O
results	O
in	O
a	O
formula	O
for	O
the	O
trifocal	B
tensor	I
.	O
unlike	O
the	O
fundamental	B
matrix	I
,	O
the	O
trifocal	B
tensor	I
re-	O
lates	O
both	O
lines	O
and	O
points	O
in	O
the	O
three	O
images	O
.	O
we	O
begin	O
by	O
describing	O
the	O
relationships	O
for	O
corresponding	O
points	O
.	O
17.2.1	O
trifocal	B
point	O
relations	O
consider	O
a	O
point	B
correspondence	O
across	O
three	O
views	O
:	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
let	O
the	O
third	O
camera	B
matrix	I
be	O
c	O
and	O
let	O
ci	O
be	O
its	O
i-th	O
row	O
.	O
analogous	O
to	O
(	O
17.1	O
)	O
we	O
can	O
write	O
an	O
equation	O
describing	O
the	O
projection	B
of	O
a	O
point	B
x	O
into	O
the	O
three	O
images	O
as	O
	O
a	O
x	O
b	O
c	O
x	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
	O
=	O
0	O
.	O
	O
	O
x−k−k	O
−k	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
17.6	O
)	O
(	O
17.7	O
)	O
this	O
matrix	B
,	O
which	O
as	O
before	O
we	O
will	O
call	O
x	O
,	O
has	O
9	O
rows	O
and	O
7	O
columns	O
.	O
from	O
the	O
existence	O
of	O
a	O
solution	O
to	O
this	O
set	O
of	O
equations	O
,	O
we	O
deduce	O
that	O
its	O
rank	O
must	O
be	O
at	O
most	O
6.	O
hence	O
any	O
7	O
×	O
7	O
minor	O
has	O
zero	O
determinant	O
.	O
this	O
fact	O
gives	O
rise	O
to	O
the	O
trilinear	B
relationships	O
that	O
hold	O
between	O
the	O
coordinates	B
of	O
the	O
points	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
there	O
are	O
essentially	O
two	O
different	O
types	O
of	O
7	O
×	O
7	O
minors	O
of	O
x.	O
in	O
choosing	O
7	O
rows	O
of	O
x	O
,	O
we	O
may	O
choose	O
either	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
(	O
i	O
)	O
three	O
rows	O
from	O
each	O
of	O
two	O
camera	B
matrices	I
and	O
one	O
row	O
from	O
the	O
third	O
,	O
or	O
(	O
ii	O
)	O
three	O
rows	O
from	O
one	O
camera	B
matrix	I
and	O
two	O
rows	O
from	O
each	O
of	O
the	O
two	O
others	O
.	O
let	O
us	O
consider	O
the	O
ﬁrst	O
type	O
.	O
a	O
typical	O
such	O
7	O
×	O
7	O
minor	O
of	O
x	O
is	O
of	O
the	O
form	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i.	O
expanding	O
note	O
that	O
this	O
matrix	B
contains	O
only	O
one	O
entry	O
in	O
the	O
last	O
column	O
,	O
namely	O
x	O
the	O
determinant	O
by	O
cofactors	O
down	O
this	O
last	O
column	O
reveals	O
that	O
the	O
determinant	O
is	O
equal	O
to	O
(	O
cid:17	O
)	O
	O
a	O
x	O
b	O
ci	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
x	O
	O
.	O
(	O
cid:18	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
det	O
x	O
a	O
x	O
b	O
x	O
(	O
cid:2	O
)	O
.	O
17.2	O
trilinear	B
relations	O
415	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
this	O
just	O
leads	O
to	O
the	O
bilinear	B
relationship	O
expressed	O
by	O
the	O
apart	O
from	O
the	O
factor	O
x	O
fundamental	B
matrix	I
,	O
as	O
discussed	O
in	O
section	O
17.1.	O
the	O
other	O
sort	O
of	O
7	O
×	O
7	O
minor	O
is	O
of	O
more	O
interest	O
.	O
an	O
example	O
of	O
such	O
a	O
determinant	O
is	O
of	O
the	O
form	O
	O
det	O
(	O
cid:2	O
)	O
j	O
x	O
(	O
cid:2	O
)	O
l	O
x	O
a	O
x	O
bj	O
bl	O
ck	O
cm	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
m	O
x	O
by	O
the	O
same	O
sort	O
of	O
argument	O
as	O
with	O
the	O
bilinear	B
relations	O
it	O
is	O
seen	O
that	O
setting	O
the	O
determinant	O
to	O
zero	O
leads	O
to	O
a	O
trilinear	B
relation	O
of	O
the	O
form	O
f	O
(	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
)	O
=	O
0.	O
by	O
ex-	O
panding	O
this	O
determinant	O
down	O
the	O
column	O
containing	O
xi	O
,	O
we	O
can	O
ﬁnd	O
a	O
speciﬁc	O
formula	O
as	O
follows	O
.	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
	O
.	O
am	O
bq	O
cr	O
	O
al	O
	O
.	O
	O
=	O
0uv	O
(	O
17.8	O
)	O
(	O
17.9	O
)	O
(	O
17.10	O
)	O
(	O
17.11	O
)	O
(	O
17.12	O
)	O
where	O
u	O
and	O
v	O
are	O
free	O
indices	O
corresponding	O
to	O
the	O
rows	O
omitted	O
from	O
the	O
matrices	O
b	O
and	O
c	O
to	O
produce	O
(	O
17.8	O
)	O
.	O
we	O
introduce	O
the	O
tensor	B
det	O
xuv	O
=	O
−1	O
2	O
(	O
cid:2	O
)	O
jx	O
xix	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kilmjqukrv	O
det	O
	O
al	O
am	O
bq	O
cr	O
t	O
qr	O
i	O
=	O
1	O
2	O
ilm	O
det	O
the	O
trilinear	B
relationship	O
(	O
17.9	O
)	O
may	O
then	O
be	O
written	O
(	O
cid:2	O
)	O
jx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kjqukrvt	O
qr	O
xix	O
i	O
=	O
0uv	O
.	O
i	O
the	O
tensor	B
t	O
qr	O
is	O
the	O
trifocal	B
tensor	I
,	O
and	O
(	O
17.11	O
)	O
is	O
a	O
trilinear	B
relation	O
such	O
as	O
those	O
discussed	O
in	O
section	O
15.2.1	O
(	O
p378	O
)	O
.	O
the	O
indices	O
u	O
and	O
v	O
are	O
free	O
indices	O
,	O
and	O
each	O
choice	B
of	O
u	O
and	O
v	O
leads	O
to	O
a	O
different	O
trilinear	B
relation	O
.	O
just	O
as	O
in	O
the	O
case	O
of	O
the	O
fundamental	O
matrix	B
,	O
one	O
may	O
write	O
the	O
formula	O
for	O
the	O
tensor	B
t	O
qr	O
in	O
a	O
slightly	O
different	O
way	O
i	O
t	O
qr	O
i	O
=	O
(	O
−1	O
)	O
i+1	O
det	O
	O
.	O
	O
∼ai	O
bq	O
cr	O
as	O
in	O
section	O
17.1	O
,	O
the	O
expression	O
∼ai	O
means	O
the	O
matrix	B
a	O
with	O
row	O
i	O
omitted	O
.	O
note	O
that	O
we	O
omit	O
row	O
i	O
from	O
the	O
ﬁrst	O
camera	B
matrix	I
,	O
but	O
include	O
rows	O
q	O
and	O
r	O
from	O
the	O
other	O
two	O
camera	O
matrices	O
.	O
in	O
the	O
often-considered	O
case	O
where	O
the	O
ﬁrst	O
camera	B
matrix	I
a	O
has	O
the	O
canonical	B
form	I
[	O
i	O
|	O
0	O
]	O
,	O
the	O
expression	O
(	O
17.12	O
)	O
for	O
the	O
trifocal	B
tensor	I
may	O
be	O
written	O
simply	O
as	O
t	O
qr	O
i	O
=	O
bq	O
i	O
cr	O
4	O
−	O
bq	O
4cr	O
i	O
.	O
(	O
17.13	O
)	O
416	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
note	O
that	O
there	O
are	O
in	O
fact	O
27	O
possible	O
trilinear	B
relations	O
that	O
may	O
be	O
formed	O
in	O
this	O
way	O
(	O
refer	O
to	O
(	O
17.8	O
)	O
)	O
.	O
speciﬁcally	O
,	O
note	O
that	O
each	O
relation	B
arises	O
from	O
taking	O
all	O
three	O
rows	O
from	O
one	O
camera	B
matrix	I
along	O
with	O
two	O
rows	O
from	O
each	O
of	O
the	O
other	O
two	O
matrices	O
.	O
this	O
gives	O
the	O
following	O
computation	B
.	O
•	O
3	O
ways	O
to	O
choose	O
the	O
ﬁrst	O
camera	B
matrix	I
from	O
which	O
to	O
take	O
all	O
three	O
rows	O
.	O
•	O
3	O
ways	O
to	O
choose	O
the	O
row	O
to	O
omit	O
from	O
the	O
second	O
camera	B
matrix	I
.	O
•	O
3	O
ways	O
to	O
choose	O
the	O
row	O
to	O
omit	O
from	O
the	O
third	O
camera	B
matrix	I
.	O
this	O
gives	O
a	O
total	O
of	O
27	O
trilinear	B
relations	O
.	O
however	O
,	O
among	O
the	O
9	O
ways	O
of	O
choosing	O
two	O
rows	O
from	O
the	O
second	O
and	O
third	O
camera	B
matrices	I
,	O
only	O
4	O
are	O
linearly	O
independent	O
(	O
we	O
return	O
to	O
this	O
in	O
section	O
17.6	O
)	O
.	O
this	O
means	O
that	O
there	O
are	O
a	O
total	O
of	O
12	O
linearly	O
independent	O
trilinear	B
relations	O
.	O
it	O
is	O
important	O
to	O
distinguish	O
between	O
the	O
number	O
of	O
trilinear	O
relations	O
,	O
however	O
,	O
and	O
the	O
number	O
of	O
different	O
trifocal	B
tensors	O
.	O
as	O
is	O
shown	O
by	O
(	O
17.11	O
)	O
,	O
several	O
different	O
trilinear	B
relations	O
may	O
be	O
expressed	O
in	O
terms	O
of	O
just	O
one	O
trifocal	B
tensor	I
.	O
in	O
(	O
17.11	O
)	O
each	O
distinct	O
choice	B
of	O
the	O
free	O
indices	O
u	O
and	O
v	O
gives	O
rise	O
to	O
a	O
different	O
trilinear	B
relation	O
,	O
all	O
of	O
which	O
are	O
expressible	O
in	O
terms	O
of	O
the	O
same	O
trifocal	B
tensor	I
t	O
qr	O
.	O
on	O
the	O
other	O
hand	O
,	O
in	O
the	O
deﬁnition	B
of	O
the	O
trifocal	B
tensor	I
given	O
in	O
(	O
17.10	O
)	O
,	O
the	O
camera	B
matrix	I
a	O
is	O
treated	O
differently	O
from	O
the	O
other	O
two	O
,	O
in	O
that	O
a	O
contributes	O
two	O
rows	O
(	O
after	O
omitting	O
row	O
i	O
)	O
to	O
the	O
determinant	O
deﬁning	O
any	O
given	O
entry	O
of	O
t	O
qr	O
,	O
whereas	O
the	O
other	O
two	O
camera	O
matrices	O
contribute	O
just	O
one	O
row	O
.	O
this	O
means	O
that	O
there	O
are	O
in	O
fact	O
three	O
different	O
trifocal	B
tensors	O
corresponding	O
to	O
the	O
choice	B
of	O
which	O
of	O
the	O
three	O
camera	B
matrices	I
contributes	O
two	O
rows	O
.	O
i	O
i	O
17.2.2	O
trifocal	B
line	O
relations	O
a	O
line	B
in	O
an	O
image	O
is	O
represented	O
by	O
a	O
covariant	O
vector	O
li	O
,	O
and	O
the	O
condition	O
for	O
a	O
point	B
x	O
to	O
lie	O
on	O
the	O
line	B
is	O
that	O
lixi	O
=	O
0.	O
let	O
xj	O
represent	O
a	O
point	B
x	O
in	O
space	O
,	O
and	O
ai	O
j	O
represent	O
a	O
camera	B
matrix	I
a.	O
the	O
3d	O
point	B
xj	O
is	O
mapped	O
to	O
the	O
image	O
point	O
as	O
xi	O
=	O
ai	O
j	O
xj	O
.	O
it	O
follows	O
that	O
the	O
condition	O
for	O
the	O
point	B
xj	O
to	O
project	O
to	O
a	O
point	B
on	O
the	O
line	B
li	O
is	O
that	O
j	O
represents	O
a	O
plane	B
consisting	O
of	O
liai	O
all	O
points	O
that	O
project	O
onto	O
the	O
line	B
li	O
.	O
j	O
xj	O
=	O
0.	O
another	O
way	O
of	O
looking	O
at	O
this	O
is	O
that	O
liai	O
consider	O
the	O
situation	O
where	O
a	O
point	B
xj	O
maps	O
to	O
a	O
point	B
xi	O
in	B
one	I
image	I
and	O
to	O
some	O
(	O
cid:2	O
)	O
q	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
in	O
two	O
other	O
images	O
.	O
this	O
may	O
be	O
expressed	O
by	O
equations	O
point	B
on	O
lines	B
l	O
xi	O
=	O
kai	O
j	O
xj	O
(	O
cid:2	O
)	O
qbq	O
l	O
j	O
xj	O
=	O
0	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
cr	O
l	O
j	O
xj	O
=	O
0.	O
these	O
may	O
be	O
written	O
as	O
a	O
single	O
matrix	O
equation	O
of	O
the	O
form	O
	O
a	O
x	O
(	O
cid:2	O
)	O
bq	O
0	O
l	O
q	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
cr	O
0	O
l	O
r	O
(	O
cid:20	O
)	O
	O
(	O
cid:21	O
)	O
x−k	O
=	O
0	O
.	O
(	O
17.14	O
)	O
since	O
this	O
set	O
of	O
equations	O
has	O
a	O
solution	B
,	O
it	O
follows	O
that	O
det	O
x	O
=	O
0	O
,	O
where	O
x	O
is	O
the	O
matrix	B
on	O
the	O
left	O
of	O
the	O
equation	O
.	O
expanding	O
this	O
determinant	O
down	O
the	O
last	O
column	O
gives	O
0	O
=	O
−	O
det	O
x	O
=	O
1	O
2	O
xiilm	O
det	O
17.2	O
trilinear	B
relations	O
	O
=	O
	O
al	O
am	O
(	O
cid:2	O
)	O
bq	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
q	O
cr	O
l	O
r	O
417	O
	O
	O
al	O
am	O
bq	O
cr	O
(	O
cid:2	O
)	O
ql	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
ilm	O
det	O
xil	O
1	O
2	O
t	O
qr	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
r	O
i	O
.	O
=	O
xil	O
(	O
17.15	O
)	O
(	O
cid:2	O
)	O
this	O
shows	O
the	O
connection	O
of	O
the	O
trifocal	B
tensor	I
with	O
sets	O
of	B
lines	I
.	O
the	O
two	O
lines	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
q	O
and	O
l	O
r	O
back-project	O
to	O
planes	O
meeting	O
in	O
a	O
line	B
in	O
space	O
.	O
the	O
image	O
of	O
this	O
line	B
in	O
the	O
ﬁrst	O
image	O
is	O
a	O
line	B
,	O
which	O
may	O
be	O
represented	O
by	O
li	O
.	O
for	O
any	O
point	B
xi	O
on	O
that	O
line	B
the	O
relation	B
(	O
17.15	O
)	O
holds	O
.	O
it	O
follows	O
that	O
l	O
is	O
the	O
representation	B
of	O
the	O
line	B
li	O
.	O
thus	O
,	O
we	O
see	O
that	O
for	O
three	O
corresponding	O
lines	B
in	O
the	O
three	O
images	O
t	O
qr	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
r	O
i	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
r	O
t	O
qr	O
p	O
lp	O
=	O
l	O
(	O
17.16	O
)	O
(	O
17.17	O
)	O
(	O
17.18	O
)	O
where	O
,	O
of	O
course	O
,	O
the	O
two	O
sides	O
are	O
equal	O
only	O
up	O
to	O
a	O
scale	O
factor	O
.	O
since	O
the	O
two	O
sides	O
of	O
the	O
relation	O
(	O
17.16	O
)	O
are	O
vectors	O
,	O
this	O
may	O
be	O
interpreted	O
as	O
meaning	O
that	O
the	O
vector	O
product	O
of	O
the	O
two	O
sides	O
vanishes	O
.	O
expressing	O
this	O
vector	O
product	O
using	O
the	O
tensor	B
ijk	O
,	O
we	O
arrive	O
at	O
an	O
equation	O
r	O
ipwt	O
qr	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
i	O
=	O
0w	O
.	O
lpl	O
in	O
an	O
analogous	O
manner	O
to	O
the	O
derivation	B
of	O
(	O
17.11	O
)	O
and	O
(	O
17.15	O
)	O
we	O
may	O
derive	O
a	O
relationship	O
between	O
corresponding	O
points	O
in	O
two	O
images	O
and	O
a	O
line	B
in	O
a	O
third	O
image	O
.	O
(	O
cid:2	O
)	O
j	O
in	O
the	O
ﬁrst	O
two	O
images	O
,	O
in	O
particular	O
,	O
if	O
a	O
point	B
xj	O
in	O
space	O
maps	O
to	O
points	O
xi	O
and	O
x	O
and	O
to	O
some	O
point	B
on	O
a	O
line	B
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
in	O
the	O
third	O
image	O
,	O
then	O
the	O
relation	B
is	O
r	O
jqut	O
qr	O
(	O
cid:2	O
)	O
jl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
xix	O
i	O
=	O
0u	O
.	O
in	O
this	O
relation	B
,	O
the	O
index	O
u	O
is	O
free	O
,	O
and	O
there	O
is	O
one	O
such	O
relation	B
for	O
each	O
choice	B
of	O
u	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
,	O
of	O
which	O
two	O
are	O
linearly	O
independent	O
.	O
we	O
summarize	O
the	O
results	O
of	O
this	O
section	O
in	O
table	O
17.1	O
,	O
where	O
the	O
ﬁnal	O
column	O
denotes	O
the	O
number	O
of	O
linearly	O
independent	O
equations	O
.	O
correspondence	B
three	O
points	O
two	O
points	O
,	O
one	O
line	B
one	O
point	B
,	O
two	O
lines	O
xix	O
i	O
=	O
0uv	O
relation	B
(	O
cid:1	O
)	O
jx	O
xix	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
kjqukrvt	O
qr	O
r	O
jqut	O
qr	O
(	O
cid:1	O
)	O
jl	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
rt	O
qr	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
xil	O
ql	O
r	O
piwt	O
qr	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
i	O
=	O
0	O
i	O
=	O
0w	O
i	O
=	O
0u	O
(	O
cid:1	O
)	O
ql	O
number	O
of	O
equations	O
4	O
2	O
1	O
2	O
three	O
lines	B
lpl	O
table	O
17.1.	O
trilinear	B
relations	O
(	O
see	O
also	O
table	O
16.1	O
(	O
p391	O
)	O
)	O
.	O
note	O
how	O
the	O
different	O
equation	O
sets	O
are	O
related	O
to	O
each	O
other	O
.	O
for	O
instance	O
,	O
the	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
and	O
second	O
line	B
of	O
the	O
table	O
is	O
derived	O
from	O
the	O
ﬁrst	O
by	O
replacing	O
x	O
deleting	O
the	O
free	O
index	O
v.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kkrv	O
by	O
the	O
line	B
l	O
418	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
17.2.3	O
relations	O
between	O
two	O
views	O
and	O
the	O
trifocal	B
tensor	I
(	O
cid:2	O
)	O
j	O
and	O
x	O
(	O
cid:2	O
)	O
j	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kjqukrvt	O
qr	O
(	O
cid:2	O
)	O
jx	O
to	O
this	O
point	B
we	O
have	O
considered	O
correspondences	B
across	O
three	O
views	O
and	O
the	O
trifo-	O
cal	O
tensor	B
.	O
here	O
we	O
describe	O
the	O
constraints	B
that	O
arise	O
if	O
the	O
correspondence	B
is	O
only	O
across	O
two	B
views	I
.	O
from	O
the	O
two	O
view	O
case	O
,	O
where	O
point	B
correspondences	O
constrain	O
the	O
fundamental	B
matrix	I
,	O
we	O
would	O
expect	O
some	O
constraint	O
on	O
t	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
in	O
the	O
second	O
and	O
third	O
images	O
.	O
consider	O
the	O
case	O
of	O
corresponding	O
points	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k.	O
the	O
point	B
this	O
means	O
that	O
there	O
is	O
a	O
point	B
x	O
in	O
space	O
mapping	O
to	O
the	O
points	O
x	O
x	O
also	O
maps	O
to	O
some	O
point	B
xi	O
in	O
the	O
ﬁrst	O
image	O
,	O
but	O
xi	O
is	O
not	O
known	O
.	O
nevertheless	O
,	O
there	O
(	O
cid:2	O
)	O
jx	O
exists	O
a	O
relationship	O
xix	O
i	O
=	O
0uv	O
between	O
these	O
points	O
.	O
for	O
each	O
choice	B
of	O
u	O
and	O
v	O
,	O
denote	O
ai	O
,	O
uv	O
=	O
x	O
.	O
the	O
entries	O
of	O
ai	O
,	O
uv	O
are	O
linear	B
expressions	O
in	O
the	O
entries	O
of	O
t	O
qr	O
(	O
cid:2	O
)	O
j	O
that	O
may	O
be	O
determined	O
explicitly	O
in	O
terms	O
of	O
the	O
known	O
points	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k.	O
there	O
exists	O
a	O
point	B
x	O
such	O
that	O
xiai	O
,	O
uv	O
=	O
0.	O
for	O
each	O
choice	B
of	O
u	O
,	O
v	O
we	O
may	O
and	O
x	O
consider	O
ai	O
,	O
uv	O
as	O
being	O
a	O
3-vector	O
indexed	O
by	O
i	O
,	O
and	O
for	O
the	O
different	O
choices	O
of	O
u	O
and	O
v	O
,	O
there	O
are	O
4	O
linearly	O
independent	O
such	O
expressions	O
.	O
thus	O
,	O
a	O
may	O
be	O
considered	O
as	O
a	O
3×4	O
matrix	B
,	O
and	O
the	O
condition	O
that	O
xiai	O
,	O
uv	O
=	O
0	O
means	O
that	O
ai	O
,	O
uv	O
has	O
rank	O
2.	O
this	O
means	O
that	O
every	O
3×3	O
subdeterminant	O
of	O
a	O
is	O
zero	O
,	O
which	O
leads	O
to	O
cubic	O
constraints	B
on	O
the	O
elements	O
of	O
the	O
trifocal	O
tensor	B
.	O
for	O
geometric	O
reasons	O
,	O
it	O
appears	O
that	O
the	O
equations	O
xiai	O
,	O
uv	O
are	O
not	O
algebraically	O
independent	O
for	O
the	O
four	O
choices	O
of	O
u	O
and	O
v.	O
consequently	O
we	O
obtain	O
a	O
single	O
cubic	O
constraint	O
on	O
t	O
jk	O
from	O
a	O
two-view	O
point	B
correspondence	O
.	O
details	O
are	O
left	O
to	O
the	O
reader	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kjqukrvt	O
qr	O
i	O
i	O
i	O
in	O
the	O
case	O
where	O
the	O
point	B
correspondence	O
is	O
between	O
the	O
ﬁrst	O
and	O
second	O
(	O
or	O
third	O
)	O
views	O
the	O
analysis	O
is	O
slightly	O
different	O
.	O
however	O
,	O
the	O
result	O
in	O
each	O
case	O
is	O
that	O
although	O
a	O
point	B
correspondence	O
across	O
two	B
views	I
leads	O
to	O
a	O
constraint	O
on	O
the	O
trifocal	B
tensor	I
,	O
this	O
constraint	O
is	O
not	O
a	O
linear	B
constraint	O
as	O
it	O
is	O
in	O
the	O
case	O
of	O
correspondences	O
across	O
three	O
views	O
.	O
17.2.4	O
afﬁne	B
trifocal	O
tensor	B
is	O
zero	O
.	O
this	O
is	O
the	O
case	O
for	O
elements	O
t	O
j3	O
in	O
the	O
case	O
where	O
all	O
three	O
cameras	B
are	O
afﬁne	B
,	O
the	O
trifocal	B
tensor	I
satisﬁes	O
certain	O
con-	O
straints	O
.	O
a	O
camera	B
matrix	I
is	O
afﬁne	B
if	O
the	O
last	O
row	O
is	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
it	O
follows	O
that	O
if	O
two	O
of	O
the	O
rows	O
in	O
the	O
matrix	B
in	O
(	O
17.12	O
)	O
are	O
of	O
this	O
form	O
,	O
then	O
the	O
corresponding	O
element	O
of	O
t	O
jk	O
3	O
–	O
a	O
total	O
of	O
11	O
i	O
elements	O
.	O
thus	O
the	O
trifocal	B
tensor	I
contains	O
16	O
non-zero	O
entries	O
,	O
deﬁned	O
up	O
to	O
scale	O
.	O
as	O
in	O
the	O
case	O
of	O
the	O
afﬁne	O
fundamental	B
matrix	I
,	O
this	O
analysis	O
is	O
equally	O
valid	O
for	O
the	O
case	O
of	O
cameras	O
sharing	O
the	O
same	O
principal	O
plane	B
.	O
and	O
t	O
33	O
1	O
,	O
t	O
3k	O
2	O
,	O
t	O
3k	O
1	O
,	O
t	O
j3	O
2	O
17.3	O
quadrilinear	B
relations	O
similar	O
arguments	O
work	O
in	O
the	O
case	O
of	O
four	O
views	O
.	O
once	O
more	O
,	O
consider	O
a	O
point	B
corre-	O
spondence	O
across	O
4	O
views	O
:	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
with	O
camera	O
matrices	O
a	O
,	O
b	O
,	O
c	O
and	O
d	O
,	O
17.3	O
quadrilinear	B
relations	O
the	O
projection	B
equations	O
may	O
be	O
written	O
as	O
	O
a	O
x	O
b	O
c	O
d	O
x	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
	O
=	O
0	O
.	O
419	O
(	O
17.19	O
)	O
	O
	O
x−k−k	O
(	O
cid:2	O
)	O
−k	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
−k	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
since	O
this	O
equation	O
has	O
a	O
solution	B
,	O
the	O
matrix	B
x	O
on	O
the	O
left	O
has	O
rank	O
at	O
most	O
7	O
,	O
and	O
so	O
all	O
8	O
×	O
8	O
determinants	O
are	O
zero	O
.	O
as	O
in	O
the	O
trilinear	B
case	O
,	O
any	O
determinant	O
containing	O
only	O
one	O
row	O
from	O
one	O
of	O
the	O
camera	O
matrices	O
gives	O
rise	O
to	O
a	O
trilinear	B
or	O
bilinear	B
relation	O
between	O
the	O
remaining	O
views	O
.	O
a	O
different	O
case	O
occurs	O
when	O
we	O
consider	O
8×	O
8	O
determi-	O
nants	O
containing	O
two	O
rows	O
from	O
each	O
of	O
the	O
camera	O
matrices	O
.	O
such	O
a	O
determinant	O
leads	O
to	O
a	O
new	O
quadrilinear	B
relationship	O
of	O
the	O
form	O
(	O
cid:2	O
)	O
jx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
lipwjqxkrylszqpqrs	O
=	O
0wxyz	O
xix	O
(	O
17.20	O
)	O
where	O
each	O
choice	B
of	O
the	O
free	O
variables	O
w	O
,	O
x	O
,	O
y	O
and	O
z	O
gives	O
a	O
different	O
equation	O
,	O
and	O
the	O
4-dimensional	O
quadrifocal	B
tensor	I
qpqrs	O
is	O
deﬁned	O
by	O
qpqrs	O
=	O
det	O
(	O
17.21	O
)	O
	O
.	O
	O
ap	O
bq	O
cr	O
ds	O
note	O
that	O
the	O
four	O
indices	O
of	O
the	O
four-view	O
tensor	B
are	O
contravariant	O
,	O
and	O
there	O
is	O
no	O
dis-	O
tinguished	O
view	O
as	O
there	O
is	O
in	O
the	O
case	O
of	O
the	O
trifocal	O
tensor	B
.	O
there	O
is	O
only	O
one	O
four-view	O
tensor	B
corresponding	O
to	O
four	O
given	O
views	O
,	O
and	O
this	O
one	O
tensor	B
gives	O
rise	O
to	O
81	O
different	O
quadrilinear	B
relationships	O
,	O
of	O
which	O
16	O
are	O
linearly	O
independent	O
(	O
see	O
section	O
17.6	O
)	O
.	O
as	O
in	O
the	O
case	O
of	O
the	O
trifocal	O
tensor	B
,	O
there	O
are	O
also	O
relations	O
between	O
lines	O
and	O
points	O
in	O
the	O
case	O
of	O
the	O
four-view	O
tensor	B
.	O
equations	O
relating	O
points	O
are	O
really	O
just	O
special	O
cases	O
of	O
the	O
relationship	O
for	B
lines	I
.	O
in	O
the	O
case	O
of	O
a	O
4-line	O
correspondence	B
,	O
however	O
,	O
something	O
different	O
happens	O
,	O
as	O
will	O
now	O
be	O
explained	O
.	O
the	O
relationship	O
between	O
a	O
set	O
of	O
four	O
lines	B
and	O
the	O
quadrifocal	B
tensor	I
is	O
given	O
by	O
the	O
formula	O
lpl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
r	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
for	O
any	O
set	O
of	O
corresponding	O
lines	B
lp	O
,	O
l	O
s	O
.	O
however	O
,	O
the	O
derivation	B
shows	O
that	O
q	O
,	O
l	O
this	O
condition	O
will	O
hold	O
as	O
long	O
as	O
there	O
is	O
a	O
single	O
point	O
in	O
space	O
that	O
projects	O
onto	O
the	O
four	O
image	O
lines	B
.	O
it	O
is	O
not	O
necessary	O
that	O
the	O
four	O
image	O
lines	B
correspond	O
(	O
in	O
the	O
sense	O
that	O
they	O
are	O
the	O
image	O
of	O
a	O
common	O
line	B
in	O
space	O
)	O
.	O
this	O
conﬁguration	O
is	O
illustrated	O
in	O
ﬁgure	O
17.1a	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
s	O
qpqrs	O
=	O
0	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
and	O
l	O
(	O
17.22	O
)	O
now	O
,	O
consider	O
the	O
case	O
where	O
three	O
of	O
the	O
lines	O
(	O
for	O
instance	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
s	O
)	O
correspond	O
by	O
deriving	O
from	O
a	O
single	O
3d	O
line	B
(	O
ﬁgure	O
17.1b	O
)	O
.	O
now	O
let	O
lp	O
be	O
any	O
arbitrary	O
line	B
in	O
the	O
ﬁrst	O
image	O
.	O
the	O
back-projection	B
of	O
this	O
line	B
is	O
a	O
plane	B
,	O
which	O
will	O
meet	O
the	O
3d	O
line	B
in	O
a	O
single	O
point	O
,	O
x	O
,	O
and	O
the	O
conditions	O
are	O
present	O
for	O
(	O
17.22	O
)	O
to	O
hold	O
.	O
since	O
this	O
is	O
true	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
for	O
any	O
arbitrary	O
line	B
lp	O
,	O
it	O
must	O
follow	O
that	O
l	O
s	O
qpqrs	O
=	O
0p	O
.	O
this	O
gives	O
three	O
linearly	O
ql	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
independent	O
equations	O
involving	O
l	O
r	O
and	O
l	O
s	O
.	O
however	O
,	O
given	O
a	O
set	O
of	O
corresponding	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
and	O
l	O
(	O
cid:2	O
)	O
q	O
,	O
l	O
(	O
cid:2	O
)	O
q	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
l	O
420	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
l	O
l	O
c	O
c	O
l///	O
c/	O
//	O
l	O
/	O
/	O
l///	O
c/	O
//	O
l	O
/	O
/	O
x	O
l	O
x	O
/l	O
/	O
l	O
/	O
c	O
a	O
/	O
c	O
b	O
/	O
/	O
c	O
/	O
/	O
c	O
fig	O
.	O
17.1.	O
four	O
line	O
“	O
correspondence	B
”	O
.	O
the	O
four	O
lines	O
l	O
,	O
l	O
(	O
cid:1	O
)	O
satisfy	O
the	O
quadrilinear	B
relation	O
(	O
17.22	O
)	O
since	O
their	O
back-projections	O
intersect	O
in	O
a	O
common	O
point	B
x	O
.	O
(	O
a	O
)	O
no	O
three	O
planes	O
intersect	O
in	O
a	O
common	O
line	B
.	O
(	O
b	O
)	O
the	O
three	O
lines	B
l	O
(	O
cid:1	O
)	O
↔	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
↔	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
are	O
the	O
image	O
of	O
the	O
same	O
line	B
l	O
in	O
3-space	O
.	O
,	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
,	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
lines	B
in	O
four	O
images	O
,	O
as	O
above	O
,	O
we	O
may	O
choose	O
a	O
subset	O
of	O
three	O
lines	B
,	O
and	O
for	O
each	O
line-	O
triplet	O
obtain	O
three	O
equations	O
in	O
this	O
way	O
.	O
since	O
there	O
are	O
four	O
choices	O
of	O
line-triplets	O
,	O
the	O
total	O
number	O
of	O
equations	O
is	O
thus	O
12	O
.	O
=	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
however	O
only	O
9	O
of	O
these	O
equations	O
are	O
independent	O
,	O
and	O
this	O
may	O
be	O
seen	O
as	O
follows	O
.	O
suppose	O
that	O
l	O
=	O
l	O
(	O
cid:2	O
)	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t.	O
this	O
is	O
equivalent	B
to	O
the	O
general	O
situation	O
since	O
by	O
applying	O
projective	B
transformations	O
to	O
each	O
of	O
the	O
four	O
images	O
we	O
can	O
trans-	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
form	O
an	O
arbitrary	O
line	B
correspondence	O
to	O
this	O
case	O
.	O
now	O
the	O
equation	O
l	O
s	O
qpqrs	O
=	O
0p	O
means	O
that	O
any	O
element	O
qp111	O
=	O
0.	O
applying	O
this	O
argument	O
to	O
all	O
four	O
triplets	O
of	O
three	O
views	O
,	O
we	O
ﬁnd	O
that	O
qpqrs	O
=	O
0	O
whenever	O
at	O
least	O
three	O
of	O
the	O
indices	O
are	O
1.	O
there	O
are	O
a	O
total	O
of	O
9	O
such	O
elements	O
.	O
since	O
the	O
set	O
of	O
equations	O
generated	O
by	O
the	O
line	B
correspon-	O
dence	O
is	O
equivalent	B
to	O
setting	O
each	O
of	O
these	O
elements	O
to	O
zero	O
,	O
among	O
the	O
total	O
of	O
12	O
equations	O
there	O
are	O
just	O
9	O
independent	O
ones	O
.	O
(	O
cid:2	O
)	O
ql	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
l	O
the	O
four-view	O
relations	O
are	O
summarized	O
in	O
table	O
17.2.	O
no	O
equation	O
is	O
given	O
here	O
for	O
the	O
case	O
of	O
three	O
lines	B
and	O
one	O
point	B
,	O
since	O
this	O
gives	O
no	O
more	O
restrictions	O
on	O
the	O
tensor	B
than	O
just	O
the	O
three-line	O
correspondence	B
.	O
17.4	O
intersections	O
of	O
four	O
planes	O
421	O
relation	B
number	O
of	O
equations	O
correspondence	B
four	O
points	O
three	O
points	O
,	O
one	O
line	B
two	O
points	O
,	O
two	O
lines	O
xix	O
(	O
cid:1	O
)	O
jx	O
xix	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
kx	O
(	O
cid:1	O
)	O
jx	O
xix	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
lipwjqxkrylszqpqrs	O
=	O
0wxyz	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
kl	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
s	O
ipwjqxkryqpqrs	O
=	O
0wxy	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
jl	O
r	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
s	O
ipwjqxqpqrs	O
=	O
0wx	O
three	O
lines	B
four	O
lines	B
(	O
cid:1	O
)	O
ql	O
lpl	O
(	O
cid:1	O
)	O
ql	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
r	O
qpqrs	O
=	O
0s	O
,	O
lpl	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
r	O
qpqrs	O
=	O
0s	O
(	O
cid:1	O
)	O
ql	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
s	O
qpqrs	O
=	O
0r	O
,	O
lpl	O
.	O
.	O
.	O
16	O
8	O
4	O
3	O
9	O
table	O
17.2.	O
quadrilinear	B
relations	O
.	O
17.4	O
intersections	O
of	O
four	O
planes	O
the	O
multi-view	O
tensors	O
may	O
be	O
given	O
a	O
different	O
derivation	B
,	O
which	O
sheds	O
a	O
little	O
more	O
light	O
on	O
their	O
meaning	O
.	O
in	O
this	O
interpretation	O
,	O
the	O
basic	O
geometric	O
property	O
is	O
the	O
inter-	O
section	O
of	O
four	O
planes	O
.	O
four	O
planes	O
in	O
space	O
will	O
generally	O
not	O
meet	O
in	O
a	O
common	O
point	B
.	O
a	O
necessary	O
and	O
sufﬁcient	O
condition	O
for	O
them	O
to	O
do	O
so	O
is	O
that	O
the	O
determinant	O
of	O
the	O
4	O
×	O
4	O
matrix	B
formed	O
from	O
the	O
vectors	O
representing	O
the	O
planes	O
should	O
vanish	O
.	O
in	O
this	O
section	O
only	O
we	O
shall	O
represent	O
the	O
determinant	O
of	O
a	O
4	O
×	O
4	O
matrix	B
notation	O
.	O
with	O
rows	O
a	O
,	O
b	O
,	O
c	O
and	O
d	O
by	O
a∧	O
b∧	O
c∧	O
d.	O
in	O
a	O
more	O
general	O
context	O
,	O
the	O
symbol	O
∧	O
rep-	O
resents	O
the	O
meet	O
(	O
or	O
intersection	B
)	O
operator	O
in	O
the	O
double	O
algebra	O
(	O
see	O
literature	O
section	O
of	O
this	O
chapter	O
)	O
.	O
however	O
,	O
for	O
the	O
present	O
purposes	O
the	O
reader	O
need	O
only	O
consider	O
it	O
as	O
a	O
shorthand	O
for	O
the	O
determinant	O
.	O
we	O
start	O
with	O
the	O
quadrifocal	B
tensor	I
for	O
which	O
the	O
derivation	B
is	O
easiest	O
.	O
consider	O
four	O
lines	O
l	O
,	O
l	O
(	O
cid:2	O
)	O
in	O
images	O
formed	O
from	O
four	O
cameras	B
with	O
camera	B
matrices	I
a	O
,	O
b	O
,	O
c	O
and	O
d.	O
the	O
back	O
projection	B
of	O
a	O
line	B
l	O
through	O
camera	B
a	O
is	O
written	O
as	O
the	O
plane	B
liai	O
,	O
with	O
notation	O
as	O
in	O
(	O
17.14	O
)	O
.	O
the	O
condition	O
that	O
these	O
four	O
planes	O
are	O
coincident	O
may	O
be	O
written	O
as	O
and	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
lpap	O
)	O
∧	O
(	O
l	O
(	O
cid:2	O
)	O
q	O
bq	O
)	O
∧	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
cr	O
)	O
∧	O
(	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
s	O
ds	O
)	O
=	O
0.	O
however	O
,	O
since	O
the	O
determinant	O
is	O
linear	B
in	O
each	O
row	O
,	O
this	O
may	O
be	O
written	O
as	O
0	O
=	O
lpl	O
(	O
cid:2	O
)	O
ql	O
s	O
(	O
ap	O
∧	O
bq	O
∧	O
cr	O
∧	O
ds	O
)	O
def=	O
lpl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
r	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
s	O
qpqrs	O
.	O
(	O
17.23	O
)	O
this	O
corresponds	O
to	O
the	O
deﬁnition	B
(	O
17.21	O
)	O
and	O
line	B
relation	O
(	O
17.22	O
)	O
for	O
the	O
quadrifocal	B
tensor	I
.	O
the	O
basic	O
geometric	O
property	O
is	O
the	O
intersection	B
of	O
the	O
four	O
planes	O
in	O
space	O
.	O
tensor	B
derivation	O
.	O
↔	O
l	O
trifocal	B
consider	O
now	O
a	O
point–line–line	O
relationship	O
xi	O
↔	O
l	O
(	O
cid:2	O
)	O
p	O
and	O
l2	O
q	O
be	O
two	O
lines	O
in	O
the	O
ﬁrst	O
image	O
that	O
pass	O
j	O
through	O
the	O
image	O
point	O
x.	O
the	O
planes	O
back-projected	O
from	O
the	O
four	O
lines	O
meet	O
in	O
a	O
point	B
(	O
see	O
ﬁgure	O
17.2	O
)	O
.	O
so	O
we	O
can	O
write	O
:	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
for	B
three	I
views	I
and	O
let	O
l1	O
r	O
(	O
al	O
∧	O
am	O
∧	O
bq	O
∧	O
cr	O
)	O
=	O
0	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
l	O
l2	O
l1	O
ml	O
422	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
l	O
x	O
c	O
l	O
/	O
/	O
c	O
l	O
/	O
/	O
/	O
/	O
c	O
fig	O
.	O
17.2.	O
a	O
point–line–line	O
correspondence	B
x	O
↔	O
l	O
(	O
cid:1	O
)	O
↔	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
involving	O
three	O
images	O
may	O
be	O
interpreted	O
as	O
follows	O
.	O
two	O
arbitrary	O
lines	B
are	O
chosen	O
to	O
pass	O
through	O
the	O
point	B
x	O
in	O
the	O
ﬁrst	O
image	O
.	O
the	O
four	O
lines	O
then	O
back-project	O
to	O
planes	O
that	O
meet	O
in	O
a	O
point	B
in	O
space	O
.	O
(	O
cid:16	O
)	O
=	O
0	O
.	O
al	O
∧	O
am	O
∧	O
bq	O
∧	O
cr	O
(	O
cid:16	O
)	O
the	O
next	O
step	O
is	O
an	O
algebraic	B
trick	O
–	O
to	O
multiply	O
this	O
equation	O
by	O
the	O
ilmilm	O
.	O
this	O
is	O
a	O
scalar	O
value	O
(	O
in	O
fact	O
equal	O
to	O
6	O
,	O
the	O
number	O
of	O
permutations	O
of	O
(	O
ilm	O
)	O
)	O
.	O
the	O
result	O
after	O
regrouping	O
is	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
l1	O
l	O
l2	O
milm	O
(	O
cid:2	O
)	O
l	O
ql	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
ilm	O
l	O
l2	O
milm	O
is	O
simply	O
the	O
cross-product	O
of	O
the	O
two	O
lines	B
ll	O
and	O
lm	O
,	O
in	O
now	O
the	O
expression	O
l1	O
other	O
words	O
their	O
intersection	B
point	O
,	O
xi	O
.	O
thus	O
ﬁnally	O
we	O
can	O
write	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
r	O
ilm	O
(	O
al	O
∧	O
am	O
∧	O
bq	O
∧	O
cr	O
)	O
0	O
=	O
xil	O
def=	O
xil	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
r	O
(	O
cid:15	O
)	O
t	O
qr	O
i	O
(	O
17.24	O
)	O
which	O
are	O
the	O
deﬁnition	B
(	O
17.10	O
)	O
and	O
basic	O
incidence	O
relation	B
(	O
17.15	O
)	O
for	O
the	O
trifocal	B
tensor	I
.	O
fundamental	B
matrix	I
.	O
we	O
can	O
derive	O
the	O
fundamental	B
matrix	I
in	O
the	O
same	O
manner	O
.	O
given	O
a	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
q	O
passing	O
through	O
x	O
,	O
and	O
(	O
cid:2	O
)	O
1	O
.	O
the	O
back-projected	O
planes	O
all	O
meet	O
in	O
a	O
point	B
,	O
so	O
we	O
r	O
and	O
l	O
l	O
write	O
(	O
cid:2	O
)	O
2	O
s	O
passing	O
through	O
x	O
(	O
cid:2	O
)	O
,	O
select	O
pairs	O
of	B
lines	I
l1	O
p	O
and	O
l2	O
(	O
cid:2	O
)	O
1	O
r	O
l	O
s	O
(	O
ap	O
∧	O
aq	O
∧	O
br	O
∧	O
bs	O
)	O
=	O
0	O
.	O
(	O
cid:2	O
)	O
2	O
p	O
l2	O
l1	O
q	O
l	O
multiplying	O
by	O
(	O
ipqipq	O
)	O
(	O
jrsjrs	O
)	O
and	O
proceeding	O
as	O
before	O
leads	O
to	O
the	O
coplanarity	B
constraint	I
0	O
=	O
xix	O
(	O
cid:2	O
)	O
j	O
(	O
ipqjrs	O
(	O
ap	O
∧	O
aq	O
∧	O
br	O
∧	O
bs	O
)	O
)	O
def=	O
xix	O
(	O
cid:2	O
)	O
jfji	O
(	O
17.25	O
)	O
which	O
can	O
be	O
compared	O
with	O
(	O
17.4	O
)	O
.	O
17.5	O
counting	B
arguments	I
in	O
this	O
section	O
we	O
specify	O
the	O
number	O
of	O
points	O
or	O
lines	B
required	O
to	O
carry	O
out	O
reconstruc-	O
tion	O
from	O
several	O
views	O
.	O
this	O
analysis	O
is	O
related	O
to	O
counting	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
associated	O
tensors	O
.	O
however	O
,	O
in	O
doing	O
this	O
it	O
is	O
necessary	O
to	O
distinguish	O
between	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
tensor	O
viewed	O
as	O
an	O
unconstrained	O
17.5	O
counting	B
arguments	I
423	O
algebraic	B
object	O
,	O
and	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
that	O
arises	O
from	O
a	O
conﬁguration	O
of	O
cameras	O
and	O
their	O
camera	B
matrices	I
.	O
for	O
instance	O
,	O
consider	O
the	O
fundamental	B
matrix	I
.	O
at	O
one	O
level	O
,	O
the	O
fundamental	B
matrix	I
may	O
be	O
considered	O
as	O
a	O
homogeneous	O
3×3	O
matrix	B
,	O
and	O
hence	O
has	O
8	O
degrees	B
of	I
freedom	I
(	O
9	O
minus	O
1	O
for	O
the	O
indeterminate	O
scale	O
)	O
.	O
on	O
the	O
other	O
hand	O
,	O
the	O
fundamental	B
matrix	I
aris-	O
ing	O
from	O
a	O
pair	O
of	B
camera	I
matrices	O
according	O
to	O
(	O
17.3–p412	O
)	O
must	O
satisfy	O
the	O
additional	O
constraint	O
det	O
f	O
=	O
0.	O
hence	O
,	O
such	O
a	O
fundamental	B
matrix	I
has	O
just	O
7	O
degrees	B
of	I
freedom	I
.	O
since	O
the	O
camera	B
matrices	I
may	O
be	O
determined	O
up	O
to	O
a	O
3d	O
projectivity	B
from	O
the	O
funda-	O
mental	O
matrix	B
(	O
and	O
vice	O
versa	O
)	O
,	O
we	O
may	O
count	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
a	O
fundamental	O
matrix	B
by	O
counting	O
the	O
degrees	B
of	I
freedom	I
of	O
the	O
camera	B
matrices	I
.	O
two	O
camera	O
matrices	O
have	O
a	O
total	O
of	O
22	O
degrees	B
of	I
freedom	I
(	O
two	O
homogeneous	O
3	O
×	O
4	O
ma-	O
trices	O
)	O
.	O
a	O
3d	O
homography	B
is	O
represented	O
by	O
a	O
4	O
×	O
4	O
homogeneous	O
matrix	O
,	O
and	O
so	O
has	O
15	O
degrees	B
of	I
freedom	I
.	O
this	O
gives	O
a	O
total	O
of	O
7	O
=	O
22	O
−	O
15	O
degrees	B
of	I
freedom	I
for	O
the	O
conﬁguration	O
of	O
the	O
two	O
cameras	B
,	O
modulo	O
a	O
projective	B
transformation	I
.	O
this	O
agrees	O
with	O
the	O
7	O
degrees	B
of	I
freedom	I
of	O
the	O
fundamental	B
matrix	I
,	O
providing	O
a	O
check	O
on	O
the	O
previous	O
calculation	O
.	O
similarly	O
,	O
the	O
trifocal	B
tensor	I
encodes	O
the	O
projective	B
structure	O
of	O
three	O
camera	B
matri-	O
ces	O
,	O
and	O
hence	O
has	O
18	O
=	O
3∗11−15	O
degrees	B
of	I
freedom	I
.	O
in	O
the	O
same	O
way	O
the	O
quadrifocal	B
tensor	I
has	O
29	O
=	O
4	O
∗	O
11	O
−	O
15	O
degrees	B
of	I
freedom	I
.	O
generally	O
for	O
m	O
cameras	B
,	O
we	O
have	O
#	O
dof	O
=	O
11m	O
−	O
15.	O
since	O
the	O
trifocal	B
and	O
quadrifocal	O
tensors	O
,	O
considered	O
just	O
as	O
homogeneous	O
algebraic	B
arrays	O
have	O
26	O
and	O
80	O
degrees	B
of	I
freedom	I
respectively	O
,	O
they	O
must	O
satisfy	O
an	O
additional	O
set	O
of	O
constraints	O
,	O
dictated	O
by	O
the	O
camera	B
geometry	O
–	O
8	O
constraints	B
for	O
the	O
trifocal	B
tensor	I
and	O
51	O
constraints	B
for	O
the	O
quadrifocal	B
tensor	I
.	O
in	O
computing	O
geometric	B
structure	O
,	O
we	O
may	O
use	O
linear	O
algebraic	B
methods	O
based	O
on	O
estimating	O
the	O
multifocal	O
tensor	B
by	O
solving	B
the	O
constraints	B
from	O
the	O
multi-linearities	O
.	O
the	O
number	O
of	O
correspondences	O
required	O
is	O
determined	O
from	O
the	O
number	O
of	O
equations	O
generated	O
by	O
each	O
point	B
or	O
line	B
correspondence	O
.	O
this	O
linear	B
method	O
takes	O
no	O
account	O
of	O
the	O
constraints	O
imposed	O
on	O
the	O
tensors	O
by	O
their	O
geometry	O
.	O
on	O
the	O
other	O
hand	O
,	O
the	O
number	O
of	O
correspondences	O
required	O
may	O
be	O
determined	O
by	O
counting	O
the	O
number	O
of	O
geometric	O
constraints	B
given	O
by	O
each	O
correspondence	B
and	O
com-	O
paring	O
with	O
the	O
total	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
system	O
.	O
consider	O
a	O
conﬁgu-	O
ration	O
of	O
n	O
points	O
in	O
m	O
views	O
.	O
the	O
total	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
this	O
system	O
is	O
11m−	O
15	O
+	O
3n	O
,	O
since	O
each	O
of	O
the	O
n	O
3d	O
points	O
has	O
3	O
degrees	B
of	I
freedom	I
.	O
to	O
estimate	O
the	O
projective	B
structure	O
the	O
available	O
data	O
are	O
the	O
images	O
of	O
the	O
n	O
points	O
in	O
m	O
images	O
,	O
a	O
total	O
of	O
2mn	O
measurements	O
(	O
each	O
2d	O
point	B
having	O
two	O
coordinates	O
)	O
.	O
thus	O
for	O
recon-	O
struction	O
to	O
be	O
possible	O
,	O
we	O
require	O
2mn	O
≥	O
11m−	O
15	O
+	O
3n	O
,	O
or	O
(	O
2m−	O
3	O
)	O
n	O
≥	O
11m−	O
15.	O
thus	O
the	O
required	O
number	O
of	O
points	O
is	O
n	O
≥	O
11m	O
−	O
15	O
2m	O
−	O
3	O
=	O
5	O
+	O
m	O
2m	O
−	O
3	O
.	O
one	O
may	O
also	O
think	O
of	O
this	O
by	O
observing	O
that	O
each	O
point	B
correspondence	O
contributes	O
424	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
#	O
views	O
tensor	B
#	O
elems	O
#	O
dof	O
linear	B
#	O
points	O
#	O
lines	B
non-linear	O
#	O
points	O
#	O
lines	B
2	O
3	O
4	O
f	O
t	O
q	O
9	O
27	O
81	O
7	O
18	O
29	O
8	O
7	O
6	O
—	O
13	O
9	O
∗	O
7	O
∗	O
6	O
6	O
—	O
∗	O
9	O
?	O
8	O
?	O
table	O
17.3.	O
projective	B
degrees	O
of	O
freedom	O
and	O
constraints	B
.	O
the	O
linear	B
column	O
indicates	O
the	O
minimum	O
number	O
of	O
correspondences	O
across	O
all	O
views	O
required	O
to	O
solve	O
linearly	O
for	O
the	O
tensor	B
(	O
up	O
to	O
scale	O
)	O
.	O
the	O
non-linear	B
is	O
the	O
minimum	O
number	O
of	O
correspondences	O
required	O
.	O
a	O
star	O
indicates	O
multiple	O
solutions	O
,	O
and	O
a	O
question-mark	O
indicates	O
that	O
no	O
practical	O
reconstruction	B
method	O
is	O
known	O
.	O
2m	O
−	O
3	O
constraints	B
on	O
the	O
cameras	B
,	O
that	O
is	O
2m	O
for	O
the	O
coordinates	B
of	O
the	O
points	O
in	O
each	O
view	O
,	O
less	O
3	O
for	O
the	O
added	O
degree	O
of	O
freedom	O
of	O
the	O
3d	O
point	B
.	O
an	O
analogous	O
argument	O
applies	O
for	O
line	O
correspondences	B
.	O
a	O
line	B
has	O
four	O
degrees	O
of	O
freedom	O
in	O
3-space	O
,	O
and	O
its	O
image	O
line	O
is	O
described	O
by	O
2	O
degrees	B
of	I
freedom	I
,	O
so	O
that	O
each	O
line	B
correspondence	O
provides	O
2m	O
−	O
4	O
constraints	B
and	O
the	O
number	O
of	O
lines	O
l	O
required	O
is	O
l	O
≥	O
11m	O
−	O
15	O
2m	O
−	O
4	O
.	O
in	O
either	O
of	O
these	O
cases	O
,	O
if	O
the	O
number	O
of	O
constraints	O
(	O
equations	O
)	O
is	O
equal	O
to	O
the	O
num-	O
ber	O
of	O
degrees	O
of	O
freedom	O
(	O
unknowns	O
)	O
of	O
the	O
cameras	O
and	O
points	O
or	O
lines	B
conﬁguration	O
,	O
then	O
we	O
can	O
in	O
general	O
expect	O
multiple	O
solutions	O
,	O
except	O
in	O
the	O
linear	B
case	O
.	O
however	O
,	O
if	O
there	O
are	O
more	O
equations	O
than	O
unknowns	O
,	O
the	O
system	O
is	O
over-determined	B
,	O
and	O
in	O
the	O
generic	O
case	O
there	O
will	O
exist	O
a	O
single	O
solution	O
.	O
table	O
17.3	O
summarizes	O
the	O
number	O
of	O
correspondences	O
required	O
for	O
reconstruction	O
.	O
a	O
star	O
(	O
*	O
)	O
indicates	O
that	O
multiple	O
solutions	O
are	O
expected	O
.	O
for	O
the	O
case	O
of	O
non-linear	O
solu-	O
tions	O
,	O
actual	O
methods	O
of	O
solution	O
are	O
not	O
always	O
known	O
,	O
other	O
than	O
by	O
brute-force	O
gen-	O
eration	O
and	O
solution	B
of	O
a	O
set	O
of	O
simultaneous	O
polynomial	O
equations	O
.	O
situations	O
where	O
no	O
simple	O
method	O
is	O
known	O
are	O
marked	O
with	O
a	O
question-mark	O
.	O
note	O
that	O
not	O
much	O
is	O
known	O
about	O
non-linear	B
solutions	O
for	B
lines	I
.	O
speciﬁc	O
non-linear	B
algorithms	O
are	O
:	O
(	O
i	O
)	O
7	O
points	O
in	O
2	O
views	O
:	O
see	O
section	O
11.1.2	O
(	O
p281	O
)	O
.	O
three	O
solutions	O
are	O
possible	O
.	O
(	O
ii	O
)	O
6	O
points	O
in	O
3	O
views	O
:	O
see	O
section	O
20.2.4	O
(	O
p510	O
)	O
.	O
three	O
solutions	O
are	O
possible	O
.	O
this	O
is	O
the	O
dual	B
(	O
see	O
chapter	O
20	O
)	O
of	O
the	O
previous	O
problem	O
.	O
(	O
iii	O
)	O
6	O
points	O
in	O
4	O
views	O
.	O
solve	O
using	O
6	O
points	O
in	O
3	O
views	O
,	O
then	O
use	O
the	O
camera	B
resec-	O
tion	O
dlt	O
algorithm	B
(	O
section	O
7.1	O
(	O
p178	O
)	O
)	O
to	O
ﬁnd	O
the	O
fourth	O
view	O
and	O
eliminate	O
all	O
but	O
one	O
solution	B
.	O
however	O
,	O
unlike	O
the	O
previous	O
two	O
cases	O
,	O
the	O
case	O
of	O
6	O
points	O
in	O
4	O
views	O
is	O
overdetermined	O
,	O
and	O
this	O
solution	B
is	O
only	O
valid	O
for	O
perfect	O
data	O
.	O
the	O
estimation	B
for	O
noisy	O
data	O
is	O
discussed	O
in	O
chapter	O
20	O
.	O
17.5	O
counting	B
arguments	I
425	O
#	O
views	O
tensor	B
#	O
non-zero	O
elements	O
#	O
dof	O
linear	B
#	O
points	O
#	O
lines	B
non-linear	O
#	O
points	O
#	O
lines	B
2	O
3	O
4	O
fa	O
ta	O
qa	O
5	O
16	O
48	O
4	O
12	O
20	O
4	O
4	O
4	O
—	O
8	O
6	O
4	O
4	O
4	O
—	O
∗	O
6	O
∗	O
5	O
?	O
?	O
table	O
17.4.	O
afﬁne	B
degrees	O
of	O
freedom	O
and	O
constraints	B
.	O
the	O
camera	B
for	O
each	O
view	O
is	O
afﬁne	B
.	O
see	O
caption	O
of	O
table	O
17.3	O
for	O
details	O
.	O
17.5.1	O
afﬁne	B
cameras	I
for	O
afﬁne	B
cameras	I
,	O
the	O
reconstruction	B
problem	O
requires	O
fewer	O
correspondences	B
.	O
the	O
plane	O
at	O
inﬁnity	O
may	O
be	O
identiﬁed	O
in	O
a	O
reconstruction	B
,	O
being	O
the	O
principal	B
plane	I
of	O
all	O
of	O
the	O
cameras	O
,	O
and	O
the	O
reconstruction	B
ambiguity	O
is	O
afﬁne	B
,	O
not	O
projective	B
.	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
for	O
m	O
afﬁne	B
cameras	I
is	O
#	O
dof	O
=	O
8m	O
−	O
12.	O
each	O
view	O
adds	O
8	O
degrees	B
of	I
freedom	I
for	O
the	O
new	O
3	O
×	O
4	O
afﬁne	B
camera	I
matrix	O
,	O
and	O
we	O
subtract	O
12	O
for	O
the	O
degrees	B
of	I
freedom	I
of	O
a	O
3d	O
afﬁne	B
transformation	I
.	O
as	O
in	O
the	O
projective	B
case	O
a	O
point	B
correspondence	O
imposes	O
2m	O
−	O
3	O
constraints	B
,	O
and	O
a	O
line	B
correspondence	O
2m	O
−	O
4	O
constraints	B
.	O
as	O
before	O
the	O
number	O
of	O
required	O
points	O
may	O
be	O
computed	O
as	O
n	O
(	O
2m	O
−	O
3	O
)	O
≥	O
8m	O
−	O
12	O
,	O
i.e	O
.	O
n	O
≥	O
8m	O
−	O
12	O
2m	O
−	O
3	O
=	O
4.	O
for	B
lines	I
the	O
result	O
is	O
l	O
≥	O
8m	O
−	O
12	O
2m	O
−	O
4	O
=	O
4	O
+	O
2	O
m	O
−	O
2	O
.	O
as	O
for	O
linear	B
methods	O
,	O
the	O
number	O
of	O
elements	O
in	O
the	O
tensor	B
is	O
3m	O
.	O
in	O
the	O
afﬁne	B
case	O
the	O
tensor	B
is	O
,	O
as	O
always	O
,	O
only	O
deﬁned	O
up	O
to	O
scale	O
,	O
but	O
additionally	O
many	O
of	O
the	O
elements	O
are	O
zero	O
,	O
as	O
seen	O
in	O
section	O
17.1.2	O
and	O
section	O
17.2.4.	O
this	O
cuts	O
down	O
on	O
the	O
required	O
number	O
of	O
correspondences	O
.	O
counting	O
results	O
are	O
given	O
in	O
table	O
17.4.	O
note	O
that	O
for	O
point	O
correspondences	B
,	O
the	O
linear	B
algorithms	O
apply	O
with	O
the	O
minimum	O
number	O
of	O
correspondences	O
given	O
by	O
the	O
above	O
equation	O
.	O
hence	O
,	O
the	O
non-linear	B
algorithms	O
are	O
the	O
same	O
as	O
the	O
linear	B
ones	O
.	O
17.5.2	O
knowing	O
four	O
coplanar	O
points	O
–	O
plane	B
plus	I
parallax	I
the	O
previous	O
counting	B
arguments	I
were	O
for	O
the	O
case	O
of	B
points	I
and	O
lines	B
in	O
general	O
po-	O
sition	O
.	O
here	O
we	O
consider	O
the	O
important	O
case	O
that	O
four	O
or	O
more	O
of	O
the	O
3d	O
points	O
are	O
coplanar	O
.	O
it	O
will	O
be	O
see	O
that	O
the	O
computation	B
of	I
the	O
tensors	O
,	O
and	O
consequently	O
projec-	O
tive	O
structure	B
,	O
is	O
signiﬁcantly	O
simpliﬁed	O
.	O
this	O
discussion	O
is	O
given	O
in	O
terms	O
of	O
knowing	O
426	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
#	O
views	O
tensor	B
#	O
dof	O
#	O
points	O
points	O
#	O
constraints	B
#	O
lines	B
lines	O
#	O
constraints	B
2	O
3	O
4	O
f	O
t	O
q	O
2	O
5	O
8	O
2	O
2	O
2	O
2	O
5	O
8	O
—	O
5	O
4	O
5	O
8	O
table	O
17.5.	O
number	O
of	O
additional	O
correspondences	B
required	O
to	O
compute	O
projective	B
structure	O
given	O
2d	O
homographies	B
between	O
the	O
views	O
,	O
induced	B
by	I
a	I
plane	I
.	O
the	O
homographies	B
may	O
be	O
computed	O
from	O
four	O
or	O
more	O
point	O
matches	O
derived	O
from	O
coplanar	O
points	O
,	O
or	O
by	O
any	O
other	O
means	O
.	O
points	O
used	O
to	O
compute	O
the	O
homographies	B
are	O
not	O
counted	O
in	O
this	O
table	O
.	O
four	O
coplanar	O
points	O
in	O
the	O
images	O
.	O
however	O
,	O
all	O
that	O
is	O
really	O
important	O
here	O
is	O
that	O
inter-image	O
homographies	B
induced	O
by	O
a	O
plane	B
should	O
be	O
known	O
.	O
computation	B
of	I
the	O
fundamental	B
matrix	I
knowing	O
four	O
coplanar	O
points	O
was	O
consid-	O
ered	O
in	O
section	O
13.3	O
(	O
p334	O
)	O
(	O
see	O
algorithm	B
13.2	O
(	O
p336	O
)	O
)	O
,	O
and	O
for	O
the	O
trifocal	B
tensor	I
in	O
section	O
16.7.1.	O
now	O
,	O
we	O
consider	O
the	O
four-view	O
case	O
.	O
from	O
the	O
correspondence	B
of	O
4	O
(	O
or	O
more	O
)	O
points	O
derived	O
from	O
3d	O
points	O
in	O
a	O
plane	B
,	O
we	O
can	O
compute	O
the	O
homographies	B
h	O
(	O
cid:2	O
)	O
,	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
from	O
the	O
ﬁrst	O
view	O
to	O
the	O
second	O
,	O
third	O
and	O
fourth	O
views	O
respectively	O
,	O
induced	O
by	O
the	O
plane	B
.	O
in	O
a	O
projective	B
reconstruction	I
,	O
we	O
choose	O
the	O
plane	B
containing	O
the	O
points	O
as	O
the	O
plane	O
at	O
inﬁnity	O
,	O
in	O
which	O
case	O
h	O
(	O
cid:2	O
)	O
are	O
the	O
inﬁnite	O
homogra-	O
phies	O
.	O
assuming	O
further	O
that	O
the	O
ﬁrst	O
image	O
is	O
at	O
the	O
origin	O
,	O
the	O
four	O
camera	O
matrices	O
may	O
now	O
be	O
written	O
as	O
and	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
a	O
=	O
[	O
i	O
|	O
0	O
]	O
b	O
=	O
[	O
h	O
(	O
cid:2	O
)	O
|t	O
(	O
cid:2	O
)	O
,	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
d	O
=	O
[	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
|t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
may	O
be	O
determined	O
only	O
up	O
to	O
a	O
common	O
scale.	O
]	O
c	O
=	O
[	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
|t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
vectors	O
t	O
(	O
cid:2	O
)	O
since	O
the	O
left	O
hand	O
3	O
×	O
3	O
blocks	O
of	O
the	O
camera	O
matrices	O
are	O
now	O
known	O
,	O
it	O
is	O
easily	O
seen	O
from	O
(	O
17.21	O
)	O
that	O
the	O
entries	O
of	O
qpqrs	O
are	O
linear	B
in	O
the	O
remaining	O
entries	O
t	O
(	O
cid:2	O
)	O
,	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
of	O
the	O
camera	O
matrices	O
.	O
using	O
(	O
17.21	O
)	O
we	O
can	O
write	O
down	O
an	O
expression	O
for	O
the	O
entries	O
of	O
qpqrs	O
in	O
terms	O
of	O
the	O
entries	O
of	O
t	O
(	O
cid:2	O
)	O
.	O
in	O
fact	O
,	O
we	O
may	O
write	O
this	O
explicitly	O
as	O
q	O
=	O
mt	O
,	O
where	O
m	O
is	O
an	O
81×9	O
matrix	B
and	O
q	O
and	O
t	O
are	O
vectors	O
representing	O
the	O
entries	O
of	O
q	O
and	O
t	O
(	O
cid:2	O
)	O
.	O
thus	O
,	O
the	O
quadrifocal	B
tensor	I
may	O
be	O
linearly	O
parametrized	O
in	O
terms	O
of	O
9	O
homogeneous	O
coordinates	O
and	O
hence	O
has	O
8	O
degrees	B
of	I
freedom	I
.	O
,	O
.	O
.	O
.	O
,	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
]	O
,	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
now	O
,	O
given	O
a	O
set	O
of	O
equations	O
eq	O
=	O
0	O
derived	O
from	O
correspondences	O
as	O
in	O
table	O
17.2	O
,	O
they	O
may	O
be	O
rewritten	O
in	O
terms	O
of	O
the	O
minimal	O
parameter	O
set	O
t	O
by	O
substituting	O
q	O
=	O
mt	O
arriving	O
at	O
emt	O
=	O
0.	O
this	O
allows	O
a	O
linear	B
solution	I
for	O
t	O
and	O
hence	O
the	O
camera	B
matrices	I
,	O
and	O
(	O
if	O
desired	O
)	O
the	O
tensor	B
,	O
q	O
=	O
mt	O
.	O
note	O
the	O
important	O
advantage	O
here	O
that	O
the	O
tensor	B
so	O
obtained	O
automatically	O
corresponds	O
to	O
a	O
set	O
of	B
camera	I
matrices	O
,	O
and	O
so	O
satisﬁes	O
all	O
geometric	B
constraints	O
–	O
the	O
troublesome	O
51	O
constraints	B
that	O
must	O
be	O
satisﬁed	O
by	O
the	O
quadrifocal	B
tensor	I
disappear	O
into	O
thin	O
air	O
.	O
the	O
above	O
analysis	O
was	O
for	O
the	O
computation	B
of	I
the	O
quadrifocal	B
tensor	I
,	O
but	O
it	O
applies	O
equally	O
well	O
to	O
the	O
fundamental	B
matrix	I
and	O
trifocal	B
tensor	I
as	O
well	O
.	O
17.5	O
counting	B
arguments	I
427	O
counting	B
argument	I
.	O
we	O
return	O
to	O
the	O
general	O
case	O
of	O
m	O
views	O
and	O
consider	O
the	O
situa-	O
tion	O
from	O
a	O
geometric	B
point	O
of	O
view	O
.	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
parametrizing	O
the	O
tensor	B
is	O
equal	O
to	O
the	O
number	O
of	O
geometric	O
degrees	B
of	I
freedom	I
remaining	O
in	O
the	O
camera	B
matrices	I
,	O
namely	O
3m	O
−	O
4	O
where	O
m	O
is	O
the	O
number	O
of	O
views	O
.	O
this	O
arises	O
from	O
3	O
(	O
m	O
−	O
1	O
)	O
for	O
the	O
last	O
column	O
of	O
each	O
camera	B
matrix	I
apart	O
from	O
the	O
ﬁrst	O
,	O
less	O
one	O
for	O
the	O
common	O
scaling	B
.	O
counting	O
the	O
number	O
of	O
constraints	O
imposed	O
by	O
a	O
point	B
or	O
a	O
line	B
correspondence	O
is	O
a	O
little	O
tricky	O
,	O
however	O
,	O
and	O
shows	O
that	O
one	O
must	O
always	O
be	O
careful	O
with	O
counting	O
arguments	O
not	O
to	O
neglect	O
hidden	O
dependencies	O
.	O
first	O
,	O
consider	O
a	O
line	B
correspondence	O
l	O
↔	O
l	O
(	O
cid:2	O
)	O
↔	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
across	O
three	O
views	O
–	O
the	O
argument	O
will	O
hold	O
in	O
general	O
for	O
m	O
≥	O
3	O
views	O
.	O
the	O
question	O
to	O
be	O
resolved	O
is	O
just	O
how	O
much	O
information	O
can	O
be	O
derived	O
from	O
the	O
measurement	O
of	O
the	O
image	O
lines	O
.	O
surprisingly	O
,	O
knowledge	O
of	O
the	O
plane	O
homographies	B
between	O
the	O
images	O
reduces	O
the	O
amount	O
of	O
information	O
that	O
a	O
line	B
correspondence	O
pro-	O
vides	O
.	O
for	O
simplicity	O
of	O
argument	O
,	O
we	O
may	O
assume	O
that	O
planar	O
homographies	O
have	O
been	O
applied	O
to	O
the	O
images	O
so	O
that	O
the	O
four	O
coplanar	O
reference	O
points	O
map	O
to	O
the	O
same	O
point	O
in	O
each	O
image	O
.	O
as	O
a	O
result	O
any	O
further	O
point	B
in	O
the	O
reference	O
plane	B
will	O
map	O
to	O
the	O
same	O
point	O
in	O
each	O
image	O
.	O
now	O
the	O
3d	O
line	B
l	O
from	O
which	O
the	O
line	B
correspondence	O
is	O
de-	O
rived	O
must	O
meet	O
the	O
reference	O
plane	B
in	O
a	O
point	B
x.	O
since	O
it	O
lies	O
on	O
the	O
reference	O
plane	B
,	O
x	O
,	O
l	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
projects	O
to	O
the	O
same	O
point	O
x	O
in	O
all	O
images	O
,	O
and	O
x	O
must	O
lie	O
on	O
all	O
three	O
image	O
lines	O
l	O
,	O
l	O
(	O
cid:2	O
)	O
.	O
thus	O
,	O
corresponding	O
lines	B
in	O
the	O
three	O
views	O
can	O
not	O
be	O
arbitrary	O
–	O
they	O
must	O
all	O
pass	O
through	O
a	O
common	O
image	O
point	O
.	O
in	O
the	O
general	O
case	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
measurements	O
of	O
the	O
lines	O
in	O
m	O
views	O
is	O
m	O
+	O
2.	O
to	O
specify	O
the	O
point	B
x	O
requires	O
2	O
degrees	B
of	I
freedom	I
,	O
and	O
each	O
line	B
through	O
the	O
point	B
then	O
has	O
one	O
remaining	O
degree	O
of	O
freedom	O
(	O
its	O
orientation	B
)	O
.	O
subtracting	O
4	O
for	O
the	O
four	O
added	O
degrees	B
of	I
freedom	I
of	O
the	O
line	B
in	O
space	O
,	O
we	O
see	O
•	O
each	O
line	B
correspondence	O
across	O
m	O
views	O
generates	O
m	O
−	O
2	O
constraints	B
on	O
the	O
re-	O
maining	O
degrees	B
of	I
freedom	I
of	O
the	O
cameras	B
.	O
note	O
how	O
the	O
condition	O
that	O
the	O
image	O
lines	O
must	O
meet	O
in	O
a	O
point	B
restricts	O
the	O
number	O
of	O
equations	O
generated	O
by	O
the	O
line	B
correspondence	O
.	O
without	O
observing	O
this	O
condition	O
,	O
one	O
would	O
expect	O
2m	O
−	O
4	O
constraints	B
from	O
each	O
line	B
.	O
however	O
,	O
with	O
perfect	O
data	O
the	O
set	O
of	O
2m−	O
4	O
equations	O
will	O
have	O
rank	O
only	O
m−	O
2.	O
with	O
noisy	O
data	O
the	O
image	O
lines	O
will	O
not	O
be	O
exactly	O
coincident	O
,	O
and	O
the	O
system	O
may	O
have	O
full	O
rank	O
,	O
but	O
this	O
will	O
be	O
entirely	O
due	O
to	O
noise	O
,	O
and	O
the	O
smallest	O
singular	B
values	I
of	O
the	O
system	O
will	O
be	O
essentially	O
random	O
.	O
one	O
should	O
,	O
however	O
,	O
include	O
all	O
available	O
equations	O
in	O
solving	O
the	O
system	O
,	O
since	O
this	O
will	O
diminish	O
the	O
noise	B
effects	O
.	O
for	O
point	O
correspondences	B
the	O
argument	O
is	O
similar	O
.	O
the	O
line	B
through	O
any	O
two	O
image	O
points	O
is	O
the	O
image	O
of	O
a	O
line	B
in	O
space	O
.	O
the	O
projections	O
of	O
this	O
3d	O
line	B
are	O
constrained	O
as	O
discussed	O
in	O
the	O
preceding	O
discussion	O
,	O
and	O
this	O
imposes	O
constraints	B
on	O
the	O
matching	B
points	O
.	O
the	O
measurements	O
have	O
3m	O
+	O
2	O
degrees	B
of	I
freedom	I
:	O
2	O
for	O
the	O
intersection	B
point	O
of	O
the	O
line	O
with	O
the	O
plane	B
and	O
,	O
in	O
each	O
view	O
,	O
one	O
for	O
the	O
line	B
orientation	O
and	O
two	O
corresponding	O
to	O
the	O
position	O
of	O
each	O
of	O
the	O
two	O
points	O
on	O
the	O
line	B
.	O
subtracting	O
6	O
for	O
the	O
degrees	B
of	I
freedom	I
of	O
the	O
two	O
points	O
in	O
3-space	O
,	O
the	O
result	O
is	O
428	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
•	O
two	O
point	O
correspondences	B
across	O
m	O
views	O
generate	O
3m	O
−	O
4	O
constraints	B
on	O
the	O
re-	O
maining	O
degrees	B
of	I
freedom	I
of	O
the	O
cameras	B
.	O
since	O
this	O
is	O
the	O
same	O
as	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
cameras	O
,	O
2	O
points	O
are	O
sufﬁcient	O
to	O
compute	O
structure	B
.	O
since	O
the	O
number	O
of	O
geometric	O
constraints	B
on	O
the	O
cameras	B
is	O
the	O
same	O
as	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
tensor	O
,	O
there	O
is	O
no	O
distinction	O
between	O
constraints	O
on	O
the	O
tensor	B
and	O
constraints	B
on	O
the	O
geometry	O
.	O
thus	O
,	O
point	O
and	O
line	O
correspondences	O
may	O
be	O
used	O
to	O
generate	O
linear	B
constraints	O
on	O
the	O
tensor	B
.	O
there	O
is	O
no	O
need	O
for	O
non-linear	O
methods	O
.	O
the	O
number	O
of	O
required	O
correspondences	B
is	O
summarized	O
in	O
table	O
17.5	O
.	O
17.6	O
number	O
of	O
independent	O
equations	O
it	O
was	O
asserted	O
in	O
table	O
17.2	O
that	O
each	O
four-view	O
point	B
correspondence	O
gives	O
rise	O
to	O
16	O
linearly	O
independent	O
equations	O
in	O
the	O
entries	O
of	O
the	O
quadrifocal	O
tensor	B
.	O
we	O
now	O
examine	O
this	O
point	B
more	O
closely	O
.	O
given	O
sufﬁciently	O
many	O
point	B
matches	O
across	O
four	O
views	O
,	O
one	O
may	O
solve	O
for	O
the	O
tensor	B
qpqrs	O
.	O
once	O
q	O
is	O
known	O
,	O
it	O
is	O
possible	O
to	O
solve	O
for	O
the	O
camera	B
matrices	I
and	O
hence	O
compute	O
projective	B
structure	O
.	O
this	O
was	O
shown	O
in	O
[	O
heyden-95b	O
,	O
heyden-97c	O
,	O
hartley-98c	O
]	O
but	O
is	O
not	O
discussed	O
further	O
in	O
this	O
book	O
.	O
a	O
curious	O
phenomenon	O
oc-	O
curs	O
however	O
when	O
one	O
counts	O
the	O
number	O
of	O
point	O
matches	O
necessary	O
to	O
do	O
this	O
.	O
as	O
indicated	O
above	O
,	O
it	O
appears	O
to	O
be	O
the	O
case	O
that	O
each	O
point	B
match	O
gives	O
16	O
linearly	O
in-	O
dependent	O
equations	O
in	O
the	O
entries	O
of	O
the	O
tensor	O
qpqrs	O
,	O
and	O
it	O
seems	O
unlikely	O
that	O
the	O
equations	O
derived	O
from	O
two	O
totally	O
unrelated	O
sets	O
of	O
point	O
correspondences	B
could	O
have	O
any	O
dependencies	O
.	O
it	O
would	O
therefore	O
appear	O
that	O
from	O
ﬁve	O
point	O
correspondences	B
one	O
obtains	O
80	O
equations	O
,	O
which	O
is	O
enough	O
to	O
solve	O
for	O
the	O
81	O
entries	O
of	O
qpqrs	O
up	O
to	O
scale	O
.	O
from	O
this	O
argument	O
it	O
would	O
seem	O
that	O
it	O
is	O
possible	O
to	O
solve	O
for	O
the	O
tensor	B
from	O
only	O
ﬁve	O
point	B
matches	O
across	O
four	O
views	O
,	O
and	O
thence	O
one	O
may	O
solve	O
for	O
the	O
camera	B
matri-	O
ces	O
,	O
up	O
to	O
the	O
usual	O
projective	B
ambiguity	I
.	O
this	O
conclusion	O
however	O
is	O
contradicted	O
by	O
the	O
following	O
remark	O
.	O
•	O
it	O
is	O
not	O
possible	O
to	O
determine	O
the	O
positions	O
of	O
four	O
(	O
or	O
any	O
number	O
of	O
)	O
cameras	B
from	O
the	O
images	O
of	O
ﬁve	O
points	O
.	O
this	O
follows	O
from	O
the	O
counting	B
arguments	I
of	O
section	O
17.5.	O
obviously	O
there	O
is	O
some	O
error	O
in	O
our	O
counting	O
of	O
equations	O
.	O
the	O
truth	O
is	O
contained	O
in	O
the	O
following	O
.	O
result	O
17.1.	O
the	O
full	O
set	O
of	O
81	O
linear	B
equations	I
(	O
17.20	O
)	O
derived	O
from	O
a	O
single	O
point	O
correspondence	B
x	O
↔	O
x	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
across	O
four	O
views	O
contains	O
16	O
independent	O
constraints	B
on	O
qpqrs	O
.	O
furthermore	O
,	O
let	O
the	O
equations	O
be	O
written	O
as	O
aq	O
=	O
0	O
where	O
a	O
is	O
an	O
81	O
×	O
81	O
matrix	B
and	O
q	O
is	O
a	O
vector	O
containing	O
the	O
entries	O
of	O
qpqrs	O
.	O
then	O
the	O
16	O
non-zero	O
singular	O
values	O
of	O
a	O
are	O
all	O
equal	O
.	O
what	O
this	O
result	O
is	O
saying	O
is	O
that	O
indeed	O
as	O
expected	O
one	O
obtains	O
16	O
linearly	O
indepen-	O
dent	O
equations	O
from	O
one	O
point	B
correspondence	O
,	O
and	O
in	O
fact	O
it	O
is	O
possible	O
to	O
reduce	O
this	O
set	O
of	O
equations	O
by	O
an	O
orthogonal	B
transformation	O
(	O
multiplication	O
of	O
the	O
equation	O
matrix	B
a	O
on	O
the	O
left	O
by	O
an	O
orthogonal	B
matrix	O
u	O
)	O
to	O
a	O
set	O
of	O
16	O
orthogonal	B
equations	O
.	O
the	O
proof	O
17.6	O
number	O
of	O
independent	O
equations	O
429	O
is	O
postponed	O
until	O
the	O
end	O
of	O
this	O
section	O
.	O
the	O
surprising	O
fact	O
however	O
is	O
that	O
the	O
equa-	O
tion	O
sets	O
corresponding	O
to	O
two	O
unrelated	O
point	B
correspondences	O
have	O
a	O
dependency	O
,	O
as	O
stated	O
in	O
the	O
following	O
result	O
.	O
result	O
17.2.	O
the	O
set	O
of	O
equations	O
(	O
17.20–p419	O
)	O
derived	O
from	O
a	O
set	O
of	O
n	O
general	O
point	O
correspondences	B
across	O
four	O
views	O
has	O
rank	O
16n	O
−	O
(	O
n	O
2	O
)	O
=	O
n	O
(	O
n	O
−	O
the	O
notation	O
(	O
n	O
1	O
)	O
/2	O
.	O
thus	O
for	O
5	O
points	O
there	O
are	O
only	O
70	O
independent	O
equations	O
,	O
not	O
enough	O
to	O
solve	O
for	O
qpqrs	O
.	O
for	O
n	O
=	O
6	O
points	O
,	O
16n	O
−	O
(	O
n	O
2	O
)	O
=	O
81	O
,	O
and	O
we	O
have	O
enough	O
equations	O
to	O
solve	O
for	O
the	O
81	O
entries	O
of	O
qpqrs	O
.	O
2	O
)	O
means	O
the	O
number	O
of	O
choices	O
of	O
2	O
among	O
n	O
,	O
speciﬁcally	O
,	O
(	O
n	O
2	O
)	O
,	O
for	O
n	O
≤	O
5.	O
we	O
now	O
prove	O
the	O
two	O
results	O
above	O
.	O
the	O
key	O
point	B
in	O
the	O
proof	O
of	O
result	O
17.1	O
con-	O
cerns	O
the	O
singular	B
values	I
of	O
a	O
skew-symmetric	O
matrix	O
(	O
see	O
result	O
a4.1	O
(	O
p581	O
)	O
)	O
.	O
result	O
17.3.	O
a	O
3	O
×	O
3	O
skew-symmetric	O
matrix	O
has	O
two	O
equal	O
non-zero	O
singular	O
values	O
.	O
the	O
rest	O
of	O
the	O
proof	O
of	O
result	O
17.1	O
is	O
quite	O
straightforward	O
as	O
long	O
as	O
one	O
does	O
not	O
get	O
lost	O
in	O
notation	O
.	O
proof	O
.	O
(	O
result	O
17.1	O
)	O
the	O
full	O
set	O
of	O
81	O
equations	O
derived	O
from	O
a	O
single	O
point	O
correspon-	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
llszqpqrs	O
=	O
0wxyz	O
.	O
a	O
total	O
of	O
81	O
equations	O
dence	O
is	O
of	O
the	O
form	O
xiipwx	O
are	O
generated	O
by	O
varying	O
w	O
,	O
x	O
,	O
y	O
,	O
z	O
over	O
the	O
range	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
thus	O
,	O
the	O
equation	O
matrix	B
a	O
may	O
be	O
written	O
as	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kkryvx	O
(	O
cid:2	O
)	O
jjqxx	O
a	O
(	O
wxyz	O
)	O
(	O
pqrs	O
)	O
=	O
xiipwx	O
(	O
cid:2	O
)	O
jjqxx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kkryx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
llsz	O
(	O
17.26	O
)	O
where	O
the	O
indices	O
(	O
wxyz	O
)	O
index	O
the	O
row	O
and	O
(	O
pqrs	O
)	O
index	O
the	O
column	O
of	O
a.	O
we	O
will	O
consider	O
a	O
set	O
of	O
indices	O
,	O
such	O
as	O
(	O
wxyz	O
)	O
in	O
this	O
case	O
,	O
as	O
a	O
single	O
index	O
for	O
the	O
row	O
or	O
column	O
of	O
a	O
matrix	B
.	O
this	O
situation	O
will	O
be	O
indicated	O
by	O
enclosing	O
the	O
indices	O
in	O
parentheses	O
as	O
here	O
,	O
and	O
referring	O
to	O
them	O
as	O
a	O
combined	O
index	O
.	O
we	O
consider	O
now	O
the	O
expression	O
xiipw	O
.	O
this	O
may	O
be	O
considered	O
as	O
a	O
matrix	B
indexed	O
by	O
the	O
free	O
indices	O
p	O
and	O
w.	O
furthermore	O
,	O
since	O
xiipw	O
=	O
−xiiwp	O
we	O
see	O
that	O
it	O
is	O
a	O
skew-symmetric	O
matrix	O
,	O
and	O
hence	O
has	O
equal	O
singular	B
values	I
.	O
we	O
denote	O
this	O
matrix	B
by	O
swp	O
.	O
writing	O
result	O
17.3	O
using	O
tensor	O
notation	O
,	O
we	O
have	O
uw	O
a	O
swpvp	O
e	O
=	O
kdae	O
(	O
17.27	O
)	O
where	O
the	O
diagonal	O
matrix	B
d	O
is	O
as	O
in	O
result	O
17.3.	O
the	O
matrix	B
a	O
in	O
(	O
17.26	O
)	O
may	O
be	O
written	O
as	O
a	O
(	O
wxyz	O
)	O
(	O
pqrs	O
)	O
=	O
swps	O
(	O
cid:2	O
)	O
u	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
z	O
s	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
zs	O
.	O
consequently	O
,	O
applying	O
(	O
17.27	O
)	O
we	O
may	O
write	O
u	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
v	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
u	O
(	O
cid:2	O
)	O
x	O
s	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
daedbf	O
dcgddh	O
.	O
yr	O
xq	O
a	O
(	O
wxyz	O
)	O
(	O
pqrs	O
)	O
vp	O
e	O
v	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
s	O
h	O
=	O
kk	O
(	O
cid:2	O
)	O
(	O
17.28	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
k	O
(	O
cid:2	O
)	O
q	O
v	O
f	O
c	O
d	O
g	O
uw	O
a	O
b	O
now	O
,	O
writing	O
ˆu	O
(	O
wxyz	O
)	O
(	O
abcd	O
)	O
=	O
uw	O
a	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
ˆk	O
=	O
kk	O
k	O
k	O
u	O
(	O
cid:2	O
)	O
x	O
b	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
u	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
c	O
u	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
z	O
d	O
ˆv	O
(	O
pqrs	O
)	O
(	O
ef	O
gh	O
)	O
=	O
vp	O
e	O
(	O
cid:2	O
)	O
q	O
v	O
f	O
v	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
g	O
v	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
s	O
h	O
ˆd	O
(	O
abcd	O
)	O
(	O
ef	O
gh	O
)	O
=	O
daedbf	O
dcgddh	O
we	O
see	O
that	O
(	O
17.28	O
)	O
may	O
be	O
written	O
as	O
ˆu	O
(	O
wxyz	O
)	O
(	O
abcd	O
)	O
a	O
(	O
wxyz	O
)	O
(	O
pqrs	O
)	O
ˆv	O
(	O
pqrs	O
)	O
(	O
ef	O
gh	O
)	O
=	O
ˆkˆd	O
(	O
abcd	O
)	O
(	O
ef	O
gh	O
)	O
.	O
(	O
17.29	O
)	O
as	O
a	O
matrix	B
,	O
d	O
(	O
abcd	O
)	O
(	O
ef	O
gh	O
)	O
is	O
diagonal	O
with	O
16	O
non-zero	O
diagonal	O
entries	O
,	O
all	O
equal	O
to	O
430	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
unity	O
.	O
to	O
show	O
that	O
(	O
17.29	O
)	O
is	O
the	O
svd	O
of	O
the	O
matrix	O
a	O
(	O
wxyz	O
)	O
(	O
pqrs	O
)	O
,	O
and	O
hence	O
to	O
complete	O
the	O
proof	O
,	O
it	O
remains	O
only	O
to	O
show	O
that	O
u	O
(	O
wxyz	O
)	O
(	O
ef	O
gh	O
)	O
are	O
orthogonal	B
matrices	I
.	O
it	O
is	O
necessary	O
only	O
to	O
show	O
that	O
the	O
columns	O
are	O
orthonormal	O
.	O
this	O
is	O
straightforward	O
and	O
is	O
left	O
as	O
an	O
exercise	O
.	O
(	O
abcd	O
)	O
and	O
v	O
(	O
pqrs	O
)	O
(	O
cid:2	O
)	O
i	O
↔	O
y	O
(	O
cid:2	O
)	O
i	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
↔	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
and	O
yi	O
↔	O
y	O
proof	O
.	O
(	O
result	O
17.2	O
)	O
we	O
consider	O
two	O
point	O
correspondences	B
across	O
four	O
views	O
,	O
namely	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i.	O
these	O
give	O
rise	O
to	O
two	O
sets	O
of	O
equations	O
axq	O
=	O
0	O
and	O
ayq	O
=	O
0	O
of	O
the	O
form	O
(	O
17.26	O
)	O
.	O
each	O
of	O
these	O
ma-	O
trices	O
has	O
rank	O
16	O
,	O
and	O
if	O
the	O
rows	O
of	O
ax	O
are	O
independent	O
of	O
the	O
rows	O
of	O
ay	O
,	O
then	O
the	O
rank	O
of	O
the	O
combined	O
set	O
of	O
equations	O
is	O
32.	O
however	O
,	O
if	O
there	O
is	O
a	O
linear	B
dependence	O
between	O
the	O
rows	O
of	O
ax	O
and	O
those	O
of	O
ay	O
then	O
their	O
combined	O
rank	O
is	O
at	O
most	O
31.	O
we	O
deﬁne	O
a	O
vector	O
sx	O
with	O
combined	O
index	O
(	O
pqrs	O
)	O
by	O
s	O
(	O
pqrs	O
)	O
sy	O
is	O
similarly	O
deﬁned	O
.	O
we	O
will	O
demonstrate	O
that	O
st	O
y	O
ax	O
=	O
st	O
rows	O
of	O
ax	O
and	O
ay	O
are	O
linearly	O
dependent	O
.	O
expanding	O
st	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
s.	O
a	O
vector	O
=	O
xpx	O
x	O
ay	O
,	O
which	O
means	O
that	O
the	O
y	O
ax	O
gives	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
rx	O
(	O
cid:2	O
)	O
qx	O
x	O
y	O
st	O
ax	O
y	O
ax	O
=	O
s	O
(	O
wxyz	O
)	O
(	O
wxyz	O
)	O
(	O
pqrs	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
yy	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
xy	O
=	O
(	O
ywy	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
jx	O
=	O
(	O
xix	O
=	O
st	O
x	O
ay	O
.	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
z	O
)	O
xiipwx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
l	O
)	O
ywwpiy	O
(	O
cid:2	O
)	O
jjqxx	O
(	O
cid:2	O
)	O
xxqjy	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
kkryx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
yyrky	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
llsz	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
zzsl	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
y	O
,	O
y	O
(	O
cid:2	O
)	O
and	O
y	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
this	O
demonstrates	O
that	O
the	O
rows	O
of	O
ax	O
and	O
ay	O
are	O
dependent	O
,	O
and	O
their	O
combined	O
rank	O
is	O
at	O
most	O
31.	O
we	O
now	O
consider	O
the	O
possibility	O
that	O
the	O
combined	O
rank	O
is	O
less	O
than	O
31.	O
in	O
such	O
a	O
case	O
,	O
all	O
31	O
×	O
31	O
subdeterminants	O
of	O
the	O
matrix	O
[	O
axt	O
,	O
ayt	O
]	O
t	O
must	O
vanish	O
.	O
these	O
subdeterminants	O
may	O
be	O
expressed	O
as	O
polynomial	O
expressions	O
in	O
the	O
coefﬁcients	O
of	O
the	O
points	O
x	O
,	O
x	O
(	O
cid:2	O
)	O
.	O
these	O
24	O
coefﬁcients	O
together	O
generate	O
a	O
24-dimensional	O
space	O
.	O
thus	O
,	O
there	O
is	O
a	O
function	O
f	O
:	O
ir24	O
→	O
irn	O
for	O
some	O
n	O
(	O
equal	O
to	O
the	O
number	O
of	O
such	O
31	O
×	O
31	O
subdeterminants	O
)	O
,	O
such	O
that	O
the	O
equation	O
matrix	B
has	O
rank	O
less	O
than	O
31	O
only	O
on	O
the	O
set	O
of	O
zeros	O
of	O
the	O
function	O
f.	O
any	O
arbitrarily	O
chosen	O
example	O
(	O
omitted	O
)	O
may	O
be	O
used	O
to	O
show	O
that	O
the	O
function	O
f	O
is	O
not	O
identically	O
zero	O
.	O
it	O
follows	O
that	O
the	O
set	O
of	O
point	O
correspondences	B
for	O
which	O
the	O
set	O
of	O
equations	O
has	O
rank	O
less	O
than	O
31	O
is	O
a	O
variety	O
in	O
ir24	O
,	O
and	O
hence	O
is	O
nowhere	O
dense	O
.	O
thus	O
,	O
the	O
set	O
of	O
equations	O
generated	O
by	O
a	O
general	O
pair	O
of	O
point	O
correspondences	B
across	O
four	O
views	O
has	O
rank	O
31.	O
we	O
now	O
turn	O
to	O
the	O
general	O
case	O
of	O
n	O
point	B
correspondences	O
across	O
all	O
four	O
views	O
.	O
note	O
that	O
the	O
linear	B
relationship	O
that	O
holds	O
for	O
two	O
point	B
correspondences	O
is	O
non-generic	O
,	O
but	O
depends	O
on	O
the	O
pair	O
of	O
correspondences	O
.	O
in	O
general	O
,	O
therefore	O
,	O
given	O
n	O
point	B
correspon-	O
dences	O
,	O
there	O
will	O
be	O
(	O
n	O
2	O
)	O
such	O
relationships	O
.	O
this	O
reduces	O
the	O
dimension	O
of	O
the	O
space	O
spanned	O
by	O
the	O
set	O
of	O
equations	O
to	O
16n	O
−	O
(	O
n	O
2	O
)	O
as	O
required	O
.	O
the	O
three-view	O
case	O
.	O
similar	O
arguments	O
hold	O
in	O
the	O
three-view	O
case	O
.	O
it	O
can	O
be	O
proved	O
in	O
the	O
same	O
manner	O
that	O
the	O
nine	O
equations	O
arising	O
from	O
a	O
point	B
match	O
contain	O
four	O
independent	O
equations	O
.	O
this	O
is	O
left	O
to	O
an	O
exercise	O
(	O
see	O
page	O
432	O
)	O
.	O
17.7	O
choosing	O
equations	O
17.7	O
choosing	O
equations	O
431	O
in	O
section	O
17.6	O
a	O
proof	O
was	O
given	O
that	O
the	O
singular	B
values	I
of	O
the	O
full	O
set	O
of	O
equations	O
derived	O
from	O
four	O
point	B
equations	I
are	O
all	O
equal	O
.	O
the	O
proof	O
may	O
easily	O
be	O
adapted	O
to	O
the	O
three-view	O
case	O
as	O
well	O
(	O
see	O
exercise	O
,	O
page	O
432	O
)	O
.	O
the	O
key	O
point	B
in	O
the	O
argument	O
is	O
that	O
the	O
two	O
non-zero	O
singular	B
values	I
of	O
a	O
3×	O
3	O
skew-symmetric	O
matrix	O
are	O
equal	O
.	O
this	O
proof	O
may	O
clearly	O
be	O
extended	O
to	O
apply	O
to	O
any	O
of	O
the	O
other	O
sets	O
of	O
equations	O
derived	O
from	O
line	O
or	O
point	B
correspondences	O
given	O
in	O
sections	O
17.2	O
and	O
17.3.	O
we	O
consider	O
still	O
the	O
four-view	O
case	O
.	O
the	O
results	O
on	O
singular	B
values	I
show	O
that	O
it	O
is	O
in	O
general	O
advisable	O
to	O
include	O
all	O
81	O
equations	O
derived	O
from	O
this	O
correspondence	B
,	O
rather	O
than	O
selecting	O
just	O
16	O
independent	O
equations	O
.	O
this	O
will	O
avoid	O
difﬁculties	O
with	O
near	O
singular	O
situations	O
.	O
this	O
conclusion	O
is	O
supported	O
by	O
experimental	O
observation	O
.	O
indeed	O
,	O
numerical	O
examples	B
show	O
that	O
the	O
condition	O
of	O
a	O
set	O
of	O
equations	O
derived	O
from	O
several	O
point	B
correspondences	O
is	O
substantially	O
better	O
when	O
all	O
equations	O
are	O
included	O
for	O
each	O
point	B
correspondence	O
.	O
in	O
this	O
context	O
,	O
the	O
condition	O
of	O
the	O
equation	O
set	O
is	O
given	O
by	O
the	O
ratio	O
of	O
the	O
ﬁrst	O
(	O
largest	O
)	O
to	O
the	O
n-th	O
singular	O
value	O
,	O
where	O
n	O
is	O
the	O
number	O
of	O
linearly	O
independent	O
equations	O
.	O
including	O
all	O
81	O
equations	O
rather	O
than	O
just	O
16	O
means	O
that	O
the	O
set	O
of	O
equations	O
is	O
larger	O
,	O
leading	O
to	O
increased	O
complexity	O
of	O
solution	O
.	O
this	O
can	O
be	O
remedied	O
as	O
follows	O
.	O
the	O
basis	O
for	O
the	O
equality	O
of	O
the	O
singular	O
values	O
is	O
that	O
swp	O
=	O
xiipw	O
and	O
the	O
other	O
similarly	O
deﬁned	O
terms	O
are	O
skew	O
symmetric	B
matrices	I
,	O
and	O
hence	O
have	O
equal	O
singular	B
values	I
.	O
the	O
same	O
effect	O
can	O
be	O
achieved	O
by	O
any	O
other	O
matrix	B
s	O
with	O
equal	O
singular	B
values	I
.	O
we	O
require	O
only	O
that	O
the	O
columns	O
of	O
s	O
should	O
represent	O
lines	B
passing	O
through	O
the	O
point	B
x	O
(	O
otherwise	O
stated	O
swpxw	O
=	O
0p	O
)	O
.	O
matrix	B
s	O
will	O
have	O
equal	O
singular	B
values	I
if	O
its	O
columns	O
are	O
orthonormal	O
.	O
these	O
conditions	O
may	O
be	O
achieved	O
with	O
s	O
being	O
a	O
3×	O
2	O
matrix	B
.	O
if	O
this	O
is	O
done	O
for	O
the	O
point	B
in	O
each	O
view	O
the	O
total	O
number	O
of	O
equations	O
will	O
be	O
reduced	B
from	O
34	O
=	O
81	O
to	O
24	O
=	O
16	O
,	O
and	O
the	O
16	O
equations	O
will	O
be	O
orthogonal	B
.	O
a	O
convenient	O
way	O
of	O
choosing	O
s	O
is	O
to	O
use	O
a	O
householder	O
matrix	B
(	O
see	O
section	O
a4.1.2	O
(	O
p580	O
)	O
)	O
as	O
shown	O
below	O
.	O
this	O
discussion	O
also	O
applies	O
to	O
the	O
trifocal	B
tensor	I
,	O
allowing	O
us	O
to	O
reduce	O
the	O
number	O
of	O
equations	O
from	O
9	O
to	O
4	O
,	O
while	O
retaining	O
equal	O
singular	B
values	I
.	O
summarizing	O
this	O
discussion	O
for	O
the	O
trifocal	B
tensor	I
case	O
:	O
•	O
given	O
a	O
point	B
correspondence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
of	O
the	O
form	O
across	O
three	O
views	O
,	O
generate	O
equations	O
(	O
cid:2	O
)	O
xiˆl	O
qx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ˆl	O
ry	O
t	O
qr	O
i	O
=	O
0xy	O
for	O
x	O
,	O
y	O
=	O
1	O
,	O
2	O
q2	O
are	O
two	O
lines	O
through	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
where	O
ˆl	O
q1	O
and	O
ˆl	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
similarly	O
ˆl	O
qx	O
and	O
ˆl	O
ry	O
)	O
.	O
a	O
convenient	O
way	O
to	O
ﬁnd	O
ˆl	O
ry	O
is	O
as	O
follows	O
.	O
(	O
cid:2	O
)	O
qh	O
(	O
cid:2	O
)	O
qx	O
=	O
δ3x	O
and	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ry	O
such	O
that	O
x	O
qx	O
and	O
h	O
(	O
i	O
)	O
find	O
householder	O
matrices	O
h	O
represented	O
by	O
orthonormal	O
vectors	O
(	O
and	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
rh	O
(	O
cid:2	O
)	O
ry	O
=	O
δ3y	O
.	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
for	O
x	O
,	O
y	O
=	O
1	O
,	O
2	O
set	O
ˆl	O
qx	O
=	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
qx	O
and	O
ˆl	O
ry	O
=	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ry	O
.	O
it	O
is	O
evident	O
that	O
essentially	O
this	O
method	O
will	O
work	O
for	O
all	O
the	O
types	O
of	O
equations	O
summarized	O
in	O
table	O
17.1	O
(	O
p417	O
)	O
and	O
table	O
17.2	O
(	O
p421	O
)	O
.	O
432	O
17	O
n-linearities	O
and	O
multiple	O
view	O
tensors	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
ql	O
r	O
this	O
chapter	O
suggests	O
that	O
the	O
most	O
basic	O
relations	O
are	O
the	O
point–line–line	O
correspon-	O
t	O
qr	O
dence	O
equation	O
xil	O
i	O
=	O
0	O
in	O
the	O
three-view	O
case	O
,	O
and	O
the	O
line-correspondence	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
equation	O
lpl	O
s	O
qpqrs	O
=	O
0	O
for	O
four	O
views	O
.	O
indeed	O
numerical	O
robustness	O
may	O
be	O
en-	O
hanced	O
by	O
reducing	O
other	O
correspondences	B
to	O
this	O
type	O
of	O
correspondence	O
,	O
for	O
carefully	O
selected	O
lines	B
.	O
(	O
cid:2	O
)	O
ql	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
r	O
l	O
17.8	O
closure	O
17.8.1	O
the	O
literature	O
although	O
using	O
a	O
slightly	O
different	O
approach	O
,	O
this	O
chapter	O
summarizes	O
previous	O
results	O
of	O
[	O
triggs-95	O
]	O
and	O
faugeras	O
and	O
mourrain	O
[	O
faugeras-95a	O
]	O
on	O
the	O
derivation	B
of	O
multi-	O
linear	B
relationships	O
between	O
corresponding	O
image	O
coordinates	O
.	O
the	O
formulae	O
for	O
re-	O
lations	O
between	O
mixed	O
point	O
and	O
line	O
correspondences	O
are	O
extensions	O
of	O
the	O
results	O
of	O
[	O
hartley-95b	O
,	O
hartley-97a	O
]	O
.	O
the	O
enumeration	O
of	O
the	O
complete	O
set	O
of	O
multilinear	O
relations	O
given	O
in	O
table	O
17.1-	O
(	O
p417	O
)	O
and	O
table	O
17.2	O
(	O
p421	O
)	O
,	O
formulae	O
for	O
the	O
multifocal	O
tensors	O
,	O
and	O
the	O
analysis	O
of	O
the	O
number	O
of	O
independent	O
equations	O
derived	O
from	O
point	O
correspondences	O
,	O
are	O
adapted	O
from	O
[	O
hartley-95a	O
]	O
.	O
a	O
similar	O
analysis	O
of	O
the	O
multifocal	O
tensors	O
has	O
also	O
appeared	O
in	O
[	O
heyden-98	O
]	O
.	O
the	O
quadrifocal	B
tensor	I
was	O
probably	O
ﬁrst	O
discovered	O
by	O
[	O
triggs-95	O
]	O
.	O
the	O
quadri-	O
linear	B
constraints	O
and	O
their	O
associated	O
tensor	B
have	O
been	O
described	O
in	O
several	O
papers	O
[	O
triggs-95	O
,	O
faugeras-95a	O
,	O
shashua-95b	O
,	O
heyden-95b	O
,	O
heyden-97c	O
]	O
.	O
the	O
double	O
(	O
or	O
grassmann–cayley	O
)	O
algebra	O
was	O
introduced	O
into	O
the	O
computer	O
vision	O
literature	O
in	O
[	O
carlsson-93	O
]	O
,	O
see	O
also	O
[	O
faugeras-95a	O
,	O
faugeras-97	O
]	O
for	O
further	O
applica-	O
tions	O
.	O
an	O
algorithm	B
for	O
computing	B
the	O
quadrifocal	B
tensor	I
and	O
an	O
algorithm	B
for	O
reconstruct-	O
ing	O
it	O
based	O
on	O
the	O
reduced	B
tensor	O
was	O
given	O
in	O
(	O
[	O
heyden-95b	O
,	O
heyden-97c	O
]	O
)	O
.	O
a	O
later	O
paper	O
[	O
hartley-98c	O
]	O
reﬁned	O
this	O
algorithm	B
.	O
17.8.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
determine	O
the	O
properties	B
of	O
the	O
afﬁne	B
quadrifocal	O
tensor	B
,	O
i.e	O
.	O
the	O
quadrifocal	B
tensor	I
computed	O
from	B
afﬁne	I
camera	I
matrices	O
.	O
in	O
particular	O
using	O
the	O
deter-	O
minant	O
deﬁnition	B
of	O
the	O
tensor	B
(	O
17.21–p419	O
)	O
,	O
verify	O
the	O
number	O
of	O
non-zero	O
elements	O
given	O
in	O
table	O
17.4	O
.	O
(	O
ii	O
)	O
show	O
that	O
the	O
9	O
linear	B
equations	I
(	O
17.11–p415	O
)	O
derived	O
from	O
a	O
single	O
point	O
cor-	O
respondence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
across	O
three	O
views	O
contains	O
4	O
linearly	O
independent	O
equations	O
.	O
furthermore	O
,	O
let	O
the	O
equations	O
be	O
written	O
as	O
at	O
=	O
0	O
where	O
a	O
is	O
a	O
9	O
×	O
27	O
matrix	B
.	O
then	O
the	O
4	O
non-zero	O
singular	O
values	O
of	O
a	O
are	O
equal	O
.	O
unlike	O
the	O
four-view	O
case	O
,	O
the	O
equations	O
resulting	O
from	O
different	O
point	B
matches	O
are	O
linearly	O
independent	O
,	O
so	O
n	O
point	B
matches	O
produce	O
4n	O
independent	O
equations	O
.	O
(	O
iii	O
)	O
if	O
a	O
canonical	O
afﬁne	O
basis	O
is	O
chosen	O
for	O
the	O
image	O
coordinates	O
such	O
that	O
three	O
corresponding	O
points	O
have	O
coordinates	B
(	O
0	O
,	O
0	O
)	O
,	O
(	O
1	O
,	O
0	O
)	O
,	O
(	O
0	O
,	O
1	O
)	O
in	O
each	O
view	O
,	O
then	O
the	O
resulting	O
tensors	O
have	O
a	O
simpler	O
form	O
.	O
these	O
“	O
reduced	B
tensors	O
”	O
have	O
a	O
greater	O
number	O
of	O
zero	O
elements	O
than	O
the	O
general	O
form	O
of	O
the	O
tensors	O
.	O
for	O
example	O
,	O
in	O
17.8	O
closure	O
433	O
the	O
case	O
of	O
the	O
reduced	O
fundamental	B
matrix	I
the	O
diagonal	O
elements	O
are	O
zero	O
,	O
and	O
the	O
reduced	B
trifocal	I
tensor	I
has	O
only	O
15	O
nonzero	O
entries	O
.	O
also	O
the	O
tensors	O
are	O
speciﬁed	O
by	O
fewer	O
parameters	B
,	O
e.g	O
.	O
four	O
in	O
the	O
case	O
of	O
the	O
reduced	O
fundamental	B
matrix	I
,	O
as	O
effectively	O
the	O
basis	O
points	O
specify	O
the	O
other	O
parameters	B
.	O
further	O
details	O
are	O
given	O
in	O
[	O
heyden-95b	O
,	O
heyden-95a	O
]	O
.	O
(	O
iv	O
)	O
show	O
that	O
if	O
the	O
four	O
camera	O
centres	O
are	O
coplanar	O
then	O
the	O
quadrifocal	B
tensor	I
has	O
28	O
geometric	B
degrees	O
of	O
freedom	O
.	O
18	O
n	O
-view	O
computational	O
methods	O
this	O
chapter	O
describes	O
computational	O
methods	O
for	O
estimating	O
a	O
projective	B
or	O
afﬁne	B
re-	O
construction	O
from	O
a	O
set	O
of	O
images	O
–	O
in	O
particular	O
where	O
the	O
number	O
of	O
views	O
is	O
large	O
.	O
we	O
start	O
with	O
the	O
most	O
general	O
case	O
which	O
is	O
that	O
of	O
bundle	O
adjustment	O
for	O
a	O
projec-	O
tive	O
reconstruction	B
.	O
this	O
is	O
then	O
specialized	O
to	O
afﬁne	O
cameras	B
and	O
the	O
important	O
fac-	O
torization	O
algorithm	B
introduced	O
.	O
a	O
generalization	O
of	O
this	O
algorithm	B
to	O
non-rigid	B
scenes	O
is	O
given	O
.	O
a	O
second	O
specialization	O
of	O
bundle	O
adjustment	O
is	O
then	O
described	O
for	O
the	O
case	O
of	O
scenes	O
containing	O
planes	O
.	O
finally	O
we	O
discuss	O
methods	O
for	O
obtaining	O
point	B
corre-	O
spondences	O
throughout	O
an	O
image	O
sequence	O
and	O
a	O
projective	B
reconstruction	I
from	O
these	O
correspondences	B
.	O
18.1	O
projective	B
reconstruction	I
–	O
bundle	B
adjustment	I
consider	O
a	O
situation	O
in	O
which	O
a	O
set	O
of	O
3d	O
points	O
xj	O
is	O
viewed	O
by	O
a	O
set	O
of	O
cameras	O
with	O
matrices	O
pi	O
.	O
denote	O
by	O
xi	O
j	O
the	O
coordinates	B
of	O
the	O
j-th	O
point	B
as	O
seen	O
by	O
the	O
i-th	O
camera	B
.	O
we	O
wish	O
to	O
solve	O
the	O
following	O
reconstruction	B
problem	O
:	O
given	O
the	O
set	O
of	O
image	O
coor-	O
dinates	O
xi	O
j	O
ﬁnd	O
the	O
set	O
of	B
camera	I
matrices	O
,	O
pi	O
,	O
and	O
the	O
points	O
xj	O
such	O
that	O
pixj	O
=	O
xi	O
j.	O
without	O
further	O
restriction	O
on	O
the	O
pi	O
or	O
xj	O
,	O
such	O
a	O
reconstruction	B
is	O
a	O
projective	B
recon-	O
struction	O
,	O
because	O
the	O
points	O
xj	O
may	O
differ	O
by	O
an	O
arbitrary	O
3d	O
projective	B
transformation	I
from	O
the	O
true	O
reconstruction	B
.	O
bundle	B
adjustment	I
.	O
if	O
the	O
image	O
measurements	O
are	O
noisy	O
then	O
the	O
equations	O
xi	O
j	O
=	O
pixj	O
will	O
not	O
be	O
satisﬁed	O
exactly	O
.	O
in	O
this	O
case	O
we	O
seek	O
the	O
maximum	O
like-	O
lihood	O
(	O
ml	O
)	O
solution	B
assuming	O
that	O
the	O
measurement	O
noise	O
is	O
gaussian	O
:	O
we	O
wish	O
to	O
estimate	O
projection	B
matrices	O
ˆpi	O
and	O
3d	O
points	O
(	O
cid:23	O
)	O
xj	O
which	O
project	O
exactly	O
to	O
image	O
points	O
j	O
=	O
ˆpi	O
(	O
cid:23	O
)	O
xj	O
,	O
and	O
also	O
minimize	O
the	O
image	O
distance	O
between	O
the	O
reprojected	O
point	B
j	O
for	O
every	O
view	O
in	O
which	O
the	O
3d	O
point	B
appears	O
,	O
j	O
as	O
ˆxi	O
ˆxi	O
and	O
detected	O
(	O
measured	O
)	O
image	O
points	O
xi	O
i.e	O
.	O
(	O
cid:7	O
)	O
ij	O
,	O
(	O
cid:23	O
)	O
xj	O
min	O
ˆp	O
i	O
d	O
(	O
ˆpi	O
(	O
cid:23	O
)	O
xj	O
,	O
xi	O
j	O
)	O
2	O
(	O
18.1	O
)	O
where	O
d	O
(	O
x	O
,	O
y	O
)	O
is	O
the	O
geometric	B
image	O
distance	B
between	O
the	O
homogeneous	O
points	O
x	O
and	O
y.	O
this	O
estimation	B
involving	O
minimizing	O
the	O
reprojection	O
error	B
is	O
known	O
as	O
bundle	B
adjustment	I
–	O
it	O
involves	O
adjusting	O
the	O
bundle	O
of	O
rays	O
between	O
each	O
camera	B
centre	I
and	O
434	O
18.1	O
projective	B
reconstruction	I
–	O
bundle	B
adjustment	I
435	O
the	O
set	O
of	O
3d	O
points	O
(	O
and	O
equivalently	O
between	O
each	O
3d	O
point	O
and	O
the	O
set	O
of	B
camera	I
centres	O
)	O
.	O
bundle	B
adjustment	I
should	O
generally	O
be	O
used	O
as	O
a	O
ﬁnal	O
step	O
of	O
any	O
reconstruction	B
algorithm	O
.	O
this	O
method	O
has	O
the	O
advantages	O
of	O
being	O
tolerant	O
of	O
missing	O
data	O
while	O
providing	O
a	O
true	O
ml	O
estimate	O
.	O
at	O
the	O
same	O
time	O
it	O
allows	O
assignment	O
of	O
individual	O
covariances	O
(	O
or	O
more	O
general	O
pdfs	O
)	O
to	O
each	O
measurement	O
and	O
may	O
also	O
be	O
extended	O
to	O
include	O
estimates	O
of	O
priors	O
and	O
constraints	B
on	O
camera	B
parameters	I
or	O
point	B
positions	O
.	O
in	O
short	O
,	O
it	O
would	O
seem	O
to	O
be	O
an	O
ideal	O
algorithm	O
,	O
except	O
for	O
the	O
fact	O
that	O
:	O
(	O
i	O
)	O
it	O
requires	O
a	O
good	O
initialization	B
to	O
be	O
provided	O
,	O
and	O
(	O
ii	O
)	O
it	O
can	O
become	O
an	O
extremely	O
large	O
minimiza-	O
tion	O
problem	O
because	O
of	O
the	O
number	O
of	O
parameters	O
involved	O
.	O
we	O
will	O
discuss	O
brieﬂy	O
these	O
two	O
points	O
.	O
iterative	B
minimization	I
.	O
since	O
each	O
camera	B
has	O
11	O
degrees	B
of	I
freedom	I
and	O
each	O
3-	O
space	O
point	O
3	O
degrees	B
of	I
freedom	I
,	O
a	O
reconstruction	B
involving	O
n	O
points	O
over	O
m	O
views	O
requires	O
minimization	B
over	O
3n	O
+	O
11m	O
parameters	B
.	O
in	O
fact	O
,	O
since	O
entities	O
are	O
often	O
over-	O
parametrized	O
(	O
e.g	O
.	O
using	O
12	O
parameters	B
for	O
the	O
homogeneous	O
p	O
matrix	B
)	O
this	O
may	O
be	O
a	O
lower	O
bound	O
.	O
if	O
the	O
levenberg–marquardt	O
algorithm	B
is	O
used	O
to	O
minimize	O
(	O
18.1	O
)	O
then	O
matrices	O
of	O
dimension	O
(	O
3n	O
+	O
11m	O
)	O
×	O
(	O
3n	O
+	O
11m	O
)	O
must	O
be	O
factored	O
(	O
or	O
sometimes	O
in-	O
verted	O
)	O
.	O
as	O
m	O
and	O
n	O
increase	O
this	O
becomes	O
extremely	O
costly	O
,	O
and	O
eventually	O
impossible	O
.	O
there	O
are	O
several	O
solutions	O
to	O
this	O
problem	O
:	O
(	O
i	O
)	O
reduce	O
n	O
and/or	O
m.	O
do	O
not	O
include	O
all	O
the	O
views	O
or	O
all	O
the	O
points	O
,	O
and	O
ﬁll	O
these	O
in	O
later	O
by	O
resectioning	B
or	O
triangulation	B
respectively	O
;	O
or	O
,	O
partition	O
the	O
data	O
into	O
several	O
sets	O
,	O
bundle	O
adjust	O
each	O
set	O
separately	O
and	O
then	O
merge	O
.	O
such	O
strategies	O
are	O
discussed	O
further	O
in	O
section	O
18.6	O
.	O
(	O
ii	O
)	O
interleave	O
.	O
alternate	O
minimizing	B
reprojection	O
error	B
by	O
varying	O
the	O
cameras	B
with	O
minimizing	B
reprojection	O
error	B
by	O
varying	O
the	O
points	O
.	O
since	O
each	O
point	B
is	O
estimated	O
independently	O
given	O
ﬁxed	O
cameras	O
,	O
and	O
similarly	O
each	O
camera	B
is	O
esti-	O
mated	O
independently	O
from	O
ﬁxed	B
points	I
,	O
the	O
largest	O
matrix	B
that	O
must	O
be	O
inverted	O
is	O
the	O
11	O
×	O
11	O
matrix	B
used	O
to	O
estimate	O
one	O
camera	B
.	O
interleaving	O
minimizes	O
the	O
same	O
cost	O
function	O
as	O
bundle	B
adjustment	I
,	O
so	O
the	O
same	O
solution	O
should	O
be	O
obtained	O
(	O
provided	O
there	O
is	O
a	O
unique	O
minimum	O
)	O
,	O
but	O
it	O
may	O
take	O
longer	O
to	O
con-	O
verge	O
.	O
interleaving	O
is	O
compared	O
with	O
bundle	O
adjustment	O
in	O
[	O
triggs-00a	O
]	O
.	O
(	O
iii	O
)	O
sparse	B
methods	I
.	O
these	O
are	O
described	O
in	O
appendix	O
6	O
(	O
p597	O
)	O
.	O
initial	B
solution	I
.	O
several	O
methods	O
for	O
initialization	B
are	O
described	O
in	O
the	O
following	O
sec-	O
tions	O
.	O
if	O
the	O
problem	O
is	O
restricted	O
to	O
afﬁne	O
cameras	B
then	O
factorization	B
(	O
section	O
18.2	O
)	O
gives	O
a	O
closed	O
form	O
optimal	O
solution	B
provided	O
points	O
are	O
imaged	O
in	O
every	O
view	O
.	O
even	O
with	O
projective	O
cameras	B
there	O
is	O
an	O
(	O
iterative	B
)	O
factorization	B
method	O
(	O
section	O
18.4	O
)	O
avail-	O
able	O
provided	O
points	O
are	O
imaged	O
in	O
every	O
view	O
.	O
if	O
there	O
is	O
more	O
information	O
available	O
on	O
the	O
data	O
,	O
for	O
example	O
that	O
it	O
is	O
partly	O
coplanar	O
,	O
then	O
again	O
a	O
closed	O
form	O
solution	O
is	O
possible	O
(	O
section	O
18.5	O
)	O
.	O
finally	O
,	O
hierarchical	O
methods	O
can	O
be	O
used	O
as	O
described	O
in	O
section	O
18.6	O
for	O
the	O
case	O
where	O
points	O
are	O
not	O
visible	O
in	O
every	O
view	O
.	O
436	O
18	O
n-view	O
computational	O
methods	O
18.2	O
afﬁne	B
reconstruction	I
–	O
the	O
factorization	B
algorithm	O
in	O
this	O
section	O
we	O
describe	O
reconstruction	B
from	O
a	O
set	O
of	O
image	O
point	B
correspondences	O
for	O
images	O
acquired	O
by	O
afﬁne	B
cameras	I
.	O
as	O
described	O
in	O
section	O
17.5.1	O
the	O
reconstruction	B
in	O
this	O
case	O
is	O
afﬁne	B
.	O
the	O
factorization	B
algorithm	O
of	O
tomasi	O
and	O
kanade	O
[	O
tomasi-92	O
]	O
to	O
be	O
presented	O
be-	O
low	O
and	O
summarized	O
in	O
algorithm	O
18.1	O
has	O
the	O
following	O
property	O
:	O
•	O
under	O
an	O
assumption	O
of	O
isotropic	O
mean-zero	O
gaussian	O
noise	B
independent	O
and	O
equal	O
for	O
each	O
measured	O
point	B
,	O
factorization	B
achieves	O
a	O
maximum	O
likelihood	O
afﬁne	B
recon-	O
struction	O
.	O
this	O
fact	O
was	O
ﬁrst	O
pointed	O
out	O
by	O
reid	O
and	O
murray	O
[	O
reid-96	O
]	O
.	O
however	O
,	O
the	O
method	O
requires	O
a	O
measurement	O
of	O
each	O
point	B
in	O
all	O
views	O
.	O
this	O
is	O
a	O
limitation	O
in	O
practice	O
,	O
since	O
matched	O
points	O
may	O
be	O
absent	O
in	O
some	O
views	O
.	O
an	O
afﬁne	B
camera	I
may	O
be	O
characterized	O
by	O
having	O
its	O
last	O
row	O
equal	O
to	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
in	O
this	O
section	O
,	O
however	O
,	O
we	O
will	O
denote	O
it	O
somewhat	O
differently	O
,	O
separating	O
out	O
the	O
translation	O
and	O
the	O
pure	O
linear	B
transformation	O
part	O
of	O
the	O
camera	O
map	O
.	O
thus	O
we	O
write	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
x	O
y	O
=	O
m	O
	O
+	O
t	O
	O
x	O
y	O
z	O
where	O
m	O
is	O
a	O
2	O
×	O
3	O
matrix	B
and	O
t	O
a	O
2-vector	O
.	O
from	O
here	O
on	O
for	O
ease	O
of	O
readability	O
x	O
represents	O
an	O
inhomogeneous	O
image	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
)	O
t	O
,	O
and	O
x	O
an	O
inhomogeneous	O
world	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t.	O
our	O
goal	O
is	O
to	O
ﬁnd	O
a	O
reconstruction	B
to	O
minimize	O
geometric	B
error	I
in	O
image	O
coordinate	O
measurements	O
.	O
that	O
is	O
,	O
we	O
wish	O
to	O
estimate	O
cameras	B
{	O
mi	O
,	O
ti	O
}	O
and	O
3d	O
points	O
{	O
xj	O
}	O
such	O
that	O
the	O
distance	B
between	O
the	O
estimated	O
image	O
points	O
ˆxi	O
j	O
=	O
mixj	O
+	O
ti	O
and	O
measured	O
image	O
points	O
xi	O
j	O
is	O
minimized	O
(	O
cid:7	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
−	O
ˆxi	O
j	O
min	O
mi	O
,	O
ti	O
,	O
xj	O
ij	O
=	O
min	O
mi	O
,	O
ti	O
,	O
xj	O
ij	O
(	O
cid:7	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
−	O
(	O
mixj	O
+	O
ti	O
)	O
.	O
(	O
18.2	O
)	O
as	O
is	O
common	O
in	O
such	O
minimization	B
problems	O
the	O
translation	O
vector	O
ti	O
can	O
be	O
elimi-	O
nated	O
in	O
advance	O
by	O
choosing	O
the	O
centroid	O
of	O
the	O
points	O
as	O
the	O
origin	O
of	O
the	O
coordinate	O
system	O
.	O
this	O
is	O
a	O
consequence	O
of	O
the	O
geometric	O
fact	O
that	O
an	O
afﬁne	B
camera	I
maps	O
the	O
cen-	O
troid	O
of	O
a	O
set	O
of	O
3d	O
points	O
to	O
the	O
centroid	O
of	O
their	O
projections	O
.	O
thus	O
,	O
if	O
the	O
coordinate	O
origin	O
is	O
chosen	O
as	O
the	O
centroid	O
of	O
the	O
3d	O
points	O
and	O
of	O
each	O
set	O
of	O
image	O
points	O
then	O
it	O
follows	O
that	O
ti	O
=	O
0.	O
this	O
step	O
requires	O
that	O
the	O
same	O
n	O
points	O
be	O
imaged	O
in	O
all	O
views	O
,	O
i.e	O
.	O
that	O
there	O
are	O
no	O
views	O
in	O
which	O
the	O
image	O
coordinates	O
of	O
any	O
point	B
are	O
unknown	O
.	O
an	O
analytical	O
derivation	B
of	O
this	O
result	O
goes	O
like	O
this	O
.	O
the	O
minimization	B
with	O
respect	O
to	O
ti	O
requires	O
that	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xk	O
j	O
(	O
cid:7	O
)	O
kj	O
∂	O
∂ti	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
−	O
(	O
mkxj	O
+	O
tk	O
)	O
=	O
0	O
which	O
after	O
a	O
brief	O
calculation	O
reduces	O
to	O
ti	O
=	O
(	O
cid:8	O
)	O
xi	O
(	O
cid:9	O
)	O
−m	O
i	O
(	O
cid:8	O
)	O
x	O
(	O
cid:9	O
)	O
,	O
where	O
the	O
centroids	O
are	O
18.2	O
afﬁne	B
reconstruction	I
–	O
the	O
factorization	B
algorithm	O
437	O
objective	O
given	O
n	O
≥	O
4	O
image	O
point	O
correspondences	B
over	O
m	O
views	O
xi	O
j	O
,	O
j	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
;	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
,	O
determine	O
afﬁne	B
camera	I
matrices	O
{	O
mi	O
,	O
ti	O
}	O
and	O
3d	O
points	O
{	O
xj	O
}	O
such	O
that	O
the	O
reprojection	B
error	I
(	O
cid:7	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
−	O
(	O
mixj	O
+	O
ti	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
is	O
minimized	O
over	O
{	O
mi	O
,	O
ti	O
,	O
xj	O
}	O
,	O
with	O
mi	O
a	O
2	O
×	O
3	O
matrix	B
,	O
xj	O
a	O
3-vector	O
,	O
and	O
xi	O
ti	O
are	O
2-vectors	O
.	O
j	O
=	O
(	O
xi	O
j	O
,	O
yi	O
j	O
)	O
t	O
and	O
ij	O
algorithm	B
(	O
i	O
)	O
computation	B
of	I
translations	O
.	O
each	O
translation	O
ti	O
is	O
computed	O
as	O
the	O
centroid	O
of	B
points	I
in	O
image	O
i	O
,	O
namely	O
(	O
ii	O
)	O
centre	B
the	O
data	O
.	O
centre	B
the	O
points	O
in	O
each	O
image	O
by	O
expressing	O
their	O
coordinates	B
with	O
respect	O
to	O
the	O
centroid	O
:	O
(	O
cid:7	O
)	O
j	O
ti	O
=	O
(	O
cid:8	O
)	O
xi	O
(	O
cid:9	O
)	O
=	O
1	O
n	O
xi	O
j.	O
j	O
←	O
xi	O
xi	O
j	O
−	O
(	O
cid:8	O
)	O
xi	O
(	O
cid:9	O
)	O
.	O
henceforth	O
work	O
with	O
these	O
centred	O
coordinates	B
.	O
(	O
iii	O
)	O
construct	O
the	O
2m	O
×	O
n	O
measurement	B
matrix	I
w	O
from	O
the	O
centred	O
data	O
,	O
as	O
deﬁned	O
(	O
iv	O
)	O
then	O
the	O
matrices	O
mi	O
are	O
obtained	O
from	O
the	O
ﬁrst	O
three	O
columns	O
of	O
u	O
multiplied	O
by	O
the	O
in	O
(	O
18.5	O
)	O
,	O
and	O
compute	O
its	O
svd	O
w	O
=	O
udvt	O
.	O
singular	B
values	I
:	O
	O
=	O
[	O
σ1u1	O
σ2u2	O
σ3u3	O
]	O
.	O
	O
m1	O
m2	O
...	O
mm	O
the	O
vectors	O
ti	O
are	O
as	O
computed	O
in	O
step	O
(	O
i	O
)	O
and	O
the	O
3d	O
structure	B
is	O
read	O
from	O
the	O
ﬁrst	O
three	O
columns	O
of	O
v	O
[	O
x1	O
x2	O
.	O
.	O
.	O
xn	O
]	O
=	O
[	O
v1	O
v2	O
v3	O
]	O
t	O
.	O
(	O
cid:27	O
)	O
(	O
cid:27	O
)	O
algorithm	B
18.1.	O
the	O
factorization	B
algorithm	O
to	O
determine	O
the	O
mle	O
for	O
an	O
afﬁne	B
reconstruction	I
from	O
n	O
image	O
correspondences	O
over	O
m	O
views	O
(	O
under	O
gaussian	O
image	O
noise	O
)	O
.	O
(	O
cid:8	O
)	O
xi	O
(	O
cid:9	O
)	O
=	O
1	O
chosen	O
to	O
coincide	O
with	O
the	O
centroid	O
(	O
cid:8	O
)	O
x	O
(	O
cid:9	O
)	O
,	O
in	O
which	O
case	O
(	O
cid:8	O
)	O
x	O
(	O
cid:9	O
)	O
=	O
0	O
and	O
j	O
and	O
(	O
cid:8	O
)	O
x	O
(	O
cid:9	O
)	O
=	O
1	O
xj	O
.	O
the	O
origin	O
of	O
the	O
3d	O
frame	O
is	O
arbitrary	O
,	O
so	O
may	O
be	O
xi	O
n	O
n	O
j	O
j	O
ti	O
=	O
(	O
cid:8	O
)	O
xi	O
(	O
cid:9	O
)	O
.	O
(	O
18.3	O
)	O
it	O
follows	O
that	O
if	O
we	O
measure	O
the	O
image	O
coordinates	O
with	O
respect	O
to	O
a	O
coordinate	O
origin	O
based	O
at	O
the	O
centroid	O
of	O
the	O
projected	O
points	O
,	O
then	O
ti	O
=	O
0.	O
thus	O
,	O
we	O
replace	O
each	O
−	O
(	O
cid:8	O
)	O
xi	O
(	O
cid:9	O
)	O
.	O
henceforth	O
we	O
will	O
assume	O
that	O
this	O
has	O
been	O
done	O
,	O
and	O
work	O
with	O
xi	O
j	O
by	O
xi	O
the	O
centred	O
coordinates	B
.	O
with	O
respect	O
to	O
these	O
new	O
coordinates	B
ti	O
=	O
0	O
,	O
and	O
so	O
(	O
18.2	O
)	O
reduces	O
to	O
j	O
(	O
cid:7	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
min	O
mi	O
,	O
xj	O
ij	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
−	O
ˆxi	O
j	O
(	O
cid:7	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
−	O
mixj	O
=	O
min	O
mi	O
,	O
xj	O
ij	O
.	O
(	O
18.4	O
)	O
438	O
18	O
n-view	O
computational	O
methods	O
the	O
minimization	B
problem	O
now	O
has	O
a	O
very	O
simple	O
form	O
when	O
written	O
as	O
a	O
matrix	B
.	O
the	O
measurement	B
matrix	I
w	O
is	O
the	O
2m	O
×	O
n	O
matrix	B
composed	O
of	O
the	O
centred	O
coordinates	B
of	O
the	O
measured	O
image	O
points	O
(	O
18.5	O
)	O
since	O
each	O
xi	O
j	O
=	O
mixj	O
,	O
the	O
complete	O
set	O
of	O
equations	O
may	O
be	O
written	O
as	O
x1	O
2	O
x2	O
2	O
...	O
xm	O
2	O
.	O
.	O
.	O
x1	O
n	O
.	O
.	O
.	O
x2	O
n	O
...	O
...	O
.	O
.	O
.	O
xm	O
n	O
	O
.	O
#	O
w	O
=	O
x1	O
x2	O
.	O
.	O
.	O
xn	O
.	O
	O
w	O
=	O
	O
m1	O
m2	O
...	O
mm	O
x1	O
1	O
x2	O
1	O
...	O
xm	O
1	O
''	O
	O
	O
=	O
(	O
cid:16	O
)	O
2	O
in	O
the	O
presence	O
of	O
noise	O
this	O
equation	O
will	O
not	O
be	O
satisﬁed	O
exactly	O
,	O
so	O
instead	O
we	O
seek	O
a	O
matrix	B
ˆw	O
as	O
close	O
as	O
possible	O
to	O
w	O
in	O
frobenius	O
norm	B
,	O
such	O
that	O
ˆw	O
may	O
be	O
decomposed	O
as	O
	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
w	O
−	O
ˆw	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
ˆx1	O
1	O
ˆx2	O
1	O
...	O
ˆxm	O
1	O
ˆw	O
=	O
ˆx1	O
.	O
.	O
.	O
n	O
ˆx2	O
.	O
.	O
.	O
n	O
...	O
...	O
.	O
.	O
.	O
ˆxm	O
n	O
(	O
cid:15	O
)	O
in	O
this	O
case	O
it	O
may	O
be	O
veriﬁed	O
that	O
wij	O
−	O
ˆwij	O
ˆx1	O
2	O
ˆx2	O
2	O
...	O
ˆxm	O
2	O
(	O
cid:7	O
)	O
=	O
f	O
ij	O
''	O
	O
	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
m1	O
m2	O
...	O
mm	O
(	O
cid:7	O
)	O
=	O
ij	O
#	O
x1	O
x2	O
.	O
.	O
.	O
xn	O
.	O
(	O
18.6	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
=	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
(	O
cid:7	O
)	O
ij	O
−	O
ˆxi	O
j	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
−	O
mixj	O
comparing	O
this	O
with	O
(	O
18.4	O
)	O
we	O
ﬁnd	O
that	O
minimizing	O
the	O
required	O
geometric	B
error	I
is	O
equivalent	B
to	O
ﬁnding	O
such	O
a	O
ˆw	O
as	O
close	O
as	O
possible	O
to	O
w	O
in	O
frobenius	O
norm	B
.	O
note	O
that	O
a	O
matrix	B
ˆw	O
satisfying	O
(	O
18.6	O
)	O
is	O
the	O
product	O
of	O
a	O
2m	O
×	O
3	O
motion	O
matrix	B
ˆm	O
,	O
and	O
a	O
3	O
×	O
n	O
structure	B
matrix	O
ˆx	O
;	O
consequently	O
ˆw	O
=	O
ˆmˆx	O
has	O
rank	O
3.	O
in	O
other	O
words	O
we	O
seek	O
a	O
rank	O
3	O
matrix	B
which	O
is	O
closest	O
to	O
w	O
in	O
frobenius	O
norm	B
.	O
such	O
a	O
matrix	B
may	O
be	O
determined	O
by	O
the	O
svd	O
of	O
w	O
truncated	O
to	O
rank	O
3.	O
in	O
more	O
detail	O
,	O
if	O
the	O
svd	O
of	O
w	O
=	O
udvt	O
then	O
ˆw	O
=	O
u2m×3d3×3vt	O
3×n	O
is	O
the	O
rank	O
3	O
matrix	B
which	O
is	O
closest	O
to	O
w	O
in	O
the	O
frobenius	O
norm	B
,	O
where	O
u2m×3	O
consists	O
of	O
the	O
ﬁrst	O
3	O
columns	O
of	O
u	O
,	O
vt	O
3×n	O
consists	O
of	O
the	O
ﬁrst	O
3	O
rows	O
of	O
vt	O
,	O
and	O
d3×3	O
is	O
the	O
diagonal	O
matrix	B
containing	O
the	O
ﬁrst	O
3	O
singular	B
values	I
,	O
d3×3	O
=	O
diag	O
(	O
σ1	O
,	O
σ2	O
,	O
σ3	O
)	O
.	O
note	O
that	O
the	O
choice	B
of	O
ˆm	O
and	O
ˆx	O
is	O
not	O
unique	O
.	O
for	O
example	O
ˆm	O
may	O
be	O
chosen	O
as	O
3×n	O
since	O
in	O
either	O
case	O
3×n	O
,	O
or	O
as	O
ˆm	O
=	O
u2m×3	O
,	O
ˆx	O
=	O
d3×3vt	O
ˆm	O
=	O
u2m×3d3×3	O
and	O
ˆx	O
=	O
vt	O
ˆw	O
=	O
ˆmˆx	O
=	O
u2m×3d3×3vt	O
3×n	O
.	O
afﬁne	B
ambiguity	O
.	O
in	O
fact	O
for	O
any	O
such	O
choice	B
there	O
is	O
an	O
additional	O
ambiguity	B
since	O
an	O
arbitrary	O
3	O
×	O
3	O
rank	O
3	O
matrix	B
a	O
may	O
be	O
inserted	O
in	O
the	O
decomposition	B
as	O
ˆw	O
=	O
ˆmaa−1ˆx	O
=	O
(	O
ˆma	O
)	O
(	O
a−1ˆx	O
)	O
.	O
this	O
means	O
that	O
the	O
camera	B
matrices	I
mi	O
,	O
which	O
are	O
obtained	O
from	O
ˆm	O
,	O
and	O
18.2	O
afﬁne	B
reconstruction	I
–	O
the	O
factorization	B
algorithm	O
439	O
the	O
3d	O
points	O
xj	O
,	O
which	O
are	O
obtained	O
from	O
ˆx	O
,	O
are	O
determined	O
up	O
to	O
multiplication	O
by	O
a	O
common	O
matrix	B
a.	O
in	O
other	O
words	O
the	O
mle	O
reconstruction	B
is	O
afﬁne	B
.	O
this	O
afﬁne	B
reconstruction	I
may	O
be	O
upgraded	O
to	O
a	O
metric	B
reconstruction	I
by	O
supplying	O
metric	B
information	O
on	O
the	O
scene	O
as	O
described	O
in	O
section	O
10.4.2	O
(	O
p272	O
)	O
,	O
or	O
by	O
using	O
auto-	O
calibration	B
methods	O
as	O
described	O
in	O
chapter	O
19	O
,	O
or	O
a	O
combination	O
of	O
the	O
two	O
.	O
note	O
that	O
in	O
the	O
case	O
of	O
afﬁne	O
cameras	B
only	O
three	O
internal	B
parameters	I
need	O
be	O
speciﬁed	O
(	O
compared	O
to	O
ﬁve	O
for	O
projective	O
cameras	B
)	O
and	O
the	O
auto-calibration	B
task	O
is	O
correspondingly	O
simpler	O
.	O
18.2.1	O
afﬁne	B
multiple	I
view	I
tensors	I
the	O
factorization	B
algorithm	O
provides	O
an	O
optimal	O
method	O
for	O
computing	O
the	O
afﬁne	B
mul-	O
tiview	O
tensors	O
from	O
image	O
point	B
correspondences	O
.	O
these	O
tensors	O
are	O
the	O
afﬁne	B
funda-	O
mental	O
matrix	B
,	O
afﬁne	B
trifocal	O
tensor	B
,	O
and	O
afﬁne	B
quadrifocal	O
tensor	B
.	O
in	O
each	O
case	O
the	O
al-	O
gorithm	O
determines	O
the	O
camera	B
matrices	I
up	O
to	O
an	O
overall	O
afﬁne	B
ambiguity	O
.	O
the	O
tensors	O
may	O
then	O
be	O
computed	O
directly	O
from	O
the	O
camera	B
matrices	I
(	O
as	O
for	O
instance	O
in	O
chapter	O
17	O
)	O
.	O
the	O
afﬁne	B
ambiguity	O
of	O
3-space	O
is	O
irrelevant	O
when	O
computing	B
the	O
tensors	O
since	O
they	O
are	O
unaffected	O
by	O
afﬁne	B
transformations	O
of	O
3-space	O
.	O
in	O
fact	O
it	O
is	O
not	O
necessary	O
to	O
compute	O
the	O
full	O
svd	O
of	O
w	O
since	O
only	O
the	O
u	O
part	O
of	O
the	O
decomposition	O
is	O
required	O
.	O
if	O
the	O
number	O
of	O
points	O
n	O
is	O
large	O
compared	O
with	O
the	O
number	O
of	O
views	O
then	O
very	O
great	O
savings	O
can	O
be	O
made	O
in	O
the	O
computation	B
of	I
the	O
svd	O
by	O
not	O
determining	B
v	O
(	O
see	O
table	O
a4.1	O
(	O
p587	O
)	O
)	O
.	O
an	O
alternative	O
to	O
using	O
the	O
svd	O
is	O
to	O
use	O
the	O
eigenvalue	O
decomposition	O
of	O
wwt	O
,	O
since	O
wwt	O
=	O
(	O
udvt	O
)	O
(	O
udvt	O
)	O
t	O
=	O
ud2ut	O
.	O
in	O
the	O
case	O
of	O
three	O
views	O
(	O
computation	B
of	I
the	O
trifocal	B
tensor	I
)	O
the	O
matrix	B
wwt	O
has	O
dimension	O
only	O
9	O
×	O
9.	O
thus	O
this	O
approach	O
can	O
mean	O
signif-	O
icant	O
savings	O
.	O
however	O
,	O
it	O
is	O
numerically	O
inferior	O
,	O
since	O
forming	O
wwt	O
causes	O
the	O
con-	O
dition	O
number	O
of	O
the	O
matrix	B
to	O
be	O
squared	O
(	O
see	O
the	O
discussion	O
of	O
svd	O
in	O
[	O
golub-89	O
]	O
)	O
.	O
since	O
we	O
need	O
just	O
the	O
three	O
largest	O
eigenvectors	O
,	O
that	O
may	O
not	O
be	O
such	O
a	O
problem	O
in	O
this	O
case	O
.	O
however	O
,	O
the	O
savings	O
of	O
this	O
approach	O
will	O
not	O
be	O
so	O
great	O
given	O
an	O
imple-	O
mentation	O
of	O
the	O
svd	O
that	O
avoids	O
computing	B
v.	O
the	O
factorization	B
method	O
may	O
be	O
used	O
to	O
compute	O
any	O
of	O
the	O
multiple-view	O
afﬁne	B
tensors	O
.	O
for	O
the	O
afﬁne	B
fundamental	I
matrix	I
,	O
however	O
,	O
algorithm	B
14.1	O
(	O
p351	O
)	O
described	O
in	O
chapter	O
14	O
is	O
more	O
direct	O
.	O
the	O
results	O
of	O
both	O
the	O
methods	O
are	O
identical	O
.	O
18.2.2	O
triangulation	B
and	O
reprojection	B
using	O
subspaces	O
the	O
factorization	B
algorithm	O
also	O
provides	O
an	O
optimal	O
method	O
for	O
computing	O
the	O
images	O
of	O
new	O
points	O
or	O
of	B
points	I
not	O
observed	O
in	O
all	O
views	O
.	O
again	O
the	O
afﬁne	B
ambiguity	O
of	O
3-space	O
is	O
irrelevant	O
.	O
a	O
column	O
of	O
w	O
is	O
the	O
set	O
of	O
all	O
corresponding	O
image	O
points	O
for	O
the	O
point	B
xj	O
and	O
is	O
referred	O
to	O
as	O
a	O
point	B
’	O
s	O
trajectory	O
.	O
the	O
rank	O
3	O
decomposition	B
(	O
18.6	O
)	O
of	O
ˆw	O
as	O
ˆw	O
=	O
ˆmˆx	O
shows	O
that	O
all	O
trajectories	O
lie	O
in	O
a	O
3	O
dimensional	O
subspace	O
.	O
in	O
particular	O
the	O
trajectory	O
(	O
i.e	O
.	O
all	O
image	O
projections	O
)	O
of	O
a	O
new	O
point	B
x	O
may	O
be	O
obtained	O
as	O
ˆmx	O
.	O
this	O
is	O
simply	O
a	O
linear	B
weighting	O
of	O
the	O
three	O
columns	O
of	O
ˆm	O
.	O
suppose	O
we	O
have	O
observed	O
a	O
new	O
point	B
x	O
in	O
some	O
(	O
not	O
all	O
)	O
views	O
,	O
and	O
wish	O
to	O
pre-	O
dict	O
its	O
projection	B
in	O
the	O
other	O
views	O
.	O
this	O
is	O
carried	O
out	O
in	O
two	O
steps	O
:	O
ﬁrst	O
triangu-	O
lation	O
to	O
ﬁnd	O
the	O
pre-image	O
x	O
,	O
and	O
then	O
reprojection	B
as	O
ˆmx	O
to	O
generate	O
its	O
image	O
in	O
440	O
18	O
n-view	O
computational	O
methods	O
all	O
views	O
.	O
note	O
that	O
the	O
projected	O
points	O
will	O
not	O
coincide	O
exactly	O
with	O
the	O
measured	O
(	O
noisy	O
)	O
points	O
.	O
in	O
the	O
triangulation	B
step	O
we	O
wish	O
to	O
ﬁnd	O
the	O
point	B
x	O
that	O
minimizes	O
re-	O
projection	B
error	O
,	O
and	O
this	O
corresponds	O
to	O
ﬁnding	O
the	O
point	B
in	O
the	O
linear	B
subspace	O
spanned	O
by	O
the	O
columns	O
of	O
ˆm	O
closest	O
to	O
the	O
trajectory	O
.	O
this	O
closest	O
point	B
is	O
found	O
by	O
projecting	O
the	O
trajectory	O
onto	O
the	O
subspace	O
(	O
in	O
a	O
similar	O
manner	O
to	O
algorithm	O
4.7	O
(	O
p130	O
)	O
)	O
.	O
in	O
more	O
detail	O
suppose	O
we	O
have	O
computed	O
a	O
set	O
of	O
afﬁne	O
cameras	B
{	O
mi	O
,	O
ti	O
}	O
then	O
the	O
triangulation	B
problem	O
may	O
be	O
solved	O
linearly	O
for	O
any	O
number	O
of	O
views	O
.	O
the	O
image	O
points	O
xi	O
=	O
mix	O
+	O
ti	O
give	O
a	O
pair	O
of	O
linear	O
equations	O
mix	O
=	O
xi	O
−	O
ti	O
in	O
the	O
entries	O
of	O
x.	O
given	O
sufﬁciently	O
many	O
such	O
equations	O
(	O
arising	O
from	O
known	O
values	O
of	O
xi	O
)	O
one	O
can	O
ﬁnd	O
the	O
linear	B
least-squares	O
solution	B
for	O
x	O
,	O
using	O
algorithm	O
a5.1	O
(	O
p589	O
)	O
,	O
the	O
pseudo-	O
inverse	O
(	O
see	O
result	O
a5.1	O
(	O
p590	O
)	O
)	O
or	O
algorithm	B
a5.3	O
(	O
p591	O
)	O
.	O
note	O
that	O
if	O
the	O
data	O
xi	O
is	O
centred	O
using	O
the	O
same	O
transformation	O
applied	O
in	O
step	O
(	O
ii	O
)	O
of	O
algorithm	O
18.1	O
,	O
then	O
the	O
translation	O
vectors	O
ti	O
in	O
the	O
afﬁne	B
triangulation	O
method	O
may	O
be	O
taken	O
to	O
be	O
zero	O
.	O
in	O
practice	O
triangulation	B
and	O
reprojection	B
provides	O
a	O
method	O
of	O
‘	O
ﬁlling	O
in	O
’	O
points	O
that	O
are	O
missed	O
during	O
tracking	O
or	O
multiple	O
view	O
matching	B
.	O
18.2.3	O
afﬁne	B
reconstruction	I
by	I
alternation	I
suppose	O
a	O
set	O
of	O
image	O
coordinates	B
xi	O
j	O
are	O
given	O
as	O
in	O
algorithm	B
18.1	O
,	O
and	O
we	O
wish	O
to	O
perform	O
afﬁne	B
reconstruction	I
.	O
we	O
have	O
seen	O
that	O
afﬁne	B
triangulation	O
may	O
be	O
carried	O
out	O
linearly	O
.	O
thus	O
,	O
if	O
the	O
afﬁne	B
camera	I
matrices	O
represented	O
by	O
{	O
mi	O
,	O
ti	O
}	O
are	O
known	O
,	O
then	O
the	O
optimal	O
point	B
positions	O
xj	O
may	O
be	O
computed	O
by	O
a	O
linear	B
least-squares	O
method	O
such	O
as	O
the	O
normal	B
equations	I
method	O
of	O
algorithm	O
a5.3	O
(	O
p591	O
)	O
.	O
conversely	O
,	O
if	O
the	O
points	O
xj	O
are	O
known	O
,	O
then	O
the	O
equations	O
xi	O
j	O
=	O
mixj	O
+	O
ti	O
are	O
linear	B
in	O
mi	O
and	O
ti	O
.	O
so	O
it	O
is	O
once	O
again	O
possible	O
simply	O
to	O
solve	O
for	O
{	O
mi	O
,	O
ti	O
}	O
by	O
linear	B
least-	O
squares	O
.	O
this	O
suggests	O
a	O
method	O
of	O
afﬁne	O
reconstruction	B
in	O
which	O
linear	B
least-squares	O
methods	O
are	O
used	O
to	O
solve	O
alternately	O
for	O
the	O
points	O
xj	O
and	O
the	O
cameras	B
{	O
mi	O
,	O
ti	O
}	O
.	O
this	O
method	O
of	O
alternation	O
is	O
not	O
to	O
be	O
recommended	O
as	O
a	O
general	O
method	O
for	O
reconstruction	O
,	O
or	O
for	O
solving	O
optimization	O
problems	O
in	O
general	O
.	O
in	O
the	O
case	O
of	O
afﬁne	O
reconstruction	B
,	O
however	O
,	O
it	O
can	O
be	O
proven	O
to	O
converge	O
rapidly	O
to	O
the	O
optimal	O
solution	B
,	O
starting	O
from	O
a	O
random	O
starting	O
point	B
.	O
this	O
method	O
of	O
afﬁne	O
reconstruction	B
has	O
the	O
advantage	O
of	O
working	O
with	B
missing	I
data	I
,	O
or	O
with	O
covariance-weighted	O
data	O
which	O
algorithm	B
18.1	O
will	O
not	O
,	O
though	O
in	O
the	O
missing	O
data	O
or	O
covariance-weighted	O
case	O
,	O
global	O
optimal	O
convergence	O
is	O
not	O
guaranteed	O
in	O
all	O
cases	O
.	O
18.3	O
non-rigid	B
factorization	I
throughout	O
the	O
book	O
it	O
has	O
been	O
assumed	O
that	O
we	O
are	O
viewing	O
a	O
rigid	O
scene	O
and	O
that	O
only	O
the	O
relative	O
motion	O
between	O
the	O
camera	B
and	O
scene	O
is	O
to	O
be	O
modelled	O
.	O
in	O
this	O
section	O
we	O
relax	O
this	O
assumption	O
and	O
consider	O
the	O
problem	O
of	O
recovering	O
a	O
reconstruction	B
for	O
a	O
deforming	O
object	O
.	O
it	O
will	O
be	O
shown	O
that	O
if	O
the	O
deformation	O
is	O
modelled	O
as	O
a	O
linear	B
combination	O
over	O
basis	O
shapes	O
then	O
the	O
reconstruction	B
and	O
the	O
basis	O
shapes	O
may	O
be	O
recovered	O
with	O
a	O
simple	O
modiﬁcation	O
of	O
the	O
factorization	O
algorithm	B
of	O
section	O
18.2.	O
an	O
example	O
where	O
this	O
type	O
of	O
situation	O
arises	O
is	O
in	O
a	O
sequence	O
of	O
images	O
of	O
a	O
per-	O
18.3	O
non-rigid	B
factorization	I
441	O
fig	O
.	O
18.1.	O
shape	O
basis	O
.	O
a	O
face	O
template	O
is	O
represented	O
by	O
n	O
equally	O
spaced	O
2d	O
points	O
(	O
here	O
n	O
=	O
140	O
)	O
.	O
the	O
central	O
face	O
of	O
the	O
seven	O
is	O
the	O
mean	O
shape	O
and	O
the	O
faces	O
to	O
the	O
left	O
or	O
right	O
are	O
generated	O
by	O
adding	O
or	O
subtracting	O
,	O
respectively	O
,	O
the	O
basis	O
shape	O
that	O
accounts	O
for	O
the	O
maximum	O
variation	O
in	O
the	O
training	O
set	O
.	O
in	O
this	O
case	O
the	O
basis	O
spans	O
expressions	O
from	O
surprised	O
to	O
disgruntled	O
.	O
facial	O
expressions	O
are	O
learnt	O
by	O
tracking	O
the	O
face	O
of	O
an	O
actor	O
with	O
the	O
template	O
whilst	O
he	O
changes	O
expression	O
but	O
does	O
not	O
vary	O
his	O
head	O
pose	O
.	O
each	O
frame	O
of	O
the	O
training	O
sequence	O
generates	O
a	O
set	O
of	O
n	O
2d	O
points	O
,	O
and	O
the	O
coordinates	B
of	O
these	O
are	O
rewritten	O
as	O
a	O
2n-vector	O
.	O
a	O
2n	O
×	O
f	O
matrix	B
is	O
then	O
composed	O
from	O
these	O
vectors	O
,	O
where	O
f	O
is	O
the	O
number	O
of	O
training	O
frames	O
,	O
and	O
the	O
basis	O
shapes	O
are	O
computed	O
from	O
the	O
singular	O
vectors	O
of	O
this	O
matrix	B
.	O
figure	O
courtesy	O
of	O
richard	O
bowden	O
.	O
son	O
’	O
s	O
head	O
which	O
moves	O
and	O
also	O
changes	O
expression	O
.	O
the	O
motion	O
of	O
the	O
head	O
may	O
be	O
modelled	O
as	O
a	O
rigid	O
rotation	B
,	O
and	O
the	O
change	O
of	O
expression	O
relative	O
to	O
the	O
ﬁxed	O
head	O
may	O
be	O
modelled	O
as	O
a	O
linear	B
combination	O
over	O
basis	O
sets	O
.	O
for	O
example	O
the	O
mouth	O
out-	O
line	B
may	O
be	O
represented	O
by	O
a	O
set	O
of	B
points	I
.	O
suppose	O
the	O
set	O
of	O
n	O
scene	O
points	O
xj	O
may	O
be	O
represented	O
as	O
a	O
linear	B
combination	O
of	O
l	O
basis	O
shapes	O
bk	O
so	O
that	O
at	O
a	O
particular	O
time	O
i	O
:	O
xi	O
1	O
xi	O
2	O
.	O
.	O
.	O
xi	O
n	O
b1k	O
b2k	O
.	O
.	O
.	O
bnk	O
j	O
and	O
the	O
basis	O
points	O
bjk	O
are	O
inhomogeneous	O
points	O
where	O
here	O
both	O
the	O
scene	O
points	O
xi	O
represented	O
by	O
3-vectors	O
,	O
and	O
bk	O
is	O
a	O
3×n	O
matrix	B
.	O
typically	O
the	O
number	O
of	O
basis	O
shapes	O
,	O
l	O
,	O
is	O
much	O
smaller	O
than	O
the	O
number	O
of	O
points	O
,	O
n.	O
the	O
coefﬁcients	O
αi	O
k	O
may	O
be	O
different	O
at	O
each	O
time	O
i	O
,	O
and	O
the	O
resulting	O
differing	O
combination	O
of	O
basis	O
shapes	O
generates	O
the	O
deformation	O
.	O
an	O
example	O
is	O
shown	O
in	O
ﬁgure	O
18.1.	O
in	O
the	O
forward	O
model	O
of	O
image	O
generation	O
each	O
view	O
i	O
is	O
acquired	O
by	O
an	O
afﬁne	B
camera	I
and	O
gives	O
the	O
image	O
points	O
xi	O
j	O
=	O
mi	O
αi	O
k	O
bjk	O
+	O
ti	O
.	O
(	O
cid:7	O
)	O
k	O
it	O
will	O
again	O
be	O
assumed	O
that	O
image	O
point	O
matches	O
are	O
available	O
for	O
all	O
views	O
.	O
our	O
goal	O
is	O
to	O
estimate	O
cameras	B
{	O
mi	O
,	O
ti	O
}	O
and	O
3d	O
structure	B
{	O
αi	O
k	O
,	O
bjk	O
}	O
from	O
the	O
measured	O
(	O
cid:27	O
)	O
image	O
points	O
{	O
xi	O
j	O
=	O
(	O
cid:7	O
)	O
}	O
,	O
such	O
that	O
the	O
distance	B
between	O
the	O
estimated	O
image	O
points	O
ˆxi	O
(	O
cid:7	O
)	O
k	O
αi	O
k	O
mi	O
j	O
bjk	O
+	O
ti	O
and	O
measured	O
image	O
points	O
is	O
minimized	O
−	O
(	O
mi	O
(	O
cid:7	O
)	O
−	O
ˆxi	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
bjk	O
+	O
ti	O
)	O
.	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
j	O
j	O
αi	O
k	O
min	O
mi	O
,	O
ti	O
,	O
αi	O
k	O
,	O
bjk	O
ij	O
=	O
min	O
mi	O
,	O
ti	O
,	O
αi	O
k	O
,	O
bjk	O
ij	O
k	O
as	O
in	O
afﬁne	B
factorization	O
the	O
translation	O
may	O
be	O
eliminated	O
by	O
centring	O
the	O
measured	O
image	O
points	O
,	O
and	O
it	O
will	O
be	O
assumed	O
from	O
here	O
on	O
that	O
this	O
has	O
been	O
done	O
.	O
then	O
the	O
''	O
#	O
l	O
(	O
cid:7	O
)	O
''	O
αi	O
k	O
=	O
k=1	O
#	O
(	O
cid:7	O
)	O
αi	O
k	O
bk	O
=	O
k	O
18	O
n-view	O
computational	O
methods	O
442	O
problem	O
reduces	O
to	O
min	O
mi	O
,	O
αi	O
k	O
,	O
bjk	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
j	O
(	O
cid:7	O
)	O
ij	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
−	O
ˆxi	O
j	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
xi	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
j	O
(	O
cid:7	O
)	O
ij	O
(	O
cid:7	O
)	O
k	O
−	O
mi	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
2	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
.	O
αi	O
k	O
bjk	O
(	O
18.7	O
)	O
=	O
min	O
mi	O
,	O
αi	O
k	O
,	O
bjk	O
(	O
cid:27	O
)	O
k	O
αi	O
k	O
	O
=	O
	O
	O
	O
	O
	O
the	O
complete	O
set	O
of	O
equations	O
ˆxi	O
j	O
=	O
mi	O
bjk	O
may	O
be	O
written	O
ˆw	O
=	O
bl	O
)	O
bl	O
)	O
b2	O
+	O
.	O
.	O
.	O
α1	O
b1	O
+	O
α1	O
l	O
2	O
b1	O
+	O
α2	O
b2	O
+	O
.	O
.	O
.	O
α2	O
l	O
2	O
...	O
b1	O
+	O
αm	O
2	O
b2	O
+	O
.	O
.	O
.	O
αm	O
l	O
m1	O
(	O
α1	O
1	O
m2	O
(	O
α2	O
1	O
b1	O
b2	O
...	O
bl	O
(	O
18.8	O
)	O
this	O
rearrangement	O
shows	O
that	O
the	O
2m	O
×	O
n	O
matrix	B
ˆw	O
may	O
be	O
decomposed	O
as	O
a	O
product	O
of	O
a	O
2m	O
×	O
3l	O
motion	O
matrix	B
ˆm	O
and	O
3l	O
×	O
n	O
structure	B
matrix	O
ˆb	O
,	O
and	O
consequently	O
ˆw	O
has	O
maximum	O
rank	O
3l	O
.	O
m1	O
m1	O
m1	O
.	O
.	O
.	O
α1	O
α1	O
α1	O
l	O
2	O
1	O
m2	O
m2	O
m2	O
.	O
.	O
.	O
α2	O
α2	O
α2	O
l	O
2	O
1	O
...	O
...	O
...	O
...	O
mm	O
mm	O
.	O
.	O
.	O
αm	O
mm	O
αm	O
αm	O
l	O
2	O
1	O
mm	O
(	O
αm	O
1	O
bl	O
)	O
as	O
in	O
rigid	O
factorization	B
a	O
rank	O
3l	O
decomposition	B
may	O
be	O
obtained	O
from	O
the	O
measure-	O
ment	O
matrix	B
w	O
by	O
truncating	O
the	O
svd	O
of	O
w	O
to	O
rank	O
3l	O
.	O
also	O
,	O
as	O
in	O
rigid	O
factorization	B
,	O
the	O
decomposition	B
ˆw	O
=	O
ˆmˆb	O
is	O
not	O
uniquely	O
deﬁned	O
since	O
an	O
arbitrary	O
3l	O
×	O
3l	O
rank	O
3l	O
matrix	B
a	O
may	O
be	O
inserted	O
in	O
the	O
decomposition	B
as	O
ˆw	O
=	O
ˆmaa−1ˆb	O
=	O
(	O
ˆma	O
)	O
(	O
a−1ˆb	O
)	O
.	O
in	O
the	O
rigid	O
case	O
this	O
resulted	O
in	O
a	O
straightforward	O
afﬁne	B
ambiguity	O
in	O
the	O
reconstruction	B
.	O
however	O
,	O
in	O
the	O
non-rigid	B
case	O
there	O
is	O
the	O
additional	O
requirement	O
that	O
the	O
motion	O
matrix	B
has	O
the	O
replicated	O
block	O
structure	B
of	O
(	O
18.8	O
)	O
,	O
and	O
we	O
return	O
to	O
this	O
below	O
.	O
this	O
block	O
structure	B
is	O
not	O
required	O
for	O
determining	O
a	O
point	B
’	O
s	O
image	O
motion	O
,	O
as	O
will	O
now	O
be	O
discussed	O
.	O
18.3.1	O
subspaces	B
and	I
tensors	I
in	O
the	O
case	O
of	O
rigid	O
factorization	B
(	O
18.6	O
)	O
,	O
as	O
discussed	O
in	O
section	O
18.2.2	O
,	O
the	O
trajecto-	O
ries	O
lie	O
in	O
a	O
3	O
dimensional	O
subspace	O
,	O
and	O
any	O
trajectory	O
may	O
be	O
generated	O
as	O
a	O
linear	B
combination	O
of	O
the	O
columns	O
of	O
ˆm	O
(	O
the	O
2m	O
×	O
3	O
motion	O
matrix	B
)	O
.	O
similarly	O
in	O
the	O
case	O
of	O
non-rigid	O
factorization	B
,	O
(	O
18.8	O
)	O
,	O
the	O
trajectories	O
lie	O
in	O
a	O
3l	O
dimensional	O
subspace	O
,	O
and	O
any	O
trajectory	O
may	O
be	O
generated	O
as	O
a	O
linear	B
combination	O
of	O
the	O
columns	O
of	O
ˆm	O
(	O
the	O
2m	O
×	O
3l	O
motion	O
matrix	B
)	O
.	O
suppose	O
we	O
observe	O
a	O
new	O
point	B
in	O
a	O
subset	O
of	O
the	O
views	O
,	O
how	O
many	O
images	O
are	O
required	O
before	O
its	O
position	O
can	O
be	O
predicted	O
in	O
all	O
the	O
other	O
views	O
?	O
this	O
is	O
simply	O
a	O
question	O
of	B
triangulation	I
:	O
in	O
rigid	O
factorization	B
a	O
3-space	O
point	B
has	O
3	O
degrees	O
of	O
free-	O
dom	O
,	O
and	O
must	O
be	O
observed	O
in	O
two	O
views	O
to	O
obtain	O
the	O
necessary	O
3	O
measurements	O
.	O
in	O
non-rigid	O
factorization	B
we	O
need	O
to	O
specify	O
3l	O
degrees	B
of	I
freedom	I
(	O
the	O
number	O
of	O
rows	O
in	O
the	O
ˆb	O
matrix	B
)	O
,	O
and	O
this	O
requires	O
3l/2	O
images	O
.	O
for	O
example	O
,	O
if	O
l	O
=	O
2	O
the	O
subspace	O
is	O
six	O
dimensional	O
(	O
the	O
columns	O
of	O
the	O
ˆb	O
matrix	B
are	O
6-vectors	O
)	O
,	O
and	O
given	O
the	O
image	O
position	O
in	O
three	O
views	O
,	O
the	O
image	O
position	O
in	O
all	O
views	O
is	O
then	O
determined	O
by	O
an	O
analogue	O
of	O
afﬁne	O
triangulation	B
(	O
section	O
18.2.2	O
)	O
even	O
though	O
the	O
object	O
is	O
deforming	O
.	O
independently	O
moving	O
objects	O
.	O
low-rank	O
factorization	B
methods	O
also	O
arise	O
when	O
there	O
are	O
independently	O
moving	O
objects	O
in	O
the	O
scene	O
.	O
for	O
instance	O
suppose	O
the	O
scene	O
is	O
divided	O
into	O
two	O
objects	O
,	O
each	O
moving	B
independently	O
of	O
the	O
other	O
,	O
and	O
viewed	O
by	O
18.3	O
non-rigid	B
factorization	I
443	O
a	O
b	O
fig	O
.	O
18.2.	O
non-rigid	B
motion	O
sequence	O
.	O
top	O
row	O
:	O
alternate	O
frames	O
from	O
a	O
sequence	O
in	O
which	O
a	O
giraffe	O
gracefully	O
walks	O
and	O
ﬂexes	O
its	O
neck	O
,	O
whilst	O
the	O
camera	B
pans	O
to	O
match	O
its	O
speed	O
.	O
bottom	O
row	O
:	O
point	B
tracks	O
showing	O
the	O
motion	O
over	O
(	O
a	O
)	O
the	O
10	O
previous	O
,	O
and	O
(	O
b	O
)	O
the	O
10	O
forthcoming	O
frames	O
.	O
these	O
tracks	O
are	O
computed	O
using	O
non-rigid	B
factorization	I
and	O
lie	O
in	O
a	O
six	O
dimensional	O
subspace	O
.	O
note	O
the	O
very	O
different	O
trajectories	O
of	O
the	O
(	O
rigid	O
)	O
background	O
from	O
the	O
(	O
deforming	O
)	O
foreground	O
.	O
yet	O
these	O
are	O
all	O
spanned	O
by	O
the	O
six	O
basis	O
vectors	O
of	O
the	O
motion	O
matrix	B
.	O
the	O
rank	O
can	O
be	O
accounted	O
for	O
as	O
follows	O
:	O
the	O
sequence	O
motion	O
is	O
effectively	O
that	O
of	O
two	O
planes	O
of	B
points	I
moving	O
independently	O
relative	O
to	O
the	O
camera	B
.	O
the	O
background	O
is	O
a	O
rigid	O
object	O
represented	O
by	O
a	O
plane	B
and	O
contributes	O
2	O
to	O
the	O
rank	O
.	O
the	O
giraffe	O
in	O
the	O
foreground	O
is	O
represented	O
as	O
a	O
non-rigid	B
object	O
by	O
a	O
set	O
of	O
l	O
=	O
2	O
planar	O
basis	O
shapes	O
and	O
contributes	O
4	O
to	O
the	O
rank	O
.	O
figures	O
courtesy	O
of	O
andrew	O
fitzgibbon	O
and	O
aeron	O
morgan	O
.	O
a	O
moving	B
afﬁne	O
camera	B
.	O
in	O
this	O
case	O
,	O
the	O
columns	O
of	O
the	O
measurement	O
matrix	B
corre-	O
sponding	O
to	O
points	O
on	O
one	O
object	O
will	O
have	O
rank	O
3	O
,	O
and	O
those	O
corresponding	O
to	O
the	O
other	O
object	O
will	O
also	O
have	O
rank	O
3.	O
the	O
total	O
rank	O
of	O
the	O
measurement	O
matrix	B
will	O
be	O
6.	O
in	O
degenerate	O
conﬁgurations	O
in	O
which	O
one	O
object	O
’	O
s	O
points	O
all	O
lie	O
in	O
a	O
plane	B
,	O
its	O
contribution	O
to	O
the	O
rank	O
will	O
be	O
only	O
2.	O
this	O
multibody	O
factorization	B
problem	O
has	O
been	O
studied	O
in	O
some	O
depth	O
in	O
[	O
costeira-98	O
]	O
.	O
an	O
example	O
of	O
point	O
tracks	O
residing	O
in	O
a	O
low	O
dimensional	O
subspace	O
is	O
shown	O
in	O
ﬁgure	O
18.2.	O
the	O
existence	O
of	O
the	O
analogue	O
of	O
the	O
fundamental	O
matrix	B
and	O
trifocal	B
tensor	I
depends	O
on	O
the	O
dimension	O
of	O
the	O
subspace	O
.	O
for	O
example	O
suppose	O
the	O
subspace	O
has	O
odd	O
di-	O
mension	O
(	O
e.g	O
.	O
l	O
=	O
3	O
so	O
it	O
is	O
9	O
dimensional	O
)	O
then	O
given	O
point	B
measurements	O
in	O
(	O
cid:25	O
)	O
3l/2	O
(	O
cid:26	O
)	O
views	O
(	O
e.g	O
.	O
4	O
views	O
)	O
the	O
corresponding	O
point	B
in	O
any	O
other	O
view	O
is	O
constrained	O
to	O
a	O
line	B
,	O
the	O
analogue	O
of	O
an	O
epipolar	B
line	I
,	O
since	O
there	O
is	O
one	O
fewer	O
measurement	O
than	O
degrees	B
of	I
freedom	I
of	O
the	O
subspace	O
.	O
however	O
,	O
if	O
the	O
dimension	O
is	O
even	O
(	O
e.g	O
.	O
l	O
=	O
2	O
so	O
it	O
is	O
6	O
dimen-	O
sional	O
)	O
then	O
given	O
point	B
measurements	O
in	O
l/2	O
views	O
(	O
e.g	O
.	O
3	O
views	O
)	O
the	O
corresponding	O
point	B
in	O
any	O
other	O
view	O
is	O
completely	O
determined	O
.	O
multi-view	O
tensors	O
can	O
be	O
built	O
for	O
444	O
18	O
n-view	O
computational	O
methods	O
the	O
non-rigid	B
l	O
>	O
1	O
subspaces	O
using	O
methods	O
similar	O
to	O
those	O
developed	O
in	O
chapter	O
17	O
for	O
l	O
=	O
1	O
3-space	O
points	O
.	O
18.3.2	O
recovering	O
the	O
camera	B
motion	I
in	O
rigid-factorization	O
the	O
camera	B
matrices	I
are	O
obtained	O
relatively	O
easily	O
from	O
the	O
motion	O
matrix	B
ˆm	O
–	O
all	O
that	O
is	O
required	O
is	O
to	O
remove	O
a	O
global	O
afﬁne	B
ambiguity	O
speciﬁed	O
by	O
a	O
3×	O
3	O
matrix	B
a	O
as	O
described	O
on	O
page	O
438.	O
in	O
the	O
non-rigid	B
case	O
,	O
the	O
analogous	O
problem	O
is	O
not	O
so	O
straightforward	O
.	O
it	O
is	O
a	O
simple	O
matter	O
to	O
obtain	O
the	O
motion	O
matrix	B
:	O
(	O
i	O
)	O
construct	O
the	O
2m	O
×	O
n	O
measurement	B
matrix	I
w	O
from	O
the	O
centred	O
data	O
,	O
as	O
deﬁned	O
in	O
(	O
18.5	O
)	O
,	O
and	O
compute	O
its	O
svd	O
w	O
=	O
udvt	O
.	O
(	O
ii	O
)	O
then	O
the	O
motion	O
matrix	B
ˆm	O
is	O
obtained	O
from	O
the	O
ﬁrst	O
3l	O
columns	O
of	O
u	O
multiplied	O
by	O
the	O
singular	B
values	I
as	O
ˆm	O
=	O
σ1u1	O
σ2u2	O
.	O
.	O
.	O
σ3lu3l	O
,	O
''	O
#	O
but	O
the	O
matrix	B
obtained	O
by	O
this	O
route	O
will	O
not	O
in	O
general	O
have	O
the	O
block	O
structure	B
of	O
(	O
18.8	O
)	O
.	O
as	O
in	O
the	O
case	O
of	O
rigid-factorization	O
the	O
motion	O
matix	O
is	O
determined	O
up	O
to	O
post-multiplication	O
by	O
a	O
matrix	B
a	O
,	O
which	O
here	O
is	O
3l	O
×	O
3l	O
.	O
the	O
task	O
is	O
then	O
to	O
deter-	O
mine	O
a	O
such	O
that	O
ˆma	O
has	O
the	O
required	O
block	O
structure	B
of	O
(	O
18.8	O
)	O
and	O
also	O
to	O
remove	O
the	O
usual	O
afﬁne	B
ambiguity	O
such	O
that	O
each	O
block	O
conforms	O
to	O
any	O
available	O
constraints	B
on	O
the	O
camera	B
calibration	I
(	O
for	O
example	O
identical	O
internal	B
parameters	I
over	O
all	O
views	O
)	O
.	O
various	O
methods	O
for	O
determining	B
a	O
have	O
been	O
investigated	O
(	O
see	O
[	O
brand-01	O
,	O
torresani-01	O
]	O
)	O
,	O
but	O
these	O
do	O
not	O
impose	O
the	O
full	O
block	O
structure	B
,	O
and	O
currently	O
there	O
is	O
not	O
a	O
satisfactory	O
solution	B
to	O
this	O
problem	O
.	O
once	O
an	O
initial	B
solution	I
has	O
been	O
obtained	O
by	O
some	O
means	O
,	O
then	O
the	O
correct	O
form	O
can	O
be	O
imposed	O
by	O
bundle	B
adjustment	I
of	O
(	O
18.7	O
)	O
.	O
18.4	O
projective	B
factorization	I
the	O
afﬁne	B
factorization	O
method	O
does	O
not	O
apply	O
directly	O
to	O
projective	O
reconstruction	B
.	O
it	O
was	O
observed	O
in	O
[	O
sturm-96	O
]	O
,	O
however	O
,	O
that	O
if	O
one	O
knows	O
the	O
“	O
projective	B
depth	I
”	O
of	O
each	O
of	O
the	O
points	O
then	O
the	O
structure	B
and	O
camera	B
parameters	I
may	O
be	O
estimated	O
by	O
a	O
simple	O
factorization	O
algorithm	B
similar	O
in	O
style	O
to	O
the	O
afﬁne	B
factorization	O
algorithm	B
.	O
consider	O
a	O
set	O
of	O
image	O
points	O
xi	O
j	O
=	O
pixj	O
.	O
this	O
equation	O
representing	O
the	O
projective	B
mapping	O
is	O
to	O
be	O
interpreted	O
as	O
true	O
only	O
up	O
to	O
a	O
constant	O
factor	O
.	O
writing	O
these	O
constant	O
xi	O
j	O
=	O
pixj	O
.	O
in	O
this	O
equation	O
,	O
and	O
henceforth	O
in	O
the	O
de-	O
factors	O
explicitly	O
,	O
we	O
have	O
λi	O
j	O
scription	O
of	O
the	O
projective	O
factorization	B
algorithm	O
,	O
the	O
notation	O
xi	O
j	O
means	O
the	O
3-vector	O
j	O
,	O
1	O
)	O
t	O
representing	O
an	O
image	O
point	O
.	O
thus	O
the	O
third	O
coordinate	O
is	O
equal	O
to	O
unity	O
,	O
(	O
xi	O
j	O
,	O
yi	O
and	O
xi	O
j	O
are	O
the	O
actual	O
measured	O
image	O
coordinates	O
.	O
provided	O
that	O
each	O
point	B
is	O
j	O
and	O
yi	O
visible	O
in	O
every	O
view	O
,	O
so	O
that	O
xi	O
j	O
is	O
known	O
for	O
all	O
i	O
,	O
j	O
,	O
the	O
complete	O
set	O
of	O
equations	O
may	O
be	O
written	O
as	O
a	O
single	O
matrix	O
equation	O
as	O
follows	O
:	O
	O
x1	O
λ1	O
1	O
1	O
x2	O
λ2	O
1	O
1	O
...	O
xm	O
λm	O
1	O
1	O
x1	O
λ1	O
2	O
2	O
x2	O
λ2	O
2	O
2	O
...	O
xm	O
λm	O
2	O
2	O
x1	O
.	O
.	O
.	O
λ1	O
n	O
n	O
x2	O
.	O
.	O
.	O
λm	O
n	O
n	O
...	O
...	O
xm	O
.	O
.	O
.	O
λm	O
n	O
n	O
	O
=	O
	O
p1	O
p2	O
...	O
pm	O
	O
[	O
x1	O
,	O
x2	O
,	O
.	O
.	O
.	O
,	O
xn	O
]	O
.	O
(	O
18.9	O
)	O
18.4	O
projective	B
factorization	I
445	O
objective	O
given	O
a	O
set	O
of	O
n	O
image	O
points	O
seen	O
in	O
m	O
views	O
:	O
xi	O
j	O
;	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
,	O
j	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
compute	O
a	O
projective	B
reconstruction	I
.	O
algorithm	B
(	O
i	O
)	O
normalize	O
the	O
image	O
data	O
using	O
isotropic	O
scaling	B
as	O
in	O
section	O
4.4.4	O
(	O
p107	O
)	O
.	O
(	O
ii	O
)	O
start	O
with	O
an	O
initial	O
estimate	O
of	O
the	O
projective	O
depths	O
λi	O
j.	O
this	O
may	O
be	O
obtained	O
by	O
techniques	O
such	O
as	O
an	O
initial	O
projective	O
reconstruction	B
,	O
or	O
else	O
by	O
setting	O
all	O
λi	O
j	O
=	O
1	O
.	O
(	O
iii	O
)	O
normalize	O
the	O
depths	O
λi	O
j	O
by	O
multiplying	O
rows	O
and	O
columns	O
by	O
constant	O
factors	O
.	O
one	O
method	O
is	O
to	O
do	O
a	O
pass	O
setting	O
the	O
norms	O
of	O
all	O
rows	O
to	O
1	O
,	O
then	O
a	O
similar	O
pass	O
on	O
columns	O
.	O
(	O
iv	O
)	O
form	O
the	O
3m	O
×	O
n	O
measurement	B
matrix	I
on	O
the	O
left	O
of	O
(	O
18.9	O
)	O
,	O
ﬁnd	O
its	O
nearest	O
rank-4	O
ap-	O
proximation	O
using	O
the	O
svd	O
and	O
decompose	O
to	O
ﬁnd	O
the	O
camera	B
matrices	I
and	O
3d	O
points	O
.	O
(	O
v	O
)	O
optional	O
iteration	B
.	O
reproject	O
the	O
points	O
into	O
each	O
image	O
to	O
obtain	O
new	O
estimates	O
of	O
the	O
depths	O
and	O
repeat	O
from	O
step	O
(	O
ii	O
)	O
.	O
algorithm	B
18.2.	O
projective	B
reconstruction	I
through	O
factorization	B
.	O
this	O
equation	O
is	O
true	O
only	O
if	O
the	O
correct	O
weighting	O
factors	O
λi	O
j	O
are	O
applied	O
to	O
each	O
of	O
the	O
measured	O
points	O
xi	O
j.	O
for	O
the	O
present	O
,	O
let	O
us	O
assume	O
that	O
these	O
depths	O
are	O
known	O
.	O
as	O
with	O
the	O
afﬁne	B
factorization	O
algorithm	B
,	O
we	O
would	O
like	O
the	O
matrix	B
on	O
the	O
left	O
–	O
denote	O
it	O
by	O
w	O
–	O
to	O
have	O
rank	O
4	O
,	O
since	O
it	O
is	O
the	O
product	O
of	O
two	O
matrices	O
with	O
4	O
columns	O
and	O
rows	O
respectively	O
.	O
the	O
actual	O
measurement	B
matrix	I
can	O
be	O
corrected	O
to	O
have	O
rank	O
4	O
by	O
using	O
the	O
svd	O
.	O
thus	O
,	O
if	O
w	O
=	O
udvt	O
,	O
all	O
but	O
the	O
ﬁrst	O
four	O
diagonal	O
entries	O
of	O
d	O
are	O
set	O
to	O
zero	O
resulting	O
in	O
ˆd	O
.	O
the	O
corrected	O
measurement	B
matrix	I
is	O
ˆw	O
=	O
uˆdvt	O
.	O
the	O
camera	B
matrices	I
are	O
retrieved	O
from	O
[	O
pt	O
m	O
]	O
t	O
=	O
uˆd	O
and	O
the	O
points	O
from	O
[	O
x1	O
,	O
x2	O
,	O
.	O
.	O
.	O
,	O
xn	O
]	O
=	O
vt.	O
note	O
that	O
this	O
factorization	B
is	O
not	O
unique	O
,	O
and	O
in	O
fact	O
we	O
may	O
interpose	O
an	O
arbitrary	O
4	O
×	O
4	O
projective	B
transformation	I
h	O
and	O
its	O
inverse	O
between	O
the	O
two	O
matrices	O
on	O
the	O
right	O
of	O
(	O
18.9	O
)	O
,	O
reﬂecting	O
the	O
fact	O
that	O
reconstruction	B
has	O
a	O
projective	B
ambiguity	I
.	O
2	O
,	O
.	O
.	O
.	O
,	O
p	O
t	O
1	O
,	O
pt	O
the	O
steps	O
of	O
the	O
projective	O
factorization	B
method	O
are	O
summarized	O
in	O
algorithm	O
18.2	O
.	O
18.4.1	O
choosing	B
the	I
depths	I
the	O
weighting	O
factors	O
λi	O
j	O
are	O
called	O
the	O
projective	B
depths	O
of	O
the	O
points	O
.	O
the	O
justiﬁcation	B
of	O
this	O
terminology	B
is	O
the	O
relation	B
of	O
these	O
λi	O
j	O
to	O
the	O
actual	O
depths	O
if	O
camera	B
matrices	I
are	O
known	O
in	O
a	O
euclidean	O
frame	O
.	O
refer	O
to	O
section	O
6.2.3	O
(	O
p162	O
)	O
and	O
in	O
particular	O
ﬁgure	O
6.6-	O
(	O
p162	O
)	O
.	O
the	O
main	O
difﬁculty	O
with	O
this	O
projective	B
factorization	I
algorithm	O
is	O
that	O
we	O
need	O
to	O
know	O
these	O
projective	B
depths	O
up	O
front	O
,	O
but	O
we	O
do	O
not	O
have	O
this	O
knowledge	O
.	O
there	O
are	O
various	O
techniques	O
to	O
estimate	O
the	O
depths	O
.	O
(	O
i	O
)	O
start	O
with	O
an	O
initial	O
projective	O
reconstruction	B
obtained	O
by	O
other	O
means	O
,	O
such	O
as	O
j	O
by	O
reprojecting	O
the	O
3d	O
those	O
discussed	O
in	O
section	O
18.6	O
below	O
.	O
then	O
compute	O
λi	O
points	O
.	O
(	O
ii	O
)	O
start	O
with	O
initial	O
depths	O
all	O
equal	O
to	O
1	O
,	O
compute	O
the	O
reconstruction	B
and	O
reproject	O
to	O
obtain	O
a	O
new	O
estimate	O
of	O
the	O
depths	O
.	O
this	O
step	O
may	O
be	O
repeated	O
to	O
obtain	O
446	O
18	O
n-view	O
computational	O
methods	O
improved	O
estimates	O
.	O
however	O
,	O
there	O
is	O
no	O
guarantee	O
that	O
the	O
procedure	O
will	O
converge	O
to	O
a	O
global	O
minimum	O
.	O
the	O
original	O
paper	O
[	O
sturm-96	O
]	O
gives	O
a	O
method	O
of	O
computing	O
the	O
depths	O
by	O
stringing	O
together	O
pairwise	O
estimates	O
of	O
the	O
depth	O
obtained	O
from	O
the	O
fundamental	B
matrix	I
,	O
or	O
the	O
trifocal	B
tensor	I
.	O
this	O
method	O
is	O
quite	O
similar	O
to	O
obtaining	O
an	O
initial	O
projective	O
recon-	O
struction	O
by	O
stringing	O
together	O
triples	O
of	O
images	O
(	O
see	O
section	O
18.6	O
)	O
,	O
whilst	O
ensuring	O
that	O
the	O
scale	O
factors	O
are	O
consistent	O
for	O
a	O
common	O
projective	B
reconstruction	I
.	O
(	O
cid:7	O
)	O
ij	O
(	O
cid:10	O
)	O
λi	O
j	O
xi	O
j	O
18.4.2	O
what	B
is	I
being	I
minimized	I
?	O
in	O
the	O
case	O
of	O
noise	O
,	O
or	O
incorrect	O
values	O
for	O
λi	O
j	O
,	O
the	O
equations	O
(	O
18.9	O
)	O
are	O
not	O
satisﬁed	O
ex-	O
actly	O
.	O
we	O
determine	O
a	O
corrected	O
measurement	B
matrix	I
ˆw	O
that	O
is	O
closest	O
to	O
w	O
in	O
frobenius	O
norm	B
,	O
subject	O
to	O
having	O
rank	O
4.	O
denoting	O
the	O
entries	O
of	O
this	O
matrix	B
as	O
ˆλi	O
j	O
,	O
then	O
the	O
computed	O
solution	O
minimizes	O
the	O
expression	O
(	O
cid:10	O
)	O
w	O
−	O
ˆw	O
(	O
cid:10	O
)	O
2	O
=	O
jxi	O
j	O
−	O
ˆλi	O
j	O
)	O
2	O
(	O
18.10	O
)	O
because	O
of	O
the	O
last	O
term	O
,	O
at	O
a	O
minimum	O
ˆλi	O
j.	O
assuming	O
they	O
are	O
(	O
cid:10	O
)	O
is	O
the	O
geomet-	O
−	O
ˆxi	O
−	O
ˆxi	O
equal	O
,	O
(	O
18.10	O
)	O
reduces	O
to	O
ric	O
distance	B
between	O
the	O
measured	O
and	O
estimated	O
points	O
,	O
what	B
is	I
being	I
minimized	I
is	O
a	O
weighted	B
sum-of-squares	O
geometric	B
distance	I
,	O
where	O
each	O
point	B
is	O
being	O
weighted	B
by	O
j	O
are	O
close	O
to	O
equal	O
,	O
then	O
the	O
factorization	B
method	O
j.	O
if	O
all	O
the	O
geometric	B
depths	O
λi	O
λi	O
minimizes	O
an	O
approximation	O
to	O
geometric	O
distance	B
scaled	O
by	O
the	O
common	O
value	O
of	O
λi	O
j.	O
j	O
must	O
be	O
close	O
to	O
λi	O
(	O
cid:10	O
)	O
2.	O
noting	O
that	O
(	O
cid:10	O
)	O
xi	O
−	O
ˆλi	O
j	O
ˆxi	O
(	O
cid:27	O
)	O
j	O
)	O
2	O
+	O
(	O
λi	O
jyi	O
j	O
−	O
ˆλi	O
j	O
ˆxi	O
−	O
ˆλi	O
j	O
ˆyi	O
j	O
)	O
2	O
(	O
cid:10	O
)	O
xi	O
j	O
ij	O
(	O
λi	O
(	O
cid:10	O
)	O
2	O
=	O
j	O
j	O
)	O
2	O
+	O
(	O
λi	O
j	O
(	O
cid:7	O
)	O
ij	O
(	O
λi	O
j	O
ˆxi	O
j	O
j	O
j	O
18.4.3	O
normalizing	O
the	O
depths	O
projective	B
depths	O
as	O
deﬁned	O
here	O
are	O
not	O
unique	O
.	O
indeed	O
suppose	O
that	O
λi	O
j	O
we	O
replace	O
pi	O
by	O
αipi	O
and	O
xj	O
by	O
βjxj	O
,	O
then	O
we	O
ﬁnd	O
that	O
xi	O
j	O
=	O
pixj	O
.	O
if	O
(	O
αiβjλi	O
j	O
)	O
xi	O
j	O
=	O
(	O
αipi	O
)	O
(	O
βjxj	O
)	O
.	O
in	O
other	O
words	O
,	O
the	O
projective	B
depths	O
λi	O
j	O
may	O
be	O
replaced	O
by	O
multiplying	O
the	O
i-th	O
row	O
of	O
(	O
18.9	O
)	O
by	O
a	O
factor	O
αi	O
and	O
the	O
j-th	O
column	O
by	O
a	O
factor	O
βj	O
.	O
in	O
the	O
light	O
of	O
the	O
previous	O
paragraph	O
,	O
the	O
closer	O
all	O
λi	O
j	O
are	O
to	O
unity	O
,	O
the	O
more	O
exactly	O
the	O
error	B
expression	O
represents	O
geometric	B
distance	I
.	O
therefore	O
,	O
it	O
is	O
advantageous	O
to	O
renormalize	O
the	O
values	O
of	O
the	O
λi	O
j	O
so	O
that	O
they	O
are	O
as	O
close	O
to	O
unity	O
as	O
possible	O
,	O
by	O
multiplying	O
rows	O
and	O
columns	O
of	O
the	O
measurement	O
matrix	B
by	O
constant	O
values	O
αi	O
and	O
βj	O
.	O
a	O
simple	O
heuristic	O
manner	O
of	O
doing	O
this	O
is	O
to	O
multiply	O
each	O
row	O
by	O
a	O
factor	O
αi	O
so	O
that	O
it	O
has	O
unit	O
norm	B
,	O
followed	O
by	O
a	O
similar	O
pass	O
normalizing	O
the	O
columns	O
.	O
the	O
row	O
and	O
column	O
passes	O
may	O
be	O
iterated	O
.	O
18.4.4	O
normalizing	O
the	O
image	O
coordinates	B
as	O
with	O
most	O
numerical	O
algorithms	O
involving	O
homogeneous	O
representations	O
of	O
image	O
coordinates	B
described	O
in	O
this	O
book	O
,	O
it	O
is	O
important	O
to	O
normalize	O
the	O
image	O
coordinates	O
.	O
a	O
reasonable	O
scheme	O
is	O
the	O
isotropic	B
normalization	O
method	O
described	O
in	O
section	O
4.4.4-	O
(	O
p107	O
)	O
.	O
one	O
can	O
see	O
the	O
necessity	O
of	O
normalization	O
quite	O
clearly	O
in	O
this	O
case	O
.	O
consider	O
two	O
image	O
points	O
x	O
=	O
(	O
200	O
,	O
300	O
,	O
1	O
)	O
t	O
and	O
ˆx	O
=	O
(	O
250	O
,	O
375	O
,	O
1	O
)	O
t.	O
obviously	O
these	O
points	O
18.5	O
projective	B
reconstruction	I
using	O
planes	O
447	O
are	O
very	O
far	O
apart	O
in	O
a	O
geometric	B
sense	O
.	O
however	O
,	O
the	O
error	B
expression	O
(	O
18.10	O
)	O
mea-	O
sures	O
not	O
geometric	B
error	I
,	O
but	O
the	O
distance	B
between	O
homogeneous	O
vectors	O
(	O
cid:10	O
)	O
λx	O
−	O
ˆλˆx	O
(	O
cid:10	O
)	O
.	O
choosing	O
λ	O
=	O
1.25	O
and	O
ˆλ	O
=	O
1.0	O
,	O
the	O
error	B
is	O
(	O
cid:10	O
)	O
(	O
250	O
,	O
375	O
,	O
1.25	O
)	O
t	O
−	O
(	O
250	O
,	O
375	O
,	O
1	O
)	O
t	O
(	O
cid:10	O
)	O
which	O
is	O
proportionally	O
quite	O
small	O
.	O
on	O
the	O
other	O
hand	O
,	O
the	O
distance	B
between	O
points	O
x	O
=	O
(	O
200	O
,	O
300	O
,	O
1	O
)	O
t	O
and	O
ˆx	O
=	O
(	O
199	O
,	O
301	O
,	O
1	O
)	O
t	O
,	O
which	O
are	O
much	O
closer	O
geometrically	O
can	O
not	O
be	O
made	O
so	O
small	O
by	O
choice	B
of	O
λ	O
and	O
ˆλ	O
(	O
except	O
for	O
small	O
values	O
)	O
.	O
the	O
reader	O
may	O
observe	O
that	O
if	O
the	O
points	O
are	O
scaled	O
down	O
by	O
a	O
factor	O
of	O
200	O
,	O
then	O
this	O
anomalous	O
sit-	O
uation	O
no	O
longer	O
occurs	O
.	O
in	O
short	O
,	O
with	O
normalized	O
coordinates	B
,	O
the	O
error	B
is	O
a	O
closer	O
approximation	O
to	O
geometric	O
error	B
.	O
j	O
(	O
xi	O
j	O
,	O
yi	O
32	O
+	O
p2	O
18.4.5	O
when	O
is	O
the	O
assumption	O
λi	O
j	O
=	O
1	O
reasonable	O
?	O
if	O
camera	B
matrices	I
are	O
normalized	O
such	O
that	O
according	O
to	O
result	O
6.1	O
(	O
p162	O
)	O
,	O
33	O
=	O
1	O
,	O
and	O
3d	O
points	O
are	O
normalized	O
to	O
have	O
last	O
coordinate	O
t	O
=	O
1	O
,	O
then	O
p2	O
31	O
+	O
p2	O
j	O
,	O
1	O
)	O
=	O
pixj	O
are	O
the	O
true	O
depths	O
of	O
the	O
points	O
from	O
the	O
camera	B
λij	O
deﬁned	O
by	O
λi	O
in	O
a	O
euclidean	O
frame	O
.	O
if	O
all	O
points	O
are	O
equidistant	O
from	O
the	O
cameras	B
throughout	O
a	O
se-	O
quence	O
then	O
we	O
may	O
reasonably	O
assume	O
that	O
each	O
λi	O
j	O
=	O
1	O
,	O
for	O
(	O
18.9	O
)	O
will	O
have	O
at	O
least	O
the	O
solution	B
where	O
pi	O
and	O
xj	O
are	O
the	O
true	O
cameras	B
and	O
points	O
,	O
normalized	O
in	O
the	O
manner	O
just	O
stated	O
.	O
more	O
generally	O
,	O
suppose	O
that	O
points	O
are	O
located	O
at	O
different	O
depths	O
,	O
but	O
each	O
point	B
xj	O
remains	O
at	O
approximately	O
the	O
same	O
depth	O
dj	O
from	O
the	O
cameras	B
through	O
the	O
whole	O
sequence	O
.	O
in	O
this	O
case	O
a	O
solution	B
will	O
exist	O
with	O
all	O
λi	O
j	O
=	O
1	O
in	O
which	O
the	O
com-	O
−1	O
j	O
(	O
xj	O
,	O
yj	O
,	O
zj	O
,	O
1	O
)	O
t.	O
similarly	O
,	O
by	O
allowing	O
multiplication	O
of	O
the	O
camera	O
puted	O
xj	O
=	O
d	O
matrices	O
by	O
a	O
factor	O
,	O
we	O
ﬁnd	O
•	O
if	O
the	O
ratios	O
of	O
true	O
depths	O
of	O
the	O
different	O
3d	O
points	O
xj	O
remain	O
approximately	O
con-	O
stant	O
during	O
a	O
sequence	O
,	O
then	O
the	O
assumption	O
λi	O
j	O
=	O
1	O
is	O
a	O
good	O
ﬁrst	O
approximation	O
to	O
projective	O
depth	O
.	O
this	O
is	O
for	O
instance	O
the	O
case	O
of	O
an	O
aerial	O
image	O
camera	O
pointing	O
straight	O
down	O
from	O
constant	O
altitude	O
.	O
18.5	O
projective	B
reconstruction	I
using	O
planes	O
it	O
was	O
seen	O
in	O
section	O
17.5.2	O
that	O
if	O
four	O
points	O
visible	O
in	O
each	O
view	O
are	O
known	O
to	O
be	O
coplanar	O
then	O
the	O
computation	B
of	I
the	O
multifocal	O
tensors	O
relating	O
the	O
image	O
points	O
becomes	O
signiﬁcantly	O
more	O
simple	O
.	O
a	O
major	O
advantage	O
is	O
that	O
a	O
tensor	B
satisfying	O
all	O
its	O
constraints	B
may	O
be	O
computed	O
using	O
a	O
linear	B
algorithm	I
.	O
we	O
now	O
continue	O
with	O
that	O
particular	O
line	B
of	O
investigation	O
,	O
and	O
show	O
that	O
the	O
use	O
of	O
linear	B
techniques	O
extends	O
to	O
estimation	O
of	O
motion	O
and	O
structure	B
for	O
any	O
number	O
of	O
views	O
.	O
the	O
condition	O
that	O
four	O
of	O
the	O
image	O
correspondences	O
are	O
derived	O
from	O
coplanar	O
points	O
is	O
equivalent	B
to	O
knowing	O
the	O
homographies	B
between	O
the	O
images	O
induced	B
by	I
a	I
plane	I
in	O
space	O
,	O
since	O
a	O
homography	B
may	O
be	O
computed	O
from	O
the	O
four	O
points	O
.	O
it	O
is	O
only	O
the	O
homographies	B
that	O
are	O
important	O
in	O
the	O
following	O
approach	O
.	O
these	O
homographies	B
may	O
be	O
computed	O
from	O
four	O
or	O
more	O
point	O
correspondences	B
,	O
or	O
line	B
correspondences	I
,	O
or	O
estimated	O
directly	O
from	O
the	O
images	O
by	O
direct	O
correlation	O
methods	O
.	O
448	O
18	O
n-view	O
computational	O
methods	O
what	O
do	O
the	O
plane-plane	O
homographies	B
tell	O
us	O
?	O
the	O
key	O
to	O
projective	O
reconstruction	B
using	O
planes	O
is	O
the	O
observation	O
that	O
knowledge	O
of	O
homographies	O
between	O
the	O
images	O
means	O
we	O
know	O
the	O
ﬁrst	O
3	O
×	O
3	O
part	O
of	O
the	O
camera	O
matrices	O
:	O
	O
m	O
p	O
=	O
	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
(	O
cid:8	O
)	O
t1	O
t2	O
t3	O
hence	O
,	O
it	O
remains	O
only	O
to	O
compute	O
their	O
last	O
columns	O
,	O
namely	O
the	O
vectors	O
t.	O
since	O
we	O
are	O
interested	O
at	O
this	O
point	B
only	O
in	O
obtaining	O
a	O
projective	B
reconstruction	I
of	O
the	O
scene	O
,	O
we	O
may	O
suppose	O
that	O
the	O
plane	B
inducing	O
the	O
homographies	B
is	O
the	O
plane	O
at	O
inﬁnity	O
,	O
with	O
points	O
xj	O
=	O
(	O
xj	O
,	O
yj	O
,	O
zj	O
,	O
0	O
)	O
t.	O
camera	B
matrices	I
may	O
be	O
written	O
in	O
the	O
form	O
pi	O
=	O
[	O
mi|ti	O
]	O
,	O
where	O
m	O
is	O
a	O
3	O
×	O
3	O
matrix	B
and	O
ti	O
is	O
a	O
column	B
vector	I
.	O
a	O
reasonable	O
assumption	O
is	O
that	O
the	O
camera	B
centres	O
do	O
not	O
lie	O
on	O
the	O
plane	B
inducing	O
the	O
homographies	B
(	O
for	O
otherwise	O
the	O
homographies	B
will	O
be	O
degenerate	B
)	O
.	O
this	O
means	O
that	O
the	O
matrix	B
m	O
is	O
non-singular	O
.	O
for	O
simplicity	O
,	O
the	O
ﬁrst	O
camera	B
may	O
be	O
assumed	O
to	O
have	O
the	O
form	O
p1	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
where	O
i	O
is	O
the	O
identity	O
matrix	B
.	O
now	O
,	O
if	O
xi	O
j	O
is	O
the	O
point	B
in	O
image	O
i	O
corresponding	O
to	O
the	O
3d	O
point	B
xj	O
=	O
(	O
xj	O
,	O
yj	O
,	O
zj	O
,	O
0	O
)	O
t	O
lying	O
on	O
the	O
homography-inducing	O
plane	B
,	O
then	O
whereas	O
j	O
=	O
p1	O
(	O
xj	O
,	O
yj	O
,	O
zj	O
,	O
0	O
)	O
t	O
=	O
(	O
xj	O
,	O
yj	O
,	O
zj	O
)	O
t	O
x1	O
j	O
=	O
mi	O
(	O
xj	O
,	O
yj	O
,	O
zj	O
)	O
t	O
=	O
mix1	O
xi	O
j	O
.	O
thus	O
mi	O
represents	O
the	O
homography	B
from	O
the	O
ﬁrst	O
image	O
to	O
the	O
i-th	O
image	O
induced	O
by	O
the	O
plane	B
.	O
conversely	O
,	O
if	O
mi	O
is	O
the	O
known	O
plane-induced	O
homography	B
that	O
maps	O
a	O
point	B
in	O
the	O
ﬁrst	O
image	O
to	O
its	O
matching	B
point	O
in	O
the	O
i-th	O
image	O
,	O
then	O
the	O
set	O
of	B
camera	I
matrices	O
can	O
be	O
assumed	O
to	O
have	O
the	O
form	O
pi	O
=	O
[	O
mi|ti	O
]	O
,	O
where	O
the	O
mi	O
are	O
known	O
and	O
their	O
scale	O
is	O
ﬁxed	O
,	O
but	O
the	O
ﬁnal	O
columns	O
ti	O
are	O
not	O
.	O
known	O
camera	O
orientation	B
.	O
we	O
have	O
just	O
shown	O
that	O
knowledge	O
of	O
homographies	O
implies	O
the	O
knowledge	O
of	O
the	O
left-hand	O
3	O
×	O
3	O
submatrix	O
of	O
each	O
camera	B
matrix	I
.	O
the	O
same	O
will	O
hold	O
if	O
we	O
know	O
the	O
orientation	B
(	O
and	O
calibration	B
)	O
of	O
all	O
the	O
cameras	B
.	O
for	O
in-	O
stance	O
,	O
a	O
reasonable	O
approach	O
to	O
reconstruction	O
,	O
knowing	O
the	O
calibration	B
of	O
each	O
cam-	O
era	O
,	O
is	O
to	O
estimate	O
the	O
orientation	B
of	O
each	O
camera	B
separately	O
from	O
the	O
translation	O
(	O
for	O
example	O
from	O
two	O
or	O
more	O
scene	O
vanishing	B
points	I
)	O
.	O
once	O
the	O
orientation	B
(	O
ri	O
)	O
and	O
cal-	O
ibration	O
(	O
ki	O
)	O
of	O
each	O
camera	B
is	O
known	O
,	O
the	O
left-hand	O
block	O
of	O
each	O
camera	B
matrix	I
is	O
kiri	O
.	O
18.5.1	O
direct	B
solution	I
for	I
structure	I
and	I
translation	I
we	O
describe	O
two	O
separate	O
methods	O
for	O
computation	B
of	I
the	O
projective	B
structure	O
given	O
plane-induced	O
homographies	B
between	O
images	O
.	O
the	O
ﬁrst	O
method	O
solves	O
for	O
the	O
3d	O
points	O
and	O
the	O
camera	B
motion	I
simultaneously	O
by	O
solving	B
a	O
single	O
linear	O
system	O
.	O
sup-	O
pose	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
1	O
)	O
t	O
is	O
not	O
on	O
the	O
plane	O
at	O
inﬁnity	O
,	O
that	O
is	O
,	O
the	O
plane	B
inducing	O
the	O
homographies	B
.	O
18.5	O
projective	B
reconstruction	I
using	O
planes	O
449	O
where	O
the	O
(	O
unknown	O
)	O
scale	O
factor	O
λ	O
has	O
been	O
explicitly	O
written	O
.	O
more	O
precisely	O
,	O
we	O
may	O
write	O
the	O
equation	O
for	O
point	O
projection	B
is	O
λx	O
=	O
px	O
=	O
[	O
m|t	O
]	O
x	O
=	O
[	O
m|t	O
]	O
	O
x	O
	O
=	O
	O
mt	O
λ	O
t1	O
t2	O
t3	O
i	O
is	O
the	O
i-th	O
row	O
of	O
the	O
matrix	B
m.	O
1	O
mt	O
2	O
mt	O
3	O
y	O
1	O
(	O
cid:21	O
)	O
	O
(	O
cid:20	O
)	O
(	O
cid:22	O
)	O
x	O
1	O
=	O
where	O
mt	O
1	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
(	O
cid:22	O
)	O
x	O
	O
mt	O
1	O
mt	O
2	O
mt	O
3	O
	O
(	O
cid:22	O
)	O
x	O
+	O
t1	O
(	O
cid:22	O
)	O
x	O
+	O
t2	O
(	O
cid:22	O
)	O
x	O
+	O
t3	O
the	O
unknown	O
scale	O
factor	O
λ	O
may	O
be	O
eliminated	O
by	O
taking	O
the	O
vector	O
product	O
of	O
the	O
two	O
sides	O
of	O
this	O
equation	O
,	O
resulting	O
in	O
1	O
mt	O
2	O
mt	O
3	O
this	O
provides	O
two	O
independent	O
equations	O
y	O
1	O
	O
=	O
0	O
.	O
	O
mt	O
	O
×	O
	O
x	O
(	O
cid:22	O
)	O
x	O
+	O
t1	O
(	O
cid:22	O
)	O
x	O
+	O
t2	O
(	O
cid:22	O
)	O
x	O
+	O
t3	O
(	O
cid:22	O
)	O
x	O
+	O
t1	O
)	O
=	O
0	O
(	O
cid:22	O
)	O
x	O
+	O
t3	O
)	O
−	O
(	O
mt	O
(	O
cid:22	O
)	O
x	O
+	O
t3	O
)	O
−	O
(	O
mt	O
(	O
cid:22	O
)	O
x	O
+	O
t2	O
)	O
=	O
0	O
	O
=	O
0	O
.	O
(	O
cid:18	O
)	O
	O
−1	O
x	O
0	O
−1	O
y	O
−	O
mt	O
−	O
mt	O
(	O
cid:22	O
)	O
x	O
0	O
1	O
1	O
2	O
x	O
(	O
mt	O
3	O
y	O
(	O
mt	O
3	O
(	O
cid:17	O
)	O
xmt	O
3	O
ymt	O
3	O
t1	O
t2	O
t3	O
which	O
are	O
linear	B
in	O
the	O
unknowns	O
(	O
cid:22	O
)	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
)	O
t	O
and	O
t	O
=	O
(	O
t1	O
,	O
t2	O
,	O
t3	O
)	O
t.	O
the	O
equations	O
2	O
may	O
be	O
written	O
as	O
thus	O
,	O
each	O
measured	O
point	B
xi	O
j	O
=	O
pixj	O
generates	O
a	O
pair	O
of	O
equations	O
,	O
and	O
with	O
m	O
views	O
involving	O
n	O
points	O
a	O
2nm	O
set	O
of	O
equations	O
in	O
3n	O
+	O
3m	O
unknowns	O
is	O
generated	O
in	O
this	O
way	O
.	O
these	O
equations	O
may	O
be	O
solved	O
by	O
linear	B
or	O
linear	B
least-squares	O
techniques	O
to	O
obtain	O
the	O
structure	B
and	O
motion	O
.	O
a	O
few	O
remarks	O
about	O
this	O
method	O
are	O
offered	O
.	O
(	O
i	O
)	O
in	O
contrast	O
to	O
factorization	O
methods	O
(	O
section	O
18.2	O
)	O
we	O
do	O
not	O
need	O
all	O
points	O
to	O
be	O
visible	O
in	O
all	O
views	O
.	O
only	O
equations	O
corresponding	O
to	O
the	O
measured	O
points	O
are	O
used	O
.	O
(	O
ii	O
)	O
since	O
it	O
is	O
assumed	O
that	O
points	O
have	O
ﬁnal	O
coordinate	O
equal	O
to	O
one	O
,	O
it	O
is	O
neces-	O
sary	O
to	O
exclude	O
points	O
that	O
lie	O
on	O
the	O
plane	O
at	O
inﬁnity	O
(	O
the	O
plane	B
inducing	O
the	O
homography	B
)	O
which	O
have	O
ﬁnal	O
coordinate	O
equal	O
to	O
zero	O
.	O
a	O
test	O
to	O
detect	O
points	O
lying	O
on	O
or	O
close	O
to	O
the	O
plane	B
is	O
necessary	O
.	O
(	O
iii	O
)	O
both	O
points	O
and	O
cameras	B
are	O
computed	O
at	O
once	O
.	O
for	O
a	O
large	O
number	O
of	O
points	O
and	O
cameras	B
this	O
may	O
be	O
a	O
very	O
large	O
estimation	B
problem	I
.	O
however	O
,	O
if	O
the	O
point	B
tracks	O
have	O
a	O
banded	O
form	O
,	O
then	O
sparse	B
solution	O
techniques	O
may	O
be	O
used	O
to	O
solve	O
the	O
equation	O
set	O
efﬁciently	O
,	O
as	O
in	O
section	O
a6.7	O
(	O
p613	O
)	O
.	O
450	O
18	O
n-view	O
computational	O
methods	O
this	O
method	O
and	O
its	O
implementation	B
are	O
discussed	O
in	O
depth	O
in	O
[	O
rother-01	O
,	O
rother-03	O
]	O
.	O
the	O
details	O
given	O
here	O
are	O
different	O
from	O
those	O
given	O
in	O
[	O
rother-01	O
]	O
,	O
where	O
the	O
structure	B
and	O
motion	O
computation	B
is	O
carried	O
out	O
in	O
a	O
speciﬁc	O
projective	B
frame	O
re-	O
lated	O
to	O
the	O
matched	O
points	O
on	O
the	O
plane	B
,	O
involving	O
a	O
coordinate	O
change	O
in	O
the	O
images	O
.	O
18.5.2	O
direct	B
motion	I
estimation	I
the	O
second	O
method	O
for	O
planar	O
reconstruction	O
knowing	O
homographies	B
solves	O
for	O
the	O
camera	B
matrices	I
ﬁrst	O
and	O
subsequently	O
computes	O
the	O
point	B
positions	O
.	O
we	O
start	O
from	O
the	O
set	O
of	B
camera	I
matrices	O
which	O
again	O
can	O
be	O
assumed	O
to	O
have	O
the	O
form	O
pi	O
=	O
[	O
hi|ti	O
]	O
,	O
where	O
the	O
hi	O
are	O
known	O
and	O
their	O
scale	O
is	O
ﬁxed	O
,	O
but	O
the	O
ﬁnal	O
columns	O
ti	O
are	O
not	O
.	O
we	O
may	O
assume	O
that	O
p1	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
so	O
that	O
t1	O
=	O
0.	O
the	O
set	O
of	O
all	O
remaining	O
ti	O
have	O
3m	O
−	O
4	O
degrees	B
of	I
freedom	I
,	O
since	O
the	O
ti	O
are	O
deﬁned	O
only	O
up	O
to	O
a	O
common	O
scale	O
.	O
now	O
assume	O
that	O
several	O
point	B
or	O
line	B
correspondences	I
across	O
two	O
or	O
more	O
views	O
are	O
known	O
(	O
three	O
views	O
are	O
required	O
for	B
lines	I
)	O
.	O
these	O
correspondences	B
must	O
derive	O
from	O
3d	O
points	O
or	O
lines	B
that	O
do	O
not	O
lie	O
in	O
the	O
reference	O
plane	B
(	O
used	O
to	O
compute	O
the	O
hi	O
)	O
.	O
each	O
point	B
correspondence	O
across	O
two	B
views	I
leads	O
to	O
a	O
linear	B
equation	O
in	O
the	O
entries	O
of	O
the	O
fundamental	O
matrix	B
.	O
similarly	O
,	O
correspondences	B
of	O
points	O
or	O
lines	B
across	O
three	O
or	O
four	O
views	O
lead	O
to	O
linear	O
equations	O
in	O
the	O
entries	O
of	O
the	O
trifocal	O
or	O
quadrifocal	B
tensor	I
.	O
the	O
key	O
point	B
(	O
as	O
explained	O
in	O
section	O
17.5.2	O
)	O
is	O
that	O
we	O
may	O
express	O
the	O
entries	O
of	O
the	O
fundamental	O
matrix	B
(	O
or	O
trifocal	B
or	O
quadrifocal	B
tensor	I
)	O
linearly	O
in	O
the	O
entries	O
of	O
the	O
vectors	O
ti	O
.	O
therefore	O
each	O
linear	B
relation	O
induced	O
by	O
a	O
point	O
or	O
line	B
correspondence	O
may	O
be	O
related	O
back	O
to	O
a	O
linear	B
relationship	O
in	O
terms	O
of	O
the	O
entries	O
of	O
the	O
ti	O
.	O
thus	O
,	O
for	O
example	O
,	O
a	O
correspondence	B
across	O
views	O
i	O
,	O
j	O
and	O
k	O
gives	O
rise	O
to	O
a	O
set	O
of	O
linear	O
equations	O
in	O
the	O
entries	O
of	O
the	O
three	O
vectors	O
ti	O
,	O
tj	O
and	O
tk	O
.	O
a	O
set	O
of	O
correspondences	O
across	O
many	O
views	O
can	O
be	O
broken	O
down	O
into	O
correspondences	B
across	O
sets	O
of	O
consecutive	O
views	O
.	O
thus	O
,	O
for	O
example	O
,	O
a	O
single	O
point	O
correspondence	B
across	O
m	O
>	O
4	O
views	O
will	O
give	O
a	O
set	O
of	O
equations	O
of	O
the	O
form	O
where	O
each	O
row	O
represents	O
a	O
set	O
of	O
equations	O
derived	O
from	O
a	O
quadrifocal	B
tensor	I
rela-	O
tionship	O
.	O
each	O
black	O
square	O
represents	O
a	O
block	O
with	O
3	O
columns	O
corresponding	O
to	O
one	O
of	O
the	O
vectors	O
ti	O
.	O
in	O
the	O
diagram	O
above	O
,	O
we	O
choose	O
to	O
wrap	O
the	O
equations	O
around	O
from	O
the	O
last	O
to	O
the	O
ﬁrst	O
view	O
to	O
add	O
greater	O
rigidity	O
.	O
otherwise	O
,	O
the	O
values	O
of	O
the	O
ti	O
can	O
drift	O
from	O
the	O
ﬁrst	O
to	O
the	O
last	O
view	O
.	O
other	O
schemes	O
for	O
selecting	O
groups	O
of	O
views	O
are	O
possible	O
,	O
and	O
it	O
is	O
not	O
necessary	O
to	O
restrict	O
to	O
consecutive	O
views	O
.	O
linear	B
relations	O
may	O
be	O
generated	O
between	O
any	O
subset	O
of	O
sufﬁciently	O
many	O
images	O
(	O
2	O
,	O
3	O
or	O
4	O
depending	O
on	O
which	O
tensor	B
is	O
used	O
to	O
generate	O
the	O
equations	O
)	O
.	O
one	O
must	O
trade	O
off	O
the	O
added	O
stability	B
of	O
the	O
solution	B
against	O
the	O
added	O
computational	O
cost	O
of	O
adding	O
more	O
equations	O
.	O
a	O
mixture	O
of	O
bifocal	O
,	O
trifocal	B
and	O
quadrifocal	O
constraints	O
may	O
be	O
used	O
18.5	O
projective	B
reconstruction	I
using	O
planes	O
451	O
in	O
generating	O
the	O
set	O
of	O
all	O
equations	O
,	O
and	O
it	O
is	O
not	O
necessary	O
that	O
all	O
points	O
be	O
visible	O
in	O
all	O
views	O
.	O
numbers	O
of	O
equations	O
generated	O
.	O
let	O
the	O
total	O
number	O
of	O
views	O
be	O
m.	O
consider	O
a	O
subset	O
of	O
s	O
views	O
(	O
s	O
=	O
2	O
,	O
3	O
or	O
4	O
)	O
and	O
let	O
n	O
point	B
correspondences	O
be	O
given	O
between	O
these	O
views	O
.	O
we	O
brieﬂy	O
consider	O
the	O
problem	O
of	O
reconstruction	B
from	O
this	O
subset	O
of	O
s	O
views	O
in	O
isolation	O
.	O
from	O
these	O
point	B
correspondences	O
we	O
can	O
generate	O
a	O
set	O
of	O
equations	O
at	O
(	O
cid:2	O
)	O
between	O
the	O
entries	O
t	O
(	O
cid:2	O
)	O
of	O
the	O
s	O
views	O
,	O
and	O
thence	O
estimate	O
the	O
values	O
of	O
the	O
3s	O
entries	O
of	O
t	O
(	O
cid:2	O
)	O
.	O
in	O
doing	O
this	O
,	O
we	O
can	O
assume	O
that	O
the	O
ﬁrst	O
view	O
has	O
t	O
=	O
0	O
,	O
and	O
the	O
vectors	O
t	O
from	O
the	O
remaining	O
s	O
−	O
1	O
views	O
are	O
only	O
determined	O
up	O
to	O
a	O
common	O
scale	O
.	O
thus	O
,	O
the	O
a	O
occurring	O
in	O
the	O
equation	O
set	O
at	O
(	O
cid:2	O
)	O
has	O
a	O
right	O
null-space	B
of	O
dimension	O
at	O
least	O
4	O
,	O
corresponding	O
to	O
the	O
4	O
degrees	B
of	I
freedom	I
of	O
the	O
solution	B
.	O
in	O
general	O
,	O
then	O
:	O
result	O
18.1.	O
ignoring	O
the	O
effects	O
of	O
noisy	O
data	O
,	O
the	O
total	O
rank	O
of	O
the	O
set	O
of	O
equations	O
generated	O
from	O
n	O
≥	O
2	O
point	B
correspondences	O
in	O
s	O
views	O
is	O
3s	O
−	O
4.	O
this	O
is	O
independent	O
of	O
the	O
number	O
of	O
point	O
(	O
or	O
line	B
)	O
correspondences	B
used	O
to	O
generate	O
them	O
.	O
to	O
be	O
exact	O
,	O
the	O
argument	O
above	O
showed	O
that	O
the	O
rank	O
was	O
at	O
most	O
3s−4	O
.	O
for	O
2-view	O
,	O
3-view	O
and	O
4-view	O
correspondences	B
this	O
is	O
equal	O
to	O
2	O
,	O
5	O
or	O
8	O
respectively	O
.	O
however	O
,	O
as	O
long	O
as	O
there	O
are	O
two	O
correspondences	O
the	O
maximum	O
rank	O
is	O
achieved	O
.	O
this	O
is	O
because	O
two	O
points	O
are	O
sufﬁcient	O
for	O
reconstruction	O
from	O
s	O
=	O
2	O
,	O
3	O
or	O
4	O
views	O
as	O
shown	O
by	O
the	O
counting	B
arguments	I
of	O
section	O
17.5.2.	O
now	O
consider	O
the	O
total	O
set	O
of	O
m	O
views	O
.	O
the	O
total	O
number	O
of	O
retrievable	O
parameters	B
of	O
all	O
the	O
ti	O
is	O
3m	O
−	O
4.	O
therefore	O
,	O
for	O
a	O
solution	O
to	O
be	O
possible	O
,	O
the	O
number	O
of	O
equations	O
must	O
exceed	O
3m	O
−	O
4	O
,	O
which	O
gives	O
the	O
following	O
result	O
.	O
result	O
18.2.	O
if	O
s	O
subsets	O
of	O
sk	O
views	O
are	O
chosen	O
from	O
among	O
m	O
views	O
,	O
then	O
in	O
order	O
to	O
solve	O
for	O
all	O
the	O
vectors	O
ti	O
representing	O
ﬁnal	O
columns	O
of	O
the	O
camera	O
matrices	O
,	O
it	O
is	O
necessary	O
that	O
s	O
(	O
cid:7	O
)	O
(	O
3sk	O
−	O
4	O
)	O
≥	O
3m	O
−	O
4	O
.	O
k=1	O
one	O
can	O
verify	O
that	O
if	O
2-view	O
correspondences	B
are	O
to	O
be	O
used	O
,	O
tions	O
derived	O
from	O
the	O
fundamental	B
matrix	I
constraints	O
,	O
ﬁcient	O
to	O
use	O
just	O
pairs	O
of	O
consecutive	O
views	O
involving	O
equa-	O
is	O
not	O
suf-	O
in	O
a	O
conﬁguration	O
such	O
as	O
then	O
it	O
for	O
in	O
this	O
case	O
,	O
the	O
total	O
number	O
of	O
equations	O
generated	O
is	O
m	O
(	O
3s−	O
4	O
)	O
=	O
m	O
(	O
3·	O
2−	O
4	O
)	O
=	O
2m	O
,	O
whereas	O
the	O
total	O
number	O
of	O
equations	O
required	O
is	O
3m	O
−	O
4.	O
thus	O
for	O
m	O
>	O
4	O
there	O
are	O
not	O
enough	O
equations	O
.	O
this	O
is	O
related	O
to	O
the	O
fact	O
that	O
the	O
fundamental	O
matrices	O
between	O
consecutive	O
views	O
are	O
not	O
sufﬁcient	O
to	O
deﬁne	O
the	O
structure	B
of	O
the	O
sequence	O
of	O
views	O
.	O
it	O
is	O
necessary	O
to	O
add	O
additional	O
constraints	B
from	O
non-consecutive	O
views	O
,	O
such	O
as	O
452	O
18	O
n-view	O
computational	O
methods	O
.	O
note	O
though	O
that	O
the	O
discussion	O
of	O
section	O
15.4	O
(	O
p383	O
)	O
suggests	O
that	O
it	O
is	O
preferable	O
to	O
use	O
trifocal	B
or	O
quadrifocal	O
constraints	O
over	O
triplets	O
or	O
quadruplets	O
of	O
views	O
.	O
implemen-	O
tation	O
details	O
for	O
this	O
method	O
are	O
given	O
in	O
[	O
kaucic-01	O
]	O
.	O
18.6	O
reconstruction	B
from	O
sequences	O
in	O
this	O
ﬁnal	O
section	O
we	O
bring	O
together	O
several	O
ideas	O
from	O
earlier	O
in	O
the	O
book	O
.	O
the	O
objective	O
here	O
is	O
to	O
compute	O
a	O
reconstruction	B
from	O
a	O
sequence	O
of	O
frames	O
provided	O
by	O
a	O
video	O
.	O
there	O
are	O
three	O
stages	O
to	O
this	O
problem	O
:	O
(	O
i	O
)	O
compute	O
corresponding	O
features	O
throughout	O
the	O
sequence	O
;	O
(	O
ii	O
)	O
compute	O
an	O
initial	O
reconstruction	O
which	O
may	O
be	O
used	O
as	O
a	O
starting	O
point	B
for	O
(	O
iii	O
)	O
bundle	B
adjustment	I
(	O
as	O
described	O
in	O
section	O
18.1	O
)	O
.	O
here	O
the	O
features	O
we	O
will	O
consider	O
are	O
interest	B
points	I
,	O
though	O
others	O
such	O
as	O
lines	O
could	O
equally	O
well	O
be	O
used	O
.	O
the	O
correspondence	B
problem	O
is	O
exacerbated	O
because	O
an	O
interest	O
point	O
feature	O
will	O
generally	O
not	O
appear	O
in	O
all	O
of	O
the	O
images	O
,	O
and	O
often	O
will	O
be	O
missing	O
from	O
consecutive	O
images	O
.	O
bundle	B
adjustment	I
,	O
however	O
,	O
is	O
not	O
hindered	O
by	O
missing	O
correspondences	B
.	O
there	O
are	O
several	O
advantages	O
of	O
a	O
video	O
sequence	O
over	O
an	O
arbitrary	O
set	O
of	O
images	O
:	O
(	O
i	O
)	O
there	O
is	O
an	O
ordering	O
on	O
the	O
images	O
;	O
(	O
ii	O
)	O
the	O
distance	B
between	O
camera	B
centres	O
(	O
the	O
base-	O
line	B
)	O
for	O
successive	O
frames	O
is	O
small	O
.	O
the	O
small	O
baseline	O
is	O
important	O
because	O
it	O
enables	O
possible	O
feature	O
matches	O
between	O
successive	O
images	O
to	O
be	O
obtained	O
and	O
assessed	O
more	O
easily	O
.	O
matches	O
are	O
more	O
easily	O
obtained	O
because	O
the	O
image	O
points	O
do	O
not	O
move	O
“	O
far	O
”	O
between	O
views	O
so	O
a	O
proximity	O
search	O
region	O
can	O
be	O
employed	O
;	O
matches	O
are	O
more	O
eas-	O
ily	O
assessed	O
(	O
as	O
to	O
whether	O
they	O
arise	O
from	O
the	O
same	O
point	O
in	O
3-space	O
)	O
because	O
nearby	O
images	O
are	O
similar	O
in	O
appearance	O
.	O
the	O
disadvantage	O
of	O
a	O
small	O
baseline	O
is	O
that	O
the	O
3d	O
structure	B
is	O
estimated	O
poorly	O
.	O
however	O
,	O
this	O
disadvantage	O
is	O
mitigated	O
by	O
tracking	O
over	O
many	O
views	O
in	O
the	O
sequence	O
so	O
that	O
the	O
effective	O
baseline	O
is	O
large	O
.	O
an	O
overview	O
of	O
the	O
method	O
is	O
given	O
in	O
algorithm	O
18.3.	O
there	O
are	O
several	O
strategies	O
that	O
may	O
be	O
used	O
to	O
obtain	O
the	O
initial	O
reconstruction	O
,	O
though	O
this	O
area	O
is	O
still	O
to	O
some	O
extent	O
a	O
black	O
art	O
.	O
three	O
possibilities	O
are	O
:	O
1.	O
extending	B
the	I
baseline	I
.	O
suppose	O
a	O
reasonable	O
number	O
of	O
scene	O
points	O
are	O
visible	O
throughout	O
the	O
sequence	O
.	O
correspondences	B
may	O
be	O
carried	O
through	O
from	O
the	O
ﬁrst	O
to	O
the	O
last	O
frame	O
using	O
the	O
pairwise	O
matches	O
(	O
from	O
f	O
)	O
,	O
or	O
the	O
triplet	O
matched	O
points	O
(	O
from	O
t	O
)	O
.	O
indeed	O
if	O
the	O
baseline	O
between	O
consecutive	O
frames	O
is	O
small	O
(	O
compared	O
to	O
the	O
struc-	O
ture	O
depth	O
)	O
,	O
then	O
pairwise	O
matches	O
may	O
be	O
obtained	O
using	O
homography	O
computation	B
(	O
algorithm	B
4.6	O
(	O
p123	O
)	O
)	O
–	O
this	O
provides	O
a	O
stronger	O
matching	B
constraint	O
(	O
point	B
to	O
point	B
)	O
than	O
f	O
(	O
point	B
to	O
line	B
)	O
.	O
a	O
trifocal	B
tensor	I
can	O
then	O
be	O
estimated	O
from	O
corresponding	O
points	O
in	O
the	O
ﬁrst	O
,	O
middle	O
(	O
say	O
)	O
,	O
and	O
end	O
frames	O
of	O
the	O
sequence	O
.	O
this	O
tensor	B
determines	O
a	O
projective	B
reconstruc-	O
18.6	O
reconstruction	B
from	O
sequences	O
453	O
objective	O
given	O
a	O
sequence	O
of	O
frames	O
in	O
a	O
video	O
,	O
compute	O
correspondences	B
and	O
a	O
reconstruction	B
of	O
the	O
scene	O
structure	O
and	O
the	O
camera	B
for	O
each	O
frame	O
.	O
algorithm	B
(	O
i	O
)	O
interest	B
points	I
:	O
compute	O
interest	B
points	I
in	O
each	O
image	O
.	O
(	O
ii	O
)	O
2	O
view	O
correspondences	B
:	O
compute	O
interest	O
point	O
correspondences	B
and	O
f	O
between	O
con-	O
secutive	O
frames	O
using	O
algorithm	O
11.4	O
(	O
p291	O
)	O
(	O
frames	O
may	O
be	O
omitted	O
if	O
the	O
baseline	O
motion	O
is	O
too	O
small	O
)	O
.	O
(	O
iii	O
)	O
3	O
view	O
correspondences	B
:	O
compute	O
interest	O
point	O
correspondences	B
and	O
t	O
between	O
all	O
consecutive	O
image	O
triplets	O
using	O
algorithm	O
16.4	O
(	O
p401	O
)	O
.	O
(	O
iv	O
)	O
initial	O
reconstruction	O
:	O
see	O
text	O
.	O
(	O
v	O
)	O
bundle	O
adjust	O
the	O
cameras	B
and	O
3d	O
structure	B
for	O
the	O
complete	O
sequence	O
.	O
(	O
vi	O
)	O
auto-calibration	B
:	O
see	O
chapter	O
19	O
(	O
optional	O
)	O
.	O
algorithm	B
18.3.	O
overview	O
of	O
reconstruction	O
from	O
a	O
sequence	O
of	O
images	O
.	O
tion	O
for	O
those	O
points	O
and	O
frames	O
.	O
the	O
cameras	B
for	O
the	O
intermediate	O
frames	O
may	O
then	O
be	O
estimated	O
by	O
resectioning	B
,	O
and	O
the	O
scene	O
points	O
not	O
visible	O
throughout	O
the	O
sequence	O
estimated	O
by	O
triangulation	B
.	O
2.	O
hierarchical	B
merging	I
of	O
sub-sequences	O
.	O
the	O
idea	O
here	O
is	O
to	O
partition	O
the	O
sequence	O
into	O
manageable	O
sub-sequences	O
(	O
there	O
can	O
be	O
several	O
hierarchical	O
layers	O
of	O
partition-	O
ing	O
)	O
.	O
a	O
projective	B
reconstruction	I
is	O
then	O
computed	O
for	O
each	O
sub-sequence	O
and	O
these	O
reconstructions	O
are	O
“	O
zipped	O
”	O
(	O
merged	O
)	O
together	O
.	O
consider	O
the	O
problem	O
of	O
merging	O
two	O
triplets	O
which	O
overlap	O
by	O
two	B
views	I
.	O
it	O
is	O
a	O
simple	O
matter	O
to	O
extend	O
the	O
correspondences	B
over	O
the	O
views	O
:	O
a	O
correspondence	B
which	O
exists	O
across	O
the	O
triplet	O
1-2-3	O
and	O
also	O
across	O
the	O
triplet	O
2-3-4	O
may	O
be	O
extended	O
to	O
the	O
frames	O
1-2-3-4	O
,	O
since	O
the	O
pair	O
2-3	O
overlaps	O
for	O
the	O
triplets	O
.	O
the	O
camera	B
matrices	I
and	O
3d	O
structure	B
are	O
then	O
computed	O
for	O
the	O
frames	O
1-2-3-4	O
,	O
for	O
example	O
by	O
ﬁrst	O
resectioning	B
and	O
then	O
bundle	B
adjustment	I
.	O
this	O
process	O
is	O
extended	O
by	O
merging	O
neighbouring	O
groups	O
of	O
frames	O
until	O
camera	B
matrices	I
and	O
correspondences	B
are	O
established	O
throughout	O
the	O
sequence	O
.	O
in	O
this	O
manner	O
error	B
can	O
be	O
distributed	O
evenly	O
over	O
the	O
sequence	O
.	O
3.	O
incremental	B
bundle	O
adjustment	O
.	O
a	O
fresh	O
bundle	B
adjustment	I
is	O
carried	O
out	O
as	O
the	O
correspondences	B
from	O
each	O
new	O
frame	O
are	O
added	O
.	O
the	O
disadvantage	O
of	O
this	O
method	O
is	O
the	O
computational	O
expense	O
and	O
also	O
the	O
possibility	O
that	O
error	B
systematically	O
accumu-	O
lates	O
.	O
of	O
course	O
these	O
three	O
methods	O
may	O
be	O
combined	O
together	O
.	O
for	O
example	O
,	O
the	O
se-	O
quence	O
can	O
be	O
partitioned	O
into	O
a	O
sub-sequence	O
where	O
common	O
points	O
are	O
visible	O
,	O
and	O
a	O
reconstruction	B
built	O
for	O
the	O
sub-sequence	O
using	O
the	O
extended	O
baseline	O
method	O
.	O
these	O
sub-sequences	O
may	O
then	O
be	O
combined	O
hierarchically	O
.	O
in	O
this	O
manner	O
structure	B
and	O
cameras	B
may	O
be	O
computed	O
automatically	O
for	O
sequences	O
consisting	O
of	O
hundreds	O
of	O
frames	O
.	O
these	O
reconstructions	O
may	O
form	O
the	O
basis	O
for	O
such	O
tasks	O
as	O
navigation	O
(	O
determining	O
the	O
camera/ego-position	O
)	O
and	O
virtual	O
model	B
genera-	O
454	O
18	O
n-view	O
computational	O
methods	O
a	O
c	O
b	O
d	O
fig	O
.	O
18.3.	O
corridor	O
sequence	O
.	O
(	O
a	O
)	O
a	O
three	O
dimensional	O
reconstruction	B
of	O
points	O
and	O
lines	B
in	O
the	O
scene	O
,	O
and	O
(	O
b	O
)	O
cameras	B
(	O
represented	O
by	O
their	O
image	O
planes	O
)	O
computed	O
automatically	O
from	O
the	O
images	O
.	O
a	O
texture	O
mapped	O
triangulated	O
graphical	O
model	B
is	O
then	O
automatically	O
constructed	O
as	O
described	O
in	O
[	O
baillard-99	O
]	O
.	O
(	O
c	O
)	O
a	O
rendering	O
of	O
the	O
scene	O
from	O
a	O
novel	O
viewpoint	O
,	O
different	O
from	O
any	O
in	O
the	O
sequence	O
.	O
(	O
d	O
)	O
vrml	O
model	B
of	O
the	O
scene	O
with	O
the	O
cameras	B
represented	O
by	O
their	O
image	O
planes	O
(	O
texture	O
mapped	O
with	O
the	O
original	O
images	O
from	O
the	O
sequence	O
)	O
.	O
tion	O
.	O
often	O
it	O
is	O
necessary	O
ﬁrst	O
to	O
compute	O
a	O
metric	B
reconstruction	I
from	O
the	O
projective	B
one	O
,	O
using	O
the	O
methods	O
described	O
in	O
chapter	O
10	O
and	O
chapter	O
19.	O
metric	B
reconstruction	I
and	O
virtual	O
model	B
generation	O
is	O
illustrated	O
in	O
the	O
following	O
examples	B
.	O
example	O
18.3.	O
corridor	O
sequence	O
a	O
camera	B
is	O
mounted	O
on	O
a	O
mobile	O
vehicle	O
for	O
this	O
sequence	O
.	O
the	O
vehicle	O
moves	O
along	O
the	O
ﬂoor	O
turning	O
to	O
the	O
left	O
.	O
the	O
forward	O
translation	O
in	O
this	O
sequence	O
makes	O
structure	B
recovery	O
difﬁcult	O
,	O
due	O
to	O
the	O
small	O
baseline	O
for	O
triangulation	O
.	O
in	O
this	O
situation	O
,	O
the	O
ben-	O
eﬁt	O
of	O
using	O
all	O
frames	O
in	O
the	O
sequence	O
is	O
signiﬁcant	O
.	O
figure	O
18.3	O
shows	O
the	O
recovered	O
(	O
cid:2	O
)	O
structure	B
.	O
18.6	O
reconstruction	B
from	O
sequences	O
455	O
fig	O
.	O
18.4.	O
wilshire	O
:	O
3d	O
points	O
and	O
cameras	B
for	O
350	O
frames	O
of	O
a	O
helicopter	O
shot	O
.	O
cameras	B
are	O
shown	O
for	O
just	O
the	O
start	O
and	O
end	O
frames	O
for	O
clarity	O
,	O
with	O
the	O
camera	B
path	O
plotted	O
between	O
.	O
example	O
18.4	O
.	O
“	O
wilshire	O
”	O
sequence	O
this	O
is	O
a	O
helicopter	O
shot	O
of	O
wilshire	O
boulevard	O
,	O
los	O
angeles	O
.	O
in	O
this	O
case	O
reconstruc-	O
tion	O
is	O
hampered	O
by	O
the	O
repeated	O
structure	B
in	O
the	O
scene	O
–	O
many	O
of	O
the	O
feature	O
points	O
(	O
for	O
example	O
those	O
on	O
the	O
skyscraper	O
windows	O
)	O
have	O
very	O
similar	O
intensity	O
neighbour-	O
hoods	O
,	O
so	O
correlation-based	O
tracking	O
produces	O
many	O
false	O
candidates	O
.	O
however	O
,	O
the	O
robust	B
geometry-guided	O
matching	B
successfully	O
rejects	O
the	O
incorrect	O
correspondences	B
.	O
(	O
cid:2	O
)	O
figure	O
18.4	O
shows	O
the	O
structure	B
.	O
456	O
18	O
n-view	O
computational	O
methods	O
18.7	O
closure	O
it	O
is	O
probably	O
fair	O
to	O
say	O
that	O
no	O
fully	O
satisfactory	O
technique	O
for	O
reconstruction	O
from	O
a	O
sequence	O
of	O
projective	O
images	O
is	O
known	O
,	O
and	O
many	O
ad-hoc	O
techniques	O
have	O
been	O
used	O
,	O
with	O
reasonable	O
success	O
.	O
four	O
views	O
is	O
the	O
limit	O
for	O
the	O
closed-form	O
solutions	O
based	O
on	O
multiview	O
tensors	O
.	O
for	O
larger	O
numbers	O
of	O
views	O
there	O
is	O
no	O
such	O
neat	O
mathematical	O
formulation	O
of	O
the	O
problem	O
.	O
one	O
exception	O
to	O
this	O
is	O
the	O
m-view	O
technique	O
based	O
on	O
duality	O
(	O
see	O
chapter	O
20	O
)	O
,	O
but	O
this	O
techniques	O
is	O
limited	O
to	O
six	O
to	O
eight	O
points	O
,	O
depending	O
on	O
which	O
dual	B
tensor	O
(	O
fundamental	B
matrix	I
,	O
trifocal	B
tensor	I
or	O
quadrifocal	B
tensor	I
)	O
is	O
used	O
.	O
most	O
sequences	O
will	O
contain	O
many	O
more	O
matched	O
points	O
than	O
this	O
.	O
18.7.1	O
literature	O
the	O
tomasi–kanade	O
algorithm	B
was	O
ﬁrst	O
proposed	O
for	O
orthographic	O
projection	B
,	O
[	O
tomasi-92	O
]	O
,	O
but	O
was	O
later	O
extended	O
to	O
paraperspective	O
[	O
poelman-94	O
]	O
.	O
it	O
has	O
been	O
ex-	O
tended	O
to	O
lines	O
and	O
conics	O
,	O
e.g	O
.	O
[	O
kahl-98a	O
]	O
,	O
but	O
the	O
mle	O
property	O
no	O
longer	O
applies	O
,	O
and	O
it	O
is	O
unclear	O
what	B
is	I
being	I
minimized	I
in	O
the	O
afﬁne	B
reconstruction	I
.	O
others	O
have	O
in-	O
vestigated	O
subspace	O
methods	O
for	O
multiple	O
afﬁne	B
views	O
in	O
the	O
case	O
of	O
planes	O
[	O
irani-99	O
]	O
,	O
and	O
the	O
case	O
of	O
multiple	O
objects	O
moving	B
independently	O
[	O
boult-91	O
,	O
gear-98	O
]	O
.	O
non-rigid	B
factorization	I
was	O
formulated	O
by	O
[	O
brand-01	O
,	O
torresani-01	O
]	O
,	O
though	O
the	O
elements	O
of	O
the	O
idea	O
are	O
present	O
in	O
[	O
bascle-98	O
]	O
.	O
afﬁne	B
reconstruction	I
with	O
uncertainty	O
(	O
covariance-	O
weighted	B
data	O
)	O
has	O
been	O
discussed	O
by	O
irani	O
and	O
anandan	O
[	O
irani-00	O
,	O
anandan-02	O
]	O
the	O
method	O
of	O
afﬁne	O
reconstruction	B
by	O
alternating	O
triangulation	B
and	O
camera	B
estimation	O
is	O
mentioned	O
in	O
[	O
huynh-03	O
]	O
,	O
under	O
the	O
name	O
“	O
powerfactorization.	O
”	O
the	O
extension	O
of	O
factorization	O
to	O
projective	O
cameras	B
is	O
due	O
to	O
sturm	O
and	O
triggs	O
[	O
sturm-96	O
]	O
.	O
methods	O
of	O
iteration	O
using	O
this	O
approach	O
have	O
been	O
proposed	O
by	O
[	O
heyden-97a	O
,	O
triggs-96	O
]	O
.	O
a	O
method	O
of	O
computing	O
multiple	O
cameras	B
based	O
on	O
a	O
plane	O
homography	B
was	O
em-	O
ployed	O
in	O
[	O
cross-99	O
]	O
,	O
initializing	O
the	O
ti	O
vectors	O
using	O
planar	O
auto-calibration	B
.	O
methods	O
for	O
obtaining	O
an	O
initial	O
projective	O
reconstruction	B
from	O
a	O
sequence	O
are	O
described	O
in	O
[	O
avidan-98	O
,	O
beardsley-94	O
,	O
beardsley-96	O
,	O
fitzgibbon-98a	O
,	O
laveau-96a	O
,	O
nister-00	O
,	O
sturm-97b	O
]	O
.	O
[	O
torr-99	O
]	O
,	O
and	O
more	O
recently	O
[	O
pollefeys-02	O
]	O
,	O
discuss	O
the	O
im-	O
portant	O
problem	O
of	O
scene	O
and	O
motion	O
degeneracies	B
that	O
may	O
be	O
encounted	O
in	O
sequence	O
reconstruction	B
.	O
18.7.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
the	O
afﬁne	B
factorization	O
algorithm	B
can	O
be	O
applied	O
to	O
obtain	O
a	O
reconstruction	B
in	O
situations	O
where	O
a	O
set	O
of	O
cameras	O
{	O
pi	O
}	O
have	O
a	O
common	O
third	O
row	O
,	O
even	O
though	O
the	O
cameras	B
are	O
not	O
afﬁne	B
.	O
the	O
third	O
row	O
is	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
(	O
see	O
section	O
6.2	O
(	O
p158	O
)	O
)	O
and	O
the	O
condition	O
of	O
a	O
common	O
third	O
row	O
is	O
equivalent	B
to	O
coplanar	O
principal	O
planes	O
.	O
for	O
example	O
if	O
a	O
camera	B
translates	O
in	O
a	O
direction	O
perpendicular	O
to	O
its	O
principal	O
axis	O
,	O
then	O
all	O
the	O
camera	B
centres	O
will	O
lie	O
on	O
a	O
plane	O
,	O
and	O
the	O
principal	O
planes	O
are	O
coplanar	O
.	O
the	O
afﬁne	B
factorization	O
algorithm	B
can	O
be	O
applied	O
in	O
this	O
case	O
because	O
the	O
set	O
of	O
cameras	O
can	O
be	O
transformed	O
as	O
pih4×4	O
to	O
18.7	O
closure	O
457	O
the	O
afﬁne	B
form	O
by	O
a	O
4×	O
4	O
homography	B
h	O
satisfying	O
p3h4×4	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
,	O
where	O
p3	O
is	O
the	O
last	O
row	O
of	O
pi	O
.	O
more	O
generally	O
,	O
if	O
the	O
camera	B
centres	O
are	O
restricted	O
to	O
a	O
plane	B
then	O
the	O
images	O
may	O
be	O
synthetically	O
rotated	O
such	O
that	O
the	O
cameras	B
effectively	O
have	O
coplanar	O
principal	O
planes	O
.	O
for	O
example	O
in	O
the	O
case	O
of	O
planar	O
motion	O
(	O
section	O
19.8	O
)	O
or	O
single	O
axis	O
rotation	B
(	O
section	O
19.9	O
(	O
p490	O
)	O
)	O
if	O
all	O
the	O
images	O
are	O
rotated	O
such	O
that	O
the	O
principal	O
axis	O
is	O
parallel	B
to	O
the	O
rotation	B
axis	O
(	O
by	O
applying	O
a	O
homography	B
to	O
each	O
image	O
which	O
maps	O
the	O
horizon	O
to	O
inﬁnity	O
in	O
the	O
case	O
of	O
a	O
vertical	O
rotation	B
axis	O
)	O
,	O
then	O
the	O
principal	O
planes	O
of	O
all	O
the	O
cameras	B
are	O
parallel	B
.	O
however	O
,	O
if	O
the	O
cameras	B
are	O
not	O
actually	O
afﬁne	B
,	O
then	O
the	O
algorithm	B
will	O
not	O
give	O
the	O
ml	O
estimate	O
of	O
the	O
reconstruction	O
.	O
19	O
auto-calibration	B
auto-calibration	O
is	O
the	O
process	O
of	O
determining	O
internal	B
camera	O
parameters	B
directly	O
from	O
multiple	O
uncalibrated	O
images	O
.	O
once	O
this	O
is	O
done	O
,	O
it	O
is	O
possible	O
to	O
compute	O
a	O
metric	B
re-	O
construction	O
from	O
the	O
images	O
.	O
auto-calibration	B
avoids	O
the	O
onerous	O
task	O
of	O
calibrating	O
cameras	B
using	O
special	O
calibration	O
objects	O
.	O
this	O
gives	O
great	O
ﬂexibility	O
since	O
,	O
for	O
ex-	O
ample	O
,	O
a	O
camera	B
can	O
be	O
calibrated	B
directly	O
from	O
an	O
image	O
sequence	O
despite	O
unknown	O
motion	O
and	O
changes	O
in	O
some	O
of	O
the	O
internal	O
parameters	B
.	O
the	O
root	O
of	O
the	O
method	O
is	O
that	O
a	O
camera	B
moves	O
rigidly	O
,	O
so	O
the	O
absolute	O
conic	O
is	O
ﬁxed	O
under	O
the	O
motion	O
.	O
conversely	O
,	O
then	O
,	O
if	O
a	O
unique	O
ﬁxed	O
conic	O
in	O
3-space	O
can	O
be	O
deter-	O
mined	O
in	O
some	O
way	O
from	O
the	O
images	O
,	O
this	O
identiﬁes	O
ω∞	O
.	O
as	O
we	O
have	O
seen	O
in	O
earlier	O
chapters	O
,	O
once	O
ω∞	O
is	O
identiﬁed	O
,	O
the	O
metric	B
geometry	O
can	O
be	O
computed	O
.	O
an	O
array	O
of	B
auto-calibration	I
methods	O
are	O
available	O
for	O
this	O
task	O
of	O
identifying	O
ω∞	O
.	O
this	O
chapter	O
has	O
four	O
main	O
parts	O
.	O
first	O
we	O
lay	O
out	O
the	O
algebraic	B
structure	O
of	O
the	O
auto-	O
calibration	B
problem	O
,	O
and	O
show	O
how	O
the	O
auto-calibration	B
equations	O
are	O
generated	O
from	O
constraints	O
on	O
the	O
internal	B
or	O
external	O
parameters	B
.	O
second	O
,	O
we	O
describe	O
several	O
direct	O
methods	O
for	O
auto-calibration	O
which	O
involve	O
computing	B
the	O
absolute	O
conic	O
or	O
its	O
image	O
.	O
these	O
include	O
estimating	B
the	O
absolute	B
dual	I
quadric	I
over	O
many	O
views	O
,	O
or	O
the	O
kruppa	O
equations	O
from	O
view	O
pairs	O
.	O
third	O
,	O
are	O
stratiﬁed	O
methods	O
for	O
auto-calibration	O
which	O
involve	O
two	O
steps	O
–	O
ﬁrst	O
solving	O
for	O
the	O
plane	O
at	O
inﬁnity	O
,	O
then	O
using	O
this	O
to	O
solve	O
for	O
the	O
absolute	O
conic	O
.	O
the	O
fourth	O
part	O
covers	O
a	O
number	O
of	O
special	O
conﬁgurations	O
including	O
a	O
camera	B
rotating	O
about	O
its	O
centre	B
,	O
a	O
camera	B
undergoing	O
planar	B
motion	I
,	O
and	O
the	O
motion	O
of	B
a	I
stereo	I
rig	I
.	O
19.1	O
introduction	O
auto-	O
(	O
or	O
self-	O
)	O
calibration	B
is	O
the	O
computation	B
of	I
metric	O
properties	B
of	O
the	O
cameras	B
and/or	O
the	O
scene	O
from	O
a	O
set	O
of	O
uncalibrated	O
images	O
.	O
this	O
differs	O
from	O
conventional	O
calibration	B
where	O
the	O
camera	B
calibration	I
matrix	O
k	O
is	O
determined	O
from	O
the	O
image	O
of	O
a	O
known	O
calibration	O
grid	O
(	O
chapter	O
7	O
)	O
or	O
properties	B
of	O
the	O
scene	O
,	O
such	O
as	O
vanishing	O
points	O
of	O
orthogonal	B
directions	O
(	O
chapter	O
8	O
)	O
.	O
instead	O
,	O
in	O
auto-calibration	O
the	O
metric	B
properties	I
are	O
determined	O
directly	O
from	O
constraints	O
on	O
the	O
internal	B
and/or	O
external	O
parameters	B
.	O
for	O
example	O
,	O
suppose	O
we	O
have	O
a	O
set	O
of	O
images	O
acquired	O
by	O
a	O
camera	B
with	O
ﬁxed	O
internal	O
parameters	B
,	O
and	O
that	O
a	O
projective	B
reconstruction	I
is	O
computed	O
from	O
point	O
cor-	O
458	O
19.2	O
algebraic	B
framework	O
and	O
problem	O
statement	O
459	O
respondences	O
across	O
the	O
image	O
set	O
.	O
the	O
reconstruction	B
computes	O
a	O
projective	B
camera	I
matrix	O
pi	O
for	O
each	O
view	O
.	O
our	O
constraint	O
is	O
that	O
for	O
the	O
actual	O
cameras	B
the	O
internal	B
pa-	O
rameter	O
matrix	B
k	O
is	O
the	O
same	O
(	O
but	O
unknown	O
)	O
for	O
each	O
view	O
.	O
now	O
,	O
each	O
camera	B
pi	O
of	O
the	O
projective	O
reconstruction	B
may	O
be	O
decomposed	O
as	O
pi	O
=	O
ki	O
[	O
ri	O
|	O
ti	O
]	O
but	O
in	O
general	O
the	O
calibration	B
matrix	I
ki	O
will	O
differ	O
for	O
each	O
view	O
.	O
thus	O
the	O
constraint	O
will	O
not	O
be	O
satisﬁed	O
by	O
the	O
projective	B
reconstruction	I
.	O
however	O
,	O
we	O
have	O
the	O
freedom	O
to	O
vary	O
our	O
projective	B
reconstruction	I
by	O
transforming	O
the	O
camera	B
matrices	I
by	O
a	O
homography	B
h.	O
since	O
the	O
actual	O
cameras	B
have	O
ﬁxed	O
internal	O
parameters	B
,	O
there	O
will	O
exist	O
a	O
homography	B
(	O
or	O
a	O
family	O
of	O
homographies	O
)	O
such	O
that	O
the	O
transformed	O
cameras	B
pih	O
do	O
decompose	O
as	O
pih	O
=	O
kri	O
[	O
i	O
|	O
ti	O
]	O
,	O
with	O
the	O
same	O
calibration	O
matrix	B
for	O
each	O
camera	B
,	O
so	O
the	O
reconstruction	B
is	O
consistent	O
with	O
the	O
constraint	O
.	O
pro-	O
vided	O
there	O
are	O
sufﬁciently	O
many	O
views	O
and	O
the	O
motion	O
between	O
the	O
views	O
is	O
general	O
(	O
see	O
later	O
)	O
,	O
then	O
this	O
consistency	O
constrains	O
h	O
to	O
the	O
extent	O
that	O
the	O
reconstruction	B
trans-	O
formed	O
by	O
h	O
is	O
within	O
a	O
similarity	B
transformation	I
of	O
the	O
actual	O
cameras	B
and	O
scene	O
,	O
i.e	O
.	O
we	O
achieve	O
a	O
metric	B
reconstruction	I
.	O
although	O
the	O
particular	O
constraints	B
used	O
to	O
achieve	O
a	O
metric	B
reconstruction	I
may	O
dif-	O
fer	O
,	O
this	O
example	O
illustrates	O
the	O
general	O
approach	O
:	O
(	O
i	O
)	O
obtain	O
a	O
projective	B
reconstruction	I
{	O
pi	O
,	O
xj	O
}	O
.	O
(	O
ii	O
)	O
determine	O
a	O
rectifying	B
homography	I
h	O
from	O
auto-calibration	O
constraints	B
,	O
and	O
transform	O
to	O
a	O
metric	B
reconstruction	I
{	O
pih	O
,	O
h−1xj	O
}	O
.	O
various	O
ﬂavours	O
of	B
auto-calibration	I
will	O
be	O
covered	O
in	O
the	O
following	O
sections	O
.	O
they	O
differ	O
in	O
the	O
constraints	B
used	O
,	O
and	O
the	O
methods	O
whereby	O
the	O
homography	B
h	O
is	O
deter-	O
mined	O
.	O
the	O
methods	O
may	O
be	O
divided	O
into	O
two	O
classes	O
:	O
those	O
that	O
directly	O
determine	O
h	O
;	O
and	O
those	O
that	O
are	O
stratiﬁed	O
,	O
determining	B
ﬁrst	O
the	O
projective	B
and	O
then	O
the	O
afﬁne	B
compo-	O
nents	O
of	O
h.	O
the	O
advantage	O
of	O
the	O
latter	O
approach	O
is	O
that	O
once	O
an	O
afﬁne	B
reconstruction	I
is	O
achieved	O
,	O
i.e	O
.	O
π∞	O
is	O
known	O
,	O
the	O
solution	B
for	O
a	O
metric	B
reconstruction	I
is	O
linear	B
.	O
if	O
camera	B
calibration	I
rather	O
than	O
metric	B
scene	O
reconstruction	B
is	O
the	O
goal	O
,	O
then	O
it	O
is	O
not	O
always	O
necessary	O
to	O
compute	O
an	O
explicit	O
projective	B
reconstruction	I
,	O
and	O
sometimes	O
the	O
camera	B
calibration	I
may	O
be	O
computed	O
more	O
directly	O
than	O
via	O
a	O
rectifying	O
transformation	O
.	O
this	O
is	O
the	O
case	O
,	O
for	O
instance	O
,	O
if	O
a	O
camera	B
rotates	O
about	O
its	O
centre	B
without	O
translation	O
,	O
as	O
is	O
discussed	O
in	O
section	O
19.6	O
.	O
19.2	O
algebraic	B
framework	O
and	O
problem	O
statement	O
suppose	O
we	O
have	O
a	O
projective	B
reconstruction	I
{	O
pi	O
,	O
xj	O
}	O
;	O
then	O
based	O
on	O
constraints	O
on	O
the	O
cameras	B
’	O
internal	B
parameters	I
or	O
motion	O
we	O
wish	O
to	O
determine	O
a	O
rectifying	B
homography	I
h	O
such	O
that	O
{	O
pih	O
,	O
h−1xj	O
}	O
is	O
a	O
metric	B
reconstruction	I
.	O
we	O
start	O
from	O
the	O
true	O
metric	B
situation	O
with	O
calibrated	O
cameras	B
,	O
and	O
structure	B
repre-	O
sented	O
in	O
a	O
euclidean	O
world	O
frame	O
.	O
thus	O
in	O
actuality	O
there	O
are	O
m	O
cameras	B
pi	O
m	O
which	O
project	O
a	O
3d	O
point	B
xm	O
to	O
an	O
image	O
point	O
xi	O
=	O
pi	O
mxm	O
in	O
each	O
view	O
,	O
where	O
the	O
subscript	O
m	O
indicates	O
that	O
the	O
cameras	B
are	O
calibrated	B
and	O
the	O
world	O
frame	O
is	O
euclidean	O
.	O
the	O
cameras	B
may	O
be	O
written	O
as	O
pi	O
m	O
=	O
ki	O
[	O
ri	O
|	O
ti	O
]	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m.	O
460	O
19	O
auto-calibration	B
in	O
a	O
projective	B
reconstruction	I
we	O
obtain	O
cameras	B
pi	O
which	O
are	O
related	O
to	O
pi	O
m	O
by	O
pi	O
m	O
=	O
pih	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
(	O
19.1	O
)	O
where	O
h	O
is	O
an	O
unknown	O
4	O
×	O
4	O
homography	B
of	O
3-space	O
.	O
our	O
goal	O
is	O
to	O
determine	O
h.	O
to	O
be	O
precise	O
we	O
are	O
not	O
concerned	O
with	O
the	O
absolute	O
rotation	O
,	O
translation	O
and	O
scale	O
of	O
the	O
reconstruction	O
,	O
and	O
we	O
will	O
now	O
factor	O
out	O
this	O
similarity	B
component	O
.	O
we	O
choose	O
the	O
world	O
frame	O
to	O
coincide	O
with	O
the	O
ﬁrst	O
camera	B
,	O
so	O
that	O
r1	O
=	O
i	O
and	O
t1	O
=	O
0.	O
then	O
ri	O
,	O
ti	O
speciﬁes	O
the	O
euclidean	O
transformation	O
between	O
the	O
i-th	O
camera	B
and	O
the	O
ﬁrst	O
,	O
and	O
p1	O
m	O
=	O
k1	O
[	O
i	O
|	O
0	O
]	O
.	O
similarly	O
,	O
in	O
the	O
projective	B
reconstruction	I
we	O
choose	O
the	O
usual	O
canonical	O
camera	O
for	O
the	O
ﬁrst	O
view	O
,	O
so	O
that	O
p1	O
=	O
[	O
i	O
|	O
0	O
]	O
.	O
then	O
writing	O
h	O
as	O
m	O
=	O
p1h	O
from	O
(	O
19.1	O
)	O
becomes	O
[	O
k1	O
|	O
0	O
]	O
=	O
[	O
i	O
|	O
0	O
]	O
h	O
,	O
which	O
implies	O
that	O
the	O
condition	O
p1	O
a	O
=	O
k1	O
and	O
t	O
=	O
0.	O
in	O
addition	O
,	O
since	O
h	O
is	O
non-singular	O
,	O
k	O
must	O
be	O
non-zero	O
,	O
so	O
we	O
may	O
assume	O
k	O
=	O
1	O
(	O
this	O
ﬁxes	O
the	O
scale	O
of	O
the	O
reconstruction	O
)	O
.	O
this	O
shows	O
that	O
h	O
is	O
of	O
the	O
form	O
(	O
cid:17	O
)	O
(	O
cid:17	O
)	O
h	O
=	O
t	O
a	O
vt	O
k	O
h	O
=	O
k1	O
0	O
vt	O
1	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
.	O
this	O
has	O
factored	O
out	O
the	O
similarity	B
component	O
.	O
the	O
vector	O
v	O
,	O
together	O
with	O
k1	O
,	O
speciﬁes	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
projective	B
recon-	O
struction	O
since	O
the	O
coordinates	B
of	O
π∞	O
are	O
(	O
cid:17	O
)	O
	O
=	O
	O
0	O
0	O
0	O
1	O
π∞	O
=	O
h−t	O
−t	O
−	O
(	O
k1	O
)	O
1	O
(	O
k1	O
)	O
0	O
−tv	O
	O
=	O
(	O
cid:18	O
)	O
	O
0	O
0	O
0	O
1	O
(	O
cid:20	O
)	O
−	O
(	O
k1	O
)	O
−tv	O
1	O
(	O
cid:21	O
)	O
.	O
we	O
will	O
write	O
π∞	O
=	O
(	O
pt	O
,	O
1	O
)	O
t	O
so	O
that	O
p	O
=	O
−	O
(	O
k1	O
)	O
shown	O
:	O
result	O
19.1.	O
a	O
projective	B
reconstruction	I
{	O
pi	O
,	O
xj	O
}	O
in	O
which	O
p1	O
=	O
[	O
i	O
|	O
0	O
]	O
can	O
be	O
trans-	O
formed	O
to	O
a	O
metric	B
reconstruction	I
{	O
pih	O
,	O
h−1xj	O
}	O
by	O
a	O
matrix	B
h	O
of	O
the	O
form	O
−tv	O
.	O
to	O
summarize	O
so	O
far	O
we	O
have	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
h	O
=	O
k	O
0	O
−ptk	O
1	O
(	O
19.2	O
)	O
where	O
k	O
is	O
an	O
upper	O
triangular	O
matrix	B
.	O
furthermore	O
,	O
(	O
i	O
)	O
k	O
=	O
k1	O
is	O
the	O
calibration	B
matrix	I
of	O
the	O
ﬁrst	O
camera	B
.	O
(	O
ii	O
)	O
the	O
coordinates	B
of	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
projective	B
reconstruction	I
are	O
given	O
by	O
π∞	O
=	O
(	O
pt	O
,	O
1	O
)	O
t.	O
conversely	O
,	O
if	O
the	O
plane	O
at	O
inﬁnity	O
in	O
the	O
projective	B
frame	O
and	O
the	O
calibration	B
matrix	I
of	O
the	O
ﬁrst	O
camera	B
are	O
known	O
,	O
then	O
the	O
transformation	B
h	O
that	O
converts	O
the	O
projective	B
to	O
a	O
metric	B
reconstruction	I
is	O
given	O
by	O
(	O
19.2	O
)	O
.	O
19.2	O
algebraic	B
framework	O
and	O
problem	O
statement	O
461	O
from	O
this	O
result	O
it	O
follows	O
that	O
to	O
transform	O
a	O
projective	B
to	O
a	O
metric	B
reconstruction	I
it	O
is	O
sufﬁcient	O
to	O
specify	O
8	O
parameters	B
–	O
the	O
three	O
entries	O
of	O
p	O
and	O
ﬁve	O
entries	O
of	O
k1	O
.	O
this	O
agrees	O
with	O
a	O
geometric	B
counting	O
argument	O
.	O
finding	O
metric	B
structure	I
is	O
equivalent	B
to	O
specifying	O
the	O
plane	O
at	O
inﬁnity	O
and	O
the	O
absolute	O
conic	O
(	O
three	O
and	O
ﬁve	O
degrees	B
of	I
freedom	I
respectively	O
)	O
.	O
in	O
a	O
metric	B
reconstruction	I
the	O
calibration	B
ki	O
of	O
each	O
camera	B
,	O
its	O
rotation	B
ri	O
relative	O
to	O
the	O
ﬁrst	O
camera	B
,	O
and	O
its	O
translation	O
ti	O
relative	O
to	O
the	O
ﬁrst	O
camera	B
up	O
to	O
a	O
single	O
common	O
scaling	B
,	O
i.e	O
.	O
ti	O
(	O
cid:6	O
)	O
→	O
sti	O
,	O
are	O
all	O
determined	O
.	O
we	O
now	O
develop	O
the	O
basic	O
auto-calibration	O
equations	O
.	O
we	O
denote	O
the	O
cameras	B
of	O
the	O
projective	B
reconstruction	I
as	O
pi	O
=	O
[	O
ai	O
|	O
ai	O
]	O
.	O
multiplying	O
out	O
(	O
19.1	O
)	O
using	O
(	O
19.2	O
)	O
gives	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
kiri	O
=	O
(	O
cid:15	O
)	O
k1	O
ai	O
−	O
aipt	O
which	O
may	O
be	O
rearranged	O
as	O
ri	O
=	O
(	O
ki	O
)	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
rotation	B
ri	O
may	O
be	O
eliminated	O
using	O
rrt	O
=	O
i	O
,	O
leaving	O
ai	O
−	O
aipt	O
−1	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
ai	O
−	O
aipt	O
(	O
cid:16	O
)	O
t	O
ai	O
−	O
aipt	O
for	O
i	O
=	O
2	O
,	O
.	O
.	O
.	O
,	O
m	O
(	O
19.3	O
)	O
k1	O
i	O
=	O
2	O
,	O
.	O
.	O
.	O
,	O
m.	O
finally	O
,	O
the	O
kikit	O
=	O
note	O
now	O
that	O
kikit	O
=	O
ω∗	O
(	O
8.11–p210	O
)	O
.	O
making	O
this	O
substitution	O
gives	O
the	O
basic	O
equations	O
for	O
auto-calibration	O
:	O
,	O
the	O
dual	B
image	I
of	I
the	I
absolute	I
conic	I
(	O
or	O
diac	O
)	O
–	O
see	O
k1k1t	O
.	O
(	O
cid:15	O
)	O
(	O
cid:15	O
)	O
ai	O
−	O
aipt	O
ai	O
−	O
aipt	O
(	O
cid:16	O
)	O
(	O
cid:16	O
)	O
−t	O
ω∗1	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
t	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
ai	O
−	O
aipt	O
ai	O
−	O
aipt	O
ω1	O
−1	O
ω∗i	O
=	O
ωi	O
=	O
(	O
19.4	O
)	O
the	O
second	O
equation	O
being	O
simply	O
the	O
inverse	O
of	O
the	O
ﬁrst	O
,	O
with	O
ω	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
(	O
or	O
iac	O
)	O
.	O
these	O
equations	O
relate	O
the	O
unknown	O
entries	O
of	O
ω∗i	O
or	O
ωi	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
and	O
unknown	O
parameters	B
p	O
with	O
the	O
known	O
entries	O
of	O
the	O
projective	O
cameras	B
ai	O
,	O
ai	O
.	O
the	O
art	O
of	B
auto-calibration	I
is	O
to	O
use	O
constraints	B
on	O
the	O
ki	O
,	O
such	O
as	O
that	O
one	O
of	O
the	O
elements	O
of	O
ki	O
is	O
zero	O
,	O
to	O
generate	O
equations	O
on	O
the	O
eight	O
parameters	B
of	O
p	O
and	O
k1	O
from	O
(	O
19.4	O
)	O
.	O
all	O
auto-calibration	B
methods	O
are	O
variations	O
on	O
solving	O
these	O
equations	O
,	O
and	O
in	O
the	O
following	O
sections	O
we	O
describe	O
several	O
of	O
these	O
methods	O
.	O
generally	O
meth-	O
ods	O
proceed	O
by	O
computing	B
ωi	O
or	O
ω∗i	O
ﬁrst	O
and	O
extracting	O
the	O
values	O
of	O
the	O
calibra-	O
tion	O
matrices	O
ki	O
from	O
these	O
–	O
though	O
iterative	B
methods	I
(	O
such	O
as	O
bundle	O
adjustment	O
)	O
may	O
be	O
parametrized	O
by	O
ki	O
directly	O
.	O
the	O
equations	O
(	O
19.4	O
)	O
have	O
a	O
geometric	B
interpreta-	O
tion	O
as	O
mappings	O
on	O
the	O
absolute	O
conic	O
,	O
and	O
we	O
will	O
return	O
to	O
this	O
in	O
section	O
19.3	O
and	O
section	O
19.5.2.	O
we	O
start	O
with	O
a	O
simple	O
example	O
to	O
illustrate	O
how	O
equations	O
on	O
the	O
eight	O
parameters	B
are	O
generated	O
from	O
(	O
19.4	O
)	O
.	O
example	O
19.2.	O
auto-calibration	B
equations	O
for	O
identical	O
ki	O
suppose	O
that	O
all	O
the	O
cameras	B
have	O
the	O
same	O
internal	O
parameters	B
,	O
so	O
ki	O
=	O
k	O
,	O
then	O
(	O
19.4	O
)	O
becomes	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
t	O
kkt	O
=	O
ai	O
−	O
aipt	O
kkt	O
ai	O
−	O
aipt	O
i	O
=	O
2	O
,	O
.	O
.	O
.	O
,	O
m.	O
(	O
19.5	O
)	O
each	O
view	O
i	O
=	O
2	O
,	O
.	O
.	O
.	O
,	O
m	O
provides	O
an	O
equation	O
,	O
and	O
we	O
can	O
develop	O
a	O
counting	B
argument	I
462	O
19	O
auto-calibration	B
for	O
the	O
number	O
of	O
views	O
required	O
(	O
in	O
principle	O
)	O
in	O
order	O
to	O
be	O
able	O
to	O
determine	O
the	O
8	O
unknowns	O
.	O
each	O
view	O
other	O
than	O
the	O
ﬁrst	O
imposes	O
5	O
constraints	B
since	O
each	O
side	O
is	O
a	O
3×3	O
symmetric	B
matrix	O
(	O
i.e	O
.	O
6	O
independent	O
elements	O
)	O
and	O
the	O
equation	O
is	O
homogeneous	O
.	O
assuming	O
these	O
constraints	B
are	O
independent	O
for	O
each	O
view	O
,	O
a	O
solution	B
is	O
determined	O
provided	O
5	O
(	O
m	O
−	O
1	O
)	O
≥	O
8.	O
consequently	O
,	O
provided	O
m	O
≥	O
3	O
a	O
solution	B
is	O
obtained	O
,	O
at	O
least	O
in	O
principle	O
.	O
clearly	O
,	O
if	O
m	O
is	O
much	O
larger	O
than	O
3	O
the	O
unknowns	O
k	O
and	O
p	O
are	O
very	O
(	O
cid:2	O
)	O
over-determined	B
.	O
one	O
could	O
imagine	O
using	O
(	O
19.5	O
)	O
as	O
a	O
basis	O
for	O
a	O
direct	O
estimation	B
of	I
the	O
rectifying	O
transformation	O
h.	O
this	O
may	O
be	O
framed	O
as	O
a	O
parametrized	O
minimization	B
problem	O
in	O
which	O
the	O
eight	O
parameters	B
of	O
(	O
19.2	O
)	O
are	O
allowed	O
to	O
vary	O
with	O
the	O
purpose	O
of	O
minimizing	O
a	O
cost	B
function	I
on	O
how	O
well	O
the	O
equations	O
(	O
19.4	O
)	O
are	O
satisﬁed	O
or	O
measuring	O
closeness	O
to	O
metric	O
structure	B
.	O
of	O
course	O
,	O
a	O
method	O
of	O
obtaining	O
an	O
initial	B
solution	I
would	O
also	O
be	O
required	O
.	O
in	O
essence	O
these	O
two	O
steps	O
,	O
initial	B
solution	I
and	O
iterative	B
minimization	I
,	O
are	O
what	O
will	O
be	O
investigated	O
in	O
the	O
following	O
sections	O
–	O
though	O
under	O
constraints	B
less	O
restrictive	O
than	O
identical	O
internal	B
parameters	I
.	O
19.3	O
calibration	B
using	O
the	O
absolute	B
dual	I
quadric	I
the	O
absolute	B
dual	I
quadric	I
,	O
q∗	O
a	O
4	O
×	O
4	O
homogeneous	O
matrix	O
of	O
rank	O
3.	O
its	O
importance	O
here	O
is	O
that	O
q∗	O
π∞	O
and	O
ω∞	O
in	O
a	O
very	O
concise	O
fashion	O
,	O
for	O
instance	O
π∞	O
is	O
the	O
null-vector	O
of	O
q∗	O
has	O
an	O
algebraically	O
simple	O
image	O
projection	B
:	O
=	O
pq∗	O
∞	O
is	O
a	O
degenerate	B
dual	O
(	O
i.e	O
.	O
plane	B
)	O
quadric	O
represented	O
by	O
∞	O
encodes	O
both	O
∞	O
,	O
and	O
it	O
(	O
19.6	O
)	O
ω∗	O
∞pt	O
the	O
idea	O
of	B
auto-calibration	I
based	O
on	O
q∗	O
to	O
a	O
constraint	O
on	O
q∗	O
which	O
is	O
simply	O
the	O
projection	B
(	O
8.5–p201	O
)	O
of	O
a	O
(	O
dual	B
)	O
quadric	O
.	O
in	O
words	O
,	O
q∗	O
the	O
dual	B
image	I
of	I
the	I
absolute	I
conic	I
ω∗	O
ω∗	O
representing	O
q∗	O
on	O
ki	O
,	O
as	O
will	O
be	O
seen	O
below	O
.	O
indeed	O
,	O
q∗	O
for	O
auto-calibration	O
in	O
[	O
triggs-97	O
]	O
.	O
∞	O
is	O
to	O
use	O
(	O
19.6	O
)	O
to	O
transfer	O
a	O
constraint	O
on	O
∞	O
via	O
the	O
(	O
known	O
)	O
camera	B
matrix	I
pi	O
.	O
in	O
this	O
manner	O
the	O
matrix	B
∞	O
may	O
be	O
determined	O
in	O
the	O
projective	B
reconstruction	I
from	O
constraints	B
∞	O
was	O
introduced	O
as	O
a	O
convenient	O
representation	B
∞	O
projects	O
to	O
=	O
kkt	O
.	O
∞	O
has	O
been	O
determined	O
,	O
then	O
the	O
rectifying	B
homography	I
(	O
19.2	O
)	O
h	O
that	O
we	O
seek	O
is	O
also	O
determined	O
as	O
shown	O
below	O
.	O
thus	O
we	O
have	O
a	O
general	O
framework	O
for	O
auto-	O
calibration	B
based	O
on	O
specifying	O
constraints	B
on	O
ki	O
to	O
determine	O
q∗	O
∞	O
de-	O
termining	O
h.	O
this	O
general	O
approach	O
is	O
summarized	O
in	O
algorithm	O
19.1.	O
in	O
section	O
19.3.1	O
we	O
will	O
concentrate	O
on	O
the	O
second	O
step	O
of	O
this	O
algorithm	B
,	O
estimation	B
of	I
q∗	O
∞	O
.	O
we	O
ﬁrst	O
ﬁll	O
in	O
some	O
details	O
.	O
∞	O
,	O
and	O
then	O
from	O
q∗	O
once	O
q∗	O
simple	B
properties	I
of	O
the	O
absolute	B
dual	I
quadric	I
.	O
section	O
3.7	O
(	O
p83	O
)	O
gives	O
a	O
full	O
de-	O
scription	O
of	O
q∗	O
∞	O
.	O
for	O
the	O
purposes	O
of	B
auto-calibration	I
particularly	O
important	O
properties	B
are	O
summarized	O
here	O
.	O
in	O
a	O
euclidean	O
frame	O
q∗	O
∞	O
has	O
the	O
canonical	B
form	I
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
˜i	O
=	O
i3×3	O
0	O
0t	O
0	O
.	O
(	O
19.7	O
)	O
19.3	O
calibration	B
using	O
the	O
absolute	B
dual	I
quadric	I
463	O
objective	O
given	O
a	O
set	O
of	O
matched	O
points	O
across	O
several	O
views	O
and	O
constraints	B
on	O
the	O
calibration	B
matrices	O
ki	O
,	O
compute	O
a	O
metric	B
reconstruction	I
of	O
the	O
points	O
and	O
cameras	B
.	O
algorithm	B
pi	O
and	O
points	O
xj	O
.	O
q∗	O
∞	O
.	O
(	O
i	O
)	O
compute	O
a	O
projective	B
reconstruction	I
from	O
a	O
set	O
of	O
views	O
,	O
resulting	O
in	O
camera	O
matrices	O
(	O
ii	O
)	O
use	O
(	O
19.6	O
)	O
along	O
with	O
constraints	O
on	O
the	O
form	B
of	I
the	O
ω∗i	O
arising	O
from	O
ki	O
to	O
estimate	O
(	O
iii	O
)	O
decompose	O
q∗	O
(	O
iv	O
)	O
apply	O
h−1	O
to	O
the	O
points	O
and	O
h	O
to	O
the	O
cameras	B
to	O
get	O
a	O
metric	B
reconstruction	I
.	O
(	O
v	O
)	O
use	O
iterative	O
least-squares	O
minimization	O
to	O
improve	O
the	O
solution	B
(	O
see	O
section	O
19.3.3	O
)	O
.	O
∞	O
as	O
h˜iht	O
,	O
where	O
˜i	O
is	O
the	O
the	O
matrix	B
diag	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
0	O
)	O
.	O
alternatively	O
,	O
the	O
calibration	B
matrix	I
of	O
each	O
camera	B
may	O
be	O
computed	O
directly	O
:	O
(	O
i	O
)	O
compute	O
ω∗i	O
for	O
all	O
i	O
using	O
(	O
19.6	O
)	O
.	O
(	O
ii	O
)	O
compute	O
the	O
calibration	B
matrix	I
ki	O
from	O
the	O
equation	O
ω∗	O
=	O
kkt	O
by	O
cholesky	O
factoriza-	O
tion	O
.	O
algorithm	B
19.1.	O
auto-calibration	B
based	O
on	O
q∗	O
∞	O
.	O
∞	O
has	O
the	O
form	O
q∗	O
in	O
a	O
projective	B
coordinate	O
frame	O
q∗	O
∞	O
=	O
h˜iht	O
,	O
where	O
˜i	O
is	O
the	O
matrix	B
in	O
(	O
19.7	O
)	O
.	O
this	O
follows	O
from	O
the	O
projective	B
transformation	I
rule	O
(	O
3.17–p74	O
)	O
for	O
dual	O
quadrics	B
,	O
q∗	O
result	O
19.3.	O
in	O
an	O
arbitrary	O
projective	B
frame	O
,	O
the	O
dual	B
absolute	I
quadric	I
is	O
represented	O
by	O
a	O
symmetric	B
4	O
×	O
4	O
matrix	B
with	O
the	O
following	O
properties	B
.	O
∞	O
(	O
cid:6	O
)	O
→	O
hq∗	O
∞ht	O
.	O
consequently	O
:	O
(	O
i	O
)	O
it	O
is	O
singular	O
of	O
rank	O
3	O
,	O
since	O
q∗	O
(	O
ii	O
)	O
its	O
null	O
space	O
is	O
the	O
vector	O
representing	O
the	O
plane	O
at	O
inﬁnity	O
,	O
since	O
q∗	O
∞π∞	O
=	O
0	O
.	O
(	O
iii	O
)	O
it	O
is	O
positive	O
semi-deﬁnite	O
(	O
or	O
negative	O
–	O
depending	O
on	O
the	O
homogeneous	O
scale	O
)	O
.	O
∞	O
is	O
a	O
degenerate	B
conic	O
.	O
∞	O
in	O
its	O
canonical	B
form	I
in	O
a	O
euclidean	O
frame	O
,	O
and	O
these	O
properties	B
are	O
immediate	O
for	O
q∗	O
easily	O
extend	O
to	O
an	O
arbitrary	O
frame	O
.	O
extracting	O
the	O
rectifying	O
homography	O
from	O
q∗	O
∞	O
in	O
a	O
pro-	O
jective	O
coordinate	O
frame	O
we	O
wish	O
to	O
determine	O
the	O
homography	B
h.	O
extracting	O
h	O
is	O
a	O
simple	O
matter	O
of	O
decomposing	O
the	O
expression	O
as	O
follows	O
.	O
∞	O
=	O
h˜iht	O
(	O
see	O
notation	O
above	O
)	O
,	O
then	O
h−1	O
is	O
a	O
3d	O
result	O
19.4.	O
if	O
q∗	O
(	O
point	B
)	O
homography	B
that	O
takes	O
the	O
projective	B
coordinate	O
frame	O
to	O
a	O
euclidean	O
frame	O
.	O
∞	O
.	O
given	O
an	O
estimated	O
q∗	O
∞	O
is	O
decomposed	O
as	O
q∗	O
note	O
that	O
a	O
camera	B
is	O
transformed	O
by	O
the	O
inverse	O
of	O
the	O
transformation	O
applied	O
to	O
points	O
,	O
so	O
h	O
is	O
the	O
correct	O
matrix	B
to	O
apply	O
to	O
a	O
camera	B
to	O
give	O
pm	O
=	O
ph	O
.	O
thus	O
h	O
is	O
the	O
rectifying	O
transformation	O
to	O
apply	O
to	O
cameras	O
.	O
a	O
decomposition	B
of	I
q∗	O
∞	O
as	O
h˜iht	O
may	O
be	O
easily	O
computed	O
from	O
its	O
eigenvalue	O
decomposition	O
(	O
see	O
section	O
a4.2	O
(	O
p580	O
)	O
for	O
jacobi	O
’	O
s	O
al-	O
gorithm	O
for	O
this	O
)	O
.	O
equivalence	O
to	O
auto-calibration	O
equations	O
.	O
equations	O
(	O
19.6	O
)	O
which	O
describe	O
the	O
image	O
projection	O
of	O
q∗	O
∞	O
are	O
simply	O
a	O
geometric	B
representation	I
of	O
the	O
auto-calibration	B
equations	O
(	O
19.4	O
)	O
as	O
will	O
now	O
be	O
demonstrated	O
.	O
464	O
19	O
auto-calibration	B
the	O
forms	O
of	O
ω	O
=	O
(	O
kkt	O
)	O
−1	O
and	O
ω∗	O
=	O
ω−1	O
=	O
kkt	O
for	O
a	O
camera	O
with	O
calibration	O
matrix	B
k	O
as	O
in	O
(	O
6.10–p157	O
)	O
are	O
	O
α2	O
ω∗	O
=	O
x	O
+	O
s2	O
+	O
x2	O
0	O
sαy	O
+	O
x0y0	O
x0	O
sαy	O
+	O
x0y0	O
x0	O
y0	O
1	O
α2	O
y	O
+	O
y2	O
0	O
y0	O
	O
	O
and	O
ω	O
=	O
1	O
α2	O
xα2	O
y	O
−sαy	O
α2	O
−sαy	O
y	O
x	O
+	O
s2	O
α2	O
y	O
+	O
y0sαy	O
αysx0	O
−	O
α2	O
xy0	O
−	O
s2y0	O
α2	O
xα2	O
−x0α2	O
αysx0	O
−	O
α2	O
y	O
+	O
α2	O
xy2	O
y	O
+	O
y0sαy	O
xy0	O
−	O
s2y0	O
0	O
+	O
(	O
αyx0	O
−	O
sy0	O
)	O
2	O
−x0α2	O
if	O
the	O
skew	O
is	O
zero	O
,	O
i.e	O
.	O
s	O
=	O
0	O
,	O
then	O
the	O
expressions	O
simplify	O
to	O
	O
α2	O
x	O
+	O
x2	O
0	O
x0y0	O
x0y0	O
α2	O
y	O
+	O
y2	O
0	O
ω∗	O
=	O
and	O
	O
ω	O
=	O
1	O
α2	O
xα2	O
y	O
x0	O
y0	O
α2	O
y	O
0	O
α2	O
0	O
x	O
−α2	O
yx0	O
−α2	O
xy0	O
α2	O
xα2	O
y	O
+	O
α2	O
yx2	O
0	O
+	O
α2	O
xy2	O
0	O
	O
x0	O
y0	O
1	O
−α2	O
−α2	O
yx0	O
xy0	O
(	O
19.9	O
)	O
	O
(	O
19.10	O
)	O
(	O
19.11	O
)	O
(	O
19.12	O
)	O
	O
table	O
19.1.	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
,	O
ω	O
,	O
and	O
dual	B
image	I
of	I
the	I
absolute	I
conic	I
,	O
ω∗	O
terms	O
of	O
the	O
camera	O
internal	B
parameters	I
.	O
,	O
written	O
in	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
we	O
have	O
seen	O
that	O
in	O
a	O
projective	B
frame	O
q∗	O
∞	O
has	O
the	O
form	O
h˜iht	O
.	O
the	O
projective	B
recon-	O
struction	O
is	O
related	O
to	O
the	O
metric	B
reconstruction	I
by	O
(	O
19.2	O
)	O
,	O
so	O
in	O
detail	O
.	O
=	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
ω∗1	O
∞pit	O
=	O
q∗	O
∞	O
=	O
h˜iht	O
=	O
k1k1t	O
−k1k1tp	O
−ptk1k1t	O
ptk1k1tp	O
ω∗1	O
−ω∗1p	O
−ptω∗1	O
ptω∗1p	O
(	O
cid:15	O
)	O
ai	O
−	O
aipt	O
(	O
cid:16	O
)	O
t	O
(	O
19.8	O
)	O
on	O
applying	O
(	O
19.6	O
)	O
with	O
pi	O
=	O
[	O
ai	O
|	O
ai	O
]	O
we	O
obtain	O
once	O
again	O
the	O
auto-calibration	B
equa-	O
tions	O
(	O
19.4	O
)	O
ω∗i	O
=	O
piq∗	O
∞	O
is	O
a	O
ﬁxed	O
quadric	O
under	O
the	O
euclidean	O
ai	O
−	O
aipt	O
this	O
is	O
a	O
geometric	B
interpretation	I
of	O
(	O
19.4	O
)	O
–	O
q∗	O
motion	O
of	O
the	O
camera	O
,	O
and	O
the	O
diac	O
ω∗i	O
is	O
the	O
image	O
of	O
q∗	O
19.3.1	O
linear	B
solutions	O
for	O
q∗	O
the	O
objective	O
here	O
is	O
to	O
estimate	O
q∗	O
∞	O
in	O
a	O
projective	B
reconstruction	I
directly	O
from	O
con-	O
straints	O
on	O
the	O
internal	B
parameters	I
.	O
we	O
will	O
start	O
by	O
describing	O
three	O
cases	O
for	O
which	O
a	O
linear	B
solution	I
may	O
be	O
obtained	O
.	O
it	O
is	O
convenient	O
at	O
this	O
point	B
to	O
summarize	O
the	O
forms	O
of	O
the	O
diac	O
and	O
also	O
the	O
iac	O
.	O
refer	O
to	O
table	O
19.1.	O
specifying	B
linear	I
constraints	I
on	O
q∗	O
∞	O
may	O
be	O
obtained	O
if	O
the	O
principal	B
point	I
is	O
known	O
.	O
assume	O
that	O
this	O
point	B
is	O
known	O
,	O
then	O
we	O
may	O
change	O
∞	O
.	O
linear	B
constraints	O
on	O
q∗	O
∞	O
from	O
a	O
set	O
of	O
images	O
∞	O
in	O
each	O
view	O
.	O
.	O
19.3	O
calibration	B
using	O
the	O
absolute	B
dual	I
quadric	I
465	O
the	O
image	O
coordinate	O
system	O
so	O
that	O
the	O
origin	O
coincides	O
with	O
the	O
principal	B
point	I
.	O
then	O
x0	O
=	O
0	O
,	O
y0	O
=	O
0	O
,	O
and	O
from	O
table	O
19.1	O
the	O
diac	O
becomes	O
x	O
+	O
s2	O
sαy	O
0	O
sαy	O
0	O
0	O
1	O
	O
α2	O
	O
.	O
(	O
19.13	O
)	O
α2	O
y	O
0	O
ω∗	O
=	O
the	O
linear	B
equations	I
on	O
q∗	O
applying	O
the	O
projection	B
equation	O
(	O
19.6	O
)	O
ω∗	O
two	O
equations	O
∞	O
are	O
then	O
generated	O
from	O
the	O
zero	O
entries	O
in	O
(	O
19.13	O
)	O
by	O
∞pt	O
to	O
each	O
view	O
i.	O
for	O
example	O
the	O
=	O
pq∗	O
∞pit	O
)	O
23	O
=	O
0	O
∞pit	O
)	O
13	O
=	O
0	O
and	O
(	O
piq∗	O
13	O
=	O
ω∗i	O
(	O
piq∗	O
follow	O
immediately	O
from	O
ω∗i	O
if	O
there	O
are	O
additional	O
constraints	B
on	O
ki	O
which	O
result	O
in	O
further	O
relationship	O
between	O
the	O
entries	O
of	O
ω∗	O
,	O
then	O
these	O
may	O
provide	O
additional	O
linear	B
equations	I
.	O
for	O
instance	O
,	O
an	O
assumption	O
that	O
skew	O
is	O
zero	O
means	O
that	O
the	O
(	O
1,2	O
)	O
-entries	O
of	O
(	O
19.13	O
)	O
vanish	O
,	O
which	O
pro-	O
vides	O
one	O
more	O
linear	O
equation	O
on	O
the	O
entries	O
of	O
q∗	O
∞	O
similar	O
to	O
(	O
19.14	O
)	O
.	O
known	O
aspect	O
ratio	O
provides	O
a	O
further	O
constraint	O
.	O
table	O
19.2	O
summarizes	O
the	O
possible	O
constraints	B
that	O
may	O
be	O
used	O
.	O
23	O
=	O
0	O
.	O
(	O
19.14	O
)	O
condition	O
constraint	O
type	O
#	O
constraints	B
zero	O
skew	O
principal	B
point	I
(	O
p.p	O
.	O
)	O
at	O
origin	O
zero	B
skew	I
(	O
p.p	O
.	O
at	O
origin	O
)	O
33	O
=	O
ω∗	O
13ω∗	O
23	O
ω∗	O
12ω∗	O
ω∗	O
13	O
=	O
ω∗	O
ω∗	O
12	O
=	O
0	O
23	O
=	O
0	O
ﬁxed	O
(	O
unknown	O
)	O
aspect	O
ratio	O
(	O
zero	B
skew	I
and	O
p.p	O
.	O
at	O
origin	O
)	O
ω∗	O
i	O
11	O
ω∗	O
i	O
22	O
=	O
ω∗	O
j	O
11	O
ω∗	O
j	O
22	O
known	O
aspect	O
ratio	O
r	O
=	O
αy/αx	O
(	O
zero	B
skew	I
and	O
p.p	O
.	O
at	O
origin	O
)	O
r2ω∗	O
11	O
=	O
ω∗	O
22	O
quadratic	O
linear	B
linear	O
quadratic	O
m	O
2m	O
m	O
m	O
−	O
1	O
linear	B
m	O
table	O
19.2.	O
auto-calibration	B
constraints	O
derived	O
from	O
the	O
diac	O
.	O
the	O
number	O
of	O
constraints	O
column	O
gives	O
the	O
total	O
number	O
of	O
constraints	O
over	O
m	O
views	O
,	O
assuming	O
the	O
constraint	O
is	O
true	O
for	O
each	O
view	O
.	O
each	O
additional	O
item	O
of	O
information	O
generates	O
additional	O
equations	O
.	O
for	O
example	O
,	O
if	O
the	O
principal	B
point	I
is	O
known	O
and	O
skew	O
is	O
zero	O
then	O
there	O
are	O
3	O
constraints	B
per	O
view	O
.	O
linear	B
solution	I
.	O
since	O
it	O
is	O
symmetric	B
,	O
q∗	O
∞	O
may	O
be	O
parametrized	O
linearly	O
by	O
10	O
ho-	O
mogeneous	O
parameters	B
,	O
namely	O
the	O
10	O
diagonal	O
and	O
above-diagonal	O
entries	O
.	O
these	O
10	O
entries	O
may	O
be	O
represented	O
by	O
a	O
10-vector	O
x.	O
in	O
the	O
usual	O
manner	O
the	O
linear	B
equations	I
on	O
q∗	O
∞	O
may	O
be	O
assembled	O
into	O
a	O
matrix	B
equation	O
of	O
the	O
form	O
ax	O
=	O
0	O
,	O
and	O
a	O
least-squares	B
solution	I
for	O
x	O
obtained	O
via	O
the	O
svd	O
.	O
for	O
example	O
,	O
the	O
two	O
equations	O
(	O
19.14	O
)	O
provide	O
two	O
rows	O
of	O
the	O
matrix	O
from	O
each	O
view	O
.	O
from	O
ﬁve	O
images	O
a	O
total	O
of	O
10	O
equations	O
are	O
obtained	O
(	O
assuming	O
only	O
that	O
principal	B
point	I
is	O
known	O
)	O
,	O
and	O
a	O
linear	B
solution	I
is	O
pos-	O
sible	O
.	O
from	O
four	O
images	O
eight	O
equations	O
are	O
generated	O
.	O
in	O
the	O
same	O
way	O
as	O
with	O
the	O
466	O
19	O
auto-calibration	B
computation	O
of	O
the	O
fundamental	O
matrix	B
from	O
seven	O
points	O
there	O
is	O
a	O
2-parameter	O
family	O
of	O
solutions	O
.	O
the	O
condition	O
det	O
q∗	O
∞	O
=	O
0	O
gives	O
a	O
fourth-degree	O
equation	O
and	O
so	O
up	O
to	O
four	O
solutions	O
for	O
q∗	O
∞	O
.	O
example	O
19.5.	O
linear	B
solution	I
for	O
variable	O
focal	B
length	I
suppose	O
the	O
camera	B
is	O
calibrated	B
apart	O
from	O
the	O
focal	B
length	I
–	O
the	O
principal	B
point	I
is	O
known	O
,	O
the	O
aspect	O
ratio	O
is	O
unity	O
(	O
if	O
it	O
is	O
not	O
the	O
equations	O
can	O
be	O
transformed	O
so	O
that	O
it	O
is	O
unity	O
from	O
the	O
known	O
value	O
)	O
,	O
and	O
skew	O
is	O
zero	O
–	O
the	O
focal	B
length	I
is	O
unknown	O
and	O
may	O
vary	O
between	O
views	O
.	O
in	O
this	O
case	O
from	O
table	O
19.2	O
there	O
are	O
four	O
linear	O
constraints	B
on	O
q∗	O
∞	O
available	O
from	O
each	O
view	O
.	O
in	O
the	O
case	O
of	O
two	O
views	O
there	O
are	O
eight	O
linear	B
constraints	O
and	O
∞	O
=	O
0.	O
if	O
m	O
≥	O
3	O
a	O
unique	O
up	O
to	O
four	O
solutions	O
are	O
obtained	O
using	O
the	O
condition	O
det	O
q∗	O
(	O
cid:2	O
)	O
linear	B
solution	I
exists	O
.	O
more	O
will	O
be	O
said	O
about	O
determination	O
of	O
focal	O
lengths	O
in	O
this	O
minimal	O
case	O
in	O
example	O
19.8	O
.	O
19.3.2	O
non-linear	B
solutions	O
for	O
q∗	O
∞	O
we	O
now	O
describe	O
various	O
non-linear	B
equations	O
that	O
can	O
be	O
obtained	O
from	O
the	O
form	B
of	I
(	O
19.6	O
)	O
.	O
it	O
has	O
been	O
seen	O
that	O
each	O
element	O
of	O
ω∗i	O
=	O
piq∗	O
∞pit	O
is	O
expressible	O
as	O
a	O
linear	B
expression	O
in	O
terms	O
of	O
the	O
parameters	O
of	O
q∗	O
∞	O
.	O
it	O
follows	O
that	O
any	O
relationship	O
between	O
the	O
entries	O
of	O
the	O
various	O
ω∗i	O
translates	O
into	O
an	O
equation	O
involving	O
the	O
entries	O
of	O
q∗	O
∞	O
.	O
in	O
particular	O
,	O
linear	B
or	O
quadratic	O
relationships	O
between	O
entries	O
of	O
ω∗	O
generate	O
respectively	O
linear	B
or	O
quadratic	O
relationships	O
between	O
entries	O
of	O
q∗	O
∞	O
.	O
given	O
sufﬁciently	O
many	O
such	O
equations	O
,	O
we	O
may	O
solve	O
for	O
q∗	O
∞	O
.	O
constant	B
internal	I
parameters	O
.	O
if	O
the	O
internal	B
parameters	I
of	O
all	O
cameras	B
are	O
the	O
same	O
,	O
then	O
ω∗i	O
=	O
ω∗j	O
for	O
all	O
i	O
and	O
j	O
,	O
which	O
expands	O
to	O
piq∗	O
∞pj	O
t.	O
however	O
,	O
since	O
these	O
are	O
homogeneous	O
quantities	O
,	O
the	O
equality	O
holds	O
only	O
up	O
to	O
an	O
unknown	O
scale	O
.	O
a	O
set	O
of	O
ﬁve	O
equations	O
are	O
generated	O
:	O
12	O
=	O
ω∗i	O
∞pit	O
=	O
pjq∗	O
13	O
=	O
ω∗i	O
11/ω∗j	O
11	O
=	O
ω∗i	O
22/ω∗j	O
22	O
=	O
ω∗i	O
13/ω∗j	O
23/ω∗j	O
23	O
=	O
ω∗i	O
33/ω∗j	O
33.	O
ω∗i	O
12/ω∗j	O
this	O
gives	O
a	O
set	O
of	O
quadratic	O
equations	O
in	O
the	O
entries	O
of	O
q∗	O
of	O
10	O
equations	O
result	O
,	O
which	O
may	O
be	O
solved	O
to	O
ﬁnd	O
q∗	O
∞	O
.	O
∞	O
.	O
given	O
three	O
views	O
,	O
a	O
total	O
calibration	O
assuming	B
zero	I
skew	I
.	O
under	O
the	O
assumption	O
of	O
zero	O
skew	O
in	O
each	O
of	O
the	O
cameras	O
,	O
the	O
form	B
of	I
the	O
diac	O
is	O
simpliﬁed	O
,	O
as	O
given	O
in	O
(	O
19.11	O
)	O
.	O
in	O
particular	O
,	O
we	O
obtain	O
the	O
following	O
constraints	B
between	O
the	O
entries	O
of	O
ω∗	O
in	O
the	O
zero-skew	O
case	O
ω∗	O
12	O
ω∗	O
33	O
=	O
ω∗	O
13	O
ω∗	O
23	O
.	O
(	O
19.15	O
)	O
this	O
gives	O
a	O
single	O
quadratic	O
equation	O
in	O
the	O
entries	O
of	O
q∗	O
obtain	O
m	O
quadratics	O
.	O
however	O
there	O
is	O
also	O
one	O
extra	O
equation	O
det	O
q∗	O
the	O
fact	O
that	O
the	O
absolute	B
dual	I
quadric	I
is	O
degenerate	B
.	O
since	O
q∗	O
linear	B
parameters	O
,	O
it	O
may	O
be	O
computed	O
(	O
at	O
least	O
in	O
principle	O
)	O
from	O
8	O
views	O
.	O
these	O
different	O
calibration	B
constraints	I
are	O
also	O
summarized	O
in	O
table	O
19.2	O
.	O
∞	O
.	O
from	O
a	O
set	O
of	O
m	O
views	O
we	O
∞	O
=	O
0	O
derived	O
from	O
∞	O
has	O
10	O
homogeneous	O
19.3	O
calibration	B
using	O
the	O
absolute	B
dual	I
quadric	I
467	O
19.3.3	O
iterative	B
methods	I
as	O
we	O
have	O
seen	O
on	O
many	O
occasions	O
throughout	O
this	O
book	O
there	O
is	O
a	O
choice	B
between	O
minimizing	B
an	O
algebraic	B
or	O
geometric	B
error	I
.	O
in	O
this	O
case	O
a	O
suitable	O
algebraic	B
error	I
is	O
provided	O
by	O
(	O
19.4	O
)	O
in	O
previous	O
cases	O
,	O
such	O
as	O
(	O
4.1–p89	O
)	O
,	O
the	O
unknown	O
scale	O
factor	O
has	O
been	O
eliminated	O
by	O
forming	O
a	O
cross	B
product	I
.	O
here	O
the	O
scale	O
factor	O
can	O
be	O
eliminated	O
by	O
using	O
a	O
matrix	B
norm	O
.	O
the	O
cost	B
function	I
is	O
(	O
cid:7	O
)	O
(	O
cid:10	O
)	O
kikit	O
−	O
piq∗	O
∞pit	O
(	O
cid:10	O
)	O
2	O
f	O
(	O
19.16	O
)	O
i	O
where	O
(	O
cid:10	O
)	O
m	O
(	O
cid:10	O
)	O
f	O
is	O
the	O
frobenius	O
norm	B
of	O
m	O
,	O
and	O
kikit	O
and	O
piq∗	O
∞pit	O
are	O
both	O
normalized	O
to	O
have	O
unit	O
frobenius	O
norm	B
.	O
the	O
cost	B
function	I
is	O
parametrized	O
by	O
the	O
(	O
at	O
most	O
eight	O
)	O
∞	O
,	O
and	O
the	O
unknown	O
elements	O
of	O
each	O
ω∗i	O
=	O
kikit	O
.	O
it	O
is	O
possible	O
unknown	O
elements	O
of	O
q∗	O
to	O
use	O
the	O
expansion	O
(	O
19.8	O
)	O
to	O
parametrize	O
the	O
absolute	B
dual	I
quadric	I
.	O
for	O
example	O
,	O
in	O
the	O
case	O
of	O
example	O
19.5	O
where	O
the	O
focal	B
length	I
is	O
the	O
only	O
unknown	O
per	O
view	O
,	O
(	O
19.16	O
)	O
would	O
be	O
minimized	O
over	O
m+3	O
parameters	B
.	O
these	O
are	O
the	O
focal	B
length	I
f	O
i	O
of	O
each	O
view	O
,	O
and	O
the	O
three	O
components	O
of	O
p.	O
note	O
that	O
this	O
parametrization	B
ensures	O
that	O
q∗	O
∞	O
has	O
rank	O
3	O
throughout	O
the	O
minimization	B
.	O
since	O
the	O
above	O
cost	B
function	I
has	O
no	O
particular	O
geometric	B
meaning	O
,	O
it	O
is	O
advisable	O
to	O
follow	O
this	O
up	O
with	O
a	O
complete	O
bundle	B
adjustment	I
.	O
in	O
fact	O
,	O
given	O
a	O
good	O
initial	O
linear	O
estimate	O
one	O
can	O
proceed	O
directly	O
to	O
bundle	O
adjustment	O
.	O
there	O
is	O
no	O
difﬁculty	O
in	O
incorporating	O
assumptions	O
on	O
calibration	O
parameters	B
into	O
a	O
full	O
bundle	O
adjustment	O
as	O
described	O
in	O
section	O
18.1	O
(	O
p434	O
)	O
.	O
example	O
19.6.	O
metric	B
reconstruction	I
for	O
general	B
motion	I
figure	O
19.1	O
(	O
a-c	O
)	O
shows	O
views	O
of	O
an	O
indian	O
temple	O
acquired	O
by	O
a	O
hand	O
held	O
camera	B
.	O
a	O
projective	B
reconstruction	I
is	O
computed	O
from	O
image	O
point	B
correspondences	O
as	O
described	O
in	O
section	O
18.6	O
,	O
and	O
a	O
metric	B
reconstruction	I
obtained	O
using	O
algorithm	O
19.1	O
under	O
the	O
constraint	O
of	O
constant	O
camera	B
parameters	I
with	O
known	B
principal	I
point	I
.	O
the	O
computed	O
(	O
cid:2	O
)	O
cameras	B
and	O
3d	O
point	B
cloud	O
are	O
shown	O
in	O
ﬁgure	O
19.1	O
(	O
d	O
)	O
and	O
(	O
e	O
)	O
.	O
19.3.4	O
a	O
counting	B
argument	I
the	O
constraints	B
we	O
have	O
seen	O
have	O
been	O
of	O
two	O
types	O
:	O
a	O
parameter	O
has	O
a	O
known	O
value	O
;	O
or	O
a	O
parameter	O
is	O
ﬁxed	O
across	O
views	O
but	O
its	O
value	O
is	O
unknown	O
.	O
the	O
actual	O
constraints	B
that	O
apply	O
depend	O
on	O
the	O
physical	O
circumstances	O
of	O
the	O
image	O
production	O
from	O
acquisition	O
by	O
the	O
camera	B
,	O
through	O
digitization	O
and	O
cropping	O
,	O
to	O
the	O
ﬁnal	O
image	O
.	O
for	O
example	O
,	O
for	O
an	O
image	O
sequence	O
in	O
which	O
the	O
lens	O
is	O
zoomed	O
it	O
might	O
be	O
the	O
case	O
that	O
the	O
skew	O
and	O
aspect	O
ratio	O
are	O
ﬁxed	O
(	O
but	O
unknown	O
)	O
,	O
but	O
that	O
the	O
focal	B
length	I
and	O
principal	B
point	I
vary	O
through	O
the	O
sequence	O
.	O
often	O
it	O
is	O
the	O
case	O
that	O
the	O
pixels	O
are	O
square	O
or	O
have	O
a	O
known	O
aspect	O
ratio	O
,	O
so	O
that	O
both	O
the	O
skew	O
(	O
which	O
is	O
zero	O
)	O
and	O
aspect	O
ratio	O
are	O
known	O
.	O
we	O
will	O
now	O
consider	O
the	O
number	O
of	O
constraints	O
that	O
are	O
required	O
to	O
determine	O
a	O
metric	B
reconstruction	I
fully	O
.	O
the	O
number	O
of	O
parameters	O
that	O
must	O
be	O
computed	O
to	O
perform	O
calibration	B
is	O
8.	O
this	O
is	O
equal	O
to	O
the	O
number	O
of	O
essential	O
parameters	B
of	O
the	O
absolute	B
dual	I
quadric	I
,	O
including	O
the	O
scale	O
ambiguity	B
and	O
rank-3	O
constraint	O
.	O
consider	O
m	O
views	O
and	O
suppose	O
that	O
k	O
of	O
the	O
468	O
19	O
auto-calibration	B
a	O
b	O
c	O
d	O
e	O
f	O
g	O
fig	O
.	O
19.1.	O
metric	B
reconstruction	I
for	O
general	B
motion	I
.	O
(	O
a	O
)	O
-	O
(	O
c	O
)	O
3	O
views	O
(	O
of	O
5	O
)	O
acquired	O
by	O
a	O
hand	O
held	O
camera	B
.	O
(	O
d	O
)	O
and	O
(	O
e	O
)	O
two	B
views	I
of	O
a	O
metric	B
reconstruction	I
computed	O
from	O
interest	O
points	O
matches	O
over	O
the	O
ﬁve	O
views	O
.	O
the	O
cameras	B
are	O
represented	O
by	O
pyramids	O
with	O
apex	O
at	O
the	O
computed	O
camera	O
centre	B
.	O
(	O
f	O
)	O
and	O
(	O
g	O
)	O
two	B
views	I
of	O
a	O
texture	O
mapped	O
3d	O
model	B
computed	O
from	O
the	O
original	O
images	O
and	O
reconstructed	O
cameras	B
using	O
an	O
area	O
based	O
stereo	O
algorithm	O
.	O
figures	O
courtesy	O
of	O
marc	O
pollefeys	O
,	O
reinhard	O
koch	O
,	O
and	O
luc	O
van	O
gool	O
.	O
internal	B
parameters	I
are	O
known	O
in	O
all	O
views	O
,	O
and	O
f	O
are	O
ﬁxed	O
over	O
the	O
views	O
but	O
unknown	O
(	O
where	O
k	O
+	O
f	O
≤	O
5	O
)	O
.	O
a	O
ﬁxed	O
and	O
known	O
calibration	O
parameter	O
provides	O
one	O
constraint	O
per	O
view	O
via	O
the	O
condition	O
ω∗i	O
=	O
piq∗	O
∞pit	O
,	O
for	O
a	O
total	O
of	O
mk	O
constraints	B
.	O
a	O
ﬁxed	O
but	O
unknown	O
calibration	B
parameter	O
provides	O
one	O
fewer	O
constraint	O
,	O
since	O
just	O
the	O
value	O
of	O
the	O
unknown	O
parameter	O
is	O
missing	O
.	O
thus	O
f	O
ﬁxed	O
parameters	O
provide	O
a	O
total	O
of	O
f	O
(	O
m−1	O
)	O
constraints	B
.	O
the	O
requirement	O
for	O
calibration	O
is	O
then	O
that	O
mk	O
+	O
(	O
m	O
−	O
1	O
)	O
f	O
≥	O
8.	O
table	O
19.3	O
gives	O
values	O
for	O
m	O
for	O
several	O
combinations	O
of	O
constraints	O
.	O
it	O
is	O
important	O
to	O
remember	O
that	O
degenerate	B
conﬁgurations	I
are	O
of	O
course	O
possible	O
in	O
which	O
some	O
of	O
the	O
constraints	O
are	O
dependent	O
.	O
this	O
will	O
increase	O
the	O
number	O
of	O
required	O
views	O
.	O
19.3.5	O
limitations	O
of	O
the	O
absolute	O
quadric	O
approach	O
to	O
calibration	O
the	O
following	O
considerations	O
apply	O
to	O
calibration	O
using	O
this	O
method	O
.	O
limitations	O
of	O
least-squares	O
algebraic	B
solution	I
.	O
since	O
the	O
least-squares	B
solution	I
(	O
e.g	O
.	O
of	O
ax	O
=	O
0	O
in	O
the	O
linear	B
solution	I
for	O
the	O
ω∗	O
)	O
minimizes	O
but	O
does	O
not	O
enforce	O
constraints	B
,	O
the	O
solution	B
obtained	O
will	O
not	O
precisely	O
satisfy	O
the	O
required	O
conditions	O
.	O
this	O
observation	O
holds	O
in	O
over-constrained	O
cases	O
.	O
for	O
instance	O
in	O
the	O
case	O
of	O
estimating	O
focal	O
lengths	O
in	O
example	O
19.5	O
,	O
the	O
entries	O
ω∗i	O
22	O
will	O
not	O
be	O
in	O
the	O
required	O
11	O
and	O
ω∗i	O
19.4	O
the	O
kruppa	O
equations	O
469	O
condition	O
ﬁxed	O
known	O
views	O
constant	B
internal	I
parameters	O
aspect	O
ratio	O
and	O
skew	O
known	O
,	O
focal	B
length	I
and	O
principal	B
point	I
vary	O
aspect	O
ratio	O
and	O
skew	O
constant	O
,	O
focal	B
length	I
and	O
principal	B
point	I
vary	O
skew	O
zero	O
,	O
all	O
other	O
parameters	B
vary	O
p.p	O
.	O
known	O
all	O
other	O
parameters	B
vary	O
p.p	O
.	O
known	O
skew	O
zero	O
p.p.	O
,	O
skew	O
and	O
aspect	O
ratio	O
known	O
f	O
5	O
0	O
2	O
0	O
0	O
0	O
0	O
k	O
0	O
2	O
0	O
1	O
2	O
3	O
4	O
m	O
3	O
4*	O
5*	O
8*	O
4*	O
,	O
5	O
(	O
linear	B
)	O
3	O
(	O
linear	B
)	O
2	O
,	O
3	O
(	O
linear	B
)	O
table	O
19.3.	O
the	O
number	O
of	O
views	O
m	O
required	O
under	O
various	O
conditions	O
in	O
order	O
for	O
there	O
to	O
be	O
enough	O
constraints	B
for	O
auto-calibration	B
.	O
for	O
those	O
cases	O
marked	O
with	O
an	O
asterisk	O
there	O
may	O
be	O
multiple	O
solu-	O
tions	O
,	O
even	O
for	O
general	O
motion	O
between	O
views	O
.	O
ratio	O
,	O
nor	O
will	O
the	O
off-diagonal	O
entries	O
be	O
precisely	O
zero	O
.	O
this	O
means	O
that	O
the	O
ki	O
will	O
not	O
be	O
precisely	O
of	O
the	O
desired	O
form	O
.	O
the	O
absolute	B
dual	I
quadric	I
computed	O
by	O
linear	B
means	O
will	O
not	O
have	O
rank	O
3	O
in	O
general	O
,	O
since	O
this	O
is	O
not	O
enforced	O
by	O
the	O
linear	B
equations	I
.	O
a	O
rank	O
3	O
matrix	B
for	O
q∗	O
∞	O
can	O
be	O
obtained	O
by	O
setting	O
the	O
smallest	O
eigenvalue	O
to	O
zero	O
in	O
its	O
eigenvalue	O
decomposition	O
(	O
in	O
a	O
similar	O
manner	O
to	O
using	O
the	O
svd	O
to	O
obtain	O
a	O
rank	O
2	O
matrix	B
for	O
f	O
in	O
the	O
8-point	O
algorithm	B
in	O
section	O
11.1.1	O
(	O
p280	O
)	O
)	O
.	O
this	O
rank	O
3	O
matrix	B
may	O
then	O
be	O
directly	O
decomposed	O
to	O
obtain	O
the	O
rectifying	B
homography	I
(	O
19.2	O
)	O
using	O
result	O
19.4.	O
alternatively	O
,	O
the	O
rank	O
3	O
matrix	B
can	O
provide	O
the	O
starting	O
point	B
for	O
an	O
iterative	B
minimization	I
as	O
described	O
in	O
section	O
19.3.3.	O
the	O
positive-deﬁniteness	O
condition	O
.	O
the	O
most	O
troublesome	O
failing	O
of	O
this	O
method	O
is	O
the	O
difﬁculty	O
in	O
enforcing	O
the	O
condition	O
that	O
q∗	O
∞	O
is	O
positive	O
semi-deﬁnite	O
,	O
(	O
or	O
negative	O
semi-deﬁnite	O
if	O
the	O
sign	O
is	O
reversed	O
)	O
.	O
this	O
is	O
related	O
to	O
the	O
condition	O
that	O
ω∗	O
∞pt	O
should	O
be	O
positive-deﬁnite	O
.	O
if	O
ω∗	O
is	O
not	O
positive-deﬁnite	O
,	O
then	O
it	O
can	O
not	O
be	O
decom-	O
posed	O
using	O
cholesky	O
factorization	B
to	O
compute	O
the	O
calibration	B
matrix	I
.	O
this	O
is	O
a	O
recur-	O
ring	O
problem	O
with	O
auto-calibration	B
methods	O
based	O
on	O
estimation	O
of	O
the	O
iac	O
or	O
diac	O
.	O
if	O
the	O
data	O
is	O
noisy	O
,	O
then	O
this	O
problem	O
may	O
occur	O
indicating	O
that	O
the	O
data	O
are	O
not	O
con-	O
sistent	O
with	O
metric	O
reconstruction	B
.	O
it	O
is	O
not	O
appropriate	O
if	O
this	O
occurs	O
to	O
seek	O
the	O
closest	O
positive-deﬁnite	O
solution	O
,	O
since	O
this	O
will	O
generally	O
be	O
a	O
boundary	O
case	O
leading	O
to	O
a	O
spu-	O
rious	O
calibration	B
.	O
=	O
pq∗	O
19.4	O
the	O
kruppa	O
equations	O
a	O
different	O
method	O
of	B
auto-calibration	I
involves	O
the	O
use	O
of	O
the	O
kruppa	O
equations	O
,	O
which	O
were	O
originally	O
introduced	O
into	O
computer	O
vision	O
by	O
faugeras	O
,	O
luong	O
and	O
may-	O
bank	O
[	O
faugeras-92a	O
]	O
and	O
historically	O
are	O
seen	O
as	O
the	O
ﬁrst	O
auto-calibration	B
method	O
.	O
they	O
470	O
19	O
auto-calibration	B
π	O
c	O
w	O
x	O
x	O
c	O
e	O
o	O
c	O
/	O
/	O
x	O
/	O
e	O
/o	O
c	O
x	O
2	O
l	O
2	O
x1	O
l	O
1	O
e	O
l	O
/	O
1	O
/	O
e	O
x	O
/	O
1	O
/	O
2	O
l	O
/	O
c	O
/x	O
2	O
fig	O
.	O
19.2.	O
epipolar	B
tangency	O
for	O
a	O
conic	O
.	O
a	O
conic	B
cw	O
on	O
a	O
world	O
plane	B
π	O
is	O
imaged	O
as	O
corresponding	O
conics	O
c	O
↔	O
c	O
(	O
cid:1	O
)	O
in	O
two	O
views	O
.	O
the	O
imaged	O
conics	O
are	O
consistent	O
with	O
the	O
epipolar	B
geometry	O
of	O
the	O
view	O
pair	O
.	O
upper	O
:	O
an	O
epipolar	B
plane	O
tangent	O
to	O
the	O
world	O
conic	B
cw	O
deﬁnes	O
corresponding	O
epipolar	B
lines	I
which	O
are	O
tangent	O
to	O
the	O
imaged	O
conics	O
.	O
lower	O
:	O
epipolar	B
lines	I
,	O
l1	O
,	O
l2	O
tangent	O
to	O
the	O
imaged	O
conic	B
in	O
the	O
ﬁrst	O
view	O
correspond	O
to	O
the	O
epipolar	B
lines	I
l	O
(	O
cid:1	O
)	O
2	O
,	O
respectively	O
,	O
tangent	O
to	O
the	O
imaged	O
conic	B
in	O
the	O
second	O
.	O
1	O
,	O
l	O
(	O
cid:1	O
)	O
are	O
two-view	O
constraints	B
that	O
require	O
only	O
f	O
to	O
be	O
known	O
,	O
and	O
consist	O
of	O
two	O
indepen-	O
dent	O
quadratic	O
equations	O
in	O
the	O
elements	O
of	O
ω∗	O
.	O
the	O
kruppa	O
equations	O
are	O
an	O
algebraic	B
representation	O
of	O
the	O
correspondence	O
of	B
epipolar	I
lines	I
tangent	O
to	O
a	O
conic	B
.	O
the	O
geometry	O
of	O
this	O
correspondence	B
is	O
illustrated	O
in	O
ﬁgure	O
19.2.	O
suppose	O
the	O
conics	O
c	O
and	O
c	O
(	O
cid:2	O
)	O
are	O
the	O
images	O
of	O
a	O
conic	O
cw	O
on	O
a	O
world	O
plane	B
in	O
the	O
ﬁrst	O
and	O
second	O
views	O
respectively	O
,	O
and	O
that	O
c∗	O
are	O
their	O
duals	O
.	O
in	O
the	O
ﬁrst	O
view	O
the	O
two	O
epipolar	O
tangent	B
lines	I
l1	O
and	O
l2	O
may	O
be	O
combined	O
into	O
a	O
single	O
de-	O
generate	O
point	B
conic	O
(	O
see	O
example	O
2.8	O
(	O
p32	O
)	O
)	O
as	O
ct	O
=	O
[	O
e	O
]	O
×c∗	O
[	O
e	O
]	O
×	O
.	O
(	O
it	O
may	O
be	O
veriﬁed	O
that	O
any	O
point	B
x	O
on	O
the	O
lines	B
l1	O
and	O
l2	O
satisﬁes	O
xtctx	O
=	O
0	O
)	O
.	O
similarly	O
,	O
in	O
the	O
second	O
view	O
]	O
×c∗	O
(	O
cid:2	O
)	O
t	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
the	O
corresponding	O
epipolar	B
lines	I
l	O
(	O
cid:2	O
)	O
]	O
×	O
.	O
the	O
epipolar	B
tangent	O
lines	B
correspond	O
under	O
the	O
homography	B
h	O
induced	O
by	O
any	O
world	O
plane	B
t	O
=	O
h−tcth−1	O
,	O
π.	O
since	O
ct	O
is	O
a	O
point	B
conic	O
it	O
transforms	O
according	O
to	O
result	O
2.13	O
(	O
p37	O
)	O
c	O
(	O
cid:2	O
)	O
and	O
the	O
correspondence	B
of	O
the	O
lines	B
requires	O
that	O
2	O
may	O
be	O
written	O
as	O
c	O
(	O
cid:2	O
)	O
1	O
and	O
l	O
(	O
cid:2	O
)	O
and	O
c∗	O
(	O
cid:2	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×c∗	O
(	O
cid:2	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
=	O
h−t	O
[	O
e	O
]	O
×c∗	O
[	O
e	O
]	O
×h−1	O
=	O
fc∗ft	O
(	O
19.17	O
)	O
the	O
last	O
equality	O
following	O
from	O
f	O
=	O
h−t	O
[	O
e	O
]	O
×	O
(	O
see	O
page	O
335	O
)	O
.	O
note	O
,	O
this	O
equation	O
does	O
not	O
enforce	O
the	O
condition	O
that	O
the	O
epipolar	B
tangent	O
lines	B
map	O
individually	O
to	O
their	O
cor-	O
responding	O
lines	B
,	O
only	O
that	O
their	O
symmetric	B
product	O
maps	O
to	O
their	O
symmetric	B
product	O
.	O
the	O
development	O
to	O
this	O
point	B
applies	O
to	O
any	O
conic	B
.	O
however	O
,	O
in	O
the	O
case	O
of	O
interest	O
here	O
the	O
world	O
conic	B
is	O
the	O
absolute	O
conic	O
on	O
the	O
plane	O
at	O
inﬁnity	O
,	O
so	O
that	O
c∗	O
ω∗	O
(	O
cid:2	O
)	O
,	O
(	O
and	O
h	O
=	O
h∞	O
)	O
,	O
and	O
(	O
19.17	O
)	O
specializes	O
to	O
19.4	O
the	O
kruppa	O
equations	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×ω∗	O
(	O
cid:2	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
=	O
fωft	O
471	O
=	O
ω∗	O
,	O
c∗	O
(	O
cid:2	O
)	O
=	O
(	O
19.18	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×ω∗	O
if	O
the	O
internal	B
parameters	I
are	O
constant	O
over	O
the	O
views	O
then	O
ω∗	O
(	O
cid:2	O
)	O
and	O
so	O
]	O
×	O
=	O
fω∗ft	O
,	O
which	O
are	O
the	O
kruppa	O
equations	O
in	O
a	O
form	O
originally	O
given	O
[	O
e	O
(	O
cid:2	O
)	O
by	O
vi´eville	O
[	O
vieville-95	O
]	O
.	O
on	O
eliminating	O
the	O
homogeneous	O
scale	O
factor	O
,	O
one	O
obtains	O
equations	O
quadratic	O
in	O
the	O
elements	O
of	O
ω∗	O
=	O
ω∗	O
.	O
although	O
(	O
19.18	O
)	O
concisely	O
expresses	O
the	O
kruppa	O
equations	O
,	O
it	O
is	O
not	O
in	O
a	O
form	O
that	O
can	O
be	O
easily	O
applied	O
.	O
a	O
succinct	O
and	O
easily	O
usable	O
form	B
of	I
the	O
kruppa	O
equations	O
is	O
now	O
given	O
.	O
we	O
show	O
that	O
the	O
null-space	B
of	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
,	O
which	O
is	O
common	O
to	O
both	O
sides	O
of	O
(	O
19.18	O
)	O
,	O
can	O
be	O
eliminated	O
leaving	O
an	O
equation	O
between	O
two	O
3-vectors	O
.	O
result	O
19.7.	O
the	O
kruppa	O
equations	O
(	O
19.18	O
)	O
are	O
equivalent	B
to	O
	O
ut	O
−ut	O
1	O
ut	O
1	O
2	O
ω∗	O
(	O
cid:2	O
)	O
u2	O
ω∗	O
(	O
cid:2	O
)	O
u2	O
ω∗	O
(	O
cid:2	O
)	O
u1	O
	O
×	O
	O
σ2	O
1	O
vt	O
1	O
σ1σ2vt	O
1	O
vt	O
σ2	O
2	O
2	O
ω∗v1	O
ω∗v2	O
ω∗v2	O
	O
=	O
0	O
(	O
19.19	O
)	O
where	O
ui	O
,	O
vi	O
and	O
σi	O
are	O
the	O
columns	O
and	O
singular	B
values	I
of	O
the	O
svd	O
of	O
f.	O
this	O
provides	O
three	O
quadratic	O
equations	O
in	O
the	O
elements	O
ω∗	O
,	O
of	O
which	O
two	O
are	O
independent	O
.	O
ij	O
of	O
ω∗	O
proof	O
.	O
the	O
fundamental	B
matrix	I
has	O
rank	O
2	O
,	O
and	O
thus	O
has	O
an	O
svd	O
expansion	O
	O
σ1	O
	O
vt	O
σ2	O
0	O
f	O
=	O
udvt	O
=	O
u	O
where	O
the	O
null-vectors	O
are	O
ftu3	O
=	O
0	O
and	O
fv3	O
=	O
0.	O
this	O
means	O
that	O
the	O
epipoles	B
are	O
e	O
=	O
v3	O
and	O
e	O
(	O
cid:2	O
)	O
=	O
u3	O
.	O
substituting	O
this	O
expansion	O
into	O
(	O
19.18	O
)	O
we	O
obtain	O
(	O
19.20	O
)	O
we	O
now	O
use	O
the	O
property	O
that	O
u	O
is	O
an	O
orthogonal	B
matrix	O
.	O
on	O
pre-multiplying	O
(	O
19.20	O
)	O
by	O
ut	O
,	O
and	O
post-multiplying	O
by	O
u	O
,	O
the	O
lhs	O
becomes	O
u2	O
−u1	O
0	O
−ut	O
u2	O
−u1	O
0	O
ut	O
[	O
u3	O
]	O
×ω∗	O
(	O
cid:2	O
)	O
[	O
u3	O
]	O
×u	O
=	O
	O
#	O
2	O
=	O
ω∗	O
(	O
cid:2	O
)	O
''	O
#	O
t	O
ω∗	O
(	O
cid:2	O
)	O
u2	O
−ut	O
ω∗	O
(	O
cid:2	O
)	O
u2	O
2	O
ut	O
1	O
0	O
[	O
u3	O
]	O
×ω∗	O
(	O
cid:2	O
)	O
[	O
u3	O
]	O
×	O
=	O
udvtω∗vdut.	O
''	O
	O
ut	O
	O
σ1	O
	O
σ2	O
	O
vtω∗v	O
	O
σ1	O
0	O
ω∗v1	O
ω∗v2	O
σ2	O
=	O
1	O
1	O
vt	O
1	O
σ1σ2vt	O
1	O
0	O
σ2	O
ω∗v2	O
0	O
σ1σ2vt	O
ω∗v2	O
1	O
vt	O
σ2	O
0	O
2	O
2	O
0	O
0	O
ω∗	O
(	O
cid:2	O
)	O
u1	O
0	O
ω∗	O
(	O
cid:2	O
)	O
u1	O
0	O
0	O
0	O
	O
	O
.	O
0	O
and	O
the	O
rhs	O
of	O
(	O
19.20	O
)	O
becomes	O
dvtω∗vd	O
=	O
472	O
19	O
auto-calibration	B
it	O
is	O
evident	O
that	O
both	O
sides	O
have	O
reduced	B
to	O
symmetric	B
matrices	I
each	O
with	O
three	O
in-	O
dependent	O
elements	O
.	O
these	O
three	O
elements	O
may	O
be	O
represented	O
by	O
a	O
homogeneous	O
3-	O
vector	O
on	O
each	O
side	O
:	O
(	O
cid:15	O
)	O
(	O
cid:15	O
)	O
xt	O
lhs	O
=	O
xt	O
rhs	O
=	O
ω∗	O
(	O
cid:2	O
)	O
u2	O
,	O
−ut	O
ω∗v1	O
,	O
σ1σ2vt	O
vt	O
1	O
1	O
1	O
ut	O
2	O
σ2	O
1	O
ω∗	O
(	O
cid:2	O
)	O
u2	O
,	O
ut	O
1	O
ω∗v2	O
,	O
σ2	O
ω∗	O
(	O
cid:2	O
)	O
u1	O
vt	O
2	O
2	O
(	O
cid:16	O
)	O
ω∗v2	O
(	O
cid:16	O
)	O
.	O
the	O
two	O
sides	O
are	O
only	O
equal	O
up	O
to	O
a	O
scale	O
factor	O
.	O
however	O
,	O
equalities	O
are	O
obtained	O
in	O
the	O
usual	O
way	O
using	O
a	O
vector	O
cross-product	O
,	O
xlhs	O
×	O
xrhs	O
=	O
0.	O
an	O
alternative	O
derivation	B
is	O
given	O
in	O
[	O
hartley-97d	O
]	O
.	O
note	O
,	O
the	O
kruppa	O
equations	O
involve	O
the	O
diac	O
,	O
rather	O
than	O
the	O
iac	O
,	O
since	O
they	O
arise	O
from	O
tangent	O
line	B
constraints	O
,	O
and	O
line	B
constraints	O
are	O
more	O
simply	O
expressed	O
using	O
a	O
dual	B
(	O
line	B
)	O
conic	B
.	O
we	O
now	O
discuss	O
the	O
solution	B
of	O
the	O
kruppa	O
equations	O
,	O
beginning	O
with	O
a	O
simple	O
ex-	O
ample	O
where	O
all	O
the	O
internal	B
parameters	I
are	O
known	O
apart	O
from	O
the	O
focal	B
length	I
.	O
an	O
alternative	O
method	O
for	O
solving	O
this	O
problem	O
using	O
the	O
absolute	B
dual	I
quadric	I
was	O
given	O
in	O
example	O
19.5.	O
example	O
19.8.	O
focal	O
lengths	O
for	O
a	O
view	O
pair	O
suppose	O
two	O
cameras	O
have	O
zero	B
skew	I
and	O
known	B
principal	I
point	I
and	O
aspect	O
ratio	O
,	O
but	O
unknown	O
and	O
different	O
focal	O
lengths	O
(	O
as	O
in	O
example	O
19.5	O
)	O
.	O
then	O
from	O
(	O
19.11	O
)	O
by	O
a	O
suitable	O
change	B
of	I
coordinates	I
their	O
diacs	O
may	O
be	O
written	O
as	O
(	O
cid:2	O
)	O
2	O
,	O
α	O
=	O
diag	O
(	O
α2	O
,	O
α2	O
,	O
1	O
)	O
,	O
ω∗	O
(	O
cid:2	O
)	O
=	O
diag	O
(	O
α	O
(	O
cid:2	O
)	O
2	O
,	O
1	O
)	O
ω∗	O
(	O
cid:2	O
)	O
are	O
the	O
unknown	O
focal	O
lengths	O
of	O
the	O
ﬁrst	O
and	O
second	O
view	O
,	O
respectively	O
.	O
where	O
α	O
,	O
α	O
writing	O
the	O
kruppa	O
equations	O
(	O
19.19	O
)	O
as	O
=	O
−	O
ut	O
1	O
ω∗	O
(	O
cid:2	O
)	O
u2	O
ω∗v2	O
ω∗	O
(	O
cid:2	O
)	O
u2	O
ut	O
2	O
ω∗v1	O
vt	O
σ2	O
1	O
1	O
it	O
is	O
evident	O
that	O
each	O
numerator	O
is	O
linear	B
in	O
terms	O
of	O
α	O
in	O
α2	O
.	O
cross-multiplying	O
provides	O
two	O
simple	O
quadratic	O
equations	O
in	O
α2	O
and	O
α	O
are	O
easily	O
solved	O
.	O
the	O
values	O
of	O
α	O
and	O
α	O
if	O
the	O
internal	B
parameters	I
are	O
the	O
same	O
for	O
the	O
two	B
views	I
(	O
that	O
is	O
α	O
=	O
α	O
equation	O
of	O
result	O
19.7	O
provides	O
a	O
quadratic	O
in	O
the	O
single	O
unknown	O
α2	O
.	O
ω∗	O
(	O
cid:2	O
)	O
u1	O
ut	O
1	O
ω∗v2	O
vt	O
σ2	O
2	O
2	O
(	O
cid:2	O
)	O
2	O
and	O
each	O
denominator	O
linear	B
(	O
cid:2	O
)	O
2	O
which	O
are	O
found	O
by	O
taking	O
the	O
square	O
roots	O
.	O
note	O
,	O
)	O
then	O
each	O
(	O
cid:2	O
)	O
σ1σ2vt	O
1	O
=	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
extending	O
the	O
kruppa	O
equations	O
to	O
multiple	O
views	O
.	O
in	O
the	O
absence	O
of	O
knowledge	O
of	O
the	O
internal	O
parameters	B
,	O
other	O
than	O
that	O
the	O
parameters	B
are	O
constant	O
across	O
views	O
,	O
the	O
kruppa	O
equations	O
provide	O
two	O
independent	O
constraints	B
on	O
the	O
ﬁve	O
unknown	O
parame-	O
ters	O
.	O
thus	O
given	O
three	O
views	O
,	O
with	O
f	O
known	O
between	O
each	O
pair	O
,	O
there	O
are	O
in	O
principle	O
six	O
quadratic	O
constraints	B
,	O
which	O
is	O
sufﬁcient	O
to	O
determine	O
ω∗	O
.	O
using	O
any	O
ﬁve	O
of	O
these	O
equations	O
results	O
in	O
ﬁve	O
quadratics	O
in	O
ﬁve	O
unknowns	O
,	O
a	O
total	O
of	O
25	O
possible	O
solutions	O
.	O
solving	B
this	O
set	O
of	O
equations	O
is	O
not	O
a	O
particularly	O
promising	O
approach	O
,	O
although	O
solu-	O
tions	O
have	O
been	O
obtained	O
by	O
homotopy	O
continuation	O
[	O
luong-92	O
]	O
and	O
by	O
minimizing	B
algebraic	I
residuals	O
using	O
every	O
view	O
pair	O
for	B
a	I
sequence	I
of	O
images	O
[	O
zeller-96	O
]	O
.	O
19.5	O
a	O
stratiﬁed	O
solution	O
473	O
ambiguities	B
.	O
vide	O
no	O
constraint	O
on	O
ω∗	O
translation	O
,	O
reduces	O
to	O
[	O
e	O
(	O
cid:2	O
)	O
if	O
there	O
is	O
no	O
rotation	O
between	O
views	O
then	O
the	O
kruppa	O
equations	O
pro-	O
.	O
this	O
may	O
be	O
seen	O
from	O
(	O
19.18	O
)	O
which	O
,	O
in	O
the	O
case	O
of	O
pure	O
]	O
×ω∗	O
]	O
×	O
,	O
since	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×ω∗	O
]	O
×	O
.	O
the	O
kruppa	O
equations	O
are	O
closely	O
related	O
to	O
the	O
calibration	B
constraint	O
provided	O
by	O
the	O
transfer	B
of	O
the	O
iac	O
under	O
the	O
inﬁnite	B
homography	I
,	O
as	O
discussed	O
later	O
in	O
section	O
19.5.2.	O
it	O
will	O
follow	O
from	O
that	O
discussion	O
that	O
the	O
constraint	O
placed	O
on	O
ω∗	O
by	O
the	O
kruppa	O
equations	O
for	O
a	O
pair	O
of	O
views	O
is	O
weaker	O
than	O
that	O
placed	O
by	O
the	O
inﬁnite	B
homography	I
constraint	I
(	O
19.25	O
)	O
.	O
consequently	O
ambiguities	B
of	O
ω∗	O
imposed	O
by	O
the	O
kruppa	O
equations	O
are	O
a	O
superset	O
of	O
those	O
imposed	O
by	O
(	O
19.25	O
)	O
.	O
the	O
application	O
of	O
the	O
kruppa	O
equations	O
to	O
three	O
or	O
more	O
views	O
provides	O
weaker	O
constraints	B
than	O
those	O
obtained	O
by	O
other	O
methods	O
such	O
as	O
the	O
modulus	B
constraint	I
(	O
section	O
19.5.1	O
)	O
or	O
the	O
absolute	B
dual	I
quadric	I
(	O
section	O
19.3.1	O
)	O
.	O
this	O
is	O
because	O
the	O
kruppa	O
constraints	B
are	O
a	O
view-pair	O
constraint	O
for	O
conics	O
obtained	O
as	O
a	O
projection	B
of	O
a	O
3d	O
(	O
dual	B
)	O
quadric	O
.	O
they	O
do	O
not	O
enforce	O
that	O
the	O
(	O
dual	B
)	O
quadric	O
is	O
degenerate	B
,	O
or	O
equivalently	O
do	O
not	O
enforce	O
a	O
common	O
support	O
plane	B
for	O
ω∞	O
over	O
the	O
multiple	O
views	O
.	O
consequently	O
,	O
there	O
are	O
additional	O
ambiguous	O
solutions	O
as	O
described	O
in	O
[	O
sturm-97b	O
]	O
.	O
although	O
the	O
application	O
of	O
the	O
kruppa	O
equations	O
to	O
auto-calibration	O
is	O
chronologi-	O
cally	O
the	O
ﬁrst	O
example	O
in	O
the	O
literature	O
,	O
the	O
difﬁculty	O
of	O
their	O
solution	B
and	O
the	O
problem	O
with	O
ambiguities	B
has	O
seen	O
them	O
losing	O
favour	O
in	O
the	O
face	O
of	O
more	O
tractable	O
methods	O
such	O
as	O
the	O
dual	B
quadric	I
formulation	O
.	O
however	O
,	O
if	O
only	O
two	B
views	I
are	O
given	O
then	O
the	O
kruppa	O
equations	O
are	O
the	O
constraint	O
available	O
on	O
ω∗	O
.	O
19.5	O
a	O
stratiﬁed	O
solution	O
determining	B
a	O
metric	B
reconstruction	I
involves	O
simultaneously	O
obtaining	O
both	O
the	O
cam-	O
era	O
calibration	B
k	O
and	O
the	O
plane	O
at	O
inﬁnity	O
,	O
π∞	O
.	O
an	O
alternative	O
approach	O
is	O
ﬁrst	O
to	O
obtain	O
by	O
some	O
means	O
π∞	O
,	O
or	O
equivalently	O
an	O
afﬁne	B
reconstruction	I
.	O
the	O
subsequent	O
deter-	O
mination	O
of	O
k	O
is	O
then	O
relatively	O
simple	O
because	O
there	O
exists	O
a	O
linear	B
solution	I
.	O
this	O
approach	O
will	O
now	O
be	O
described	O
starting	O
with	O
methods	O
of	O
determining	O
π∞	O
,	O
and	O
hence	O
h∞	O
,	O
and	O
followed	O
by	O
methods	O
of	O
computing	O
k	O
given	O
h∞	O
.	O
19.5.1	O
afﬁne	B
reconstruction	I
–	O
determining	B
π∞	O
for	O
general	O
motion	O
and	O
constant	B
internal	I
parameters	O
,	O
(	O
19.3–p461	O
)	O
can	O
be	O
rearranged	O
into	O
providing	O
a	O
constraint	O
only	O
on	O
π∞	O
,	O
known	O
as	O
the	O
modulus	B
constraint	I
.	O
this	O
allows	O
the	O
coordinates	B
p	O
of	O
π∞	O
to	O
be	O
solved	O
for	O
directly	O
,	O
and	O
is	O
described	O
below	O
.	O
the	O
modulus	B
constraint	I
the	O
modulus	B
constraint	I
is	O
a	O
polynomial	O
equation	O
in	O
the	O
coordinates	B
of	O
π∞	O
.	O
assume	O
the	O
internal	B
parameters	I
are	O
constant	O
;	O
then	O
from	O
(	O
19.3–p461	O
)	O
with	O
ki	O
=	O
k	O
a	O
−	O
apt	O
=	O
µkrk−1	O
(	O
19.21	O
)	O
where	O
the	O
scale	O
factor	O
µ	O
is	O
explicitly	O
included	O
,	O
and	O
for	O
clarity	O
the	O
superscripts	O
are	O
omit-	O
ted	O
.	O
since	O
krk−1	O
is	O
conjugate	O
to	O
a	O
rotation	B
,	O
it	O
has	O
eigenvalues	O
{	O
1	O
,	O
eiθ	O
,	O
e	O
−iθ	O
}	O
.	O
conse-	O
quently	O
,	O
the	O
eigenvalues	O
of	O
(	O
a−	O
apt	O
)	O
are	O
{	O
µ	O
,	O
µeiθ	O
,	O
µe	O
−iθ	O
}	O
,	O
and	O
thus	O
have	O
equal	O
moduli	O
.	O
this	O
is	O
the	O
modulus	B
constraint	I
on	O
the	O
coordinates	B
of	O
the	O
plane	O
at	O
inﬁnity	O
,	O
p.	O
474	O
19	O
auto-calibration	B
to	O
develop	O
this	O
constraint	O
further	O
consider	O
the	O
characteristic	O
polynomial	O
of	O
a	O
−	O
apt	O
which	O
is	O
det	O
(	O
λi	O
−	O
a	O
+	O
apt	O
)	O
=	O
(	O
λ	O
−	O
λ1	O
)	O
(	O
λ	O
−	O
λ2	O
)	O
(	O
λ	O
−	O
λ3	O
)	O
=	O
λ3	O
−	O
f1λ2	O
+	O
f2λ	O
−	O
f3	O
where	O
λi	O
are	O
the	O
three	O
eigenvalues	O
,	O
and	O
f1	O
=	O
λ1	O
+	O
λ2	O
+	O
λ3	O
=	O
µ	O
(	O
1	O
+	O
2	O
cos	O
θ	O
)	O
f2	O
=	O
λ1λ2	O
+	O
λ1λ3	O
+	O
λ2λ3	O
=	O
µ2	O
(	O
1	O
+	O
2	O
cos	O
θ	O
)	O
f3	O
=	O
λ1λ2λ3	O
=	O
µ3	O
.	O
eliminating	O
the	O
scalar	O
µ	O
and	O
angle	B
θ	O
we	O
obtain	O
f3f	O
3	O
1	O
=	O
f	O
3	O
2	O
.	O
looking	O
more	O
closely	O
at	O
the	O
characteristic	O
polynomial	O
we	O
observe	O
that	O
p	O
appears	O
only	O
as	O
part	O
of	O
the	O
rank-1	O
term	O
apt	O
.	O
this	O
means	O
that	O
the	O
elements	O
of	O
p	O
appear	O
only	O
linearly	O
in	O
the	O
determinant	O
det	O
(	O
λi	O
−	O
a	O
+	O
apt	O
)	O
,	O
and	O
hence	O
linearly	O
in	O
each	O
of	O
f1	O
,	O
f2	O
,	O
f3	O
.	O
hence	O
the	O
modulus	B
constraint	I
may	O
be	O
written	O
as	O
a	O
quartic	B
polynomial	O
in	O
the	O
three	O
elements	O
pi	O
of	O
p.	O
this	O
polynomial	O
equation	O
is	O
only	O
a	O
necessary	O
condition	O
for	O
the	O
eigen-	O
values	O
to	O
have	O
equal	O
moduli	O
,	O
not	O
sufﬁcient	O
.	O
each	O
view	O
pair	O
generates	O
a	O
quartic	B
equation	O
in	O
the	O
coordinates	B
of	O
π∞	O
.	O
thus	O
,	O
in	O
principle	O
,	O
three	O
views	O
determine	O
π∞	O
,	O
but	O
only	O
as	O
the	O
intersection	B
of	O
three	O
quartics	O
in	O
three	O
variables	O
–	O
a	O
possible	O
43	O
solutions	O
.	O
however	O
,	O
for	B
three	I
views	I
an	O
additional	O
cubic	O
equation	O
is	O
available	O
from	O
the	O
modulus	B
constraint	I
,	O
and	O
this	O
equation	O
can	O
be	O
used	O
to	O
eliminate	O
many	O
of	O
the	O
spurious	O
solutions	O
.	O
this	O
cubic	O
equation	O
is	O
developed	O
in	O
[	O
schaffalitzky-00a	O
]	O
.	O
the	O
modulus	B
constraint	I
may	O
also	O
be	O
combined	O
with	O
scene	O
in-	O
formation	O
.	O
for	O
example	O
,	O
if	O
a	O
corresponding	O
vanishing	O
line	O
is	O
available	O
in	O
two	O
views	O
,	O
then	O
π∞	O
is	O
determined	O
up	O
to	O
a	O
one-parameter	O
ambiguity	B
.	O
applying	O
the	O
modulus	O
con-	O
straint	O
resolves	O
this	O
ambiguity	B
,	O
and	O
results	O
in	O
a	O
quartic	B
equation	O
in	O
one	O
variable	O
.	O
kruppa	O
equations	O
are	O
equations	O
on	O
ω∗	O
ulus	O
constraint	O
is	O
an	O
equation	O
on	O
π∞	O
which	O
does	O
not	O
involve	O
ω∗	O
π∞	O
is	O
known	O
the	O
other	O
can	O
subsequently	O
be	O
determined	O
.	O
the	O
modulus	B
constraint	I
may	O
be	O
considered	O
the	O
cousin	O
of	O
the	O
kruppa	O
equations	O
:	O
the	O
which	O
do	O
not	O
involve	O
π∞	O
;	O
conversely	O
,	O
the	O
mod-	O
or	O
.	O
once	O
one	O
of	O
ω∗	O
other	O
methods	B
of	I
ﬁnding	I
π∞	O
because	O
of	O
the	O
problem	O
with	O
solving	O
sets	O
of	O
simultaneous	O
quartic	B
equations	O
,	O
the	O
modu-	O
lus	O
constraint	O
is	O
not	O
very	O
satisfactory	O
as	O
a	O
practical	O
means	O
of	O
ﬁnding	O
the	O
plane	O
at	O
inﬁnity	O
.	O
in	O
fact	O
,	O
ﬁnding	O
the	O
plane	O
at	O
inﬁnity	O
is	O
the	O
hardest	O
part	O
of	B
auto-calibration	I
and	O
the	O
place	O
where	O
one	O
is	O
most	O
likely	O
to	O
run	O
into	O
difﬁculties	O
.	O
the	O
plane	O
at	O
inﬁnity	O
may	O
be	O
identiﬁed	O
by	O
various	O
other	O
methods	O
.	O
several	O
of	O
these	O
are	O
described	O
in	O
chapter	O
10.	O
one	O
straightforward	O
method	O
(	O
which	O
is	O
outside	O
the	O
province	O
of	O
pure	O
auto-calibration	B
)	O
is	O
to	O
use	O
properties	B
of	O
the	O
scene	O
geometry	O
.	O
for	O
example	O
,	O
the	O
correspondence	B
of	O
a	O
vanishing	O
point	O
between	O
two	O
views	O
determines	O
a	O
point	B
on	O
π∞	O
,	O
and	O
three	O
such	O
correspondences	B
determine	O
π∞	O
in	O
a	O
projective	B
reconstruction	I
.	O
indeed	O
,	O
19.5	O
a	O
stratiﬁed	O
solution	O
475	O
a	O
good	O
approximation	O
for	O
π∞	O
may	O
well	O
be	O
obtained	O
from	O
the	O
correspondence	B
of	O
three	O
points	O
that	O
are	O
distant	O
in	O
the	O
scene	O
.	O
a	O
second	O
method	O
is	O
to	O
employ	O
a	O
pure	O
translation	O
between	O
two	O
views	O
,	O
i.e	O
.	O
the	O
camera	B
translates	O
but	O
does	O
not	O
rotate	O
or	O
change	O
internal	O
parameters	B
;	O
π∞	O
is	O
determined	O
uniquely	O
by	O
such	O
a	O
motion	O
.	O
as	O
seen	O
in	O
result	O
19.3	O
(	O
p463	O
)	O
the	O
plane	O
at	O
inﬁnity	O
may	O
also	O
be	O
computed	O
from	O
the	O
absolute	B
dual	I
quadric	I
and	O
this	O
method	O
is	O
quite	O
attractive	O
if	O
the	O
principal	B
point	I
is	O
known	O
.	O
methods	O
of	O
bounding	O
the	O
position	O
of	O
π∞	O
using	O
cheiral	O
inequalities	O
will	O
be	O
described	O
in	O
chapter	O
21.	O
these	O
use	O
information	O
about	O
which	O
points	O
are	O
in	O
front	O
of	O
the	O
cameras	O
to	O
get	O
a	O
quasi-afﬁne	B
reconstruction	I
,	O
which	O
is	O
close	O
to	O
an	O
afﬁne	B
reconstruction	I
.	O
a	O
method	O
for	O
ﬁnding	O
the	O
plane	O
at	O
inﬁnity	O
by	O
iterative	B
search	O
from	O
this	O
initial	O
quasi-afﬁne	O
reconstruc-	O
tion	O
is	O
described	O
in	O
[	O
hartley-94b	O
]	O
.	O
more	O
recently	O
,	O
the	O
bounds	O
imposed	O
by	O
cheirality	O
have	O
been	O
used	O
[	O
hartley-99	O
]	O
to	O
deﬁne	O
a	O
rectangular	O
region	O
of	O
3d	O
parameter	B
space	I
in-	O
side	O
which	O
the	O
vector	O
p	O
representing	O
the	O
plane	O
at	O
inﬁnity	O
must	O
lie	O
.	O
then	O
an	O
exhaustive	O
search	O
is	O
undertaken	O
to	O
ﬁnd	O
the	O
elusive	O
plane	O
at	O
inﬁnity	O
inside	O
this	O
region	O
.	O
19.5.2	O
afﬁne	B
to	O
metric	B
conversion	O
–	O
determining	B
k	O
given	O
π∞	O
once	O
the	O
plane	O
at	O
inﬁnity	O
has	O
been	O
determined	O
,	O
an	O
afﬁne	B
reconstruction	I
is	O
effectively	O
known	O
.	O
the	O
remaining	O
step	O
is	O
to	O
transform	O
from	O
afﬁne	O
to	O
metric	B
.	O
it	O
turns	O
out	O
that	O
this	O
is	O
a	O
far	O
easier	O
step	O
than	O
the	O
step	O
from	O
projective	O
to	O
afﬁne	O
.	O
in	O
fact	O
,	O
a	O
linear	B
algorithm	I
is	O
available	O
based	O
on	O
the	O
transformation	B
of	O
the	O
iac	O
or	O
its	O
dual	B
.	O
the	O
inﬁnite	B
homography	I
.	O
the	O
inﬁnite	B
homography	I
h∞	O
is	O
the	O
plane	B
projective	O
trans-	O
formation	O
between	O
two	O
images	O
induced	O
by	O
the	O
plane	O
at	O
inﬁnity	O
π∞	O
(	O
see	O
chapter	O
13	O
)	O
.	O
if	O
the	O
plane	O
at	O
inﬁnity	O
π∞	O
=	O
(	O
pt	O
,	O
1	O
)	O
t	O
and	O
camera	B
matrices	I
[	O
ai	O
|	O
ai	O
]	O
are	O
known	O
in	O
any	O
projective	B
coordinate	O
frame	O
,	O
an	O
explicit	O
formula	O
for	O
the	O
inﬁnite	B
homography	I
can	O
be	O
derived	O
from	O
result	O
13.1	O
(	O
p326	O
)	O
hi∞	O
=	O
ai	O
−	O
aipt	O
(	O
19.22	O
)	O
where	O
hi∞	O
represents	O
the	O
homography	B
from	O
a	O
camera	B
[	O
i	O
|	O
0	O
]	O
to	O
the	O
camera	B
[	O
ai	O
|	O
ai	O
]	O
.	O
so	O
hi∞	O
may	O
be	O
computed	O
from	O
a	O
projective	B
reconstruction	I
once	O
the	O
plane	O
at	O
inﬁnity	O
is	O
known	O
.	O
if	O
the	O
ﬁrst	O
camera	B
is	O
not	O
in	O
the	O
canonical	B
form	I
[	O
i	O
|	O
0	O
]	O
,	O
then	O
one	O
can	O
still	O
compute	O
the	O
homography	B
hi∞	O
from	O
the	O
ﬁrst	O
image	O
to	O
the	O
i-th	O
by	O
writing	O
a1	O
−	O
a1pt	O
ai	O
−	O
aipt	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
−1	O
.	O
(	O
cid:15	O
)	O
hi∞	O
=	O
(	O
19.23	O
)	O
this	O
is	O
not	O
strictly	O
necessary	O
,	O
however	O
,	O
since	O
one	O
can	O
invent	O
a	O
new	O
view	O
that	O
does	O
have	O
camera	B
matrix	I
in	O
the	O
canonical	B
form	I
[	O
i	O
|	O
0	O
]	O
,	O
and	O
express	O
the	O
inﬁnite	O
homographies	O
with	O
respect	O
to	O
this	O
view	O
.	O
in	O
the	O
following	O
discussion	O
,	O
we	O
write	O
k	O
and	O
ω	O
(	O
without	O
super-	O
scripts	O
)	O
to	O
refer	O
either	O
to	O
this	O
reference	O
view	O
,	O
or	O
to	O
the	O
ﬁrst	O
view	O
,	O
if	O
it	O
is	O
in	O
canonical	O
form	O
.	O
the	O
absolute	O
conic	O
lies	O
on	O
π∞	O
so	O
its	O
image	O
is	O
mapped	O
between	O
views	O
by	O
h∞	O
.	O
under	O
the	O
point	B
transformation	O
xi	O
=	O
hi∞x	O
,	O
where	O
hi∞	O
is	O
the	O
inﬁnite	B
homography	I
between	O
the	O
reference	O
view	O
and	O
view	O
i	O
,	O
the	O
transformation	B
rules	O
for	O
a	O
dual	O
conic	B
(	O
result	O
2.14	O
(	O
p37	O
)	O
)	O
476	O
19	O
auto-calibration	B
and	O
a	O
point	B
conic	O
(	O
result	O
2.13	O
(	O
p37	O
)	O
)	O
lead	O
to	O
the	O
relations	O
ω∗i	O
=	O
hi∞ω∗hi∞	O
t	O
and	O
ωi	O
=	O
(	O
hi∞	O
)	O
−tω	O
(	O
hi∞	O
)	O
−1	O
.	O
(	O
19.24	O
)	O
where	O
ωi	O
is	O
the	O
iac	O
in	O
the	O
i-th	O
view	O
.	O
it	O
may	O
be	O
veriﬁed	O
that	O
these	O
equations	O
are	O
precisely	O
the	O
auto-calibration	B
equations	O
(	O
19.4–p461	O
)	O
,	O
and	O
this	O
is	O
another	O
geometric	B
interpretation	I
of	O
those	O
equations	O
.	O
these	O
are	O
among	O
the	O
most	O
important	O
relationships	O
for	O
auto-calibration	O
.	O
they	O
are	O
the	O
basis	O
for	O
obtaining	O
metric	B
reconstruction	I
from	O
afﬁne	B
reconstruction	I
,	O
and	O
also	O
for	O
cali-	O
brating	O
a	O
non-translating	O
camera	B
,	O
as	O
will	O
be	O
seen	O
later	O
in	O
section	O
19.6.	O
the	O
signiﬁcance	O
of	O
this	O
relation	B
for	O
auto-calibration	B
is	O
that	O
if	O
hi∞	O
is	O
known	O
,	O
then	O
these	O
are	O
linear	B
relations	O
between	O
ωi	O
and	O
ω	O
(	O
and	O
similarly	O
for	O
ω∗	O
)	O
.	O
this	O
means	O
that	O
constraints	B
placed	O
on	O
ωi	O
in	O
one	O
view	O
can	O
easily	O
be	O
transferred	O
to	O
another	O
and	O
in	O
this	O
manner	O
sufﬁcient	O
constraints	B
may	O
be	O
assembled	O
to	O
determine	O
ω	O
by	O
linear	B
means	O
.	O
once	O
ω	O
is	O
determined	O
,	O
then	O
k	O
fol-	O
lows	O
by	O
the	O
cholesky	O
decomposition	B
.	O
we	O
will	O
illustrate	O
this	O
approach	O
for	O
the	O
example	O
of	O
ﬁxed	O
internal	B
parameters	I
.	O
sketch	O
solution	B
for	O
identical	O
internal	B
parameters	I
.	O
constant	O
over	O
m	O
views	O
then	O
ki	O
=	O
k	O
and	O
ω∗i	O
=	O
ω∗	O
equation	O
of	O
(	O
19.24	O
)	O
becomes	O
if	O
the	O
internal	B
parameters	I
are	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
,	O
and	O
the	O
ω∗	O
ω∗	O
=	O
hi∞ω∗hi∞t	O
.	O
(	O
19.25	O
)	O
a	O
very	O
important	O
point	B
here	O
relates	O
to	O
the	O
scale	O
factors	O
in	O
the	O
equation	O
(	O
19.25	O
)	O
.	O
•	O
although	O
(	O
19.25	O
)	O
is	O
a	O
relationship	O
between	O
homogeneous	O
quantities	O
,	O
the	O
scale	O
factor	O
in	O
the	O
homogeneous	O
equation	O
can	O
be	O
chosen	O
as	O
unity	O
provided	O
hi∞	O
is	O
normalized	O
as	O
det	O
hi∞	O
=	O
1.	O
this	O
results	O
in	O
six	O
equations	O
for	O
the	O
independent	O
elements	O
of	O
the	O
symmetric	O
matrix	B
.	O
then	O
(	O
19.25	O
)	O
can	O
be	O
written	O
in	O
a	O
homogeneous	O
linear	O
form	O
ω∗	O
ac	O
=	O
0	O
,	O
(	O
19.26	O
)	O
where	O
a	O
is	O
a	O
6	O
×	O
6	O
matrix	B
composed	O
from	O
the	O
elements	O
of	O
hi∞	O
,	O
and	O
c	O
is	O
the	O
conic	B
ω∗	O
written	O
as	O
a	O
6-vector	O
.	O
as	O
discussed	O
below	O
,	O
c	O
is	O
not	O
uniquely	O
determined	O
by	O
one	O
such	O
equation	O
since	O
a	O
has	O
at	O
most	O
rank	O
4.	O
however	O
,	O
if	O
linear	B
equations	I
(	O
19.26	O
)	O
from	O
m	O
≥	O
2	O
view	O
pairs	O
are	O
combined	O
,	O
so	O
that	O
a	O
is	O
now	O
a	O
6m	O
×	O
6	O
matrix	B
,	O
and	O
provided	O
the	O
rotations	B
between	O
the	O
views	O
are	O
about	O
different	O
axes	O
,	O
then	O
in	O
general	O
c	O
is	O
determined	O
uniquely	O
.	O
related	O
to	O
the	O
issue	O
of	O
uniqueness	O
is	O
the	O
issue	O
of	O
numerical	O
stability	B
.	O
under	O
a	O
single	O
motion	O
the	O
linear	B
computation	O
of	O
k	O
from	O
h∞	O
is	O
extremely	O
sensitive	O
to	O
the	O
accuracy	O
of	O
h∞	O
.	O
if	O
h∞	O
is	O
inaccurate	O
it	O
is	O
not	O
always	O
possible	O
to	O
obtain	O
a	O
positive-deﬁnite	B
matrix	I
ω	O
(	O
or	O
ω∗	O
)	O
and	O
thus	O
to	O
apply	O
the	O
cholesky	O
decomposition	B
to	O
obtain	O
k.	O
this	O
sensitivity	O
is	O
reduced	B
if	O
further	O
motions	O
are	O
made	O
,	O
and	O
ω	O
obtained	O
from	O
the	O
combined	O
constraints	B
of	O
a	O
number	O
of	O
h∞	O
’	O
s	O
.	O
477	O
19.5	O
a	O
stratiﬁed	O
solution	O
in	O
an	O
analogous	O
manner	O
to	O
the	O
linear	B
solution	I
for	O
ω∗	O
advantage	O
of	O
using	O
the	O
iac	O
.	O
,	O
a	O
linear	B
solution	I
may	O
be	O
obtained	O
for	O
ω	O
starting	O
from	O
(	O
19.24	O
)	O
.	O
in	O
fact	O
using	O
the	O
equations	O
involving	O
the	O
iac	O
is	O
attractive	O
for	O
the	O
following	O
reason	O
.	O
in	O
the	O
zero-skew	O
case	O
the	O
form	B
of	I
(	O
19.12–p464	O
)	O
for	O
the	O
iac	O
is	O
simpler	O
and	O
more	O
clearly	O
reﬂects	O
the	O
role	O
of	O
each	O
calibration	B
parameter	O
than	O
does	O
the	O
corresponding	O
formula	O
(	O
19.11–p464	O
)	O
for	O
the	O
diac	O
.	O
in	O
order	O
to	O
obtain	O
linear	B
equations	I
using	O
the	O
diac	O
equations	O
(	O
19.11	O
)	O
it	O
is	O
necessary	O
to	O
assume	O
that	O
the	O
principal	B
point	I
is	O
known	O
.	O
this	O
is	O
not	O
necessary	O
for	O
equations	O
deriving	O
from	O
the	O
iac	O
.	O
an	O
assumption	O
of	O
zero	O
skew	O
is	O
quite	O
natural	O
and	O
is	O
a	O
safe	O
assumption	O
for	O
most	O
imaging	O
conditions	O
.	O
however	O
,	O
an	O
assumption	O
of	O
known	O
principal	B
point	I
is	O
much	O
less	O
tenable	O
.	O
for	O
this	O
reason	O
it	O
is	O
usually	O
preferable	O
to	O
use	O
the	O
iac	O
constraints	B
of	O
(	O
19.24	O
)	O
for	O
auto-calibration	O
rather	O
than	O
using	O
the	O
diac	O
constraints	B
.	O
other	O
calibration	B
constraints	I
.	O
the	O
algorithm	B
just	O
described	O
was	O
for	O
constant	O
but	O
arbitrary	O
internal	B
parameters	I
.	O
if	O
more	O
is	O
known	O
about	O
k	O
,	O
such	O
as	O
the	O
value	O
of	O
the	O
aspect	O
ratio	O
or	O
that	O
the	O
skew	O
is	O
zero	O
,	O
the	O
corresponding	O
constraints	B
may	O
be	O
simply	O
added	O
to	O
the	O
set	O
of	O
equations	O
on	O
ω	O
(	O
or	O
ω∗	O
)	O
,	O
and	O
imposed	O
as	O
soft	O
constraints	B
.	O
the	O
possible	O
constraints	B
are	O
shown	O
in	O
table	O
19.2	O
(	O
p465	O
)	O
for	O
the	O
diac	O
(	O
the	O
same	O
constraints	O
that	O
are	O
used	O
to	O
compute	O
q∗	O
∞	O
in	O
section	O
19.3	O
)	O
and	O
table	O
19.4	O
for	O
the	O
iac	O
.	O
as	O
mentioned	O
above	O
,	O
the	O
constraints	B
derived	O
from	O
the	O
iac	O
are	O
generally	O
linear	B
,	O
whereas	O
the	O
constraints	B
derived	O
from	O
the	O
diac	O
,	O
are	O
linear	B
only	O
under	O
the	O
assumption	O
that	O
the	O
principal	B
point	I
is	O
known	O
(	O
and	O
at	O
the	O
origin	O
)	O
.	O
just	O
as	O
with	O
the	O
absolute	B
dual	I
quadric	I
method	O
,	O
it	O
is	O
possible	O
to	O
allow	O
varying	O
internal	O
parameters	B
for	O
the	O
cameras	B
,	O
as	O
long	O
as	O
sufﬁciently	O
many	O
constraints	B
are	O
imposed	O
.	O
the	O
constraint	O
of	O
constant	O
internal	B
parameters	I
for	O
the	O
cameras	B
imposed	O
a	O
total	O
of	O
5	O
(	O
m	O
−	O
1	O
)	O
constraints	B
on	O
the	O
calibration	B
parameters	O
of	O
the	O
m	O
views	O
.	O
we	O
can	O
make	O
do	O
with	O
fewer	O
constraints	B
,	O
letting	O
certain	O
parameters	B
vary	O
.	O
the	O
method	O
of	O
calibration	O
with	O
varying	O
internal	B
parameters	I
is	O
quite	O
analogous	O
to	O
that	O
used	O
in	O
the	O
case	O
of	O
the	O
absolute	O
dual	B
quadric	I
.	O
each	O
entry	O
of	O
ωi	O
is	O
expressible	O
as	O
a	O
linear	B
expression	O
in	O
the	O
entries	O
of	O
ω	O
according	O
to	O
(	O
19.24	O
)	O
.	O
a	O
linear	B
constraint	O
on	O
some	O
entry	O
of	O
ωi	O
therefore	O
maps	O
back	O
to	O
a	O
linear	B
constraint	O
on	O
the	O
entries	O
of	O
ω.	O
note	O
:	O
to	O
avoid	O
treating	O
the	O
ﬁrst	O
image	O
differently	O
,	O
any	O
constraints	B
imposed	O
on	O
the	O
ﬁrst	O
camera	B
,	O
such	O
as	O
ω1	O
12	O
=	O
0	O
(	O
camera	B
1	O
has	O
zero	B
skew	I
)	O
should	O
be	O
treated	O
by	O
adding	O
this	O
equation	O
to	O
the	O
complete	O
equation	O
set	O
,	O
rather	O
than	O
by	O
decreasing	O
the	O
number	O
of	O
parame-	O
ters	O
used	O
to	O
describe	O
ω1	O
.	O
the	O
latter	O
method	O
would	O
cause	O
the	O
zero-skew	O
constraint	O
to	O
be	O
enforced	O
exactly	O
in	O
the	O
ﬁrst	O
image	O
(	O
a	O
hard	O
constraint	O
)	O
,	O
but	O
it	O
would	O
be	O
a	O
soft	O
constraint	O
in	O
the	O
other	O
images	O
.	O
algorithm	B
19.2	O
summarizes	O
the	O
stratiﬁed	O
method	O
for	O
both	O
constant	O
and	O
varying	B
parameters	I
.	O
one	O
could	O
imagine	O
implementing	O
this	O
algorithm	B
directly	O
for	O
a	O
camera	O
mounted	O
on	O
a	O
robot	O
:	O
the	O
camera	B
is	O
ﬁrst	O
moved	O
by	O
a	O
pure	O
translation	O
in	O
order	O
to	O
deter-	O
mine	O
π∞	O
;	O
and	O
in	O
subsequent	O
motions	O
the	O
camera	B
may	O
both	O
translate	O
and	O
rotate	O
until	O
sufﬁcient	O
rotations	B
have	O
accumulated	O
to	O
determine	O
k	O
uniquely	O
.	O
478	O
19	O
auto-calibration	B
condition	O
zero	B
skew	I
constraint	O
ω12	O
=	O
0	O
principal	B
point	I
at	O
origin	O
ω13	O
=	O
ω23	O
=	O
0	O
known	O
aspect	O
ratio	O
r	O
=	O
αy/αx	O
(	O
assuming	B
zero	I
skew	I
)	O
ﬁxed	O
(	O
unknown	O
)	O
aspect	O
ratio	O
(	O
assuming	B
zero	I
skew	I
)	O
ω11	O
=	O
r2ω22	O
ωi	O
11/ωi	O
22	O
=	O
ωj	O
11/ωj	O
22	O
type	O
linear	B
linear	O
linear	B
#	O
constraints	B
m	O
2m	O
m	O
quadratic	O
m	O
−	O
1	O
table	O
19.4.	O
auto-calibration	B
constraints	O
derived	O
from	O
the	O
iac	O
.	O
these	O
constraints	B
are	O
derived	O
directly	O
from	O
the	O
form	B
of	I
(	O
19.10–p464	O
)	O
and	O
(	O
19.12–p464	O
)	O
.	O
the	O
number	O
of	O
constraints	O
column	O
gives	O
the	O
total	O
number	O
of	O
constraints	O
over	O
m	O
views	O
,	O
assuming	O
the	O
constraint	O
is	O
true	O
for	O
each	O
view	O
.	O
using	O
hard	O
constraints	B
.	O
algorithm	B
19.2	O
comes	O
down	O
to	O
solving	O
a	O
homogeneous	O
set	O
of	O
equations	O
of	O
the	O
form	O
ac	O
=	O
0	O
,	O
where	O
c	O
represents	O
ω	O
arranged	O
as	O
a	O
6-vector	O
.	O
generally	O
the	O
supplied	O
information	O
on	O
k	O
,	O
such	O
as	O
that	O
the	O
skew	O
is	O
zero	O
,	O
will	O
not	O
be	O
satisﬁed	O
exactly	O
.	O
as	O
discussed	O
in	O
section	O
8.8	O
(	O
p223	O
)	O
known	O
information	O
can	O
be	O
imposed	O
as	O
a	O
hard	O
constraint	O
by	O
parametrizing	O
ωi	O
in	O
each	O
view	O
to	O
satisfy	O
this	O
constraint	O
.	O
for	O
instance	O
if	O
the	O
camera	B
is	O
known	O
to	O
have	O
square	O
pixels	O
then	O
the	O
remaining	O
parameters	B
for	O
the	O
iac	O
of	O
each	O
view	O
can	O
be	O
represented	O
by	O
a	O
homogeneous	O
4-vector	O
.	O
linear	B
equations	I
for	O
the	O
unknown	O
parameters	B
in	O
each	O
view	O
may	O
again	O
be	O
obtained	O
from	O
(	O
19.24	O
)	O
.	O
a	O
homogeneous	O
set	O
of	O
equations	O
of	O
the	O
form	O
ac	O
=	O
0	O
may	O
then	O
be	O
assembled	O
,	O
where	O
c	O
now	O
represents	O
the	O
unknown	O
parameters	B
of	O
ωi	O
over	O
all	O
views	O
,	O
and	O
a	O
solution	B
which	O
minimizes	O
(	O
cid:10	O
)	O
ac	O
(	O
cid:10	O
)	O
obtained	O
in	O
the	O
usual	O
manner	O
via	O
the	O
svd	O
.	O
an	O
alternative	O
is	O
to	O
include	O
all	O
the	O
parameters	B
in	O
each	O
view	O
and	O
use	O
algorithm	O
a5.5	O
(	O
p594	O
)	O
to	O
minimize	O
(	O
cid:10	O
)	O
ac	O
(	O
cid:10	O
)	O
,	O
while	O
satisfying	O
constraints	B
cc	O
=	O
0	O
exactly	O
.	O
19.5.3	O
the	O
ambiguities	B
in	O
using	O
the	O
inﬁnite	B
homography	I
relation	O
in	O
this	O
section	O
we	O
describe	O
the	O
ambiguities	B
in	O
determining	O
the	O
internal	O
parameters	B
from	O
(	O
19.25	O
)	O
that	O
occur	O
if	O
only	O
a	O
single	O
rotation	O
axis	O
is	O
used	O
.	O
it	O
will	O
be	O
assumed	O
that	O
the	O
internal	B
parameters	I
are	O
unknown	O
but	O
ﬁxed	O
.	O
a	O
rotation	B
matrix	O
r	O
has	O
an	O
eigenvector	O
dr	O
with	O
unit	O
eigenvalue	O
,	O
rdr	O
=	O
1dr	O
,	O
where	O
dr	O
is	O
the	O
direction	O
of	O
the	O
axis	O
of	O
the	O
rotation	O
.	O
consequently	O
,	O
the	O
matrix	B
hi∞	O
=	O
krik−1	O
also	O
has	O
an	O
eigenvector	O
with	O
unit	O
eigenvalue	O
(	O
provided	O
hi∞	O
is	O
normalized	O
as	O
det	O
hi∞	O
=	O
1	O
)	O
.	O
this	O
eigenvector	O
is	O
vr	O
=	O
kdr	O
,	O
and	O
the	O
image	O
point	O
vr	O
corresponds	O
to	O
the	O
vanishing	O
point	O
of	O
the	O
rotation	O
axis	O
direction	O
.	O
suppose	O
ω∗	O
;	O
then	O
,	O
it	O
may	O
be	O
veriﬁed	O
that	O
if	O
ω∗	O
true	O
satisﬁes	O
(	O
19.25	O
)	O
with	O
hi∞	O
=	O
krik−1	O
,	O
then	O
so	O
does	O
the	O
one-parameter	O
family	O
of	O
(	O
dual	B
)	O
conics	O
true	O
is	O
the	O
true	O
ω∗	O
ω∗	O
(	O
µ	O
)	O
=ω	O
∗	O
true	O
+	O
µvrvt	O
r	O
(	O
19.27	O
)	O
where	O
µ	O
parametrizes	O
the	O
family	O
.	O
in	O
a	O
similar	O
manner	O
there	O
is	O
a	O
one	O
parameter	O
family	O
(	O
pencil	O
)	O
of	O
solutions	O
for	O
the	O
iac	O
equation	O
of	O
(	O
19.24	O
)	O
.	O
this	O
argument	O
indicates	O
that	O
19.5	O
a	O
stratiﬁed	O
solution	O
479	O
objective	O
given	O
a	O
projective	B
reconstruction	I
{	O
pi	O
,	O
xj	O
}	O
,	O
where	O
pi	O
=	O
[	O
ai	O
|	O
ai	O
]	O
,	O
determine	O
a	O
metric	B
recon-	O
struction	O
via	O
an	O
intermediate	O
afﬁne	B
reconstruction	I
.	O
algorithm	B
(	O
i	O
)	O
afﬁne	B
rectiﬁcation	O
:	O
determine	O
the	O
vector	O
p	O
that	O
deﬁnes	O
π∞	O
,	O
using	O
one	O
of	O
the	O
methods	O
described	O
in	O
section	O
19.5.1.	O
at	O
this	O
point	B
an	O
afﬁne	B
reconstruction	I
may	O
be	O
obtained	O
as	O
{	O
pihp	O
,	O
h−1	O
p	O
xj	O
}	O
with	O
(	O
ii	O
)	O
inﬁnite	B
homography	I
:	O
compute	O
the	O
inﬁnite	B
homography	I
between	O
the	O
reference	O
view	O
and	O
the	O
others	O
as	O
(	O
iii	O
)	O
compute	O
ω	O
:	O
normalize	O
the	O
matrix	B
so	O
that	O
det	O
hi∞	O
=	O
1	O
.	O
•	O
in	O
constant	O
case	O
of	O
the	O
calibration	O
:	O
equations	O
ω	O
=	O
(	O
hi∞	O
)	O
−tω	O
(	O
hi∞	O
)	O
−1	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
as	O
ac	O
=	O
0	O
with	O
a	O
a	O
6m	O
×	O
6	O
matrix	B
,	O
and	O
c	O
the	O
elements	O
of	O
the	O
conic	O
ω	O
arranged	O
as	O
a	O
6-vector	O
,	O
or	O
•	O
for	O
variable	O
calibration	B
parameters	O
,	O
use	O
the	O
equation	O
ωi	O
=	O
(	O
hi∞	O
)	O
−tω	O
(	O
hi∞	O
)	O
−1	O
to	O
express	O
linear	B
constraints	O
on	O
entries	O
of	O
ωi	O
(	O
e.g	O
.	O
zero	B
skew	I
)	O
as	O
linear	O
equations	O
in	O
the	O
entries	O
of	O
ω.	O
rewrite	O
the	O
(	O
iv	O
)	O
obtain	O
a	O
least-squares	B
solution	I
to	O
ac	O
=	O
0	O
via	O
svd	O
.	O
(	O
v	O
)	O
metric	B
rectiﬁcation	I
:	O
determine	O
the	O
camera	B
matrix	I
k	O
from	O
the	O
cholesky	O
decomposi-	O
tion	O
ω	O
=	O
(	O
kkt	O
)	O
−1	O
.	O
then	O
a	O
metric	B
reconstruction	I
is	O
obtained	O
as	O
{	O
pihpha	O
,	O
(	O
hpha	O
)	O
−1xj	O
}	O
with	O
(	O
cid:24	O
)	O
(	O
cid:24	O
)	O
$	O
hp	O
=	O
i	O
−pt	O
0	O
1	O
hi∞	O
=	O
ai	O
−	O
aipt	O
ha	O
=	O
k	O
0t	O
0	O
1	O
(	O
cid:25	O
)	O
%	O
.	O
.	O
(	O
cid:25	O
)	O
.	O
(	O
vi	O
)	O
use	O
iterative	O
least-squares	O
minimization	O
to	O
improve	O
the	O
solution	B
(	O
see	O
section	O
19.3.3	O
)	O
.	O
algorithm	B
19.2.	O
stratiﬁed	O
auto-calibration	O
algorithm	B
using	O
iac	O
constraints	B
.	O
although	O
the	O
inﬁnite	B
homography	I
constraint	I
seemingly	O
provides	O
six	O
constraints	B
on	O
the	O
ﬁve	O
degrees	B
of	I
freedom	I
of	O
ω∗	O
,	O
only	O
four	O
of	O
these	O
constraints	B
are	O
linearly	O
independent	O
.	O
removing	B
the	I
ambiguity	I
.	O
the	O
one-parameter	O
ambiguity	B
may	O
be	O
resolved	O
in	O
several	O
ways	O
.	O
first	O
,	O
if	O
there	O
is	O
another	O
view	O
available	O
related	O
by	O
a	O
rotation	B
around	O
an	O
axis	O
with	O
a	O
direction	O
different	O
to	O
dr	O
,	O
then	O
the	O
combination	O
of	O
both	O
sets	O
of	O
constraints	O
will	O
not	O
have	O
this	O
ambiguity	B
.	O
a	O
linear	B
solution	I
is	O
easily	O
obtained	O
in	O
the	O
manner	O
of	O
(	O
19.26	O
)	O
.	O
thus	O
with	O
a	O
minimum	O
of	O
three	O
views	O
(	O
i.e	O
.	O
more	O
than	O
one	O
rotation	B
)	O
a	O
unique	O
solution	B
can	O
generally	O
be	O
obtained	O
.	O
a	O
second	O
method	O
of	O
resolving	O
the	O
ambiguity	B
is	O
to	O
make	O
assumptions	O
on	O
the	O
internal	B
parameters	I
of	O
the	O
cameras	B
:	O
for	O
instance	O
an	O
assumption	O
of	O
zero	O
skew	O
(	O
see	O
table	O
19.4	O
)	O
.	O
the	O
equations	O
enforcing	O
zero	B
skew	I
may	O
be	O
added	O
as	O
hard	O
constraints	B
to	O
the	O
set	O
of	O
equations	O
being	O
solved	O
.	O
an	O
alternative	O
(	O
but	O
equivalent	B
)	O
method	O
enforces	O
the	O
constraints	B
a	O
posteriori	O
in	O
the	O
following	O
manner	O
.	O
an	O
ambiguity	B
in	O
solving	O
for	O
c	O
,	O
from	O
the	O
linear	B
equation	O
system	O
480	O
ac	O
=	O
0	O
,	O
occurs	O
when	O
a	O
has	O
a	O
2-dimensional	O
(	O
or	O
greater	O
)	O
right	O
null-space	B
.	O
in	O
this	O
case	O
in	O
solving	O
for	O
ω	O
there	O
would	O
be	O
a	O
family	O
of	O
solutions	O
of	O
the	O
form	O
19	O
auto-calibration	B
ω	O
(	O
α	O
)	O
=ω	O
1	O
+	O
αω2	O
.	O
here	O
ω1	O
and	O
ω2	O
are	O
known	O
from	O
the	O
null-space	B
generators	O
,	O
and	O
α	O
must	O
be	O
determined	O
.	O
it	O
remains	O
simply	O
to	O
ﬁnd	O
the	O
value	O
of	O
α	O
that	O
leads	O
to	O
a	O
solution	B
satisfying	O
the	O
chosen	O
constraint	O
condition	O
in	O
table	O
19.4.	O
this	O
is	O
solved	O
linearly	O
.	O
one	O
could	O
do	O
the	O
same	O
thing	O
solving	O
for	O
the	O
diac	O
,	O
but	O
then	O
the	O
constraint	O
condition	O
would	O
be	O
quadratic	O
(	O
see	O
table	O
19.2	O
(	O
p465	O
)	O
)	O
,	O
and	O
one	O
of	O
the	O
solutions	O
would	O
be	O
spurious	O
.	O
in	O
certain	O
cases	O
,	O
these	O
additional	O
constraints	B
do	O
not	O
resolve	O
the	O
ambiguity	B
.	O
for	O
exam-	O
ple	O
,	O
skew-zero	O
does	O
not	O
resolve	O
the	O
ambiguity	B
if	O
the	O
rotation	B
is	O
about	O
the	O
image	O
x-	O
or	O
y-axes	O
.	O
such	O
exceptions	O
are	O
described	O
in	O
more	O
detail	O
in	O
[	O
zisserman-98	O
]	O
,	O
and	O
we	O
give	O
a	O
few	O
commonly	O
occurring	O
examples	B
now	O
.	O
typical	B
ambiguities	I
.	O
the	O
one-parameter	O
family	O
of	O
solutions	O
given	O
in	O
(	O
19.27	O
)	O
for	O
ω∗	O
(	O
µ	O
)	O
corresponds	O
to	O
a	O
one-parameter	O
family	O
of	O
calibration	O
matrices	O
obtained	O
from	O
(	O
µ	O
)	O
as	O
ω∗	O
ω∗	O
(	O
µ	O
)	O
=	O
k	O
(	O
µ	O
)	O
k	O
(	O
µ	O
)	O
t.	O
for	O
simplicity	O
we	O
will	O
assume	O
that	O
the	O
true	O
camera	B
k	O
(	O
which	O
is	O
a	O
member	O
of	O
this	O
family	O
)	O
has	O
skew	O
zero	O
,	O
so	O
k	O
has	O
four	O
unknown	O
parameters	B
.	O
if	O
the	O
rotation	B
axis	O
is	O
parallel	B
to	O
the	O
camera	B
x-axis	O
,	O
then	O
dr	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
and	O
vr	O
=	O
kdr	O
=	O
αx	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t.	O
from	O
the	O
form	O
(	O
19.11–p464	O
)	O
of	O
ω∗	O
with	O
no	O
skew	O
,	O
the	O
family	O
(	O
19.27	O
)	O
is	O
ω∗	O
(	O
µ	O
)	O
=ω	O
∗	O
true	O
+	O
µvrvt	O
r	O
=	O
	O
α2	O
x	O
(	O
1	O
+	O
µ	O
)	O
+x	O
2	O
0	O
x0y0	O
x0	O
	O
.	O
x0y0	O
y	O
+	O
y2	O
α2	O
y0	O
x0	O
0	O
y0	O
1	O
(	O
19.28	O
)	O
note	O
that	O
the	O
entire	O
family	O
has	O
skew-zero	O
,	O
and	O
in	O
this	O
case	O
only	O
the	O
element	O
ω∗	O
11	O
is	O
varying	O
.	O
this	O
means	O
that	O
the	O
principal	B
point	I
and	O
αy	O
are	O
unambiguously	O
determined	O
–	O
since	O
they	O
may	O
be	O
read-off	O
from	O
elements	O
which	O
are	O
unaffected	O
by	O
the	O
ambiguity	B
.	O
however	O
,	O
it	O
is	O
apparent	B
that	O
αx	O
can	O
not	O
be	O
determined	O
because	O
it	O
only	O
appears	O
in	O
the	O
varying	O
element	O
ω∗	O
•	O
if	O
k	O
is	O
computed	O
from	O
the	O
inﬁnite	B
homography	I
relation	O
(	O
19.25	O
)	O
assuming	O
a	O
zero-	O
skew	O
camera	B
,	O
then	O
for	O
some	O
motions	O
,	O
there	O
remains	O
one	O
undetermined	O
calibration	B
parameter	O
.	O
for	O
rotation	O
about	O
various	O
axes	O
this	O
ambiguity	B
is	O
as	O
follows	O
.	O
11	O
(	O
µ	O
)	O
.	O
to	O
summarize	O
this	O
,	O
and	O
two	O
other	O
canonical	O
cases	O
:	O
(	O
i	O
)	O
x-axis	O
:	O
αx	O
is	O
undetermined	O
;	O
(	O
ii	O
)	O
y-axis	O
:	O
αy	O
is	O
undetermined	O
;	O
(	O
iii	O
)	O
z-axis	O
(	O
principal	O
axis	O
)	O
:	O
αx	O
and	O
αy	O
are	O
undetermined	O
,	O
but	O
their	O
ratio	O
αy/αx	O
is	O
determined	O
.	O
geometric	B
note	O
.	O
these	O
ambiguities	B
are	O
not	O
limited	O
to	O
calibration	O
from	O
a	O
pair	O
of	O
views	O
,	O
but	O
apply	O
to	O
complete	O
sequences	O
.	O
for	O
instance	O
if	O
the	O
set	O
of	O
rotations	O
in	O
a	O
camera	B
motion	I
are	O
all	O
about	O
the	O
x-axis	O
of	O
the	O
camera	O
,	O
then	O
there	O
will	O
be	O
a	O
reconstruction	B
ambiguity	O
,	O
and	O
19.6	O
calibration	B
from	O
rotating	O
cameras	B
481	O
the	O
same	O
is	O
true	O
for	O
y-axis	O
rotations	B
.	O
one	O
can	O
see	O
this	O
geometrically	O
as	O
follows	O
.	O
con-	O
sider	O
a	O
metric	B
reconstruction	I
of	O
a	O
scene	O
from	O
a	O
sequence	O
of	O
images	O
with	O
only	O
y-axis	O
ro-	O
tations	O
of	O
the	O
camera	O
.	O
one	O
can	O
deﬁne	O
a	O
coordinate	O
system	O
in	O
which	O
the	O
world	O
y-axis	O
is	O
aligned	O
with	O
the	O
direction	O
of	O
the	O
camera	O
’	O
s	O
y-axis	O
.	O
now	O
,	O
consider	O
“	O
squashing	O
”	O
the	O
whole	O
reconstruction	B
(	O
points	O
and	O
camera	B
positions	O
)	O
so	O
that	O
their	O
y	O
coordinate	O
is	O
multiplied	O
by	O
some	O
factor	O
k.	O
from	O
the	O
imaging	O
geometry	O
,	O
it	O
is	O
easy	O
to	O
see	O
that	O
this	O
will	O
have	O
the	O
effect	O
of	O
multiplying	O
the	O
y	O
image	O
coordinate	O
of	O
any	O
imaged	O
point	B
by	O
the	O
same	O
factor	O
k	O
,	O
but	O
not	O
affecting	O
the	O
x-coordinate	O
.	O
however	O
,	O
this	O
effect	O
can	O
be	O
undone	O
by	O
multiplying	O
the	O
−1	O
,	O
thereby	O
leaving	O
scale	O
factor	O
αy	O
of	O
coordinates	O
in	O
the	O
image	O
by	O
the	O
inverse	O
factor	O
k	O
image	O
coordinates	O
unchanged	O
.	O
this	O
shows	O
that	O
αy	O
is	O
not	O
unambiguously	O
determined	O
,	O
in	O
fact	O
it	O
is	O
unconstrained	O
.	O
in	O
summary	O
there	O
is	O
a	O
one-parameter	O
ambiguity	B
parallel	O
to	O
the	O
rotation	B
axis	O
in	O
the	O
metric	B
reconstruction	I
and	O
a	O
corresponding	O
one-parameter	O
ambi-	O
guity	O
in	O
the	O
internal	B
parameters	I
.	O
this	O
argument	O
shows	O
that	O
the	O
problem	O
of	O
ambiguity	B
is	O
intrinsic	O
to	O
the	O
motion	O
,	O
and	O
not	O
to	O
any	O
particular	O
auto-calibration	B
algorithm	O
.	O
relationship	O
to	O
the	O
kruppa	O
equations	O
.	O
writing	O
(	O
19.24	O
)	O
for	O
two	O
views	O
as	O
ω∗	O
(	O
cid:2	O
)	O
h∞ω∗ht∞	O
and	O
multiplying	O
before	O
and	O
after	O
by	O
the	O
matrix	B
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
leads	O
to	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×ω∗	O
(	O
cid:2	O
)	O
]	O
×	O
=	O
fω∗ft	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×h∞ω∗ht∞	O
[	O
e	O
(	O
cid:2	O
)	O
since	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×h∞	O
.	O
this	O
is	O
simply	O
the	O
kruppa	O
equations	O
(	O
19.18–p471	O
)	O
,	O
which	O
shows	O
that	O
they	O
follow	O
immediately	O
from	O
the	O
inﬁnite	B
homography	I
constraint	I
.	O
since	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
is	O
not	O
invertible	O
,	O
one	O
can	O
not	O
go	O
the	O
other	O
direction	O
and	O
derive	O
the	O
inﬁnite	B
homography	I
constraint	I
from	O
the	O
kruppa	O
equations	O
.	O
thus	O
,	O
the	O
kruppa	O
equations	O
are	O
a	O
weaker	O
con-	O
straint	O
.	O
however	O
the	O
difference	O
is	O
that	O
to	O
apply	O
(	O
19.24	O
)	O
one	O
needs	O
to	O
know	O
the	O
plane	O
at	O
inﬁnity	O
(	O
and	O
hence	O
afﬁne	B
structure	O
)	O
,	O
since	O
it	O
is	O
true	O
only	O
for	O
the	O
inﬁnite	B
homography	I
,	O
and	O
not	O
for	O
an	O
arbitrary	O
h.	O
the	O
kruppa	O
equations	O
,	O
on	O
the	O
other	O
hand	O
,	O
do	O
not	O
involve	O
any	O
knowledge	O
of	O
afﬁne	O
structure	B
of	O
the	O
scene	O
.	O
nevertheless	O
,	O
this	O
relationship	O
shows	O
that	O
for	B
a	I
sequence	I
of	O
images	O
,	O
any	O
calibration	B
ambiguity	O
under	O
the	O
inﬁnite	B
homography	I
relation	O
is	O
also	O
an	O
ambiguity	B
of	O
the	O
kruppa	O
equations	O
.	O
19.6	O
calibration	B
from	O
rotating	O
cameras	B
in	O
this	O
section	O
,	O
we	O
begin	O
consideration	O
of	O
calibration	O
under	O
special	O
imaging	O
conditions	O
.	O
the	O
situation	O
considered	O
here	O
is	O
the	O
one	O
in	O
which	O
the	O
camera	B
rotates	O
about	O
its	O
centre	B
but	O
does	O
not	O
translate	O
.	O
we	O
will	O
consider	O
both	O
the	O
case	O
of	O
ﬁxed	O
internal	B
parameters	I
,	O
and	O
the	O
case	O
of	O
some	O
parameters	B
known	O
and	O
ﬁxed	O
whilst	O
others	O
are	O
unknown	O
and	O
varying	O
.	O
this	O
situation	O
is	O
one	O
that	O
occurs	O
frequently	O
.	O
examples	B
include	O
:	O
pan–tilt	O
and	O
zoom	O
surveillance	O
cameras	B
;	O
cameras	B
used	O
for	O
broadcasts	O
of	O
sporting	O
events	O
which	O
are	O
almost	O
invariably	O
ﬁxed	O
in	O
location	O
but	O
free	O
to	O
rotate	O
and	O
zoom	O
;	O
and	O
hand-held	O
camcorders	O
which	O
are	O
very	O
often	O
panned	O
from	O
a	O
single	O
viewpoint	O
.	O
even	O
though	O
the	O
rotation	B
is	O
not	O
exactly	O
about	O
the	O
centre	B
,	O
in	O
practice	O
the	O
translation	O
is	O
generally	O
negligible	O
compared	O
to	O
the	O
distance	B
of	O
scene	O
points	O
,	O
and	O
a	O
ﬁxed	O
centre	O
is	O
an	O
excellent	O
approximation	O
.	O
the	O
calibration	B
problem	O
from	O
rotating	O
cameras	B
is	O
mathematically	O
identical	O
with	O
the	O
afﬁne-to-metric	O
calibration	B
step	O
in	O
stratiﬁed	O
reconstruction	B
,	O
as	O
given	O
in	O
section	O
19.5.2	O
.	O
482	O
19	O
auto-calibration	B
objective	O
given	O
m	O
≥	O
2	O
views	O
acquired	O
by	O
a	O
camera	B
rotating	O
about	O
its	O
centre	B
with	O
ﬁxed	O
or	O
varying	O
internal	O
parameters	B
,	O
compute	O
the	O
parameters	B
of	O
each	O
camera	B
.	O
it	O
is	O
assumed	O
that	O
the	O
rotations	B
are	O
not	O
all	O
about	O
the	O
same	O
axis	O
.	O
algorithm	B
(	O
i	O
)	O
inter-image	O
homographies	B
:	O
compute	O
the	O
homography	B
hi	O
between	O
each	O
view	O
i	O
and	O
a	O
reference	O
view	O
such	O
that	O
xi	O
=	O
hix	O
using	O
,	O
for	O
example	O
,	O
algorithm	B
4.6	O
(	O
p123	O
)	O
.	O
normalize	O
the	O
matrices	O
such	O
that	O
det	O
hi	O
=	O
1	O
.	O
(	O
ii	O
)	O
compute	O
ω	O
:	O
•	O
in	O
the	O
case	O
of	O
constant	O
calibration	B
:	O
equations	O
ω	O
=	O
(	O
hi	O
)	O
−tω	O
(	O
hi	O
)	O
−1	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
as	O
ac	O
=	O
0	O
where	O
a	O
is	O
a	O
6m	O
×	O
6	O
matrix	B
,	O
and	O
c	O
the	O
elements	O
of	O
the	O
conic	O
ω	O
arranged	O
as	O
a	O
6-vector	O
,	O
or	O
•	O
for	O
variable	O
calibration	B
parameters	O
,	O
use	O
the	O
equation	O
ωi	O
=	O
(	O
hi	O
)	O
−tω	O
(	O
hi	O
)	O
−1	O
to	O
ex-	O
press	O
linear	B
constraints	O
on	O
entries	O
of	O
ωi	O
in	O
table	O
19.4	O
(	O
e.g	O
.	O
unit	O
aspect	O
ratio	O
)	O
as	O
linear	O
equations	O
in	O
the	O
entries	O
of	O
ω.	O
rewrite	O
the	O
(	O
iii	O
)	O
compute	O
k	O
:	O
determine	O
the	O
cholesky	O
decomposition	B
of	I
ω	O
as	O
ω	O
=	O
uut	O
,	O
and	O
thence	O
k	O
=	O
u−t	O
.	O
(	O
iv	O
)	O
iterative	B
improvement	O
:	O
(	O
optional	O
)	O
reﬁne	O
the	O
linear	B
estimate	O
of	O
k	O
by	O
minimizing	B
(	O
cid:7	O
)	O
d	O
(	O
xi	O
j	O
,	O
krik−1xj	O
)	O
2	O
i=2	O
,	O
m	O
;	O
j=1	O
,	O
n	O
over	O
k	O
and	O
ri	O
,	O
where	O
xj	O
,	O
xi	O
j	O
are	O
the	O
position	O
of	O
the	O
j-th	O
point	B
measured	O
in	O
the	O
ﬁrst	O
and	O
i-th	O
images	O
respectively	O
.	O
initial	O
estimates	O
for	O
the	O
minimization	B
are	O
obtained	O
from	O
k	O
and	O
ri	O
=	O
k−1hik	O
.	O
algorithm	B
19.3.	O
calibration	B
for	O
a	O
camera	B
rotating	O
about	O
its	O
centre	B
.	O
from	O
a	O
non-translating	O
camera	B
it	O
is	O
impossible	O
to	O
achieve	O
an	O
afﬁne	B
(	O
or	O
any	O
)	O
reconstruc-	O
tion	O
,	O
because	O
there	O
is	O
no	O
way	O
to	O
resolve	O
depth	O
.	O
nevertheless	O
,	O
we	O
may	O
compute	O
the	O
inﬁnite	B
homography	I
between	O
the	O
images	O
,	O
which	O
is	O
all	O
that	O
is	O
needed	O
to	O
determine	O
the	O
camera	B
calibration	I
.	O
as	O
has	O
been	O
shown	O
earlier	O
(	O
section	O
8.4	O
(	O
p202	O
)	O
)	O
the	O
images	O
of	O
two	O
cameras	B
with	O
a	O
common	O
centre	B
are	O
related	O
by	O
a	O
plane	B
projective	O
transformation	B
.	O
indeed	O
,	O
if	O
xi	O
and	O
x	O
are	O
−1	O
,	O
corresponding	O
image	O
points	O
then	O
they	O
are	O
related	O
by	O
xi	O
=	O
hix	O
,	O
where	O
hi	O
=	O
kiri	O
(	O
k	O
)	O
and	O
ri	O
is	O
the	O
rotation	B
between	O
view	O
i	O
and	O
the	O
reference	O
view	O
.	O
furthermore	O
,	O
since	O
this	O
map	O
is	O
independent	O
of	O
the	O
depth	O
of	O
the	O
points	O
imaged	O
at	O
x	O
,	O
it	O
applies	O
also	O
to	O
points	O
at	B
inﬁnity	I
,	O
so	O
as	O
shown	O
in	O
section	O
13.4	O
(	O
p338	O
)	O
,	O
hi	O
=	O
hi∞	O
=	O
kiri	O
(	O
k	O
)	O
−1	O
.	O
thus	O
we	O
have	O
a	O
convenient	O
means	O
of	O
measuring	O
h∞	O
directly	O
from	O
images	O
.	O
given	O
h∞	O
a	O
solution	B
for	O
the	O
calibration	B
matrices	O
ki	O
of	O
all	O
the	O
images	O
in	O
the	O
set	O
ac-	O
quired	O
by	O
the	O
rotating	O
camera	B
may	O
be	O
obtained	O
as	O
described	O
in	O
section	O
19.5.2.	O
the	O
method	O
may	O
be	O
applied	O
to	O
either	O
ﬁxed	O
or	O
variable	O
internal	B
parameters	I
and	O
is	O
summa-	O
rized	O
in	O
algorithm	O
19.3.	O
we	O
will	O
illustrate	O
this	O
by	O
a	O
number	O
of	O
examples	O
.	O
19.6	O
calibration	B
from	O
rotating	O
cameras	B
483	O
fig	O
.	O
19.3.	O
calibrating	O
a	O
camera	B
rotating	O
about	O
its	O
centre	B
.	O
(	O
upper	O
)	O
five	O
images	O
of	O
the	O
us	O
capitol	O
acquired	O
by	O
approximately	O
rotating	O
the	O
camera	B
about	O
its	O
centre	B
.	O
(	O
lower	O
)	O
a	O
mosaic	O
image	O
constructed	O
from	O
the	O
ﬁve	O
images	O
(	O
see	O
example	O
8.14	O
(	O
p207	O
)	O
)	O
.	O
the	O
mosaic	O
image	O
shows	O
very	O
clearly	O
the	O
distortion	B
effect	O
of	O
the	O
inﬁnite	O
homography	B
between	O
the	O
images	O
.	O
analysis	O
of	O
this	O
distortion	B
provides	O
the	O
basis	O
for	O
the	O
auto-calibration	B
algorithm	O
.	O
the	O
calibration	B
is	O
computed	O
as	O
described	O
in	O
algorithm	O
19.3.	O
example	O
19.9.	O
rotation	B
about	O
centre	B
with	O
ﬁxed	O
internal	O
parameters	B
the	O
images	O
in	O
ﬁgure	O
19.3	O
were	O
obtained	O
using	O
a	O
35mm	O
camera	B
with	O
ordinary	O
black	O
and	O
white	O
ﬁlm	O
to	O
produce	O
negatives	O
.	O
the	O
camera	B
was	O
hand-held	O
,	O
and	O
no	O
particular	O
care	O
was	O
taken	O
to	O
ensure	O
that	O
the	O
camera	B
centre	I
remained	O
stationary	O
.	O
prints	O
enlarged	O
from	O
these	O
negatives	O
were	O
digitized	O
using	O
a	O
ﬂat-bed	O
scanner	O
.	O
the	O
enlargement	O
process	O
can	O
lead	O
to	O
a	O
non-zero	O
value	O
of	O
s	O
and	O
unequal	O
values	O
of	O
αx	O
and	O
αy	O
if	O
the	O
negative	O
and	O
print	O
paper	O
are	O
not	O
precisely	O
parallel	B
.	O
the	O
resulting	O
image	O
size	O
was	O
776	O
×	O
536	O
pixels	O
.	O
the	O
constraint	O
applied	O
here	O
is	O
that	O
the	O
internal	B
parameters	I
are	O
constant	O
.	O
the	O
camera	B
484	O
19	O
auto-calibration	B
focal	O
length	O
linear	O
non	O
linear	B
10	O
15	O
frame	O
20	O
25	O
pan	O
linear	B
non	O
linear	B
)	O
s	O
l	O
e	O
x	O
i	O
p	O
(	O
h	O
t	O
g	O
n	O
e	O
l	O
l	O
a	O
c	O
o	O
f	O
)	O
g	O
e	O
d	O
(	O
n	O
a	O
p	O
1200	O
1100	O
1000	O
900	O
800	O
700	O
600	O
500	O
0	O
-10	O
-20	O
-30	O
-40	O
-50	O
-60	O
-70	O
-80	O
0	O
5	O
0	O
5	O
a	O
c	O
principal	B
point	I
linear	O
non	O
linear	B
100	O
200	O
300	O
400	O
500	O
600	O
700	O
u_o	O
(	O
pixels	O
)	O
b	O
tilt	O
linear	B
non	O
linear	B
)	O
s	O
l	O
e	O
x	O
i	O
p	O
(	O
o	O
_	O
v	O
)	O
g	O
e	O
d	O
(	O
t	O
l	O
i	O
t	O
500	O
400	O
300	O
200	O
100	O
0	O
0	O
10	O
8	O
6	O
4	O
2	O
0	O
10	O
15	O
frame	O
20	O
25	O
0	O
5	O
15	O
20	O
25	O
frame	O
10	O
d	O
fig	O
.	O
19.4.	O
rotation	B
for	O
varying	O
internal	O
parameters	B
assuming	O
square	O
pixels	O
.	O
these	O
are	O
for	O
the	O
panned	O
sequence	O
of	O
ﬁgure	O
8.9	O
(	O
p206	O
)	O
.	O
(	O
a	O
)	O
focal	B
length	I
.	O
(	O
b	O
)	O
principal	B
point	I
.	O
(	O
c	O
)	O
pan	O
angle	B
.	O
(	O
d	O
)	O
tilt	O
angle	B
.	O
figures	O
courtesy	O
of	O
lourdes	O
de	O
agapito	O
vicente	O
.	O
matrix	B
computed	O
as	O
described	O
in	O
algorithm	O
19.3	O
is	O
	O
964.4	O
−4.9	O
392.8	O
966.4	O
282.0	O
	O
klinear	O
=	O
	O
956.8	O
−6.4	O
392.0	O
959.3	O
281.4	O
	O
.	O
1	O
kiterative	O
=	O
1	O
there	O
is	O
little	O
difference	O
between	O
the	O
linear	B
and	O
iterative	B
estimates	O
,	O
and	O
the	O
computed	O
(	O
cid:2	O
)	O
aspect	O
ratio	O
(	O
virtually	O
unity	O
)	O
and	O
principal	B
point	I
are	O
very	O
reasonable	O
.	O
example	O
19.10.	O
rotation	B
about	O
centre	B
with	O
varying	O
internal	O
parameters	B
the	O
images	O
in	O
ﬁgure	O
8.9	O
(	O
p206	O
)	O
were	O
acquired	O
by	O
panning	O
a	O
camcorder	O
approximately	O
about	O
its	O
centre	B
.	O
the	O
camera	B
was	O
not	O
zoomed	O
,	O
but	O
due	O
to	O
auto-focus	O
there	O
might	O
be	O
slight	O
variations	O
in	O
the	O
focal	B
length	I
and	O
principal	B
point	I
.	O
in	O
this	O
example	O
the	O
constraint	O
used	O
is	O
that	O
the	O
pixels	O
are	O
square	O
:	O
i.e	O
.	O
that	O
the	O
skew	O
is	O
zero	O
and	O
the	O
aspect	O
ratio	O
unity	O
;	O
but	O
the	O
focal	B
length	I
and	O
principal	B
point	I
are	O
unknown	O
and	O
not	O
ﬁxed	O
.	O
then	O
from	O
table	O
19.4	O
we	O
have	O
two	O
linear	O
constraints	B
on	O
ω	O
from	O
each	O
view	O
.	O
−1	O
)	O
11	O
=	O
from	O
zero	O
skew	O
(	O
hi∞	O
−1	O
)	O
22.	O
these	O
constraints	B
are	O
assembled	O
to	O
give	O
a	O
linear	B
system	O
of	O
equations	O
(	O
hi∞	O
on	O
ω	O
as	O
described	O
in	O
algorithm	O
19.3	O
.	O
−1	O
)	O
12	O
=	O
0	O
,	O
and	O
from	O
unit	O
aspect	O
ratio	O
(	O
hi∞	O
−t	O
ω	O
hi∞	O
−t	O
ω	O
hi∞	O
−t	O
ω	O
hi∞	O
the	O
internal	B
parameters	I
of	O
the	O
computed	O
camera	O
matrix	B
for	O
each	O
view	O
are	O
shown	O
it	O
is	O
evident	O
that	O
the	O
recovered	O
focal	B
length	I
and	O
principal	B
point	I
are	O
in	O
ﬁgure	O
19.4.	O
quite	O
constant	O
(	O
even	O
though	O
this	O
was	O
not	O
imposed	O
)	O
,	O
and	O
the	O
pan	O
and	O
tilt	O
angles	O
are	O
very	O
(	O
cid:2	O
)	O
reasonable	O
for	O
this	O
hand-held	O
sequence	O
.	O
19.7	O
auto-calibration	B
from	O
planes	O
485	O
19.7	O
auto-calibration	B
from	O
planes	O
for	O
a	O
set	O
of	O
images	O
of	O
a	O
planar	O
scene	O
,	O
the	O
two-step	O
approach	O
of	O
estimating	O
a	O
projec-	O
tive	O
reconstruction	B
followed	O
by	O
computation	B
of	I
a	O
rectifying	O
transformation	O
to	O
take	O
it	O
to	O
metric	O
does	O
not	O
work	O
.	O
this	O
is	O
because	O
it	O
is	O
not	O
possible	O
to	O
determine	O
the	O
cameras	B
without	O
depth	O
relief	O
.	O
as	O
seen	O
in	O
section	O
17.5.2	O
(	O
p425	O
)	O
,	O
a	O
minimum	O
of	O
two	O
points	O
not	O
lying	O
on	O
the	O
plane	B
are	O
required	O
.	O
nevertheless	O
,	O
auto-calibration	B
from	O
scene	O
planes	O
is	O
possible	O
.	O
this	O
was	O
shown	O
by	O
[	O
triggs-98	O
]	O
who	O
gave	O
a	O
solution	B
in	O
the	O
case	O
of	O
constant	O
internal	B
parameters	I
.	O
the	O
method	O
is	O
especially	O
interesting	O
from	O
the	O
point	B
of	O
view	O
of	O
po-	O
tential	O
applications	O
.	O
scenes	O
consisting	O
of	O
planes	O
are	O
extremely	O
common	O
in	O
man-made	O
environments	O
,	O
e.g	O
.	O
the	O
ground	O
plane	O
.	O
furthermore	O
,	O
in	O
aerial	O
images	O
acquired	O
by	O
a	O
high-	O
ﬂying	O
aircraft	O
or	O
a	O
satellite	O
,	O
the	O
depth-relief	O
of	O
the	O
scene	O
is	O
small	O
compared	O
with	O
the	O
extent	O
of	O
the	O
image	O
,	O
and	O
the	O
scene	O
may	O
be	O
accurately	O
approximated	O
as	O
a	O
plane	B
and	O
the	O
auto-calibration	B
method	O
will	O
apply	O
.	O
the	O
starting	O
point	B
of	O
the	O
algorithm	B
is	O
a	O
set	O
of	O
image–to–image	O
homographies	B
induced	O
by	O
the	O
world	O
plane	B
.	O
these	O
can	O
all	O
be	O
related	O
back	O
to	O
the	O
ﬁrst	O
image	O
,	O
providing	O
a	O
set	O
of	O
homographies	O
hi	O
.	O
geometrically	O
auto-calibration	O
from	O
planes	O
is	O
then	O
a	O
marriage	O
of	O
two	O
ideas	O
.	O
first	O
,	O
the	O
circular	B
points	I
on	O
the	O
plane	B
,	O
which	O
are	O
the	O
intersection	B
of	O
the	O
absolute	O
conic	O
with	O
the	O
plane	B
,	O
are	O
mapped	O
from	O
image	O
to	O
image	O
via	O
the	O
homographies	O
.	O
second	O
,	O
as	O
we	O
have	O
seen	O
in	O
example	O
8.18	O
(	O
p211	O
)	O
,	O
the	O
calibration	B
matrix	I
k	O
may	O
be	O
determined	O
from	O
the	O
imaged	O
circular	B
points	I
of	O
a	O
plane	B
(	O
with	O
two	O
constraints	B
provided	O
by	O
each	O
image	O
)	O
.	O
thus	O
suppose	O
the	O
images	O
of	O
the	O
circular	O
points	O
(	O
4	O
dof	O
)	O
are	O
determined	O
in	O
the	O
ﬁrst	O
image	O
(	O
by	O
some	O
means	O
)	O
,	O
then	O
they	O
may	O
be	O
transferred	O
to	O
the	O
other	O
views	O
by	O
the	O
known	O
hi	O
.	O
in	O
each	O
view	O
then	O
there	O
are	O
two	O
constraints	O
on	O
ω	O
,	O
since	O
the	O
two	O
imaged	O
circular	B
points	I
lie	O
on	O
ω.	O
in	O
detail	O
,	O
if	O
we	O
denote	O
the	O
(	O
at	O
this	O
stage	O
unknown	O
)	O
imaged	O
circular	B
points	I
in	O
the	O
ﬁrst	O
view	O
by	O
cj	O
,	O
j	O
=	O
1	O
,	O
2.	O
then	O
the	O
auto-calibration	B
equations	O
are	O
(	O
hicj	O
)	O
tωi	O
(	O
hicj	O
)	O
=	O
0	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
j	O
=	O
1	O
,	O
2	O
(	O
19.29	O
)	O
where	O
h1	O
=	O
i.	O
in	O
solving	O
these	O
equations	O
the	O
unknowns	O
are	O
the	O
coordinates	B
of	O
the	O
circular	B
points	I
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
some	O
number	O
of	O
unknown	O
calibration	B
parameters	O
.	O
although	O
the	O
circular	B
points	I
are	O
complex	O
points	O
,	O
they	O
are	O
complex	O
conjugates	O
of	O
each	O
other	O
,	O
so	O
4	O
parameters	B
sufﬁce	O
to	O
describe	O
them	O
.	O
if	O
in	O
addition	O
there	O
are	O
a	O
total	O
of	O
v	O
unknowns	O
in	O
the	O
internal	B
parameters	I
ki	O
of	O
all	O
m	O
views	O
,	O
then	O
a	O
solution	B
is	O
possible	O
provided	O
2m	O
≥	O
v	O
+	O
4	O
,	O
since	O
each	O
view	O
provides	O
two	O
equations	O
.	O
restrictions	O
on	O
the	O
internal	B
parameters	I
of	O
the	O
cameras	B
lead	O
to	O
further	O
algebraic	B
con-	O
straints	O
according	O
to	O
table	O
19.4	O
and	O
these	O
are	O
used	O
to	O
supplement	O
the	O
constraints	B
im-	O
posed	O
by	O
(	O
19.29	O
)	O
.	O
various	O
cases	O
are	O
considered	O
in	O
table	O
19.5.	O
in	O
most	O
cases	O
,	O
calibration	B
from	O
a	O
plane	B
is	O
a	O
non-linear	B
problem	O
and	O
nothing	O
more	O
will	O
be	O
said	O
here	O
about	O
computa-	O
tional	O
aspects	O
of	O
how	O
to	O
ﬁnd	O
the	O
solution	B
.	O
iterative	B
methods	I
are	O
necessary	O
,	O
minimizing	B
some	O
cost	B
function	I
.	O
see	O
[	O
triggs-98	O
]	O
for	O
more	O
details	O
of	O
minimization	O
methods	O
.	O
implementation	B
.	O
a	O
considerable	O
implementational	O
advantage	O
of	O
this	O
method	O
is	O
that	O
it	O
only	O
requires	O
the	O
homography	B
between	O
planes	O
,	O
and	O
not	O
the	O
point	B
correspondences	O
486	O
19	O
auto-calibration	B
condition	O
unknown	O
but	O
constant	B
internal	I
parameters	O
constant	O
known	O
skew	O
and	O
aspect	O
ratio	O
.	O
constant	O
unknown	O
principal	B
point	I
and	O
focal	B
length	I
all	O
internal	B
parameters	I
known	O
except	O
varying	O
focal	O
length	O
varying	O
focal	B
length	I
,	O
all	O
other	O
internal	B
parameters	I
ﬁxed	O
but	O
unknown	O
dof	O
(	O
v	O
)	O
views	O
5	O
3	O
m	O
m	O
+	O
4	O
5	O
4	O
4	O
8	O
table	O
19.5.	O
the	O
number	O
of	O
views	O
required	O
for	O
calibration	O
from	O
a	O
plane	B
under	O
various	O
conditions	O
.	O
calibration	B
is	O
(	O
in	O
principle	O
)	O
possible	O
if	O
2m	O
≥	O
v	O
+	O
4.	O
arising	O
from	O
3-space	O
points	O
that	O
are	O
generally	O
required	O
to	O
estimate	O
multiple	O
view	O
ten-	O
sors	O
,	O
such	O
as	O
the	O
fundamental	B
matrix	I
.	O
the	O
matching	B
transformation	O
between	O
planes	O
is	O
a	O
much	O
simpler	O
,	O
stabler	O
and	O
accurate	O
computation	B
because	O
of	O
the	O
constrained	O
nature	O
of	O
the	O
inter-image	O
transformation	B
which	O
is	O
point-to-point	O
.	O
the	O
method	O
of	O
algorithm	O
4.6-	O
(	O
p123	O
)	O
may	O
be	O
used	O
to	O
estimate	O
this	O
transformation	B
between	O
two	O
images	O
.	O
alternatively	O
,	O
correlation-based	O
methods	O
that	O
estimate	O
the	O
parametrized	O
homography	B
directly	O
from	O
image	O
intensity	O
may	O
be	O
used	O
.	O
including	O
additional	O
information	O
.	O
if	O
additional	O
information	O
is	O
available	O
on	O
the	O
plane	B
or	O
the	O
motion	O
then	O
the	O
complexity	O
of	B
auto-calibration	I
using	O
scene	O
planes	O
may	O
be	O
re-	O
duced	O
.	O
for	O
example	O
,	O
if	O
the	O
vanishing	O
line	O
of	O
the	O
imaged	O
plane	B
can	O
be	O
determined	O
then	O
only	O
two	O
parameters	O
are	O
required	O
to	O
specify	O
the	O
circular	B
points	I
since	O
the	O
imaged	O
circu-	O
lar	O
points	O
lie	O
on	O
the	O
vanishing	O
line	O
.	O
indeed	O
if	O
the	O
plane	B
provides	O
sufﬁcient	O
information	O
to	O
estimate	O
its	O
imaged	O
circular	B
points	I
directly	O
(	O
such	O
as	O
a	O
square	O
grid	O
)	O
then	O
the	O
problem	O
reduces	O
to	O
that	O
of	O
calibration	O
from	B
scene	I
constraints	I
discussed	O
in	O
section	O
8.8	O
(	O
p223	O
)	O
.	O
similarly	O
constraints	B
on	O
the	O
motion	O
may	O
be	O
used	O
to	O
simplify	O
the	O
problem	O
.	O
one	O
partic-	O
ular	O
example	O
is	O
where	O
the	O
rotation	B
axis	O
describing	O
the	O
camera	B
motion	I
is	O
parallel	B
to	O
the	O
scene	O
plane	O
normal	O
.	O
in	O
this	O
case	O
the	O
imaged	O
circular	B
points	I
may	O
be	O
computed	O
directly	O
from	O
the	O
ﬁxed	O
points	O
of	O
the	O
homography	B
and	O
two	O
linear	O
constraints	B
placed	O
on	O
ω.	O
this	O
situation	O
is	O
discussed	O
further	O
in	O
note	O
(	O
vii	O
)	O
at	O
the	O
end	O
of	O
the	O
chapter	O
.	O
an	O
example	O
of	O
such	O
a	O
motion	O
is	O
planar	B
motion	I
which	O
is	O
discussed	O
in	O
detail	O
in	O
the	O
following	O
section	O
.	O
19.8	O
planar	B
motion	I
a	O
case	O
of	O
some	O
practical	O
importance	O
is	O
that	O
of	O
a	O
camera	O
moving	B
in	O
a	O
plane	B
and	O
rotating	O
about	O
an	O
axis	O
perpendicular	O
to	O
that	O
plane	B
.	O
this	O
is	O
the	O
case	O
for	O
a	O
roaming	O
vehicle	O
moving	B
on	O
a	O
ground	O
plane	O
,	O
with	O
a	O
camera	B
ﬁxed	O
with	O
respect	O
to	O
the	O
vehicle	O
body	O
.	O
in	O
this	O
case	O
,	O
the	O
camera	B
must	O
move	O
in	O
a	O
plane	B
parallel	O
to	O
the	O
(	O
horizontal	O
)	O
ground	O
,	O
and	O
as	O
the	O
vehicle	O
turns	O
,	O
the	O
camera	B
will	O
rotate	O
about	O
a	O
vertical	O
axis	O
.	O
it	O
is	O
not	O
assumed	O
that	O
the	O
camera	B
is	O
pointing	O
horizontally	O
,	O
or	O
is	O
in	O
any	O
other	O
particular	O
orientation	B
with	O
respect	O
to	O
the	O
vehicle	O
.	O
however	O
,	O
we	O
assume	O
constant	B
internal	I
calibration	O
for	O
the	O
camera	B
.	O
the	O
constrained	O
nature	O
of	O
the	O
motion	O
makes	O
the	O
calibration	B
task	O
signiﬁcantly	O
simpler	O
.	O
19.8	O
planar	B
motion	I
487	O
it	O
will	O
be	O
shown	O
that	O
given	O
three	O
or	O
more	O
images	O
from	O
a	O
sequence	O
of	O
planar	O
motions	O
an	O
afﬁne	B
reconstruction	I
may	O
be	O
computed	O
.	O
to	O
do	O
this	O
,	O
we	O
need	O
to	O
determine	O
the	O
plane	O
at	O
inﬁnity	O
.	O
this	O
will	O
be	O
done	O
by	O
identifying	O
three	O
points	O
on	O
the	O
plane	O
at	O
inﬁnity	O
,	O
thereby	O
deﬁning	O
the	O
plane	B
.	O
these	O
points	O
will	O
be	O
identiﬁed	O
as	O
being	O
ﬁxed	B
points	I
in	O
the	O
sequence	O
of	O
images	O
.	O
fixed	O
image	O
points	O
under	O
planar	B
motion	I
.	O
according	O
to	O
section	O
3.4.1	O
(	O
p77	O
)	O
,	O
any	O
rigid	O
motion	O
(	O
for	O
instance	O
the	O
camera	B
motion	I
)	O
can	O
be	O
interpreted	O
as	O
a	O
rotation	B
about	O
screw	B
axis	I
along	O
with	O
a	O
translation	O
along	O
the	O
direction	O
of	O
the	O
axis	O
.	O
for	O
a	O
planar	O
motion	O
,	O
the	O
rotation	B
axis	O
is	O
perpendicular	O
to	O
the	O
plane	B
of	O
motion	O
,	O
and	O
the	O
translational	O
part	O
of	O
the	O
screw	O
motion	O
is	O
zero	O
.	O
think	O
of	O
the	O
vehicle	O
as	O
being	O
swung	O
horizontally	O
around	O
the	O
screw	B
axis	I
.	O
the	O
position	O
of	O
the	O
screw	O
axis	O
with	O
respect	O
to	O
the	O
camera	B
remains	O
ﬁxed	O
,	O
and	O
so	O
it	O
will	O
constitute	O
a	O
line	B
of	O
ﬁxed	B
points	I
in	O
the	O
image	O
.	O
if	O
a	O
second	O
motion	O
takes	O
place	O
about	O
a	O
different	O
axis	O
,	O
then	O
the	O
image	O
of	O
the	O
second	O
axis	O
will	O
be	O
ﬁxed	O
in	O
the	O
second	O
pair	O
of	O
images	O
.	O
the	O
images	O
of	O
the	O
two	O
axes	O
will	O
in	O
general	O
be	O
different	O
,	O
but	O
will	O
intersect	O
in	O
the	O
image	O
of	O
the	O
point	O
where	O
the	O
two	O
screw	O
axes	O
meet	O
.	O
since	O
the	O
two	O
axes	O
are	O
vertical	O
,	O
they	O
are	O
perforce	O
parallel	B
,	O
and	O
so	O
will	O
meet	O
at	O
their	O
common	O
direction	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
this	O
direction	O
projects	O
into	O
the	O
images	O
at	O
the	O
intersection	B
of	O
the	O
images	O
of	O
the	O
screw	O
axes	O
,	O
which	O
is	O
the	O
vanishing	O
point	O
of	O
the	O
screw	O
axes	O
direction	O
.	O
this	O
image	O
point	O
is	O
called	O
the	O
apex	O
.	O
we	O
now	O
have	O
one	O
ﬁxed	O
point	O
over	O
the	O
views	O
,	O
and	O
this	O
will	O
be	O
used	O
to	O
determine	O
one	O
point	B
on	O
the	O
plane	O
at	O
inﬁnity	O
in	O
a	O
projective	B
reconstruction	I
.	O
as	O
we	O
have	O
seen	O
the	O
image	O
of	O
the	O
screw	O
axis	O
is	O
a	O
line	B
of	O
ﬁxed	B
points	I
for	O
an	O
image	O
pair	O
.	O
there	O
is	O
also	O
a	O
ﬁxed	O
line	O
which	O
is	O
identiﬁable	O
from	O
a	O
pair	O
of	O
images	O
as	O
follows	O
.	O
because	O
the	O
plane	B
of	O
motion	O
of	O
the	O
camera	O
(	O
which	O
will	O
be	O
called	O
the	O
ground	O
plane	O
)	O
is	O
ﬁxed	O
,	O
the	O
set	O
of	B
points	I
in	O
the	O
plane	B
is	O
mapped	O
to	O
the	O
same	O
line	O
in	O
all	O
the	O
images	O
.	O
this	O
line	B
is	O
called	O
the	O
horizon	O
line	B
and	O
is	O
the	O
vanishing	O
line	O
of	O
the	O
ground	O
plane	B
.	O
since	O
each	O
of	O
the	O
cameras	O
lie	O
on	O
the	O
ground	O
plane	O
their	O
epipoles	B
must	O
all	O
lie	O
on	O
the	O
horizon	O
line	B
.	O
unlike	O
the	O
image	O
of	O
the	O
screw	O
axis	O
,	O
the	O
horizon	O
line	B
is	O
a	O
ﬁxed	O
line	O
,	O
but	O
not	O
a	O
line	B
of	O
ﬁxed	B
points	I
.	O
although	O
the	O
horizon	O
line	B
is	O
not	O
ﬁxed	O
pointwise	O
,	O
it	O
contains	O
two	O
points	O
that	O
are	O
ﬁxed	O
in	O
the	O
image	O
pair	O
,	O
namely	O
the	O
image	O
of	O
the	O
two	O
circular	B
points	I
on	O
the	O
ground	O
plane	O
.	O
these	O
circular	B
points	I
are	O
the	O
intersection	B
of	O
the	O
absolute	O
conic	O
with	O
the	O
ground	O
plane	O
.	O
since	O
the	O
image	B
of	I
the	I
absolute	I
conic	I
is	O
ﬁxed	O
under	O
rigid	O
motion	O
,	O
and	O
the	O
image	O
of	O
the	O
ground	O
plane	B
is	O
ﬁxed	O
,	O
the	O
images	O
of	O
two	O
circular	B
points	I
must	O
be	O
ﬁxed	O
.	O
in	O
fact	O
,	O
they	O
will	O
be	O
ﬁxed	O
in	O
all	O
images	O
from	O
the	O
planar	B
motion	I
sequence	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
19.5.	O
so	O
far	O
we	O
have	O
described	O
the	O
ﬁxed	O
points	O
of	O
the	O
motion	O
sequence	O
.	O
computing	B
these	O
ﬁxed	B
points	I
is	O
equivalent	B
to	O
afﬁne	B
reconstruction	I
,	O
since	O
we	O
can	O
back-project	O
from	O
the	O
ﬁxed	B
image	I
points	I
to	O
ﬁnd	O
the	O
corresponding	O
3d	O
points	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
al-	O
though	O
the	O
apex	O
may	O
be	O
computed	O
from	O
two	O
views	O
;	O
it	O
requires	O
three	O
views	O
to	O
compute	O
the	O
imaged	O
circular	B
points	I
.	O
computing	B
the	O
ﬁxed	B
points	I
.	O
the	O
set	O
of	B
points	I
in	O
space	O
that	O
map	O
to	O
the	O
same	O
image	O
point	B
in	O
two	O
images	O
is	O
called	O
the	O
horopter	B
.	O
in	O
general	O
,	O
the	O
horopter	B
is	O
a	O
twisted	B
cubic	I
,	O
488	O
19	O
auto-calibration	B
v	O
image	O
of	O
screw	O
axis	O
c	O
i	O
e	O
e	O
/	O
a	O
horizon	O
c	O
j	O
image	O
v	O
b	O
imaged	O
screw	O
axes	O
horizon	O
image	O
fig	O
.	O
19.5.	O
fixed	O
image	O
entities	O
for	B
planar	I
motion	I
.	O
(	O
a	O
)	O
for	O
two	O
views	O
the	O
imaged	O
screw	B
axis	I
is	O
a	O
line	B
of	O
ﬁxed	B
points	I
in	O
the	O
image	O
under	O
the	O
motion	O
.	O
the	O
horizon	O
is	O
a	O
ﬁxed	O
line	O
under	O
the	O
motion	O
.	O
the	O
epipoles	B
e	O
,	O
e	O
(	O
cid:1	O
)	O
and	O
imaged	O
circular	B
points	I
of	O
the	O
ground	O
plane	O
ci	O
,	O
cj	O
lie	O
on	O
the	O
horizon	O
.	O
(	O
b	O
)	O
the	O
relation	B
between	O
the	O
ﬁxed	O
lines	O
obtained	O
pairwise	O
for	O
three	O
images	O
under	O
planar	B
motion	I
.	O
the	O
image	O
horizon	O
lines	B
for	O
each	O
pair	O
are	O
coincident	O
,	O
and	O
the	O
imaged	O
screw	O
axes	O
for	O
each	O
pair	O
intersect	O
in	O
the	O
apex	O
v.	O
all	O
the	O
epipoles	B
lie	O
on	O
the	O
horizon	O
line	B
.	O
but	O
in	O
the	O
case	O
of	O
planar	O
motion	O
it	O
degenerates	O
to	O
a	O
line	B
(	O
the	O
screw	B
axis	I
)	O
and	O
a	O
conic	B
on	O
the	O
ground	O
plane	O
.	O
the	O
image	O
of	O
the	O
horopter	O
is	O
the	O
conic	B
deﬁned	O
by	O
f	O
+	O
ft	O
,	O
where	O
f	O
is	O
the	O
fundamental	B
matrix	I
(	O
see	O
section	O
9.4	O
(	O
p250	O
)	O
)	O
.	O
in	O
the	O
case	O
of	O
planar	O
motion	O
this	O
will	O
be	O
a	O
degenerate	B
conic	O
consisting	O
of	O
two	O
lines	B
,	O
the	O
image	O
of	O
the	O
screw	O
axis	O
and	O
the	O
horizon	O
line	B
(	O
see	O
ﬁgure	O
9.11	O
(	O
p253	O
)	O
)	O
.	O
by	O
decomposing	O
the	O
conic	B
,	O
these	O
two	O
lines	O
are	O
determined	O
.	O
from	O
three	O
images	O
we	O
can	O
compute	O
the	O
image	O
of	O
the	O
horopter	O
for	O
each	O
of	O
three	O
pairs	O
,	O
and	O
thereby	O
obtain	O
three	O
sets	O
of	O
horizon	O
lines	B
and	O
imaged	O
axes	O
.	O
the	O
horizon	O
line	B
will	O
be	O
a	O
common	O
component	O
of	O
these	O
sets	O
,	O
and	O
the	O
other	O
components	O
(	O
the	O
images	O
of	O
the	O
screw	O
axes	O
)	O
will	O
intersect	O
in	O
the	O
image	O
at	O
the	O
apex	O
.	O
now	O
we	O
turn	O
to	O
computing	O
the	O
circular	B
points	I
.	O
it	O
is	O
useful	O
to	O
understand	O
the	O
geom-	O
etry	O
of	O
a	O
pair	O
of	O
horopters	O
corresponding	O
to	O
two	O
pairs	O
of	O
images	O
.	O
let	O
c12	O
be	O
a	O
conic	B
representing	O
the	O
portion	O
of	O
the	O
horopter	O
for	O
images	O
1	O
and	O
2	O
,	O
lying	O
in	O
the	O
ground	O
plane	O
.	O
this	O
conic	B
will	O
pass	O
through	O
the	O
two	O
circular	O
points	O
,	O
the	O
two	O
camera	O
centres	O
and	O
the	O
intersection	B
of	O
the	O
screw	B
axis	I
with	O
the	O
ground	O
plane	O
.	O
since	O
the	O
conic	B
contains	O
the	O
cir-	O
cular	O
points	O
it	O
is	O
a	O
circle	O
.	O
let	O
c23	O
be	O
the	O
corresponding	O
circle	O
deﬁned	O
from	O
images	O
2	O
and	O
3.	O
the	O
two	O
circular	O
points	O
and	O
the	O
centre	B
of	O
the	O
second	O
camera	B
will	O
lie	O
on	O
both	O
circles	O
.	O
since	O
two	O
conics	O
intersect	O
in	O
general	O
in	O
four	O
points	O
,	O
there	O
must	O
be	O
a	O
further	O
(	O
real	O
)	O
intersection	B
point	O
.	O
however	O
,	O
this	O
can	O
be	O
discarded	O
,	O
since	O
the	O
points	O
of	O
interest	O
are	O
the	O
two	O
complex	O
intersection	B
points	O
,	O
namely	O
the	O
circular	B
points	I
on	O
the	O
ground	O
plane	O
.	O
in	O
implementations	O
,	O
authors	O
have	O
chosen	O
different	O
ways	O
of	O
ﬁnding	O
the	O
two	O
circular	O
points	O
.	O
in	O
[	O
armstrong-96b	O
]	O
the	O
method	O
is	O
based	O
on	O
ﬁnding	O
ﬁxed	O
lines	O
in	O
three	O
views	O
through	O
the	O
apex	O
using	O
the	O
trifocal	B
tensor	I
.	O
in	O
[	O
faugeras-98	O
,	O
sturm-97b	O
]	O
the	O
method	O
in-	O
volves	O
computing	B
the	O
trifocal	B
tensor	I
of	O
a	O
1d	O
camera	B
,	O
applied	O
to	O
imaging	O
the	O
2d	O
ground	O
plane	O
to	O
a	O
1d	O
image	O
.	O
in	O
both	O
cases	O
the	O
positions	O
of	O
the	O
circular	O
points	O
on	O
the	O
horizon	O
are	O
obtained	O
as	O
the	O
solution	B
of	O
a	O
cubic	O
in	O
one	O
variable	O
.	O
the	O
main	O
steps	O
of	O
this	O
afﬁne	B
calibration	O
method	O
are	O
summarized	O
in	O
algorithm	O
19.4	O
.	O
19.8	O
planar	B
motion	I
489	O
objective	O
given	O
three	O
(	O
or	O
more	O
)	O
images	O
acquired	O
by	O
a	O
camera	B
with	O
constant	B
internal	I
parameters	O
under-	O
going	O
planar	B
motion	I
compute	O
an	O
afﬁne	B
reconstruction	I
.	O
algorithm	B
the	O
trifocal	B
tensor	I
may	O
be	O
computed	O
by	O
,	O
e.g	O
.	O
algorithm	B
16.4	O
(	O
p401	O
)	O
.	O
(	O
i	O
)	O
compute	O
a	O
projective	B
reconstruction	I
.	O
from	O
the	O
trifocal	B
tensor	I
t	O
for	O
the	O
three	O
views	O
.	O
(	O
ii	O
)	O
compute	O
pairwise	O
fundamental	O
matrices	O
from	O
t	O
.	O
see	O
algorithm	B
15.1	O
(	O
p375	O
)	O
.	O
de-	O
compose	O
the	O
symmetric	B
part	I
of	O
each	O
fundamental	B
matrix	I
into	O
two	O
lines	O
,	O
a	O
horizon	O
and	O
the	O
image	O
of	O
the	O
screw	O
axes	O
.	O
see	O
section	O
9.4.1	O
(	O
p252	O
)	O
.	O
(	O
iii	O
)	O
compute	O
the	O
apex	O
.	O
intersect	O
the	O
three	O
imaged	O
screw	O
axes	O
to	O
determine	O
the	O
apex	O
v.	O
(	O
iv	O
)	O
compute	O
the	O
horizon	O
for	O
the	O
triplet	O
.	O
obtain	O
the	O
six	O
epipoles	B
from	O
the	O
three	O
funda-	O
mental	O
matrices	O
,	O
and	O
determine	O
the	O
horizon	O
by	O
an	O
orthogonal	B
regression	I
ﬁt	O
to	O
these	O
epipoles	B
.	O
(	O
v	O
)	O
compute	O
the	O
imaged	O
circular	B
points	I
.	O
compute	O
the	O
position	O
of	O
the	O
imaged	O
circular	O
(	O
vi	O
)	O
compute	O
the	O
plane	O
at	O
inﬁnity	O
.	O
triangulate	O
points	O
on	O
the	O
plane	O
at	O
inﬁnity	O
from	O
the	O
for	O
each	O
of	O
v	O
,	O
ci	O
,	O
cj	O
.	O
this	O
determines	O
points	O
on	O
the	O
horizon	O
(	O
see	O
text	O
)	O
ci	O
,	O
cj	O
.	O
corresponding	O
image	O
points	O
x	O
↔	O
x	O
(	O
cid:1	O
)	O
three	O
points	O
on	O
π∞	O
,	O
and	O
hence	O
determines	O
the	O
plane	B
.	O
,	O
with	O
x	O
=	O
x	O
(	O
cid:1	O
)	O
(	O
vii	O
)	O
compute	O
an	O
afﬁne	B
reconstruction	I
.	O
rectify	O
the	O
projective	B
reconstruction	I
using	O
the	O
computed	O
π∞	O
as	O
in	O
algorithm	B
19.2.	O
algorithm	B
19.4.	O
afﬁne	B
calibration	O
for	B
planar	I
motion	I
.	O
metric	B
reconstruction	I
.	O
once	O
the	O
apex	O
and	O
two	O
circular	O
points	O
are	O
found	O
,	O
the	O
plane	O
at	O
inﬁnity	O
is	O
computed	O
,	O
and	O
the	O
inﬁnite	O
homographies	O
between	O
the	O
images	O
can	O
be	O
com-	O
puted	O
.	O
calibration	B
and	O
metric	B
reconstruction	I
now	O
proceeds	O
in	O
the	O
usual	O
way	O
.	O
how-	O
ever	O
,	O
it	O
must	O
be	O
noted	O
that	O
the	O
constrained	O
nature	O
of	O
the	O
motion	O
means	O
that	O
there	O
is	O
a	O
one-parameter	O
family	O
of	O
solutions	O
for	O
the	O
calibration	B
because	O
all	O
the	O
camera	B
rota-	O
tions	O
are	O
about	O
the	O
same	O
axis	O
.	O
we	O
have	O
the	O
sort	O
of	O
calibration	O
ambiguity	B
considered	O
in	O
section	O
19.5.3.	O
it	O
is	O
necessary	O
to	O
make	O
an	O
assumption	O
about	O
internal	B
calibration	O
in	O
order	O
to	O
ﬁnd	O
a	O
unique	O
result	O
.	O
if	O
the	O
y-axis	O
of	O
the	O
camera	O
is	O
parallel	B
with	O
the	O
rotation	B
axis	O
(	O
which	O
may	O
be	O
true	O
in	O
a	O
practical	O
situation	O
)	O
,	O
then	O
we	O
have	O
seen	O
that	O
the	O
zero-skew	O
constraint	O
is	O
not	O
sufﬁcient	O
.	O
the	O
best	O
plan	O
is	O
to	O
enforce	O
a	O
zero-skew	O
and	O
known	O
aspect	O
ratio	O
constraint	O
(	O
e.g	O
.	O
if	O
the	O
pixels	O
are	O
square	O
)	O
.	O
example	O
19.11.	O
metric	B
reconstruction	I
for	O
planar	B
motion	I
.	O
figure	O
19.6	O
(	O
a	O
)	O
shows	O
four	O
of	O
seven	O
images	O
of	O
a	O
planar	O
motion	O
sequence	O
.	O
for	O
this	O
se-	O
quence	O
the	O
elevation	O
angle	B
of	O
the	O
camera	B
is	O
approximately	O
20	O
.	O
the	O
computed	O
im-	O
aged	O
screw	O
axes	O
and	O
horizon	O
lines	B
using	O
all	O
possible	O
pairs	O
are	O
shown	O
in	O
ﬁgure	O
19.6	O
(	O
b	O
)	O
,	O
with	O
the	O
resulting	O
estimated	O
apex	O
and	O
horizon	O
line	B
.	O
the	O
positions	O
of	O
the	O
imaged	O
cir-	O
cular	O
points	O
were	O
estimated	O
as	O
x	O
=	O
104	O
±	O
362i	O
,	O
y	O
=	O
−86	O
∓	O
2i	O
.	O
assuming	O
an	O
as-	O
pect	O
ratio	O
of	O
1.1	O
,	O
the	O
internal	B
parameters	I
of	O
the	O
calibration	B
matrix	I
k	O
were	O
computed	O
as	O
αx	O
=	O
330	O
,	O
αy	O
=	O
363	O
,	O
x0	O
=	O
123	O
,	O
y0	O
=	O
50.	O
the	O
accuracy	O
of	O
the	O
metric	O
recon-	O
struction	O
was	O
assessed	O
by	O
measuring	O
metric	B
invariants	O
.	O
typical	O
results	O
are	O
shown	O
in	O
(	O
cid:2	O
)	O
ﬁgure	O
19.6	O
(	O
c	O
)	O
.	O
◦	O
490	O
19	O
auto-calibration	B
a	O
5000	O
4000	O
3000	O
2000	O
1000	O
0	O
−1000	O
−2000	O
−3000	O
−4000	O
)	O
s	O
l	O
e	O
x	O
i	O
p	O
(	O
−5000	O
−5000	O
0	O
(	O
pixels	O
)	O
b	O
5000	O
c	O
fig	O
.	O
19.6.	O
planar	B
motion	I
sequence	O
.	O
(	O
a	O
)	O
four	O
images	O
(	O
of	O
seven	O
used	O
)	O
acquired	O
from	O
a	O
camera	B
mounted	O
on	O
a	O
vehicle	O
moving	B
on	O
a	O
plane	B
.	O
(	O
b	O
)	O
the	O
computed	O
epipoles	O
(	O
×	O
)	O
,	O
horizon	O
lines	B
(	O
grey	O
solid	O
)	O
,	O
and	O
imaged	O
screw	O
axes	O
(	O
grey	O
dashed	O
)	O
for	O
all	O
image	O
pairs	O
.	O
(	O
c	O
)	O
euclidean	O
invariants	O
measured	O
in	O
the	O
metric	B
recon-	O
struction	O
the	O
right	O
angle	B
is	O
measured	O
as	O
89◦	O
,	O
the	O
ratio	O
of	O
the	O
non-parallel	O
lengths	O
is	O
measured	O
as	O
0.61	O
(	O
compared	O
to	O
the	O
approximate	O
veridical	O
value	O
of	O
0.65	O
)	O
.	O
19.9	O
single	O
axis	O
rotation	B
–	O
turntable	O
motion	O
in	O
this	O
section	O
we	O
discuss	O
auto-calibration	B
of	O
single	O
axis	O
motions	O
where	O
the	O
relative	O
motion	O
between	O
scene	O
and	O
cameras	B
is	O
equivalent	B
to	O
a	O
rotation	B
about	O
a	O
single	O
ﬁxed	O
axis	O
.	O
this	O
is	O
a	O
specialization	O
of	O
the	O
planar	O
motion	O
case	O
of	O
section	O
19.8	O
where	O
here	O
the	O
screw	O
axes	O
for	O
each	O
motion	O
are	O
coincident	O
.	O
this	O
situation	O
occurs	O
,	O
for	O
example	O
,	O
in	O
the	O
case	O
of	O
a	O
static	O
camera	B
viewing	O
an	O
object	O
rotating	O
on	O
a	O
turntable	O
.	O
a	O
second	O
example	O
is	O
that	O
of	O
a	O
camera	O
rotating	O
about	O
a	O
ﬁxed	O
axis	O
(	O
offset	O
from	O
its	O
centre	B
)	O
.	O
a	O
third	O
example	O
is	O
that	O
of	O
a	O
camera	O
viewing	O
a	O
rotating	O
mirror	O
.	O
we	O
will	O
consider	O
here	O
turntable	O
motion	O
and	O
for	O
ease	O
of	O
discussion	O
assume	O
that	O
the	O
axis	O
is	O
vertical	O
so	O
that	O
the	O
motion	O
occurs	O
in	O
a	O
horizontal	O
plane	B
.	O
again	O
it	O
is	O
not	O
assumed	O
that	O
the	O
camera	B
is	O
pointing	O
horizontally	O
,	O
or	O
is	O
in	O
any	O
other	O
particular	O
orientation	B
with	O
respect	O
to	O
the	O
axis	O
.	O
it	O
is	O
assumed	O
that	O
the	O
internal	B
calibration	O
of	O
the	O
camera	O
is	O
constant	O
.	O
the	O
ﬁxed	B
image	I
points	I
under	O
a	O
sequence	O
of	O
single	O
axis	O
rotation	O
are	O
those	O
of	O
planar	O
motion	O
described	O
in	O
section	O
19.8	O
,	O
and	O
shown	O
in	O
ﬁgure	O
19.5	O
(	O
a	O
)	O
,	O
with	O
the	O
addition	O
that	O
the	O
imaged	O
screw	B
axis	I
is	O
a	O
line	B
of	O
ﬁxed	B
points	I
.	O
the	O
constraint	O
of	O
ﬁgure	O
19.5	O
(	O
b	O
)	O
is	O
not	O
available	O
here	O
as	O
all	O
the	O
imaged	O
screw	O
axes	O
are	O
coincident	O
.	O
the	O
consequence	O
is	O
that	O
it	O
is	O
not	O
possible	O
to	O
determine	O
the	O
apex	O
v	O
directly	O
,	O
and	O
only	O
the	O
two	O
circular	O
points	O
on	O
π∞	O
may	O
be	O
recovered	O
from	O
imaged	O
ﬁxed	B
points	I
.	O
this	O
means	O
that	O
the	O
reconstruction	B
,	O
in	O
the	O
absence	O
of	O
constraints	O
on	O
the	O
internal	B
parameters	I
,	O
is	O
not	O
afﬁne	B
,	O
but	O
a	O
particular	O
19.9	O
single	O
axis	O
rotation	B
–	O
turntable	O
motion	O
491	O
parametrized	O
projective	B
transformation	I
.	O
metric	B
structure	I
is	O
known	O
in	O
the	O
horizontal	O
planes	O
(	O
since	O
the	O
circular	B
points	I
of	O
these	O
planes	O
is	O
known	O
)	O
but	O
there	O
is	O
a	O
1d	O
projective	B
transformation	I
in	O
the	O
vertical	O
(	O
z	O
)	O
direction	O
.	O
the	O
resulting	O
ambiguity	B
is	O
the	O
transforma-	O
tion	O
xp	O
=	O
hxe	O
where	O
	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
γ	O
0	O
0	O
0	O
δ	O
1	O
	O
h	O
=	O
(	O
19.30	O
)	O
and	O
γ	O
and	O
δ	O
are	O
scalars	O
which	O
determine	O
the	O
intersection	B
of	O
the	O
z	O
axis	O
with	O
π∞	O
and	O
the	O
relative	O
scaling	B
between	O
the	O
horizontal	O
and	O
vertical	O
directions	O
.	O
an	O
example	O
of	O
the	O
projective	O
transformations	O
represented	O
by	O
family	O
of	O
mappings	O
is	O
shown	O
in	O
ﬁgure	O
1.4-	O
(	O
p16	O
)	O
.	O
computing	B
the	O
ﬁxed	B
points	I
.	O
one	O
way	O
to	O
proceed	O
is	O
to	O
determine	O
the	O
imaged	O
circular	B
points	I
directly	O
.	O
as	O
is	O
evident	O
from	O
ﬁgure	O
19.7	O
(	O
b	O
)	O
the	O
point	B
tracks	O
are	O
ellipses	O
which	O
are	O
images	O
of	O
circles	O
.	O
in	O
3-space	O
these	O
circles	O
lie	O
in	O
parallel	O
horizontal	O
planes	O
and	O
intersect	O
in	O
the	O
circular	B
points	I
on	O
π∞	O
.	O
in	O
the	O
image	O
,	O
ellipses	O
may	O
be	O
ﬁtted	O
to	O
these	O
tracks	O
,	O
and	O
the	O
common	O
intersection	B
points	O
of	O
the	O
image	O
conics	O
are	O
the	O
(	O
complex	O
conjugate	O
)	O
imaged	O
circular	B
points	I
.	O
the	O
3d	O
circular	B
points	I
may	O
then	O
be	O
determined	O
by	O
triangulation	B
from	O
two	O
or	O
more	O
views	O
.	O
this	O
is	O
the	O
approach	O
taken	O
by	O
[	O
jiang-02	O
]	O
.	O
an	O
alternative	O
more	O
algebraic	O
way	O
to	O
proceed	O
is	O
to	O
model	O
the	O
camera	B
matrices	I
as	O
pi	O
=	O
h3×3	O
[	O
rz	O
(	O
θi	O
)	O
|	O
t	O
]	O
where	O
	O
h1	O
h2	O
h3	O
	O
	O
cos	O
θi	O
sin	O
θi	O
pi	O
=	O
−	O
sin	O
θi	O
cos	O
θi	O
0	O
0	O
0	O
0	O
1	O
t	O
0	O
0	O
	O
(	O
19.31	O
)	O
with	O
hk	O
the	O
columns	O
of	O
h3×3	O
.	O
this	O
division	O
of	O
the	O
internal	O
and	O
external	O
parameters	B
means	O
that	O
h3×3	O
and	O
t	O
are	O
ﬁxed	O
over	O
the	O
sequence	O
,	O
and	O
only	O
the	O
angle	B
of	O
rotation	B
,	O
θi	O
,	O
about	O
the	O
z	O
axis	O
varies	O
for	O
each	O
camera	B
pi	O
.	O
given	O
this	O
parametrization	B
,	O
the	O
estimation	B
problem	I
can	O
then	O
be	O
precisely	O
stated	O
as	O
determining	O
the	O
common	O
matrix	B
h3×3	O
and	O
the	O
angles	O
θi	O
in	O
order	O
to	O
estimate	O
the	O
set	O
of	O
cameras	O
pi	O
for	O
the	O
sequence	O
.	O
thus	O
a	O
total	O
of	O
8	O
+	O
m	O
parameters	B
must	O
be	O
estimated	O
for	O
m	O
views	O
,	O
where	O
8	O
is	O
the	O
number	O
of	O
degrees	O
of	O
freedom	O
of	O
the	O
homography	O
h3×3	O
.	O
this	O
is	O
a	O
considerable	O
saving	O
over	O
the	O
11m	O
that	O
would	O
be	O
required	O
for	O
a	O
projective	O
reconstruction	B
of	O
a	O
general	B
motion	I
sequence	O
.	O
for	O
single	O
axis	O
motion	O
the	O
fundamental	B
matrix	I
has	O
the	O
special	O
form	O
described	O
in	O
section	O
9.4.1	O
(	O
p252	O
)	O
,	O
and	O
writing	O
the	O
matrix	B
in	O
terms	O
of	O
the	O
camera	O
matrices	O
(	O
19.31	O
)	O
gives	O
f	O
=	O
α	O
[	O
h2	O
]	O
×	O
+	O
β	O
(	O
h1	O
×	O
h3	O
)	O
(	O
h1	O
×	O
h2	O
)	O
t	O
+	O
(	O
h1	O
×	O
h2	O
)	O
(	O
h1	O
×	O
h3	O
)	O
t	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
which	O
means	O
that	O
the	O
columns	O
of	O
h3×3	O
are	O
partially	O
determined	O
once	O
the	O
fundamental	B
matrix	I
is	O
computed	O
.	O
this	O
is	O
the	O
approach	O
taken	O
by	O
[	O
fitzgibbon-98b	O
]	O
where	O
a	O
funda-	O
mental	O
matrix	B
of	O
the	O
special	O
form	O
is	O
ﬁtted	O
to	O
point	O
correspondences	B
(	O
see	O
section	O
11.7.2-	O
(	O
p293	O
)	O
)	O
.	O
it	O
may	O
be	O
shown	O
that	O
from	O
3	O
or	O
more	O
views	O
the	O
ﬁrst	O
two	O
columns	O
h1	O
,	O
h2	O
of	O
492	O
19	O
auto-calibration	B
a	O
b	O
e	O
m	O
a	O
r	O
f	O
20	O
40	O
60	O
500	O
1000	O
1500	O
c	O
2000	O
2500	O
3000	O
fig	O
.	O
19.7.	O
dinosaur	O
sequence	O
and	O
tracking	O
:	O
(	O
a	O
)	O
six	O
frames	O
from	O
a	O
sequence	O
of	O
36	O
of	O
a	O
dinosaur	O
rotating	O
on	O
a	O
turntable	O
(	O
image	O
sequence	O
courtesy	O
of	O
the	O
university	O
of	O
hannover	O
[	O
niem-94	O
]	O
)	O
.	O
(	O
b	O
)	O
a	O
subset	O
of	O
the	O
point	O
tracks	O
–	O
only	O
the	O
200	O
tracks	O
which	O
survived	O
for	O
longer	O
than	O
7	O
successive	O
views	O
are	O
shown	O
.	O
(	O
c	O
)	O
track	O
lifetimes	O
:	O
each	O
vertical	O
bar	O
corresponds	O
to	O
a	O
single	O
point	O
track	O
,	O
extending	O
from	O
the	O
ﬁrst	O
to	O
last	O
frame	O
in	O
which	O
that	O
point	B
was	O
seen	O
.	O
the	O
horizontal	O
ordering	O
is	O
according	O
to	O
where	O
the	O
point	B
ﬁrst	O
appeared	O
in	O
the	O
sequence	O
.	O
the	O
measurement	B
matrix	I
is	O
relatively	O
sparse	B
,	O
and	O
few	O
points	O
survive	O
longer	O
than	O
15	O
frames	O
.	O
h3×3	O
and	O
the	O
angle	B
θi	O
can	O
be	O
fully	O
determined	O
,	O
but	O
h3	O
is	O
only	O
determined	O
up	O
to	O
the	O
two-parameter	O
family	O
corresponding	O
to	O
the	O
ambiguity	B
of	O
(	O
19.30	O
)	O
.	O
metric	B
reconstruction	I
.	O
the	O
two	O
parameter	O
ambiguity	B
in	O
the	O
reconstruction	B
given	O
by	O
(	O
19.30	O
)	O
can	O
be	O
resolved	O
by	O
providing	O
additional	O
information	O
on	O
the	O
internal	B
parameters	I
,	O
for	O
example	O
that	O
the	O
pixels	O
are	O
square	O
.	O
however	O
,	O
if	O
the	O
camera	B
is	O
horizontal	O
with	O
im-	O
age	O
y	O
axis	O
parallel	O
to	O
the	O
rotation	B
axis	O
,	O
then	O
square	O
pixels	O
only	O
provides	O
one	O
additional	O
constraint	O
(	O
from	O
the	O
aspect	O
ratio	O
,	O
as	O
the	O
skew	O
zero	O
constraint	O
does	O
not	O
provide	O
an	O
addi-	O
tional	O
constraint	O
)	O
.	O
in	O
this	O
case	O
further	O
information	O
on	O
the	O
camera	B
is	O
required	O
(	O
e.g	O
.	O
the	O
y	O
coordinate	O
of	O
the	O
principal	B
point	I
)	O
or	O
the	O
aspect	O
ratio	O
of	O
the	O
scene	O
may	O
be	O
used	O
.	O
example	O
19.12.	O
reconstruction	B
from	O
a	O
turntable	O
sequence	O
figure	O
19.7	O
shows	O
frames	O
from	O
a	O
sequence	O
of	O
a	O
model	O
dinosaur	O
rotating	O
on	O
a	O
turntable	O
,	O
and	O
the	O
resulting	O
image	O
point	O
tracks	O
.	O
feature	O
extraction	O
is	O
performed	O
on	O
the	O
luminance	O
component	O
of	O
the	O
colour	O
signal	O
.	O
the	O
projective	B
geometry	O
of	O
the	O
turntable	O
motion	O
is	O
de-	O
19.10	O
auto-calibration	B
of	O
a	O
stereo	O
rig	O
493	O
a	O
b	O
fig	O
.	O
19.8.	O
dinosaur	O
:	O
(	O
a	O
)	O
3d	O
scene	O
points	O
(	O
about	O
5000	O
)	O
and	O
camera	B
positions	O
for	O
the	O
dinosaur	O
se-	O
quence	O
.	O
(	O
b	O
)	O
the	O
automatic	O
computation	B
of	I
a	O
3d	O
graphical	O
model	B
for	O
this	O
sequence	O
is	O
described	O
in	O
[	O
fitzgibbon-98b	O
]	O
.	O
termined	O
from	O
these	O
tracks	O
(	O
and	O
no	O
other	O
information	O
)	O
and	O
the	O
resulting	O
reconstruction	B
of	O
cameras	B
and	O
3d	O
points	O
is	O
shown	O
in	O
ﬁgure	O
19.8.	O
effectively	O
the	O
camera	B
circumnav-	O
igates	O
the	O
object	O
.	O
a	O
3d	O
texture	O
mapped	O
graphical	O
model	B
may	O
then	O
be	O
computed	O
,	O
in	O
principle	O
,	O
by	O
back-projecting	O
cones	O
deﬁned	O
by	O
the	O
dinosaur	O
silhouette	O
in	O
each	O
frame	O
,	O
(	O
cid:2	O
)	O
and	O
intersecting	O
the	O
set	O
of	O
cones	O
to	O
determine	O
the	O
visual	O
hull	O
of	O
the	O
3d	O
object	O
.	O
19.10	O
auto-calibration	B
of	O
a	O
stereo	O
rig	O
in	O
this	O
section	O
we	O
describe	O
a	O
stratiﬁed	O
method	O
for	O
calibrating	O
a	O
“	O
ﬁxed	O
”	O
two-camera	O
stereo	O
rig	O
.	O
fixed	O
here	O
means	O
that	O
the	O
relative	O
orientation	B
of	O
the	O
cameras	B
on	O
the	O
rig	O
is	O
unchanged	O
during	O
the	O
motion	O
,	O
and	O
the	O
internal	B
parameters	I
of	O
each	O
camera	B
are	O
also	O
494	O
19	O
auto-calibration	B
unchanged	O
.	O
it	O
will	O
be	O
shown	O
that	O
from	O
a	O
single	O
motion	O
of	O
the	O
rig	O
the	O
plane	O
at	O
inﬁnity	O
is	O
determined	O
uniquely	O
.	O
suppose	O
a	O
ﬁxed	O
stereo	O
rig	O
undergoes	O
a	O
general	B
motion	I
.	O
the	O
projective	B
structure	O
of	O
the	O
scene	O
can	O
be	O
obtained	O
before	O
(	O
x	O
)	O
and	O
after	O
(	O
x	O
(	O
cid:2	O
)	O
are	O
two	O
projective	O
reconstructions	O
of	O
the	O
same	O
scene	O
they	O
are	O
related	O
by	O
a	O
4	O
×	O
4	O
projective	B
transformation	I
hp	O
,	O
as	O
)	O
the	O
motion	O
.	O
since	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
=	O
hpx	O
.	O
however	O
,	O
the	O
actual	O
motion	O
of	O
the	O
rig	O
is	O
euclidean	O
,	O
and	O
it	O
follows	O
(	O
see	O
below	O
)	O
that	O
the	O
homography	B
hp	O
is	O
conjugate	O
to	O
the	O
euclidean	O
transformation	O
representing	O
the	O
mo-	O
tion	O
.	O
conjugacy	B
is	O
the	O
key	O
result	O
because	O
under	O
a	O
conjugacy	B
relation	I
ﬁxed	O
entities	O
are	O
mapped	O
to	O
ﬁxed	O
entities	O
.	O
consequently	O
the	O
ﬁxed	O
entities	O
of	O
the	O
euclidean	O
motion	O
(	O
in	O
particular	O
the	O
plane	O
at	O
inﬁnity	O
)	O
can	O
be	O
accessed	O
from	O
the	O
ﬁxed	O
entities	O
of	O
the	O
projective	O
motion	O
represented	O
by	O
hp	O
.	O
conjugacy	B
relation	I
.	O
suppose	O
xe	O
represents	O
a	O
point	B
in	O
3-space	O
in	O
a	O
euclidean	O
coor-	O
dinate	O
frame	O
attached	O
to	O
the	O
rig	O
,	O
and	O
x	O
(	O
cid:2	O
)	O
e	O
represents	O
the	O
same	O
point	O
after	O
the	O
motion	O
of	O
the	O
rig	O
.	O
then	O
the	O
points	O
are	O
related	O
as	O
x	O
(	O
cid:2	O
)	O
e	O
=	O
hexe	O
(	O
19.32	O
)	O
where	O
he	O
is	O
a	O
non-singular	O
4	O
×	O
4	O
euclidean	O
transformation	O
matrix	B
that	O
represents	O
the	O
rotation	B
and	I
translation	I
of	O
the	O
rig	O
.	O
suppose	O
also	O
that	O
the	O
point	B
is	O
represented	O
in	O
a	O
pro-	O
jective	O
coordinate	O
frame	O
attached	O
to	O
the	O
rig	O
(	O
and	O
which	O
is	O
obtained	O
by	O
a	O
projective	B
reconstruction	I
)	O
;	O
then	O
xe	O
=	O
hepx	O
x	O
(	O
cid:2	O
)	O
e	O
=	O
hepx	O
(	O
cid:2	O
)	O
(	O
19.33	O
)	O
where	O
hep	O
is	O
a	O
non-singular	O
4	O
×	O
4	O
matrix	B
that	O
relates	O
projective	B
to	O
metric	B
structure	I
.	O
an	O
essential	O
point	O
to	O
note	O
here	O
is	O
that	O
the	O
two	O
projective	O
reconstructions	O
,	O
before	O
and	O
after	O
the	O
camera	B
must	O
be	O
in	O
the	O
same	O
projective	O
coordinate	O
frame	O
,	O
in	O
other	O
words	O
,	O
the	O
same	O
pair	O
of	O
cameras	O
matrices	O
must	O
be	O
used	O
before	O
and	O
after	O
.	O
from	O
(	O
19.32	O
)	O
and	O
(	O
19.33	O
)	O
if	O
follows	O
that	O
hp	O
=	O
h−1	O
ep	O
he	O
hep	O
(	O
19.34	O
)	O
so	O
that	O
hp	O
is	O
conjugate	O
to	O
a	O
euclidean	O
transformation	O
.	O
there	O
are	O
two	O
important	O
proper-	O
ties	O
of	O
this	O
conjugacy	B
relation	I
:	O
(	O
i	O
)	O
hp	O
and	O
he	O
have	O
the	O
same	O
eigenvalues	O
.	O
(	O
ii	O
)	O
if	O
e	O
is	O
an	O
eigenvector	O
of	O
he	O
then	O
the	O
corresponding	O
eigenvector	O
of	O
hp	O
,	O
with	O
the	O
same	O
eigenvalue	O
,	O
is	O
(	O
h−1	O
ep	O
e	O
)	O
,	O
i.e	O
.	O
the	O
eigenvectors	O
of	O
he	O
are	O
mapped	O
to	O
the	O
eigen-	O
vectors	O
of	O
hp	O
by	O
the	O
point	B
transformation	O
(	O
19.33	O
)	O
.	O
this	O
follows	O
from	O
(	O
19.34	O
)	O
,	O
for	O
if	O
hee	O
=	O
λe	O
then	O
hephph−1	O
ep	O
gives	O
the	O
desired	O
result	O
.	O
ep	O
e	O
=	O
λe	O
,	O
and	O
pre-multiplying	O
by	O
h−1	O
19.10	O
auto-calibration	B
of	O
a	O
stereo	O
rig	O
495	O
fixed	O
points	O
of	O
a	O
euclidean	O
transformation	O
.	O
consider	O
the	O
euclidean	O
transformation	O
represented	O
by	O
the	O
matrix	B
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
he	O
=	O
t	O
r	O
0t	O
1	O
=	O
	O
cos	O
θ	O
−	O
sin	O
θ	O
0	O
0	O
cos	O
θ	O
sin	O
θ	O
	O
.	O
0	O
0	O
0	O
0	O
0	O
0	O
1	O
1	O
0	O
1	O
this	O
is	O
a	O
rotation	B
by	O
θ	O
about	O
the	O
z-axis	O
together	O
with	O
a	O
unit	O
translation	O
along	O
the	O
z-	O
axis	O
(	O
it	O
is	O
a	O
general	O
screw	O
motion	O
)	O
.	O
the	O
eigenvectors	O
of	O
he	O
are	O
the	O
ﬁxed	B
points	I
un-	O
der	O
the	O
transformation	B
(	O
refer	O
to	O
section	O
2.9	O
(	O
p61	O
)	O
)	O
.	O
in	O
this	O
case	O
the	O
eigenvalues	O
are	O
{	O
eiθ	O
,	O
e	O
−iθ	O
,	O
1	O
,	O
1	O
}	O
and	O
the	O
corresponding	O
eigenvectors	O
of	O
he	O
are	O
	O
1	O
i	O
0	O
0	O
e1	O
=	O
	O
e2	O
=	O
	O
1−i	O
	O
e3	O
=	O
0	O
0	O
	O
0	O
0	O
1	O
0	O
	O
e4	O
=	O
	O
.	O
	O
0	O
0	O
1	O
0	O
all	O
the	O
eigenvectors	O
lie	O
on	O
π∞	O
.	O
this	O
means	O
that	O
π∞	O
is	O
ﬁxed	O
as	O
a	O
set	O
,	O
but	O
is	O
not	O
a	O
plane	B
of	O
ﬁxed	B
points	I
.	O
the	O
eigenvectors	O
e1	O
and	O
e2	O
are	O
the	O
circular	B
points	I
for	O
planes	O
perpendicular	O
to	O
the	O
z	O
(	O
rotation	B
)	O
axis	O
.	O
the	O
other	O
two	O
(	O
identical	O
)	O
eigenvectors	O
e3	O
and	O
e4	O
are	O
the	O
direction	O
of	O
the	O
rotation	O
axis	O
.	O
e	O
e	O
e	O
.	O
the	O
eigenvectors	O
of	O
h−t	O
computing	B
π∞	O
.	O
if	O
the	O
point	B
transformation	O
matrix	B
is	O
he	O
then	O
from	O
(	O
3.6–p68	O
)	O
the	O
plane	B
transformation	O
matrix	B
is	O
h−t	O
are	O
the	O
ﬁxed	O
planes	O
under	O
the	O
motion	O
.	O
the	O
matrix	B
h−t	O
also	O
has	O
two	O
equal	O
,	O
unit	O
eigenvalues	O
and	O
a	O
single	O
eigen-	O
vector	O
corresponding	O
to	O
these	O
which	O
is	O
the	O
plane	B
π∞	O
as	O
may	O
easily	O
be	O
veriﬁed	O
.	O
the	O
eigenvectors	O
of	O
h−t	O
p	O
,	O
in	O
the	O
same	O
manner	O
as	O
the	O
mapping	O
of	O
eigenvectors	O
of	O
he	O
to	O
those	O
of	O
hp	O
described	O
above	O
.	O
consequently	O
,	O
π∞	O
in	O
the	O
projective	B
reconstruction	I
is	O
the	O
eigenvector	O
corresponding	O
to	O
the	O
(	O
double	O
)	O
real	O
eigenvalue	O
of	O
h−t	O
p	O
.	O
thus	O
,	O
•	O
π∞	O
may	O
be	O
computed	O
uniquely	O
as	O
the	O
real	O
eigenvector	O
of	O
h−t	O
more	O
simply	O
,	O
as	O
the	O
real	O
eigenvector	O
of	O
ht	O
p	O
.	O
are	O
mapped	O
to	O
those	O
of	O
h−t	O
p	O
,	O
or	O
equivalently	O
,	O
and	O
e	O
we	O
observe	O
here	O
that	O
although	O
the	O
real	O
eigenvalue	O
has	O
algebraic	B
multiplicity	O
of	O
two	O
,	O
its	O
geometric	B
multiplicity	O
(	O
in	O
the	O
case	O
of	O
non-planar	O
motions	O
)	O
is	O
one	O
.	O
this	O
is	O
what	O
enables	O
us	O
to	O
ﬁnd	O
the	O
plane	O
at	O
inﬁnity	O
.	O
the	O
procedure	O
for	O
afﬁne	O
calibration	O
is	O
summarized	O
in	O
algorithm	O
19.5.	O
metric	B
calibration	I
and	O
ambiguities	B
.	O
once	O
π∞	O
is	O
identiﬁed	O
,	O
the	O
metric	B
calibration	I
may	O
proceed	O
as	O
described	O
in	O
the	O
stratiﬁed	O
algorithm	O
19.2	O
(	O
p479	O
)	O
.	O
since	O
the	O
rig	O
is	O
ﬁxed	O
,	O
the	O
parameters	B
of	O
the	O
left	O
camera	B
are	O
unchanged	O
during	O
the	O
motion	O
(	O
and	O
similarly	O
for	O
the	O
right	O
camera	B
)	O
.	O
from	O
a	O
single	O
motion	O
the	O
internal	B
parameters	I
of	O
each	O
camera	B
are	O
determined	O
up	O
to	O
the	O
one-parameter	O
family	O
resulting	O
from	O
a	O
single	O
rotation	O
as	O
described	O
in	O
section	O
19.5.3.	O
as	O
usual	O
the	O
ambiguity	B
from	O
a	O
single	O
motion	O
is	O
removed	O
by	O
additional	O
motions	O
or	O
496	O
objective	O
19	O
auto-calibration	B
given	O
two	O
(	O
or	O
more	O
)	O
stereo	O
pairs	O
of	O
images	O
acquired	O
by	O
a	O
ﬁxed	O
stereo	O
rig	O
undergoing	O
general	O
motions	O
(	O
i.e	O
.	O
both	O
r	O
and	O
t	O
are	O
non-zero	O
,	O
and	O
t	O
not	O
perpendicular	O
to	O
the	O
axis	O
of	O
r	O
)	O
,	O
compute	O
an	O
afﬁne	B
reconstruction	I
.	O
algorithm	B
(	O
i	O
)	O
compute	O
an	O
initial	O
projective	O
reconstruction	B
x	O
:	O
using	O
the	O
ﬁrst	O
stereo	O
pair	O
compute	O
a	O
projective	B
reconstruction	I
(	O
pl	O
,	O
pr	O
,	O
{	O
xj	O
}	O
)	O
as	O
described	O
in	O
chapter	O
10.	O
this	O
involves	O
com-	O
puting	O
the	O
fundamental	B
matrix	I
f	O
and	O
point	B
correspondences	O
between	O
the	O
images	O
of	O
the	O
ﬁrst	O
pair	O
xl	O
j	O
↔	O
xr	O
j	O
,	O
e.g	O
.	O
use	O
algorithm	O
11.4	O
(	O
p291	O
)	O
.	O
(	O
ii	O
)	O
compute	O
a	O
projective	B
reconstruction	I
x	O
(	O
cid:1	O
)	O
after	O
the	O
motion	O
:	O
compute	O
correspondences	B
j	O
↔	O
x	O
(	O
cid:1	O
)	O
r	O
(	O
cid:1	O
)	O
l	O
between	O
the	O
images	O
of	O
the	O
second	O
stereo	O
pair	O
x	O
j	O
.	O
since	O
both	O
the	O
internal	B
and	O
relative	O
external	O
parameters	B
of	O
the	O
cameras	B
are	O
ﬁxed	O
,	O
the	O
second	O
stereo	O
pair	O
has	O
the	O
same	O
fundamental	O
matrix	B
f	O
as	O
the	O
ﬁrst	O
.	O
the	O
same	O
camera	O
matrices	O
pl	O
,	O
pr	O
are	O
used	O
for	O
triangu-	O
lating	O
points	O
x	O
(	O
cid:1	O
)	O
in	O
the	O
second	O
stereo	O
pair	O
.	O
j	O
in	O
3-space	O
from	O
the	O
computed	O
correspondences	O
x	O
j	O
↔	O
x	O
(	O
cid:1	O
)	O
l	O
(	O
cid:1	O
)	O
r	O
j	O
:	O
compute	O
correspondences	B
between	O
j	O
↔	O
x	O
(	O
cid:1	O
)	O
l	O
the	O
left	O
images	O
of	O
the	O
two	O
stereo	O
pairs	O
xl	O
j	O
(	O
e.g	O
.	O
again	O
use	O
algorithm	O
11.4	O
(	O
p291	O
)	O
)	O
.	O
this	O
establishes	O
correspondences	B
between	O
the	O
space	O
points	O
xj	O
↔	O
x	O
(	O
cid:1	O
)	O
j.	O
the	O
homography	B
hp	O
may	O
be	O
estimated	O
linearly	O
from	O
ﬁve	O
or	O
more	O
of	O
these	O
3-space	O
point	B
correspondences	O
,	O
and	O
then	O
the	O
estimate	O
reﬁned	O
by	O
minimizing	B
a	O
suitable	O
cost	B
function	I
over	O
hp	O
.	O
for	O
example	O
,	O
j	O
)	O
2	O
)	O
minimizes	O
the	O
distance	B
between	O
the	O
j	O
)	O
2	O
+	O
d	O
(	O
xr	O
minimizing	B
measured	O
and	O
reprojected	O
image	O
points	O
.	O
j	O
,	O
prhx	O
(	O
cid:1	O
)	O
j	O
,	O
plhx	O
(	O
cid:1	O
)	O
(	O
cid:27	O
)	O
j	O
(	O
d	O
(	O
xl	O
(	O
iii	O
)	O
compute	O
the	O
4×4	O
matrix	B
hp	O
which	O
relates	O
x	O
to	O
x	O
(	O
cid:1	O
)	O
(	O
iv	O
)	O
afﬁne	B
reconstruction	I
:	O
compute	O
π∞	O
from	O
the	O
real	O
eigenvector	O
of	O
ht	O
p	O
and	O
thence	O
an	O
afﬁne	B
reconstruction	I
.	O
algorithm	B
19.5.	O
afﬁne	B
calibration	O
of	O
a	O
ﬁxed	O
stereo	O
rig	O
.	O
by	O
supplying	O
additional	O
constraints	B
,	O
such	O
as	O
that	O
the	O
pixels	O
are	O
square	O
.	O
if	O
there	O
are	O
additional	O
motions	O
then	O
an	O
improved	O
estimate	O
of	O
π∞	O
may	O
also	O
be	O
computed	O
.	O
the	O
outcome	O
of	O
metric	O
calibration	B
is	O
the	O
complete	O
calibration	B
of	O
the	O
rig	O
(	O
i.e	O
.	O
the	O
relative	O
external	O
orientation	B
of	O
the	O
cameras	B
and	O
their	O
internal	B
parameters	I
)	O
.	O
planar	B
motion	I
.	O
in	O
the	O
special	O
case	O
of	O
orthogonal	O
(	O
planar	O
)	O
motion	O
,	O
where	O
the	O
transla-	O
tion	O
is	O
orthogonal	B
to	O
the	O
rotation	B
axis	O
direction	O
,	O
the	O
space	O
of	O
eigenvectors	O
corresponding	O
to	O
the	O
repeated	O
(	O
real	O
)	O
eigenvalue	O
is	O
two-dimensional	B
.	O
consequently	O
,	O
π∞	O
is	O
determined	O
only	O
up	O
to	O
a	O
one-parameter	O
family	O
.	O
we	O
are	O
therefore	O
unable	O
to	O
ﬁnd	O
the	O
plane	O
at	O
inﬁnity	O
uniquely	O
(	O
this	O
is	O
examined	O
in	O
detail	O
in	O
example	O
3.8	O
(	O
p81	O
)	O
)	O
.	O
the	O
ambiguity	B
may	O
be	O
re-	O
solved	O
by	O
a	O
second	O
orthogonal	B
motion	O
about	O
an	O
axis	O
with	O
a	O
different	O
direction	O
from	O
the	O
ﬁrst	O
.	O
example	O
19.13.	O
auto-calibration	B
from	O
two	O
stereo	O
pairs	O
figure	O
19.9	O
(	O
a	O
)	O
(	O
b	O
)	O
shows	O
the	O
two	O
stereo	O
pairs	O
used	O
for	O
the	O
afﬁne	B
calibration	O
of	O
the	O
stereo	O
rig	O
following	O
the	O
procedure	O
of	O
algorithm	O
19.5.	O
the	O
accuracy	O
of	O
the	O
calibration	O
is	O
as-	O
sessed	O
by	O
computing	O
a	O
vanishing	O
point	B
in	O
the	O
right	O
image	O
in	O
two	O
ways	O
:	O
ﬁrst	O
,	O
as	O
the	O
intersection	B
of	O
imaged	O
parallel	B
lines	I
;	O
second	O
,	O
by	O
determining	O
the	O
corresponding	O
van-	O
ishing	O
point	B
in	O
the	O
left	O
image	O
(	O
from	O
images	O
of	O
the	O
same	O
parallel	B
lines	I
)	O
,	O
and	O
mapping	O
this	O
vanishing	O
point	O
to	O
the	O
right	O
image	O
using	O
the	O
inﬁnite	B
homography	I
computed	O
from	O
19.11	O
closure	O
497	O
a	O
b	O
c	O
d	O
e	O
fig	O
.	O
19.9.	O
auto-calibration	B
of	O
a	O
stereo	O
rig	O
.	O
the	O
input	O
stereo	O
pairs	O
before	O
(	O
a	O
)	O
and	O
after	O
(	O
b	O
)	O
the	O
motion	O
of	O
the	O
rig	O
.	O
the	O
stereo	O
rig	O
moves	O
left	O
by	O
about	O
20	O
cm	O
,	O
pans	O
by	O
about	O
10◦	O
and	O
changes	O
elevation	O
by	O
about	O
10◦	O
.	O
the	O
accuracy	O
of	O
the	O
computed	O
h∞	O
is	O
assessed	O
on	O
another	O
stereo	O
pair	O
acquired	O
by	O
the	O
same	O
rig	O
as	O
follows	O
:	O
in	O
(	O
c	O
)	O
,	O
the	O
left	O
image	O
(	O
of	O
a	O
stereo	O
pair	O
)	O
,	O
a	O
vanishing	O
point	O
is	O
computed	O
by	O
intersecting	O
the	O
imaged	O
sides	O
of	O
the	O
table	O
(	O
which	O
are	O
parallel	B
in	O
the	O
scene	O
)	O
.	O
in	O
(	O
d	O
)	O
,	O
the	O
right	O
image	O
(	O
of	O
a	O
stereo	O
pair	O
)	O
,	O
the	O
corresponding	O
vanishing	O
point	O
is	O
computed	O
.	O
the	O
white	O
square	O
(	O
near	O
the	O
line	B
intersection	O
)	O
is	O
the	O
vanishing	O
point	O
from	O
the	O
left	O
image	O
mapped	O
to	O
the	O
right	O
using	O
the	O
computed	O
h∞	O
.	O
in	O
the	O
absence	O
of	O
error	O
the	O
points	O
should	O
be	O
identical	O
.	O
(	O
e	O
)	O
following	O
metric	B
calibration	I
the	O
computed	O
angle	O
between	O
the	O
desk	O
sides	O
(	O
shown	O
in	O
white	O
)	O
from	O
the	O
3d	O
reconstruction	B
is	O
90.7◦	O
,	O
in	O
very	O
good	O
agreement	O
with	O
the	O
veridical	O
value	O
.	O
the	O
eigenvector	O
of	O
ht	O
p	O
.	O
the	O
discrepancy	O
between	O
the	O
vanishing	B
points	I
is	O
a	O
measure	O
of	O
the	O
accuracy	O
of	O
the	O
computed	O
h∞	O
.	O
the	O
metric	B
calibration	I
uses	O
the	O
zero	B
skew	I
constraint	O
to	O
resolve	O
the	O
one-parameter	O
ambiguity	B
.	O
angles	O
in	O
the	O
resulting	O
metric	B
reconstruction	I
(	O
cid:2	O
)	O
are	O
accurate	O
to	O
within	O
1	O
◦	O
.	O
19.11	O
closure	O
research	O
in	O
the	O
area	O
of	B
auto-calibration	I
is	O
still	O
quite	O
active	O
,	O
and	O
better	O
methods	O
than	O
those	O
described	O
in	O
this	O
chapter	O
may	O
yet	O
be	O
developed	O
.	O
there	O
is	O
still	O
a	O
lack	O
of	O
closed	O
form	O
solutions	O
from	O
multiview	O
tensors	O
,	O
and	O
of	O
algorithms	O
to	O
automatically	O
detect	O
critical	B
motion	I
sequences	I
(	O
see	O
below	O
)	O
.	O
critical	B
motion	I
sequences	I
.	O
it	O
has	O
been	O
seen	O
in	O
this	O
chapter	O
that	O
for	O
certain	O
classes	O
of	O
motion	O
it	O
is	O
not	O
possible	O
to	O
completely	O
determine	O
the	O
rectifying	B
homography	I
h.	O
the	O
resulting	O
reconstruction	B
is	O
then	O
at	O
some	O
level	O
between	O
metric	O
and	O
projective	B
.	O
for	O
ex-	O
ample	O
,	O
for	O
constant	O
internal	B
parameters	I
in	O
the	O
case	O
of	O
planar	O
motion	O
there	O
is	O
a	O
one-	O
parameter	O
scaling	O
ambiguity	B
parallel	O
to	O
the	O
rotation	B
axis	O
;	O
and	O
for	O
pure	O
translation	O
under	O
constant	B
internal	I
parameters	O
the	O
reconstruction	B
is	O
afﬁne	B
.	O
sequences	O
of	B
camera	I
motions	O
for	O
which	O
such	O
ambiguities	B
arise	O
are	O
termed	O
“	O
critical	B
motion	I
sequences	I
”	O
and	O
have	O
been	O
systematically	O
classiﬁed	O
by	O
sturm	O
[	O
sturm-97a	O
,	O
sturm-97b	O
]	O
in	O
the	O
case	O
of	O
constant	O
in-	O
ternal	O
parameters	B
.	O
this	O
classiﬁcation	B
has	O
been	O
extended	O
to	O
more	O
general	O
calibration	O
constraints	B
,	O
such	O
as	O
varying	O
focal	O
lengths	O
[	O
pollefeys-99b	O
,	O
sturm-99b	O
]	O
.	O
for	O
recent	O
work	O
see	O
[	O
kahl-99	O
,	O
kahl-01b	O
,	O
ma-99	O
,	O
sturm-01	O
]	O
.	O
498	O
19	O
auto-calibration	B
recommendations	O
.	O
it	O
may	O
seem	O
that	O
auto-calibration	B
offers	O
a	O
complete	O
solution	B
to	O
metric	B
reconstruction	I
.	O
calibrated	B
cameras	O
are	O
not	O
necessary	O
and	O
we	O
can	O
do	O
with	O
con-	O
straints	O
as	O
weak	O
as	O
the	O
zero-skew	O
constraint	O
on	O
the	O
camera	B
.	O
unfortunately	O
one	O
must	O
be	O
wary	O
of	O
putting	O
complete	O
trust	O
in	O
auto-calibration	O
.	O
auto-calibration	B
can	O
work	O
well	O
in	O
the	O
right	O
circumstances	O
,	O
but	O
used	O
recklessly	O
it	O
will	O
fail	O
.	O
several	O
speciﬁc	O
recommenda-	O
tions	O
can	O
be	O
made	O
.	O
(	O
i	O
)	O
take	O
care	O
to	O
avoid	O
ambiguous	O
motion	O
sequences	O
.	O
it	O
has	O
been	O
seen	O
that	O
calibra-	O
tion	O
degeneracies	B
occur	O
if	O
the	O
motion	O
is	O
too	O
restricted	O
,	O
such	O
as	O
being	O
about	O
a	O
single	O
axis	O
.	O
the	O
motion	O
should	O
not	O
be	O
too	O
small	O
,	O
or	O
cover	O
too	O
small	O
a	O
ﬁeld	O
of	O
view	O
.	O
auto-calibration	B
often	O
comes	O
down	O
to	O
estimating	O
the	O
inﬁnite	O
homogra-	O
phy	O
,	O
the	O
effects	O
of	O
which	O
are	O
not	O
apparent	B
on	O
small	O
ﬁelds	O
of	O
view	O
.	O
(	O
ii	O
)	O
use	O
as	O
much	O
information	O
as	O
you	O
have	O
.	O
although	O
it	O
is	O
possible	O
to	O
calibrate	O
from	O
minimal	O
information	O
such	O
as	O
zero	O
skew	O
,	O
this	O
should	O
be	O
avoided	O
if	O
other	O
infor-	O
mation	O
is	O
available	O
.	O
for	O
instance	O
the	O
known	O
aspect	O
ratio	O
constraint	O
should	O
be	O
used	O
if	O
it	O
is	O
valid	O
,	O
as	O
should	O
the	O
knowledge	O
of	O
the	O
principal	O
point	B
.	O
even	O
if	O
the	O
values	O
are	O
known	O
only	O
imprecisely	O
,	O
this	O
information	O
can	O
be	O
incorporated	O
into	O
a	O
linear	B
auto-calibration	O
method	O
by	O
including	O
an	O
equation	O
,	O
but	O
with	O
low	O
weight	O
.	O
(	O
iii	O
)	O
this	O
recommendation	O
relates	O
to	O
bundle	O
adjustment	O
as	O
well	O
.	O
generally	O
it	O
is	O
best	O
to	O
ﬁnish	O
off	O
with	O
a	O
bundle	B
adjustment	I
.	O
in	O
doing	O
this	O
,	O
it	O
is	O
recommended	O
that	O
the	O
internal	B
parameters	I
of	O
the	O
camera	B
not	O
be	O
left	O
to	O
ﬂoat	O
unbounded	O
.	O
for	O
instance	O
,	O
even	O
if	O
the	O
principal	B
point	I
is	O
not	O
known	O
exactly	O
,	O
it	O
is	O
usually	O
known	O
within	O
some	O
reasonable	O
bounds	O
(	O
it	O
is	O
not	O
close	O
to	O
inﬁnity	O
for	O
instance	O
)	O
.	O
similarly	O
,	O
aspect	O
ratio	O
normally	O
lies	O
between	O
0.5	O
and	O
3.	O
this	O
knowledge	O
should	O
be	O
incorporated	O
in	O
a	O
bundle	B
adjustment	I
by	O
adding	O
further	O
constraints	B
to	O
the	O
cost	B
function	I
,	O
with	O
small	O
weights	O
(	O
standard	O
deviations	O
)	O
if	O
necessary	O
.	O
this	O
can	O
give	O
an	O
enormous	O
improvement	O
in	O
results	O
where	O
auto-calibration	B
is	O
poorly	O
conditioned	O
(	O
and	O
hence	O
unstable	O
)	O
by	O
preventing	O
the	O
solution	B
from	O
wandering	O
off	O
into	O
remote	O
regions	O
of	O
parameter	O
space	O
in	O
quest	O
of	O
a	O
minor	O
and	O
insigniﬁcant	O
improvement	O
in	O
the	O
cost	B
function	I
.	O
(	O
iv	O
)	O
methods	O
that	O
use	O
restricted	O
motions	O
usually	O
are	O
more	O
reliable	O
than	O
those	O
that	O
allow	O
general	B
motion	I
.	O
for	O
instance	O
the	O
methods	O
that	O
involve	O
a	O
rotating	O
but	O
non-	O
translating	O
camera	B
are	O
generally	O
much	O
more	O
reliable	O
than	O
general	B
motion	I
meth-	O
ods	O
.	O
the	O
same	O
is	O
true	O
of	O
afﬁne	O
reconstruction	B
from	O
a	O
translational	B
motion	I
.	O
19.11.1	O
the	O
literature	O
the	O
idea	O
of	O
auto	O
calibrating	O
a	O
camera	B
originated	O
in	O
faugeras	O
et	O
al	O
.	O
[	O
faugeras-92a	O
]	O
where	O
the	O
kruppa	O
equations	O
were	O
used	O
.	O
the	O
early	O
papers	O
considered	O
the	O
case	O
of	O
con-	O
stant	O
internal	B
parameters	I
.	O
[	O
mohr-93	O
]	O
investigated	O
bundle-adjustment	O
like	O
methods	O
for	O
more	O
than	O
two	B
views	I
.	O
[	O
hartley-94b	O
]	O
and	O
mohr	O
et	O
al	O
.	O
the	O
afﬁne	B
reconstruction	I
solution	O
for	O
the	O
case	O
of	O
pure	O
translation	O
was	O
given	O
by	O
moons	O
et	O
al	O
.	O
[	O
moons-94	O
]	O
,	O
and	O
was	O
extended	O
to	O
a	O
combination	O
of	O
pure	O
trans-	O
lation	O
followed	O
by	O
rotation	B
for	O
a	O
full	O
metric	O
reconstruction	B
by	O
armstrong	O
et	O
al	O
.	O
[	O
armstrong-94	O
]	O
.	O
the	O
case	O
of	B
auto-calibration	I
for	O
a	O
camera	B
rotating	O
about	O
its	O
centre	B
19.11	O
closure	O
499	O
was	O
given	O
by	O
[	O
hartley-94a	O
]	O
.	O
the	O
modulus	B
constraint	I
was	O
ﬁrst	O
published	O
by	O
pollefeys	O
et	O
al	O
.	O
[	O
pollefeys-96	O
]	O
.	O
the	O
original	O
method	O
for	O
auto-calibration	O
of	B
a	I
stereo	I
rig	I
was	O
given	O
by	O
zisserman	O
[	O
zisserman-95b	O
]	O
,	O
with	O
alternative	O
parametrizations	O
given	O
in	O
devernay	O
and	O
et	O
al	O
.	O
faugeras	O
[	O
devernay-96	O
]	O
,	O
and	O
horaud	O
and	O
csurka	O
[	O
horaud-98	O
]	O
.	O
the	O
special	O
case	O
of	O
planar	O
motion	O
of	B
a	I
stereo	I
rig	I
is	O
covered	O
in	O
[	O
beardsley-95b	O
,	O
csurka-98	O
]	O
.	O
for	B
planar	I
motion	I
of	O
a	O
monocular	O
camera	B
the	O
original	O
method	O
was	O
published	O
by	O
armstrong	O
et	O
al	O
.	O
[	O
armstrong-96b	O
]	O
,	O
and	O
an	O
alternative	O
numerical	O
solution	B
was	O
given	O
in	O
faugeras	O
et	O
al	O
.	O
[	O
faugeras-98	O
]	O
.	O
in	O
more	O
recent	O
papers	O
less	O
restrictive	O
constraints	B
than	O
constant	B
internal	I
parameters	O
have	O
been	O
investigated	O
.	O
a	O
number	O
of	O
“	O
existence	O
proofs	O
”	O
have	O
been	O
given	O
:	O
heyden	O
and	O
˚astr¨om	O
[	O
heyden-97b	O
]	O
showed	O
that	O
metric	B
reconstruction	I
is	O
possible	O
knowing	O
only	O
skew	O
and	O
aspect	O
ratio	O
,	O
and	O
[	O
pollefeys-98	O
,	O
heyden-98	O
]	O
showed	O
that	O
skew-zero	O
alone	O
was	O
sufﬁcient	O
.	O
triggs	O
[	O
triggs-97	O
]	O
introduced	O
the	O
absolute	O
(	O
dual	B
)	O
quadric	O
as	O
a	O
numerical	O
device	O
for	O
formulating	O
auto-calibration	B
problems	O
,	O
and	O
applied	O
both	O
linear	O
methods	O
and	O
sequential-	O
quadratic	O
programming	O
to	O
solve	O
for	O
q∗	O
∞	O
.	O
pollefeys	O
et	O
al	O
.	O
[	O
pollefeys-98	O
]	O
showed	O
that	O
computations	O
based	O
on	O
q∗	O
∞	O
could	O
be	O
used	O
to	O
compute	O
metric	B
reconstructions	O
for	O
varying	O
focal	B
length	I
under	O
general	B
motion	I
for	O
real	O
image	O
sequences	O
.	O
for	O
the	O
case	O
of	O
a	O
rotating	O
camera	B
de	O
agapito	O
et	O
al	O
.	O
[	O
deagapito-98	O
]	O
gave	O
a	O
non-	O
linear	B
solution	I
for	O
varying	O
internal	O
parameters	B
based	O
on	O
the	O
use	O
of	O
the	O
diac	O
.	O
this	O
was	O
modiﬁed	O
in	O
[	O
deagapito-99	O
]	O
to	O
an	O
iac-based	O
linear	B
method	O
.	O
19.11.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
[	O
hartley-92a	O
]	O
ﬁrst	O
gave	O
a	O
solution	B
for	O
the	O
extraction	O
of	O
focal	O
lengths	O
from	O
the	O
fundamental	B
matrix	I
,	O
but	O
the	O
algorithm	B
given	O
there	O
is	O
unwieldy	O
.	O
a	O
simple	O
elegant	O
formula	O
is	O
given	O
in	O
[	O
bougnoux-98	O
]	O
:	O
α2	O
=	O
−p	O
(	O
cid:2	O
)	O
t	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×˜ifpptftp	O
(	O
cid:2	O
)	O
p	O
(	O
cid:2	O
)	O
t	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×˜if˜iftp	O
(	O
cid:2	O
)	O
(	O
19.35	O
)	O
are	O
the	O
principal	O
points	O
in	O
the	O
(	O
cid:2	O
)	O
2	O
where	O
˜i	O
is	O
the	O
matrix	B
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
and	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
two	O
images	O
.	O
unit	O
aspect	O
ratio	O
and	O
zero	B
skew	I
are	O
assumed	O
.	O
the	O
formula	O
for	O
α	O
is	O
given	O
by	O
reversing	O
the	O
roles	O
of	O
the	O
two	O
images	O
(	O
and	O
transposing	O
f	O
)	O
.	O
note	O
that	O
the	O
ﬁnal	O
step	O
of	O
the	O
algorithm	O
is	O
to	O
take	O
a	O
square	O
root	O
.	O
it	O
is	O
assured	O
(	O
cid:2	O
)	O
2	O
as	O
computed	O
by	O
(	O
19.35	O
)	O
are	O
positive	O
,	O
given	O
good	O
data	O
and	O
a	O
that	O
α2	O
and	O
α	O
good	O
guess	O
of	O
the	O
principal	O
point	B
.	O
however	O
in	O
practice	O
this	O
does	O
not	O
always	O
pertain	O
,	O
and	O
negative	O
values	O
can	O
result	O
.	O
this	O
is	O
the	O
same	O
problem	O
as	O
mentioned	O
previously	O
in	O
section	O
19.3.5	O
(	O
p468	O
)	O
.	O
in	O
addition	O
,	O
as	O
ﬂagged	O
in	O
[	O
newsam-96	O
]	O
,	O
the	O
method	O
has	O
an	O
intrinsic	O
degeneracy	B
when	O
the	O
principal	O
rays	O
of	O
the	O
two	O
cameras	B
meet	O
in	O
space	O
,	O
in	O
which	O
case	O
it	O
is	O
impossible	O
to	O
compute	O
the	O
focal	O
lengths	O
inde-	O
pendently	O
.	O
this	O
occurs	O
when	O
both	O
cameras	O
are	O
trained	O
on	O
the	O
same	O
point	O
,	O
quite	O
a	O
common	O
occurrence	O
.	O
a	O
further	O
degeneracy	B
occurs	O
when	O
the	O
plane	B
deﬁned	O
by	O
the	O
baseline	O
and	O
the	O
500	O
19	O
auto-calibration	B
principal	O
ray	O
of	O
one	O
camera	B
is	O
perpendicular	O
to	O
the	O
plane	B
deﬁned	O
by	O
the	O
baseline	O
and	O
principal	O
ray	O
of	O
the	O
other	O
camera	B
.	O
generally	O
speaking	O
,	O
our	O
opinion	O
is	O
that	O
this	O
method	O
is	O
of	O
doubtful	O
value	O
as	O
a	O
means	O
of	O
computing	O
focal	O
lengths	O
.	O
(	O
ii	O
)	O
show	O
that	O
if	O
the	O
internal	B
parameters	I
are	O
constant	O
then	O
the	O
constraints	B
on	O
q∗	O
∞	O
obtained	O
from	O
two	O
views	O
(	O
19.6–p462	O
)	O
are	O
equivalent	B
to	O
the	O
kruppa	O
equa-	O
tions	O
(	O
19.18–p471	O
)	O
.	O
hint	O
,	O
from	O
(	O
9.10–p256	O
)	O
the	O
cameras	B
may	O
be	O
chosen	O
as	O
p1	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
p2	O
=	O
[	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×f	O
|	O
e	O
(	O
cid:2	O
)	O
]	O
.	O
(	O
iii	O
)	O
show	O
from	O
(	O
19.21–p473	O
)	O
that	O
in	O
the	O
case	O
of	O
a	O
camera	O
translating	O
with	O
constant	O
internal	B
parameters	I
and	O
without	O
rotating	O
,	O
then	O
the	O
plane	O
at	O
inﬁnity	O
may	O
be	O
com-	O
puted	O
directly	O
from	O
a	O
projective	B
reconstruction	I
.	O
(	O
iv	O
)	O
the	O
inﬁnite	B
homography	I
relation	O
(	O
19.24–p476	O
)	O
may	O
be	O
derived	O
in	O
two	O
lines	B
−1	O
,	O
in	O
section	O
13.4	O
(	O
p338	O
)	O
.	O
this	O
may	O
simply	O
from	O
the	O
deﬁnition	B
hij∞	O
=	O
kirij	O
(	O
kj	O
)	O
be	O
rearranged	O
as	O
hij∞kj	O
=	O
kirij	O
.	O
eliminating	O
the	O
rotation	B
using	O
orthogonality	B
as	O
rijrij	O
t	O
=	O
i	O
gives	O
hij∞	O
(	O
kjkj	O
t	O
)	O
hij∞t	O
=	O
(	O
kikit	O
)	O
.	O
(	O
v	O
)	O
under	O
he	O
,	O
points	O
on	O
π∞	O
(	O
i.e	O
.	O
with	O
x4	O
=	O
0	O
)	O
are	O
mapped	O
to	O
points	O
on	O
π∞	O
by	O
the	O
3×	O
3	O
homography	B
x∞	O
(	O
cid:6	O
)	O
→	O
rx∞	O
.	O
under	O
this	O
point	B
transformation	O
a	O
conic	B
on	O
π∞	O
maps	O
according	O
to	O
result	O
2.13	O
(	O
p37	O
)	O
c	O
(	O
cid:6	O
)	O
→	O
r−tcr−1	O
=	O
rcrt	O
.	O
the	O
absolute	O
conic	O
ω∞	O
is	O
ﬁxed	O
since	O
rirt	O
=	O
i.	O
now	O
,	O
denote	O
by	O
a	O
the	O
direction	O
of	O
the	O
rotation	O
axis	O
,	O
so	O
that	O
ra	O
=	O
1a	O
.	O
the	O
(	O
degenerate	B
)	O
point	B
conic	O
aat	O
is	O
also	O
ﬁxed	O
.	O
it	O
follows	O
that	O
there	O
is	O
a	O
pencil	O
of	O
ﬁxed	O
conics	O
c∞	O
(	O
µ	O
)	O
=i	O
+	O
µaat	O
under	O
the	O
mapping	O
since	O
r	O
(	O
ω∞	O
+	O
µaat	O
)	O
rt	O
=	O
rirt	O
+	O
µraatrt	O
=	O
ω∞	O
+	O
µaat	O
.	O
the	O
scalar	O
µ	O
parametrizes	O
the	O
pencil	O
.	O
this	O
shows	O
that	O
under	O
a	O
particular	O
simi-	O
larity	O
there	O
is	O
a	O
one-parameter	O
family	O
of	O
ﬁxed	O
conics	O
on	O
π∞	O
.	O
however	O
,	O
it	O
is	O
the	O
case	O
that	O
ω∞	O
is	O
the	O
only	O
conic	B
ﬁxed	O
under	O
any	O
similarity	B
.	O
(	O
vi	O
)	O
a	O
further	O
calibration	B
ambiguity	O
exists	O
for	O
a	O
common	O
type	O
of	O
robot	O
head	O
,	O
namely	O
a	O
pan-tilt	O
(	O
or	O
alt-azimuth	O
)	O
head	O
.	O
in	O
[	O
deagapito-99	O
]	O
it	O
was	O
shown	O
that	O
since	O
the	O
camera	B
may	O
rotate	O
about	O
its	O
x	O
or	O
y	O
axes	O
its	O
set	O
of	O
orientations	O
form	O
only	O
a	O
2-parameter	O
family	O
,	O
rather	O
than	O
a	O
3-parameter	O
family	O
of	O
general	O
rotations	B
.	O
this	O
limitation	O
causes	O
an	O
ambiguity	B
in	O
the	O
aspect	O
ratio	O
αx	O
of	O
the	O
camera	O
,	O
and	O
consequently	O
of	O
x0	O
as	O
well	O
.	O
(	O
vii	O
)	O
the	O
method	O
of	B
auto-calibration	I
from	O
planes	O
is	O
generally	O
non-linear	B
.	O
however	O
,	O
for	O
special	O
motions	O
linear	B
constraints	O
on	O
ω	O
can	O
be	O
obtained	O
.	O
suppose	O
we	O
have	O
two	O
images	O
of	O
a	O
plane	O
that	O
induces	O
a	O
planar	O
homography	O
h	O
between	O
views	O
,	O
and	O
imagine	O
that	O
the	O
motion	O
of	O
the	O
camera	O
relative	O
to	O
the	O
plane	B
is	O
a	O
general	O
screw	O
motion	O
but	O
with	O
the	O
screw	B
axis	I
parallel	O
to	O
the	O
plane	B
normal	O
.	O
consider	O
the	O
action	O
of	O
this	O
screw	O
motion	O
on	O
the	O
plane	B
.	O
since	O
this	O
action	O
(	O
a	O
ro-	O
tation	O
about	O
the	O
plane	B
’	O
s	O
normal	O
and	O
a	O
translation	O
)	O
does	O
not	O
change	O
the	O
plane	B
’	O
s	O
orientation	B
,	O
its	O
line	B
of	O
intersection	B
with	O
the	O
plane	O
at	O
inﬁnity	O
is	O
unchanged	O
(	O
as	O
a	O
set	O
)	O
.	O
the	O
absolute	O
conic	O
is	O
ﬁxed	O
(	O
as	O
a	O
set	O
)	O
under	O
euclidean	O
motion	O
.	O
con-	O
sequently	O
,	O
the	O
plane	B
’	O
s	O
intersection	B
with	O
the	O
absolute	O
conic	O
,	O
which	O
deﬁnes	O
the	O
circular	B
points	I
for	O
the	O
plane	B
,	O
is	O
also	O
unchanged	O
under	O
the	O
motion	O
.	O
19.11	O
closure	O
501	O
consider	O
now	O
applying	O
the	O
action	O
to	O
the	O
camera	B
viewing	O
the	O
plane	B
.	O
since	O
the	O
two	O
circular	O
points	O
are	O
ﬁxed	O
(	O
as	O
3-space	O
points	O
)	O
they	O
have	O
the	O
same	O
image	O
be-	O
fore	O
and	O
after	O
the	O
motion	O
.	O
as	O
the	O
homography	B
h	O
maps	O
points	O
on	O
the	O
plane	B
between	O
images	O
,	O
the	O
imaged	O
circular	B
points	I
must	O
correspond	O
to	O
two	O
of	O
its	O
ﬁxed	B
points	I
(	O
see	O
section	O
2.9	O
(	O
p61	O
)	O
)	O
and	O
can	O
thus	O
be	O
determined	O
directly	O
from	O
the	O
ho-	O
mography	O
.	O
each	O
circular	B
points	I
places	O
a	O
linear	B
constraint	O
on	O
ω.	O
further	O
details	O
of	O
this	O
method	O
are	O
given	O
in	O
[	O
knight-03	O
]	O
.	O
20	O
duality	B
it	O
has	O
been	O
known	O
since	O
the	O
work	O
of	O
carlsson	O
[	O
carlsson-95	O
]	O
and	O
weinshall	O
et	O
al	O
.	O
[	O
weinshall-95	O
]	O
that	O
there	O
is	O
a	O
dualization	O
principle	O
that	O
allows	O
one	O
to	O
interchange	O
the	O
role	O
of	B
points	I
being	O
viewed	O
by	O
several	O
cameras	B
and	O
the	O
camera	B
centres	O
themselves	O
.	O
in	O
principle	O
this	O
implies	O
the	O
possibility	O
of	O
dualizing	O
projective	B
reconstruction	I
algorithms	O
to	O
obtain	O
new	O
algorithms	O
.	O
in	O
this	O
chapter	O
,	O
this	O
theme	O
is	O
developed	O
to	O
outline	O
an	O
ex-	O
plicit	O
method	O
for	O
dualizing	O
any	O
projective	B
reconstruction	I
algorithm	O
.	O
at	O
the	O
practical	O
implementation	B
level	O
,	O
however	O
,	O
it	O
is	O
shown	O
that	O
there	O
are	O
difﬁculties	O
which	O
need	O
to	O
be	O
overcome	O
in	O
order	O
to	O
allow	O
application	O
of	O
this	O
dualization	O
method	O
to	O
produce	O
working	O
algorithms	O
.	O
20.1	O
carlsson–weinshall	O
duality	B
let	O
e1	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
e2	O
=	O
(	O
0	O
,	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
e3	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
and	O
e4	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
form	O
part	O
of	O
a	O
projective	O
basis	O
for	O
ip3	O
.	O
similarly	O
,	O
let	O
e1	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
e2	O
=	O
(	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
,	O
e3	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
and	O
e4	O
=	O
(	O
1	O
,	O
1	O
,	O
1	O
)	O
t	O
be	O
a	O
projective	B
basis	O
for	O
the	O
projective	B
image	O
plane	B
ip2	O
.	O
now	O
,	O
consider	O
a	O
camera	B
with	O
matrix	B
p.	O
we	O
assume	O
that	O
the	O
camera	B
centre	I
c	O
does	O
not	O
sit	O
on	O
any	O
of	O
the	O
axial	O
planes	O
,	O
that	O
is	O
none	O
of	O
the	O
four	O
coordinates	B
of	O
c	O
is	O
zero	O
.	O
in	O
this	O
case	O
,	O
no	O
three	O
of	O
the	O
points	O
pei	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
are	O
collinear	O
in	O
the	O
image	O
.	O
consequently	O
,	O
one	O
may	O
apply	O
a	O
projective	B
transformation	I
h	O
to	O
the	O
image	O
so	O
that	O
ei	O
=	O
hpei	O
.	O
we	O
assume	O
that	O
this	O
has	O
been	O
done	O
,	O
and	O
henceforth	O
denote	O
hp	O
simply	O
by	O
p.	O
since	O
pei	O
=	O
ei	O
,	O
the	O
form	B
of	I
the	O
matrix	B
p	O
is	O
	O
a	O
p	O
=	O
	O
.	O
b	O
d	O
d	O
c	O
d	O
deﬁnition	B
20.1.	O
a	O
camera	B
matrix	I
p	O
is	O
called	O
a	O
reduced	B
camera	I
matrix	I
if	O
it	O
maps	O
ei	O
to	O
ei	O
for	O
each	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
.	O
in	O
other	O
words	O
ei	O
=	O
pei	O
.	O
502	O
20.1	O
carlsson–weinshall	O
duality	B
now	O
,	O
for	O
any	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
one	O
veriﬁes	O
that	O
	O
a	O
p	O
=	O
	O
a	O
b	O
d	O
d	O
c	O
d	O
y	O
z	O
t	O
	O
	O
x	O
	O
=	O
	O
x	O
b	O
d	O
d	O
c	O
d	O
	O
	O
x	O
y	O
z	O
t	O
notice	O
the	O
symmetry	O
in	O
this	O
equation	O
between	O
the	O
entries	O
of	O
the	O
camera	O
matrix	B
and	O
the	O
coordinates	B
of	O
the	O
point	B
.	O
they	O
may	O
be	O
interchanged	O
as	O
follows	O
	O
=	O
	O
ax	O
+	O
dt	O
by	O
+	O
dt	O
cz	O
+	O
dt	O
	O
.	O
	O
a	O
b	O
c	O
d	O
	O
	O
.	O
y	O
t	O
t	O
z	O
t	O
503	O
(	O
20.1	O
)	O
(	O
20.2	O
)	O
the	O
interchange	O
of	O
the	O
roles	O
of	O
cameras	O
and	O
points	O
may	O
be	O
interpreted	O
as	O
a	O
form	B
of	I
du-	O
ality	O
,	O
which	O
will	O
be	O
referred	O
to	O
as	O
carlsson–weinshall	O
duality	B
,	O
or	O
more	O
brieﬂy	O
carlsson	O
duality	B
.	O
the	O
consequences	O
of	O
this	O
duality	B
will	O
be	O
explored	O
in	O
the	O
rest	O
of	O
this	O
chapter	O
.	O
20.1.1	O
dual	B
algorithms	O
first	O
of	O
all	O
,	O
we	O
will	O
use	O
it	O
for	O
deriving	O
a	O
dual	B
algorithm	I
from	O
a	O
given	O
projective	B
recon-	O
struction	O
algorithm	B
.	O
speciﬁcally	O
,	O
it	O
will	O
be	O
shown	O
that	O
if	O
one	O
has	O
an	O
algorithm	B
for	O
doing	O
projective	B
reconstruction	I
from	O
n	O
views	O
of	O
m	O
+	O
4	O
points	O
,	O
then	O
there	O
is	O
an	O
algorithm	B
for	O
doing	O
projective	B
reconstruction	I
from	O
m	O
views	O
of	O
n	O
+	O
4	O
points	O
.	O
this	O
result	O
,	O
observed	O
by	O
carlsson	O
[	O
carlsson-95	O
]	O
,	O
will	O
be	O
made	O
speciﬁc	O
by	O
explicitly	O
describing	O
the	O
steps	O
of	O
the	O
dual	O
algorithm	B
.	O
we	O
consider	O
a	O
projective	B
reconstruction	I
problem	O
,	O
which	O
will	O
be	O
referred	O
to	O
as	O
p	O
(	O
m	O
,	O
n	O
)	O
.	O
it	O
is	O
the	O
problem	O
of	O
doing	O
reconstruction	B
from	O
m	O
views	O
of	O
n	O
points	O
.	O
we	O
denote	O
image	O
points	O
by	O
xi	O
j	O
,	O
which	O
represents	O
the	O
image	O
of	O
the	O
j-th	O
object	O
space	O
point	O
in	O
the	O
i-th	O
view	O
.	O
thus	O
,	O
the	O
upper	O
index	O
indicates	O
the	O
view	O
number	O
,	O
and	O
the	O
lower	O
index	O
represents	O
the	O
point	B
number	O
.	O
such	O
a	O
set	O
of	B
points	I
{	O
xi	O
}	O
is	O
called	O
realizable	O
if	O
there	O
are	O
a	O
set	O
of	B
camera	I
matrices	O
pi	O
and	O
a	O
set	O
of	O
3d	O
points	O
xj	O
such	O
that	O
xi	O
j	O
=	O
pixj	O
.	O
the	O
projective	B
reconstruction	I
problem	O
p	O
(	O
m	O
,	O
n	O
)	O
is	O
that	O
of	O
ﬁnding	O
such	O
camera	B
matrices	I
pi	O
and	O
points	O
}	O
for	O
m	O
views	O
of	O
n	O
points	O
.	O
the	O
set	O
of	B
camera	I
matrices	O
and	O
xj	O
given	O
a	O
realizable	O
set	O
{	O
xi	O
3d	O
points	O
together	O
are	O
called	O
a	O
realization	B
(	O
or	O
projective	B
realization	I
)	O
of	O
the	O
set	O
of	O
point	O
correspondences	B
.	O
let	O
a	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
represent	O
an	O
algorithm	B
for	O
solving	B
the	O
projective	B
reconstruction	I
problem	O
p	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
.	O
an	O
algorithm	B
will	O
now	O
be	O
exhibited	O
for	O
solving	O
the	O
projective	B
reconstruction	I
p	O
(	O
m	O
,	O
n	O
+	O
4	O
)	O
.	O
this	O
algorithm	B
will	O
be	O
denoted	O
a∗	O
(	O
m	O
,	O
n	O
+	O
4	O
)	O
,	O
the	O
dual	B
of	O
the	O
algorithm	B
a	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
.	O
initially	O
,	O
the	O
steps	O
of	O
the	O
algorithm	O
will	O
be	O
given	O
without	O
proof	O
.	O
in	O
addition	O
,	O
difﬁcul-	O
ties	O
will	O
be	O
glossed	O
over	O
so	O
as	O
to	O
give	O
the	O
general	O
idea	O
without	O
getting	O
bogged	O
down	O
in	O
details	O
.	O
in	O
the	O
description	O
of	O
this	O
algorithm	B
it	O
is	O
important	O
to	O
keep	O
track	O
of	O
the	O
range	O
of	O
the	O
indices	O
,	O
and	O
whether	O
they	O
index	O
the	O
cameras	B
or	O
the	O
points	O
.	O
thus	O
,	O
the	O
following	O
may	O
help	O
to	O
keep	O
track	O
.	O
j	O
j	O
504	O
20	O
duality	B
views	O
(	O
i	O
)	O
m	O
xi	O
j	O
1	O
x2	O
x1	O
1	O
x1	O
x2	O
2	O
2	O
x2	O
n	O
xn+1	O
2	O
x1	O
n	O
xn+1	O
1	O
xn+2	O
1	O
xn+3	O
1	O
xn+4	O
1	O
n	O
4	O
xm	O
1	O
xm	O
2	O
xm	O
n	O
xn+1	O
m	O
xn+2	O
m	O
xn+3	O
m	O
xn+4	O
m	O
points	O
(	O
j	O
)	O
points	O
(	O
j	O
)	O
views	O
(	O
i	O
)	O
m	O
x	O
'	O
i	O
j	O
x	O
'	O
1	O
x	O
'	O
1	O
2	O
1	O
x	O
'	O
2	O
1	O
x	O
'	O
2	O
2	O
x	O
'	O
1	O
n	O
e1	O
e2	O
e3	O
e4	O
x	O
'	O
2	O
n	O
e1	O
e2	O
e3	O
e4	O
n	O
4	O
x	O
'	O
m	O
1	O
x	O
'	O
m	O
2	O
x	O
'	O
m	O
n	O
e1	O
e2	O
e3	O
e4	O
t1	O
t2	O
ti	O
tm	O
fig	O
.	O
20.1.	O
left	O
:	O
input	O
to	O
algorithm	O
a∗	O
(	O
m	O
,	O
n	O
+	O
4	O
)	O
.	O
right	O
:	O
input	O
data	O
after	O
transformation	B
.	O
•	O
upper	O
indices	O
represent	O
the	O
view	O
number	O
.	O
•	O
lower	O
indices	O
represent	O
the	O
point	B
number	O
.	O
•	O
i	O
ranges	O
from	O
1	O
to	O
m.	O
•	O
j	O
ranges	O
from	O
1	O
to	O
n.	O
•	O
k	O
ranges	O
from	O
1	O
to	O
4.	O
the	O
dual	B
algorithm	I
given	O
an	O
algorithm	B
a	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
the	O
goal	O
is	O
to	O
exhibit	O
a	O
dual	B
algorithm	I
a∗	O
(	O
m	O
,	O
n	O
+	O
4	O
)	O
.	O
input	O
:	O
the	O
input	O
to	O
the	O
algorithm	B
a∗	O
in	O
m	O
views	O
.	O
this	O
set	O
of	B
points	I
can	O
be	O
arranged	O
in	O
a	O
table	O
as	O
in	O
ﬁgure	O
20.1	O
(	O
left	O
)	O
.	O
(	O
m	O
,	O
n	O
+	O
4	O
)	O
consists	O
of	O
a	O
realizable	O
set	O
of	O
n	O
+	O
4	O
points	O
seen	O
in	O
this	O
table	O
,	O
the	O
points	O
xi	O
receive	O
special	O
treatment	O
.	O
n+k	O
are	O
separated	O
from	O
the	O
other	O
points	O
xi	O
j	O
,	O
since	O
they	O
will	O
step	O
1	O
:	O
transform	O
the	O
ﬁrst	O
step	O
is	O
to	O
compute	O
,	O
for	O
each	O
i	O
,	O
a	O
transformation	B
ti	O
that	O
maps	O
the	O
points	O
xi	O
n+k	O
,	O
k	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
in	O
the	O
i-th	O
view	O
to	O
the	O
points	O
ek	O
of	O
a	O
canonical	O
basis	O
for	O
projec-	O
tive	O
2-space	O
ip2	O
.	O
the	O
transformation	B
ti	O
is	O
applied	O
also	O
to	O
each	O
of	O
the	O
points	O
xi	O
j	O
to	O
pro-	O
duce	O
transformed	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
j.	O
the	O
result	O
is	O
the	O
transformed	O
point	B
array	O
shown	O
in	O
ﬁgure	O
20.1	O
(	O
right	O
)	O
.	O
a	O
different	O
transformation	B
ti	O
is	O
computed	O
and	O
applied	O
to	O
each	O
column	O
of	O
the	O
array	O
,	O
as	O
indicated	O
.	O
j	O
=	O
tixi	O
20.1	O
carlsson–weinshall	O
duality	B
505	O
points	O
(	O
i	O
)	O
m	O
views	O
(	O
j	O
)	O
n	O
^	O
^	O
1	O
x2	O
x1	O
1	O
^	O
^	O
x1	O
x2	O
2	O
2	O
^	O
x	O
j	O
i	O
^	O
^	O
m	O
x2	O
x1	O
m	O
^	O
x	O
j	O
i	O
=	O
x	O
'	O
i	O
j	O
^	O
xn	O
1	O
^	O
xn	O
2	O
^	O
xn	O
m	O
points	O
(	O
i	O
)	O
views	O
(	O
j	O
)	O
n	O
^	O
x	O
j	O
i	O
^	O
^	O
1	O
x2	O
x1	O
1	O
^	O
^	O
x1	O
x2	O
2	O
2	O
^	O
^	O
m	O
x2	O
x1	O
m	O
e1	O
e1	O
e2	O
e2	O
e3	O
e3	O
e4	O
e4	O
m	O
4	O
^	O
xn	O
1	O
^	O
xn	O
2	O
^	O
xn	O
m	O
e1	O
e2	O
e3	O
e4	O
fig	O
.	O
20.2.	O
left	O
:	O
transposed	O
data	O
.	O
right	O
:	O
transposed	O
data	O
extended	O
by	O
addition	O
of	O
extra	O
points	O
.	O
step	O
2	O
:	O
transpose	O
the	O
last	O
four	O
rows	O
of	O
the	O
array	O
are	O
dropped	O
,	O
and	O
the	O
remaining	O
block	O
of	O
the	O
array	O
is	O
i	O
=	O
x	O
(	O
cid:2	O
)	O
i	O
transposed	O
.	O
one	O
deﬁnes	O
ˆxj	O
j	O
.	O
at	O
the	O
same	O
time	O
,	O
one	O
does	O
a	O
mental	O
switch	O
of	B
points	I
and	O
views	O
.	O
thus	O
the	O
point	B
ˆxj	O
i	O
is	O
now	O
conceived	O
as	O
being	O
the	O
image	O
of	O
the	O
i-th	O
point	B
in	O
the	O
j-th	O
view	O
,	O
whereas	O
the	O
point	B
x	O
(	O
cid:2	O
)	O
i	O
j	O
was	O
the	O
image	O
of	O
the	O
j-th	O
point	B
in	O
the	O
i-th	O
view	O
.	O
what	O
is	O
happening	O
here	O
effectively	O
is	O
that	O
the	O
roles	O
of	B
points	I
and	O
cameras	B
are	O
being	O
swapped	O
–	O
the	O
basic	O
concept	O
behind	O
carlsson	O
duality	B
expressed	O
by	O
(	O
20.2	O
)	O
.	O
the	O
resulting	O
transposed	O
array	O
is	O
shown	O
in	O
ﬁgure	O
20.2	O
(	O
left	O
)	O
.	O
step	O
3	O
:	O
extend	O
the	O
array	O
of	B
points	I
is	O
now	O
extended	O
by	O
the	O
addition	O
of	O
four	O
extra	O
rows	O
containing	O
points	O
ek	O
in	O
all	O
positions	O
of	O
the	O
(	O
m	O
+	O
k	O
)	O
-th	O
row	O
of	O
the	O
array	O
,	O
as	O
shown	O
in	O
ﬁgure	O
20.2	O
(	O
right	O
)	O
.	O
the	O
purpose	O
of	O
this	O
extension	O
will	O
be	O
explained	O
in	O
section	O
20.1.2.	O
step	O
4	O
:	O
solve	O
the	O
array	O
of	B
points	I
resulting	O
from	O
the	O
last	O
step	O
has	O
m	O
+	O
4	O
rows	O
and	O
n	O
columns	O
,	O
and	O
may	O
be	O
regarded	O
as	O
the	O
positions	O
of	O
m	O
+	O
4	O
points	O
seen	O
in	O
n	O
views	O
.	O
as	O
such	O
,	O
it	O
is	O
a	O
candidate	O
for	O
solution	O
by	O
the	O
algorithm	B
a	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
,	O
which	O
we	O
have	O
assumed	O
is	O
given	O
.	O
essential	O
here	O
is	O
that	O
the	O
points	O
in	O
the	O
array	O
form	O
a	O
realizable	O
set	O
of	O
point	O
correspondences	B
.	O
jus-	O
of	O
cameras	O
ˆpj	O
and	O
points	O
(	O
cid:23	O
)	O
xi	O
such	O
that	O
ˆxj	O
i	O
=	O
ˆpj	O
(	O
cid:23	O
)	O
xi	O
.	O
in	O
addition	O
,	O
corresponding	O
to	O
the	O
last	O
tiﬁcation	O
of	O
this	O
is	O
deferred	O
for	O
now	O
.	O
the	O
result	O
of	O
the	O
algorithm	O
a	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
is	O
a	O
set	O
four	O
rows	O
of	O
the	O
array	O
,	O
there	O
are	O
points	O
(	O
cid:23	O
)	O
xm+k	O
such	O
that	O
ek	O
=	O
ˆpj	O
(	O
cid:23	O
)	O
xm+k	O
for	O
all	O
j.	O
step	O
5	O
:	O
3d	O
transformation	B
since	O
the	O
reconstruction	B
obtained	O
in	O
the	O
last	O
step	O
is	O
a	O
projective	B
reconstruction	I
,	O
one	O
may	O
transform	O
it	O
(	O
equivalently	O
,	O
choose	O
a	O
projective	B
coordinate	O
frame	O
)	O
such	O
that	O
the	O
points	O
506	O
(	O
cid:23	O
)	O
xm+k	O
are	O
the	O
four	O
points	O
ek	O
of	O
a	O
partial	O
canonical	O
basis	O
for	O
ip3	O
.	O
the	O
only	O
requirement	O
is	O
that	O
the	O
points	O
(	O
cid:23	O
)	O
xm+k	O
obtained	O
in	O
the	O
projective	B
reconstruction	I
are	O
not	O
coplanar	O
.	O
this	O
at	O
this	O
point	B
,	O
one	O
sees	O
that	O
ek	O
=	O
ˆpj	O
(	O
cid:23	O
)	O
xm+k	O
=	O
ˆpjek	O
.	O
from	O
this	O
it	O
follows	O
that	O
ˆpj	O
has	O
assumption	O
is	O
validated	O
later	O
.	O
20	O
duality	B
the	O
special	O
form	O
ˆpj	O
=	O
	O
aj	O
bj	O
dj	O
dj	O
cj	O
dj	O
(	O
20.3	O
)	O
	O
.	O
	O
.	O
step	O
6	O
:	O
dualize	O
let	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
zi	O
,	O
ti	O
)	O
t	O
,	O
and	O
ˆpj	O
be	O
as	O
given	O
in	O
(	O
20.3	O
)	O
.	O
now	O
deﬁne	O
points	O
xj	O
=	O
(	O
aj	O
,	O
bj	O
,	O
cj	O
,	O
dj	O
)	O
t	O
and	O
cameras	B
	O
xi	O
p	O
(	O
cid:2	O
)	O
i	O
=	O
yi	O
ti	O
ti	O
zi	O
ti	O
then	O
one	O
veriﬁes	O
that	O
p	O
(	O
cid:2	O
)	O
ixj	O
=	O
(	O
xiaj	O
+	O
tidj	O
,	O
yibj	O
+	O
tidj	O
,	O
zicj	O
+	O
tidj	O
)	O
t	O
=	O
ˆpj	O
(	O
cid:23	O
)	O
xi	O
=	O
ˆxj	O
i	O
=	O
x	O
(	O
cid:2	O
)	O
i	O
j	O
.	O
if	O
,	O
in	O
addition	O
,	O
one	O
deﬁnes	O
xn+k	O
=	O
ek	O
for	O
k	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
,	O
then	O
p	O
(	O
cid:2	O
)	O
ixn+k	O
=	O
ek	O
.	O
it	O
is	O
then	O
evident	O
that	O
the	O
cameras	B
p	O
(	O
cid:2	O
)	O
i	O
and	O
points	O
xj	O
and	O
xn+k	O
form	O
a	O
projective	B
realization	I
of	O
the	O
transformed	O
data	O
array	O
obtained	O
in	O
step	O
1	O
of	O
this	O
algorithm	B
.	O
step	O
7	O
:	O
reverse	O
transformation	B
−1p	O
(	O
cid:2	O
)	O
i	O
,	O
and	O
with	O
the	O
points	O
xj	O
and	O
xn+k	O
obtained	O
in	O
the	O
finally	O
,	O
deﬁning	O
pi	O
=	O
(	O
ti	O
)	O
previous	O
step	O
,	O
one	O
has	O
a	O
projective	B
realization	I
of	O
the	O
original	O
data	O
.	O
indeed	O
,	O
one	O
veriﬁes	O
pixj	O
=	O
(	O
ti	O
)	O
−1p	O
(	O
cid:2	O
)	O
ixj	O
=	O
(	O
ti	O
)	O
−1x	O
(	O
cid:2	O
)	O
i	O
j	O
=	O
xi	O
j	O
.	O
this	O
completes	O
the	O
description	O
of	O
the	O
algorithm	O
.	O
one	O
can	O
see	O
that	O
it	O
takes	O
place	O
in	O
various	O
stages	O
.	O
(	O
i	O
)	O
in	O
step	O
1	O
,	O
the	O
data	O
is	O
transformed	O
into	O
canonical	O
image	O
reference	O
frames	O
based	O
(	O
ii	O
)	O
in	O
steps	O
2	O
and	O
3	O
the	O
problem	O
is	O
mapped	O
into	O
the	O
dual	B
domain	O
,	O
resulting	O
in	O
a	O
dual	B
on	O
the	O
selection	O
of	O
four	O
distinguished	O
points	O
.	O
problem	O
p	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
.	O
(	O
iii	O
)	O
the	O
dual	B
problem	O
is	O
solved	O
in	O
steps	O
4	O
and	O
5	O
.	O
(	O
iv	O
)	O
step	O
6	O
maps	O
the	O
solution	B
back	O
into	O
the	O
original	O
domain	O
.	O
(	O
v	O
)	O
step	O
7	O
undoes	O
the	O
effects	O
of	O
the	O
initial	O
transformation	B
.	O
20.1	O
carlsson–weinshall	O
duality	B
507	O
20.1.2	O
justiﬁcation	B
of	O
the	O
algorithm	B
to	O
justify	O
this	O
algorithm	B
,	O
one	O
needs	O
to	O
be	O
sure	O
that	O
at	O
step	O
4	O
there	O
indeed	O
exists	O
a	O
solution	B
to	O
the	O
transformed	O
problem	O
.	O
before	O
considering	O
this	O
,	O
it	O
is	O
necessary	O
to	O
explain	O
the	O
purpose	O
of	O
step	O
3	O
,	O
which	O
extends	O
the	O
data	O
by	O
the	O
addition	O
of	O
rows	O
of	O
image	O
points	O
ek	O
,	O
and	O
step	O
5	O
,	O
which	O
transforms	O
the	O
arbitrary	O
projective	B
solution	O
to	O
one	O
in	O
which	O
four	O
points	O
are	O
equal	O
to	O
the	O
3d	O
basis	O
points	O
ek	O
.	O
the	O
purpose	O
of	O
these	O
steps	O
is	O
to	O
ensure	O
that	O
one	O
obtains	O
a	O
solution	B
to	O
the	O
dual	B
re-	O
construction	O
problem	O
in	O
which	O
ˆpj	O
has	O
the	O
special	O
form	O
given	O
by	O
(	O
20.3	O
)	O
in	O
which	O
the	O
camera	B
matrix	I
is	O
parametrized	O
by	O
only	O
4	O
values	O
.	O
the	O
dual	B
algorithm	I
is	O
described	O
in	O
this	O
manner	O
so	O
that	O
it	O
will	O
work	O
with	O
any	O
algorithm	B
a	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
whatever	O
.	O
however	O
,	O
both	O
steps	O
3	O
and	O
5	O
may	O
be	O
eliminated	O
if	O
the	O
known	O
algorithm	O
a	O
(	O
n	O
,	O
m	O
+	O
4	O
)	O
has	O
the	O
capability	O
of	O
enforcing	O
this	O
constraint	O
on	O
the	O
camera	B
matrices	I
directly	O
.	O
algorithms	O
based	O
on	O
the	O
fundamental	B
matrix	I
,	O
trifocal	B
or	O
quadrifocal	O
tensors	O
may	O
easily	O
be	O
modiﬁed	O
in	O
this	O
way	O
,	O
as	O
will	O
be	O
seen	O
.	O
in	O
the	O
mean	O
time	O
,	O
since	O
ˆpj	O
of	O
the	O
form	O
(	O
20.3	O
)	O
is	O
called	O
a	O
reduced	B
camera	I
matrix	I
,	O
we	O
call	O
any	O
reconstruction	B
of	O
a	O
set	O
of	O
image	O
correspondences	B
in	O
which	O
each	O
camera	B
matrix	I
is	O
of	O
this	O
form	O
a	O
reduced	B
reconstruction	O
.	O
not	O
all	O
sets	O
of	O
realizable	O
point	B
correspon-	O
dences	O
allow	O
a	O
reduced	B
realization	O
,	O
however	O
.	O
the	O
following	O
result	O
characterizes	O
sets	O
of	O
point	O
correspondences	B
that	O
do	O
have	O
this	O
property	O
.	O
result	O
20.2.	O
a	O
set	O
of	O
image	O
points	O
{	O
xi	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
;	O
j	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
}	O
admits	O
a	O
reduced	B
realization	O
if	O
and	O
only	O
if	O
it	O
may	O
be	O
augmented	O
with	O
supplementary	O
correspon-	O
dences	O
xi	O
n+k	O
=	O
ek	O
for	O
k	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
such	O
that	O
:	O
j	O
(	O
i	O
)	O
the	O
total	O
set	O
of	O
image	O
correspondences	B
is	O
realizable	O
,	O
and	O
(	O
ii	O
)	O
the	O
reconstructed	O
points	O
xn+k	O
corresponding	O
to	O
the	O
supplementary	O
image	O
cor-	O
respondences	O
are	O
non-coplanar	O
.	O
proof	O
.	O
the	O
proof	O
is	O
straightforward	O
enough	O
.	O
suppose	O
the	O
set	O
permits	O
a	O
reduced	B
real-	O
ization	O
,	O
and	O
let	O
pi	O
be	O
the	O
set	O
of	O
reduced	O
camera	B
matrices	I
.	O
let	O
points	O
xn+k	O
=	O
ek	O
for	O
k	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
be	O
projected	O
into	O
the	O
m	O
images	O
.	O
the	O
projections	O
are	O
xi	O
n+k	O
=	O
pixn+k	O
=	O
piek	O
=	O
ek	O
for	O
all	O
i.	O
conversely	O
,	O
suppose	O
the	O
augmented	O
set	O
of	B
points	I
is	O
realizable	O
and	O
the	O
points	O
xn+k	O
are	O
non-coplanar	O
.	O
in	O
this	O
case	O
,	O
a	O
projective	B
basis	O
may	O
be	O
chosen	O
such	O
that	O
xn+k	O
=	O
ek	O
.	O
then	O
for	O
each	O
view	O
,	O
one	O
has	O
ek	O
=	O
piek	O
for	O
all	O
k.	O
from	O
this	O
it	O
follows	O
that	O
each	O
pi	O
has	O
the	O
desired	O
form	O
(	O
20.3	O
)	O
.	O
one	O
other	O
remark	O
must	O
be	O
made	O
before	O
proving	O
the	O
correctness	O
of	O
the	O
algorithm	O
.	O
result	O
20.3.	O
if	O
a	O
set	O
of	O
image	O
points	O
{	O
xi	O
reduced	B
realization	O
then	O
so	O
does	O
the	O
transposed	O
set	O
{	O
ˆxj	O
where	O
ˆxj	O
j	O
for	O
all	O
i	O
and	O
j.	O
i	O
=	O
xi	O
:	O
j	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
;	O
j	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
}	O
permits	O
a	O
:	O
j	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
;	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m	O
}	O
i	O
this	O
is	O
the	O
basic	O
duality	O
property	O
,	O
effectively	O
proved	O
by	O
the	O
construction	O
given	O
in	O
step	O
6	O
of	O
the	O
algorithm	O
above	O
.	O
now	O
it	O
is	O
possible	O
to	O
prove	O
the	O
correctness	O
of	O
the	O
algorithm	O
.	O
508	O
result	O
20.4.	O
let	O
xi	O
correspondences	B
,	O
and	O
suppose	O
j	O
and	O
xi	O
20	O
duality	B
n+k	O
as	O
in	O
ﬁgure	O
20.1	O
(	O
left	O
)	O
be	O
a	O
set	O
of	O
realizable	O
image	O
point	O
(	O
i	O
)	O
for	O
each	O
i	O
,	O
the	O
four	O
points	O
xi	O
n+k	O
do	O
not	O
include	O
three	O
collinear	O
points	O
.	O
(	O
ii	O
)	O
the	O
four	O
points	O
xn+k	O
in	O
a	O
projective	B
reconstruction	I
are	O
non-coplanar	O
.	O
then	O
the	O
algorithm	B
of	O
section	O
20.1.1	O
will	O
succeed	O
.	O
proof	O
.	O
because	O
of	O
the	O
ﬁrst	O
condition	O
,	O
transformations	O
ti	O
exist	O
for	O
each	O
i	O
,	O
transforming	O
the	O
input	O
data	O
to	O
the	O
form	O
shown	O
in	O
ﬁgure	O
20.1	O
(	O
right	O
)	O
.	O
this	O
transformed	O
data	O
is	O
also	O
realizable	O
,	O
since	O
the	O
transformed	O
data	O
differs	O
only	O
by	O
a	O
projective	B
transformation	I
of	O
the	O
image	O
.	O
now	O
,	O
according	O
to	O
result	O
20.2	O
applied	O
to	O
ﬁgure	O
20.1	O
(	O
right	O
)	O
,	O
the	O
correspondences	B
x	O
(	O
cid:2	O
)	O
i	O
j	O
admit	O
a	O
reduced	B
realization	O
.	O
by	O
result	O
20.3	O
the	O
transposed	O
data	O
ﬁgure	O
20.2	O
(	O
left	O
)	O
also	O
admits	O
a	O
reduced	B
realization	O
.	O
applying	O
result	O
20.2	O
once	O
more	O
shows	O
that	O
the	O
extended	O
data	O
ﬁgure	O
20.2	O
(	O
right	O
)	O
is	O
realizable	O
.	O
furthermore	O
,	O
the	O
points	O
(	O
cid:23	O
)	O
xm+k	O
are	O
non-coplanar	O
,	O
and	O
so	O
step	O
5	O
is	O
valid	O
.	O
the	O
subsequent	O
steps	O
6	O
and	O
7	O
go	O
forward	O
without	O
problems	O
.	O
the	O
ﬁrst	O
condition	O
may	O
be	O
checked	O
from	O
the	O
image	O
correspondences	O
xi	O
j.	O
it	O
may	O
be	O
thought	O
that	O
to	O
check	O
the	O
second	O
condition	O
requires	O
reconstruction	B
to	O
be	O
carried	O
out	O
.	O
it	O
is	O
,	O
however	O
,	O
possible	O
to	O
check	O
whether	O
the	O
reconstructed	O
points	O
will	O
be	O
coplanar	O
without	O
carrying	O
out	O
the	O
reconstruction	B
.	O
this	O
is	O
left	O
as	O
an	O
exercise	O
for	O
the	O
reader	O
(	O
page	O
342	O
)	O
.	O
20.2	O
reduced	B
reconstruction	O
in	O
this	O
section	O
,	O
we	O
concentrate	O
on	O
and	O
reevaluate	O
steps	O
3	O
–	O
5	O
of	O
the	O
algorithm	O
described	O
in	O
the	O
preceding	O
section	O
.	O
to	O
recapitulate	O
,	O
the	O
purpose	O
of	O
these	O
steps	O
is	O
to	O
obtain	O
a	O
reduced	B
reconstruction	O
from	O
a	O
set	O
of	O
image	O
correspondences	B
.	O
thus	O
,	O
the	O
input	O
is	O
a	O
set	O
of	O
image	O
correspondences	B
ˆxj	O
i	O
admitting	O
a	O
reduced	B
realization	O
(	O
see	O
ﬁgure	O
20.2	O
(	O
left	O
)	O
)	O
.	O
the	O
i	O
for	O
all	O
output	O
is	O
a	O
set	O
of	O
reduced	O
camera	B
matrices	I
ˆpj	O
and	O
points	O
(	O
cid:23	O
)	O
xi	O
such	O
that	O
ˆpj	O
(	O
cid:23	O
)	O
xi	O
=	O
ˆxj	O
i	O
,	O
j.	O
as	O
we	O
have	O
seen	O
,	O
one	O
way	O
to	O
do	O
this	O
(	O
as	O
in	O
steps	O
3	O
–	O
5	O
)	O
of	O
the	O
given	O
algorithm	B
is	O
to	O
augment	O
the	O
points	O
by	O
the	O
addition	O
of	O
four	O
extra	O
synthetic	O
point	O
correspondences	B
ˆxj	O
m+k	O
,	O
carrying	O
out	O
projective	B
reconstruction	I
,	O
and	O
then	O
applying	O
a	O
3d	O
homography	B
so	O
that	O
the	O
3d	O
points	O
(	O
cid:23	O
)	O
xm+k	O
are	O
mapped	O
to	O
the	O
points	O
ek	O
of	O
a	O
projective	O
basis	O
for	O
ip3	O
.	O
the	O
problem	O
with	O
this	O
is	O
that	O
in	O
the	O
presence	O
of	O
noise	O
,	O
the	O
projective	B
reconstruction	I
is	O
not	O
exact	O
.	O
thus	O
,	O
the	O
camera	B
matrices	I
obtained	O
by	O
this	O
method	O
will	O
map	O
points	O
ek	O
to	O
points	O
close	O
to	O
,	O
but	O
not	O
identical	O
with	O
ek	O
.	O
this	O
means	O
that	O
the	O
camera	B
matrices	I
are	O
not	O
exactly	O
in	O
reduced	O
form	O
.	O
therefore	O
,	O
we	O
now	O
consider	O
methods	O
of	O
computing	O
a	O
realization	B
of	O
the	O
point	B
correspondences	O
in	O
which	O
the	O
cameras	B
are	O
exactly	O
reduced	B
.	O
20.2.1	O
the	O
reduced	B
fundamental	I
matrix	I
the	O
most	O
evident	O
applications	O
of	O
these	O
dual	B
methods	O
are	O
to	O
dualize	O
the	O
reconstruction	B
algorithms	O
involving	O
the	O
fundamental	B
matrix	I
and	O
trifocal	B
tensor	I
.	O
these	O
will	O
lead	O
to	O
reconstruction	O
algorithms	O
for	O
6	O
or	O
7	O
points	O
(	O
respectively	O
)	O
across	O
n	O
views	O
.	O
in	O
this	O
sec-	O
tion	O
,	O
we	O
consider	O
reconstruction	B
from	O
6	O
points	O
.	O
the	O
dual	B
of	O
a	O
reconstruction	B
problem	O
20.2	O
reduced	B
reconstruction	O
509	O
p	O
(	O
n	O
,	O
6	O
)	O
is	O
a	O
problem	O
p	O
(	O
2	O
,	O
n	O
+	O
4	O
)	O
,	O
namely	O
reconstruction	B
from	O
n	O
+	O
4	O
points	O
in	O
2	O
views	O
.	O
the	O
method	O
of	O
chapter	O
10	O
involving	O
the	O
fundamental	B
matrix	I
is	O
a	O
standard	O
way	O
of	O
solving	O
such	O
a	O
problem	O
.	O
to	O
this	O
end	O
we	O
deﬁne	O
a	O
reduced	B
fundamental	I
matrix	I
:	O
deﬁnition	B
20.5.	O
a	O
fundamental	B
matrix	I
ˆf	O
is	O
called	O
a	O
reduced	B
fundamental	I
matrix	I
if	O
it	O
satisﬁes	O
the	O
condition	O
et	O
i	O
ˆfei	O
=	O
0	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
.	O
it	O
is	O
evident	O
that	O
since	O
a	O
reduced	B
fundamental	I
matrix	I
already	O
satisﬁes	O
constraints	B
derived	O
from	O
four	O
point	B
correspondences	O
,	O
it	O
may	O
be	O
computed	O
from	O
a	O
small	O
number	O
of	O
additional	O
points	O
,	O
in	O
fact	O
linearly	O
from	O
four	O
points	O
,	O
or	O
non-linearly	O
from	O
three	O
points	O
.	O
20.2.2	O
computation	B
of	I
the	O
reduced	B
fundamental	I
matrix	I
for	O
a	O
reduced	B
fundamental	I
matrix	I
,	O
the	O
condition	O
et	O
ˆfei	O
=	O
0	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
implies	O
i	O
that	O
the	O
diagonal	O
entries	O
of	O
ˆf	O
are	O
zero	O
.	O
the	O
requirement	O
that	O
(	O
1	O
,	O
1	O
,	O
1	O
)	O
ˆf	O
(	O
1	O
,	O
1	O
,	O
1	O
)	O
t	O
=	O
0	O
gives	O
the	O
additional	O
condition	O
that	O
the	O
sum	O
of	O
entries	O
of	O
ˆf	O
is	O
zero	O
.	O
thus	O
one	O
may	O
write	O
ˆf	O
in	O
the	O
form	O
ˆf	O
=	O
q	O
r	O
s	O
t	O
−	O
(	O
p	O
+	O
q	O
+	O
r	O
+	O
s	O
+	O
t	O
)	O
0	O
p	O
0	O
(	O
20.4	O
)	O
	O
0	O
	O
thereby	O
parametrizing	O
a	O
fundamental	B
matrix	I
satisfying	O
all	O
the	O
linear	B
constraints	O
(	O
though	O
not	O
the	O
condition	O
det	O
ˆf	O
=	O
0	O
)	O
.	O
now	O
,	O
a	O
further	O
point	B
correspondence	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
satisfying	O
x	O
(	O
cid:2	O
)	O
tˆfx	O
=	O
0	O
is	O
easily	O
seen	O
to	O
provide	O
a	O
linear	B
equation	O
in	O
the	O
parameters	B
p	O
,	O
.	O
.	O
.	O
,	O
t	O
of	O
ˆf	O
.	O
given	O
at	O
least	O
four	O
such	O
correspondences	B
,	O
one	O
may	O
solve	O
for	O
these	O
parameters	B
,	O
up	O
to	O
an	O
inconsequential	O
scale	O
.	O
given	O
only	O
three	O
such	O
correspondences	B
,	O
the	O
extra	O
con-	O
straint	O
det	O
ˆf	O
=	O
0	O
may	O
be	O
used	O
to	O
provide	O
the	O
extra	O
constraint	O
necessary	O
to	O
determine	O
ˆf	O
.	O
there	O
may	O
be	O
one	O
or	O
three	O
solutions	O
.	O
this	O
computation	B
is	O
analogous	O
to	O
the	O
method	O
used	O
in	O
section	O
11.1.2	O
(	O
p281	O
)	O
to	O
compute	O
the	O
fundamental	B
matrix	I
from	O
seven	O
point	B
cor-	O
respondences	O
.	O
with	O
four	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
or	O
more	O
,	O
one	O
ﬁnds	O
a	O
least-squares	B
solution	I
.	O
20.2.3	O
retrieving	B
reduced	O
camera	B
matrices	I
computing	O
a	O
pair	O
of	O
reduced	O
camera	B
matrices	I
that	O
correspond	O
to	O
a	O
reduced	B
fundamen-	O
tal	O
matrix	B
is	O
surprisingly	O
tricky	O
.	O
one	O
can	O
not	O
assume	O
that	O
the	O
ﬁrst	O
camera	B
is	O
[	O
i	O
|	O
0	O
]	O
as	O
in	O
the	O
usual	O
projective	B
camera	I
case	O
,	O
since	O
this	O
is	O
non-generic	O
,	O
the	O
camera	B
centre	I
corre-	O
sponding	O
with	O
the	O
basis	O
point	B
e4	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
however	O
,	O
we	O
may	O
instead	O
assume	O
that	O
the	O
pair	O
of	O
cameras	O
are	O
of	O
the	O
form	O
	O
1	O
p	O
=	O
1	O
1	O
1	O
1	O
1	O
	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
	O
a	O
	O
b	O
d	O
d	O
c	O
d	O
(	O
20.5	O
)	O
since	O
the	O
centre	B
of	O
the	O
ﬁrst	O
camera	B
is	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
1	O
)	O
t	O
which	O
is	O
a	O
generic	O
point	B
with	O
respect	O
to	O
the	O
basis	O
points	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
.	O
further	O
,	O
if	O
d	O
(	O
cid:5	O
)	O
=	O
0	O
,	O
then	O
we	O
may	O
assume	O
that	O
d	O
=	O
1	O
,	O
but	O
we	O
prefer	O
not	O
to	O
do	O
this	O
.	O
510	O
20	O
duality	B
the	O
reduced	B
fundamental	I
matrix	I
corresponding	O
to	O
this	O
pair	O
of	O
cameras	O
is	O
	O
ˆf	O
=	O
b	O
(	O
d	O
−	O
c	O
)	O
−c	O
(	O
d	O
−	O
b	O
)	O
c	O
(	O
d	O
−	O
a	O
)	O
0	O
0	O
−a	O
(	O
d	O
−	O
c	O
)	O
a	O
(	O
d	O
−	O
b	O
)	O
−b	O
(	O
d	O
−	O
a	O
)	O
0	O
	O
(	O
20.6	O
)	O
(	O
20.7	O
)	O
which	O
the	O
reader	O
may	O
verify	O
satisﬁes	O
the	O
four	O
linear	O
constraints	B
as	O
well	O
as	O
the	O
zero-	O
determinant	O
condition	O
.	O
the	O
task	O
at	O
hand	O
is	O
to	O
retrieve	O
the	O
values	O
of	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
given	O
the	O
fundamental	B
matrix	I
.	O
this	O
seemingly	O
requires	O
a	O
solution	B
of	O
simultaneous	O
quadratic	O
equations	O
,	O
but	O
there	O
is	O
a	O
linear	B
method	O
as	O
follows	O
.	O
(	O
i	O
)	O
the	O
ratio	O
a	O
:	O
b	O
:	O
c	O
may	O
be	O
found	O
by	O
solving	B
the	O
set	O
of	O
homogeneous	O
linear	O
equations	O
	O
f12	O
f21	O
f13	O
0	O
0	O
f31	O
0	O
f23	O
f32	O
	O
=	O
0	O
	O
	O
a	O
b	O
c	O
where	O
fij	O
is	O
the	O
ij-th	O
entry	O
of	O
ˆf	O
.	O
the	O
matrix	B
appearing	O
here	O
clearly	O
has	O
the	O
same	O
rank	O
as	O
ˆf	O
(	O
namely	O
2	O
)	O
,	O
so	O
there	O
is	O
a	O
unique	O
solution	B
(	O
up	O
to	O
scale	O
)	O
to	O
this	O
equation	O
set	O
.	O
the	O
solution	B
a	O
:	O
b	O
:	O
c	O
=	O
a	O
:	O
b	O
:	O
c	O
provides	O
a	O
set	O
of	O
homogeneous	O
equations	O
in	O
a	O
,	O
b	O
and	O
c	O
,	O
namely	O
ba	O
=	O
ab	O
,	O
ca	O
=	O
ac	O
and	O
cb	O
=	O
bc	O
,	O
of	O
which	O
two	O
are	O
linearly	O
independent	O
.	O
(	O
ii	O
)	O
similarly	O
,	O
one	O
may	O
ﬁnd	O
the	O
ratio	O
d	O
−	O
a	O
:	O
d	O
−	O
b	O
:	O
d	O
−	O
c	O
by	O
solving	B
(	O
d	O
−	O
a	O
,	O
d	O
−	O
b	O
,	O
d	O
−	O
c	O
)	O
ˆf	O
=	O
0.	O
once	O
again	O
,	O
the	O
solution	B
is	O
unique	O
.	O
this	O
provides	O
two	O
more	O
linear	B
equations	I
in	O
the	O
values	O
of	O
a	O
,	O
b	O
,	O
c	O
,	O
d.	O
(	O
iii	O
)	O
from	O
the	O
set	O
of	O
equations	O
one	O
may	O
solve	O
for	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
up	O
to	O
scale	O
,	O
and	O
hence	O
reconstruct	O
the	O
second	O
camera	B
matrix	I
according	O
to	O
(	O
20.5	O
)	O
.	O
20.2.4	O
solving	O
for	O
six	O
points	O
in	O
three	O
views	O
the	O
minimal	O
case	O
involving	O
the	O
computation	B
of	I
the	O
reduced	B
fundamental	I
matrix	I
in-	O
volves	O
three	O
point	B
,	O
in	O
which	O
case	O
there	O
may	O
be	O
three	O
solutions	O
.	O
by	O
dualization	O
,	O
this	O
leads	O
to	O
a	O
solution	B
to	O
the	O
reconstruction	B
problem	O
for	O
six	O
points	O
in	O
three	O
views	O
.	O
its	O
use	O
in	O
outlier	O
detection	O
using	O
the	O
trifocal	B
tensor	I
has	O
been	O
described	O
in	O
algorithm	O
16.4	O
(	O
p401	O
)	O
.	O
because	O
of	O
its	O
intrinsic	O
interest	O
as	O
a	O
minimum-case	O
solution	B
,	O
and	O
because	O
of	O
its	O
prac-	O
tical	O
use	O
,	O
the	O
algorithm	B
is	O
given	O
explicitly	O
as	O
algorithm	O
20.1.	O
the	O
algorithm	B
consists	O
essentially	O
of	O
putting	O
together	O
what	O
has	O
been	O
described	O
previously	O
.	O
however	O
there	O
are	O
a	O
few	O
minor	O
variations	O
.	O
in	O
algorithm	O
20.1	O
,	O
the	O
ﬁnal	O
estimation	B
of	I
the	O
camera	B
matrices	I
takes	O
place	O
in	O
the	O
domain	O
of	O
the	O
original	O
point	B
measurements	O
.	O
as	O
an	O
alternative	O
,	O
one	O
could	O
apply	O
a	O
dlt	O
algorithm	B
in	O
the	O
dual	B
domain	O
,	O
as	O
in	O
the	O
basic	O
algorithm	O
of	O
section	O
20.1.1.	O
however	O
,	O
the	O
present	O
method	O
seems	O
simpler	O
.	O
it	O
has	O
the	O
advantage	O
of	O
avoiding	O
the	O
need	O
for	O
applying	O
the	O
inverse	O
transformations	O
t	O
,	O
t	O
(	O
cid:2	O
)	O
.	O
more	O
signiﬁcantly	O
the	O
ﬁnal	O
computation	B
of	I
the	O
camera	B
matrices	I
is	O
carried	O
out	O
using	O
the	O
original	O
data	O
.	O
this	O
is	O
important	O
,	O
because	O
the	O
transformations	O
can	O
severely	O
skew	O
the	O
noise	B
characteristics	O
of	O
the	O
data	O
.	O
,	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
the	O
basis	O
for	O
this	O
algorithm	B
and	O
the	O
n-view	O
case	O
to	O
follow	O
is	O
the	O
dual	B
fundamental	O
20.2	O
reduced	B
reconstruction	O
objective	O
given	O
a	O
set	O
of	O
six	O
point	B
correspondences	O
xj	O
↔	O
x	O
(	O
cid:1	O
)	O
pute	O
a	O
reconstruction	B
from	O
these	O
points	O
,	O
consisting	O
of	O
the	O
three	O
camera	B
matrices	I
p	O
,	O
p	O
(	O
cid:1	O
)	O
and	O
the	O
six	O
3d	O
points	O
x1	O
,	O
.	O
.	O
.	O
,	O
x6	O
.	O
algorithm	B
j	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
j	O
across	O
three	O
views	O
,	O
com-	O
and	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
511	O
(	O
i	O
)	O
select	O
a	O
set	O
of	O
four	O
points	O
no	O
three	O
of	O
which	O
are	O
collinear	O
in	O
any	O
of	O
the	O
three	O
views	O
.	O
let	O
these	O
be	O
the	O
correspondences	B
x2+k	O
↔	O
x	O
(	O
cid:1	O
)	O
t	O
to	O
the	O
other	O
two	O
points	O
x1	O
and	O
x2	O
resulting	O
in	O
points	O
ˆx1	O
=	O
tx1	O
and	O
ˆx2	O
=	O
tx2	O
.	O
(	O
ii	O
)	O
for	O
the	O
ﬁrst	O
view	O
,	O
ﬁnd	O
a	O
projective	B
transformation	I
t	O
that	O
maps	O
each	O
x2+k	O
to	O
ek	O
.	O
apply	O
(	O
iii	O
)	O
from	O
the	O
dual	B
correspondence	O
ˆx1	O
↔	O
ˆx2	O
derive	O
an	O
equation	O
in	O
the	O
entries	O
p	O
,	O
q	O
,	O
r	O
,	O
s	O
,	O
t	O
of	O
the	O
reduced	O
fundamental	B
matrix	I
ˆf	O
as	O
in	O
(	O
20.4	O
)	O
.	O
the	O
equation	O
is	O
derived	O
from	O
the	O
relationship	O
ˆxt	O
2+k	O
for	O
k	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
4	O
.	O
2+k	O
↔	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
2	O
ˆfˆx1	O
=	O
0	O
.	O
(	O
iv	O
)	O
in	O
the	O
same	O
way	O
as	O
in	O
the	O
last	O
two	O
steps	O
,	O
form	O
two	O
more	O
equations	O
from	O
the	O
points	O
in	O
the	O
other	O
two	B
views	I
.	O
this	O
results	O
in	O
a	O
set	O
of	O
three	O
homogeneous	O
equations	O
in	O
ﬁve	O
unknowns	O
.	O
there	O
will	O
be	O
a	O
two-parameter	O
family	O
of	O
solutions	O
for	O
the	O
reduced	B
fundamental	I
matrix	I
,	O
generated	O
by	O
two	O
independent	O
solutions	O
ˆf1	O
and	O
ˆf2	O
.	O
(	O
v	O
)	O
the	O
general	O
solution	O
is	O
ˆf	O
=	O
λˆf1	O
+	O
µˆf2	O
.	O
from	O
the	O
requirement	O
det	O
ˆf	O
=	O
0	O
one	O
derives	O
a	O
homogeneous	O
cubic	O
equation	O
in	O
(	O
λ	O
,	O
µ	O
)	O
,	O
which	O
one	O
may	O
solve	O
to	O
ﬁnd	O
(	O
λ	O
,	O
µ	O
)	O
,	O
and	O
hence	O
ˆf	O
.	O
there	O
will	O
be	O
1	O
or	O
3	O
real	O
solutions	O
.	O
further	O
steps	O
are	O
applied	O
to	O
each	O
solution	B
in	O
turn	O
.	O
(	O
vi	O
)	O
use	O
the	O
method	O
of	O
section	O
20.2.3	O
to	O
extract	O
the	O
parameters	B
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
t	O
of	O
the	O
second	O
(	O
cid:1	O
)	O
reduced	B
camera	I
matrix	I
ˆp	O
deﬁned	O
in	O
(	O
20.5	O
)	O
.	O
(	O
vii	O
)	O
we	O
complete	O
the	O
reconstruction	B
in	O
the	O
original	O
measurement	O
domain	O
.	O
the	O
dual	B
of	O
cam-	O
(	O
cid:1	O
)	O
deﬁned	O
by	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
is	O
the	O
point	B
x2	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
t.	O
thus	O
the	O
six	O
3d	O
points	O
are	O
era	O
ˆp	O
x1	O
=	O
(	O
1	O
,	O
1	O
,	O
1	O
,	O
1	O
)	O
t	O
,	O
x2	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
t	O
and	O
x2+k	O
=	O
ek	O
for	O
k	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
4.	O
this	O
gives	O
the	O
structure	B
of	O
the	O
reconstructed	O
scene	O
.	O
one	O
may	O
then	O
compute	O
the	O
three	O
camera	B
matrices	I
using	O
the	O
dlt	O
algorithm	B
for	O
camera	B
calibration	I
described	O
in	O
section	O
7.1	O
(	O
p178	O
)	O
.	O
since	O
we	O
require	O
the	O
camera	B
matrices	I
deﬁned	O
with	O
respect	O
to	O
the	O
original	O
camera	B
coordinates	O
here	O
,	O
we	O
use	O
the	O
original	O
coordinates	B
to	O
solve	O
for	O
p	O
,	O
p	O
(	O
cid:1	O
)	O
such	O
that	O
pxj	O
=	O
xj	O
,	O
etc	O
.	O
since	O
the	O
solution	B
will	O
be	O
exact	O
,	O
the	O
dlt	O
solution	B
will	O
be	O
sufﬁcient	O
.	O
and	O
p	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
algorithm	B
20.1.	O
algorithm	B
for	O
computing	O
a	O
projective	O
reconstruction	B
from	O
six	O
points	O
in	O
three	O
views	O
.	O
matrix	B
,	O
ˆf	O
.	O
note	O
how	O
the	O
dual	B
fundamental	O
matrix	B
expresses	O
a	O
relationship	O
between	O
points	O
in	O
the	O
same	O
image	O
.	O
indeed	O
the	O
equations	O
used	O
to	O
solve	O
for	O
ˆf	O
are	O
constructed	O
from	O
points	O
in	O
the	O
same	O
image	O
.	O
this	O
contrasts	O
with	O
the	O
standard	O
fundamental	B
matrix	I
where	O
the	O
relationships	O
being	O
encoded	O
are	O
between	O
points	O
seen	O
in	O
separate	O
images	O
.	O
20.2.5	O
six	O
points	O
in	O
n	O
views	O
the	O
method	O
for	O
six	O
points	O
in	O
three	O
views	O
can	O
be	O
applied	O
with	O
little	O
modiﬁcation	O
to	O
the	O
case	O
of	O
six	O
points	O
in	O
many	O
views	O
.	O
the	O
main	O
difference	O
is	O
that	O
the	O
reduced	B
fundamental	I
matrix	I
ˆf	O
will	O
be	O
uniquely	O
determined	O
by	O
the	O
data	O
.	O
speciﬁcally	O
at	O
step	O
4	O
of	O
the	O
algorithm	O
of	O
section	O
20.2.4	O
,	O
each	O
view	O
will	O
contribute	O
one	O
equation	O
.	O
with	O
four	O
views	O
or	O
more	O
,	O
this	O
will	O
be	O
sufﬁcient	O
to	O
determine	O
ˆf	O
.	O
in	O
this	O
redundant-data	O
case	O
,	O
one	O
must	O
be	O
careful	O
with	O
the	O
effects	O
of	O
noise	O
.	O
for	O
this	O
reason	O
,	O
it	O
appears	O
preferable	O
to	O
carry	O
out	O
the	O
last	O
step	O
of	O
the	O
algorithm	O
,	O
as	O
shown	O
,	O
with	O
original	O
untransformed	O
points	O
.	O
this	O
mitigates	O
the	O
effect	O
of	O
noise	O
distortion	B
that	O
would	O
result	O
from	O
working	O
with	O
transformed	O
points	O
.	O
512	O
20	O
duality	B
20.2.6	O
seven	O
points	O
in	O
n	O
views	O
the	O
problem	O
of	O
seven	O
points	O
in	O
n	O
views	O
is	O
dual	O
to	O
the	O
case	O
of	O
three	O
views	O
of	O
n+4	O
points	O
and	O
is	O
solved	O
by	O
computing	B
the	O
reduced	B
trifocal	I
tensor	I
from	O
n	O
point	B
correspondences	O
.	O
deﬁnition	B
20.6.	O
a	O
trifocal	B
tensor	I
t	O
is	O
called	O
a	O
reduced	B
trifocal	I
tensor	I
if	O
it	O
satisﬁes	O
the	O
linear	B
constraints	O
imposed	O
by	O
synthetic	O
point	O
correspondences	B
ek	O
↔	O
e	O
(	O
cid:2	O
)	O
k	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
.	O
↔	O
e	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
k	O
the	O
general	O
method	O
for	O
reconstruction	O
from	O
7	O
points	O
is	O
similar	O
to	O
the	O
method	O
for	O
six	O
points	O
in	O
n	O
views	O
,	O
except	O
that	O
the	O
reduced	B
trifocal	I
tensor	I
is	O
used	O
instead	O
of	O
the	O
reduced	O
fundamental	B
matrix	I
.	O
there	O
are	O
,	O
however	O
some	O
minor	O
differences	O
.	O
in	O
computing	O
the	O
reduced	B
trifocal	I
tensor	I
,	O
the	O
constraints	B
corresponding	O
to	O
the	O
syn-	O
thetic	O
correspondences	B
ej	O
↔	O
ej	O
↔	O
ej	O
should	O
be	O
satisﬁed	O
exactly	O
,	O
whereas	O
the	O
other	O
correspondences	B
used	O
to	O
compute	O
the	O
tensor	B
are	O
subject	O
to	O
noise	O
,	O
and	O
will	O
only	O
be	O
sat-	O
isﬁed	O
approximately	O
.	O
otherwise	O
the	O
computed	O
tensor	O
will	O
not	O
be	O
exactly	O
in	O
reduced	O
form	O
.	O
in	O
the	O
case	O
of	O
the	O
reduced	O
fundamental	B
matrix	I
this	O
was	O
handled	O
by	O
giving	O
a	O
spe-	O
ciﬁc	O
parametrization	B
of	I
the	O
reduced	B
fundamental	I
matrix	I
.	O
that	O
is	O
,	O
it	O
was	O
parametrized	O
in	O
such	O
a	O
way	O
that	O
the	O
constraints	B
generated	O
by	O
the	O
synthetic	O
correspondences	O
were	O
au-	O
tomatically	O
satisﬁed	O
(	O
see	O
(	O
20.4	O
)	O
)	O
.	O
in	O
the	O
case	O
of	O
the	O
trifocal	O
tensor	B
,	O
it	O
is	O
not	O
obvious	O
that	O
such	O
a	O
convenient	O
parametrization	B
is	O
possible	O
.	O
the	O
synthetic	O
constraints	O
are	O
of	O
the	O
form	O
eiepeqjprkqst	O
jk	O
i	O
=	O
0rs	O
which	O
is	O
rather	O
more	O
complicated	O
than	O
the	O
linear	B
constraints	O
on	O
the	O
reduced	B
fundamen-	O
tal	O
matrix	B
.	O
instead	O
,	O
one	O
may	O
proceed	O
in	O
the	O
following	O
manner	O
.	O
in	O
the	O
usual	O
linear	B
method	O
of	O
computing	O
the	O
trifocal	B
tensor	I
,	O
one	O
must	O
solve	O
a	O
set	O
of	O
linear	O
equations	O
of	O
the	O
form	O
at	O
=	O
0	O
,	O
or	O
more	O
precisely	O
,	O
ﬁnd	O
the	O
vector	O
t	O
that	O
mini-	O
mizes	O
(	O
cid:10	O
)	O
at	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
1.	O
in	O
solving	O
for	O
the	O
reduced	B
trifocal	I
tensor	I
,	O
the	O
matrix	B
a	O
may	O
be	O
divided	O
into	O
two	O
parts	O
,	O
corresponding	O
to	O
those	O
constraints	B
from	O
the	O
synthetic	O
correspondences	O
,	O
which	O
should	O
be	O
satisﬁed	O
exactly	O
,	O
and	O
the	O
constraints	B
from	O
real	O
corre-	O
spondences	O
,	O
which	O
must	O
be	O
satisﬁed	O
in	O
a	O
least-squares	O
sense	O
.	O
the	O
ﬁrst	O
set	O
of	O
constraints	O
are	O
of	O
the	O
form	O
ct	O
=	O
0	O
,	O
and	O
the	O
second	O
set	O
may	O
be	O
written	O
as	O
ˆat	O
=	O
0.	O
the	O
problem	O
becomes	O
:	O
ﬁnd	O
t	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ˆat	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
1	O
and	O
ct	O
=	O
0.	O
an	O
algorithm	B
for	O
solving	B
this	O
problem	O
is	O
given	O
as	O
algorithm	O
a5.5	O
(	O
p594	O
)	O
.	O
for	O
the	O
problem	O
of	O
extracting	O
the	O
three	O
camera	B
matrices	I
from	O
the	O
reduced	B
tensor	O
no	O
simple	O
method	O
seems	O
to	O
be	O
available	O
,	O
similar	O
to	O
that	O
described	O
in	O
section	O
20.2.3	O
for	O
the	O
fundamental	B
matrix	I
.	O
instead	O
,	O
one	O
may	O
use	O
the	O
method	O
described	O
in	O
steps	O
5	O
and	O
6	O
of	O
the	O
general	O
dual	B
algorithm	I
(	O
see	O
page	O
505	O
)	O
.	O
the	O
minimal	B
conﬁguration	I
of	O
this	O
type	O
is	O
seven	O
points	O
in	O
two	B
views	I
.	O
in	O
this	O
case	O
,	O
the	O
problem	O
is	O
best	O
solved	O
directly	O
by	O
the	O
method	O
of	O
section	O
11.1.2	O
(	O
p281	O
)	O
,	O
rather	O
than	O
by	O
dualization	O
to	O
the	O
case	O
of	O
three	O
points	O
in	O
six	O
views	O
.	O
20.2.7	O
performance	B
issues	O
dual	O
reconstruction	O
algorithms	O
based	O
on	O
the	O
reduced	B
fundamental	I
matrix	I
and	O
trifocal	B
tensor	I
have	O
been	O
implemented	O
and	O
tested	O
.	O
the	O
results	O
of	O
these	O
tests	O
were	O
contained	O
20.3	O
closure	O
513	O
in	O
a	O
student	O
report	O
presented	O
in	O
august	O
1996	O
by	O
gilles	O
debunne	O
.	O
since	O
this	O
report	O
is	O
effectively	O
unavailable	O
,	O
the	O
results	O
are	O
summarized	O
here	O
.	O
the	O
most	O
serious	O
difﬁculty	O
is	O
the	O
distortion	B
of	O
the	O
noise	B
distribution	O
by	O
the	O
applica-	O
tion	O
of	O
projective	O
transformations	O
ti	O
to	O
the	O
images	O
.	O
application	O
of	O
projective	B
transfor-	O
mations	O
to	O
the	O
image	O
data	O
has	O
the	O
effect	O
of	O
distorting	O
any	O
noise	B
distribution	O
that	O
may	O
apply	O
to	O
the	O
data	O
.	O
the	O
problem	O
is	O
related	O
to	O
the	O
need	O
to	O
choose	O
four	O
points	O
that	O
are	O
non-	O
collinear	O
in	O
any	O
of	O
the	O
images	O
.	O
if	O
the	O
points	O
are	O
close	O
to	O
collinear	O
in	O
any	O
of	O
the	O
images	O
,	O
then	O
the	O
projective	B
transformation	I
applied	O
to	O
the	O
image	O
in	O
step	O
1	O
of	O
the	O
algorithm	O
may	O
entail	O
extreme	O
distortion	B
of	O
the	O
image	O
.	O
this	O
sort	O
of	O
distortion	O
can	O
degrade	O
performance	B
of	O
the	O
algorithm	B
severely	O
.	O
without	O
special	O
attention	O
being	O
paid	O
to	O
the	O
noise-distortion	O
,	O
performance	B
of	O
the	O
algo-	O
rithms	O
was	O
generally	O
unsatisfactory	O
,	O
despite	O
great	O
care	O
being	O
taken	O
to	O
minimize	O
errors	O
due	O
to	O
noise	O
in	O
steps	O
4–6	O
of	O
the	O
algorithm	O
(	O
page	O
505f	O
f	O
)	O
,	O
when	O
the	O
inverse	O
projective	B
transformations	O
are	O
applied	O
in	O
step	O
7	O
,	O
the	O
average	O
error	B
became	O
very	O
large	O
.	O
some	O
points	O
retained	O
quite	O
small	O
error	B
,	O
whereas	O
in	O
those	O
images	O
where	O
distortion	B
was	O
signiﬁcant	O
,	O
quite	O
large	O
errors	O
resulted	O
.	O
normalization	B
in	O
the	O
sense	O
of	O
section	O
4.4.4	O
(	O
p107	O
)	O
is	O
also	O
a	O
problem	O
.	O
it	O
has	O
been	O
shown	O
to	O
be	O
essential	O
for	O
performance	B
of	O
the	O
linear	B
reconstruction	O
algorithms	O
to	O
ap-	O
ply	O
data	O
normalization	B
.	O
however	O
,	O
what	O
sort	O
of	O
normalization	O
should	O
be	O
applied	O
to	O
the	O
transformed	O
data	O
of	O
ﬁgure	O
20.1	O
(	O
right	O
)	O
,	O
which	O
is	O
geometrically	O
unrelated	O
to	O
actual	O
image	O
measurements	O
,	O
is	O
a	O
mystery	O
.	O
to	O
get	O
good	O
results	O
,	O
it	O
would	O
seem	O
that	O
one	O
would	O
need	O
to	O
propagate	O
assumed	O
error	B
distributions	O
forward	O
in	O
step	O
1	O
of	O
the	O
algorithm	O
to	O
get	O
assumed	O
error	B
distributions	O
for	O
the	O
transformed	O
data	O
ﬁgure	O
20.1	O
(	O
right	O
)	O
,	O
and	O
then	O
during	O
reconstruction	B
to	O
minimize	O
residual	B
error	O
relative	O
to	O
this	O
propagated	O
error	B
distribution	O
.	O
equivalently	O
,	O
cost	B
functions	I
being	O
minimized	O
during	O
reconstruction	B
must	O
be	O
related	O
back	O
to	O
measurement	O
error	O
in	O
the	O
original	O
image	O
points	O
.	O
recent	O
work	O
reported	O
in	O
[	O
hartley-00a	O
,	O
schaffalitzky-00c	O
]	O
has	O
shown	O
that	O
this	O
indeed	O
gives	O
signiﬁcantly	O
improved	O
results	O
.	O
20.3	O
closure	O
20.3.1	O
the	O
literature	O
the	O
idea	O
behind	O
carlsson–weinshall	O
duality	B
was	O
ﬁrst	O
described	O
in	O
a	O
pair	O
of	O
papers	O
ap-	O
pearing	O
simultaneously	O
:	O
[	O
carlsson-95	O
]	O
and	O
weinshall	O
[	O
weinshall-95	O
]	O
and	O
subsequently	O
in	O
a	O
joint	O
paper	O
[	O
carlsson-98	O
]	O
.	O
the	O
treatment	O
given	O
here	O
for	O
the	O
general	O
method	O
of	O
du-	O
alizing	O
an	O
algorithm	B
was	O
given	O
in	O
[	O
hartley-98b	O
]	O
,	O
derived	O
from	O
these	O
earlier	O
papers	O
.	O
details	O
of	O
methods	O
for	O
handling	O
with	O
noise	O
propagation	O
were	O
given	O
in	O
[	O
hartley-00a	O
]	O
,	O
building	O
on	O
earlier	O
implementations	O
contained	O
in	O
an	O
unavailable	O
report	O
by	O
gilles	O
de-	O
bunne	O
(	O
august	O
1996	O
)	O
.	O
the	O
problem	O
of	O
reconstruction	B
from	O
six	O
points	O
in	O
three	O
views	O
was	O
perhaps	O
ﬁrst	O
treated	O
in	O
a	O
technical	O
report	O
[	O
hartley-92b	O
]	O
(	O
later	O
published	O
as	O
[	O
hartley-94c	O
]	O
)	O
where	O
the	O
exis-	O
tence	O
of	O
up	O
to	O
eight	O
solutions	O
was	O
shown	O
.	O
the	O
problem	O
was	O
given	O
a	O
complete	O
solution	B
in	O
[	O
quan-94	O
]	O
where	O
it	O
was	O
shown	O
that	O
only	O
three	O
solutions	O
are	O
possible	O
.	O
this	O
was	O
also	O
pointed	O
out	O
in	O
[	O
ponce-94	O
]	O
.	O
the	O
paper	O
[	O
carlsson-95	O
]	O
established	O
that	O
this	O
problem	O
is	O
514	O
20	O
duality	B
dual	O
to	O
the	O
two-view	O
,	O
seven	O
point	B
problem	O
for	O
which	O
a	O
solution	B
was	O
known	O
.	O
this	O
en-	O
abled	O
the	O
formulation	O
of	O
the	O
method	O
given	O
in	O
this	O
chapter	O
.	O
the	O
minimum	O
six	O
point	B
conﬁguration	O
was	O
used	O
in	O
[	O
torr-97	O
]	O
for	O
robust	O
estimation	B
of	I
the	O
trifocal	B
tensor	I
.	O
an	O
al-	O
ternative	O
method	O
for	O
computing	O
a	O
reconstruction	B
from	O
six	O
points	O
in	O
n	O
≥	O
3	O
views	O
is	O
given	O
in	O
[	O
schaffalitzky-00c	O
]	O
.	O
this	O
method	O
does	O
not	O
require	O
that	O
images	O
are	O
ﬁrst	O
projectively	O
transformed	O
to	O
a	O
canonical	O
basis	O
.	O
20.3.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
in	O
the	O
dual	B
algorithm	I
of	O
section	O
20.1.1	O
it	O
was	O
noted	O
that	O
the	O
method	O
will	O
only	O
work	O
if	O
the	O
four	O
points	O
used	O
to	O
deﬁne	O
the	O
image	O
transformations	O
are	O
non-	O
coplanar	O
.	O
however	O
,	O
note	O
that	O
in	O
this	O
case	O
,	O
the	O
algorithm	B
of	O
section	O
18.5.2	O
(	O
p450	O
)	O
will	O
compute	O
a	O
projective	B
reconstruction	I
linearly	O
.	O
(	O
ii	O
)	O
if	O
the	O
four	O
chosen	O
points	O
are	O
coplanar	O
,	O
then	O
the	O
homographies	B
ti	O
will	O
map	O
the	O
plane	B
to	O
a	O
common	O
coordinate	O
system	O
.	O
the	O
transformed	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
j	O
will	O
then	O
satisfy	O
the	O
condition	O
of	O
section	O
17.5.2	O
(	O
p425	O
)	O
,	O
namely	O
the	O
lines	B
joining	O
any	O
pair	O
of	B
points	I
x	O
(	O
cid:2	O
)	O
i	O
k	O
(	O
j	O
and	O
k	O
ﬁxed	O
and	O
a	O
different	O
line	B
for	O
each	O
i	O
)	O
will	O
meet	O
in	O
a	O
common	O
point	B
.	O
the	O
duality	B
in	O
the	O
case	O
is	O
described	O
in	O
[	O
criminisi-98	O
,	O
irani-98	O
]	O
.	O
(	O
iii	O
)	O
still	O
in	O
the	O
case	O
of	O
the	O
four	O
chosen	O
points	O
being	O
coplanar	O
:	O
after	O
applying	O
the	O
ti	O
,	O
any	O
point	B
on	O
the	O
plane	B
of	O
the	O
four	O
points	O
will	O
map	O
to	O
the	O
same	O
point	O
in	O
all	O
im-	O
ages	O
.	O
thus	O
,	O
the	O
fundamental	B
matrix	I
consistent	O
with	O
the	O
point	B
correspondences	O
will	O
be	O
skew-symmetric	O
.	O
j	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
21	O
cheirality	O
when	O
a	O
projective	B
reconstruction	I
of	O
a	O
scene	O
is	O
carried	O
out	O
from	O
a	O
set	O
of	O
point	O
corre-	O
spondences	O
,	O
an	O
important	O
piece	O
of	O
information	O
is	O
typically	O
ignored	O
–	O
if	O
the	O
points	O
are	O
visible	O
in	O
the	O
images	O
,	O
then	O
they	O
must	O
have	O
been	O
in	O
front	O
of	O
the	O
camera	O
.	O
in	O
general	O
,	O
a	O
projective	B
reconstruction	I
of	O
a	O
scene	O
will	O
not	O
bear	O
a	O
close	O
resemblance	O
to	O
the	O
real	O
scene	O
when	O
interpreted	O
as	O
if	O
the	O
coordinate	O
frame	O
were	O
euclidean	O
.	O
the	O
scene	O
is	O
often	O
split	O
across	O
the	O
plane	O
at	O
inﬁnity	O
,	O
as	O
is	O
illustrated	O
in	O
two	O
dimensions	O
by	O
ﬁgure	O
21.1.	O
it	O
is	O
pos-	O
sible	O
to	O
come	O
much	O
closer	O
to	O
at	O
least	O
an	O
afﬁne	B
reconstruction	I
of	O
the	O
scene	O
by	O
taking	O
this	O
simple	O
constraint	O
into	O
account	O
.	O
the	O
resulting	O
reconstruction	B
is	O
called	O
“	O
quasi-afﬁne	B
”	O
in	O
that	O
it	O
lies	O
part	O
way	O
between	O
a	O
projective	B
and	O
afﬁne	B
reconstruction	I
.	O
scene	O
objects	O
are	O
no	O
longer	O
split	O
across	O
the	O
plane	O
at	O
inﬁnity	O
,	O
though	O
they	O
may	O
still	O
suffer	O
projective	B
distortion	O
.	O
converting	O
a	O
projective	B
reconstruction	I
to	O
quasi-afﬁne	B
is	O
extremely	O
simple	O
if	O
one	O
ne-	O
glects	O
the	O
cameras	B
and	O
requires	O
only	O
that	O
the	O
scene	O
be	O
of	O
the	O
correct	O
quasi-afﬁne	B
form	O
–	O
in	O
fact	O
it	O
can	O
be	O
accomplished	O
in	O
about	O
two	O
lines	O
of	O
programming	O
(	O
see	O
corollary	O
21.9	O
)	O
.	O
to	O
handle	O
the	O
cameras	B
as	O
well	O
requires	O
the	O
solution	B
of	O
a	O
linear	B
programming	O
problem	O
.	O
21.1	O
quasi-afﬁne	B
transformations	O
a	O
subset	O
b	O
of	O
irn	O
is	O
called	O
convex	O
if	O
the	O
line	B
segment	O
joining	O
any	O
two	O
points	O
in	O
b	O
also	O
lies	O
entirely	O
within	O
b.	O
the	O
convex	B
hull	I
of	O
b	O
,	O
denoted	O
b	O
,	O
is	O
the	O
smallest	O
convex	O
set	O
containing	O
b.	O
our	O
main	O
concern	O
will	O
be	O
with	O
3-dimensional	O
point	B
sets	O
,	O
so	O
n	O
=	O
3.	O
we	O
view	O
ir3	O
as	O
being	O
a	O
subset	O
of	O
ip3	O
,	O
consisting	O
of	O
all	O
non-inﬁnite	O
points	O
.	O
the	O
inﬁnite	O
points	O
constitute	O
the	O
plane	O
at	O
inﬁnity	O
,	O
denoted	O
π∞	O
.	O
thus	O
,	O
ip3	O
=	O
ir3	O
∪	O
π∞	O
.	O
a	O
subset	O
of	O
ip3	O
will	O
be	O
called	O
convex	O
if	O
and	O
only	O
if	O
it	O
is	O
contained	O
in	O
ir3	O
and	O
is	O
convex	O
in	O
ir3	O
.	O
hence	O
,	O
according	O
to	O
this	O
deﬁnition	B
,	O
a	O
convex	O
set	O
does	O
not	O
contain	O
any	O
inﬁnite	O
points	O
.	O
deﬁnition	B
21.1.	O
consider	O
a	O
point	B
set	O
{	O
xi	O
}	O
⊂	O
ir3	O
⊂	O
ip3	O
.	O
a	O
projective	B
mapping	O
h	O
:	O
ip3	O
→	O
ip3	O
is	O
said	O
to	O
preserve	O
the	O
convex	B
hull	I
of	O
the	O
points	O
{	O
xi	O
}	O
if	O
(	O
i	O
)	O
h	O
(	O
xi	O
)	O
is	O
a	O
ﬁnite	B
point	O
for	O
all	O
i	O
,	O
and	O
(	O
ii	O
)	O
h	O
maps	O
the	O
convex	B
hull	I
of	O
points	O
{	O
xi	O
}	O
bijectively	O
onto	O
the	O
convex	B
hull	I
of	O
the	O
points	O
{	O
h	O
(	O
xi	O
)	O
}	O
.	O
515	O
516	O
21	O
cheirality	O
a	O
b	O
fig	O
.	O
21.1	O
.	O
(	O
a	O
)	O
an	O
image	O
of	O
a	O
comb	O
,	O
and	O
(	O
b	O
)	O
the	O
result	O
of	O
applying	O
a	O
projective	B
transformation	I
to	O
the	O
image	O
.	O
the	O
projective	B
transformation	I
does	O
not	O
however	O
preserve	O
the	O
convex	O
hull	O
of	O
the	O
set	O
of	B
points	I
constituting	O
the	O
comb	O
.	O
in	O
the	O
original	O
image	O
,	O
the	O
convex	B
hull	I
of	O
the	O
comb	O
is	O
a	O
ﬁnite	B
set	O
contained	O
within	O
the	O
extent	O
of	O
the	O
visible	O
image	O
.	O
however	O
,	O
some	O
of	O
the	O
points	O
in	O
this	O
convex	B
hull	I
are	O
mapped	O
to	O
inﬁnity	O
by	O
the	O
transformation	B
.	O
an	O
example	O
,	O
shown	O
in	O
ﬁgure	O
21.1	O
,	O
may	O
help	O
in	O
understanding	O
this	O
deﬁnition	B
.	O
the	O
example	O
deals	O
with	O
2d	O
point	B
sets	O
,	O
but	O
the	O
principle	O
is	O
the	O
same	O
.	O
the	O
ﬁgure	O
shows	O
an	O
image	O
of	O
a	O
comb	O
and	O
the	O
image	O
resampled	O
according	O
to	O
a	O
projective	B
mapping	O
.	O
the	O
projective	B
mapping	O
does	O
not	O
however	O
preserve	O
the	O
convex	O
hull	O
of	O
the	O
comb	O
.	O
most	O
people	O
will	O
agree	O
that	O
the	O
resampled	O
image	O
is	O
unlike	O
any	O
view	O
of	O
a	O
comb	O
seen	O
by	O
camera	B
or	O
human	O
eye	O
.	O
the	O
last	O
coordinate	O
is	O
equal	O
to	O
1.	O
the	O
property	O
of	O
preserving	O
the	O
convex	B
hull	I
of	O
a	O
set	O
of	B
points	I
may	O
be	O
characterized	O
in	O
various	O
different	O
ways	O
,	O
as	O
is	O
shown	O
by	O
the	O
theorem	O
to	O
be	O
given	O
shortly	O
.	O
in	O
order	O
to	O
state	O
this	O
theorem	O
,	O
we	O
introduce	O
a	O
new	O
notation	O
.	O
notation	O
.	O
the	O
symbol	O
(	O
cid:23	O
)	O
x	O
denotes	O
a	O
homogeneous	B
representation	I
of	O
a	O
point	B
x	O
in	O
which	O
3d	O
.	O
thus	O
for	O
instance	O
if	O
h	O
is	O
a	O
projective	B
transformation	I
,	O
we	O
may	O
write	O
h	O
(	O
cid:23	O
)	O
x	O
=	O
t	O
(	O
cid:2	O
)	O
(	O
cid:23	O
)	O
x	O
mean	O
that	O
the	O
transformation	B
takes	O
point	B
(	O
cid:23	O
)	O
x	O
to	O
point	O
(	O
cid:23	O
)	O
x	O
commonly	O
in	O
this	O
chapter	O
we	O
will	O
be	O
interested	O
in	O
the	O
exact	O
equalities	O
(	O
not	O
equalities	O
up	O
to	O
scale	O
)	O
between	O
vectors	O
representing	O
homogeneous	O
quantities	O
,	O
such	O
as	B
points	I
in	O
to	O
is	O
,	O
but	O
that	O
the	O
scale	O
factor	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
required	O
to	O
make	O
this	O
equality	O
exact	O
.	O
now	O
for	O
the	O
theorem	O
.	O
theorem	O
21.2.	O
consider	O
a	O
projective	B
transformation	I
h	O
:	O
ip3	O
→	O
ip3	O
and	O
a	O
set	O
of	B
points	I
{	O
xi	O
}	O
.	O
let	O
π∞	O
be	O
the	O
plane	B
mapped	O
to	O
inﬁnity	O
by	O
h.	O
the	O
following	O
statements	O
are	O
equivalent	B
.	O
(	O
i	O
)	O
h	O
preserves	O
the	O
convex	B
hull	I
of	O
the	O
points	O
{	O
xi	O
}	O
.	O
(	O
ii	O
)	O
˜x	O
∩	O
π∞	O
=	O
∅	O
for	O
any	O
point	B
˜x	O
in	O
the	O
convex	B
hull	I
of	O
the	O
points	O
{	O
xi	O
}	O
.	O
h	O
(	O
cid:23	O
)	O
xi	O
=	O
t	O
(	O
iii	O
)	O
let	O
h	O
be	O
a	O
matrix	B
representing	O
the	O
transformation	B
h	O
,	O
and	O
suppose	O
that	O
(	O
cid:2	O
)	O
i.	O
then	O
the	O
constants	O
t	O
(	O
cid:2	O
)	O
i	O
all	O
have	O
the	O
same	O
sign	O
.	O
(	O
cid:23	O
)	O
x	O
(	O
cid:2	O
)	O
i	O
21.1	O
quasi-afﬁne	B
transformations	O
517	O
t	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
,	O
˜y	O
,	O
˜z	O
(	O
cid:2	O
)	O
(	O
cid:23	O
)	O
x	O
is	O
equal	O
to	O
zero	O
.	O
this	O
means	O
that	O
h	O
˜x	O
=	O
(	O
˜x	O
proof	O
.	O
this	O
will	O
be	O
proved	O
by	O
showing	O
that	O
(	O
i	O
)	O
⇒	O
(	O
ii	O
)	O
⇒	O
(	O
iii	O
)	O
⇒	O
(	O
i	O
)	O
.	O
(	O
i	O
)	O
⇒	O
(	O
ii	O
)	O
.	O
if	O
h	O
preserves	O
the	O
convex	B
hull	I
of	O
the	O
points	O
,	O
then	O
h	O
(	O
˜x	O
)	O
is	O
a	O
ﬁnite	B
point	O
for	O
any	O
point	B
˜x	O
in	O
the	O
convex	B
hull	I
of	O
the	O
xi	O
.	O
so	O
˜x	O
∩	O
π∞	O
=	O
∅	O
.	O
(	O
ii	O
)	O
⇒	O
(	O
iii	O
)	O
.	O
consider	O
the	O
chord	O
joining	O
two	O
points	O
xi	O
and	O
xj	O
and	O
suppose	O
that	O
t	O
(	O
cid:2	O
)	O
i	O
and	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
is	O
a	O
continuous	O
function	O
j	O
(	O
as	O
in	O
part	O
(	O
iii	O
)	O
of	O
the	O
theorem	O
)	O
have	O
opposite	O
signs	O
.	O
since	O
t	O
t	O
of	O
the	O
coordinates	O
of	O
xi	O
,	O
there	O
must	O
be	O
a	O
point	B
˜x	O
lying	O
on	O
the	O
chord	O
from	O
xi	O
to	O
xj	O
for	O
(	O
cid:2	O
)	O
,	O
0	O
)	O
t.	O
since	O
˜x	O
is	O
in	O
the	O
which	O
t	O
convex	B
hull	I
of	O
the	O
points	O
{	O
xi	O
}	O
,	O
this	O
contradicts	O
(	O
ii	O
)	O
.	O
(	O
cid:23	O
)	O
x	O
(	O
iii	O
)	O
⇒	O
(	O
i	O
)	O
.	O
we	O
assume	O
that	O
there	O
exist	O
constants	O
t	O
(	O
cid:2	O
)	O
h	O
(	O
cid:23	O
)	O
x	O
=	O
t	O
(	O
cid:2	O
)	O
i	O
i	O
all	O
of	O
the	O
same	O
sign	O
such	O
that	O
h	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
cid:2	O
)	O
i.	O
let	O
s	O
be	O
the	O
subset	O
of	O
irn	O
consisting	O
of	O
all	O
points	O
x	O
satisfying	O
the	O
condition	O
i.	O
the	O
set	O
s	O
contains	O
{	O
xi	O
}	O
.	O
(	O
cid:2	O
)	O
it	O
if	O
xi	O
and	O
xj	O
are	O
points	O
in	O
s	O
with	O
corresponding	O
j.	O
to	O
see	O
this	O
,	O
consider	O
a	O
point	B
(	O
cid:23	O
)	O
x	O
=	O
α	O
(	O
cid:23	O
)	O
xi+	O
(	O
1−α	O
)	O
(	O
cid:23	O
)	O
xj	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
j	O
,	O
then	O
any	O
intermediate	O
point	B
x	O
between	O
xi	O
and	O
xj	O
must	O
have	O
t	O
(	O
cid:2	O
)	O
(	O
cid:23	O
)	O
x	O
4	O
(	O
α	O
(	O
cid:23	O
)	O
xi	O
+	O
(	O
1	O
−	O
α	O
)	O
(	O
cid:23	O
)	O
xj	O
)	O
=	O
ht	O
(	O
cid:23	O
)	O
xi	O
+	O
(	O
1−	O
α	O
)	O
ht	O
(	O
cid:23	O
)	O
xj	O
4	O
=	O
ht	O
=	O
αht	O
4	O
i	O
+	O
(	O
1−	O
α	O
)	O
t	O
(	O
cid:2	O
)	O
=	O
αt	O
will	O
be	O
shown	O
that	O
s	O
is	O
convex	O
.	O
constants	O
t	O
value	O
intermediate	O
between	O
t	O
where	O
0	O
≤	O
α	O
≤	O
1.	O
this	O
point	B
lies	O
between	O
xi	O
and	O
xj	O
.	O
denote	O
by	O
ht	O
then	O
,	O
has	O
the	O
same	O
sign	O
as	O
the	O
t	O
4	O
the	O
last	O
row	O
of	O
h.	O
(	O
cid:2	O
)	O
i	O
and	O
t	O
such	O
that	O
t	O
(	O
cid:2	O
)	O
i	O
and	O
t	O
(	O
cid:2	O
)	O
t	O
4	O
(	O
cid:2	O
)	O
j	O
(	O
cid:2	O
)	O
must	O
have	O
the	O
(	O
cid:2	O
)	O
j	O
as	O
claimed	O
.	O
consequently	O
,	O
the	O
value	O
of	O
t	O
(	O
cid:2	O
)	O
i	O
and	O
t	O
(	O
cid:2	O
)	O
j	O
,	O
and	O
so	O
x	O
lies	O
in	O
s	O
also	O
.	O
this	O
shows	O
that	O
s	O
is	O
convex	O
.	O
which	O
lies	O
between	O
t	O
(	O
cid:2	O
)	O
same	O
sign	O
as	O
t	O
i	O
and	O
t	O
now	O
,	O
let	O
˜s	O
be	O
a	O
convex	O
subset	O
of	O
s.	O
it	O
will	O
be	O
shown	O
that	O
h	O
(	O
˜s	O
)	O
is	O
also	O
convex	O
.	O
this	O
is	O
easily	O
seen	O
to	O
be	O
true	O
,	O
since	O
h	O
maps	O
a	O
line	B
segment	O
in	O
˜s	O
to	O
a	O
line	B
segment	O
that	O
does	O
not	O
cross	O
the	O
plane	O
at	O
inﬁnity	O
.	O
thus	O
,	O
h	O
maps	O
any	O
convex	O
set	O
˜s	O
such	O
that	O
s	O
⊃	O
˜s	O
⊃	O
{	O
xi	O
}	O
to	O
}	O
.	O
however	O
,	O
if	O
h	O
satisﬁes	O
condition	O
(	O
iii	O
)	O
,	O
then	O
(	O
cid:2	O
)	O
⊃	O
{	O
x	O
(	O
cid:2	O
)	O
a	O
convex	O
set	O
˜s	O
it	O
is	O
easily	O
seen	O
that	O
h−1	O
does	O
also	O
.	O
from	O
this	O
it	O
follows	O
that	O
the	O
above	O
correspondence	B
is	O
bijective	O
.	O
since	O
the	O
convex	B
hull	I
of	O
{	O
xi	O
}	O
(	O
or	O
{	O
x	O
(	O
cid:2	O
)	O
}	O
between	O
convex	O
sets	O
˜s	O
and	O
˜s	O
i	O
respectively	O
)	O
is	O
the	O
intersection	B
of	O
all	O
such	O
convex	O
sets	O
,	O
it	O
follows	O
that	O
h	O
preserves	O
the	O
convex	B
hull	I
of	O
the	O
points	O
.	O
(	O
cid:2	O
)	O
⊃	O
˜s	O
(	O
cid:2	O
)	O
such	O
that	O
s	O
(	O
cid:2	O
)	O
i	O
the	O
projective	B
transformations	O
that	O
preserve	O
the	O
convex	O
hull	O
of	O
a	O
given	O
set	O
of	B
points	I
form	O
an	O
important	O
class	O
,	O
and	O
will	O
be	O
called	O
quasi-afﬁne	B
transformations	O
.	O
deﬁnition	B
21.3.	O
let	O
b	O
be	O
a	O
subset	O
of	O
irn	O
and	O
let	O
h	O
be	O
a	O
projectivity	B
of	O
ipn	O
.	O
the	O
projec-	O
tivity	O
h	O
is	O
said	O
to	O
be	O
“	O
quasi-afﬁne	B
”	O
with	O
respect	O
to	O
the	O
set	O
b	O
if	O
h	O
preserves	O
the	O
convex	B
hull	I
of	O
the	O
set	O
b	O
.	O
−1	O
is	O
quasi-afﬁne	B
it	O
may	O
be	O
veriﬁed	O
that	O
if	O
h	O
is	O
quasi-afﬁne	B
with	O
respect	O
to	O
b	O
,	O
then	O
h	O
with	O
respect	O
to	O
h	O
(	O
b	O
)	O
.	O
furthermore	O
,	O
if	O
h	O
is	O
quasi-afﬁne	B
with	O
respect	O
to	O
b	O
and	O
g	O
is	O
quasi-afﬁne	B
with	O
respect	O
to	O
h	O
(	O
b	O
)	O
,	O
then	O
g	O
◦	O
h	O
is	O
quasi-afﬁne	B
with	O
respect	O
to	O
b.	O
thus	O
,	O
quasi-afﬁne	B
projectivities	O
may	O
be	O
composed	O
in	O
this	O
fashion	O
.	O
strictly	O
speaking	O
,	O
however	O
,	O
quasi-afﬁne	B
projectivities	O
with	O
respect	O
to	O
a	O
given	O
ﬁxed	O
set	O
of	B
points	I
do	O
not	O
form	O
a	O
group	O
.	O
518	O
21	O
cheirality	O
we	O
will	O
be	O
considering	O
sets	O
of	B
points	I
{	O
xi	O
}	O
and	O
{	O
x	O
(	O
cid:2	O
)	O
}	O
that	O
correspond	O
via	O
a	O
projectiv-	O
ity	O
.	O
when	O
we	O
speak	O
of	O
the	O
projectivity	O
being	O
quasi-afﬁne	B
,	O
we	O
will	O
mean	O
with	O
respect	O
to	O
the	O
set	O
{	O
xi	O
}	O
.	O
two-dimensional	B
quasi-afﬁne	O
mappings	O
two-dimensional	B
quasi-afﬁne	O
mappings	O
arise	O
as	O
transformations	O
between	O
planar	O
point	B
sets	O
in	O
3d	O
and	O
their	O
image	O
under	O
a	O
projective	B
camera	I
mapping	O
,	O
as	O
stated	O
formally	O
below	O
.	O
i	O
theorem	O
21.4.	O
if	O
b	O
is	O
a	O
point	B
set	O
in	O
a	O
plane	B
(	O
the	O
“	O
object	O
plane	B
”	O
)	O
in	O
ir3	O
and	O
b	O
lies	O
entirely	O
in	O
front	O
of	O
a	O
projective	O
camera	B
,	O
then	O
the	O
mapping	O
from	O
the	O
object	O
plane	B
to	O
the	O
image	B
plane	I
deﬁned	O
by	O
the	O
camera	B
is	O
quasi-afﬁne	B
with	O
respect	O
to	O
b.	O
proof	O
.	O
that	O
there	O
is	O
a	O
projectivity	B
h	O
mapping	O
the	O
object	O
plane	B
to	O
the	O
image	B
plane	I
is	O
well	O
known	O
.	O
what	O
is	O
to	O
be	O
proved	O
is	O
that	O
the	O
projectivity	B
is	O
quasi-afﬁne	B
with	O
respect	O
to	O
b.	O
let	O
l	O
be	O
the	O
line	B
in	O
which	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
meets	O
the	O
object	O
plane	B
.	O
since	O
b	O
lies	O
entirely	O
in	O
front	O
of	O
the	O
camera	O
,	O
l	O
does	O
not	O
meet	O
the	O
convex	B
hull	I
of	O
b.	O
however	O
,	O
by	O
deﬁnition	B
of	O
the	O
principal	B
plane	I
h	O
(	O
l	O
)	O
=	O
l∞	O
,	O
where	O
l∞	O
is	O
the	O
line	B
at	I
inﬁnity	I
in	O
the	O
image	B
plane	I
.	O
thus	O
,	O
one	O
deduces	O
that	O
h	O
(	O
b	O
)	O
∩	O
l∞	O
=	O
∅	O
,	O
and	O
hence	O
by	O
theorem	O
21.2	O
the	O
transformation	B
is	O
quasi-afﬁne	B
with	O
respect	O
to	O
b.	O
note	O
that	O
if	O
points	O
xi	O
are	O
visible	O
in	O
an	O
image	O
,	O
then	O
the	O
corresponding	O
object	O
points	O
must	O
lie	O
in	O
front	O
of	O
the	O
camera	O
.	O
applying	O
theorem	O
21.4	O
to	O
a	O
sequence	O
of	O
imaging	O
operations	O
(	O
for	O
instance	O
,	O
a	O
picture	B
of	O
a	O
picture	B
of	O
a	O
picture	B
,	O
etc	O
.	O
)	O
,	O
it	O
follows	O
that	O
the	O
original	O
and	O
ﬁnal	O
images	O
in	O
the	O
sequence	O
are	O
connected	O
by	O
a	O
planar	O
projectivity	O
which	O
is	O
quasi-afﬁne	B
with	O
respect	O
to	O
any	O
point	B
set	O
in	O
the	O
object	O
plane	B
visible	O
in	O
the	O
ﬁnal	O
image	O
.	O
similarly	O
,	O
if	O
two	O
images	O
are	O
taken	O
of	O
a	O
set	O
of	B
points	I
{	O
xi	O
}	O
in	O
a	O
plane	B
,	O
{	O
xi	O
}	O
and	O
{	O
x	O
(	O
cid:2	O
)	O
}	O
i	O
being	O
corresponding	O
points	O
in	O
the	O
two	O
images	O
,	O
then	O
there	O
is	O
a	O
quasi-afﬁne	B
mapping	I
(	O
with	O
respect	O
to	O
the	O
xi	O
)	O
mapping	O
each	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
i	O
,	O
and	O
so	O
theorem	O
21.2	O
applies	O
,	O
yielding	O
the	O
following	O
:	O
result	O
21.5.	O
if	O
{	O
xi	O
}	O
and	O
{	O
x	O
(	O
cid:2	O
)	O
}	O
are	O
corresponding	O
points	O
in	O
two	B
views	I
of	O
a	O
set	O
of	O
object	O
points	O
{	O
xi	O
}	O
lying	O
in	O
a	O
plane	B
,	O
then	O
there	O
is	O
a	O
matrix	B
h	O
representing	O
a	O
planar	O
projectivity	O
such	O
that	O
hˆxi	O
=	O
wiˆx	O
(	O
cid:2	O
)	O
i	O
and	O
all	O
wi	O
have	O
the	O
same	O
sign	O
.	O
i	O
21.2	O
front	O
and	O
back	O
of	O
a	O
camera	O
the	O
depth	O
of	O
a	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
with	O
respect	O
to	O
a	O
camera	B
was	O
shown	O
in	O
(	O
6.15–	O
p162	O
)	O
to	O
be	O
given	O
by	O
sign	O
(	O
det	O
m	O
)	O
w	O
depth	O
(	O
x	O
;	O
p	O
)	O
=	O
(	O
21.1	O
)	O
where	O
m	O
is	O
the	O
left	O
hand	O
3	O
×	O
3	O
block	O
of	O
p	O
,	O
m3	O
is	O
the	O
third	O
row	O
of	O
m	O
,	O
and	O
px	O
=	O
wˆx	O
.	O
this	O
expression	O
is	O
not	O
dependent	O
on	O
the	O
particular	O
homogeneous	B
representation	I
of	O
x	O
or	O
m	O
,	O
that	O
is	O
it	O
is	O
unchanged	O
by	O
multiplication	O
by	O
non-zero	O
scale	O
factors	O
.	O
this	O
deﬁnition	B
of	O
depth	O
is	O
used	O
to	O
determine	O
whether	O
a	O
point	B
is	O
in	O
front	O
of	O
a	O
camera	O
or	O
not	O
.	O
t	O
(	O
cid:10	O
)	O
m3	O
(	O
cid:10	O
)	O
result	O
21.6.	O
the	O
point	B
x	O
lies	O
in	O
front	O
of	O
the	O
camera	O
p	O
if	O
and	O
only	O
if	O
depth	O
(	O
x	O
;	O
p	O
)	O
>	O
0	O
.	O
21.3	O
three-dimensional	O
point	B
sets	O
519	O
in	O
fact	O
,	O
depth	O
is	O
positive	O
for	O
points	O
in	O
front	O
of	O
the	O
camera	O
,	O
negative	O
for	O
points	O
be-	O
hind	O
the	O
camera	B
,	O
inﬁnite	O
on	O
the	O
plane	O
at	O
inﬁnity	O
and	O
zero	O
on	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
.	O
if	O
the	O
camera	B
centre	I
or	O
the	O
point	B
x	O
is	O
at	B
inﬁnity	I
,	O
then	O
depth	O
is	O
not	O
deﬁned	O
.	O
usually	O
,	O
in	O
this	O
section	O
we	O
will	O
only	O
be	O
concerned	O
with	O
the	O
sign	O
of	O
depth	O
and	O
not	O
its	O
magnitude	O
.	O
we	O
may	O
then	O
write	O
depth	O
(	O
x	O
;	O
p	O
)	O
.	O
=	O
wt	O
det	O
m	O
(	O
21.2	O
)	O
where	O
the	O
symbol	O
.	O
=	O
indicates	O
equality	O
of	O
sign	O
.	O
the	O
quantity	O
sign	O
(	O
depth	O
(	O
x	O
;	O
p	O
)	O
)	O
will	O
be	O
referred	O
to	O
as	O
the	O
cheirality	O
of	O
the	O
point	O
x	O
with	O
respect	O
to	O
the	O
camera	B
p.	O
the	O
cheirality	O
of	O
a	O
point	O
is	O
said	O
to	O
be	O
reversed	O
by	O
a	O
transformation	B
if	O
it	O
is	O
swapped	O
from	O
1	O
to	O
−1	O
or	O
vice	O
versa	O
.	O
21.3	O
three-dimensional	O
point	B
sets	O
in	O
this	O
section	O
the	O
connection	O
between	O
cheirality	O
of	B
points	I
with	O
respect	O
to	O
a	O
camera	B
and	O
convex	O
hulls	O
of	O
point	O
sets	O
will	O
be	O
explained	O
.	O
the	O
main	O
result	O
is	O
stated	O
now	O
.	O
theorem	O
21.7.	O
let	O
pe	O
and	O
p	O
(	O
cid:2	O
)	O
e	O
be	O
two	O
cameras	O
,	O
xe	O
cameras	B
,	O
and	O
xi	O
and	O
x	O
(	O
cid:2	O
)	O
euclidean	O
.	O
)	O
i	O
a	O
set	O
of	B
points	I
lying	O
in	O
front	O
of	O
both	O
i	O
the	O
corresponding	O
image	O
points	O
.	O
(	O
the	O
superscript	O
e	O
stands	O
for	O
,	O
{	O
xi	O
}	O
)	O
be	O
any	O
projective	B
reconstruction	I
from	O
the	O
image	O
correspon-	O
dences	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
has	O
the	O
same	O
(	O
ii	O
)	O
if	O
each	O
xi	O
is	O
a	O
ﬁnite	B
point	O
,	O
and	O
p	O
(	O
cid:23	O
)	O
xi	O
=	O
wiˆxi	O
with	O
wi	O
having	O
the	O
same	O
sign	O
for	O
all	O
sign	O
for	O
all	O
i.	O
i	O
,	O
and	O
let	O
pxi	O
=	O
wiˆxi	O
and	O
p	O
(	O
cid:2	O
)	O
xi	O
=	O
w	O
iˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i.	O
then	O
wiw	O
(	O
i	O
)	O
let	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
i	O
,	O
then	O
there	O
exists	O
a	O
quasi-afﬁne	B
transformation	O
h	O
taking	O
each	O
xi	O
to	O
xe	O
i	O
.	O
note	O
that	O
the	O
condition	O
that	O
each	O
wiw	O
of	O
course	O
,	O
the	O
existence	O
of	O
a	O
projective	O
transformation	B
taking	O
each	O
xi	O
to	O
xe	O
i	O
is	O
guaran-	O
teed	O
by	O
theorem	O
10.1	O
(	O
p266	O
)	O
.	O
the	O
current	O
theorem	O
gives	O
the	O
extra	O
information	O
that	O
the	O
transformation	B
is	O
quasi-afﬁne	B
,	O
and	O
hence	O
one	O
has	O
a	O
quasi-afﬁne	B
reconstruction	I
.	O
(	O
cid:2	O
)	O
i	O
have	O
the	O
same	O
sign	O
is	O
unaffected	O
by	O
multiply-	O
ing	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
or	O
any	O
of	O
the	O
points	O
xi	O
by	O
a	O
scale	O
factor	O
,	O
and	O
hence	O
is	O
invariant	O
of	O
the	O
choice	O
of	O
homogeneous	O
representative	O
for	O
any	O
of	O
these	O
quantities	O
.	O
in	O
particular	O
,	O
if	O
p	O
is	O
multiplied	O
(	O
cid:2	O
)	O
by	O
a	O
negative	O
constant	O
,	O
then	O
so	O
is	O
wi	O
for	O
all	O
i.	O
thus	O
the	O
sign	O
of	O
wiw	O
i	O
is	O
inverted	O
for	O
each	O
i	O
,	O
but	O
they	O
still	O
all	O
have	O
the	O
same	O
sign	O
.	O
similarly	O
,	O
if	O
one	O
point	B
xi	O
is	O
multiplied	O
by	O
a	O
neg-	O
(	O
cid:2	O
)	O
ative	O
constant	O
,	O
then	O
both	O
wi	O
and	O
w	O
i	O
is	O
unchanged	O
.	O
in	O
the	O
same	O
way	O
,	O
the	O
condition	O
that	O
each	O
wi	O
(	O
in	O
part	O
(	O
ii	O
)	O
of	O
the	O
theorem	O
)	O
have	O
the	O
same	O
sign	O
for	O
all	O
i	O
is	O
unaffected	O
if	O
the	O
camera	B
matrix	I
is	O
multiplied	O
by	O
a	O
negative	O
(	O
or	O
of	O
course	O
positive	O
)	O
constant	O
.	O
(	O
cid:2	O
)	O
i	O
change	O
signs	O
,	O
and	O
so	O
the	O
sign	O
of	O
wiw	O
proof	O
.	O
the	O
points	O
xe	O
depth	O
with	O
respect	O
to	O
these	O
cameras	B
.	O
according	O
to	O
(	O
21.2	O
)	O
i	O
lie	O
in	O
front	O
of	O
the	O
cameras	O
pe	O
and	O
p	O
(	O
cid:2	O
)	O
e	O
,	O
and	O
hence	O
have	O
positive	O
hence	O
,	O
det	O
(	O
me	O
)	O
wite	O
multiplying	O
these	O
expressions	O
together	O
,	O
and	O
cancelling	O
te	O
i	O
>	O
0	O
for	O
all	O
i.	O
similarly	O
for	O
the	O
second	O
camera	B
,	O
det	O
(	O
m	O
(	O
cid:2	O
)	O
e	O
)	O
w	O
i	O
>	O
0.	O
i	O
because	O
it	O
appears	O
twice	O
,	O
(	O
cid:2	O
)	O
ite	O
.	O
=	O
det	O
(	O
me	O
)	O
wite	O
i	O
.	O
depth	O
(	O
xe	O
i	O
;	O
pe	O
)	O
520	O
21	O
cheirality	O
(	O
cid:2	O
)	O
i	O
has	O
i	O
)	O
,	O
and	O
hence	O
wiw	O
i	O
=	O
(	O
peh−1	O
)	O
(	O
hxe	O
i	O
det	O
me	O
det	O
m	O
(	O
cid:2	O
)	O
e	O
>	O
0.	O
since	O
det	O
me	O
det	O
m	O
(	O
cid:2	O
)	O
e	O
is	O
constant	O
,	O
this	O
shows	O
that	O
wiw	O
(	O
cid:2	O
)	O
gives	O
wiw	O
constant	O
sign	O
.	O
this	O
was	O
shown	O
in	O
terms	O
of	O
the	O
true	O
conﬁguration	O
.	O
note	O
however	O
that	O
for	O
any	O
h	O
,	O
one	O
has	O
(	O
cid:2	O
)	O
wiˆxi	O
=	O
pexe	O
i	O
has	O
the	O
same	O
sign	O
for	O
the	O
projective	B
}	O
)	O
.	O
since	O
any	O
projective	B
reconstruction	I
is	O
of	O
this	O
reconstruction	B
(	O
peh−1	O
,	O
p	O
(	O
cid:2	O
)	O
eh−1	O
,	O
{	O
hxe	O
(	O
cid:2	O
)	O
form	O
(	O
except	O
for	O
homogeneous	O
scale	O
factors	O
)	O
,	O
and	O
the	O
condition	O
that	O
wiw	O
i	O
has	O
the	O
same	O
i	O
,	O
pe	O
and	O
p	O
(	O
cid:2	O
)	O
e	O
,	O
it	O
sign	O
is	O
independent	O
of	O
choice	O
of	O
homogeneous	O
representatives	O
of	O
xe	O
(	O
cid:2	O
)	O
follows	O
that	O
in	O
any	O
projective	B
reconstruction	I
,	O
wiw	O
i	O
has	O
the	O
same	O
sign	O
for	O
all	O
i.	O
this	O
to	O
show	O
the	O
second	O
part	O
,	O
suppose	O
in	O
the	O
projective	B
reconstruction	I
wiˆxi	O
=	O
p	O
(	O
cid:23	O
)	O
x	O
all	O
the	O
wi	O
proves	O
the	O
ﬁrst	O
part	O
of	O
the	O
theorem	O
.	O
(	O
cid:23	O
)	O
xe	O
tion	O
represented	O
by	O
h	O
such	O
that	O
h	O
(	O
cid:23	O
)	O
xi	O
=	O
ηi	O
have	O
the	O
same	O
sign	O
.	O
since	O
this	O
is	O
a	O
projective	B
reconstruction	I
,	O
there	O
exists	O
a	O
transforma-	O
i	O
and	O
ph−1	O
=	O
pe	O
for	O
some	O
constants	O
ηi	O
and	O
i	O
	O
.	O
then	O
,	O
and	O
so	O
wiˆxi	O
=	O
p	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
ph−1	O
)	O
(	O
h	O
(	O
cid:23	O
)	O
xi	O
)	O
=	O
(	O
pe	O
)	O
(	O
ηi	O
(	O
cid:23	O
)	O
xe	O
i	O
)	O
.	O
pe	O
(	O
cid:23	O
)	O
xe	O
i	O
=	O
(	O
wi/ηi	O
)	O
ˆxi	O
for	O
all	O
i.	O
however	O
,	O
since	O
depth	O
(	O
xe	O
i	O
,	O
pe	O
)	O
>	O
0	O
,	O
one	O
has	O
det	O
(	O
me	O
)	O
wi/ηi	O
>	O
0	O
for	O
all	O
i.	O
since	O
det	O
(	O
me	O
)	O
/	O
is	O
constant	O
,	O
and	O
by	O
hypothesis	O
wi	O
has	O
the	O
same	O
sign	O
for	O
all	O
i	O
,	O
it	O
follows	O
that	O
ηi	O
i	O
is	O
a	O
quasi-afﬁne	B
has	O
the	O
same	O
sign	O
for	O
all	O
i.	O
thus	O
the	O
mapping	O
h	O
such	O
that	O
h	O
(	O
cid:23	O
)	O
xi	O
=	O
ηi	O
map	O
with	O
respect	O
to	O
the	O
points	O
(	O
cid:23	O
)	O
xi	O
,	O
according	O
to	O
theorem	O
21.2.	O
one	O
of	O
the	O
cameras	O
only	O
.	O
however	O
,	O
deﬁning	O
p	O
(	O
cid:2	O
)	O
(	O
cid:23	O
)	O
xi	O
=	O
w	O
note	O
that	O
the	O
condition	O
that	O
wi	O
have	O
the	O
same	O
sign	O
for	O
all	O
i	O
needs	O
to	O
be	O
checked	O
for	O
iˆx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
,	O
according	O
to	O
part	O
(	O
i	O
)	O
of	O
the	O
(	O
cid:2	O
)	O
i	O
has	O
the	O
same	O
sign	O
for	O
all	O
i.	O
thus	O
,	O
if	O
all	O
wi	O
have	O
the	O
same	O
sign	O
,	O
then	O
so	O
do	O
(	O
cid:23	O
)	O
xe	O
theorem	O
,	O
wiw	O
all	O
w	O
(	O
cid:2	O
)	O
i.	O
according	O
to	O
theorem	O
21.7	O
,	O
any	O
projective	B
reconstruction	I
in	O
which	O
p	O
(	O
cid:23	O
)	O
xi	O
=	O
wiˆxi	O
and	O
21.4	O
obtaining	O
a	O
quasi-afﬁne	B
reconstruction	I
wi	O
has	O
the	O
same	O
sign	O
for	O
all	O
i	O
is	O
a	O
quasi-afﬁne	B
reconstruction	I
.	O
the	O
advantage	O
of	O
a	O
quasi-afﬁne	B
reconstruction	I
is	O
that	O
it	O
gives	O
a	O
closer	O
approximation	O
to	O
the	O
true	O
shape	O
of	O
the	O
object	O
than	O
does	O
an	O
arbitrary	O
projective	B
transformation	I
.	O
it	O
may	O
be	O
used	O
as	O
a	O
stepping	O
stone	O
on	O
the	O
way	O
to	O
a	O
metric	B
reconstruction	I
of	O
the	O
scene	O
,	O
as	O
in	O
[	O
hartley-94b	O
]	O
.	O
in	O
addition	O
,	O
one	O
may	O
retrieve	O
the	O
convex	B
hull	I
of	O
the	O
object	O
or	O
determine	O
such	O
questions	O
as	O
whether	O
two	O
points	O
lie	O
on	O
the	O
same	O
side	O
of	O
a	O
plane	O
.	O
it	O
turns	O
out	O
that	O
quasi-afﬁne	B
reconstruction	I
is	O
extremely	O
simple	O
,	O
given	O
a	O
projective	B
reconstruction	I
,	O
as	O
shown	O
in	O
the	O
following	O
theorem	O
.	O
theorem	O
21.8.	O
any	O
projective	B
reconstruction	I
in	O
which	O
one	O
of	O
the	O
cameras	O
is	O
an	O
afﬁne	B
camera	I
is	O
a	O
quasi-afﬁne	B
reconstruction	I
.	O
proof	O
.	O
recall	O
that	O
an	O
afﬁne	B
camera	I
is	O
one	O
for	O
which	O
the	O
last	O
row	O
is	O
of	O
the	O
form	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
in	O
this	O
case	O
,	O
writing	O
wiˆxi	O
=	O
p	O
(	O
cid:23	O
)	O
xi	O
,	O
one	O
immediately	O
veriﬁes	O
that	O
wi	O
=	O
1	O
for	O
all	O
i	O
,	O
and	O
in	O
particular	O
they	O
all	O
have	O
the	O
same	O
sign	O
.	O
according	O
to	O
theorem	O
21.2	O
this	O
21.5	O
effect	O
of	O
transformations	O
on	O
cheirality	O
521	O
means	O
that	O
the	O
reconstruction	B
differs	O
by	O
a	O
quasi-afﬁne	B
transformation	O
from	O
the	O
truth	O
.	O
the	O
following	O
result	O
follows	O
immediately	O
.	O
corollary	O
21.9.	O
let	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
.	O
then	O
by	O
swapping	O
the	O
last	O
two	O
columns	O
of	O
p	O
and	O
of	O
p	O
(	O
cid:2	O
)	O
two	O
coordinates	O
of	O
each	O
xi	O
,	O
one	O
obtains	O
a	O
quasi-afﬁne	B
reconstruction	I
of	O
the	O
scene	O
.	O
,	O
{	O
xi	O
}	O
)	O
be	O
a	O
projective	B
reconstruction	I
of	O
a	O
scene	O
in	O
which	O
,	O
as	O
well	O
as	O
the	O
last	O
this	O
is	O
similar	O
to	O
result	O
10.4	O
(	O
p271	O
)	O
,	O
in	O
which	O
it	O
was	O
shown	O
that	O
if	O
the	O
camera	B
p	O
is	O
known	O
in	O
reality	O
to	O
be	O
an	O
afﬁne	B
camera	I
,	O
then	O
the	O
above	O
procedure	O
provides	O
an	O
afﬁne	B
reconstruction	I
.	O
21.5	O
effect	O
of	O
transformations	O
on	O
cheirality	O
at	O
this	O
point	B
,	O
it	O
is	O
desirable	O
to	O
derive	O
a	O
slightly	O
different	O
form	B
of	I
the	O
formula	O
for	O
depth	O
deﬁned	O
in	O
(	O
21.2	O
)	O
.	O
let	O
p	O
be	O
a	O
camera	B
matrix	I
.	O
the	O
centre	B
of	O
p	O
is	O
the	O
unique	O
point	B
c	O
such	O
that	O
pc	O
=	O
0.	O
one	O
can	O
write	O
an	O
explicit	O
formula	O
for	O
c	O
as	O
follows	O
.	O
deﬁnition	B
21.10.	O
given	O
a	O
camera	B
matrix	I
p	O
,	O
we	O
deﬁne	O
ct	O
where	O
p	O
to	O
be	O
the	O
vector	O
(	O
c1	O
,	O
c2	O
,	O
c3	O
,	O
c4	O
)	O
,	O
ci	O
=	O
(	O
−1	O
)	O
i	O
det	O
ˆp	O
(	O
i	O
)	O
and	O
ˆp	O
(	O
i	O
)	O
is	O
the	O
matrix	B
obtained	O
by	O
removing	O
the	O
i-th	O
column	O
of	O
p.	O
we	O
denote	O
by	O
[	O
p/vt	O
]	O
the	O
4	O
×	O
4	O
matrix	B
made	O
up	O
of	O
a	O
3	O
×	O
4	O
camera	B
matrix	I
p	O
augmented	O
with	O
an	O
ﬁnal	O
row	O
vt.	O
deﬁnition	B
21.10	O
leads	O
to	O
a	O
simple	O
formula	O
for	O
det	O
[	O
p/vt	O
]	O
.	O
cofac-	O
tor	O
expansion	O
of	O
the	O
determinant	O
along	O
the	O
last	O
row	O
gives	O
det	O
[	O
p/vt	O
]	O
=	O
vtcp	O
for	O
any	O
row	B
vector	I
vt.	O
as	O
a	O
special	O
case	O
,	O
if	O
pt	O
i	O
is	O
the	O
i-th	O
row	O
of	O
p	O
,	O
then	O
pt	O
i	O
cp	O
=	O
det	O
[	O
p/pt	O
i	O
]	O
=	O
0	O
where	O
the	O
last	O
equality	O
is	O
true	O
because	O
the	O
matrix	B
has	O
a	O
repeated	O
row	O
.	O
since	O
this	O
is	O
true	O
for	O
all	O
i	O
,	O
it	O
follows	O
that	O
pcp	O
=	O
0	O
,	O
and	O
so	O
cp	O
is	O
the	O
camera	B
centre	I
,	O
as	O
claimed	O
.	O
note	O
that	O
submatrix	O
ˆp	O
(	O
4	O
)	O
is	O
the	O
same	O
as	O
matrix	B
m	O
in	O
the	O
decomposition	B
p	O
=	O
[	O
m	O
|	O
v	O
]	O
,	O
and	O
so	O
det	O
m	O
=	O
c4	O
.	O
this	O
allows	O
us	O
to	O
reformulate	O
(	O
21.2	O
)	O
,	O
as	O
follows	O
.	O
.	O
=	O
w	O
(	O
et	O
4	O
x	O
)	O
(	O
et	O
4	O
cp	O
)	O
depth	O
(	O
x	O
;	O
p	O
)	O
x	O
=	O
0.	O
we	O
now	O
consider	O
a	O
projective	B
transformation	I
represented	O
by	O
matrix	B
h.	O
if	O
p	O
(	O
cid:2	O
)	O
(	O
21.3	O
)	O
where	O
et	O
4	O
is	O
the	O
vector	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
it	O
is	O
signiﬁcant	O
to	O
note	O
here	O
that	O
e4	O
is	O
the	O
vector	O
representing	O
the	O
plane	O
at	O
inﬁnity	O
–	O
a	O
point	B
x	O
lies	O
on	O
the	O
plane	O
at	O
inﬁnity	O
if	O
and	O
only	O
if	O
et	O
=	O
ph−1	O
4	O
and	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
then	O
the	O
image	O
correspondences	O
are	O
preserved	O
by	O
this	O
transformation	B
.	O
when	O
speaking	O
of	O
a	O
projective	O
transformation	B
being	O
applied	O
to	O
a	O
set	O
of	B
points	I
and	O
to	O
a	O
camera	B
,	O
it	O
is	O
meant	O
that	O
a	O
point	B
x	O
is	O
transformed	O
to	O
hx	O
and	O
the	O
camera	B
matrix	I
is	O
transformed	O
to	O
ph−1	O
.	O
in	O
this	O
section	O
we	O
will	O
consider	O
such	O
projective	B
transformations	O
and	O
their	O
effect	O
on	O
the	O
cheirality	O
of	B
points	I
with	O
respect	O
to	O
a	O
camera	B
.	O
first	O
,	O
we	O
wish	O
to	O
determine	O
what	O
522	O
happens	O
to	O
cp	O
when	O
p	O
is	O
transformed	O
to	O
ph−1	O
.	O
to	O
answer	O
that	O
question	O
,	O
consider	O
an	O
arbitrary	O
4-vector	O
v.	O
we	O
see	O
that	O
21	O
cheirality	O
vth−1cph−1	O
=	O
det	O
(	O
ph−1/vth−1	O
)	O
=	O
det	O
(	O
p/vt	O
)	O
det	O
h−1	O
=	O
vtcp	O
det	O
h−1	O
.	O
since	O
this	O
is	O
true	O
for	O
all	O
vectors	O
v	O
,	O
it	O
follows	O
that	O
h−1cph−1	O
=	O
cp	O
det	O
h−1	O
,	O
or	O
cph−1	O
=	O
hcp	O
det	O
h−1	O
.	O
(	O
21.4	O
)	O
at	O
one	O
level	O
,	O
this	O
formula	O
is	O
saying	O
that	O
the	O
transformation	B
h	O
takes	O
the	O
camera	B
centre	I
c	O
=	O
cp	O
to	O
the	O
new	O
location	O
cph−1	O
≈	O
hc	O
.	O
however	O
,	O
we	O
are	O
interested	O
in	O
the	O
exact	O
coordinates	B
of	O
cph−1	O
,	O
especially	O
the	O
sign	O
of	O
the	O
last	O
coordinate	O
c4	O
which	O
appears	O
in	O
(	O
21.3	O
)	O
.	O
thus	O
,	O
the	O
factor	O
det	O
h−1	O
is	O
signiﬁcant	O
.	O
now	O
,	O
applying	O
(	O
21.4	O
)	O
to	O
(	O
21.3	O
)	O
gives	O
.	O
=	O
w	O
(	O
et	O
4	O
.	O
=	O
w	O
(	O
et	O
4	O
depth	O
(	O
hx	O
;	O
ph−1	O
)	O
hx	O
)	O
(	O
et	O
4	O
hx	O
)	O
(	O
et	O
4	O
cph−1	O
)	O
hcp	O
)	O
deth	O
−1	O
.	O
one	O
may	O
interpret	O
the	O
expression	O
et	O
4	O
h	O
as	O
being	O
the	O
plane	B
π∞	O
mapped	O
to	O
inﬁnity	O
by	O
h.	O
this	O
is	O
because	O
a	O
point	B
x	O
lies	O
on	O
π∞	O
if	O
and	O
only	O
if	O
the	O
last	O
coordinate	O
of	O
hx	O
is	O
zero	O
–	O
that	O
is	O
e4hx	O
=	O
0.	O
on	O
the	O
other	O
hand	O
,	O
x	O
lies	O
on	O
π∞	O
if	O
and	O
only	O
if	O
πt∞x	O
=	O
0.	O
finally	O
,	O
denoting	O
the	O
fourth	O
row	O
of	O
the	O
transformation	B
matrix	O
h	O
by	O
ht	O
4	O
,	O
and	O
sign	O
(	O
det	O
h	O
)	O
by	O
δ	O
,	O
we	O
obtain	O
result	O
21.11.	O
if	O
π∞	O
is	O
the	O
plane	B
mapped	O
to	O
inﬁnity	O
by	O
a	O
projective	B
transformation	I
h	O
and	O
δ	O
=	O
sign	O
(	O
det	O
h	O
)	O
,	O
then	O
depth	O
(	O
hx	O
;	O
ph−1	O
)	O
.	O
=	O
w	O
(	O
πt∞x	O
)	O
(	O
πt∞cp	O
)	O
δ	O
.	O
this	O
equation	O
will	O
be	O
used	O
extensively	O
.	O
it	O
may	O
be	O
considered	O
to	O
be	O
a	O
generalization	O
of	O
(	O
21.3	O
)	O
.	O
it	O
will	O
be	O
seen	O
in	O
the	O
next	O
section	O
that	O
δ	O
=	O
sign	O
(	O
det	O
h	O
)	O
is	O
an	O
indicator	O
of	O
whether	O
h	O
is	O
an	O
orientation-reversing	O
or	O
orientation-preserving	O
transformation	B
.	O
thus	O
,	O
the	O
effect	O
on	O
cheirality	O
of	O
applying	O
a	O
transformation	B
h	O
is	O
determined	O
only	O
by	O
the	O
position	O
of	O
the	O
plane	O
mapped	O
to	O
inﬁnity	O
π∞	O
,	O
and	O
whether	O
h	O
preserves	O
or	O
reverses	O
orientation	B
.	O
we	O
now	O
consider	O
the	O
effect	O
of	O
different	O
transformations	O
on	O
the	O
cheirality	O
of	B
points	I
with	O
respect	O
to	O
a	O
camera	B
.	O
the	O
effect	O
of	O
an	O
afﬁne	B
transformation	I
is	O
considered	O
ﬁrst	O
.	O
result	O
21.12.	O
an	O
afﬁne	B
transformation	I
with	O
positive	O
determinant	O
preserves	O
the	O
cheiral-	O
ity	O
of	O
any	O
point	B
with	O
respect	O
to	O
a	O
camera	B
.	O
an	O
afﬁne	B
transformation	I
with	O
negative	O
deter-	O
minant	O
reverses	O
cheirality	O
.	O
proof	O
.	O
an	O
afﬁne	B
transformation	I
preserves	O
the	O
plane	O
at	O
inﬁnity	O
,	O
hence	O
π∞	O
=	O
e4	O
.	O
the	O
result	O
then	O
follows	O
by	O
comparing	O
(	O
21.3	O
)	O
and	O
result	O
21.11.	O
we	O
now	O
determine	O
how	O
an	O
arbitrary	O
projective	B
transformation	I
affects	O
cheirality	O
.	O
result	O
21.13.	O
let	O
h	O
represent	O
a	O
projective	B
transformation	I
with	O
positive	O
determinant	O
,	O
and	O
let	O
π∞	O
be	O
the	O
plane	B
in	O
space	O
mapped	O
to	O
inﬁnity	O
by	O
h.	O
the	O
cheirality	O
of	O
a	O
point	O
x	O
is	O
preserved	O
by	O
h	O
if	O
and	O
only	O
if	O
x	O
lies	O
on	O
the	O
same	O
side	O
of	O
the	O
plane	O
π∞	O
as	O
the	O
camera	B
centre	I
.	O
21.6	O
orientation	B
523	O
.	O
proof	O
.	O
since	O
det	O
h	O
>	O
0	O
,	O
we	O
see	O
from	O
(	O
21.3	O
)	O
and	O
result	O
21.11	O
that	O
depth	O
(	O
x	O
;	O
p	O
)	O
=	O
depth	O
(	O
hx	O
;	O
ph−1	O
)	O
if	O
and	O
only	O
if	O
(	O
πt∞x	O
)	O
(	O
πt∞c	O
)	O
c	O
)	O
.	O
suppose	O
the	O
point	B
x	O
and	O
the	O
camera	B
p	O
are	O
located	O
at	O
ﬁnite	O
points	O
so	O
that	O
the	O
cheirality	O
is	O
well	O
deﬁned	O
,	O
and	O
let	O
them	O
be	O
scaled	O
so	O
that	O
both	O
x	O
and	O
c	O
have	O
ﬁnal	O
coordinate	O
equal	O
to	O
1.	O
in	O
this	O
case	O
,	O
(	O
et	O
c	O
)	O
=	O
1	O
and	O
we	O
see	O
that	O
cheirality	O
is	O
preserved	O
if	O
and	O
only	O
if	O
4	O
(	O
πt∞x	O
)	O
(	O
πt∞c	O
)	O
=	O
πt∞c	O
.	O
this	O
condition	O
may	O
be	O
interpreted	O
as	O
meaning	O
that	O
the	O
points	O
c	O
and	O
x	O
both	O
lie	O
on	O
the	O
same	O
side	O
of	O
the	O
plane	O
π∞	O
.	O
hence	O
,	O
the	O
cheirality	O
of	O
a	O
point	O
x	O
is	O
preserved	O
by	O
a	O
transformation	B
h	O
,	O
if	O
and	O
only	O
if	O
it	O
lies	O
on	O
the	O
same	O
side	O
of	O
the	O
plane	O
π∞	O
as	O
the	O
camera	B
centre	I
.	O
x	O
)	O
(	O
et	O
4	O
.	O
=	O
1	O
,	O
or	O
otherwise	O
expressed	O
πt∞x	O
.	O
.	O
=	O
(	O
et	O
4	O
x	O
)	O
(	O
et	O
4	O
21.6	O
orientation	B
we	O
now	O
consider	O
the	O
question	O
of	O
image	O
orientation	B
.	O
a	O
mapping	O
h	O
from	O
irn	O
to	O
itself	O
is	O
called	O
orientation-preserving	O
at	O
points	O
x	O
where	O
the	O
jacobian	O
of	O
h	O
(	O
the	O
determinant	O
of	O
the	O
matrix	O
of	O
partial	O
derivatives	O
)	O
is	O
positive	O
,	O
and	O
orientation-reversing	O
at	O
points	O
where	O
the	O
jacobian	O
is	O
negative	O
.	O
reﬂection	O
of	B
points	I
of	O
irn	O
with	O
respect	O
to	O
a	O
hyperplane	O
(	O
that	O
is	O
mirror	O
imaging	O
)	O
is	O
an	O
example	O
of	O
an	O
orientation-reversing	O
mapping	O
.	O
a	O
projectivity	B
h	O
from	O
pn	O
to	O
itself	O
restricts	O
to	O
a	O
mapping	O
from	O
irn	O
−	O
π∞	O
to	O
irn	O
,	O
where	O
π∞	O
is	O
the	O
hyperplane	O
(	O
line	B
,	O
plane	B
)	O
mapped	O
to	O
inﬁnity	O
by	O
h.	O
consider	O
the	O
case	O
n	O
=	O
3	O
and	O
let	O
h	O
be	O
a	O
4	O
×	O
4	O
matrix	B
representing	O
the	O
projectivity	B
h.	O
we	O
wish	O
to	O
determine	O
at	O
which	O
points	O
x	O
mathematica	O
[	O
mathematica-92	O
]	O
)	O
that	O
if	O
h	O
(	O
cid:23	O
)	O
x	O
=	O
w	O
(	O
cid:23	O
)	O
x	O
in	O
irn	O
−	O
π∞	O
the	O
map	O
h	O
is	O
orientation-preserving	O
.	O
it	O
may	O
be	O
veriﬁed	O
(	O
quite	O
easily	O
using	O
and	O
j	O
is	O
the	O
jacobian	O
matrix	B
of	O
h	O
(	O
cid:2	O
)	O
evaluated	O
at	O
x	O
,	O
then	O
det	O
(	O
j	O
)	O
=	O
det	O
(	O
h	O
)	O
/w4	O
.	O
this	O
gives	O
the	O
following	O
result	O
.	O
result	O
21.14.	O
a	O
projectivity	B
h	O
of	O
ip3	O
represented	O
by	O
a	O
matrix	B
h	O
is	O
orientation-preserving	O
at	O
any	O
point	B
in	O
ir3	O
−	O
π∞	O
if	O
and	O
only	O
if	O
det	O
(	O
h	O
)	O
>	O
0.	O
of	O
course	O
,	O
the	O
concept	O
of	O
orientability	O
may	O
be	O
extended	O
to	O
the	O
whole	O
of	O
ip3	O
,	O
and	O
it	O
may	O
be	O
shown	O
that	O
h	O
is	O
orientation-preserving	O
on	O
the	O
whole	O
of	O
ip3	O
if	O
and	O
only	O
if	O
det	O
(	O
h	O
)	O
>	O
0.	O
the	O
essential	O
feature	O
here	O
is	O
that	O
as	O
a	O
topological	O
manifold	O
,	O
ip3	O
is	O
orientable	O
.	O
two	O
sets	O
of	B
points	I
{	O
xi	O
}	O
and	O
{	O
xi	O
}	O
that	O
correspond	O
via	O
a	O
quasi-afﬁne	B
transformation	O
are	O
said	O
to	O
be	O
oppositely	B
oriented	I
if	O
the	O
transformation	B
is	O
orientation-reversing	O
.	O
as	O
an	O
example	O
,	O
consider	O
the	O
transformation	B
given	O
by	O
a	O
diagonal	O
matrix	B
h	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
−1	O
,	O
1	O
)	O
.	O
this	O
transformation	B
has	O
negative	O
determinant	O
,	O
and	O
hence	O
is	O
orientation-reversing	O
.	O
on	O
the	O
other	O
hand	O
,	O
it	O
is	O
afﬁne	B
,	O
and	O
hence	O
quasi-afﬁne	B
.	O
therefore	O
,	O
it	O
is	O
possible	O
always	O
to	O
construct	O
oppositely	B
oriented	I
quasi-afﬁne	O
reconstructions	O
of	O
a	O
scene	O
.	O
it	O
may	O
appear	O
therefore	O
that	O
the	O
orientation	B
of	O
a	O
scene	O
may	O
not	O
be	O
determined	O
from	O
a	O
pair	O
of	O
images	O
.	O
although	O
this	O
is	O
sometimes	O
true	O
,	O
it	O
is	O
sometimes	O
possible	O
to	O
rule	O
out	O
one	O
of	O
the	O
op-	O
positely	O
oriented	O
quasi-afﬁne	B
reconstructions	O
of	O
a	O
scene	O
,	O
and	O
hence	O
determine	O
the	O
true	O
orientation	B
of	O
the	O
scene	O
.	O
common	O
experience	O
provides	O
some	O
clues	O
here	O
.	O
in	O
particular	O
a	O
stereo	O
pair	O
may	O
be	O
viewed	O
by	O
presenting	O
one	O
image	O
to	O
one	O
eye	O
and	O
the	O
other	O
image	O
to	O
the	O
other	O
eye	O
.	O
if	O
this	O
is	O
done	O
correctly	O
,	O
then	O
the	O
brain	O
perceives	O
a	O
3d	O
reconstruction	B
of	O
the	O
scene	O
if	O
,	O
however	O
,	O
the	O
two	O
images	O
are	O
swapped	O
and	O
presented	O
to	O
the	O
opposite	O
eyes	O
,	O
then	O
the	O
perspective	O
will	O
be	O
reversed	O
–	O
hills	O
become	O
valleys	O
and	O
vice	O
versa	O
.	O
in	O
effect	O
,	O
the	O
brain	O
is	O
able	O
to	O
compute	O
two	O
oppositely	O
oriented	O
reconstructions	O
of	O
the	O
image	O
pair	O
.	O
it	O
seems	O
,	O
therefore	O
,	O
524	O
21	O
cheirality	O
fig	O
.	O
21.2.	O
stereo	O
pairs	O
of	O
images	O
that	O
may	O
be	O
viewed	O
by	O
cross-fusing	O
(	O
the	O
eyes	O
are	O
crossed	O
so	O
that	O
the	O
left	O
eye	O
sees	O
the	O
right	O
image	O
and	O
vice	O
versa	O
)	O
.	O
the	O
two	O
bottom	O
images	O
are	O
the	O
same	O
as	O
the	O
top	O
pair	O
,	O
except	O
that	O
they	O
are	O
swapped	O
.	O
in	O
the	O
top	O
pair	O
of	O
images	O
one	O
sees	O
an	O
l-shaped	O
region	O
raised	O
above	O
a	O
planar	O
background	O
.	O
in	O
the	O
bottom	O
pair	O
of	O
images	O
the	O
l-shaped	O
region	O
appears	O
as	O
an	O
indentation	O
.	O
the	O
two	O
“	O
reconstructions	O
”	O
differ	O
by	O
reﬂection	O
in	O
the	O
background	O
plane	B
.	O
this	O
demonstrates	O
that	O
the	O
same	O
pair	O
of	O
images	O
may	O
give	O
rise	O
to	O
two	O
differently	O
oriented	O
projective	B
reconstructions	O
.	O
that	O
in	O
certain	O
circumstances	O
,	O
two	O
oppositely	O
oriented	O
realizations	B
of	O
an	O
image	O
pair	O
exist	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
21.2.	O
it	O
may	O
be	O
surprising	O
to	O
discover	O
that	O
this	O
is	O
not	O
always	O
the	O
case	O
,	O
as	O
is	O
shown	O
in	O
the	O
following	O
theorem	O
.	O
as	O
used	O
in	O
this	O
theorem	O
and	O
elsewhere	O
in	O
this	O
chapter	O
,	O
a	O
projective	B
realization	I
of	O
a	O
set	O
of	O
point	O
correspondences	B
is	O
known	O
as	O
a	O
strong	B
realization	O
if	O
the	O
reconstructed	O
3d	O
points	O
xi	O
are	O
in	O
front	O
of	O
all	O
the	O
cameras	B
.	O
,	O
{	O
xi	O
}	O
)	O
be	O
a	O
strong	B
realization	O
of	O
a	O
uniquely	O
realizable	O
set	O
of	O
theorem	O
21.15.	O
let	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
point	B
correspondences	O
.	O
there	O
exists	O
a	O
different	O
oppositely	B
oriented	I
strong	O
realization	B
,	O
{	O
xi	O
}	O
)	O
if	O
and	O
only	O
if	O
there	O
exists	O
a	O
plane	B
in	O
ir3	O
such	O
that	O
the	O
perspective	O
centres	O
(	O
p	O
,	O
p	O
of	O
both	O
cameras	B
p	O
and	O
p	O
(	O
cid:2	O
)	O
lie	O
on	O
one	O
side	O
of	O
the	O
plane	O
,	O
and	O
the	O
points	O
xi	O
lie	O
on	O
the	O
other	O
side	O
.	O
(	O
cid:2	O
)	O
proof	O
.	O
consider	O
one	O
strong	B
realization	O
of	O
the	O
conﬁguration	O
.	O
by	O
deﬁnition	B
,	O
all	O
the	O
points	O
lie	O
in	O
front	O
of	O
both	O
cameras	B
.	O
suppose	O
that	O
there	O
exists	O
a	O
plane	B
separating	O
the	O
points	O
from	O
the	O
two	O
camera	O
centres	O
.	O
let	O
g	O
be	O
a	O
projective	B
transformation	I
mapping	O
the	O
given	O
plane	B
to	O
inﬁnity	O
and	O
let	O
a	O
be	O
an	O
afﬁne	B
transformation	I
.	O
suppose	O
further	O
that	O
21.7	O
the	O
cheiral	B
inequalities	I
525	O
det	O
g	O
>	O
0	O
and	O
det	O
a	O
<	O
0.	O
let	O
h	O
be	O
the	O
composition	O
h	O
=	O
ag	O
.	O
according	O
to	O
result	O
21.13	O
the	O
transformation	B
g	O
is	O
cheirality-reversing	O
for	O
the	O
points	O
,	O
since	O
the	O
points	O
are	O
on	O
the	O
opposite	O
side	O
of	O
the	O
plane	O
from	O
the	O
camera	B
centres	O
.	O
according	O
to	O
result	O
21.12	O
a	O
is	O
also	O
cheirality-reversing	O
,	O
since	O
det	O
a	O
<	O
0.	O
the	O
composition	O
h	O
must	O
therefore	O
be	O
cheirality-	O
preserving	O
,	O
and	O
it	O
transforms	O
the	O
strong	B
conﬁguration	O
to	O
a	O
different	O
strong	B
conﬁgura-	O
tion	O
.	O
since	O
h	O
has	O
negative	O
determinant	O
,	O
however	O
,	O
it	O
is	O
orientation-reversing	O
,	O
so	O
the	O
two	O
strong	O
realizations	B
have	O
opposite	O
orientations	O
.	O
conversely	O
,	O
suppose	O
that	O
two	O
strong	O
oppositely	B
oriented	I
realizations	O
exist	O
and	O
let	O
h	O
be	O
the	O
transformation	B
taking	O
one	O
to	O
the	O
other	O
.	O
since	O
h	O
is	O
orientation-reversing	O
,	O
det	O
h	O
<	O
0.	O
the	O
mapping	O
h	O
is	O
by	O
deﬁnition	B
cheirality-preserving	O
on	O
all	O
points	O
,	O
with	O
respect	O
to	O
both	O
cameras	B
.	O
if	O
π∞	O
is	O
the	O
plane	B
mapped	O
to	O
inﬁnity	O
by	O
h	O
,	O
then	O
according	O
to	O
result	O
21.13	O
the	O
points	O
x	O
must	O
lie	O
on	O
the	O
opposite	O
side	O
of	O
the	O
plane	O
π∞	O
from	O
both	O
camera	B
centres	O
.	O
21.7	O
the	O
cheiral	B
inequalities	I
in	O
section	O
21.4	O
a	O
very	O
simple	O
method	O
was	O
given	O
for	O
obtaining	O
a	O
quasi-afﬁne	B
reconstruc-	O
tion	O
of	O
a	O
scene	O
directly	O
from	O
a	O
projective	B
reconstruction	I
.	O
however	O
,	O
the	O
reconstruction	B
obtained	O
there	O
did	O
not	O
respect	O
the	O
condition	O
that	O
the	O
points	O
must	O
lie	O
in	O
front	O
of	O
all	O
cam-	O
eras	O
.	O
in	O
fact	O
,	O
the	O
ﬁrst	O
camera	B
in	O
this	O
construction	O
is	O
an	O
afﬁne	B
camera	I
,	O
for	O
which	O
front	O
and	O
back	O
are	O
not	O
well	O
deﬁned	O
.	O
by	O
taking	O
full	O
advantage	O
of	O
the	O
fact	O
that	O
visible	O
points	O
must	O
lie	O
in	O
front	O
of	O
the	O
camera	O
,	O
it	O
is	O
possible	O
to	O
constrain	O
the	O
reconstruction	B
more	O
tightly	O
,	O
leading	O
to	O
a	O
closer	O
approximation	O
to	O
a	O
true	O
afﬁne	B
reconstruction	I
of	O
the	O
scene	O
.	O
the	O
method	O
will	O
be	O
given	O
for	O
the	O
case	O
of	O
a	O
reconstruction	O
derived	O
from	O
several	O
im-	O
ages	O
.	O
one	O
is	O
given	O
a	O
set	O
of	O
image	O
points	O
{	O
xj	O
i	O
is	O
the	O
projection	B
of	O
the	O
i-th	O
point	B
in	O
the	O
j-th	O
image	O
.	O
not	O
all	O
points	O
are	O
visible	O
in	O
each	O
image	O
,	O
so	O
for	O
some	O
(	O
i	O
,	O
j	O
)	O
the	O
point	B
xj	O
i	O
is	O
not	O
given	O
,	O
in	O
which	O
case	O
it	O
is	O
not	O
known	O
whether	O
the	O
i-th	O
point	B
lies	O
in	O
front	O
of	O
the	O
j-th	O
camera	B
or	O
not	O
.	O
on	O
the	O
other	O
hand	O
,	O
the	O
existence	O
of	O
an	O
image	O
point	O
xj	O
i	O
implies	O
that	O
the	O
point	B
lies	O
in	O
front	O
of	O
the	O
camera	O
.	O
}	O
,	O
where	O
xj	O
i	O
we	O
start	O
from	O
an	O
assumed	O
projective	B
reconstruction	I
of	O
the	O
scene	O
,	O
consisting	O
of	O
a	O
set	O
≈	O
pjxi	O
.	O
writing	O
the	O
implied	O
scalar	O
of	O
3d	O
points	O
xi	O
and	O
cameras	B
pj	O
such	O
that	O
xj	O
i	O
constant	O
explicitly	O
in	O
this	O
equation	O
gives	O
wj	O
i	O
ˆxj	O
i	O
=	O
pjxi	O
.	O
in	O
this	O
equation	O
,	O
pj	O
and	O
xi	O
are	O
arbitrarily	O
chosen	O
homogeneous	O
representatives	O
of	O
the	O
respective	O
matrix	B
or	O
vector	O
.	O
related	O
to	O
theorem	O
21.7	O
one	O
may	O
state	O
for	O
several	O
views	O
:	O
result	O
21.16.	O
consider	O
a	O
set	O
of	B
points	I
xe	O
deﬁned	O
for	O
some	O
indices	O
(	O
i	O
,	O
j	O
)	O
such	O
that	O
point	B
xe	O
be	O
a	O
projective	B
reconstruction	I
from	O
xj	O
˜xi	O
=	O
±xi	O
such	O
that	O
for	O
each	O
(	O
i	O
,	O
j	O
)	O
for	O
which	O
xj	O
i	O
be	O
i	O
lies	O
in	O
front	O
of	B
camera	I
pje	O
.	O
let	O
(	O
pj	O
;	O
xi	O
)	O
i	O
.	O
then	O
there	O
are	O
camera	B
matrices	I
˜pj	O
=	O
±pj	O
and	O
i	O
and	O
cameras	B
pje	O
,	O
and	O
let	O
xj	O
i	O
is	O
deﬁned	O
,	O
one	O
has	O
i	O
=	O
pjexe	O
i	O
with	O
wj	O
brieﬂy	O
stated	O
,	O
one	O
can	O
always	O
adjust	O
a	O
projective	B
reconstruction	I
,	O
multiplying	O
camera	B
matrices	I
and	O
points	O
by	O
−1	O
if	O
necessary	O
,	O
so	O
that	O
wj	O
i	O
is	O
positive	O
whenever	O
image	O
point	O
xj	O
exists	O
.	O
the	O
simple	O
proof	O
is	O
omitted	O
.	O
to	O
ﬁnd	O
the	O
matrices	O
˜pj	O
and	O
points	O
˜xi	O
,	O
one	O
may	O
assume	O
that	O
one	O
of	O
the	O
cameras	O
˜p1	O
=	O
p1	O
,	O
for	O
otherwise	O
all	O
points	O
and	O
cameras	B
may	O
be	O
multiplied	O
by	O
−1	O
.	O
the	O
condition	O
p1	O
˜xi	O
=	O
w1	O
i	O
>	O
0	O
determines	O
whether	O
to	O
x1	O
i	O
with	O
w1	O
i	O
>	O
0.	O
i	O
˜pj	O
˜xi	O
=	O
wj	O
i	O
ˆxj	O
i	O
526	O
21	O
cheirality	O
choose	O
˜xi	O
=	O
xi	O
or	O
−xi	O
for	O
all	O
i	O
such	O
that	O
x1	O
i	O
is	O
deﬁned	O
.	O
each	O
known	O
˜xi	O
determines	O
˜pj	O
i	O
is	O
deﬁned	O
.	O
continuing	O
in	O
this	O
way	O
,	O
one	O
easily	O
ﬁnds	O
the	O
factor	O
±1	O
for	O
all	O
j	O
such	O
that	O
xj	O
to	O
apply	O
to	O
each	O
pj	O
and	O
xj	O
to	O
ﬁnd	O
˜pj	O
and	O
˜xi	O
.	O
we	O
assume	O
that	O
this	O
has	O
been	O
done	O
,	O
and	O
replace	O
each	O
pj	O
by	O
˜pj	O
and	O
xi	O
by	O
˜xi	O
.	O
in	O
future	O
we	O
drop	O
the	O
tildes	O
and	O
continue	O
to	O
work	O
with	O
the	O
corrected	O
pj	O
and	O
xi	O
.	O
we	O
now	O
know	O
that	O
wj	O
i	O
is	O
given	O
.	O
i	O
>	O
0	O
whenever	O
image	O
point	O
xj	O
now	O
,	O
we	O
seek	O
a	O
transformation	B
h	O
that	O
will	O
transform	O
the	O
projective	B
reconstruction	I
to	O
a	O
quasi-afﬁne	B
reconstruction	I
for	O
which	O
all	O
points	O
lie	O
in	O
front	O
of	O
the	O
cameras	O
as	O
appro-	O
priate	O
.	O
denoting	O
by	O
4-vector	O
v	O
the	O
plane	B
π∞	O
mapped	O
to	O
inﬁnity	O
by	O
h	O
,	O
this	O
condition	O
may	O
be	O
written	O
as	O
(	O
see	O
result	O
21.11	O
)	O
:	O
depth	O
(	O
xi	O
;	O
pj	O
)	O
.	O
=	O
(	O
vtxi	O
)	O
(	O
vtc	O
)	O
δ	O
>	O
0	O
where	O
δ	O
=	O
sign	O
(	O
det	O
h	O
)	O
.	O
this	O
condition	O
holds	O
for	O
all	O
pairs	O
(	O
i	O
,	O
j	O
)	O
where	O
xj	O
since	O
we	O
are	O
free	O
to	O
multiply	O
v	O
by	O
−1	O
if	O
necessary	O
,	O
we	O
may	O
assume	O
that	O
(	O
vtc1	O
)	O
δ	O
>	O
0	O
for	O
the	O
centre	B
of	O
the	O
camera	B
p1	O
.	O
the	O
following	O
inequalities	O
now	O
follow	O
easily	O
:	O
i	O
is	O
given	O
.	O
xt	O
i	O
v	O
>	O
0	O
for	O
all	O
i	O
δcj	O
tv	O
>	O
0	O
for	O
all	O
j	O
.	O
(	O
21.5	O
)	O
these	O
equations	O
(	O
21.5	O
)	O
may	O
be	O
called	O
the	O
cheiral	B
inequalities	I
.	O
since	O
the	O
values	O
of	O
each	O
xi	O
,	O
c	O
and	O
c	O
(	O
cid:2	O
)	O
are	O
known	O
,	O
they	O
form	O
a	O
set	O
of	O
inequalities	O
in	O
the	O
entries	O
of	O
v.	O
the	O
value	O
of	O
δ	O
is	O
not	O
known	O
a	O
priori	O
,	O
and	O
so	O
it	O
is	O
necessary	O
to	O
seek	O
a	O
solution	B
for	O
each	O
of	O
the	O
two	O
cases	O
δ	O
=	O
1	O
and	O
δ	O
=	O
−1	O
.	O
to	O
ﬁnd	O
the	O
required	O
transformation	B
h	O
,	O
ﬁrst	O
of	O
all	O
we	O
solve	O
the	O
cheiral	B
inequalities	I
to	O
ﬁnd	O
a	O
value	O
of	O
v	O
,	O
either	O
for	O
δ	O
=	O
1	O
or	O
δ	O
=	O
−1	O
.	O
the	O
required	O
matrix	B
h	O
is	O
any	O
matrix	B
having	O
vt	O
as	O
its	O
last	O
row	O
and	O
satisfying	O
the	O
condition	O
det	O
h	O
.	O
=	O
δ.	O
if	O
the	O
last	O
component	O
of	O
v	O
is	O
non-zero	O
,	O
then	O
h	O
can	O
be	O
chosen	O
to	O
have	O
the	O
simple	O
form	O
in	O
which	O
the	O
ﬁrst	O
three	O
rows	O
are	O
of	O
the	O
form	O
±	O
[	O
i	O
|	O
0	O
]	O
.	O
if	O
a	O
euclidean	O
reconstruction	O
(	O
or	O
more	O
speciﬁcally	O
a	O
quasi-afﬁne	B
reconstruction	I
)	O
is	O
possible	O
,	O
then	O
there	O
must	O
be	O
a	O
solution	B
either	O
for	O
δ	O
=	O
1	O
or	O
δ	O
=	O
−1	O
.	O
in	O
some	O
cases	O
there	O
will	O
exist	O
solutions	O
of	O
the	O
cheiral	O
inequalities	O
for	O
both	O
δ	O
=	O
1	O
and	O
δ	O
=	O
−1	O
.	O
this	O
will	O
mean	O
that	O
two	O
oppositely	O
oriented	O
strong	B
realizations	O
exist	O
.	O
the	O
conditions	O
under	O
which	O
this	O
may	O
occur	O
were	O
discussed	O
in	O
section	O
21.6.	O
solving	B
the	O
cheiral	B
inequalities	I
naturally	O
,	O
the	O
cheiral	B
inequalities	I
may	O
be	O
solved	O
using	O
techniques	O
of	O
linear	O
program-	O
ming	O
.	O
as	O
they	O
stand	O
however	O
,	O
if	O
v	O
is	O
a	O
solution	B
then	O
so	O
is	O
αv	O
for	O
any	O
positive	O
factor	O
α.	O
in	O
order	O
to	O
restrict	O
the	O
solution	B
domain	O
to	O
be	O
bounded	O
,	O
one	O
may	O
add	O
additional	O
inequal-	O
ities	O
.	O
for	O
instance	O
,	O
if	O
v	O
=	O
(	O
v1	O
,	O
v2	O
,	O
v3	O
,	O
v4	O
)	O
t	O
,	O
then	O
the	O
inequalities	O
−1	O
<	O
vi	O
<	O
1	O
serve	O
to	O
restrict	O
the	O
solution	B
domain	O
to	O
be	O
a	O
bounded	O
polyhedron	O
.	O
to	O
achieve	O
a	O
unique	O
solution	B
we	O
need	O
to	O
specify	O
some	O
goal	O
function	O
to	O
be	O
linearized	O
.	O
an	O
appropriate	O
strategy	O
is	O
to	O
seek	O
to	O
maximize	O
the	O
extent	O
to	O
which	O
each	O
of	O
the	O
inequali-	O
ties	O
is	O
satisﬁed	O
.	O
to	O
do	O
this	O
,	O
we	O
introduce	O
one	O
further	O
variable	O
,	O
d.	O
each	O
of	O
the	O
inequalities	O
atv	O
of	O
the	O
form	O
(	O
21.5	O
)	O
for	O
appropriate	O
a	O
is	O
replaced	O
by	O
an	O
inequality	O
atv	O
>	O
d.	O
we	O
seek	O
21.7	O
the	O
cheiral	B
inequalities	I
527	O
to	O
maximize	O
d	O
while	O
satisfying	O
all	O
the	O
inequalities	O
.	O
this	O
is	O
a	O
standard	O
linear	B
program-	O
ming	O
problem	O
,	O
for	O
which	O
many	O
methods	O
of	O
solution	O
exist	O
,	O
such	O
as	O
the	O
simplex	O
method	O
(	O
[	O
press-88	O
]	O
)	O
.1	O
if	O
a	O
solution	B
is	O
found	O
for	O
which	O
d	O
>	O
0	O
then	O
this	O
will	O
be	O
a	O
desired	O
solution	B
.	O
summary	B
of	O
the	O
algorithm	B
now	O
,	O
we	O
give	O
the	O
complete	O
algorithm	B
for	O
computing	O
a	O
quasi-afﬁne	O
reconstruction	B
of	O
a	O
scene	O
using	O
the	O
cheiral	B
inequalities	I
.	O
the	O
algorithm	B
as	O
outlined	O
above	O
was	O
discussed	O
for	O
the	O
case	O
of	O
two	O
views	O
.	O
in	O
the	O
present	O
case	O
it	O
will	O
be	O
presented	O
for	O
an	O
arbitrary	O
number	O
of	O
views	O
.	O
the	O
extension	O
to	O
more	O
views	O
is	O
straightforward	O
.	O
objective	O
given	O
a	O
set	O
of	O
3d	O
points	O
xi	O
and	O
camera	B
matrices	I
pj	O
constituting	O
a	O
projective	B
reconstruction	I
from	O
a	O
set	O
of	O
image	O
points	O
,	O
compute	O
a	O
projective	B
transformation	I
h	O
transforming	O
the	O
projective	B
to	O
a	O
quasi-afﬁne	B
reconstruction	I
.	O
algorithm	B
(	O
i	O
)	O
for	O
each	O
pair	O
(	O
i	O
,	O
j	O
)	O
such	O
that	O
point	B
xj	O
(	O
ii	O
)	O
replace	O
some	O
cameras	B
pj	O
by	O
−pj	O
and	O
some	O
points	O
xi	O
by	O
−xi	O
as	O
required	O
to	O
ensure	O
i	O
is	O
given	O
let	O
pjxi	O
=	O
w	O
j	O
i	O
ˆxj	O
i	O
.	O
that	O
each	O
w	O
j	O
i	O
>	O
0	O
.	O
(	O
iii	O
)	O
form	O
the	O
cheiral	B
inequalities	I
(	O
21.5	O
)	O
where	O
cj	O
=	O
cpj	O
is	O
deﬁned	O
by	O
deﬁnition	O
21.10	O
.	O
(	O
iv	O
)	O
for	O
each	O
of	O
the	O
values	O
δ	O
=	O
±1	O
,	O
choose	O
a	O
solution	B
(	O
if	O
it	O
exists	O
)	O
to	O
the	O
set	O
of	O
cheiral	O
inequalities	O
.	O
let	O
the	O
solution	B
be	O
vδ	O
.	O
a	O
solution	B
must	O
exist	O
for	O
at	O
least	O
one	O
value	O
of	O
δ	O
,	O
sometimes	O
for	O
both	O
values	O
of	O
δ	O
.	O
(	O
v	O
)	O
deﬁne	O
a	O
matrix	B
hδ	O
having	O
last	O
row	O
equal	O
to	O
vδ	O
and	O
such	O
that	O
det	O
(	O
h	O
)	O
.=	O
δ.	O
the	O
matrix	B
hδ	O
is	O
the	O
required	O
transformation	B
matrix	O
.	O
if	O
both	O
h+	O
and	O
h−	O
exist	O
,	O
then	O
they	O
lead	O
to	O
two	O
oppositely	B
oriented	I
quasi-afﬁne	O
reconstructions	O
.	O
algorithm	B
21.1.	O
computing	O
a	O
quasi-afﬁne	O
reconstruction	B
.	O
bounding	O
the	O
plane	O
at	O
inﬁnity	O
a	O
quasi-afﬁne	B
reconstruction	I
is	O
of	O
course	O
not	O
unique	O
,	O
being	O
deﬁned	O
only	O
up	O
to	O
a	O
quasi-	O
afﬁne	B
transformation	I
with	O
respect	O
to	O
the	O
points	O
and	O
camera	B
centres	O
.	O
however	O
,	O
once	O
one	O
has	O
been	O
found	O
,	O
it	O
is	O
possible	O
to	O
set	O
bounds	O
on	O
the	O
coordinates	B
of	O
the	O
plane	O
at	O
inﬁnity	O
.	O
thus	O
,	O
let	O
pj	O
and	O
xi	O
constitute	O
a	O
quasi-afﬁne	B
reconstruction	I
of	O
a	O
scene	O
.	O
one	O
may	O
choose	O
the	O
sign	O
of	O
pj	O
and	O
xi	O
such	O
that	O
the	O
last	O
coordinates	B
of	O
xi	O
and	O
the	O
determinants	O
of	O
each	O
mj	O
are	O
positive	O
.	O
one	O
may	O
apply	O
a	O
translation	O
to	O
the	O
points	O
and	O
cameras	B
so	O
that	O
the	O
coordinate	O
origin	O
lies	O
inside	O
the	O
convex	B
hull	I
of	O
the	O
points	O
and	O
camera	B
centres	O
.	O
for	O
simplicity	O
,	O
the	O
centroid	O
of	O
these	O
points	O
may	O
be	O
placed	O
at	O
the	O
origin	O
.	O
it	O
is	O
possible	O
to	O
apply	O
a	O
further	O
quasi-afﬁne	B
transformation	O
h	O
to	O
obtain	O
an	O
alternative	O
reconstruction	B
.	O
let	O
π∞	O
be	O
the	O
plane	B
mapped	O
to	O
inﬁnity	O
by	O
h.	O
we	O
conﬁne	O
our	O
interest	O
to	O
orientation-preserving	O
transforms	O
,	O
and	O
wish	O
to	O
ﬁnd	O
constraints	B
on	O
the	O
coordinates	B
of	O
π∞	O
such	O
that	O
h	O
is	O
quasi-afﬁne	B
.	O
a	O
plane	B
π∞	O
has	O
this	O
property	O
if	O
and	O
only	O
if	O
it	O
lies	O
entirely	O
outside	O
the	O
convex	B
hull	I
of	O
the	O
points	O
and	O
camera	B
centres	O
.	O
since	O
the	O
plane	B
π∞	O
1	O
the	O
simplex	O
algorithm	B
given	O
in	O
[	O
press-88	O
]	O
is	O
not	O
suitable	O
for	O
use	O
as	O
stands	O
,	O
since	O
it	O
makes	O
the	O
unnecessary	O
assumption	O
that	O
all	O
variables	O
are	O
non-negative	O
.	O
it	O
needs	O
to	O
be	O
modiﬁed	O
to	O
be	O
used	O
for	O
this	O
problem	O
.	O
21	O
cheirality	O
528	O
can	O
not	O
cross	O
the	O
convex	B
hull	I
,	O
it	O
can	O
not	O
pass	O
through	O
the	O
origin	O
.	O
representing	O
π∞	O
by	O
the	O
vector	O
v	O
,	O
this	O
says	O
that	O
the	O
last	O
coordinate	O
of	O
v	O
is	O
non-zero	O
.	O
one	O
may	O
then	O
write	O
v	O
=	O
(	O
v1	O
,	O
v2	O
,	O
v3	O
,	O
1	O
)	O
t.	O
since	O
the	O
origin	O
lies	O
on	O
the	O
same	O
side	O
of	O
the	O
plane	O
as	O
all	O
the	O
points	O
,	O
the	O
cheiral	B
inequalities	I
become	O
xt	O
v	O
>	O
0	O
for	O
all	O
i	O
i	O
cj	O
tv	O
>	O
0	O
for	O
all	O
j	O
(	O
21.6	O
)	O
for	O
v	O
=	O
(	O
v1	O
,	O
v2	O
,	O
v3	O
,	O
1	O
)	O
t.	O
one	O
may	O
ﬁnd	O
upper	O
and	O
lower	O
bounds	O
for	O
each	O
vi	O
by	O
solving	B
the	O
linear	B
programming	O
problem	O
to	O
maximize	O
vi	O
or	O
−vi	O
subject	O
to	O
these	O
constraints	B
.	O
none	O
of	O
the	O
vi	O
can	O
be	O
unbounded	O
,	O
since	O
otherwise	O
the	O
plane	B
π∞	O
represented	O
by	O
the	O
vector	O
v	O
could	O
lie	O
arbitrarily	O
close	O
to	O
the	O
origin	O
.	O
before	O
solving	O
for	O
this	O
system	O
,	O
good	O
practice	O
is	O
to	O
apply	O
an	O
afﬁne	B
transformation	I
to	O
normalize	O
the	O
set	O
of	B
points	I
and	O
camera	B
centres	O
so	O
that	O
their	O
centroid	O
is	O
at	O
the	O
origin	O
and	O
their	O
principal	O
moments	O
are	O
all	O
equal	O
to	O
1.	O
the	O
complete	O
algorithm	B
for	O
computing	B
the	O
bounds	O
on	O
the	O
position	O
of	O
the	O
plane	O
at	B
inﬁnity	I
is	O
given	O
in	O
algorithm	O
21.2.	O
objective	O
given	O
a	O
quasi-afﬁne	B
reconstruction	I
of	O
a	O
scene	O
,	O
establish	O
bounds	O
on	O
the	O
coordinates	B
of	O
the	O
plane	O
at	O
inﬁnity	O
.	O
algorithm	B
so	O
that	O
det	O
mj	O
=	O
1	O
.	O
(	O
i	O
)	O
normalize	O
the	O
points	O
xi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
zi	O
,	O
ti	O
)	O
t	O
so	O
that	O
ti	O
=	O
1	O
,	O
and	O
cameras	B
pj	O
=	O
[	O
mj	O
|	O
tj	O
]	O
(	O
ii	O
)	O
further	O
normalize	O
by	O
replacing	O
xi	O
by	O
h−1xi	O
and	O
pj	O
by	O
pjh	O
,	O
where	O
h	O
is	O
an	O
afﬁne	B
trans-	O
formation	O
moving	B
the	O
centroid	O
to	O
the	O
origin	O
and	O
scaling	B
in	O
the	O
principal	O
axis	O
directions	O
so	O
that	O
is	O
has	O
equal	O
principal	O
axes	O
.	O
(	O
iii	O
)	O
letting	O
v	O
=	O
(	O
v1	O
,	O
v2	O
,	O
v3	O
,	O
1	O
)	O
t	O
,	O
form	O
cheiral	O
inequalities	O
(	O
21.6	O
)	O
.	O
any	O
orientation-	O
preserving	O
transformation	B
h	O
mapping	O
the	O
reconstruction	O
to	O
an	O
afﬁne	B
reconstruction	I
of	O
the	O
image	O
must	O
have	O
the	O
form	O
(	O
cid:24	O
)	O
(	O
cid:25	O
)	O
h	O
=	O
i	O
v1	O
v2	O
v3	O
0	O
1	O
for	O
a	O
vector	O
v	O
satisfying	O
these	O
inequalities	O
.	O
(	O
iv	O
)	O
upper	O
and	O
lower	O
bounds	O
for	O
each	O
vi	O
may	O
be	O
found	O
by	O
running	O
a	O
linear	B
programming	O
problem	O
six	O
times	O
.	O
the	O
coordinates	B
of	O
a	O
desired	O
transformation	B
h	O
must	O
lie	O
inside	O
the	O
box	O
deﬁned	O
by	O
these	O
bounds	O
.	O
algorithm	B
21.2.	O
establishing	O
bounds	O
on	O
the	O
plane	O
at	O
inﬁnity	O
.	O
21.8	O
which	O
points	O
are	O
visible	O
in	O
a	O
third	O
view	O
consider	O
a	O
scene	O
reconstructed	O
from	O
two	O
views	O
.	O
we	O
consider	O
now	O
the	O
question	O
of	O
determining	O
which	O
points	O
are	O
visible	O
in	O
a	O
third	O
view	O
.	O
such	O
a	O
question	O
arises	O
when	O
one	O
is	O
given	O
two	O
uncalibrated	O
views	O
of	O
a	O
scene	O
and	O
one	O
seeks	O
to	O
synthesize	O
a	O
third	O
view	O
.	O
this	O
can	O
be	O
done	O
by	O
carrying	O
out	O
a	O
projective	B
reconstruction	I
of	O
the	O
scene	O
from	O
the	O
21.8	O
which	O
points	O
are	O
visible	O
in	O
a	O
third	O
view	O
529	O
π∞	O
p1	O
p2	O
p3	O
x	O
fig	O
.	O
21.3.	O
the	O
point	B
set	O
x	O
is	O
in	O
front	O
of	O
all	O
three	O
cameras	B
as	O
shown	O
.	O
however	O
,	O
if	O
an	O
orientation-	O
preserving	O
projective	B
transformation	I
h	O
is	O
applied	O
taking	O
the	O
plane	B
π∞	O
to	O
inﬁnity	O
,	O
then	O
the	O
point	B
set	O
will	O
subsequently	O
lie	O
in	O
front	O
of	O
the	O
cameras	O
p1	O
and	O
p2	O
but	O
behind	O
the	O
camera	B
p3	O
.	O
thus	O
,	O
suppose	O
the	O
point	B
set	O
x	O
is	O
reconstructed	O
from	O
images	O
captured	O
by	O
cameras	B
p1	O
and	O
p2	O
,	O
and	O
let	O
p3	O
be	O
any	O
other	O
cam-	O
era	O
matrix	B
.	O
if	O
a	O
plane	B
exists	O
separating	O
the	O
centre	B
of	O
camera	B
p3	O
from	O
the	O
other	O
camera	B
centres	O
,	O
and	O
not	O
meeting	O
the	O
convex	B
hull	I
of	O
the	O
point	B
set	O
x	O
,	O
then	O
it	O
can	O
not	O
be	O
determined	O
whether	O
the	O
points	O
lie	O
in	O
front	O
of	O
p3	O
.	O
ﬁrst	O
two	B
views	I
and	O
then	O
projecting	O
into	O
the	O
third	O
view	O
.	O
in	O
this	O
case	O
,	O
it	O
is	O
important	O
to	O
determine	O
if	O
a	O
point	B
lies	O
in	O
front	O
of	O
the	O
third	O
camera	B
and	O
is	O
hence	O
visible	O
,	O
or	O
not	O
.	O
if	O
the	O
third	O
view	O
is	O
given	O
simply	O
by	O
specifying	O
the	O
camera	B
matrix	I
with	O
respect	O
to	O
the	O
frame	O
of	O
reference	O
of	O
some	O
given	O
reconstruction	B
,	O
then	O
it	O
may	O
be	O
impossible	O
to	O
determine	O
whether	O
points	O
are	O
in	O
front	O
of	O
the	O
third	O
camera	B
or	O
behind	O
it	O
in	O
the	O
true	O
scene	O
.	O
the	O
basic	O
ambiguity	O
is	O
illustrated	O
in	O
ﬁgure	O
21.3.	O
knowledge	O
of	O
a	O
single	O
point	B
known	O
to	O
be	O
visible	O
in	O
the	O
third	O
view	O
serves	O
to	O
break	O
the	O
ambiguity	B
,	O
however	O
,	O
as	O
the	O
following	O
result	O
shows	O
.	O
by	O
applying	O
theorem	O
21.7	O
(	O
p519	O
)	O
to	O
the	O
ﬁrst	O
and	O
third	O
views	O
,	O
one	O
obtains	O
the	O
following	O
criterion	O
.	O
result	O
21.17.	O
let	O
points	O
(	O
p1	O
,	O
p2	O
,	O
{	O
xi	O
}	O
)	O
be	O
a	O
realization	B
of	O
a	O
set	O
of	O
correspondences	O
j	O
ˆxi	O
=	O
pixj	O
j	O
has	O
the	O
same	O
sign	O
for	O
all	O
points	O
xj	O
visible	O
in	O
the	O
third	O
i	O
.	O
let	O
p3	O
be	O
the	O
camera	B
matrix	I
of	O
a	O
third	O
view	O
and	O
suppose	O
that	O
wi	O
↔	O
x2	O
x1	O
i	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
.	O
then	O
w1	O
view	O
.	O
j	O
w3	O
in	O
practice	O
,	O
it	O
will	O
usually	O
be	O
the	O
case	O
that	O
one	O
knows	O
at	O
least	O
one	O
point	B
x0	O
visible	O
in	O
0	O
,	O
and	O
any	O
other	O
point	B
xj	O
will	O
be	O
in	O
0w3	O
0	O
.	O
0w3	O
the	O
third	O
view	O
.	O
this	O
serves	O
to	O
deﬁne	O
the	O
sign	O
w1	O
.	O
front	O
of	O
the	O
camera	O
p3	O
if	O
and	O
only	O
if	O
w1	O
=	O
w1	O
j	O
w3	O
j	O
as	O
an	O
example	O
,	O
once	O
a	O
projective	B
reconstruction	I
has	O
been	O
carried	O
out	O
using	O
two	O
views	O
,	O
the	O
camera	B
matrix	I
of	O
the	O
third	O
camera	B
may	O
be	O
determined	O
from	O
the	O
images	O
of	O
six	O
or	O
more	O
points	O
known	O
to	O
be	O
in	O
front	O
of	O
it	O
by	O
solving	B
directly	O
for	O
the	O
matrix	B
p3	O
given	O
the	O
correspondences	B
x3	O
i	O
=	O
p3xi	O
where	O
points	O
xi	O
are	O
the	O
reconstructed	O
points	O
.	O
then	O
one	O
can	O
determine	O
unambiguously	O
which	O
other	O
points	O
are	O
in	O
front	O
of	O
p3	O
.	O
530	O
21	O
cheirality	O
x2	O
x1	O
π∞	O
fig	O
.	O
21.4.	O
as	O
shown	O
,	O
the	O
point	B
x1	O
is	O
closer	O
to	O
the	O
camera	B
than	O
x2	O
.	O
however	O
,	O
if	O
an	O
orientation-reversing	O
projectivity	B
is	O
applied	O
,	O
taking	O
π∞	O
to	O
inﬁnity	O
,	O
then	O
both	O
x1	O
and	O
x2	O
remain	O
in	O
front	O
of	O
the	O
camera	O
,	O
but	O
x2	O
is	O
closer	O
to	O
the	O
camera	B
than	O
x1	O
.	O
21.9	O
which	O
points	O
are	O
in	O
front	O
of	O
which	O
when	O
we	O
are	O
attempting	O
to	O
synthesize	O
a	O
new	O
view	O
of	O
a	O
scene	O
that	O
has	O
been	O
recon-	O
structed	O
from	O
two	O
or	O
more	O
uncalibrated	O
views	O
it	O
is	O
sometimes	O
necessary	O
to	O
consider	O
the	O
possibility	O
of	B
points	I
being	O
obscured	O
by	O
other	O
points	O
.	O
this	O
leads	O
to	O
the	O
question	O
:	O
given	O
two	O
points	O
that	O
project	O
to	O
the	O
same	O
point	O
in	O
the	O
new	O
view	O
,	O
which	O
one	O
is	O
closer	O
to	O
the	O
camera	B
,	O
and	O
hence	O
obscures	O
the	O
other	O
?	O
in	O
the	O
case	O
where	O
the	O
possibility	O
exists	O
of	O
oppositely	O
oriented	O
quasi-afﬁne	B
reconstructions	O
it	O
may	O
once	O
again	O
be	O
impossible	O
to	O
determine	O
which	O
of	O
a	O
pair	O
of	B
points	I
is	O
closer	O
to	O
the	O
new	O
camera	B
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
21.4.	O
if	O
a	O
plane	B
exists	O
,	O
separating	O
the	O
camera	B
centres	O
from	O
the	O
point	B
set	O
,	O
then	O
two	O
oppositely	O
oriented	O
reconstructions	O
exist	O
,	O
and	O
one	O
can	O
not	O
determine	O
which	O
points	O
are	O
in	O
front	O
of	O
which	O
.	O
the	O
sort	O
of	O
ambiguity	O
shown	O
in	O
ﬁgure	O
21.4	O
can	O
only	O
occur	O
in	O
the	O
case	O
where	O
there	O
exists	O
a	O
plane	B
π∞	O
that	O
separates	O
the	O
camera	B
centres	O
from	O
the	O
set	O
of	O
all	O
visible	O
points	O
.	O
if	O
this	O
is	O
not	O
the	O
case	O
,	O
then	O
one	O
can	O
compute	O
a	O
quasi-afﬁne	B
reconstruc-	O
tion	O
and	O
the	O
problem	O
is	O
easily	O
solved	O
.	O
to	O
avoid	O
the	O
effort	O
of	O
computing	O
a	O
quasi-afﬁne	B
reconstruction	I
,	O
however	O
,	O
we	O
would	O
like	O
to	O
solve	O
this	O
problem	O
using	O
only	O
a	O
projective	B
reconstruction	I
of	O
the	O
scene	O
.	O
how	O
this	O
may	O
be	O
done	O
is	O
explained	O
next	O
.	O
−1	O
(	O
x	O
;	O
p	O
)	O
=	O
1/depth	O
(	O
x	O
;	O
p	O
)	O
.	O
this	O
inverse	O
depth	O
function	O
is	O
inﬁnite	O
on	O
the	O
principal	B
plane	I
of	O
the	O
camera	B
,	O
zero	O
on	O
the	O
plane	O
at	O
inﬁnity	O
,	O
positive	O
for	O
points	O
in	O
front	O
of	O
the	O
camera	O
and	O
negative	O
for	O
points	O
behind	O
the	O
camera	B
.	O
for	O
notational	O
simplicity	O
,	O
we	O
write	O
χ	O
(	O
x	O
;	O
p	O
)	O
instead	O
of	O
depth	O
one	O
may	O
invert	O
(	O
21.1–p518	O
)	O
to	O
get	O
an	O
expression	O
for	O
depth	O
−1	O
(	O
x	O
;	O
p	O
)	O
.	O
for	O
points	O
x	O
lying	O
on	O
a	O
ray	O
through	O
the	O
camera	B
centre	I
,	O
the	O
value	O
of	O
χ	O
(	O
x	O
;	O
p	O
)	O
decreases	O
monotonically	O
along	O
this	O
ray	O
,	O
from	O
zero	O
at	O
the	O
camera	B
centre	I
,	O
decreasing	O
through	O
posi-	O
tive	O
values	O
to	O
zero	O
at	O
the	O
plane	O
at	O
inﬁnity	O
,	O
thence	O
continuing	O
to	O
decrease	O
through	O
nega-	O
tive	O
values	O
to	O
−∞	O
at	O
the	O
camera	B
centre	I
.	O
a	O
point	B
x1	O
lies	O
closer	O
to	O
the	O
front	O
of	O
the	O
camera	O
than	O
x2	O
if	O
and	O
only	O
if	O
χ	O
(	O
x1	O
)	O
>	O
χ	O
(	O
x2	O
)	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
21.5	O
.	O
(	O
cid:2	O
)	O
deﬁned	O
by	O
χ	O
now	O
,	O
if	O
the	O
conﬁguration	O
undergoes	O
an	O
orientation-preserving	O
transformation	B
h	O
tak-	O
ing	O
the	O
plane	B
π∞	O
to	O
inﬁnity	O
,	O
then	O
the	O
parameter	O
χ	O
will	O
be	O
replaced	O
by	O
a	O
new	O
parameter	O
(	O
cid:2	O
)	O
must	O
also	O
vary	O
monotonically	O
χ	O
along	O
the	O
ray	O
.	O
since	O
h	O
is	O
orientation-preserving	O
,	O
points	O
just	O
in	O
front	O
of	O
the	O
camera	O
cen-	O
tre	O
will	O
remain	O
in	O
front	O
of	O
the	O
camera	O
after	O
the	O
transformation	B
,	O
because	O
of	O
result	O
21.13	O
.	O
(	O
cid:2	O
)	O
(	O
x	O
)	O
=χ	O
(	O
hx	O
;	O
ph−1	O
)	O
.	O
the	O
value	O
of	O
χ	O
531	O
21.10	O
closure	O
χ'=0	O
χ	O
<	O
0	O
χ	O
<	O
0	O
χ	O
'	O
<	O
0	O
x2	O
χ	O
'	O
>	O
0	O
x1	O
π∞	O
χ	O
>	O
0	O
fig	O
.	O
21.5.	O
the	O
parameter	O
χ	O
.	O
(	O
cid:2	O
)	O
thus	O
both	O
χ	O
and	O
χ	O
and	O
x2	O
are	O
two	O
points	O
on	O
the	O
line	B
,	O
then	O
χ	O
decrease	O
monotonically	O
in	O
the	O
same	O
direction	O
along	O
the	O
ray	O
.	O
if	O
x1	O
(	O
x2	O
)	O
if	O
and	O
only	O
if	O
χ	O
(	O
x1	O
)	O
>	O
χ	O
(	O
x2	O
)	O
.	O
in	O
the	O
case	O
where	O
the	O
projective	B
transformation	I
has	O
negative	O
determinant	O
,	O
then	O
the	O
front	O
and	O
back	O
of	O
the	O
camera	O
are	O
reversed	O
locally	O
.	O
in	O
this	O
case	O
the	O
direction	O
of	O
increase	O
(	O
x2	O
)	O
if	O
and	O
only	O
if	O
of	O
the	O
parameter	O
χ	O
χ	O
(	O
x1	O
)	O
<	O
χ	O
(	O
x2	O
)	O
.	O
will	O
be	O
reversed	O
.	O
consequently	O
,	O
χ	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
x1	O
)	O
>	O
χ	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
x1	O
)	O
>	O
χ	O
in	O
the	O
case	O
where	O
the	O
projective	B
transformation	I
transforms	O
the	O
scene	O
to	O
the	O
“	O
true	O
”	O
scene	O
,	O
of	O
two	O
points	O
that	O
project	O
to	O
the	O
same	O
point	O
in	O
the	O
image	O
,	O
the	O
one	O
with	O
the	O
higher	O
(	O
cid:2	O
)	O
value	O
of	O
χ	O
is	O
closer	O
to	O
the	O
camera	B
.	O
this	O
leads	O
to	O
the	O
following	O
result	O
that	O
allows	O
us	O
to	O
determine	O
from	O
an	O
arbitrary	O
projective	B
reconstruction	I
which	O
of	O
two	O
points	O
is	O
closer	O
to	O
the	O
front	O
of	O
the	O
camera	O
.	O
result	O
21.18.	O
suppose	O
that	O
x1	O
and	O
x2	O
are	O
two	O
points	O
that	O
map	O
to	O
the	O
same	O
point	O
in	O
an	O
image	O
.	O
consider	O
a	O
projective	B
reconstruction	I
of	O
the	O
scene	O
and	O
let	O
the	O
parameter	O
χ	O
be	O
deﬁned	O
(	O
by	O
formula	O
(	O
21.3–p521	O
)	O
)	O
in	O
the	O
frame	O
of	O
the	O
projective	O
reconstruction	B
.	O
if	O
the	O
projective	B
reconstruction	I
has	O
the	O
same	O
orientation	O
as	O
the	O
true	O
scene	O
,	O
then	O
the	O
point	B
that	O
lies	O
closer	O
to	O
the	O
front	O
of	O
the	O
camera	O
in	O
the	O
true	O
scene	O
is	O
the	O
one	O
that	O
has	O
the	O
greater	O
value	O
of	O
χ.	O
on	O
the	O
other	O
hand	O
,	O
if	O
the	O
projective	B
transformation	I
has	O
the	O
opposite	O
orientation	B
,	O
then	O
the	O
point	B
with	O
smaller	O
value	O
of	O
χ	O
will	O
lie	O
closer	O
to	O
the	O
front	O
of	O
the	O
camera	O
in	O
the	O
true	O
scene	O
.	O
as	O
remarked	O
previously	O
,	O
unless	O
there	O
exists	O
a	O
plane	B
separating	O
the	O
point	B
set	O
from	O
the	O
cameras	B
used	O
for	O
the	O
reconstruction	B
,	O
the	O
orientation	B
of	O
the	O
scene	O
is	O
uniquely	O
de-	O
termined	O
,	O
and	O
one	O
can	O
determine	O
whether	O
the	O
projective	B
transformation	I
of	O
result	O
21.18	O
has	O
positive	O
or	O
negative	O
determinant	O
.	O
however	O
,	O
to	O
do	O
this	O
may	O
require	O
one	O
to	O
compute	O
a	O
strong	B
realization	O
of	O
the	O
conﬁguration	O
by	O
the	O
linear	B
programming	O
method	O
as	O
described	O
in	O
section	O
21.7.	O
if	O
differently	O
oriented	O
strong	B
realizations	O
exist	O
,	O
then	O
as	O
illustrated	O
by	O
ﬁgure	O
21.4	O
,	O
there	O
is	O
an	O
essential	O
ambiguity	O
.	O
however	O
,	O
this	O
ambiguity	B
may	O
be	O
resolved	O
by	O
knowledge	O
of	O
the	O
relative	O
distance	B
from	O
the	O
camera	B
of	O
a	O
single	O
pair	O
of	B
points	I
.	O
21.10	O
closure	O
21.10.1	O
the	O
literature	O
the	O
topic	O
of	O
this	O
chapter	O
belongs	O
to	O
oriented	O
projective	B
geometry	O
,	O
which	O
is	O
treated	O
in	O
a	O
standard	O
and	O
readable	O
text	O
[	O
stolﬁ-91	O
]	O
.	O
laveau	O
and	O
faugeras	O
apply	O
the	O
ideas	O
of	O
532	O
21	O
cheirality	O
oriented	O
projective	B
geometry	O
in	O
[	O
laveau-96b	O
]	O
.	O
the	O
concepts	O
of	O
front	O
and	O
back	O
of	O
the	O
camera	O
were	O
also	O
used	O
in	O
[	O
robert-93	O
]	O
to	O
compute	O
convex	O
hulls	O
in	O
projective	O
recon-	O
structions	O
.	O
this	O
chapter	O
derives	O
from	O
the	O
paper	O
[	O
hartley-98a	O
]	O
which	O
also	O
treats	O
such	O
topics	O
of	O
invariants	O
for	O
quasi-afﬁne	O
mappings	O
and	O
conditions	O
under	O
which	O
arbitrary	O
correspondences	B
allow	O
quasi-afﬁne	B
reconstructions	O
.	O
cheirality	O
,	O
and	O
speciﬁcally	O
the	O
cheirality	O
inequalities	O
have	O
been	O
useful	O
in	O
determin-	O
ing	O
quasi-afﬁne	B
reconstructions	O
as	O
an	O
intermediate	O
step	O
towards	O
afﬁne	B
and	O
metric	B
recon-	O
struction	O
in	O
[	O
hartley-94b	O
,	O
hartley-99	O
]	O
.	O
more	O
recently	O
werner	O
and	O
pajdla	O
in	O
[	O
werner-01	O
]	O
have	O
used	O
oriented	O
projective	B
geometry	O
to	O
eliminate	O
spurious	O
line	B
correspondences	I
,	O
and	O
to	O
constrain	O
correspondences	B
of	O
ﬁve	O
points	O
[	O
werner-03	O
]	O
,	O
over	O
two	B
views	I
.	O
22	O
degenerate	B
conﬁgurations	I
in	O
past	O
chapters	O
we	O
have	O
given	O
algorithms	O
for	O
the	O
estimation	B
of	I
various	O
quantities	O
as-	O
sociated	O
with	O
multiple	O
images	O
–	O
the	O
projection	B
matrix	O
,	O
the	O
fundamental	B
matrix	I
and	O
the	O
trifocal	B
tensor	I
.	O
in	O
each	O
of	O
these	O
cases	O
,	O
linear	B
and	O
iterative	B
algorithms	I
were	O
given	O
,	O
but	O
little	O
consideration	O
was	O
given	O
to	O
the	O
possibility	O
that	O
these	O
algorithms	O
could	O
fail	O
.	O
we	O
now	O
consider	O
under	O
what	O
conditions	O
this	O
might	O
happen	O
.	O
typically	O
,	O
if	O
sufﬁciently	O
many	O
point	B
correspondences	O
are	O
given	O
in	O
some	O
sort	O
of	O
“	O
gen-	O
eral	O
position	O
”	O
then	O
the	O
quantities	O
in	O
question	O
will	O
be	O
uniquely	O
determined	O
,	O
and	O
the	O
algo-	O
rithms	O
we	O
have	O
given	O
will	O
succeed	O
.	O
however	O
,	O
if	O
there	O
are	O
too	O
few	O
point	B
correspondences	O
given	O
,	O
or	O
else	O
all	O
the	O
points	O
lie	O
in	O
certain	O
critical	B
conﬁgurations	I
,	O
then	O
there	O
will	O
not	O
be	O
a	O
unique	O
solution	B
.	O
sometimes	O
there	O
will	O
be	O
a	O
ﬁnite	B
number	O
of	O
different	O
solutions	O
,	O
and	O
sometimes	O
a	O
complete	O
family	O
of	O
solutions	O
.	O
this	O
chapter	O
will	O
concentrate	O
on	O
three	O
of	O
the	O
main	O
estimation	B
problems	O
that	O
we	O
have	O
encountered	O
in	O
this	O
book	O
,	O
camera	B
resectioning	I
,	O
reconstruction	B
from	O
two	B
views	I
and	O
re-	O
construction	O
from	O
three	O
views	O
.	O
some	O
of	O
the	O
results	O
given	O
here	O
are	O
classical	O
,	O
particularly	O
the	O
camera	B
resectioning	I
and	O
two-view	O
critical	B
surface	I
problems	O
.	O
others	O
are	O
more	O
recent	O
results	O
.	O
we	O
consider	O
the	O
different	O
estimation	B
problems	O
in	O
turn	O
.	O
22.1	O
camera	B
resectioning	I
we	O
begin	O
by	O
considering	O
the	O
problem	O
of	O
computing	B
the	O
camera	B
projection	O
matrix	B
,	O
given	O
a	O
set	O
of	B
points	I
in	O
space	O
and	O
the	O
corresponding	O
set	O
of	B
points	I
in	O
the	O
image	O
.	O
thus	O
,	O
one	O
is	O
given	O
a	O
set	O
of	B
points	I
xi	O
in	O
space	O
that	O
are	O
mapped	O
to	O
points	O
xi	O
in	O
the	O
image	O
by	O
a	O
camera	B
with	O
projection	B
matrix	O
p.	O
the	O
coordinates	B
of	O
the	O
points	O
in	O
space	O
and	O
the	O
image	O
are	O
known	O
,	O
and	O
the	O
matrix	B
p	O
is	O
to	O
be	O
computed	O
.	O
this	O
problem	O
was	O
considered	O
in	O
chapter	O
7.	O
before	O
considering	O
the	O
critical	B
conﬁgurations	I
for	O
this	O
problem	O
,	O
we	O
will	O
digress	O
to	O
look	O
at	O
an	O
abstraction	O
of	O
the	O
camera	O
projection	B
.	O
cameras	B
as	O
points	O
suppose	O
the	O
existence	O
of	O
a	O
set	O
of	O
correspondences	O
xi	O
↔	O
xi	O
.	O
let	O
us	O
suppose	O
that	O
there	O
is	O
a	O
unique	O
camera	B
matrix	I
p	O
such	O
that	O
xi	O
=	O
pxi	O
.	O
now	O
,	O
let	O
h	O
be	O
a	O
matrix	B
representing	O
a	O
projective	B
transformation	I
of	O
the	O
image	O
,	O
and	O
let	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
hxi	O
be	O
the	O
set	O
of	O
transformed	O
image	O
coordinates	O
.	O
then	O
it	O
is	O
clear	O
that	O
there	O
is	O
a	O
unique	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
such	O
that	O
533	O
22	O
degenerate	B
conﬁgurations	I
534	O
i	O
=	O
p	O
(	O
cid:2	O
)	O
xi	O
,	O
namely	O
the	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
=	O
hp	O
.	O
conversely	O
,	O
if	O
there	O
exists	O
more	O
than	O
one	O
camera	B
matrix	I
p	O
mapping	O
xi	O
to	O
xi	O
,	O
then	O
there	O
exists	O
more	O
than	O
one	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
mapping	O
xi	O
to	O
x	O
(	O
cid:2	O
)	O
i.	O
thus	O
,	O
the	O
existence	O
or	O
not	O
of	O
a	O
unique	O
solution	B
to	O
the	O
problem	O
of	O
determining	O
the	O
projection	O
matrix	B
p	O
is	O
dependent	O
on	O
the	O
image	O
points	O
xi	O
only	O
up	O
to	O
a	O
projective	B
transformation	I
h	O
of	O
the	O
image	O
.	O
next	O
,	O
observe	O
that	O
applying	O
a	O
projective	B
transformation	I
h	O
to	O
a	O
camera	B
matrix	I
p	O
does	O
not	O
change	O
the	O
camera	B
centre	I
.	O
speciﬁcally	O
,	O
the	O
point	B
c	O
is	O
the	O
camera	B
centre	I
if	O
and	O
only	O
if	O
pc	O
=	O
0.	O
however	O
pc	O
=	O
0	O
if	O
and	O
only	O
if	O
hpc	O
=	O
0.	O
thus	O
,	O
the	O
camera	B
centre	I
is	O
preserved	O
by	O
a	O
projective	B
transformation	I
of	O
the	O
image	O
.	O
next	O
,	O
we	O
show	O
that	O
this	O
is	O
essentially	O
the	O
only	O
property	O
of	O
the	O
camera	O
that	O
is	O
preserved	O
.	O
result	O
22.1.	O
let	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
be	O
two	O
camera	O
matrices	O
with	O
the	O
same	O
centre	O
.	O
then	O
there	O
exists	O
a	O
projective	B
image	O
transformation	B
represented	O
by	O
a	O
non-singular	O
matrix	B
h	O
such	O
that	O
p	O
(	O
cid:2	O
)	O
=	O
hp	O
.	O
proof	O
.	O
if	O
the	O
centre	B
c	O
is	O
not	O
at	B
inﬁnity	I
,	O
then	O
the	O
camera	B
matrices	I
are	O
of	O
the	O
form	O
p	O
=	O
[	O
m	O
|	O
−mc	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
m	O
(	O
cid:2	O
)	O
|	O
−m	O
(	O
cid:2	O
)	O
c	O
]	O
,	O
where	O
c	O
is	O
the	O
inhomogeneous	O
3-vector	O
representing	O
the	O
a	O
3d	O
projective	B
transformation	I
g	O
such	O
that	O
gc	O
is	O
a	O
ﬁnite	B
point	O
,	O
say	O
(	O
cid:23	O
)	O
c.	O
in	O
this	O
case	O
,	O
the	O
camera	B
centre	I
.	O
then	O
clearly	O
,	O
p	O
(	O
cid:2	O
)	O
=	O
m	O
(	O
cid:2	O
)	O
m−1p	O
.	O
if	O
c	O
is	O
a	O
point	B
at	O
inﬁnity	O
,	O
then	O
one	O
chooses	O
two	O
camera	O
matrices	O
pg−1	O
and	O
p	O
(	O
cid:2	O
)	O
g−1	O
both	O
have	O
the	O
same	O
centre	O
,	O
namely	O
(	O
cid:23	O
)	O
c.	O
it	O
follows	O
that	O
p	O
(	O
cid:2	O
)	O
g	O
=	O
hpg	O
for	O
some	O
h.	O
cancelling	O
g	O
gives	O
p	O
(	O
cid:2	O
)	O
=	O
hp	O
.	O
this	O
result	O
may	O
be	O
interpreted	O
as	O
saying	O
that	O
an	O
image	O
is	O
determined	O
up	O
to	O
projectivity	O
by	O
the	O
camera	B
centre	I
alone	O
.	O
thus	O
,	O
we	O
see	O
that	O
in	O
considering	O
the	O
problem	O
of	O
uniqueness	B
of	O
the	O
camera	B
matrix	I
,	O
one	O
may	O
ignore	O
all	O
the	O
parameters	B
of	O
the	O
camera	B
,	O
except	O
the	O
camera	B
centre	I
,	O
since	O
this	O
alone	O
determines	O
the	O
projectivity	B
type	O
of	O
the	O
image	O
,	O
and	O
hence	O
the	O
uniqueness	B
or	O
not	O
of	O
a	O
solution	O
.	O
images	O
as	O
equivalence	O
classes	O
of	O
rays	O
to	O
gain	O
insight	O
into	O
the	O
critical	B
conﬁgurations	I
of	O
camera	B
resectioning	I
,	O
we	O
turn	O
ﬁrst	O
to	O
consider	O
2-dimensional	O
cameras	B
,	O
mapping	O
ip2	O
to	O
ip1	O
.	O
consider	O
a	O
camera	B
centre	I
c	O
and	O
a	O
set	O
of	B
points	I
xi	O
in	O
space	O
.	O
the	O
rays	O
cxi	O
intersect	O
an	O
image	O
line	O
l	O
at	O
a	O
set	O
of	B
points	I
¯xi	O
;	O
thus	O
points	O
¯xi	O
are	O
the	O
images	O
of	O
the	O
points	O
xi	O
.	O
the	O
projection	B
of	O
the	O
points	O
xi	O
to	O
points	O
¯xi	O
in	O
the	O
1d	O
image	O
may	O
be	O
described	O
by	O
a	O
2	O
×	O
3	O
projection	B
matrix	O
as	O
described	O
in	O
section	O
6.4.2	O
(	O
p175	O
)	O
.	O
as	O
shown	O
in	O
chapter	O
2	O
,	O
the	O
projective	B
equivalence	O
type	O
of	O
the	O
set	O
of	O
rays	O
cxi	O
is	O
the	O
same	O
as	O
that	O
of	O
the	O
image	O
points	O
¯xi	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
22.1.	O
thus	O
,	O
instead	O
of	O
considering	O
an	O
image	O
as	O
being	O
the	O
set	O
of	B
points	I
on	O
the	O
image	O
line	O
,	O
the	O
image	O
may	O
be	O
thought	O
of	O
as	O
the	O
projective	B
equivalence	O
class	O
of	O
the	O
set	O
of	O
rays	O
from	O
the	O
camera	B
centre	I
through	O
each	O
of	O
the	O
image	O
points	O
.	O
in	O
the	O
case	O
of	O
just	O
4	O
image	O
points	O
,	O
the	O
cross	B
ratio	I
of	O
the	O
points	O
¯xi	O
(	O
or	O
equivalently	O
,	O
the	O
rays	O
)	O
characterizes	O
their	O
projective	B
equivalence	O
class	O
.	O
to	O
give	O
a	O
speciﬁc	O
notation	O
,	O
we	O
denote	O
by	O
(	O
cid:8	O
)	O
c	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
x	O
i	O
,	O
.	O
.	O
.	O
xn	O
(	O
cid:9	O
)	O
the	O
projective	B
equivalence	O
class	O
of	O
the	O
set	O
of	O
rays	O
cxi	O
.	O
the	O
same	O
remarks	O
are	O
valid	O
for	O
projections	O
of	O
3d	O
points	O
into	O
a	O
2-dimensional	O
image	O
.	O
one	O
may	O
also	O
extend	O
the	O
above	O
notation	O
by	O
writing	O
(	O
cid:8	O
)	O
c	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xn	O
(	O
cid:9	O
)	O
to	O
represent	O
the	O
22.1	O
camera	B
resectioning	I
l	O
x	O
1	O
535	O
x2	O
x	O
1	O
x	O
2	O
x	O
3	O
x	O
4	O
x	O
3	O
x	O
4	O
c	O
fig	O
.	O
22.1.	O
projection	B
of	O
points	O
in	O
the	O
plane	B
using	O
a	O
2d	O
camera	B
.	O
a	O
1d	O
image	O
is	O
formed	O
by	O
the	O
intersection	B
of	O
the	O
rays	O
li	O
=	O
cxi	O
with	O
the	O
image	O
line	O
l.	O
the	O
set	O
of	O
image	O
points	O
{	O
¯xi	O
}	O
is	O
projectively	O
equivalent	B
to	O
the	O
set	O
of	O
rays	O
{	O
li	O
}	O
.	O
for	O
four	O
points	O
,	O
the	O
projective	B
equivalence	O
class	O
of	O
the	O
image	O
is	O
determined	O
by	O
the	O
cross	B
ratio	I
of	O
the	O
points	O
.	O
projective	B
equivalence	O
class	O
of	O
all	O
the	O
rays	O
cxi	O
.	O
as	O
in	O
the	O
2-dimensional	O
case	O
,	O
this	O
is	O
an	O
abstraction	O
of	O
the	O
projection	O
of	O
the	O
points	O
xi	O
relative	O
to	O
a	O
camera	B
with	O
centre	B
at	O
c.	O
we	O
will	O
be	O
considering	O
conﬁgurations	O
of	B
camera	I
centres	O
and	O
3d	O
points	O
,	O
which	O
will	O
be	O
denoted	O
by	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cm	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xn	O
}	O
or	O
variations	O
thereof	O
.	O
implicit	O
is	O
that	O
the	O
symbols	O
appearing	O
before	O
the	O
semicolon	O
are	O
camera	B
centres	O
,	O
and	O
those	O
that	O
come	O
after	O
are	O
3d	O
points	O
.	O
in	O
order	O
to	O
make	O
the	O
statements	O
of	O
derived	O
results	O
simple	O
,	O
the	O
concept	O
of	O
image	O
equivalence	O
is	O
deﬁned	O
.	O
deﬁnition	B
22.2.	O
two	O
conﬁgurations	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cm	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xn	O
}	O
and	O
{	O
c	O
(	O
cid:2	O
)	O
1	O
,	O
.	O
.	O
.	O
,	O
c	O
(	O
cid:2	O
)	O
are	O
called	O
image-equivalent	O
if	O
(	O
cid:8	O
)	O
ci	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xn	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
c	O
(	O
cid:2	O
)	O
1	O
,	O
.	O
.	O
.	O
,	O
m.	O
n	O
n	O
m	O
;	O
x	O
(	O
cid:2	O
)	O
i	O
;	O
x	O
(	O
cid:2	O
)	O
1	O
,	O
.	O
.	O
.	O
,	O
x	O
(	O
cid:2	O
)	O
1	O
,	O
.	O
.	O
.	O
,	O
x	O
(	O
cid:2	O
)	O
}	O
(	O
cid:9	O
)	O
for	O
all	O
i	O
=	O
the	O
concept	O
of	O
image	O
equivalence	O
is	O
distinct	O
from	O
projective	O
equivalence	O
of	O
the	O
sets	O
of	B
points	I
and	O
camera	B
centres	O
involved	O
.	O
indeed	O
,	O
the	O
relevance	O
of	O
this	O
to	O
reconstruction	O
ambiguity	B
is	O
that	O
if	O
a	O
conﬁguration	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cm	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xn	O
}	O
allows	O
another	O
image-	O
equivalent	B
set	O
which	O
is	O
not	O
projective	B
equivalent	O
,	O
then	O
this	O
amounts	O
to	O
an	O
ambiguity	B
of	O
the	O
projective	B
reconstruction	I
problem	O
,	O
since	O
the	O
projective	B
structure	O
of	O
the	O
points	O
and	O
cameras	B
is	O
not	O
uniquely	O
deﬁned	O
by	O
the	O
set	O
of	O
images	O
.	O
in	O
this	O
case	O
,	O
we	O
say	O
that	O
the	O
conﬁguration	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cm	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xn	O
}	O
allows	O
an	O
alternative	O
reconstruction	B
.	O
22.1.1	O
ambiguity	B
in	O
2d	O
–	O
chasles	O
’	O
theorem	O
before	O
considering	O
the	O
usual	O
3d	O
cameras	B
,	O
we	O
discuss	O
the	O
simpler	O
case	O
of	O
2d	O
cameras	B
.	O
the	O
analysis	O
of	O
the	O
uniqueness	O
of	O
2d	O
camera	B
projections	O
involves	O
planar	O
conics	O
.	O
ambi-	O
guity	O
in	O
determining	O
the	O
camera	B
centre	I
from	O
the	O
projection	B
of	O
a	O
set	O
of	O
known	O
points	O
xi	O
means	O
that	O
the	O
projection	B
of	O
the	O
points	O
is	O
the	O
same	O
from	O
two	O
different	O
camera	B
centres	O
c	O
and	O
c	O
(	O
cid:2	O
)	O
.	O
the	O
question	O
is	O
for	O
what	O
conﬁgurations	O
of	O
the	O
points	O
this	O
may	O
occur	O
.	O
the	O
answer	O
to	O
this	O
question	O
is	O
given	O
by	O
chasles	O
’	O
theorem	O
.	O
536	O
22	O
degenerate	B
conﬁgurations	I
x2	O
x1	O
x3	O
xn	O
c'	O
c	O
fig	O
.	O
22.2.	O
the	O
points	O
x1	O
,	O
.	O
.	O
.	O
,	O
xn	O
project	O
in	O
equivalent	O
ways	O
to	O
the	O
two	O
camera	O
centres	O
c	O
and	O
c	O
(	O
cid:1	O
)	O
.	O
theorem	O
22.3	O
chasles	O
’	O
theorem	O
.	O
let	O
xi	O
be	O
a	O
set	O
of	O
n	O
points	O
and	O
c	O
and	O
c	O
(	O
cid:2	O
)	O
centres	O
,	O
all	O
lying	O
in	O
a	O
plane	B
.	O
then	O
two	O
camera	O
(	O
cid:8	O
)	O
c	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
x	O
n	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
c	O
(	O
cid:2	O
)	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
x	O
n	O
(	O
cid:9	O
)	O
if	O
and	O
only	O
if	O
one	O
of	O
the	O
following	O
conditions	O
holds	O
(	O
i	O
)	O
the	O
points	O
c	O
,	O
c	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
all	O
points	O
lie	O
on	O
the	O
union	O
of	O
two	O
lines	B
(	O
a	O
degenerate	B
conic	O
)	O
,	O
both	O
camera	O
centres	O
and	O
all	O
xi	O
all	O
lie	O
on	O
a	O
non-degenerate	O
conic	B
,	O
or	O
lying	O
on	O
the	O
same	O
line	O
.	O
note	O
that	O
as	O
a	O
simple	O
corollary	O
of	O
this	O
theorem	O
,	O
if	O
c	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
these	O
two	O
conﬁgurations	O
are	O
shown	O
in	O
ﬁgure	O
22.2.	O
is	O
any	O
other	O
camera	B
centre	I
lying	O
on	O
the	O
same	O
component	O
of	O
a	O
conic	O
(	O
degenerate	B
or	O
non-degenerate	O
)	O
as	O
c	O
,	O
c	O
(	O
cid:2	O
)	O
and	O
the	O
xi	O
,	O
then	O
the	O
projection	B
of	O
the	O
points	O
to	O
the	O
centre	B
c	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
is	O
equivalent	B
to	O
their	O
projection	B
to	O
the	O
original	O
camera	B
centres	O
.	O
furthermore	O
,	O
any	O
number	O
of	O
extra	O
points	O
xj	O
may	O
be	O
added	O
without	O
breaking	O
the	O
ambiguity	B
,	O
as	O
long	O
as	O
they	O
lie	O
on	O
the	O
same	O
conic	O
.	O
22.1.2	O
ambiguity	B
for	O
3d	O
cameras	B
we	O
now	O
address	O
the	O
problem	O
of	O
ambiguity	B
of	O
camera	B
resection	O
in	O
the	O
case	O
of	O
full	O
3d	O
cameras	B
.	O
twisted	O
cubics	O
(	O
described	O
in	O
section	O
3.3	O
(	O
p75	O
)	O
)	O
play	O
an	O
analogous	O
role	O
in	O
the	O
3d	O
case	O
to	O
that	O
played	O
by	O
conics	O
in	O
the	O
case	O
of	O
2d	O
cameras	B
.	O
the	O
degenerate	B
form	O
of	O
a	O
twisted	O
cubic	O
consisting	O
of	O
a	O
conic	O
plus	O
a	O
line	B
intersecting	O
the	O
conic	B
arises	O
in	O
this	O
context	O
;	O
so	O
does	O
the	O
degenerate	B
cubic	O
consisting	O
of	O
three	O
lines	B
.	O
as	O
in	O
the	O
2d	O
case	O
,	O
when	O
ambiguity	B
arises	O
from	O
points	O
lying	O
on	O
a	O
degenerate	O
cubic	O
,	O
the	O
camera	B
centres	O
must	O
both	O
lie	O
on	O
the	O
same	O
component	O
.	O
a	O
complete	O
classiﬁcation	B
of	I
the	O
point	O
and	O
camera	O
conﬁgurations	O
leading	O
to	O
ambigu-	O
ous	O
camera	B
resectioning	I
is	O
given	O
in	O
ﬁgure	O
22.3	O
and	O
also	O
in	O
the	O
following	O
deﬁnition	B
.	O
for	O
the	O
present	O
we	O
describe	O
the	O
geometric	B
conﬁgurations	O
.	O
the	O
exact	O
relevance	O
to	O
ambigu-	O
ous	O
camera	B
conﬁgurations	O
will	O
be	O
given	O
afterwards	O
.	O
deﬁnition	B
22.4.	O
a	O
critical	B
set	I
for	O
camera	B
resectioning	I
consists	O
of	O
two	O
parts	O
:	O
(	O
i	O
)	O
an	O
algebraic	B
curve	O
c	O
containing	O
the	O
camera	B
centres	O
,	O
plus	O
any	O
number	O
of	O
the	O
3d	O
22.1	O
camera	B
resectioning	I
537	O
points	O
.	O
this	O
curve	O
may	O
be	O
(	O
a	O
)	O
a	O
non-degenerate	O
twisted	B
cubic	I
(	O
degree	O
3	O
)	O
,	O
(	O
b	O
)	O
a	O
planar	O
conic	O
(	O
degree	O
2	O
)	O
,	O
(	O
c	O
)	O
a	O
straight	O
line	B
(	O
degree	O
1	O
)	O
,	O
or	O
(	O
d	O
)	O
a	O
single	O
point	O
(	O
degree	O
0	O
)	O
.	O
(	O
ii	O
)	O
a	O
union	O
of	O
linear	O
subspaces	O
l	O
(	O
lines	B
or	O
planes	O
)	O
containing	O
any	O
number	O
of	O
3d	O
points	O
.	O
the	O
curve	O
c	O
and	O
the	O
linear	B
subspaces	O
satisfy	O
three	O
conditions	O
:	O
(	O
i	O
)	O
each	O
of	O
the	O
linear	O
subspaces	O
must	O
meet	O
the	O
curve	O
c.	O
(	O
ii	O
)	O
the	O
sum	O
of	O
the	O
degree	O
of	O
the	O
curve	O
c	O
and	O
the	O
dimensions	O
of	O
the	O
linear	O
subspaces	O
(	O
iii	O
)	O
except	O
in	O
the	O
case	O
where	O
c	O
is	O
a	O
single	O
point	O
,	O
the	O
cameras	B
do	O
not	O
lie	O
at	O
the	O
inter-	O
is	O
at	O
most	O
3.	O
section	O
point	B
of	O
c	O
and	O
the	O
linear	B
subspaces	O
.	O
the	O
various	O
possibilities	O
are	O
shown	O
in	O
ﬁgure	O
22.3	O
,	O
and	O
it	O
is	O
easily	O
veriﬁed	O
that	O
these	O
completely	O
enumerate	O
all	O
conﬁgurations	O
in	O
accordance	O
with	O
deﬁnition	O
22.4.	O
result	O
22.5.	O
the	O
different	O
possible	O
critical	O
sets	O
for	B
camera	I
resectioning	I
are	O
:	O
ﬁrst	O
line	B
.	O
(	O
i	O
)	O
a	O
non-degenerate	O
twisted	B
cubic	I
c	O
(	O
degree	O
3	O
)	O
.	O
(	O
ii	O
)	O
a	O
plane	B
conic	O
c	O
(	O
degree	O
2	O
)	O
,	O
plus	O
a	O
line	B
(	O
dimension	O
1	O
)	O
that	O
meets	O
the	O
conic	B
.	O
(	O
iii	O
)	O
a	O
line	B
c	O
(	O
degree	O
1	O
)	O
plus	O
up	O
to	O
two	O
other	O
lines	B
(	O
total	O
dimension	O
2	O
)	O
that	O
meet	O
the	O
(	O
iv	O
)	O
a	O
line	B
c	O
(	O
degree	O
1	O
)	O
,	O
plus	O
a	O
plane	B
(	O
dimension	O
2	O
)	O
.	O
(	O
v	O
)	O
a	O
point	B
c	O
(	O
degree	O
0	O
)	O
and	O
up	O
to	O
three	O
lines	B
passing	O
through	O
the	O
point	B
(	O
total	O
di-	O
(	O
vi	O
)	O
a	O
point	B
c	O
(	O
degree	O
0	O
)	O
and	O
a	O
line	B
and	O
a	O
plane	B
both	O
passing	O
through	O
this	O
point	B
.	O
the	O
exact	O
relationship	O
of	O
these	O
critical	O
sets	O
to	O
ambiguous	O
camera	B
resectioning	I
is	O
mension	O
3	O
)	O
.	O
given	O
by	O
the	O
following	O
result	O
.	O
result	O
22.6.	O
let	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
be	O
two	O
different	O
camera	B
matrices	I
with	O
camera	B
centres	O
c0	O
and	O
c1	O
.	O
then	O
the	O
two	O
camera	O
centres	O
and	O
the	O
points	O
xi	O
that	O
satisfy	O
pxi	O
=	O
p	O
(	O
cid:2	O
)	O
xi	O
all	O
lie	O
on	O
a	O
critical	O
set	O
as	O
given	O
by	O
deﬁnition	B
22.4.	O
furthermore	O
,	O
if	O
pθ	O
=	O
p	O
+	O
θp	O
(	O
cid:2	O
)	O
has	O
rank	O
31	O
,	O
then	O
the	O
camera	B
centre	I
of	O
the	O
camera	B
deﬁned	O
by	O
pθ	O
lies	O
on	O
the	O
component	O
c	O
of	O
the	O
critical	O
set	O
containing	O
the	O
two	O
original	O
camera	B
centres	O
c0	O
and	O
c1	O
,	O
and	O
pθx	O
=	O
px	O
=	O
p	O
(	O
cid:2	O
)	O
x	O
for	O
any	O
point	B
x	O
in	O
the	O
critical	B
set	I
.	O
conversely	O
,	O
let	O
p	O
be	O
a	O
camera	B
matrix	I
with	O
centre	B
c0	O
.	O
let	O
c0	O
and	O
a	O
set	O
of	O
3d	O
points	O
xi	O
lie	O
in	O
a	O
critical	B
set	I
for	O
camera	B
resectioning	I
.	O
let	O
c1	O
be	O
any	O
other	O
point	B
lying	O
on	O
the	O
component	O
c	O
of	O
the	O
critical	O
set	O
,	O
with	O
c1	O
(	O
cid:5	O
)	O
=	O
c0	O
unless	O
c	O
consists	O
of	O
a	O
single	O
point	B
.	O
then	O
there	O
exists	O
a	O
camera	B
matrix	I
p	O
(	O
cid:2	O
)	O
(	O
different	O
from	O
p	O
)	O
with	O
camera	O
centre	B
c1	O
such	O
that	O
pxi	O
=	O
p	O
(	O
cid:2	O
)	O
xi	O
for	O
all	O
points	O
xi	O
.	O
1	O
we	O
include	O
the	O
case	O
p∞	O
=	O
p	O
(	O
cid:1	O
)	O
.	O
538	O
22	O
degenerate	B
conﬁgurations	I
fig	O
.	O
22.3.	O
the	O
different	O
critical	B
conﬁgurations	I
for	O
camera	B
resectioning	I
from	O
a	O
single	B
view	I
.	O
the	O
open	O
circles	O
represent	O
centres	O
of	O
projection	O
and	O
the	O
ﬁlled	O
circles	O
represent	O
points	O
.	O
each	O
case	O
consists	O
of	O
an	O
algebraic	B
curve	O
(	O
or	O
single	O
point	O
)	O
c	O
containing	O
the	O
camera	B
centres	O
,	O
plus	O
a	O
set	O
of	O
linear	O
subspaces	O
(	O
lines	B
or	O
planes	O
)	O
.	O
proof	O
.	O
an	O
outline	O
of	O
the	O
proof	O
will	O
be	O
given	O
,	O
with	O
details	O
left	O
for	O
the	O
reader	O
to	O
ﬁll	O
in	O
.	O
we	O
temporarily	O
need	O
to	O
distinguish	O
between	O
equality	O
of	O
homogeneous	O
quantities	O
up	O
to	O
a	O
scale	O
factor	O
(	O
which	O
will	O
be	O
denoted	O
by	O
≈	O
)	O
and	O
absolute	O
equality	O
(	O
which	O
is	O
denoted	O
by	O
=	O
)	O
.	O
suppose	O
that	O
x	O
maps	O
to	O
the	O
same	O
image	O
point	B
with	O
respect	O
to	O
cameras	O
p	O
and	O
.	O
one	O
can	O
write	O
px	O
≈	O
p	O
(	O
cid:2	O
)	O
x.	O
taking	O
account	O
of	O
the	O
scale	O
factor	O
,	O
this	O
can	O
be	O
written	O
p	O
(	O
cid:2	O
)	O
as	O
px	O
=	O
−θp	O
(	O
cid:2	O
)	O
x	O
for	O
some	O
constant	O
θ.	O
from	O
this	O
it	O
follows	O
that	O
(	O
p	O
+	O
θp	O
(	O
cid:2	O
)	O
)	O
x	O
=	O
0	O
.	O
)	O
x	O
=	O
0.	O
for	O
some	O
θ.	O
it	O
follows	O
that	O
px	O
=	O
−θp	O
(	O
cid:2	O
)	O
x	O
,	O
conversely	O
,	O
suppose	O
that	O
(	O
p	O
+	O
θp	O
(	O
cid:2	O
)	O
and	O
so	O
px	O
≈	O
p	O
(	O
cid:2	O
)	O
x.	O
thus	O
,	O
the	O
critical	B
set	I
is	O
the	O
set	O
of	B
points	I
x	O
in	O
the	O
right	O
null-space	B
of	O
p	O
+	O
θp	O
(	O
cid:2	O
)	O
deﬁne	O
pθ	O
=	O
p	O
+	O
θp	O
(	O
cid:2	O
)	O
.	O
the	O
rest	O
of	O
the	O
proof	O
involves	O
ﬁnding	O
the	O
set	O
of	O
all	O
points	O
x	O
satisfying	O
pθx	O
=	O
0	O
as	O
θ	O
runs	O
over	O
all	O
values	O
.	O
if	O
pθ	O
is	O
a	O
camera	B
matrix	I
(	O
has	O
rank	O
3	O
)	O
then	O
such	O
an	O
x	O
is	O
the	O
centre	B
of	O
the	O
camera	B
pθ	O
.	O
if	O
however	O
pθ	O
is	O
rank-deﬁcient	O
for	O
some	O
value	O
x	O
=	O
0	O
is	O
a	O
linear	B
space	O
.	O
the	O
total	O
critical	O
set	O
of	O
θi	O
,	O
then	O
the	O
set	O
of	B
points	I
x	O
such	O
that	O
pθi	O
therefore	O
consists	O
of	O
two	O
parts	O
:	O
for	O
some	O
θ	O
.	O
22.2	O
degeneracies	B
in	O
two	B
views	I
539	O
(	O
i	O
)	O
the	O
locus	O
of	O
the	O
camera	O
centre	B
of	O
pθ	O
over	O
all	O
values	O
θ	O
for	O
which	O
pθ	O
has	O
full	O
rank	O
(	O
that	O
is	O
rank	O
3	O
)	O
.	O
this	O
is	O
a	O
curve	O
c	O
containing	O
the	O
two	O
camera	O
centres	O
c0	O
and	O
c1	O
.	O
(	O
ii	O
)	O
a	O
linear	B
space	O
(	O
line	B
or	O
plane	B
)	O
corresponding	O
to	O
each	O
value	O
of	O
θ	O
for	O
which	O
pθ	O
has	O
rank	O
2	O
or	O
less	O
.	O
if	O
pθ	O
has	O
rank	O
2	O
,	O
the	O
points	O
such	O
that	O
pθx	O
=	O
0	O
form	O
a	O
line	B
,	O
and	O
if	O
it	O
has	O
rank	O
1	O
,	O
then	O
they	O
form	O
a	O
plane	B
.	O
θ	O
θ	O
is	O
the	O
matrix	B
pθ	O
with	O
the	O
i-th	O
column	O
removed	O
.	O
since	O
each	O
p	O
(	O
i	O
)	O
θ	O
let	O
the	O
4-vector	O
cθ	O
be	O
deﬁned	O
by	O
cθ	O
=	O
(	O
c1	O
,	O
c2	O
,	O
c3	O
,	O
c4	O
)	O
t	O
,	O
where	O
ci	O
=	O
(	O
−1	O
)	O
i	O
det	O
p	O
(	O
i	O
)	O
is	O
a	O
3	O
×	O
3	O
and	O
p	O
(	O
i	O
)	O
matrix	B
,	O
and	O
the	O
entries	O
of	O
pθ	O
are	O
linear	B
in	O
θ	O
,	O
we	O
see	O
that	O
each	O
ci	O
=	O
(	O
−1	O
)	O
i	O
det	O
p	O
(	O
i	O
)	O
θ	O
is	O
a	O
cubic	O
polynomial	O
in	O
θ.	O
according	O
to	O
the	O
discussion	O
following	O
deﬁnition	B
21.10	O
(	O
p521	O
)	O
,	O
pθcθ	O
=	O
0	O
,	O
hence	O
if	O
cθ	O
(	O
cid:5	O
)	O
=	O
0	O
then	O
it	O
is	O
the	O
camera	B
centre	I
of	O
pθ	O
,	O
and	O
as	O
θ	O
varies	O
the	O
point	B
cθ	O
traces	O
out	O
the	O
curve	O
c.	O
since	O
the	O
coordinates	B
of	O
cθ	O
are	O
cubic	O
polynomials	O
,	O
this	O
is	O
in	O
general	O
a	O
twisted	B
cubic	I
.	O
if	O
however	O
the	O
four	O
components	O
of	O
cθ	O
have	O
a	O
simultaneous	O
root	O
θi	O
,	O
then	O
the	O
degree	O
of	O
the	O
curve	O
cθ	O
is	O
diminished	O
.	O
in	O
this	O
case	O
pθi	O
is	O
rank-deﬁcient	O
,	O
x	O
=	O
0.	O
thus	O
the	O
linear	B
subspace	O
and	O
there	O
exists	O
a	O
linear	B
space	O
of	B
points	I
x	O
such	O
that	O
pθi	O
components	O
of	O
the	O
critical	O
set	O
correspond	O
to	O
values	O
of	O
θ	O
where	O
cθ	O
vanishes	O
.	O
clearly	O
there	O
can	O
be	O
at	O
most	O
three	O
such	O
values	O
.	O
further	O
details	O
are	O
left	O
to	O
the	O
reader	O
.	O
the	O
last	O
part	O
of	O
the	O
theorem	O
provides	O
a	O
converse	O
result	O
–	O
namely	O
that	O
if	O
the	O
points	O
and	O
one	O
camera	B
centre	I
lie	O
in	O
a	O
critical	O
conﬁguration	O
,	O
then	O
there	O
exist	O
alternative	O
resection	B
solutions	O
with	O
the	O
camera	B
placed	O
at	O
any	O
location	O
in	O
c.	O
the	O
exact	O
form	B
of	I
the	O
camera	B
matrix	I
p	O
is	O
not	O
important	O
here	O
,	O
only	O
its	O
camera	B
centre	I
,	O
as	O
has	O
been	O
observed	O
above	O
.	O
for	O
most	O
of	O
the	O
conﬁgurations	O
in	O
ﬁgure	O
22.3	O
it	O
is	O
clear	O
enough	O
geometrically	O
that	O
the	O
image	O
of	O
the	O
critical	O
set	O
is	O
unchanged	O
(	O
up	O
to	O
projectivity	O
)	O
by	O
moving	B
the	O
camera	B
along	O
the	O
locus	O
c.	O
in	O
the	O
case	O
where	O
c	O
is	O
a	O
planar	O
conic	O
,	O
this	O
follows	O
fairly	O
easily	O
from	O
the	O
1d	O
camera	B
case	O
(	O
theorem	O
22.3	O
)	O
.	O
the	O
exception	O
is	O
the	O
twisted	B
cubic	I
case	O
.	O
it	O
is	O
illustrated	O
graphically	O
in	O
ﬁgure	O
22.4.	O
we	O
leave	O
this	O
proof	O
for	O
now	O
,	O
and	O
come	O
back	O
to	O
it	O
later	O
(	O
result	O
22.25	O
(	O
p551	O
)	O
)	O
.	O
22.2	O
degeneracies	B
in	O
two	B
views	I
notation	O
.	O
for	O
the	O
rest	O
of	O
this	O
chapter	O
,	O
the	O
camera	B
matrices	I
are	O
represented	O
by	O
p	O
and	O
q	O
,	O
3d	O
points	O
by	O
p	O
and	O
q.	O
thus	O
cameras	B
and	O
3d	O
points	O
are	O
distinguished	O
only	O
by	O
their	O
type-	O
face	O
.	O
this	O
may	O
appear	O
to	O
be	O
a	O
little	O
confusing	O
,	O
but	O
the	O
alternative	O
of	O
using	O
subscripts	O
or	O
primes	O
proved	O
to	O
be	O
much	O
more	O
confusing	O
.	O
in	O
the	O
context	O
of	O
ambiguous	O
reconstructions	O
from	O
image	O
coordinates	B
we	O
distinguish	O
the	O
two	O
reconstructions	O
by	O
using	O
p	O
and	O
p	O
for	O
one	O
,	O
and	O
q	O
and	O
q	O
for	O
the	O
other	O
.	O
now	O
we	O
turn	O
to	O
the	O
case	O
of	O
two	O
views	O
of	O
an	O
object	O
.	O
given	O
sufﬁciently	O
many	O
points	O
placed	O
in	O
“	O
general	B
position	I
”	O
one	O
may	O
determine	O
the	O
placement	O
of	O
the	O
two	O
cameras	B
,	O
and	O
reconstruct	O
the	O
point	B
set	O
up	O
to	O
a	O
projective	B
transformation	I
.	O
this	O
may	O
be	O
done	O
using	O
one	O
of	O
the	O
projective	O
reconstruction	B
algorithms	O
discussed	O
in	O
chapter	O
10.	O
we	O
now	O
wish	O
to	O
determine	O
under	O
what	O
conditions	O
this	O
technique	O
may	O
fail	O
.	O
thus	O
,	O
we	O
consider	O
a	O
set	O
of	O
image	O
correspondences	B
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
set	O
of	O
correspondences	O
consists	O
of	O
a	O
pair	O
of	B
camera	I
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
points	O
pi	O
such	O
that	O
xi	O
=	O
ppi	O
and	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
p	O
(	O
cid:2	O
)	O
pi	O
for	O
all	O
i.	O
two	O
realizations	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
i.	O
a	O
realization	B
of	O
this	O
and	O
a	O
set	O
of	O
3d	O
,	O
pi	O
}	O
540	O
22	O
degenerate	B
conﬁgurations	I
fig	O
.	O
22.4.	O
separate	O
views	O
of	O
a	O
set	O
of	B
points	I
on	O
the	O
twisted	B
cubic	I
(	O
t3	O
,	O
t2	O
,	O
t,1	O
)	O
t	O
as	O
viewed	O
from	O
a	O
centre	B
of	O
projection	B
.	O
the	O
visible	O
points	O
are	O
viewed	O
from	O
the	O
points	O
with	O
t	O
=	O
3	O
,	O
4	O
,	O
5	O
,	O
10	O
,	O
50	O
,	O
1000	O
with	O
the	O
image	O
suitably	O
magniﬁed	O
to	O
prevent	O
the	O
point	B
set	O
from	O
becoming	O
too	O
small	O
.	O
as	O
is	O
plausible	O
from	O
the	O
image	O
,	O
the	O
sets	O
of	B
points	I
differ	O
by	O
a	O
projective	B
transformation	I
.	O
from	O
a	O
viewpoint	O
on	O
a	O
twisted	O
cubic	O
,	O
the	O
twisted	B
cubic	I
has	O
the	O
appearance	O
of	O
a	O
conic	O
,	O
in	O
this	O
particular	O
case	O
a	O
parabola	O
.	O
and	O
{	O
q	O
,	O
q	O
(	O
cid:2	O
)	O
represented	O
by	O
a	O
matrix	B
h	O
such	O
that	O
q	O
=	O
ph−1	O
,	O
q	O
(	O
cid:2	O
)	O
,	O
qi	O
}	O
are	O
projectively	O
equivalent	B
if	O
there	O
is	O
a	O
3d	O
projective	B
transformation	I
,	O
=	O
p	O
(	O
cid:2	O
)	O
h−1	O
,	O
and	O
qi	O
=	O
hpi	O
for	O
all	O
i.	O
because	O
of	O
a	O
technicality	O
,	O
this	O
deﬁnition	B
of	O
equivalence	O
is	O
not	O
quite	O
appropriate	O
to	O
the	O
present	O
discussion	O
.	O
recall	O
from	O
the	O
projective	B
reconstruction	I
theorem	O
,	O
theorem	O
10.1-	O
(	O
p266	O
)	O
,	O
that	O
one	O
can	O
not	O
determine	O
the	O
position	O
of	O
a	O
point	O
lying	O
on	O
the	O
line	B
joining	O
the	O
two	O
camera	O
centres	O
.	O
hence	O
,	O
non-projectively-equivalent	O
reconstructions	O
will	O
always	O
exist	O
if	O
some	O
points	O
lie	O
on	O
the	O
line	B
of	O
camera	B
centres	O
,	O
the	O
two	O
reconstructions	O
differing	O
only	O
by	O
the	O
position	O
of	O
the	O
points	O
pi	O
and	O
qi	O
on	O
this	O
line	B
.	O
this	O
type	O
of	O
reconstruction	O
ambiguity	B
is	O
not	O
of	O
great	O
interest	O
,	O
and	O
so	O
we	O
will	O
modify	O
the	O
notion	O
of	O
equivalence	O
by	O
deﬁning	O
two	O
reconstructions	O
to	O
be	O
equivalent	B
if	O
h	O
exists	O
such	O
that	O
q	O
=	O
ph−1	O
and	O
q	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
h−1	O
.	O
as	O
in	O
the	O
proof	O
of	O
the	O
projective	O
reconstruction	B
theorem	O
,	O
such	O
an	O
h	O
will	O
also	O
map	O
qi	O
to	O
pi	O
,	O
except	O
possibly	O
for	O
reconstructed	O
points	O
qi	O
lying	O
on	O
the	O
line	B
of	O
the	O
camera	B
centres	O
.	O
according	O
to	O
theorem	O
9.10	O
(	O
p254	O
)	O
,	O
this	O
condition	O
is	O
also	O
equivalent	B
to	O
the	O
condition	O
that	O
fp	O
(	O
cid:1	O
)	O
p	O
=	O
fq	O
(	O
cid:1	O
)	O
q	O
,	O
where	O
fp	O
(	O
cid:1	O
)	O
p	O
and	O
fq	O
(	O
cid:1	O
)	O
q	O
are	O
the	O
fundamental	O
matrices	O
corre-	O
sponding	O
to	O
the	O
camera	B
pairs	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
.	O
accordingly	O
,	O
we	O
make	O
the	O
following	O
deﬁnition	B
.	O
deﬁnition	B
22.7.	O
two	O
conﬁgurations	O
of	O
cameras	O
and	O
points	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
are	O
said	O
to	O
be	O
conjugate	O
conﬁgurations	O
provided	O
,	O
pi	O
}	O
and	O
{	O
q	O
,	O
q	O
(	O
cid:2	O
)	O
)	O
and	O
(	O
q	O
,	O
q	O
(	O
cid:2	O
)	O
,	O
qi	O
}	O
(	O
i	O
)	O
ppi	O
=	O
qqi	O
and	O
p	O
(	O
cid:2	O
)	O
pi	O
=	O
q	O
(	O
cid:2	O
)	O
qi	O
for	O
all	O
i	O
.	O
(	O
ii	O
)	O
the	O
fundamental	O
matrices	O
fq	O
(	O
cid:1	O
)	O
q	O
and	O
fq	O
(	O
cid:1	O
)	O
q	O
corresponding	O
to	O
the	O
two	O
camera	O
matrix	B
pairs	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
and	O
(	O
q	O
,	O
q	O
(	O
cid:2	O
)	O
)	O
are	O
different	O
.	O
a	O
conﬁguration	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
,	O
pi	O
}	O
that	O
allows	O
a	O
conjugate	O
conﬁguration	O
is	O
called	O
critical	O
.	O
an	O
important	O
remark	O
is	O
that	O
being	O
a	O
critical	O
conﬁguration	O
depends	O
only	O
on	O
the	O
camera	B
22.2	O
degeneracies	B
in	O
two	B
views	I
541	O
respectively	O
,	O
then	O
{	O
ˆp	O
,	O
ˆp	O
(	O
cid:2	O
)	O
,	O
pi	O
}	O
is	O
a	O
critical	O
conﬁguration	O
and	O
ˆp	O
and	O
ˆp	O
centres	O
and	O
the	O
points	O
,	O
and	O
not	O
on	O
the	O
particular	O
cameras	B
.	O
result	O
22.8.	O
if	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
the	O
same	O
centres	O
as	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
well	O
.	O
proof	O
.	O
this	O
is	O
easily	O
seen	O
as	O
follows	O
.	O
since	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
,	O
pi	O
}	O
is	O
a	O
critical	O
conﬁguration	O
there	O
exists	O
an	O
alternative	O
conﬁguration	O
{	O
q	O
,	O
q	O
(	O
cid:2	O
)	O
,	O
qi	O
}	O
such	O
that	O
ppi	O
=	O
qqi	O
and	O
p	O
(	O
cid:2	O
)	O
pi	O
=	O
q	O
(	O
cid:2	O
)	O
qi	O
for	O
all	O
i.	O
however	O
,	O
since	O
p	O
and	O
ˆp	O
have	O
the	O
same	O
camera	O
centre	O
,	O
ˆp	O
=	O
hp	O
according	O
to	O
result	O
22.1	O
and	O
similarly	O
ˆp	O
are	O
two	O
cameras	O
with	O
,	O
pi	O
}	O
is	O
a	O
critical	O
conﬁguration	O
as	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
therefore	O
=	O
h	O
(	O
cid:2	O
)	O
p	O
(	O
cid:2	O
)	O
ˆppi	O
=	O
hppi	O
=	O
hqqi	O
and	O
(	O
cid:2	O
)	O
pi	O
=	O
h	O
(	O
cid:2	O
)	O
p	O
(	O
cid:2	O
)	O
pi	O
=	O
h	O
(	O
cid:2	O
)	O
q	O
(	O
cid:2	O
)	O
qi	O
.	O
ˆp	O
it	O
follows	O
that	O
{	O
hq	O
,	O
h	O
(	O
cid:2	O
)	O
q	O
(	O
cid:2	O
)	O
fore	O
critical	O
.	O
(	O
cid:2	O
)	O
,	O
qi	O
}	O
is	O
an	O
alternative	O
conﬁguration	O
to	O
{	O
ˆp	O
,	O
ˆp	O
,	O
pi	O
}	O
,	O
which	O
is	O
there-	O
the	O
goal	O
of	O
this	O
section	O
is	O
to	O
determine	O
under	O
what	O
conditions	O
non-equivalent	B
re-	O
alizations	O
of	O
a	O
set	O
of	O
point	O
correspondences	B
may	O
occur	O
.	O
this	O
question	O
is	O
completely	O
resolved	O
by	O
the	O
following	O
theorem	O
,	O
which	O
will	O
be	O
proved	O
incrementally	O
.	O
,	O
ri	O
}	O
.	O
(	O
i	O
)	O
conjugate	O
conﬁgurations	O
of	O
cameras	B
and	O
points	O
generically	O
,	O
pi	O
}	O
has	O
two	O
conjugates	O
,	O
qi	O
}	O
and	O
{	O
r	O
,	O
r	O
(	O
cid:2	O
)	O
,	O
pi	O
}	O
is	O
a	O
critical	O
conﬁguration	O
,	O
then	O
all	O
the	O
points	O
pi	O
and	O
the	O
two	O
cam-	O
theorem	O
22.9.	O
come	O
in	O
triples	O
.	O
thus	O
a	O
critical	O
conﬁguration	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
{	O
q	O
,	O
q	O
(	O
cid:2	O
)	O
(	O
ii	O
)	O
if	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
(	O
iii	O
)	O
conversely	O
,	O
suppose	O
that	O
the	O
camera	B
centres	O
of	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
and	O
a	O
set	O
of	O
3d	O
points	O
pi	O
lie	O
on	O
a	O
ruled	O
quadric	O
(	O
excluding	O
the	O
quadrics	B
(	O
v	O
)	O
and	O
(	O
viii	O
)	O
in	O
result	O
22.11	O
)	O
,	O
then	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
era	O
centres	O
cp	O
and	O
cp	O
(	O
cid:1	O
)	O
lie	O
on	O
a	O
ruled	O
quadric	O
surface	O
sp	O
.	O
,	O
pi	O
}	O
is	O
a	O
critical	O
conﬁguration	O
.	O
by	O
the	O
words	O
“	O
ruled	B
quadric	O
”	O
in	O
this	O
context	O
is	O
meant	O
any	O
quadric	O
surface	O
that	O
con-	O
tains	O
a	O
straight	O
line	B
.	O
this	O
includes	O
various	O
degenerate	B
quadrics	O
,	O
as	O
will	O
be	O
seen	O
.	O
a	O
gen-	O
eral	O
discussion	O
and	O
classiﬁcation	B
of	I
quadric	O
surfaces	O
has	O
been	O
given	O
in	O
section	O
3.2.4-	O
(	O
p74	O
)	O
.	O
a	O
quadric	O
is	O
usually	O
deﬁned	O
to	O
be	O
the	O
set	O
of	B
points	I
x	O
such	O
that	O
xtsx	O
=	O
0	O
,	O
where	O
s	O
is	O
a	O
symmetric	B
4	O
×	O
4	O
matrix	B
.	O
however	O
,	O
if	O
s	O
is	O
any	O
4	O
×	O
4	O
matrix	B
,	O
not	O
neces-	O
sarily	O
symmetric	B
,	O
then	O
one	O
sees	O
that	O
for	O
any	O
point	B
x	O
,	O
one	O
has	O
xtsx	O
=	O
(	O
xtssymx	O
)	O
,	O
where	O
ssym	O
=	O
(	O
s	O
+	O
st	O
)	O
/2	O
is	O
the	O
symmetric	B
part	I
of	O
s.	O
thus	O
,	O
xtsx	O
=	O
0	O
if	O
and	O
only	O
if	O
xtssymx	O
=	O
0	O
,	O
and	O
so	O
s	O
deﬁnes	O
the	O
same	O
quadric	O
surface	O
as	O
ssym	O
.	O
in	O
investigating	O
reconstruction	B
ambiguity	O
,	O
it	O
will	O
often	O
be	O
convenient	O
to	O
use	O
non-symmetric	O
matrices	O
s	O
to	O
represent	O
quadrics	B
.	O
proof	O
.	O
we	O
begin	O
by	O
proving	O
the	O
ﬁrst	O
part	O
of	O
the	O
theorem	O
.	O
let	O
f	O
and	O
f	O
(	O
cid:2	O
)	O
be	O
two	O
distinct	O
fundamental	O
matrices	O
satisfying	O
the	O
relation	B
x	O
(	O
cid:2	O
)	O
f	O
(	O
cid:2	O
)	O
xi	O
=	O
0	O
for	O
all	O
correspon-	O
dences	O
x	O
(	O
cid:2	O
)	O
tfθxi	O
=	O
0.	O
however	O
,	O
fθ	O
is	O
a	O
fundamental	B
matrix	I
only	O
if	O
det	O
fθ	O
=	O
0.	O
now	O
,	O
det	O
f	O
(	O
θ	O
)	O
is	O
generally	O
a	O
polynomial	O
of	O
degree	O
3	O
in	O
θ.	O
this	O
polynomial	O
has	O
roots	O
θ	O
=	O
0	O
and	O
θ	O
=	O
1	O
corresponding	O
to	O
f	O
and	O
↔	O
xi	O
.	O
deﬁne	O
fθ	O
=	O
f	O
+	O
θf	O
(	O
cid:2	O
)	O
.	O
one	O
easily	O
veriﬁes	O
that	O
x	O
(	O
cid:2	O
)	O
tfxi	O
=	O
x	O
(	O
cid:2	O
)	O
i	O
i	O
i	O
i	O
22	O
degenerate	B
conﬁgurations	I
542	O
f	O
(	O
cid:2	O
)	O
respectively	O
.	O
the	O
third	O
root	O
corresponds	O
to	O
a	O
third	O
fundamental	B
matrix	I
,	O
and	O
hence	O
a	O
third	O
non-equivalent	B
reconstruction	O
.	O
in	O
special	O
cases	O
,	O
det	O
f	O
(	O
θ	O
)	O
has	O
degree	O
2	O
in	O
θ	O
and	O
there	O
are	O
only	O
two	O
conjugate	O
conﬁgurations	O
.	O
the	O
second	O
part	O
of	O
the	O
theorem	O
is	O
concluded	O
by	O
proving	O
the	O
following	O
lemma	O
.	O
lemma	O
22.10.	O
consider	O
two	O
pairs	O
of	O
cameras	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
,	O
with	O
corresponding	O
different	O
fundamental	O
matrices	O
fp	O
(	O
cid:1	O
)	O
p	O
and	O
fq	O
(	O
cid:1	O
)	O
q.	O
deﬁne	O
quadrics	B
sp	O
=	O
p	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qp	O
,	O
and	O
sq	O
=	O
q	O
(	O
cid:2	O
)	O
tfp	O
(	O
cid:1	O
)	O
pq.	O
)	O
and	O
(	O
q	O
,	O
q	O
(	O
cid:2	O
)	O
(	O
i	O
)	O
the	O
quadric	O
sp	O
contains	O
the	O
camera	B
centres	O
of	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
the	O
camera	B
centres	O
of	O
q	O
and	O
q	O
(	O
cid:2	O
)	O
.	O
.	O
similarly	O
,	O
sq	O
contains	O
(	O
ii	O
)	O
sp	O
is	O
a	O
ruled	B
quadric	O
.	O
(	O
iii	O
)	O
if	O
p	O
and	O
q	O
are	O
3d	O
points	O
such	O
that	O
pp	O
=	O
qq	O
and	O
p	O
(	O
cid:2	O
)	O
p	O
=	O
q	O
(	O
cid:2	O
)	O
q	O
,	O
then	O
p	O
lies	O
on	O
the	O
(	O
iv	O
)	O
conversely	O
,	O
if	O
p	O
is	O
a	O
point	B
lying	O
on	O
the	O
quadric	O
sp	O
,	O
then	O
there	O
exists	O
a	O
point	B
q	O
quadric	O
sp	O
,	O
and	O
q	O
lies	O
on	O
sq	O
.	O
lying	O
on	O
sq	O
such	O
that	O
pp	O
=	O
qq	O
and	O
p	O
(	O
cid:2	O
)	O
p	O
=	O
q	O
(	O
cid:2	O
)	O
q.	O
proof	O
.	O
recall	O
that	O
according	O
to	O
result	O
9.12	O
(	O
p255	O
)	O
the	O
matrix	B
f	O
is	O
the	O
fundamen-	O
tal	O
matrix	B
corresponding	O
to	O
a	O
pair	O
of	O
cameras	O
(	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
)	O
if	O
and	O
only	O
if	O
p	O
(	O
cid:2	O
)	O
tfp	O
is	O
skew-	O
symmetric	B
.	O
since	O
fp	O
(	O
cid:1	O
)	O
p	O
(	O
cid:5	O
)	O
=	O
fq	O
(	O
cid:1	O
)	O
q	O
,	O
however	O
,	O
the	O
matrices	O
sp	O
and	O
sq	O
deﬁned	O
here	O
are	O
not	O
skew-symmetric	O
,	O
and	O
hence	O
represent	O
non-trivial	O
quadrics	B
.	O
we	O
adopt	O
a	O
convention	O
that	O
a	O
camera	B
represented	O
by	O
a	O
matrix	B
such	O
as	O
p	O
or	O
p	O
(	O
cid:2	O
)	O
centre	B
denoted	O
by	O
cp	O
or	O
cp	O
(	O
cid:1	O
)	O
.	O
has	O
camera	B
(	O
i	O
)	O
the	O
camera	B
centre	I
of	O
p	O
satisﬁes	O
pcp	O
=	O
0.	O
then	O
p	O
(	O
p	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qp	O
)	O
cp	O
=	O
ct	O
p	O
spcp	O
=	O
ct	O
ct	O
p	O
(	O
p	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
q	O
)	O
pcp	O
=	O
0	O
since	O
pcp	O
=	O
0.	O
so	O
,	O
cp	O
lies	O
on	O
the	O
quadric	O
sp	O
.	O
in	O
a	O
similar	O
manner	O
,	O
cp	O
(	O
cid:1	O
)	O
lies	O
on	O
sp	O
.	O
(	O
ii	O
)	O
let	O
eq	O
be	O
the	O
epipole	O
deﬁned	O
by	O
fq	O
(	O
cid:1	O
)	O
qeq	O
=	O
0	O
,	O
and	O
consider	O
the	O
ray	O
passing	O
through	O
cp	O
consisting	O
of	O
all	O
points	O
such	O
that	O
eq	O
=	O
px	O
.	O
then	O
for	O
any	O
such	O
point	B
,	O
one	O
veriﬁes	O
that	O
spx	O
=	O
p	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qpx	O
=	O
p	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qeq	O
=	O
0.	O
thus	O
the	O
ray	O
lies	O
on	O
sp	O
and	O
so	O
sp	O
is	O
a	O
ruled	B
quadric	O
.	O
(	O
iii	O
)	O
under	O
the	O
given	O
conditions	O
one	O
sees	O
that	O
ptspp	O
=	O
ptp	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qpp	O
=	O
qt	O
(	O
q	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qq	O
)	O
q	O
=	O
0	O
(	O
iv	O
)	O
let	O
p	O
lie	O
on	O
sp	O
and	O
deﬁne	O
x	O
=	O
pp	O
and	O
x	O
(	O
cid:2	O
)	O
since	O
q	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qq	O
is	O
skew-symmetric	O
.	O
thus	O
,	O
p	O
lies	O
on	O
the	O
quadric	O
sp	O
.	O
by	O
a	O
similar	O
argument	O
,	O
q	O
lies	O
on	O
sq	O
.	O
=	O
p	O
(	O
cid:2	O
)	O
p.	O
then	O
,	O
from	O
ptspp	O
=	O
0	O
we	O
deduce	O
0	O
=	O
ptp	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qpp	O
=	O
x	O
(	O
cid:2	O
)	O
tfq	O
(	O
cid:1	O
)	O
qx	O
,	O
and	O
so	O
x	O
↔	O
x	O
(	O
cid:2	O
)	O
are	O
a	O
corresponding	O
pair	O
of	B
points	I
with	O
respect	O
to	O
fq	O
(	O
cid:1	O
)	O
q.	O
therefore	O
,	O
there	O
exists	O
a	O
point	B
q	O
such	O
that	O
qq	O
=	O
x	O
=	O
pp	O
,	O
and	O
q	O
(	O
cid:2	O
)	O
q	O
=	O
x	O
(	O
cid:2	O
)	O
=	O
p	O
(	O
cid:2	O
)	O
p.	O
from	O
part	O
(	O
iii	O
)	O
of	O
this	O
lemma	O
,	O
q	O
must	O
lie	O
on	O
sq	O
.	O
22.2	O
degeneracies	B
in	O
two	B
views	I
543	O
this	O
lemma	O
completely	O
describes	O
the	O
sets	O
of	O
3d	O
points	O
giving	O
rise	O
to	O
ambiguous	O
image	O
correspondences	O
.	O
note	O
that	O
any	O
two	O
arbitrarily	O
chosen	O
camera	B
pairs	O
can	O
give	O
rise	O
to	O
ambiguous	O
image	O
correspondences	O
,	O
provided	O
that	O
the	O
world	O
points	O
lie	O
on	O
the	O
given	O
quadrics	B
.	O
22.2.1	O
examples	B
of	O
ambiguity	B
at	O
this	O
point	B
it	O
remains	O
to	O
prove	O
the	O
converse	O
of	O
theorem	O
22.9.	O
this	O
needs	O
to	O
be	O
done	O
for	O
all	O
types	O
of	O
ruled	O
quadrics	B
and	O
any	O
placement	O
of	O
the	O
two	O
camera	B
centres	O
on	O
the	O
quadric	O
.	O
the	O
different	O
types	O
of	O
ruled	O
quadrics	B
,	O
including	O
degenerate	B
cases	O
,	O
are	O
(	O
see	O
section	O
3.2.4	O
(	O
p74	O
)	O
)	O
:	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
;	O
a	O
cone	O
;	O
two	O
(	O
intersecting	O
)	O
planes	O
;	O
a	O
single	O
plane	O
;	O
a	O
single	O
line	O
.	O
a	O
complete	O
enumeration	O
of	O
the	O
types	O
of	O
placement	O
of	O
two	O
camera	B
centres	O
on	O
a	O
ruled	O
quadric	O
is	O
given	O
in	O
the	O
following	O
result	O
.	O
result	O
22.11.	O
the	O
possible	O
conﬁgurations	O
of	O
two	O
distinct	O
points	O
(	O
particularly	O
camera	B
centres	O
)	O
on	O
a	O
ruled	O
quadric	O
surface	O
are	O
as	O
enumerated	O
:	O
(	O
i	O
)	O
hyperboloid	B
of	O
one	O
sheet	O
,	O
two	O
points	O
not	O
on	O
the	O
same	O
generator	O
(	O
ii	O
)	O
hyperboloid	B
of	O
one	O
sheet	O
,	O
two	O
points	O
on	O
the	O
same	O
generator	O
(	O
iii	O
)	O
cone	O
,	O
one	O
point	B
at	O
the	O
vertex	O
and	O
one	O
not	O
(	O
iv	O
)	O
cone	O
,	O
two	O
points	O
on	O
different	O
generators	O
,	O
neither	O
one	O
at	O
the	O
vertex	O
(	O
v	O
)	O
cone	O
,	O
two	O
points	O
on	O
the	O
same	O
generator	O
,	O
neither	O
one	O
at	O
the	O
vertex	O
(	O
vi	O
)	O
pair	O
of	O
planes	O
,	O
two	O
points	O
on	O
the	O
intersection	B
of	O
the	O
two	O
planes	O
(	O
vii	O
)	O
pair	O
of	O
planes	O
,	O
one	O
point	B
at	O
the	O
intersection	B
and	O
one	O
not	O
(	O
viii	O
)	O
pair	O
of	O
planes	O
,	O
neither	O
point	B
at	O
the	O
intersection	B
,	O
but	O
points	O
on	O
different	O
planes	O
(	O
ix	O
)	O
pair	O
of	O
planes	O
,	O
neither	O
point	B
on	O
the	O
intersection	B
,	O
both	O
points	O
on	O
the	O
same	O
plane	O
(	O
x	O
)	O
single	O
plane	O
with	O
two	O
points	O
(	O
xi	O
)	O
single	O
line	O
with	O
two	O
points	O
any	O
two	O
quadric/point-pairs	O
in	O
the	O
same	O
class	O
are	O
projectively	O
equivalent	B
.	O
it	O
is	O
clear	O
by	O
enumeration	O
of	O
cases	O
that	O
this	O
list	O
is	O
complete	O
.	O
the	O
only	O
case	O
in	O
which	O
it	O
is	O
not	O
immediately	O
obvious	O
that	O
any	O
two	O
conﬁgurations	O
in	O
the	O
same	O
category	O
are	O
projectively	O
equivalent	B
is	O
in	O
the	O
non-degenerate	O
case	O
of	O
the	O
hyperboloid	O
of	O
one	O
sheet	O
.	O
the	O
proof	O
of	O
this	O
fact	O
is	O
left	O
as	O
exercise	O
(	O
i	O
)	O
at	O
the	O
end	O
of	O
the	O
chapter	O
(	O
page	O
559	O
)	O
.	O
now	O
,	O
consider	O
an	O
example	O
of	O
a	O
critical	O
conﬁguration	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
on	O
a	O
quadric	O
sp	O
also	O
containing	O
the	O
two	O
camera	O
centres	O
.	O
the	O
quadric	O
and	O
two	O
camera	O
centres	O
belong	O
to	O
one	O
of	O
the	O
categories	O
given	O
in	O
result	O
22.11	O
.	O
(	O
cid:2	O
)	O
,	O
(	O
cid:23	O
)	O
pi	O
}	O
in	O
which	O
all	O
pi	O
lie	O
)	O
and	O
a	O
set	O
of	B
points	I
(	O
cid:23	O
)	O
pi	O
lie	O
on	O
a	O
quadric	O
,	O
(	O
cid:23	O
)	O
pi	O
}	O
is	O
a	O
critical	O
conﬁguration	O
,	O
let	O
the	O
centres	O
of	O
two	O
new	O
cameras	B
(	O
ˆp	O
,	O
ˆp	O
.	O
since	O
the	O
points	O
(	O
cid:23	O
)	O
pi	O
lie	O
on	O
sp	O
,	O
it	O
follows	O
that	O
{	O
p	O
,	O
p	O
(	O
cid:2	O
)	O
ˆsp	O
.	O
suppose	O
that	O
ˆsp	O
and	O
the	O
two	O
camera	O
centres	O
lie	O
in	O
the	O
same	O
category	O
as	O
the	O
given	O
example	O
.	O
since	O
two	O
conﬁgurations	O
in	O
the	O
same	O
category	O
are	O
projectively	O
equivalent	B
,	O
we	O
may	O
assume	O
that	O
ˆsp	O
=	O
sp	O
and	O
the	O
centres	O
of	O
p	O
and	O
ˆp	O
are	O
the	O
same	O
,	O
as	O
are	O
the	O
centres	O
of	O
p	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
and	O
ˆp	O
and	O
hence	O
by	O
result	O
22.8	O
so	O
is	O
{	O
ˆp	O
,	O
ˆp	O
this	O
shows	O
that	O
to	O
demonstrate	O
the	O
converse	O
section	O
of	O
theorem	O
22.9	O
it	O
is	O
sufﬁcient	O
merely	O
to	O
demonstrate	O
an	O
example	O
of	O
a	O
critical	O
conﬁguration	O
belonging	O
to	O
each	O
of	O
the	O
categories	O
given	O
in	O
result	O
22.11	O
(	O
except	O
for	O
cases	O
(	O
v	O
)	O
and	O
(	O
viii	O
)	O
)	O
.	O
examples	B
will	O
be	O
given	O
,	O
(	O
cid:23	O
)	O
pi	O
}	O
.	O
(	O
cid:2	O
)	O
544	O
22	O
degenerate	B
conﬁgurations	I
for	O
several	O
of	O
the	O
categories	O
,	O
though	O
not	O
all	O
.	O
the	O
fact	O
that	O
cases	O
(	O
v	O
)	O
and	O
(	O
viii	O
)	O
are	O
not	O
critical	O
is	O
not	O
shown	O
here	O
.	O
the	O
remaining	O
cases	O
are	O
left	O
to	O
the	O
motivated	O
reader	O
.	O
examples	B
of	O
critical	B
conﬁgurations	I
consider	O
the	O
case	O
p	O
=	O
q	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
=	O
[	O
i	O
|	O
t0	O
]	O
.	O
in	O
this	O
case	O
,	O
one	O
sees	O
that	O
sp	O
=	O
consequently	O
,	O
i	O
tt	O
0	O
fq	O
(	O
cid:1	O
)	O
q	O
[	O
i	O
|	O
0	O
]	O
=	O
(	O
cid:17	O
)	O
spsym	O
=	O
1	O
2	O
fq	O
(	O
cid:1	O
)	O
q	O
+	O
ft	O
fq	O
(	O
cid:1	O
)	O
q	O
q	O
(	O
cid:1	O
)	O
q	O
ft	O
q	O
(	O
cid:1	O
)	O
qt0	O
0	O
tt	O
0	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
i	O
tt	O
0	O
[	O
fq	O
(	O
cid:1	O
)	O
q	O
|	O
0	O
]	O
.	O
(	O
cid:18	O
)	O
.	O
given	O
the	O
fundamental	B
matrix	I
fq	O
(	O
cid:1	O
)	O
q	O
of	O
rank	O
2	O
,	O
and	O
the	O
camera	B
matrix	I
q	O
=	O
[	O
i	O
|	O
0	O
]	O
,	O
one	O
may	O
easily	O
ﬁnd	O
the	O
other	O
camera	B
matrix	I
q	O
(	O
cid:2	O
)	O
.	O
this	O
is	O
done	O
by	O
using	O
the	O
formula	O
of	O
result	O
9.13	O
(	O
p256	O
)	O
.	O
we	O
now	O
consider	O
several	O
examples	B
of	O
critical	B
conﬁgurations	I
belonging	O
to	O
different	O
categories	O
of	O
result	O
22.11.	O
example	O
22.12.	O
hyperboloid	B
of	O
one	O
sheet	O
–	O
two	O
centres	O
not	O
on	O
the	O
same	O
generator	O
.	O
we	O
choose	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
ﬁnd	O
that	O
	O
1	O
0	O
1	O
1	O
0	O
0	O
−1	O
0	O
−1	O
	O
and	O
t0	O
=	O
(	O
0	O
,	O
2	O
,	O
0	O
)	O
t.	O
then	O
tt	O
	O
.	O
	O
1	O
1−1	O
1	O
0	O
ssym	O
=	O
1	O
0	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
(	O
0	O
,	O
2	O
,	O
0	O
)	O
and	O
we	O
this	O
is	O
the	O
quadric	O
with	O
equation	O
x2	O
+	O
y2	O
+2y−	O
z2	O
=	O
0	O
,	O
or	O
x2	O
+	O
(	O
y	O
+1	O
)	O
2−	O
z2	O
=	O
1.	O
this	O
is	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
.	O
note	O
that	O
in	O
this	O
case	O
,	O
the	O
camera	B
centres	O
are	O
cp	O
=	O
cq	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
(	O
in	O
inhomogeneous	O
coordinates	B
)	O
.	O
the	O
camera	B
centre	I
cp	O
(	O
cid:1	O
)	O
=	O
(	O
0	O
,	O
2	O
,	O
0	O
)	O
.	O
we	O
note	O
that	O
the	O
line	B
from	O
cp	O
to	O
cp	O
(	O
cid:1	O
)	O
does	O
not	O
lie	O
on	O
the	O
quadric	O
surface	O
.	O
the	O
camera	B
centre	I
cq	O
(	O
cid:1	O
)	O
is	O
not	O
uniquely	O
determined	O
by	O
the	O
information	O
already	O
given	O
,	O
since	O
the	O
fundamental	B
matrix	I
does	O
not	O
uniquely	O
determine	O
the	O
two	O
cameras	O
.	O
however	O
,	O
the	O
epipole	O
e	O
such	O
that	O
fq	O
(	O
cid:1	O
)	O
qe	O
=	O
0	O
is	O
e	O
=	O
(	O
1	O
,	O
0	O
,	O
−1	O
)	O
.	O
since	O
e	O
=	O
qcq	O
(	O
cid:1	O
)	O
,	O
we	O
see	O
that	O
cq	O
(	O
cid:1	O
)	O
=	O
(	O
1	O
,	O
0	O
,	O
−1	O
,	O
k	O
−1	O
)	O
.	O
in	O
inhomogeneous	O
coordinates	B
cq	O
(	O
cid:1	O
)	O
=	O
k	O
(	O
1	O
,	O
0	O
,	O
−1	O
)	O
for	O
any	O
k.	O
we	O
verify	O
that	O
the	O
complete	O
line	B
from	O
cp	O
to	O
cq	O
(	O
cid:1	O
)	O
lies	O
on	O
the	O
quadric	O
,	O
but	O
cq	O
(	O
cid:1	O
)	O
may	O
lie	O
anywhere	O
along	O
this	O
line	B
.	O
(	O
cid:2	O
)	O
example	O
22.13.	O
hyperboloid	B
of	O
one	O
sheet	O
,	O
both	O
centres	O
on	O
the	O
same	O
generator	O
.	O
we	O
choose	O
the	O
same	O
fq	O
(	O
cid:1	O
)	O
q	O
as	O
in	O
the	O
previous	O
example	O
,	O
and	O
and	O
t0	O
=	O
(	O
3	O
,	O
4	O
,	O
5	O
)	O
t.	O
then	O
tt	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
(	O
−2	O
,	O
4	O
,	O
−2	O
)	O
and	O
we	O
ﬁnd	O
that	O
0	O
	O
1	O
−1	O
2	O
−1	O
−1	O
0	O
1	O
−1	O
2	O
−1	O
	O
.	O
ssym	O
=	O
this	O
is	O
the	O
quadric	O
with	O
equation	O
(	O
x−1	O
)	O
2	O
+	O
(	O
y+2	O
)	O
2−	O
(	O
z+1	O
)	O
2	O
=	O
4	O
,	O
which	O
is	O
once	O
again	O
22.2	O
degeneracies	B
in	O
two	B
views	I
545	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
.	O
it	O
may	O
be	O
veriﬁed	O
that	O
the	O
line	B
(	O
x	O
,	O
y	O
,	O
z	O
)	O
=	O
(	O
3t	O
,	O
4t	O
,	O
5t	O
)	O
lies	O
entirely	O
on	O
the	O
quadric	O
and	O
contains	O
the	O
two	O
camera	O
centres	O
,	O
(	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
and	O
(	O
3	O
,	O
4	O
,	O
5	O
)	O
t.	O
(	O
cid:2	O
)	O
example	O
22.14.	O
cone	O
–	O
one	O
centre	B
at	O
the	O
vertex	O
of	O
the	O
cone	O
.	O
we	O
choose	O
fq	O
(	O
cid:1	O
)	O
q	O
to	O
be	O
the	O
same	O
as	O
in	O
the	O
previous	O
example	O
,	O
but	O
t0	O
=	O
(	O
1	O
,	O
0	O
,	O
1	O
)	O
t.	O
in	O
this	O
case	O
we	O
see	O
that	O
tt	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
0t	O
,	O
and	O
so	O
ssym	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
−1	O
,	O
0	O
)	O
.	O
this	O
is	O
an	O
example	O
of	O
a	O
cone	O
.	O
the	O
camera	B
centre	I
0	O
(	O
cid:2	O
)	O
of	O
both	O
p	O
and	O
q	O
is	O
at	O
the	O
vertex	O
of	O
the	O
cone	O
,	O
namely	O
the	O
point	B
cp	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
example	O
22.15.	O
cone	O
–	O
neither	O
centre	B
at	O
the	O
vertex	O
of	O
the	O
cone	O
.	O
we	O
choose	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
and	O
t0	O
=	O
(	O
0	O
,	O
2	O
,	O
0	O
)	O
t.	O
in	O
this	O
case	O
,	O
we	O
see	O
that	O
	O
1	O
	O
ssym	O
=	O
1	O
1	O
0	O
1	O
0	O
this	O
is	O
the	O
quadric	O
with	O
equation	O
x2	O
+	O
y2	O
+	O
2y	O
=	O
0	O
,	O
or	O
x2	O
+	O
(	O
y	O
+	O
1	O
)	O
2	O
=	O
1	O
,	O
which	O
is	O
a	O
cylinder	O
parallel	B
with	O
the	O
z-axis	O
,	O
thus	O
projectively	O
equivalent	B
to	O
the	O
cone	O
with	O
vertex	O
at	O
(	O
cid:2	O
)	O
the	O
inﬁnite	O
point	O
(	O
0	O
,	O
0	O
,	O
1	O
,	O
0	O
)	O
t.	O
neither	O
of	O
the	O
camera	O
centres	O
lies	O
at	O
the	O
vertex	O
.	O
example	O
22.16.	O
two	O
planes	O
.	O
we	O
choose	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
diag	O
(	O
1	O
,	O
−1	O
,	O
0	O
)	O
and	O
t0	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
0t	O
.	O
in	O
this	O
case	O
,	O
we	O
see	O
that	O
sp	O
=	O
ssym	O
=	O
diag	O
(	O
1	O
,	O
−1	O
,	O
0	O
,	O
0	O
)	O
,	O
which	O
so	O
that	O
tt	O
0	O
represents	O
a	O
pair	O
of	O
planes	O
.	O
in	O
this	O
case	O
the	O
camera	B
centres	O
are	O
on	O
the	O
intersection	B
of	O
the	O
(	O
cid:2	O
)	O
two	O
planes	O
	O
1	O
1	O
0	O
−1	O
0	O
0	O
0	O
0	O
0	O
	O
and	O
t0	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
example	O
22.17.	O
single	O
plane	O
.	O
we	O
choose	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
(	O
cid:2	O
)	O
then	O
ssym	O
=	O
diag	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
,	O
which	O
represents	O
a	O
single	O
plane	O
,	O
x	O
=	O
0.	O
example	O
22.18.	O
single	O
line	O
.	O
we	O
choose	O
fq	O
(	O
cid:1	O
)	O
q	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
)	O
and	O
t0	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
in	O
this	O
case	O
,	O
we	O
see	O
that	O
ssym	O
=	O
diag	O
(	O
1	O
,	O
1	O
,	O
0	O
,	O
0	O
)	O
,	O
which	O
represents	O
a	O
single	O
line	O
–	O
the	O
z-axis	O
.	O
(	O
cid:2	O
)	O
all	O
the	O
points	O
and	O
the	O
two	O
camera	O
centres	O
lie	O
on	O
this	O
single	O
line	O
.	O
apart	O
for	O
the	O
impossible	O
cases	O
(	O
v	O
)	O
and	O
(	O
viii	O
)	O
this	O
gives	O
examples	B
of	O
all	O
possible	O
de-	O
generate	O
conﬁgurations	O
except	O
for	O
cases	O
(	O
vii	O
)	O
and	O
(	O
ix	O
)	O
in	O
result	O
22.11.	O
these	O
remaining	O
cases	O
are	O
left	O
for	O
the	O
reader	O
.	O
minimal	O
case	O
–	O
seven	O
points	O
as	O
seen	O
in	O
section	O
11.1.2	O
(	O
p281	O
)	O
,	O
seven	O
is	O
the	O
minimum	O
number	O
of	O
points	O
in	O
general	O
position	O
from	O
which	O
one	O
can	O
do	O
projective	B
reconstruction	I
.	O
the	O
method	O
comes	O
down	O
to	O
solving	O
a	O
cubic	O
equation	O
,	O
for	O
which	O
either	O
one	O
or	O
three	O
real	O
solutions	O
exist	O
.	O
looked	O
at	O
from	O
the	O
point	B
of	O
view	O
of	O
critical	O
surfaces	O
,	O
the	O
seven	O
points	O
and	O
two	O
camera	O
centres	O
in	O
one	O
conﬁguration	O
must	O
lie	O
on	O
a	O
quadric	O
surface	O
(	O
since	O
9	O
points	O
lie	O
on	O
a	O
quadric	O
)	O
.	O
if	O
this	O
quadric	O
is	O
ruled	B
,	O
then	O
there	O
will	O
be	O
three	O
conjugate	O
solutions	O
.	O
on	O
the	O
other	O
hand	O
,	O
if	O
it	O
is	O
not	O
a	O
ruled	B
quadric	O
(	O
for	O
instance	O
an	O
ellipsoid	O
)	O
then	O
there	O
will	O
be	O
only	O
one	O
solution	B
.	O
this	O
shows	O
that	O
the	O
distinction	O
between	O
the	O
cases	O
where	O
the	O
cubic	O
equation	O
has	O
one	O
or	O
three	O
solutions	O
arises	O
from	O
the	O
difference	O
between	O
the	O
546	O
22	O
degenerate	B
conﬁgurations	I
points	O
and	O
camera	B
centres	O
lying	O
on	O
a	O
ruled	O
or	O
unruled	O
quadric	O
–	O
a	O
pleasing	O
connection	O
between	O
the	O
algebra	O
and	O
geometry	O
.	O
22.3	O
carlsson–weinshall	O
duality	B
the	O
duality	B
explored	O
in	O
chapter	O
20	O
between	O
cameras	O
and	O
points	O
may	O
be	O
exploited	O
so	O
as	O
to	O
dualize	O
degeneracy	B
results	O
,	O
as	O
will	O
be	O
explained	O
in	O
this	O
section	O
.	O
we	O
give	O
a	O
more	O
formal	O
treatment	O
of	O
carlsson–weinshall	O
duality	B
here	O
.	O
the	O
basis	O
of	O
carlsson–weinshall	O
duality	B
is	O
the	O
equation	O
−t	O
−t	O
z	O
−t	O
−d	O
−d	O
c	O
−d	O
y	O
b	O
	O
=	O
	O
x	O
	O
a	O
	O
	O
x	O
y	O
z	O
t	O
	O
.	O
	O
	O
a	O
b	O
c	O
d	O
camera	B
matrix	I
−1	O
,	O
b	O
the	O
on	O
to	O
−1	O
)	O
t.	O
we	O
are	O
interested	O
in	O
describing	O
cameras	B
−1	O
,	O
d	O
a	O
camera	B
with	O
centre	B
(	O
a	O
in	O
terms	O
of	O
their	O
camera	B
centres	O
.	O
as	O
this	O
shows	O
,	O
in	O
swapping	O
camera	B
centres	O
with	O
3d	O
points	O
,	O
one	O
must	O
invert	O
the	O
coordinates	B
of	O
the	O
camera	B
centre	I
and	O
point	B
.	O
for	O
instance	O
,	O
the	O
point	B
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
is	O
dual	O
to	O
a	O
camera	B
with	O
camera	B
centre	I
(	O
x	O
corresponds	O
−1	O
)	O
t.	O
−1	O
,	O
y	O
−1	O
,	O
z	O
−1	O
,	O
t	O
−1	O
,	O
c	O
left	O
the	O
we	O
denote	O
the	O
reduced	B
camera	I
matrix	I
	O
a	O
−1	O
p	O
=	O
−1	O
b	O
	O
−d	O
−d	O
−1	O
−d	O
−1	O
−1	O
−1	O
c	O
(	O
22.1	O
)	O
(	O
22.2	O
)	O
−1	O
,	O
z	O
−1	O
,	O
y	O
with	O
centre	O
c	O
=	O
(	O
a	O
,	O
b	O
,	O
c	O
,	O
d	O
)	O
t	O
by	O
pc	O
.	O
−1	O
,	O
d	O
−1	O
,	O
c	O
(	O
x	O
pcx	O
=	O
pxc	O
−1	O
)	O
t	O
and	O
c	O
=	O
(	O
a	O
−1	O
,	O
t	O
−1	O
,	O
b	O
now	O
,	O
deﬁning	O
the	O
points	O
x	O
=	O
−1	O
)	O
t	O
,	O
one	O
immediately	O
veriﬁes	O
that	O
thus	O
,	O
this	O
transformation	B
interchanges	O
the	O
results	O
of	O
3d	O
points	O
and	O
camera	B
centres	O
.	O
thus	O
,	O
a	O
camera	B
with	O
centre	B
c	O
acting	O
on	O
x	O
gives	O
the	O
same	O
result	O
as	O
camera	O
with	O
centre	O
x	O
acting	O
on	O
c.	O
this	O
observation	O
leads	O
to	O
the	O
following	O
deﬁnition	B
deﬁnition	O
22.19.	O
the	O
mapping	O
of	O
ip3	O
to	O
itself	O
given	O
by	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
(	O
cid:6	O
)	O
→	O
(	O
yzt	O
,	O
ztx	O
,	O
txy	O
,	O
xyz	O
)	O
t	O
will	O
be	O
called	O
the	O
carlsson–weinshall	O
map	O
,	O
and	O
will	O
be	O
denoted	O
by	O
γ.	O
we	O
denote	O
the	O
image	O
of	O
a	O
point	B
x	O
under	O
γ	O
by	O
x.	O
the	O
image	O
of	O
an	O
object	O
under	O
γ	O
is	O
sometimes	O
referred	O
to	O
as	O
the	O
dual	B
object	O
.	O
the	O
carlsson–weinshall	O
map	O
is	O
an	O
example	O
of	O
a	O
cremona	O
transformation	B
.	O
for	O
more	O
information	O
on	O
cremona	O
transformations	O
,	O
the	O
reader	O
is	O
referred	O
to	O
semple	O
and	O
knee-	O
bone	O
(	O
[	O
semple-79	O
]	O
)	O
.	O
note	O
.	O
if	O
none	O
of	O
the	O
coordinates	O
of	O
x	O
is	O
zero	O
then	O
we	O
may	O
divide	O
x	O
by	O
xyzt	O
.	O
then	O
γ	O
is	O
equivalent	B
to	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
(	O
cid:6	O
)	O
→	O
(	O
x	O
−1	O
)	O
t.	O
this	O
is	O
the	O
form	B
of	I
the	O
mapping	O
−1	O
,	O
y	O
−1	O
,	O
z	O
−1	O
,	O
t	O
22.3	O
carlsson–weinshall	O
duality	B
547	O
that	O
we	O
will	O
usually	O
use	O
.	O
in	O
the	O
case	O
where	O
one	O
of	O
the	O
coordinates	O
of	O
x	O
is	O
zero	O
,	O
then	O
the	O
mapping	O
will	O
be	O
interpreted	O
as	O
in	O
the	O
deﬁnition	B
.	O
note	O
that	O
any	O
point	B
(	O
0	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
is	O
mapped	O
to	O
the	O
point	B
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
by	O
γ	O
,	O
provided	O
none	O
of	O
the	O
other	O
coordinates	B
is	O
zero	O
.	O
thus	O
,	O
the	O
mapping	O
is	O
not	O
one-to-one	O
.	O
if	O
two	O
of	O
the	O
coordinates	B
of	O
x	O
are	O
zero	O
,	O
then	O
x	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
which	O
is	O
an	O
unde-	O
ﬁned	O
point	B
.	O
thus	O
,	O
γ	O
is	O
not	O
deﬁned	O
at	O
all	O
points	O
.	O
in	O
fact	O
,	O
there	O
is	O
no	O
way	O
to	O
extend	O
γ	O
continuously	O
to	O
such	O
points	O
.	O
deﬁne	O
the	O
reference	O
tetrahedron	O
to	O
be	O
the	O
tetrahedron	O
with	O
vertices	O
e1	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
e2	O
=	O
(	O
0	O
,	O
1	O
,	O
0	O
,	O
0	O
)	O
t	O
,	O
e3	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
,	O
0	O
)	O
t	O
and	O
e4	O
=	O
(	O
0	O
,	O
0	O
,	O
0	O
,	O
1	O
)	O
t.	O
as	O
we	O
have	O
just	O
seen	O
,	O
γ	O
is	O
one-to-one	O
other	O
than	O
on	O
the	O
faces	O
of	O
the	O
reference	O
tetrahedron	O
.	O
it	O
maps	O
a	O
face	O
of	O
the	O
reference	O
tetrahedron	O
to	O
the	O
opposite	O
vertex	O
,	O
and	O
is	O
undeﬁned	O
on	O
the	O
edges	O
of	O
the	O
reference	O
tetrahedron	O
.	O
next	O
,	O
we	O
investigate	O
the	O
way	O
in	O
which	O
γ	O
acts	O
on	O
other	O
geometric	B
objects	O
.	O
theorem	O
22.20.	O
the	O
carlsson–weinshall	O
map	O
,	O
γ	O
acts	O
in	O
the	O
following	O
manner	O
:	O
(	O
i	O
)	O
it	O
maps	O
a	O
line	B
passing	O
through	O
two	O
general	O
points	O
x0	O
and	O
x1	O
to	O
the	O
twisted	B
cubic	I
passing	O
through	O
x0	O
,	O
x1	O
and	O
the	O
four	O
reference	O
vertices	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
.	O
(	O
ii	O
)	O
it	O
maps	O
a	O
line	B
passing	O
through	O
any	O
of	O
the	O
points	O
ei	O
to	O
a	O
line	B
passing	O
through	O
the	O
same	O
ei	O
.	O
we	O
exclude	O
the	O
lines	B
lying	O
on	O
the	O
face	O
of	O
the	O
reference	O
tetrahedron	O
,	O
since	O
such	O
lines	B
will	O
be	O
mapped	O
to	O
a	O
single	O
point	O
.	O
(	O
iii	O
)	O
it	O
maps	O
a	O
quadric	O
s	O
passing	O
through	O
the	O
four	O
points	O
ei	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
to	O
a	O
if	O
s	O
is	O
a	O
ruled	B
quadric	O
(	O
denoted	O
¯s	O
)	O
passing	O
through	O
the	O
same	O
four	O
points	O
.	O
quadric	O
,	O
then	O
so	O
is	O
¯s	O
.	O
if	O
s	O
is	O
degenerate	B
then	O
so	O
is	O
¯s	O
.	O
proof	O
.	O
(	O
i	O
)	O
a	O
line	B
has	O
parametric	O
equation	O
(	O
x0	O
+	O
aθ	O
,	O
y0	O
+	O
bθ	O
,	O
z0	O
+	O
cθ	O
,	O
t0	O
+	O
dθ	O
)	O
t	O
,	O
and	O
a	O
point	B
on	O
this	O
line	B
is	O
taken	O
by	O
the	O
carlsson–weinshall	O
map	O
to	O
the	O
point	B
t	O
(	O
(	O
y0	O
+	O
bθ	O
)	O
(	O
z0	O
+	O
cθ	O
)	O
(	O
t0	O
+	O
dθ	O
)	O
,	O
.	O
.	O
.	O
,	O
(	O
x0	O
+	O
aθ	O
)	O
(	O
y0	O
+	O
bθ	O
)	O
(	O
z0	O
+	O
cθ	O
)	O
)	O
.	O
thus	O
,	O
the	O
entries	O
of	O
the	O
vector	O
are	O
cubic	O
functions	O
of	O
θ	O
,	O
and	O
the	O
curve	O
is	O
a	O
twisted	B
cubic	I
.	O
now	O
,	O
setting	O
θ	O
=	O
−x0/a	O
,	O
the	O
term	O
(	O
x0	O
+	O
aθ	O
)	O
vanishes	O
,	O
and	O
the	O
corresponding	O
dual	B
t	O
≈	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t.	O
the	O
ﬁrst	O
entry	O
is	O
the	O
point	B
is	O
(	O
(	O
y0	O
+	O
bθ	O
)	O
(	O
z0	O
+	O
cθ	O
)	O
(	O
t0	O
+	O
dθ	O
)	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
only	O
one	O
that	O
does	O
not	O
contain	O
(	O
x0	O
+	O
aθ	O
)	O
,	O
and	O
hence	O
the	O
only	O
one	O
that	O
does	O
not	O
vanish	O
.	O
this	O
shows	O
that	O
the	O
reference	O
vertex	O
e1	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
is	O
on	O
the	O
twisted	B
cubic	I
.	O
by	O
similar	O
arguments	O
,	O
the	O
other	O
points	O
e2	O
,	O
.	O
.	O
.	O
,	O
e4	O
lie	O
on	O
the	O
twisted	B
cubic	I
also	O
.	O
note	O
that	O
a	O
twisted	B
cubic	I
is	O
deﬁned	O
by	O
six	O
points	O
,	O
and	O
this	O
twisted	B
cubic	I
is	O
deﬁned	O
by	O
the	O
given	O
six	O
points	O
ei	O
,	O
x0	O
,	O
x1	O
that	O
lie	O
on	O
it	O
,	O
where	O
x0	O
and	O
x1	O
are	O
any	O
two	O
points	O
deﬁning	O
the	O
line	B
.	O
(	O
ii	O
)	O
we	O
prove	O
this	O
for	B
lines	I
passing	O
through	O
the	O
point	B
e0	O
=	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t.	O
an	O
analogous	O
proof	O
holds	O
for	O
the	O
other	O
points	O
ei	O
.	O
choose	O
another	O
point	B
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
on	O
the	O
line	B
,	O
such	O
that	O
x	O
does	O
not	O
lie	O
on	O
any	O
face	O
of	O
the	O
reference	O
tetrahedron	O
.	O
thus	O
x	O
has	O
no	O
zero	O
coordinate	O
.	O
points	O
on	O
a	O
line	O
passing	O
through	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
and	O
x	O
=	O
(	O
x	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
are	O
all	O
of	O
the	O
form	O
(	O
α	O
,	O
y	O
,	O
z	O
,	O
t	O
)	O
t	O
for	O
varying	O
values	O
of	O
α.	O
these	O
points	O
are	O
mapped	O
by	O
−1	O
)	O
t.	O
this	O
represents	O
a	O
line	B
passing	O
through	O
the	O
−1	O
,	O
z	O
the	O
transformation	B
to	O
(	O
α	O
−1	O
,	O
z	O
two	O
points	O
(	O
1	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
t	O
and	O
x	O
=	O
(	O
x	O
−1	O
,	O
t	O
−1	O
,	O
y	O
−1	O
)	O
t.	O
−1	O
,	O
y	O
−1	O
,	O
t	O
22	O
degenerate	B
conﬁgurations	I
548	O
(	O
iii	O
)	O
since	O
the	O
quadric	O
s	O
passes	O
through	O
all	O
the	O
points	O
ei	O
,	O
the	O
diagonal	O
entries	O
of	O
s	O
must	O
all	O
be	O
zero	O
.	O
this	O
means	O
that	O
there	O
are	O
no	O
terms	O
involving	O
a	O
squared	O
coordinate	O
(	O
such	O
as	O
x2	O
)	O
in	O
the	O
equation	O
for	O
the	O
quadric	O
.	O
hence	O
the	O
equation	O
for	O
the	O
quadric	O
contains	O
only	O
mixed	O
terms	O
(	O
such	O
as	O
xy	O
,	O
yz	O
or	O
xt	O
)	O
.	O
therefore	O
,	O
the	O
quadric	O
s	O
may	O
be	O
deﬁned	O
by	O
an	O
equation	O
axy	O
+	O
bxz	O
+	O
cxt	O
+	O
dyz	O
+	O
eyt	O
+	O
f	O
zt	O
=	O
0.	O
dividing	O
this	O
equation	O
by	O
xyzt	O
,	O
−1	O
=	O
0	O
.	O
−1	O
+	O
cy	O
we	O
obtain	O
az	O
−1	O
)	O
t	O
,	O
this	O
is	O
a	O
quadratic	O
equation	O
in	O
the	O
entries	O
of	O
x.	O
thus	O
since	O
x	O
=	O
(	O
x	O
γ	O
maps	O
quadric	O
to	O
quadric	O
.	O
speciﬁcally	O
,	O
suppose	O
s	O
is	O
represented	O
by	O
the	O
matrix	B
−1	O
+	O
by	O
−1	O
,	O
z	O
−1t	O
−1	O
,	O
t	O
−1t	O
−1	O
,	O
y	O
−1	O
+	O
f	O
x	O
−1y	O
−1z	O
−1z	O
−1	O
+	O
dx	O
−1t	O
−1	O
+	O
ex	O
	O
	O
0	O
a	O
b	O
	O
then	O
¯s	O
=	O
	O
0	O
f	O
s	O
=	O
e	O
f	O
e	O
d	O
b	O
0	O
c	O
f	O
e	O
c	O
0	O
a	O
d	O
b	O
a	O
0	O
c	O
a	O
0	O
d	O
e	O
b	O
d	O
0	O
f	O
0	O
c	O
and	O
xtsx	O
=	O
0	O
implies	O
xt¯sx	O
=	O
0.	O
if	O
s	O
is	O
ruled	B
,	O
then	O
it	O
contains	O
two	O
generators	O
passing	O
through	O
any	O
point	B
,	O
and	O
in	O
particular	O
through	O
each	O
ei	O
.	O
by	O
part	O
(	O
ii	O
)	O
,	O
these	O
are	O
mapped	O
to	O
straight	O
lines	B
,	O
which	O
must	O
lie	O
on	O
¯s	O
.	O
thus	O
¯s	O
is	O
a	O
ruled	B
quadric	O
.	O
one	O
may	O
further	O
verify	O
that	O
det	O
s	O
=	O
det	O
¯s	O
,	O
which	O
implies	O
that	O
if	O
s	O
is	O
a	O
non-degenerate	O
quadric	O
(	O
that	O
is	O
det	O
s	O
(	O
cid:5	O
)	O
=	O
0	O
)	O
,	O
then	O
so	O
is	O
¯s	O
.	O
in	O
this	O
non-degenerate	O
case	O
,	O
if	O
s	O
is	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
,	O
then	O
det	O
s	O
>	O
0	O
,	O
from	O
which	O
it	O
follows	O
that	O
det	O
¯s	O
>	O
0.	O
thus	O
¯s	O
is	O
also	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
.	O
the	O
action	O
of	O
γ	O
on	O
other	O
geometric	B
entities	O
is	O
investigated	O
in	O
exercises	O
(	O
page	O
559	O
)	O
;	O
we	O
wish	O
to	O
interpret	O
duality	B
equation	O
(	O
22.2	O
)	O
in	O
a	O
coordinate-free	O
manner	O
.	O
the	O
matrix	B
pc	O
has	O
by	O
deﬁnition	B
the	O
form	O
given	O
in	O
(	O
22.1	O
)	O
,	O
and	O
maps	O
ei	O
to	O
ei	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
.	O
the	O
image	O
pcx	O
is	O
may	O
be	O
thought	O
of	O
as	O
a	O
representation	B
of	O
the	O
projection	B
of	O
x	O
relative	O
to	O
the	O
projective	B
basis	O
ei	O
in	O
the	O
image	O
.	O
alternatively	O
,	O
pcx	O
represents	O
the	O
projective	B
equivalence	O
class	O
of	O
the	O
set	O
of	O
the	O
ﬁve	O
rays	O
ce1	O
,	O
.	O
.	O
.	O
,	O
ce4	O
,	O
cx	O
.	O
thus	O
pcx	O
=	O
pc	O
(	O
cid:1	O
)	O
x	O
(	O
cid:2	O
)	O
if	O
and	O
only	O
if	O
the	O
set	O
of	O
rays	O
from	O
c	O
to	O
x	O
and	O
the	O
four	O
vertices	O
of	O
the	O
reference	O
tetrahedron	O
is	O
projectively	O
equivalent	B
to	O
the	O
set	O
of	O
rays	O
from	O
c	O
(	O
cid:2	O
)	O
and	O
the	O
four	O
reference	O
vertices	O
.	O
in	O
terms	O
of	O
the	O
notation	O
introduced	O
earlier	O
,	O
we	O
may	O
write	O
(	O
22.2	O
)	O
in	O
a	O
different	O
form	O
as	O
to	O
x	O
(	O
cid:2	O
)	O
(	O
cid:8	O
)	O
c	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
x	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
c	O
(	O
cid:9	O
)	O
.	O
(	O
22.3	O
)	O
the	O
duality	B
principle	I
the	O
basis	O
of	O
duality	O
is	O
(	O
22.2	O
)	O
which	O
states	O
that	O
pcx	O
=	O
pxc	O
,	O
with	O
notation	O
as	O
in	O
(	O
22.2	O
)	O
the	O
notation	O
pcx	O
represents	O
the	O
coordinates	B
of	O
the	O
projection	B
of	O
point	B
x	O
with	O
re-	O
spect	O
to	O
the	O
canonical	O
image	O
coordinate	O
frame	O
deﬁned	O
by	O
the	O
projections	O
of	O
the	O
corners	O
of	O
the	O
reference	O
tetrahedron	O
.	O
equivalently	O
,	O
pc	O
may	O
be	O
considered	O
as	O
representing	O
the	O
projective	B
equivalence	O
class	O
of	O
the	O
ﬁve	O
projected	O
points	O
pcei	O
and	O
pcx	O
.	O
in	O
the	O
notation	O
of	O
this	O
chapter	O
,	O
this	O
is	O
(	O
cid:8	O
)	O
c	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:9	O
)	O
.	O
thus	O
the	O
duality	B
relation	O
may	O
be	O
written	O
as	O
(	O
22.4	O
)	O
(	O
cid:8	O
)	O
c	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
x	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
c	O
(	O
cid:9	O
)	O
where	O
the	O
bar	O
represents	O
the	O
carlsson–weinshall	O
map	O
.	O
although	O
pc	O
was	O
deﬁned	O
in	O
terms	O
of	O
the	O
canonical	O
projective	B
basis	O
,	O
there	O
is	O
nothing	O
special	O
about	O
the	O
four	O
points	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
used	O
as	O
vertices	O
of	O
the	O
reference	O
tetrahedron	O
,	O
22.3	O
carlsson–weinshall	O
duality	B
549	O
other	O
than	O
the	O
fact	O
that	O
they	O
are	O
non-coplanar	O
.	O
given	O
any	O
four	O
non-coplanar	O
points	O
,	O
one	O
may	O
deﬁne	O
a	O
projective	B
coordinate	O
system	O
in	O
which	O
these	O
four	O
points	O
are	O
the	O
points	O
ei	O
forming	O
part	O
of	O
a	O
projective	O
basis	O
.	O
the	O
carlsson–weinshall	O
map	O
may	O
then	O
be	O
de-	O
ﬁned	O
with	O
respect	O
to	O
this	O
coordinate	O
frame	O
.	O
the	O
resulting	O
map	O
is	O
called	O
the	O
carlsson–	O
weinshall	O
map	O
with	O
respect	O
to	O
the	O
given	O
reference	O
tetrahedron	O
.	O
to	O
be	O
more	O
precise	O
,	O
it	O
should	O
be	O
observed	O
that	O
ﬁve	O
points	O
(	O
not	O
four	O
)	O
deﬁne	O
a	O
projec-	O
tive	O
coordinate	O
frame	O
in	O
ip3	O
.	O
in	O
fact	O
,	O
there	O
is	O
more	O
than	O
one	O
projective	B
frame	O
(	O
in	O
fact	O
a	O
3-parameter	O
family	O
)	O
for	O
which	O
four	O
non-coplanar	O
points	O
have	O
coordinates	B
ei	O
.	O
thus	O
the	O
carlsson–weinshall	O
map	O
with	O
respect	O
to	O
a	O
given	O
reference	O
tetrahedron	O
is	O
not	O
unique	O
.	O
however	O
,	O
the	O
mapping	O
given	O
by	O
deﬁnition	B
22.19	O
with	O
respect	O
to	O
any	O
such	O
coordinate	O
frame	O
may	O
be	O
used	O
.	O
given	O
a	O
statement	O
or	O
theorem	O
concerning	O
projections	O
of	O
sets	O
of	B
points	I
with	O
respect	O
to	O
one	O
or	O
more	O
projection	O
centres	O
one	O
may	O
derive	O
a	O
dual	B
statement	O
.	O
one	O
requires	O
that	O
among	O
the	O
four	O
points	O
being	O
projected	O
,	O
there	O
are	O
four	O
non-coplanar	O
points	O
that	O
may	O
form	O
a	O
reference	O
tetrahedron	O
.	O
under	O
a	O
general	O
duality	O
mapping	O
with	O
respect	O
to	O
the	O
reference	O
tetrahedron	O
(	O
i	O
)	O
points	O
(	O
other	O
than	O
those	O
belonging	O
to	O
the	O
reference	O
tetrahedron	O
)	O
are	O
mapped	O
to	O
centres	O
of	O
projection	O
.	O
(	O
ii	O
)	O
centres	O
of	O
projection	O
are	O
mapped	O
to	O
points	O
.	O
(	O
iii	O
)	O
straight	O
lines	B
are	O
mapped	O
to	O
twisted	O
cubics	O
.	O
(	O
iv	O
)	O
ruled	B
quadrics	O
containing	O
the	O
reference	O
tetrahedron	O
are	O
mapped	O
to	O
ruled	O
quadrics	B
containing	O
the	O
reference	O
tetrahedron	O
.	O
if	O
the	O
original	O
quadric	O
is	O
non-	O
degenerate	B
,	O
so	O
is	O
its	O
image	O
under	O
the	O
duality	B
mapping	O
.	O
points	O
lying	O
on	O
an	O
edge	O
of	O
the	O
reference	O
tetrahedron	O
should	O
be	O
avoided	O
,	O
since	O
the	O
carlsson–weinshall	O
mapping	O
is	O
undeﬁned	O
for	O
such	O
points	O
.	O
using	O
this	O
as	O
a	O
sort	O
of	O
trans-	O
lation	O
table	O
,	O
one	O
may	O
dualize	O
existing	O
theorems	O
about	O
point	B
projection	O
,	O
giving	O
new	O
theorems	O
for	O
which	O
a	O
separate	O
proof	O
is	O
not	O
needed	O
.	O
note	O
.	O
it	O
is	O
important	O
to	O
observe	O
that	O
only	O
those	O
points	O
not	O
belonging	O
to	O
the	O
reference	O
tetrahedron	O
are	O
mapped	O
to	O
camera	O
centres	O
by	O
duality	B
.	O
the	O
vertices	O
of	O
the	O
reference	O
tetrahedron	O
remain	O
points	O
.	O
in	O
practice	O
,	O
in	O
applying	O
the	O
duality	B
principle	I
,	O
one	O
may	O
select	O
any	O
four	O
points	O
to	O
form	O
the	O
reference	O
tetrahedron	O
,	O
as	O
long	O
as	O
they	O
are	O
non-coplanar	O
.	O
in	O
general	O
,	O
in	O
the	O
results	O
stated	O
in	O
the	O
next	O
section	O
there	O
will	O
be	O
an	O
assumption	O
(	O
not	O
always	O
stated	O
explicitly	O
)	O
that	O
point	B
sets	O
considered	O
contain	O
four	O
non-coplanar	O
points	O
,	O
which	O
may	O
be	O
taken	O
as	O
the	O
reference	O
tetrahedron	O
.	O
22.3.1	O
single	B
view	I
ambiguity	O
it	O
will	O
be	O
shown	O
in	O
this	O
section	O
how	O
various	O
ambiguous	O
reconstruction	B
results	O
may	O
be	O
derived	O
simply	O
from	O
known	O
or	O
obvious	O
geometric	B
statements	O
by	O
applying	O
duality	B
.	O
camera	B
resectioning	I
from	O
ﬁve	O
points	O
five	O
3d–2d	O
point	B
correspondences	O
are	O
not	O
sufﬁcient	O
for	B
camera	I
resectioning	I
for	O
pro-	O
jective	O
cameras	B
.	O
it	O
is	O
interesting	O
to	O
know	O
what	O
one	O
can	O
determine	O
from	O
ﬁve	O
point	O
cor-	O
respondences	O
,	O
however	O
.	O
550	O
22	O
degenerate	B
conﬁgurations	I
c	O
x	O
x	O
c	O
fig	O
.	O
22.5.	O
left	O
:	O
any	O
point	B
on	O
the	O
line	B
passing	O
through	O
c	O
and	O
x	O
is	O
projected	O
to	O
the	O
same	O
point	O
from	O
projection	O
centre	B
c.	O
right	O
:	O
the	O
dual	B
statement	O
–	O
from	O
any	O
centre	B
of	O
projection	B
c	O
lying	O
on	O
a	O
twisted	O
cubic	O
passing	O
through	O
x	O
and	O
the	O
vertices	O
of	O
the	O
reference	O
tetrahedron	O
,	O
the	O
ﬁve	O
points	O
are	O
projected	O
in	O
the	O
same	O
way	O
(	O
up	O
to	O
projective	O
equivalence	O
)	O
.	O
thus	O
a	O
camera	B
is	O
constrained	O
to	O
lie	O
on	O
a	O
twisted	O
cubic	O
by	O
its	O
image	O
of	O
ﬁve	O
known	O
points	O
.	O
as	O
a	O
simple	O
example	O
of	O
what	O
can	O
be	O
deduced	O
using	O
carlsson	O
duality	B
,	O
consider	O
the	O
following	O
simple	O
question	O
:	O
when	O
do	O
two	O
points	O
project	O
to	O
the	O
same	O
point	O
in	O
an	O
image	O
?	O
the	O
answer	O
is	O
obviously	O
when	O
the	O
two	O
points	O
lie	O
on	O
the	O
same	O
ray	O
(	O
straight	O
line	B
)	O
through	O
the	O
camera	B
centre	I
.	O
dualizing	O
this	O
simple	O
observation	O
,	O
ﬁgure	O
22.5	O
shows	O
that	O
the	O
centre	B
of	O
the	O
camera	B
constrained	O
by	O
ﬁve	O
point	B
3d–2d	O
correspondences	B
must	O
lie	O
on	O
a	O
twisted	O
cubic	O
passing	O
through	O
the	O
ﬁve	O
3d	O
points	O
.	O
the	O
horopter	B
in	O
a	O
similar	O
manner	O
one	O
may	O
compute	O
the	O
form	B
of	I
the	O
horopter	B
determined	O
by	O
two	O
cameras	O
.	O
the	O
horopter	B
is	O
the	O
set	O
of	O
space	O
points	O
that	O
map	O
to	O
the	O
same	O
point	O
in	O
two	O
images	O
.	O
the	O
argument	O
is	O
illustrated	O
in	O
ﬁgure	O
22.6	O
and	O
begins	O
with	O
a	O
simple	O
observation	O
concerning	O
straight	O
lines	B
.	O
result	O
22.21.	O
given	O
points	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
,	O
the	O
locus	O
of	B
camera	I
centres	O
c	O
such	O
that	O
(	O
cid:8	O
)	O
c	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
c	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:9	O
)	O
.	O
is	O
the	O
straight	O
line	B
passing	O
through	O
x	O
and	O
x	O
(	O
cid:2	O
)	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
22.6	O
(	O
left	O
)	O
the	O
dual	B
of	O
this	O
statement	O
determines	O
the	O
horopter	B
for	O
a	O
pair	O
of	O
cameras	O
(	O
see	O
ﬁgure	O
22.6	O
(	O
right	O
)	O
)	O
.	O
result	O
22.22.	O
given	O
projection	B
centres	O
c	O
and	O
c	O
(	O
cid:2	O
)	O
,	O
non-collinear	O
with	O
the	O
four	O
points	O
ei	O
of	O
a	O
reference	O
tetrahedron	O
,	O
the	O
set	O
of	B
points	I
x	O
such	O
that	O
(	O
cid:8	O
)	O
c	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
c	O
(	O
cid:2	O
)	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:9	O
)	O
is	O
a	O
twisted	B
cubic	I
passing	O
through	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
and	O
the	O
two	O
projec-	O
tion	O
centres	O
c	O
and	O
c	O
(	O
cid:2	O
)	O
.	O
ambiguity	B
of	O
camera	B
resection	O
finally	O
,	O
we	O
consider	O
ambiguity	B
of	O
resection	B
.	O
this	O
is	O
very	O
closely	O
related	O
to	O
the	O
horopter	B
.	O
to	O
visualize	O
this	O
,	O
the	O
reader	O
may	O
refer	O
again	O
to	O
ﬁgure	O
22.6	O
,	O
though	O
it	O
is	O
not	O
exactly	O
pertinent	O
in	O
this	O
situation	O
.	O
result	O
22.23.	O
consider	O
a	O
set	O
of	B
camera	I
centres	O
c1	O
,	O
.	O
.	O
.	O
,	O
cm	O
and	O
a	O
point	B
x0	O
all	O
lying	O
on	O
22.3	O
carlsson–weinshall	O
duality	B
551	O
c	O
c'	O
x	O
x'	O
x	O
x'	O
c	O
c'	O
,	O
.	O
.	O
.	O
lying	O
on	O
the	O
line	B
passing	O
through	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
fig	O
.	O
22.6.	O
left	O
:	O
from	O
any	O
centre	B
of	O
projection	B
c	O
,	O
c	O
(	O
cid:1	O
)	O
,	O
are	O
projected	O
to	O
the	O
same	O
ray	O
.	O
that	O
is	O
,	O
(	O
cid:8	O
)	O
c	O
;	O
ei	O
,	O
x	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
c	O
;	O
ei	O
,	O
x	O
(	O
cid:1	O
)	O
(	O
cid:9	O
)	O
for	O
all	O
c	O
on	O
the	O
the	O
points	O
x	O
and	O
x	O
(	O
cid:1	O
)	O
line	B
.	O
right	O
:	O
the	O
dual	B
statement	O
–	O
all	O
points	O
on	O
the	O
twisted	B
cubic	I
passing	O
through	O
c	O
and	O
c	O
(	O
cid:1	O
)	O
and	O
the	O
vertices	O
of	O
the	O
reference	O
tetrahedron	O
are	O
projected	O
in	O
the	O
same	O
way	O
relative	O
to	O
the	O
two	O
projection	O
centres	O
.	O
that	O
is	O
,	O
(	O
cid:8	O
)	O
c	O
;	O
ei	O
,	O
x	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
c	O
(	O
cid:1	O
)	O
;	O
ei	O
,	O
x	O
(	O
cid:9	O
)	O
for	O
all	O
x	O
on	O
the	O
twisted	B
cubic	I
.	O
this	O
curve	O
is	O
called	O
the	O
horopter	B
for	O
the	O
two	O
centres	O
of	O
projection	O
.	O
a	O
single	O
straight	O
line	B
and	O
let	O
ei	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
be	O
the	O
vertices	O
of	O
a	O
reference	O
tetrahedron	O
.	O
let	O
x	O
be	O
another	O
point	B
.	O
then	O
the	O
two	O
conﬁgurations	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cm	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
}	O
and	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cm	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x0	O
}	O
are	O
image-equivalent	B
conﬁgurations	I
if	O
and	O
only	O
if	O
x	O
lies	O
on	O
the	O
same	O
straight	O
line	B
as	O
x0	O
and	O
the	O
cameras	B
.	O
in	O
passing	O
to	O
the	O
dual	B
statement	O
,	O
according	O
to	O
theorem	O
22.20	O
the	O
straight	O
line	B
be-	O
comes	O
a	O
twisted	B
cubic	I
through	O
the	O
four	O
vertices	O
of	O
the	O
reference	O
tetrahedron	O
.	O
thus	O
the	O
dual	B
statement	O
to	O
result	O
22.23	O
is	O
:	O
result	O
22.24.	O
consider	O
a	O
set	O
of	B
points	I
xi	O
and	O
a	O
camera	B
centre	I
c0	O
all	O
lying	O
on	O
a	O
single	O
twisted	B
cubic	I
also	O
passing	O
through	O
four	O
reference	O
vertices	O
ei	O
.	O
let	O
c	O
be	O
any	O
other	O
camera	B
centre	I
.	O
then	O
the	O
conﬁgurations	O
{	O
c	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x1	O
,	O
.	O
.	O
.	O
,	O
xm	O
}	O
and	O
{	O
c0	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x1	O
,	O
.	O
.	O
.	O
,	O
xm	O
}	O
are	O
image-equivalent	O
if	O
and	O
only	O
if	O
c	O
lies	O
on	O
the	O
same	O
twisted	O
cubic	O
.	O
since	O
the	O
points	O
ei	O
may	O
be	O
any	O
four	O
non-coplanar	O
points	O
,	O
and	O
a	O
twisted	B
cubic	I
can	O
not	O
contain	O
4	O
coplanar	O
points	O
,	O
one	O
may	O
state	O
this	O
last	O
result	O
in	O
the	O
following	O
form	O
:	O
result	O
22.25.	O
let	O
x1	O
,	O
.	O
.	O
.	O
,	O
xm	O
be	O
a	O
set	O
of	B
points	I
and	O
c0	O
a	O
camera	B
centre	I
all	O
lying	O
on	O
a	O
twisted	O
cubic	O
.	O
then	O
for	O
any	O
other	O
camera	B
centre	I
c	O
the	O
conﬁgurations	O
{	O
c	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xm	O
}	O
and	O
{	O
c0	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xm	O
}	O
are	O
image-equivalent	O
if	O
and	O
only	O
if	O
c	O
lies	O
on	O
the	O
same	O
twisted	O
cubic	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
22.6	O
(	O
right	O
)	O
.	O
it	O
shows	O
that	O
camera	B
pose	O
can	O
not	O
be	O
uniquely	O
determined	O
whenever	O
all	O
points	O
and	O
a	O
camera	B
centre	I
lie	O
on	O
a	O
twisted	O
cubic	O
.	O
this	O
gives	O
an	O
independent	O
proof	O
of	O
result	O
22.6	O
(	O
p537	O
)	O
covering	O
the	O
case	O
that	O
was	O
left	O
unﬁnished	O
previously	O
.	O
using	O
similar	O
methods	O
one	O
can	O
show	O
that	O
this	O
is	O
one	O
of	O
only	O
two	O
possible	O
ambiguous	O
situations	O
.	O
the	O
other	O
case	O
in	O
which	O
ambiguity	B
occurs	O
is	O
when	O
all	O
points	O
and	O
the	O
two	O
552	O
22	O
degenerate	B
conﬁgurations	I
camera	O
centres	O
lie	O
in	O
the	O
union	O
of	O
a	O
plane	O
and	O
a	O
line	B
.	O
this	O
arises	O
as	O
the	O
dual	B
of	O
the	O
case	O
when	O
the	O
straight	O
line	B
through	O
the	O
camera	B
centres	O
meets	O
one	O
of	O
the	O
vertices	O
of	O
the	O
reference	O
tetrahedron	O
.	O
in	O
this	O
case	O
,	O
the	O
dual	B
of	O
this	O
line	B
is	O
also	O
a	O
straight	O
line	B
through	O
the	O
same	O
reference	O
vertex	O
(	O
see	O
theorem	O
22.20	O
)	O
,	O
and	O
all	O
points	O
must	O
lie	O
on	O
this	O
line	B
or	O
the	O
opposite	O
face	O
of	O
the	O
reference	O
tetrahedron	O
.	O
note	O
in	O
both	O
these	O
examples	B
how	O
the	O
use	O
of	O
duality	B
has	O
taken	O
intuitively	O
obvious	O
statements	O
concerning	O
projections	O
of	O
collinear	O
points	O
and	O
derived	O
a	O
result	O
somewhat	O
less	O
obvious	O
about	O
points	O
lying	O
on	O
a	O
twisted	O
cubic	O
.	O
22.3.2	O
two-view	O
ambiguity	B
the	O
basic	O
result	O
theorem	O
22.9	O
(	O
p541	O
)	O
about	O
critical	O
surfaces	O
from	O
two	O
views	O
may	O
be	O
stated	O
as	O
follows	O
.	O
theorem	O
22.26.	O
a	O
conﬁguration	O
{	O
c1	O
,	O
c2	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
xn	O
}	O
of	O
two	O
camera	B
centres	O
and	O
n	O
points	O
allows	O
an	O
alternative	O
reconstruction	B
if	O
and	O
only	O
if	O
both	O
camera	O
centres	O
c1	O
,	O
c2	O
and	O
all	O
the	O
points	O
xj	O
lie	O
on	O
a	O
ruled	O
quadric	O
surface	O
.	O
if	O
the	O
quadric	O
is	O
non-degenerate	O
(	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
)	O
,	O
then	O
there	O
will	O
always	O
exist	O
a	O
third	O
distinct	O
reconstruction	B
.	O
one	O
may	O
write	O
down	O
the	O
dual	B
statement	O
straight	O
away	O
as	O
follows	O
.	O
theorem	O
22.27.	O
a	O
conﬁguration	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cn	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
x6	O
}	O
of	O
any	O
number	O
of	O
cameras	O
and	O
six	O
points	O
allows	O
an	O
alternative	O
reconstruction	B
if	O
and	O
only	O
if	O
all	O
camera	B
centres	O
c1	O
,	O
.	O
.	O
.	O
,	O
cn	O
and	O
all	O
the	O
points	O
x1	O
,	O
.	O
.	O
.	O
,	O
x6	O
lie	O
on	O
a	O
ruled	O
quadric	O
surface.1	O
if	O
the	O
quadric	O
is	O
non-degenerate	O
(	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
)	O
then	O
there	O
will	O
always	O
exist	O
a	O
third	O
distinct	O
reconstruction	B
.	O
this	O
result	O
was	O
originally	O
proved	O
in	O
[	O
maybank-98	O
]	O
.	O
just	O
to	O
emphasize	O
how	O
a	O
duality	B
proof	O
works	O
,	O
a	O
proof	O
for	O
theorem	O
22.27	O
will	O
be	O
given	O
.	O
proof	O
.	O
consider	O
the	O
conﬁguration	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cn	O
;	O
x1	O
,	O
.	O
.	O
.	O
,	O
x6	O
}	O
.	O
one	O
renumbers	O
the	O
points	O
so	O
that	O
the	O
conﬁguration	O
is	O
denoted	O
by	O
{	O
c1	O
,	O
.	O
.	O
.	O
,	O
cn	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x1	O
,	O
x2	O
}	O
where	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
are	O
four	O
non-collinear	O
points	O
,	O
taken	O
to	O
be	O
the	O
vertices	O
of	O
a	O
reference	O
tetra-	O
hedron	O
.	O
if	O
this	O
conﬁguration	O
has	O
an	O
alternative	O
reconstruction	B
,	O
then	O
there	O
exists	O
an-	O
other	O
conﬁguration	O
{	O
c	O
(	O
cid:2	O
)	O
}	O
such	O
that	O
for	O
all	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
and	O
n	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:2	O
)	O
j	O
=	O
1	O
,	O
2	O
,	O
one	O
has	O
(	O
cid:8	O
)	O
ci	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
xj	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
c	O
(	O
cid:2	O
)	O
(	O
cid:9	O
)	O
.	O
dualizing	O
this	O
using	O
(	O
22.3	O
)	O
yields	O
1	O
,	O
x	O
(	O
cid:2	O
)	O
i	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:9	O
)	O
for	O
all	O
j	O
=	O
1	O
,	O
2	O
and	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n.	O
(	O
cid:8	O
)	O
xj	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
ci	O
(	O
cid:9	O
)	O
=	O
(	O
cid:8	O
)	O
x	O
(	O
cid:2	O
)	O
j	O
;	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
,	O
c	O
(	O
cid:2	O
)	O
i	O
1	O
,	O
.	O
.	O
.	O
,	O
c	O
(	O
cid:2	O
)	O
2	O
j	O
now	O
,	O
theorem	O
22.26	O
applies	O
,	O
and	O
one	O
deduces	O
that	O
the	O
two	O
camera	O
centres	O
xj	O
,	O
the	O
reference	O
vertices	O
e1	O
,	O
.	O
.	O
.	O
,	O
e4	O
and	O
the	O
points	O
ci	O
all	O
lie	O
on	O
a	O
ruled	O
quadric	O
surface	O
¯s	O
.	O
applying	O
the	O
reverse	O
dualization	O
,	O
using	O
theorem	O
22.20	O
(	O
iii	O
)	O
,	O
one	O
sees	O
that	O
the	O
points	O
x1	O
,	O
x2	O
and	O
the	O
camera	B
centres	O
ci	O
all	O
lie	O
on	O
the	O
quadric	O
surface	O
s.	O
this	O
proves	O
the	O
forward	O
implication	O
of	O
the	O
theorem	O
.	O
the	O
reverse	O
implication	O
is	O
handled	O
in	O
a	O
similar	O
manner	O
.	O
1	O
in	O
this	O
statement	O
,	O
it	O
is	O
assumed	O
that	O
the	O
set	O
of	B
points	I
x1	O
,	O
.	O
.	O
.	O
,	O
x6	O
includes	O
four	O
non-coplanar	O
points	O
forming	O
a	O
reference	O
tetrahedron	O
and	O
that	O
none	O
of	O
the	O
other	O
two	O
xj	O
nor	O
any	O
of	O
the	O
camera	O
centres	O
ci	O
lies	O
on	O
a	O
face	O
of	O
this	O
tetrahedron	O
.	O
whether	O
or	O
not	O
this	O
condition	O
is	O
essential	O
is	O
not	O
resolved	O
.	O
22.4	O
three-view	O
critical	B
conﬁgurations	I
553	O
the	O
existence	O
of	O
a	O
third	O
distinct	O
solution	B
follows	O
from	O
the	O
fact	O
that	O
the	O
dual	B
of	O
a	O
non-	O
degenerate	B
quadric	O
is	O
non-degenerate	O
.	O
the	O
minimum	O
interesting	O
case	O
of	O
theorem	O
22.27	O
is	O
when	O
n	O
=	O
3	O
,	O
as	O
studied	O
in	O
section	O
20.2.4	O
(	O
p510	O
)	O
.	O
in	O
this	O
case	O
there	O
are	O
nine	O
points	O
in	O
total	O
(	O
three	O
cameras	B
and	O
six	O
points	O
)	O
.	O
one	O
can	O
construct	O
a	O
quadric	O
surface	O
passing	O
through	O
these	O
nine	O
points	O
(	O
a	O
quadric	O
is	O
de-	O
ﬁned	O
by	O
nine	O
points	O
)	O
.	O
if	O
the	O
quadric	O
is	O
a	O
ruled	B
quadric	O
(	O
a	O
hyperboloid	B
of	O
one	O
sheet	O
in	O
the	O
non-degenerate	O
case	O
)	O
,	O
then	O
there	O
are	O
three	O
possible	O
distinct	O
reconstructions	O
.	O
otherwise	O
the	O
reconstruction	B
is	O
unique	O
.	O
as	O
with	O
reconstruction	B
from	O
seven	O
points	O
in	O
two	B
views	I
,	O
algorithm	B
20.1	O
(	O
p511	O
)	O
for	O
six	O
points	O
in	O
three	O
views	O
requires	O
the	O
solution	B
of	O
a	O
cubic	O
equa-	O
tion	O
.	O
as	O
with	O
seven	O
points	O
,	O
the	O
distinction	O
between	O
cases	O
where	O
the	O
cubic	O
has	O
one	O
or	O
three	O
real	O
solutions	O
is	O
explained	O
as	O
the	O
difference	O
between	O
whether	O
the	O
quadric	O
is	O
ruled	B
or	O
not	O
.	O
22.4	O
three-view	O
critical	B
conﬁgurations	I
we	O
now	O
turn	O
to	O
consider	O
the	O
ambiguous	O
conﬁgurations	O
that	O
may	O
arise	O
in	O
the	O
three-view	O
case	O
.	O
in	O
this	O
section	O
,	O
to	O
distinguish	O
the	O
three	O
cameras	B
,	O
we	O
use	O
superscripts	O
instead	O
of	O
primes	O
.	O
thus	O
,	O
let	O
p0	O
,	O
p1	O
,	O
p2	O
be	O
three	O
cameras	B
and	O
{	O
pi	O
}	O
be	O
a	O
set	O
of	B
points	I
.	O
we	O
ask	O
under	O
what	O
circumstances	O
there	O
exists	O
another	O
conﬁguration	O
consisting	O
of	O
three	O
other	O
camera	B
matrices	I
q0	O
,	O
q1	O
and	O
q2	O
and	O
points	O
{	O
qi	O
}	O
such	O
that	O
pjpi	O
=	O
qjqi	O
for	O
all	O
i	O
and	O
j.	O
we	O
require	O
that	O
the	O
two	O
conﬁgurations	O
be	O
projectively	O
inequivalent	O
.	O
various	O
special	O
ambiguous	O
conﬁgurations	O
exist	O
.	O
points	O
in	O
a	O
plane	B
if	O
all	O
the	O
points	O
lie	O
in	O
a	O
plane	B
,	O
and	O
pi	O
=	O
qi	O
for	O
all	O
i	O
,	O
then	O
any	O
of	O
the	O
cameras	O
may	O
be	O
moved	O
without	O
changing	O
the	O
projective	B
equivalence	O
class	O
of	O
the	O
projected	O
points	O
.	O
it	O
is	O
possible	O
to	O
choose	O
pj	O
and	O
qj	O
with	O
centres	O
at	O
any	O
two	O
preassigned	O
locations	O
in	O
such	O
a	O
way	O
that	O
pjpi	O
=	O
qjqi	O
.	O
points	O
on	O
a	O
twisted	O
cubic	O
a	O
similar	O
ambiguous	O
situation	O
arises	O
when	O
all	O
the	O
points	O
plus	O
one	O
of	O
the	O
cameras	O
,	O
say	O
p2	O
,	O
lie	O
on	O
a	O
twisted	O
cubic	O
.	O
in	O
this	O
case	O
,	O
we	O
may	O
choose	O
q0	O
=	O
p0	O
and	O
q1	O
=	O
p1	O
and	O
the	O
points	O
qi	O
=	O
pi	O
for	O
all	O
i.	O
then	O
according	O
to	O
the	O
ambiguity	B
of	O
camera	B
resectioning	I
for	O
points	O
on	O
a	O
twisted	O
cubic	O
,	O
(	O
section	O
22.1.2	O
)	O
,	O
for	O
any	O
point	B
c2	O
q	O
on	O
the	O
twisted	B
cubic	I
a	O
camera	B
matrix	I
q2	O
may	O
be	O
chosen	O
with	O
centre	O
at	O
c2	O
q	O
such	O
that	O
p2pi	O
=	O
q2qi	O
for	O
all	O
i.	O
these	O
examples	B
of	O
ambiguity	B
are	O
not	O
very	O
interesting	O
,	O
since	O
they	O
are	O
no	O
more	O
than	O
extensions	O
of	O
the	O
one-view	O
camera	B
resectioning	I
ambiguity	O
.	O
in	O
the	O
above	O
examples	B
,	O
the	O
points	O
pi	O
and	O
qi	O
are	O
the	O
same	O
in	O
each	O
case	O
,	O
and	O
the	O
ambiguity	B
lies	O
only	O
in	O
the	O
placement	O
of	O
the	O
cameras	O
with	O
respect	O
to	O
the	O
points	O
.	O
more	O
interesting	O
ambiguities	B
may	O
also	O
occur	O
,	O
as	O
we	O
consider	O
next	O
.	O
554	O
22	O
degenerate	B
conﬁgurations	I
general	O
three-view	O
ambiguity	B
suppose	O
that	O
the	O
camera	B
matrices	I
(	O
p0	O
,	O
p1	O
,	O
p2	O
)	O
and	O
(	O
q0	O
,	O
q1	O
,	O
q2	O
)	O
are	O
ﬁxed	O
,	O
and	O
we	O
wish	O
to	O
ﬁnd	O
the	O
set	O
of	O
all	O
points	O
such	O
that	O
pip	O
=	O
qiq	O
for	O
i	O
=	O
0	O
,	O
1	O
,	O
2.	O
note	O
that	O
we	O
are	O
trying	O
here	O
to	O
copy	O
the	O
two-view	O
case	O
in	O
which	O
both	O
sets	O
of	B
camera	I
matrices	O
are	O
chosen	O
in	O
advance	O
.	O
later	O
,	O
we	O
will	O
turn	O
to	O
the	O
less	O
restricted	O
case	O
in	O
which	O
just	O
one	O
set	O
of	O
cameras	O
is	O
chosen	O
in	O
advance	O
.	O
a	O
simple	O
observation	O
is	O
that	O
a	O
critical	O
conﬁguration	O
for	B
three	I
views	I
is	O
also	O
a	O
critical	B
set	I
for	O
each	O
of	O
the	O
pairs	O
of	O
views	O
.	O
thus	O
one	O
is	O
led	O
naturally	O
to	O
assume	O
that	O
the	O
set	O
of	B
points	I
for	O
which	O
{	O
p0	O
,	O
p1	O
,	O
p2	O
,	O
pi	O
}	O
is	O
a	O
critical	O
conﬁguration	O
is	O
simply	O
the	O
intersection	B
of	O
the	O
point	B
sets	O
for	O
which	O
each	O
of	O
{	O
p0	O
,	O
p1	O
,	O
pi	O
}	O
,	O
{	O
p1	O
,	O
p2	O
,	O
pi	O
}	O
and	O
{	O
p0	O
,	O
p2	O
,	O
pi	O
}	O
is	O
a	O
critical	O
conﬁguration	O
.	O
since	O
by	O
lemma	O
22.10	O
(	O
p542	O
)	O
each	O
of	O
these	O
point	B
sets	O
is	O
a	O
ruled	B
quadric	O
,	O
one	O
is	O
led	O
to	O
assume	O
that	O
the	O
critical	O
point	O
set	O
in	O
the	O
three-view	O
case	O
is	O
simply	O
an	O
in-	O
tersection	O
of	O
three	O
quadrics	B
.	O
although	O
this	O
is	O
not	O
far	O
from	O
the	O
truth	O
,	O
the	O
reasoning	O
is	O
somewhat	O
fuzzy	O
.	O
the	O
crucial	O
point	B
missing	O
in	O
this	O
argument	O
is	O
that	O
the	O
corresponding	O
conjugate	O
points	O
may	O
not	O
be	O
the	O
same	O
for	O
each	O
of	O
the	O
three	O
pairs	O
.	O
more	O
precisely	O
,	O
corresponding	O
to	O
the	O
critical	O
conﬁguration	O
{	O
p0	O
,	O
p1	O
,	O
pi	O
}	O
,	O
there	O
exists	O
a	O
conjugate	O
conﬁguration	O
{	O
q0	O
,	O
q1	O
,	O
q01	O
}	O
for	O
which	O
pjpi	O
=	O
qjq01	O
for	O
j	O
=	O
0	O
,	O
1.	O
simi-	O
larly	O
,	O
for	O
the	O
critical	O
conﬁguration	O
{	O
p0	O
,	O
p2	O
,	O
pi	O
}	O
,	O
there	O
exists	O
a	O
conjugate	O
conﬁguration	O
{	O
q0	O
,	O
q2	O
,	O
q02	O
}	O
for	O
which	O
pjpi	O
=	O
qjq02	O
i	O
are	O
not	O
necessarily	O
the	O
same	O
as	O
q01	O
,	O
so	O
we	O
can	O
not	O
conclude	O
that	O
there	O
exist	O
points	O
qi	O
such	O
that	O
i	O
pjpi	O
=	O
qjqi	O
for	O
all	O
i	O
and	O
j	O
=	O
0	O
,	O
1	O
,	O
2	O
–	O
at	O
least	O
not	O
immediately	O
.	O
for	O
j	O
=	O
0	O
,	O
2.	O
however	O
,	O
the	O
points	O
q02	O
i	O
i	O
i	O
i	O
we	O
now	O
consider	O
this	O
a	O
little	O
more	O
closely	O
.	O
considering	O
just	O
the	O
ﬁrst	O
pairs	O
of	O
cameras	O
(	O
p0	O
,	O
p1	O
)	O
and	O
(	O
q0	O
,	O
q1	O
)	O
,	O
lemma	O
22.10	O
(	O
p542	O
)	O
tells	O
us	O
that	O
if	O
p	O
and	O
q	O
are	O
points	O
such	O
that	O
pjp	O
=	O
qjq	O
,	O
then	O
p	O
must	O
lie	O
on	O
a	O
quadric	O
surface	O
s01	O
p	O
determined	O
by	O
these	O
camera	B
matrices	I
.	O
similarly	O
,	O
point	B
q	O
lies	O
on	O
a	O
quadric	O
s01	O
q	O
.	O
likewise	O
considering	O
the	O
camera	B
pairs	O
(	O
p0	O
,	O
p2	O
)	O
and	O
(	O
q0	O
,	O
q2	O
)	O
one	O
ﬁnds	O
that	O
the	O
point	B
p	O
must	O
lie	O
on	O
a	O
second	O
quadric	O
s02	O
p	O
deﬁned	O
by	O
these	O
two	O
camera	O
pairs	O
.	O
similarly	O
,	O
there	O
exists	O
a	O
further	O
quadric	O
deﬁned	O
by	O
the	O
camera	B
pairs	O
(	O
p1	O
,	O
p2	O
)	O
and	O
(	O
q1	O
,	O
q2	O
)	O
on	O
which	O
the	O
point	B
p	O
must	O
lie	O
.	O
thus	O
for	O
points	O
p	O
and	O
q	O
to	O
exist	O
such	O
that	O
pjp	O
=	O
qjq	O
for	O
j	O
=	O
0	O
,	O
1	O
,	O
2	O
it	O
is	O
necessary	O
that	O
p	O
lie	O
on	O
the	O
intersection	B
of	O
the	O
three	O
quadrics	B
:	O
p	O
∈	O
s01	O
p	O
.	O
it	O
will	O
now	O
be	O
seen	O
that	O
this	O
is	O
almost	O
a	O
necessary	O
and	O
sufﬁcient	O
condition	O
.	O
p	O
∩	O
s02	O
p	O
∩	O
s12	O
result	O
22.28.	O
let	O
(	O
p0	O
,	O
p1	O
,	O
p2	O
)	O
and	O
(	O
q0	O
,	O
q1	O
,	O
q2	O
)	O
be	O
two	O
triplets	O
of	B
camera	I
matrices	O
and	O
assume	O
p0	O
=	O
q0	O
.	O
for	O
each	O
of	O
the	O
pairs	O
(	O
i	O
,	O
j	O
)	O
=	O
(	O
0	O
,	O
1	O
)	O
,	O
(	O
0	O
,	O
2	O
)	O
and	O
(	O
1	O
,	O
2	O
)	O
,	O
let	O
sij	O
p	O
and	O
sij	O
q	O
be	O
the	O
ruled	B
quadric	O
critical	O
surfaces	O
deﬁned	O
for	O
camera	B
matrix	I
pairs	O
(	O
pi	O
,	O
pj	O
)	O
and	O
(	O
qi	O
,	O
qj	O
)	O
as	O
in	O
lemma	O
22.10	O
(	O
p542	O
)	O
.	O
p	O
∩	O
s02	O
p	O
∩	O
s12	O
lie	O
on	O
the	O
intersection	B
s01	O
q	O
∩	O
s02	O
(	O
iii	O
)	O
conversely	O
,	O
if	O
p	O
is	O
a	O
point	B
lying	O
on	O
the	O
intersection	B
of	O
quadrics	B
s01	O
q	O
and	O
c2	O
(	O
ii	O
)	O
if	O
there	O
exist	O
points	O
p	O
and	O
q	O
such	O
that	O
pip	O
=	O
qiq	O
for	O
all	O
i	O
=	O
0	O
,	O
1	O
,	O
2	O
,	O
then	O
p	O
must	O
q	O
∩	O
s12	O
q	O
.	O
p	O
∩	O
s02	O
p	O
∩	O
s12	O
p	O
,	O
q	O
,	O
then	O
there	O
q	O
such	O
that	O
pip	O
=	O
qiq	O
for	O
all	O
i	O
=	O
0	O
,	O
1	O
,	O
2.	O
but	O
not	O
on	O
a	O
plane	O
containing	O
the	O
three	O
camera	B
centres	O
c0	O
exists	O
a	O
point	B
q	O
lying	O
on	O
s01	O
p	O
and	O
q	O
must	O
lie	O
on	O
s01	O
p	O
∩	O
s02	O
p	O
∩	O
s12	O
q	O
∩	O
s02	O
q	O
∩	O
s12	O
q	O
,	O
c1	O
(	O
i	O
)	O
the	O
centre	B
of	O
camera	B
p0	O
lies	O
on	O
s01	O
p	O
,	O
p1	O
lies	O
on	O
s01	O
p	O
,	O
and	O
p2	O
lies	O
on	O
p	O
∩	O
s02	O
p	O
.	O
s12	O
22.4	O
three-view	O
critical	B
conﬁgurations	I
555	O
note	O
that	O
the	O
condition	O
that	O
p0	O
=	O
q0	O
is	O
not	O
any	O
restriction	O
of	O
generality	O
,	O
since	O
the	O
pro-	O
jective	O
frames	O
for	O
the	O
two	O
conﬁgurations	O
(	O
p0	O
,	O
p1	O
,	O
p2	O
)	O
and	O
(	O
q0	O
,	O
q1	O
,	O
q2	O
)	O
are	O
independent	O
.	O
one	O
may	O
easily	O
choose	O
a	O
projective	B
frame	O
for	O
the	O
second	O
conﬁguration	O
in	O
which	O
this	O
condition	O
is	O
true	O
.	O
this	O
assumption	O
is	O
made	O
simply	O
so	O
that	O
one	O
may	O
consider	O
the	O
point	B
p	O
in	O
relation	O
to	O
the	O
projective	B
frame	O
of	O
the	O
second	O
set	O
of	O
cameras	O
.	O
the	O
extra	O
condition	O
that	O
the	O
point	B
p	O
does	O
not	O
lie	O
on	O
the	O
plane	B
of	O
camera	B
centres	O
ci	O
q	O
is	O
necessary	O
,	O
however	O
the	O
reader	O
is	O
referred	O
to	O
[	O
hartley-00b	O
]	O
for	O
justiﬁcation	O
of	O
this	O
claim	O
.	O
note	O
that	O
this	O
case	O
will	O
usually	O
not	O
arise	O
,	O
however	O
,	O
since	O
the	O
intersection	B
point	O
of	O
the	O
three	O
quadrics	B
with	O
the	O
trifocal	B
plane	O
will	O
be	O
empty	O
,	O
or	O
in	O
special	O
cases	O
consist	O
of	O
a	O
ﬁnite	O
number	O
of	O
points	O
.	O
where	O
it	O
does	O
arise	O
is	O
through	O
the	O
possibility	O
that	O
the	O
three	O
camera	B
centres	O
c0	O
q	O
are	O
collinear	O
,	O
in	O
which	O
case	O
any	O
other	O
point	B
is	O
coplanar	O
with	O
these	O
three	O
camera	B
centres	O
.	O
q	O
and	O
c2	O
q	O
,	O
c1	O
proof	O
.	O
the	O
ﬁrst	O
statement	O
follows	O
directly	O
from	O
lemma	O
22.10	O
(	O
p542	O
)	O
.	O
for	O
the	O
second	O
part	O
,	O
the	O
fact	O
that	O
the	O
points	O
p	O
and	O
q	O
lie	O
on	O
the	O
intersections	O
of	O
the	O
three	O
quadrics	B
follows	O
(	O
as	O
pointed	O
out	O
before	O
the	O
statement	O
of	O
the	O
theorem	O
)	O
from	O
lemma	O
22.10	O
(	O
p542	O
)	O
applied	O
to	O
each	O
pair	O
of	O
cameras	O
in	O
turn	O
.	O
to	O
prove	O
the	O
ﬁnal	O
assertion	O
,	O
suppose	O
that	O
p	O
lies	O
on	O
the	O
intersection	B
of	O
the	O
three	O
quadrics	B
.	O
then	O
from	O
lemma	O
22.10	O
(	O
p542	O
)	O
,	O
applied	O
to	O
each	O
of	O
the	O
three	O
quadrics	B
sij	O
p	O
,	O
there	O
exist	O
points	O
qij	O
such	O
that	O
the	O
following	O
conditions	O
hold	O
:	O
p0p	O
=	O
q0q01	O
p0p	O
=	O
q0q02	O
p1p	O
=	O
q1q12	O
p1p	O
=	O
q1q01	O
p2p	O
=	O
q2q02	O
p2p	O
=	O
q2q12	O
.	O
it	O
is	O
easy	O
to	O
be	O
confused	O
by	O
the	O
superscripts	O
here	O
,	O
but	O
the	O
main	O
point	B
is	O
that	O
each	O
line	B
is	O
precisely	O
the	O
result	O
of	O
lemma	O
22.10	O
(	O
p542	O
)	O
applied	O
to	O
one	O
of	O
the	O
three	O
pairs	O
of	B
camera	I
matrices	O
at	O
a	O
time	O
.	O
these	O
equations	O
may	O
be	O
rearranged	O
as	O
p0p	O
=	O
q0q01	O
=	O
q0q02	O
p1p	O
=	O
q1q01	O
=	O
q1q12	O
p2p	O
=	O
q2q02	O
=	O
q2q12	O
.	O
now	O
,	O
the	O
condition	O
that	O
q1q01	O
=	O
q1q12	O
means	O
that	O
the	O
points	O
q01	O
and	O
q12	O
are	O
collinear	O
with	O
the	O
camera	B
centre	I
c1	O
q	O
of	O
q1	O
.	O
thus	O
,	O
assuming	O
that	O
the	O
points	O
qij	O
are	O
distinct	O
,	O
they	O
must	O
lie	O
in	O
a	O
conﬁguration	O
as	O
shown	O
in	O
ﬁgure	O
22.7.	O
one	O
sees	O
from	O
the	O
diagram	O
that	O
if	O
two	O
of	O
the	O
points	O
are	O
the	O
same	O
,	O
then	O
the	O
third	O
one	O
is	O
the	O
same	O
as	O
the	O
other	O
two	O
.	O
if	O
the	O
three	O
points	O
are	O
distinct	O
,	O
then	O
the	O
three	O
points	O
qij	O
and	O
the	O
three	O
camera	B
centres	O
ci	O
q	O
are	O
coplanar	O
,	O
since	O
they	O
all	O
lie	O
in	O
the	O
plane	B
deﬁned	O
by	O
q01	O
and	O
the	O
line	B
joining	O
q02	O
to	O
q12	O
.	O
thus	O
the	O
three	O
points	O
all	O
lie	O
in	O
the	O
plane	B
of	O
the	O
camera	B
centres	O
ci	O
q.	O
however	O
,	O
since	O
p0p	O
=	O
q0q01	O
=	O
q0q02	O
it	O
follows	O
that	O
p	O
must	O
lie	O
along	O
the	O
same	O
line	O
as	O
q01	O
and	O
q02	O
,	O
and	O
hence	O
must	O
lie	O
in	O
the	O
same	O
plane	O
as	O
the	O
camera	B
centres	O
ci	O
q.	O
thus	O
,	O
this	O
result	O
shows	O
that	O
the	O
points	O
in	O
a	O
3-view	O
critical	O
conﬁguration	O
lie	O
on	O
the	O
intersection	B
of	O
three	O
quadrics	B
,	O
whereas	O
the	O
camera	B
centres	O
lie	O
on	O
the	O
intersections	O
of	O
556	O
22	O
degenerate	B
conﬁgurations	I
p	O
0	O
q	O
0=	O
q1	O
q	O
12	O
q	O
01	O
q	O
02	O
p	O
q	O
2	O
fig	O
.	O
22.7.	O
conﬁguration	O
of	O
the	O
three	O
camera	B
centres	O
and	O
the	O
three	O
ambiguous	O
points	O
.	O
if	O
the	O
three	O
points	O
qij	O
are	O
distinct	O
,	O
then	O
they	O
all	O
lie	O
in	O
the	O
plane	B
of	O
the	O
camera	B
centres	O
ci	O
q.	O
pairs	O
of	O
the	O
quadrics	O
.	O
in	O
general	O
,	O
the	O
intersection	B
of	O
three	O
quadrics	B
will	O
consist	O
of	O
eight	O
points	O
.	O
in	O
this	O
case	O
,	O
the	O
critical	B
set	I
with	O
respect	O
to	O
the	O
two	O
triplets	O
of	B
camera	I
matrices	O
will	O
consist	O
of	O
these	O
eight	O
points	O
,	O
less	O
any	O
such	O
points	O
that	O
lie	O
on	O
the	O
plane	B
of	O
the	O
three	O
cameras	B
qi	O
.	O
in	O
fact	O
,	O
it	O
has	O
been	O
shown	O
(	O
in	O
a	O
longer	O
unpublished	O
version	O
of	O
[	O
maybank-98	O
]	O
)	O
that	O
of	O
the	O
eight	O
points	O
of	O
intersection	B
of	O
three	O
quadrics	B
,	O
only	O
seven	O
are	O
critical	O
,	O
since	O
the	O
eighth	O
point	B
lies	O
on	O
the	O
plane	B
of	O
the	O
three	O
cameras	B
.	O
p	O
=	O
αs01	O
p	O
p	O
=	O
0	O
and	O
pts02	O
p	O
+	O
βs02	O
p	O
p	O
=	O
0	O
will	O
also	O
satisfy	O
pts12	O
in	O
some	O
cases	O
,	O
however	O
,	O
the	O
camera	B
matrices	I
may	O
be	O
chosen	O
such	O
that	O
the	O
three	O
quadric	O
surfaces	O
meet	O
in	O
a	O
curve	O
.	O
this	O
will	O
occur	O
if	O
the	O
three	O
quadrics	B
sij	O
p	O
are	O
lin-	O
p	O
,	O
then	O
any	O
point	B
p	O
that	O
satisﬁes	O
early	O
dependent	O
.	O
for	O
instance	O
if	O
s12	O
pts01	O
p	O
p	O
=	O
0.	O
thus	O
the	O
intersection	B
of	O
the	O
three	O
quadrics	B
is	O
the	O
same	O
as	O
the	O
intersection	B
of	O
two	O
of	O
them	O
.	O
in	O
this	O
case	O
,	O
the	O
three	O
cameras	B
must	O
also	O
lie	O
on	O
the	O
same	O
intersection	O
curve	O
.	O
we	O
deﬁne	O
a	O
non-degenerate	O
ellip-	O
tic	O
quartic	B
to	O
be	O
the	O
intersection	B
curve	O
of	O
two	O
non-degenerate	O
ruled	B
quadrics	O
,	O
consisting	O
of	O
a	O
single	O
curve	O
.	O
this	O
is	O
a	O
fourth-degree	O
space	B
curve	I
.	O
other	O
ways	O
that	O
two	O
quadrics	O
can	O
intersect	O
include	O
a	O
twisted-cubic	O
plus	O
a	O
line	B
,	O
or	O
two	O
conics	O
.	O
examples	B
of	O
elliptic	O
quartics	O
are	O
shown	O
in	O
ﬁgure	O
22.8.	O
example	O
22.29.	O
three-view	O
critical	O
conﬁguration	O
–	O
the	O
elliptic	B
quartic	I
.	O
we	O
consider	O
the	O
quadrics	B
represented	O
by	O
matrices	O
a	O
and	O
b	O
=	O
˜b	O
+	O
˜bt	O
−s	O
−	O
u	O
−s	O
+	O
u	O
s	O
−	O
t	O
s	O
+	O
t	O
	O
and	O
˜b	O
=	O
	O
0	O
1	O
	O
p	O
q	O
a	O
=	O
0	O
r	O
0	O
0	O
−p	O
−	O
q	O
−	O
r	O
0	O
0	O
0	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
−1	O
0	O
0	O
0	O
0	O
−1	O
0	O
,	O
where	O
	O
.	O
(	O
22.5	O
)	O
thus	O
,	O
b	O
is	O
a	O
member	O
of	O
a	O
5-parameter	O
family	O
of	B
quadrics	I
generated	O
by	O
{	O
p	O
,	O
q	O
,	O
r	O
,	O
s	O
,	O
t	O
,	O
u	O
}	O
,	O
(	O
remembering	O
that	O
scale	O
is	O
irrelevant	O
)	O
.	O
the	O
camera	B
matrices	I
p0	O
=	O
[	O
i|	O
0	O
]	O
,	O
p1	O
=	O
[	O
i	O
|	O
(	O
−1	O
,	O
−1	O
,	O
−1	O
)	O
t	O
]	O
and	O
p2	O
=	O
[	O
i	O
|	O
(	O
1	O
,	O
1	O
,	O
−1	O
)	O
t	O
]	O
have	O
centres	O
lying	O
on	O
the	O
intersection	B
of	O
these	O
three	O
quadrics	B
.	O
we	O
show	O
that	O
a	O
conﬁguration	O
consisting	O
of	O
these	O
three	O
cameras	B
,	O
and	O
any	O
number	O
of	O
points	O
on	O
the	O
intersection	B
of	O
the	O
two	O
quadrics	O
is	O
critical	O
.	O
this	O
is	O
demonstrated	O
by	O
explicitly	O
exhibiting	O
two	O
alternative	O
conﬁgurations	O
consisting	O
of	O
three	O
cameras	B
qi	O
and	O
for	O
each	O
point	B
p	O
lying	O
on	O
the	O
intersection	B
of	O
the	O
two	O
quadrics	O
,	O
a	O
conjugate	O
point	O
q	O
such	O
22.4	O
three-view	O
critical	B
conﬁgurations	I
557	O
4	O
3	O
2	O
1	O
0	O
6	O
5	O
4	O
3	O
2	O
1	O
0	O
−1	O
−2	O
−3	O
−1	O
−1	O
−0.5	O
0	O
0.5	O
1	O
1.5	O
2	O
−4	O
−2	O
−3	O
1	O
0	O
−1	O
−15	O
−10	O
−5	O
0	O
5	O
4	O
2	O
0	O
−2	O
−4	O
−6	O
−8	O
−10	O
−12	O
−14	O
1.5	O
1	O
0.5	O
0	O
−0.5	O
−1	O
−1.5	O
2	O
5	O
0	O
−5	O
−8	O
−6	O
2	O
0	O
−4	O
−2	O
0	O
2	O
0	O
1	O
2	O
4	O
6	O
3	O
−2	O
−1	O
1.5	O
1	O
0.5	O
0	O
−0.5	O
−1	O
−1.5	O
−2	O
−2	O
fig	O
.	O
22.8.	O
examples	B
of	O
elliptic	B
quartic	I
curves	O
generated	O
as	O
the	O
intersection	B
of	O
two	O
ruled	O
quadrics	B
.	O
that	O
pip	O
=	O
qiq	O
.	O
in	O
fact	O
,	O
two	O
different	O
conjugate	O
conﬁgurations	O
are	O
given	O
in	O
table	O
22.1	O
and	O
table	O
22.2.	O
it	O
may	O
be	O
veriﬁed	O
directly	O
that	O
pip	O
=	O
qiq	O
for	O
all	O
points	O
p	O
=	O
(	O
x	O
,	O
y	O
,	O
xy	O
,	O
1	O
)	O
t	O
and	O
corresponding	O
points	O
q	O
,	O
provided	O
that	O
p	O
lies	O
on	O
the	O
quadric	O
b	O
.	O
(	O
it	O
always	O
lies	O
on	O
quadric	O
a	O
)	O
.	O
the	O
easiest	O
way	O
to	O
see	O
this	O
is	O
to	O
verify	O
that	O
(	O
pip	O
)	O
×	O
(	O
qiq	O
)	O
=	O
0	O
for	O
all	O
such	O
points	O
.	O
in	O
fact	O
for	O
i	O
=	O
0	O
,	O
1	O
,	O
the	O
cross-product	O
is	O
always	O
zero	O
,	O
whereas	O
for	O
i	O
=	O
2	O
it	O
may	O
be	O
veriﬁed	O
by	O
direct	O
computation	O
that	O
(	O
p2p	O
)	O
×	O
(	O
q2q	O
)	O
=	O
for	O
the	O
ﬁrst	O
solution	B
,	O
and	O
(	O
p2p	O
)	O
×	O
(	O
q2q	O
)	O
=	O
ptbp	O
ptbp	O
(	O
4	O
,	O
−4x	O
,	O
4	O
)	O
t	O
(	O
−4y	O
,	O
4	O
,	O
4	O
)	O
t	O
(	O
cid:15	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:16	O
)	O
(	O
cid:2	O
)	O
for	O
the	O
second	O
solution	B
.	O
thus	O
p2p	O
=	O
q2q	O
if	O
and	O
only	O
if	O
p	O
lies	O
on	O
b.	O
and	O
b	O
(	O
cid:2	O
)	O
note	O
that	O
in	O
this	O
example	O
,	O
a	O
is	O
the	O
matrix	B
representing	O
the	O
quadric	O
s01	O
p	O
.	O
this	O
example	O
is	O
quite	O
general	O
,	O
since	O
if	O
a	O
(	O
cid:2	O
)	O
are	O
two	O
non-degenerate	O
ruled	B
quadrics	O
containing	O
the	O
centres	O
of	O
three	O
cameras	B
,	O
then	O
by	O
a	O
projective	B
transformation	I
,	O
we	O
may	O
map	O
a	O
(	O
cid:2	O
)	O
to	O
a	O
and	O
the	O
three	O
camera	B
centres	O
to	O
those	O
of	O
the	O
given	O
pi	O
,	O
provided	O
only	O
that	O
no	O
two	O
of	O
the	O
camera	O
centres	O
lie	O
on	O
the	O
same	O
generator	O
of	O
a	O
(	O
cid:2	O
)	O
.	O
in	O
addition	O
,	O
b	O
(	O
cid:2	O
)	O
will	O
map	O
to	O
a	O
+	O
λb	O
for	O
some	O
λ.	O
thus	O
,	O
the	O
pencil	O
generated	O
by	O
a	O
(	O
cid:2	O
)	O
and	O
b	O
(	O
cid:2	O
)	O
,	O
and	O
hence	O
also	O
their	O
intersection	B
curve	O
,	O
are	O
projectively	O
equivalent	B
to	O
those	O
generated	O
by	O
a	O
and	O
b.	O
the	O
possibility	O
that	O
two	O
of	O
the	O
camera	B
centres	O
lie	O
on	O
the	O
same	O
generator	O
of	O
a	O
(	O
cid:2	O
)	O
is	O
not	O
a	O
difﬁculty	O
,	O
since	O
if	O
the	O
line	B
of	O
the	O
camera	B
centres	O
lies	O
on	O
all	O
quadrics	B
in	O
the	O
pencil	O
,	O
then	O
the	O
quadric	O
intersection	O
can	O
not	O
be	O
an	O
non-degenerate	O
elliptic	B
quartic	I
.	O
otherwise	O
,	O
22	O
degenerate	B
conﬁgurations	I
(	O
cid:18	O
)	O
1	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
,	O
q1	O
=	O
(	O
cid:17	O
)	O
−4	O
0	O
0	O
(	O
cid:18	O
)	O
0	O
2	O
0	O
0	O
0	O
1	O
0	O
−2	O
1	O
558	O
the	O
camera	B
matrices	I
are	O
(	O
cid:17	O
)	O
q0	O
=	O
and	O
q2	O
=	O
(	O
cid:17	O
)	O
−4	O
(	O
2p	O
+	O
q	O
−	O
t	O
+	O
u	O
)	O
0	O
8p	O
8	O
(	O
r	O
+	O
s	O
−	O
u	O
)	O
8r	O
−8r	O
4	O
(	O
p	O
+	O
q	O
+	O
2r	O
+	O
s	O
+	O
t	O
)	O
−2	O
(	O
p	O
+	O
q	O
−	O
s	O
−	O
t	O
)	O
−2	O
(	O
2p	O
+	O
q	O
−	O
2s	O
+	O
3t	O
+	O
3u	O
)	O
2p	O
+	O
q	O
−	O
2s	O
−	O
t	O
−	O
u	O
−2	O
(	O
q	O
−	O
t	O
+	O
u	O
)	O
−q	O
+	O
t	O
−	O
u	O
the	O
conjugate	O
point	O
to	O
p	O
=	O
(	O
x	O
,	O
y	O
,	O
xy	O
,	O
1	O
)	O
t	O
is	O
q	O
=	O
(	O
(	O
x	O
−	O
1	O
)	O
x	O
,	O
(	O
x	O
−	O
1	O
)	O
y	O
,	O
(	O
x	O
−	O
1	O
)	O
xy	O
,	O
−2x	O
(	O
−2	O
+	O
y	O
+	O
xy	O
)	O
)	O
t	O
.	O
table	O
22.1.	O
first	O
conjugate	O
solution	O
to	O
reconstruction	O
problem	O
for	O
cameras	B
pi	O
and	O
points	O
on	O
the	O
inter-	O
section	O
of	B
quadrics	I
a	O
and	O
b	O
given	O
in	O
(	O
22.5	O
)	O
.	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
0	O
0	O
0	O
1	O
0	O
,	O
q1	O
=	O
0	O
0−	O
2	O
1	O
0	O
0	O
4	O
0	O
0	O
1	O
0	O
2	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
(	O
cid:18	O
)	O
the	O
camera	B
matrices	I
are	O
q0	O
=	O
and	O
q2	O
=	O
(	O
cid:17	O
)	O
−8	O
(	O
p	O
+	O
s	O
+	O
u	O
)	O
−8p	O
8p	O
4	O
(	O
q	O
+	O
2r	O
+	O
t	O
−	O
u	O
)	O
−4	O
(	O
2p	O
+	O
q	O
+	O
r	O
+	O
s	O
−	O
t	O
)	O
2	O
(	O
q	O
+	O
2r	O
−	O
2s	O
−	O
3t	O
−	O
3u	O
)	O
0	O
−8r	O
2	O
(	O
q	O
+	O
t	O
−	O
u	O
)	O
−q	O
−	O
t	O
+	O
u	O
−2	O
(	O
q	O
+	O
r	O
−	O
s	O
+	O
t	O
)	O
q	O
+	O
2r	O
−	O
2s	O
+	O
t	O
+	O
u	O
the	O
conjugate	O
point	O
to	O
p	O
=	O
(	O
x	O
,	O
y	O
,	O
xy	O
,	O
1	O
)	O
t	O
is	O
q	O
=	O
(	O
(	O
y	O
−	O
1	O
)	O
x	O
,	O
(	O
y	O
−	O
1	O
)	O
y	O
,	O
(	O
y	O
−	O
1	O
)	O
xy	O
,	O
2y	O
(	O
−2	O
+	O
x	O
+	O
xy	O
)	O
)	O
t	O
.	O
table	O
22.2.	O
second	O
conjugate	O
solution	O
to	O
reconstruction	O
problem	O
.	O
we	O
can	O
choose	O
a	O
(	O
cid:2	O
)	O
centres	O
.	O
this	O
demonstrates	O
to	O
be	O
one	O
of	O
the	O
quadrics	O
not	O
containing	O
the	O
line	B
of	O
the	O
two	O
camera	O
result	O
22.30.	O
any	O
conﬁguration	O
consisting	O
of	O
three	O
cameras	B
and	O
any	O
number	O
of	O
points	O
lying	O
on	O
a	O
non-degenerate	O
elliptic	B
quartic	I
is	O
critical	O
.	O
22.5	O
closure	O
22.5.1	O
the	O
literature	O
the	O
twisted	B
cubic	I
as	O
the	O
critical	O
curve	O
for	B
camera	I
resectioning	I
was	O
brought	O
to	O
the	O
atten-	O
tion	O
of	O
the	O
computer-vision	O
community	O
by	O
[	O
buchanan-88	O
]	O
.	O
for	O
more	O
about	O
critical	O
sets	O
of	O
two	O
views	O
,	O
the	O
reader	O
is	O
referred	O
to	O
[	O
maybank-90	O
]	O
and	O
the	O
book	O
[	O
maybank-93	O
]	O
.	O
in	O
both	O
these	O
cases	O
,	O
the	O
critical	O
point	O
sets	O
were	O
known	O
much	O
earlier	O
.	O
in	O
fact	O
[	O
buchanan-88	O
]	O
refers	O
the	O
reader	O
to	O
the	O
german	O
photogrammetric	O
literature	O
[	O
krames-42	O
,	O
rinner-72	O
]	O
.	O
for	O
two	O
views	O
,	O
the	O
result	O
that	O
(	O
v	O
)	O
and	O
(	O
viii	O
)	O
are	O
not	O
critical	O
in	O
theorem	O
22.9	O
(	O
p541	O
)	O
is	O
due	O
to	O
fredrik	O
kahl	O
(	O
unpublished	O
)	O
.	O
22.5	O
closure	O
559	O
the	O
discussion	O
of	O
critical	O
conﬁgurations	O
for	B
three	I
views	I
given	O
in	O
this	O
chapter	O
is	O
only	O
a	O
part	O
of	O
what	O
is	O
known	O
about	O
this	O
topic	O
.	O
more	O
can	O
be	O
found	O
in	O
[	O
hartley-00b	O
,	O
hartley-02a	O
,	O
kahl-01a	O
]	O
.	O
in	O
particular	O
,	O
the	O
elliptic-quartic	O
conﬁguration	O
is	O
extended	O
to	O
any	O
number	O
of	O
cameras	O
in	O
[	O
kahl-01a	O
]	O
.	O
a	O
critical	O
conﬁguration	O
for	O
any	O
number	O
of	O
cameras	O
,	O
consisting	O
of	B
points	I
on	O
a	O
twisted	B
cubic	I
and	O
cameras	B
on	O
a	O
straight	O
line	B
is	O
considered	O
in	O
[	O
hartley-03	O
]	O
.	O
earlier	O
work	O
on	O
this	O
area	O
includes	O
an	O
investigation	O
of	O
the	O
critical	O
camera	B
positions	O
for	O
sets	O
of	O
six	O
points	O
in	O
[	O
maybank-98	O
]	O
,	O
and	O
an	O
unpublished	O
report	O
[	O
shashua-96	O
]	O
deals	O
with	O
critical	O
conﬁgurations	O
in	O
three	O
views	O
.	O
nothing	O
has	O
been	O
said	O
here	O
about	O
critical	B
conﬁgurations	I
of	O
lines	B
in	O
three	O
or	O
more	O
views	O
,	O
but	O
this	O
topic	O
has	O
been	O
treated	O
in	O
[	O
buchanan-92	O
]	O
.	O
in	O
addition	O
,	O
critical	O
conﬁgura-	O
tion	O
for	O
linear	O
reconstruction	B
from	O
lines	B
(	O
the	O
linear	B
line	O
complex	O
)	O
have	O
been	O
identiﬁed	O
in	O
[	O
stein-99	O
]	O
.	O
22.5.2	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
fill	O
out	O
the	O
details	O
of	O
the	O
following	O
sketch	O
to	O
prove	O
that	O
any	O
two	O
conﬁgurations	O
consisting	O
of	O
a	O
hyperboloid	O
of	O
one	O
sheet	O
and	O
two	O
points	O
on	O
the	O
hyperboloid	B
are	O
projectively	O
equivalent	B
(	O
via	O
a	O
projectivity	B
of	O
ip3	O
)	O
provided	O
that	O
the	O
points	O
in	O
both	O
pairs	O
either	O
do	O
or	O
do	O
not	O
lie	O
on	O
the	O
same	O
generator	O
.	O
since	O
any	O
hyperboloid	B
of	O
one	O
sheet	O
is	O
projectively	O
equivalent	B
to	O
x2	O
+	O
y2	O
−	O
z2	O
=	O
1	O
,	O
any	O
two	O
hyperboloids	O
of	O
one	O
sheet	O
are	O
projectively	O
equivalent	B
to	O
each	O
other	O
,	O
and	O
also	O
to	O
the	O
hyperboloid	B
given	O
by	O
z	O
=	O
xy	O
.	O
deﬁne	O
a	O
1d	O
projective	B
transformation	I
hx	O
(	O
x	O
)	O
=	O
x	O
=	O
(	O
ax	O
+	O
b	O
)	O
/	O
(	O
cx	O
+	O
d	O
)	O
.	O
one	O
computes	O
that	O
(	O
cid:2	O
)	O
	O
a	O
c	O
	O
	O
x	O
y	O
xy	O
1	O
d	O
c	O
b	O
a	O
b	O
d	O
	O
=	O
	O
x	O
(	O
cid:2	O
)	O
y	O
(	O
cid:2	O
)	O
y	O
x	O
1	O
	O
.	O
this	O
is	O
a	O
3d	O
projective	B
transformation	I
taking	O
the	O
surface	O
z	O
=	O
xy	O
to	O
itself	O
.	O
composing	O
this	O
with	O
a	O
similar	O
transformation	B
of	O
y	O
one	O
ﬁnds	O
a	O
projective	B
trans-	O
formation	O
that	O
takes	O
(	O
x	O
,	O
y	O
,	O
xy	O
,	O
1	O
)	O
t	O
to	O
(	O
x	O
,	O
1	O
)	O
t	O
while	O
ﬁxing	O
the	O
quadric	O
z	O
=	O
xy	O
.	O
since	O
hx	O
and	O
hy	O
are	O
arbitrary	O
1d	O
projective	B
transformations	O
,	O
this	O
gives	O
enough	O
freedom	O
to	O
map	O
any	O
two	O
points	O
to	O
two	O
others	O
.	O
,	O
y	O
,	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
y	O
(	O
ii	O
)	O
show	O
that	O
γ	O
maps	O
a	O
line	B
that	O
meets	O
one	O
of	O
the	O
edges	O
of	O
the	O
reference	O
tetrahedron	O
to	O
a	O
conic	B
.	O
(	O
iii	O
)	O
show	O
that	O
γ	O
maps	O
a	O
straight	O
line	B
meeting	O
two	O
opposite	O
edges	O
of	O
the	O
reference	O
tetrahedron	O
to	O
a	O
straight	O
line	B
meeting	O
the	O
same	O
two	O
edges	O
.	O
(	O
iv	O
)	O
how	O
are	O
these	O
conﬁgurations	O
related	O
to	O
degenerate	O
conﬁgurations	O
for	B
camera	I
resectioning	I
,	O
as	O
shown	O
in	O
ﬁgure	O
22.3	O
(	O
p538	O
)	O
.	O
(	O
v	O
)	O
two-view	O
degeneracy	B
occurs	O
when	O
all	O
points	O
and	O
the	O
two	O
cameras	O
lie	O
on	O
a	O
ruled	O
quadric	O
.	O
given	O
eight	O
points	O
on	O
the	O
corners	O
of	O
a	O
euclidean	O
cube	O
and	O
two	O
camera	O
centres	O
,	O
show	O
that	O
these	O
10	O
points	O
always	O
lie	O
on	O
a	O
quadric	O
.	O
if	O
this	O
is	O
a	O
ruled	B
quadric	O
,	O
then	O
the	O
conﬁguration	O
is	O
degenerate	B
,	O
and	O
reconstruction	B
is	O
not	O
possible	O
from	O
8	O
points	O
.	O
investigate	O
under	O
what	O
conditions	O
the	O
quadric	O
is	O
ruled	B
.	O
hint	O
:	O
560	O
22	O
degenerate	B
conﬁgurations	I
there	O
is	O
a	O
two-parameter	O
family	O
of	B
quadrics	I
passing	O
through	O
the	O
cube	O
vertices	O
.	O
what	O
does	O
this	O
two-parameter	O
family	O
look	O
like	O
?	O
(	O
vi	O
)	O
extend	O
result	O
22.30	O
by	O
showing	O
that	O
a	O
conﬁguration	O
of	O
any	O
number	O
of	O
cameras	O
and	O
points	O
lying	O
on	O
a	O
non-degenerate	O
elliptic	B
quartic	I
is	O
critical	O
.	O
this	O
does	O
not	O
require	O
complex	O
computations	O
.	O
if	O
stuck	O
,	O
refer	O
to	O
[	O
kahl-01a	O
]	O
.	O
part	O
v	O
appendices	O
portrait	O
of	O
the	O
countess	O
d	O
’	O
haussonville	O
,	O
1845	O
(	O
oil	O
on	O
canvas	O
)	O
by	O
jean-auguste-dominique	O
ingres	O
(	O
1780-1867	O
)	O
the	O
frick	O
collection	O
,	O
new	O
york	O
appendix	O
1	O
tensor	B
notation	I
since	O
tensor	B
notation	I
is	O
not	O
commonly	O
used	O
in	O
computer	O
vision	O
,	O
it	O
seems	O
appropri-	O
ate	O
to	O
give	O
a	O
brief	O
introduction	O
to	O
its	O
use	O
.	O
for	O
more	O
details	O
,	O
the	O
reader	O
is	O
referred	O
to	O
[	O
triggs-95	O
]	O
.	O
for	O
simplicity	O
,	O
these	O
concepts	O
will	O
be	O
explained	O
here	O
in	O
the	O
context	O
of	O
low-dimensional	O
projective	B
spaces	O
,	O
rather	O
than	O
in	O
their	O
full	O
generality	O
.	O
however	O
,	O
the	O
ideas	O
apply	O
in	O
arbitrary	O
dimensional	O
vector	O
spaces	O
.	O
consider	O
a	O
set	O
of	O
basis	O
vectors	O
ei	O
,	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
for	O
a	O
2-dimensional	O
projective	B
space	O
ip2	O
.	O
for	O
reasons	O
to	O
become	O
clear	O
,	O
we	O
will	O
write	O
the	O
indices	O
as	O
subscripts	O
.	O
with	O
respect	O
to	O
this	O
basis	O
,	O
a	O
point	B
in	O
ip2	O
is	O
represented	O
by	O
a	O
set	O
of	O
coordinates	O
xi	O
,	O
which	O
represents	O
i=1	O
xi	O
ei	O
.	O
we	O
write	O
the	O
coordinates	B
with	O
an	O
upper	O
index	O
,	O
as	O
shown	O
.	O
let	O
x	O
the	O
point	B
represent	O
the	O
triple	O
of	O
coordinates	O
,	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
x3	O
)	O
t.	O
(	O
cid:27	O
)	O
3	O
(	O
cid:27	O
)	O
now	O
,	O
consider	O
a	O
change	O
of	O
coordinate	O
axes	O
in	O
which	O
the	O
basis	O
vectors	O
ei	O
are	O
replaced	O
by	O
a	O
new	O
basis	O
set	O
ˆej	O
,	O
where	O
ˆej	O
=	O
ei	O
,	O
and	O
h	O
is	O
the	O
basis	O
transformation	B
matrix	O
j.	O
if	O
ˆx	O
=	O
(	O
ˆx1	O
,	O
ˆx2	O
,	O
ˆx3	O
)	O
t	O
are	O
the	O
coordinates	B
of	O
the	O
vector	O
with	O
respect	O
to	O
with	O
entries	O
h	O
i	O
the	O
new	O
basis	O
,	O
then	O
we	O
may	O
verify	O
that	O
ˆx	O
=	O
h−1x	O
.	O
thus	O
,	O
if	O
the	O
basis	O
vectors	O
transform	O
according	O
to	O
h	O
the	O
coordinates	B
of	O
points	O
transform	O
according	O
to	O
the	O
inverse	O
transforma-	O
tion	O
h−1	O
.	O
i	O
h	O
i	O
j	O
next	O
,	O
consider	O
a	O
line	B
in	O
ip2	O
represented	O
by	O
coordinates	B
l	O
with	O
respect	O
to	O
the	O
original	O
basis	O
.	O
with	O
respect	O
to	O
the	O
new	O
basis	O
,	O
it	O
may	O
be	O
veriﬁed	O
that	O
the	O
line	B
is	O
represented	O
by	O
a	O
new	O
set	O
of	O
coordinates	O
ˆl	O
=	O
htl	O
.	O
thus	O
coordinates	B
of	O
the	O
line	B
transform	O
according	O
to	O
ht	O
.	O
as	O
a	O
further	O
example	O
,	O
let	O
p	O
be	O
a	O
matrix	B
representing	O
a	O
mapping	O
between	O
projective	B
(	O
or	O
vector	O
)	O
spaces	O
.	O
if	O
g	O
and	O
h	O
represent	O
basis	O
transformations	O
in	O
the	O
domain	O
and	O
range	O
spaces	O
,	O
then	O
with	O
respect	O
to	O
the	O
new	O
bases	O
,	O
the	O
mapping	O
is	O
represented	O
by	O
a	O
new	O
matrx	O
ˆp	O
=	O
h−1pg	O
.	O
note	O
in	O
these	O
examples	B
that	O
sometimes	O
the	O
matrix	B
h	O
or	O
ht	O
is	O
used	O
in	O
the	O
transformation	B
,	O
and	O
sometimes	O
h−1	O
.	O
these	O
three	O
examples	B
of	O
coordinate	O
transformations	O
may	O
be	O
written	O
explicitly	O
as	O
fol-	O
lows	O
.	O
ˆxi	O
=	O
(	O
h	O
−1	O
)	O
i	O
j	O
xj	O
ˆli	O
=	O
h	O
j	O
i	O
lj	O
ˆp	O
i	O
j	O
=	O
(	O
h	O
−1	O
)	O
i	O
k	O
gl	O
j	O
p	O
k	O
l	O
where	O
we	O
use	O
the	O
tensor	B
summation	O
convention	O
that	O
an	O
index	O
repeated	O
in	O
upper	O
and	O
lower	O
positions	O
in	O
a	O
product	O
represents	O
summation	O
over	O
the	O
range	O
of	O
the	O
index	O
.	O
note	O
that	O
those	O
indices	O
that	O
are	O
written	O
as	O
superscripts	O
transform	O
according	O
to	O
h−1	O
,	O
whereas	O
562	O
a1.1	O
the	O
tensor	B
rst	O
563	O
those	O
that	O
are	O
written	O
as	O
subscripts	O
transform	O
as	O
h	O
(	O
or	O
g	O
)	O
.	O
note	O
that	O
there	O
is	O
no	O
distinc-	O
tion	O
in	O
tensor	O
notation	O
between	O
indices	O
that	O
are	O
transformed	O
by	O
h	O
,	O
and	O
those	O
that	O
are	O
transformed	O
by	O
ht	O
.	O
in	O
general	O
,	O
tensor	B
indices	O
will	O
transform	O
by	O
either	O
h	O
or	O
h−1	O
–	O
in	O
fact	O
this	O
is	O
the	O
characteristic	O
of	O
a	O
tensor	O
.	O
those	O
indices	O
that	O
transform	O
according	O
to	O
h	O
are	O
known	O
as	O
covariant	O
indices	O
and	O
are	O
written	O
as	O
subscripts	O
.	O
those	O
indices	O
that	O
transform	O
according	O
to	O
h−1	O
are	O
known	O
as	O
contravariant	O
indices	O
,	O
and	O
are	O
written	O
as	O
superscripts	O
.	O
the	O
number	O
of	O
indices	O
is	O
the	O
valency	O
of	O
the	O
tensor	O
.	O
the	O
sum	O
over	O
an	O
index	O
,	O
e.g	O
.	O
h	O
j	O
i	O
lj	O
,	O
is	O
referred	O
to	O
as	O
a	O
contraction	O
,	O
in	O
this	O
case	O
the	O
tensor	B
h	O
j	O
i	O
is	O
contracted	O
with	O
the	O
line	B
lj	O
.	O
the	O
tensor	B
rst	O
is	O
deﬁned	O
for	O
r	O
,	O
s	O
,	O
t	O
=	O
1	O
,	O
.	O
.	O
.	O
,3	O
as	O
follows	O
:	O
a1.1	O
the	O
tensor	B
rst	O
	O
0	O
unless	O
r	O
,	O
s	O
and	O
t	O
are	O
distinct	O
+1	O
if	O
rst	O
is	O
an	O
even	O
permutation	O
of	O
123	O
−1	O
if	O
rst	O
is	O
an	O
odd	O
permutation	O
of	O
123	O
rst	O
=	O
the	O
tensor	B
ijk	O
(	O
or	O
its	O
contravariant	O
counterpart	O
,	O
ijk	O
)	O
is	O
connected	O
with	O
the	O
cross	O
prod-	O
uct	O
of	O
two	O
vectors	O
.	O
if	O
a	O
and	O
b	O
are	O
two	O
vectors	O
,	O
and	O
c	O
=	O
a	O
×	O
b	O
is	O
their	O
cross	B
product	I
,	O
then	O
the	O
following	O
formula	O
may	O
easily	O
be	O
veriﬁed	O
.	O
ci	O
=	O
(	O
a	O
×	O
b	O
)	O
i	O
=	O
ijkajbk	O
.	O
related	O
to	O
this	O
is	O
the	O
expression	O
(	O
a4.5–p581	O
)	O
for	O
the	O
skew-symmetric	O
matrix	O
[	O
a	O
]	O
×	O
.	O
using	O
tensor	O
notation	O
one	O
writes	O
this	O
as	O
(	O
[	O
a	O
]	O
×	O
)	O
ik	O
=	O
ijkaj	O
.	O
thus	O
,	O
one	O
sees	O
that	O
if	O
a	O
is	O
a	O
contravariant	O
vector	O
,	O
then	O
[	O
a	O
]	O
×	O
is	O
a	O
matrix	B
with	O
two	O
covariant	O
indices	O
.	O
a	O
similar	O
formula	O
holds	O
for	O
[	O
v	O
]	O
×	O
where	O
v	O
is	O
covariant	O
,	O
namely	O
(	O
[	O
v	O
]	O
×	O
)	O
ik	O
=	O
ijkvj	O
.	O
finally	O
,	O
the	O
tensor	B
ijk	O
is	O
related	O
to	O
determinants	O
:	O
for	O
three	O
contravariant	O
tensors	O
ai	O
,	O
bj	O
and	O
ck	O
,	O
one	O
veriﬁes	O
that	O
aibjckijk	O
is	O
the	O
determinant	O
of	O
the	O
3	O
×	O
3	O
matrix	B
with	O
rows	O
ai	O
,	O
bj	O
and	O
ck	O
.	O
a1.2	O
the	O
trifocal	B
tensor	I
i	O
the	O
trifocal	B
tensor	I
t	O
jk	O
has	O
one	O
covariant	O
and	O
two	O
contravariant	O
indices	O
.	O
for	O
vectors	O
and	O
matrices	O
,	O
such	O
as	O
xi	O
,	O
li	O
and	O
p	O
i	O
j	O
,	O
it	O
is	O
possible	O
to	O
write	O
the	O
transformation	B
rules	O
using	O
standard	O
linear	B
algebra	O
notation	O
,	O
e.g	O
.	O
x	O
(	O
cid:2	O
)	O
=	O
hx	O
.	O
however	O
,	O
for	O
tensors	O
with	O
three	O
or	O
more	O
indices	O
,	O
this	O
can	O
not	O
conveniently	O
be	O
done	O
.	O
there	O
is	O
really	O
no	O
choice	O
but	O
to	O
use	O
tensor	B
notation	I
when	O
dealing	O
with	O
the	O
trifocal	B
tensor	I
.	O
transformation	B
rule	I
.	O
the	O
arrangement	O
of	O
indices	O
for	O
the	O
trifocal	B
tensor	I
implies	O
a	O
transformation	B
rule	I
−1	O
)	O
k	O
t	O
with	O
respect	O
to	O
changes	O
of	O
basis	O
in	O
the	O
three	O
images	O
.	O
it	O
is	O
worthwhile	O
pointing	O
out	O
one	O
possible	O
source	O
of	O
confusion	O
here	O
.	O
the	O
transformation	B
rule	I
(	O
a1.1	O
)	O
shows	O
how	O
the	O
ˆt	O
jk	O
i	O
=	O
f	O
r	O
(	O
a1.1	O
)	O
−1	O
)	O
j	O
i	O
(	O
g	O
s	O
(	O
h	O
t	O
st	O
r	O
564	O
appendix	O
1	O
tensor	B
notation	I
l1	O
l	O
2	O
l	O
3	O
/	O
/	O
l	O
1	O
l	O
/	O
/	O
2	O
l	O
/	O
/	O
3	O
t1	O
/	O
/	O
l	O
1	O
l	O
/	O
/	O
2	O
l	O
/	O
/	O
3	O
t	O
2	O
/	O
/	O
l	O
1	O
l	O
/	O
/	O
2	O
l	O
/	O
/	O
3	O
t	O
3	O
/	O
l	O
1	O
/	O
l	O
1	O
/	O
l	O
1	O
l	O
/	O
2	O
l	O
/	O
2	O
l	O
/	O
2	O
l	O
/	O
3	O
l	O
/	O
3	O
l	O
/	O
3	O
fig	O
.	O
a1.1	O
.	O
a	O
3-dimensional	O
representation	B
of	O
the	O
trifocal	B
tensor	I
–	O
ﬁgure	O
after	O
faugeras	O
and	O
pa-	O
padopoulo	O
[	O
faugeras-97	O
]	O
.	O
the	O
picture	B
represents	O
li	O
=	O
l	O
,	O
which	O
is	O
the	O
contraction	O
of	O
the	O
tensor	O
with	O
the	O
lines	B
l	O
(	O
cid:1	O
)	O
to	O
produce	O
a	O
line	B
l.	O
in	O
pseudo-matrix	O
notation	O
this	O
can	O
be	O
written	O
as	O
li	O
=	O
l	O
(	O
cid:1	O
)	O
ttil	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
t	O
,	O
and	O
l	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
where	O
(	O
ti	O
)	O
jk	O
=	O
t	O
jk	O
.	O
kt	O
jk	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
jl	O
i	O
i	O
tensor	B
is	O
transformed	O
in	O
terms	O
of	O
basis	O
transformations	O
in	O
the	O
three	O
images	O
.	O
often	O
,	O
we	O
are	O
concerned	O
instead	O
with	O
point	O
coordinate	O
transformations	O
.	O
thus	O
,	O
if	O
f	O
(	O
cid:2	O
)	O
,	O
g	O
(	O
cid:2	O
)	O
and	O
h	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
j	O
represent	O
coordinate	O
transformations	O
in	O
the	O
images	O
,	O
in	O
the	O
sense	O
that	O
ˆxj	O
=	O
f	O
i	O
xi	O
,	O
and	O
g	O
(	O
cid:2	O
)	O
are	O
similarly	O
deﬁned	O
for	O
the	O
other	O
images	O
,	O
then	O
the	O
transformation	B
rule	I
may	O
be	O
written	O
as	O
and	O
h	O
(	O
cid:2	O
)	O
ˆt	O
jk	O
i	O
=	O
(	O
f	O
(	O
cid:2	O
)	O
−1	O
)	O
r	O
i	O
g	O
(	O
cid:2	O
)	O
k	O
(	O
cid:2	O
)	O
j	O
s	O
h	O
t	O
t	O
st	O
r	O
.	O
picture	B
of	O
tensors	O
.	O
a	O
vector	O
x	O
may	O
be	O
thought	O
of	O
as	O
a	O
set	O
of	O
numbers	O
arranged	O
in	O
a	O
column	O
or	O
row	O
,	O
and	O
a	O
matrix	B
h	O
as	O
a	O
2d	O
array	O
of	O
numbers	O
.	O
similarly	O
,	O
a	O
tensor	B
with	O
three	O
indices	O
may	O
be	O
thought	O
of	O
as	O
a	O
3d	O
array	O
of	O
numbers	O
.	O
in	O
particular	O
the	O
trifocal	B
tensor	I
is	O
a	O
3	O
×	O
3	O
×	O
3	O
cube	O
of	O
cells	O
as	O
illustrated	O
in	O
ﬁgure	O
a1.1	O
.	O
appendix	O
2	O
gaussian	O
(	O
normal	O
)	O
and	O
χ2	O
distributions	O
a2.1	O
gaussian	O
probability	O
distribution	O
given	O
a	O
vector	O
x	O
of	O
random	O
variables	O
xi	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
,	O
with	O
mean	O
x	O
=	O
e	O
[	O
x	O
]	O
,	O
where	O
e	O
[	O
·	O
]	O
represents	O
the	O
expected	O
value	O
,	O
and	O
∆x	O
=	O
x	O
−	O
x	O
,	O
the	O
covariance	B
matrix	O
σ	O
is	O
an	O
n	O
×	O
n	O
matrix	B
given	O
by	O
σ	O
=	O
e	O
[	O
∆x	O
∆xt	O
]	O
so	O
that	O
σij	O
=	O
e	O
[	O
∆xi∆xj	O
]	O
.	O
the	O
diagonal	O
entries	O
of	O
the	O
matrix	O
σ	O
are	O
the	O
variances	O
of	O
the	O
individual	O
variables	O
xi	O
,	O
whereas	O
the	O
off-diagonal	O
entries	O
are	O
the	O
cross-covariance	O
values	O
.	O
the	O
variables	O
xi	O
are	O
said	O
to	O
conform	O
to	O
a	O
joint	O
gaussian	O
distribution	B
,	O
if	O
the	O
probability	O
distribution	O
of	O
x	O
is	O
of	O
the	O
form	O
−n/2	O
det	O
(	O
σ−1	O
)	O
1/2	O
exp	O
p	O
(	O
x	O
+	O
∆x	O
)	O
=	O
(	O
2π	O
)	O
(	O
a2.1	O
)	O
for	O
some	O
positive-semideﬁnite	O
matrix	B
σ−1	O
.	O
it	O
may	O
be	O
veriﬁed	O
that	O
x	O
and	O
σ	O
are	O
the	O
mean	O
and	O
covariance	B
of	O
the	O
distribution	B
.	O
a	O
gaussian	O
distribution	B
is	O
uniquely	O
determined	O
by	O
−n/2	O
det	O
(	O
σ−1	O
)	O
1/2	O
is	O
just	O
the	O
normalizing	O
factor	O
its	O
mean	O
and	O
covariance	B
.	O
the	O
factor	O
(	O
2π	O
)	O
necessary	O
to	O
make	O
the	O
total	O
integral	O
of	O
the	O
distribution	O
equal	O
to	O
1	O
.	O
(	O
cid:20	O
)	O
−	O
n	O
(	O
cid:7	O
)	O
in	O
the	O
special	O
case	O
where	O
σ	O
is	O
a	O
scalar	O
matrix	B
σ	O
=	O
σ2i	O
the	O
gaussian	O
pdf	O
takes	O
a	O
√	O
p	O
(	O
x	O
)	O
=	O
(	O
(	O
xi	O
−	O
¯xi	O
)	O
2/2σ2	O
simple	O
form	O
−n	O
exp	O
2πσ	O
)	O
(	O
cid:21	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
−	O
(	O
∆x	O
)	O
tς−1	O
(	O
∆x	O
)	O
/2	O
i=1	O
(	O
cid:15	O
)	O
(	O
cid:27	O
)	O
(	O
cid:16	O
)	O
where	O
x	O
=	O
(	O
x1	O
,	O
x2	O
,	O
.	O
.	O
.	O
,	O
xn	O
)	O
t.	O
this	O
distribution	B
is	O
called	O
an	O
isotropic	B
gaussian	O
distri-	O
bution	O
.	O
mahalanobis	O
distance	B
.	O
note	O
that	O
in	O
this	O
case	O
the	O
value	O
of	O
the	O
pdf	O
at	O
a	O
point	B
x	O
is	O
of	O
the	O
point	O
x	O
from	O
simply	O
a	O
function	O
of	O
the	O
euclidean	O
distance	O
the	O
mean	O
x	O
=	O
(	O
¯x1	O
,	O
.	O
.	O
.	O
,	O
¯xn	O
)	O
t.	O
by	O
analogy	O
with	O
this	O
one	O
may	O
deﬁne	O
the	O
mahalanobis	O
distance	B
between	O
two	O
vectors	O
x	O
and	O
y	O
to	O
be	O
1/2	O
n	O
i=1	O
(	O
xi	O
−	O
¯xi	O
)	O
2	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
(	O
x	O
−	O
y	O
)	O
tς−1	O
(	O
x	O
−	O
y	O
)	O
(	O
cid:10	O
)	O
x	O
−	O
y	O
(	O
cid:10	O
)	O
σ	O
=	O
1/2	O
.	O
565	O
566	O
appendix	O
2	O
gaussian	O
(	O
normal	O
)	O
and	O
χ2	O
distributions	O
one	O
veriﬁes	O
that	O
for	O
a	O
positive-deﬁnite	O
matrix	B
σ	O
,	O
this	O
deﬁnes	O
a	O
metric	B
on	O
irn	O
.	O
using	O
this	O
notation	O
,	O
the	O
general	O
form	O
of	O
the	O
gaussian	O
pdf	O
may	O
be	O
written	O
as	O
(	O
cid:15	O
)	O
−	O
(	O
cid:10	O
)	O
x	O
−	O
x	O
(	O
cid:10	O
)	O
2	O
σ/2	O
(	O
cid:16	O
)	O
p	O
(	O
x	O
)	O
≈	O
exp	O
where	O
the	O
normalizing	O
factor	O
has	O
been	O
omitted	O
.	O
thus	O
,	O
the	O
value	O
of	O
the	O
gaussian	O
pdf	O
is	O
a	O
function	O
of	O
the	O
mahalanobis	O
distance	B
of	O
the	O
point	B
x	O
from	O
the	O
mean	O
.	O
exp	O
1	O
,	O
σ2	O
2	O
,	O
.	O
.	O
.	O
,	O
σ2	O
=	O
ux	O
and	O
x	O
(	O
cid:2	O
)	O
=	O
ux	O
,	O
and	O
substituting	O
in	O
(	O
a2.1	O
)	O
,	O
leads	O
to	O
change	O
of	O
coordinates	O
.	O
since	O
σ	O
is	O
symmetric	B
and	O
positive-deﬁnite	O
,	O
it	O
may	O
be	O
written	O
as	O
σ	O
=	O
utdu	O
,	O
where	O
u	O
is	O
an	O
orthogonal	B
matrix	O
and	O
d	O
=	O
(	O
σ2	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
n	O
)	O
is	O
diagonal	O
.	O
writing	O
x	O
(	O
cid:2	O
)	O
−	O
(	O
x	O
−	O
x	O
)	O
tς−1	O
(	O
x	O
−	O
x	O
)	O
/2	O
(	O
cid:15	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
−	O
(	O
x	O
(	O
cid:2	O
)	O
−	O
x	O
(	O
cid:2	O
)	O
)	O
tuς−1ut	O
(	O
x	O
(	O
cid:2	O
)	O
−	O
x	O
(	O
cid:2	O
)	O
−	O
(	O
x	O
(	O
cid:2	O
)	O
−	O
x	O
(	O
cid:2	O
)	O
)	O
td−1	O
(	O
x	O
(	O
cid:2	O
)	O
−	O
x	O
(	O
cid:2	O
)	O
)	O
/2	O
thus	O
,	O
the	O
orthogonal	B
change	O
of	O
coordinates	O
from	O
x	O
to	O
x	O
(	O
cid:2	O
)	O
=	O
ux	O
transforms	O
a	O
general	O
gaussian	O
pdf	O
into	O
one	O
with	O
diagonal	O
covariance	B
matrix	O
.	O
a	O
further	O
scaling	B
by	O
σi	O
in	O
each	O
coordinate	O
direction	O
may	O
be	O
applied	O
to	O
transform	O
it	O
to	O
an	O
isotropic	B
gaussian	O
dis-	O
tribution	O
.	O
equivalently	O
stated	O
,	O
a	O
change	B
of	I
coordinates	I
may	O
be	O
applied	O
to	O
transform	O
mahalanobis	O
distance	B
to	O
ordinary	O
euclidean	O
distance	O
.	O
=	O
exp	O
=	O
exp	O
(	O
cid:16	O
)	O
)	O
/2	O
a2.2	O
χ2	O
distribution	B
n	O
distribution	B
is	O
the	O
distribution	B
of	O
the	O
sum	O
of	O
squares	O
of	O
n	O
independent	O
gaussian	O
the	O
χ2	O
random	O
variables	O
.	O
as	O
applied	O
to	O
a	O
gaussian	O
random	O
vector	O
v	O
with	O
non-singular	O
covari-	O
ance	O
matrix	B
σ	O
,	O
the	O
value	O
of	O
(	O
v	O
−	O
¯v	O
)	O
tς−1	O
(	O
v	O
−	O
¯v	O
)	O
satisﬁes	O
a	O
χ2	O
n	O
distribution	B
,	O
where	O
n	O
is	O
the	O
dimension	O
of	O
v.	O
if	O
the	O
covariance	B
matrix	O
σ	O
is	O
singular	O
,	O
then	O
we	O
must	O
replace	O
σ−1	O
with	O
the	O
pseudo-inverse	B
σ+	O
.	O
in	O
this	O
case	O
•	O
if	O
v	O
is	O
a	O
gaussian	O
random	O
vector	O
with	O
mean	O
¯v	O
and	O
covariance	B
matrix	O
σ	O
,	O
then	O
the	O
value	O
of	O
(	O
v	O
−	O
¯v	O
)	O
tς+	O
(	O
v	O
−	O
¯v	O
)	O
satisﬁes	O
a	O
χ2	O
the	O
cumulative	O
chi-squared	O
distribution	B
is	O
deﬁned	O
as	O
fn	O
(	O
k2	O
)	O
=	O
n	O
(	O
ξ	O
)	O
dξ	O
.	O
this	O
represents	O
the	O
probability	O
that	O
the	O
value	O
of	O
the	O
χ2	O
n	O
random	O
variable	O
is	O
less	O
than	O
k2	O
.	O
graphs	O
of	O
the	O
χ2	O
n	O
distributions	O
for	O
n	O
=	O
1	O
,	O
.	O
.	O
.	O
,4	O
are	O
shown	O
in	O
ﬁgure	O
a2.1	O
a	O
program	O
for	O
computing	O
the	O
cumulative	O
chi-squared	O
distri-	O
bution	O
fn	O
(	O
k2	O
)	O
is	O
given	O
in	O
[	O
press-88	O
]	O
.	O
since	O
it	O
is	O
a	O
monotonically	O
increasing	O
function	O
,	O
one	O
may	O
compute	O
the	O
inverse	O
function	O
by	O
any	O
simple	O
technique	O
such	O
as	O
subdivision	O
,	O
and	O
values	O
are	O
tabulated	O
in	O
table	O
a2.1	O
(	O
compare	O
with	O
ﬁgure	O
a2.1	O
)	O
.	O
r	O
distribution	B
,	O
where	O
r	O
=	O
rankς	O
.	O
k2	O
0	O
χ2	O
n	O
distribution	B
and	O
inverse	O
cumulative	O
χ2	O
(	O
cid:31	O
)	O
a2.2	O
χ2	O
distribution	B
567	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
14	O
12	O
10	O
8	O
6	O
4	O
2	O
2	O
4	O
6	O
8	O
10	O
0.2	O
0.4	O
0.6	O
0.8	O
1	O
fig	O
.	O
a2.1	O
.	O
the	O
χ2	O
1	O
,	O
.	O
.	O
.	O
,	O
4.	O
in	O
both	O
cases	O
,	O
graphs	O
are	O
for	O
n	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
4	O
bottom	O
to	O
top	O
(	O
at	O
middle	O
point	B
of	O
horizontal	O
axis	O
)	O
.	O
n	O
distribution	B
(	O
left	O
)	O
and	O
inverse	O
cumulative	O
χ2	O
−1	O
n	O
distribution	B
f	O
n	O
(	O
right	O
)	O
for	O
n	O
=	O
n	O
α	O
=	O
0.95	O
α	O
=	O
0.99	O
1	O
2	O
3	O
4	O
3.84	O
5.99	O
7.81	O
9.49	O
6.63	O
9.21	O
11.34	O
13.28	O
table	O
a2.1	O
.	O
values	O
of	O
k2	O
for	O
which	O
fn	O
(	O
k2	O
)	O
,	O
the	O
cumulative	O
χ2	O
distribution	B
with	O
n	O
degrees	B
of	I
freedom	I
,	O
equals	O
α	O
,	O
i.e	O
.	O
k2	O
=	O
f	O
−1	O
n	O
(	O
α	O
)	O
,	O
where	O
α	O
is	O
the	O
probability	O
.	O
appendix	O
3	O
parameter	O
estimation	O
there	O
is	O
much	O
theory	O
about	O
parameter	O
estimation	O
,	O
dealing	O
with	O
properties	O
such	O
as	O
the	O
bias	B
and	O
variance	B
of	O
the	O
estimate	O
.	O
this	O
theory	O
is	O
based	O
on	O
analysis	O
of	O
the	O
probability	O
density	O
functions	O
of	O
the	O
measurements	O
and	O
the	O
parameter	B
space	I
.	O
in	O
this	O
appendix	O
,	O
we	O
discuss	O
such	O
topics	O
as	O
bias	O
of	O
an	O
estimator	B
,	O
the	O
variance	B
,	O
the	O
cram´er-rao	O
lower	O
bound	O
on	O
the	O
variance	B
,	O
and	O
the	O
posterior	O
distribution	B
.	O
the	O
treatment	O
will	O
be	O
largely	O
informal	O
,	O
based	O
on	O
examples	O
,	O
and	O
exploring	O
these	O
concepts	O
in	O
the	O
context	O
of	O
reconstruction	O
.	O
the	O
general	O
lesson	O
to	O
be	O
learnt	O
from	O
this	O
discussion	O
is	O
that	O
many	O
of	O
these	O
concepts	O
depend	O
strongly	O
on	O
the	O
particular	O
parametrization	B
of	I
the	O
model	B
.	O
in	O
problems	O
such	O
as	O
3d	O
projective	B
reconstruction	I
,	O
where	O
there	O
is	O
no	O
preferred	O
parametrization	B
,	O
these	O
concepts	O
are	O
not	O
well	O
deﬁned	O
,	O
or	O
depend	O
very	O
strongly	O
on	O
assumed	O
noise	B
models	O
.	O
a	O
simple	O
geometric	O
estimation	B
problem	I
.	O
the	O
problem	O
we	O
shall	O
consider	O
is	O
related	O
to	O
the	O
triangulation	B
problem	O
of	O
determining	O
a	O
point	B
in	O
space	O
from	O
its	O
projection	B
into	O
two	O
images	O
.	O
to	O
simplify	O
this	O
problem	O
,	O
however	O
,	O
we	O
consider	O
its	O
2-dimensional	O
analog	O
.	O
in	O
addition	O
,	O
we	O
ﬁx	O
one	O
of	O
the	O
rays	O
reducing	O
the	O
problem	O
to	O
one	O
of	O
estimating	O
the	O
position	O
of	O
a	O
point	O
along	O
a	O
known	O
line	O
from	O
observing	O
it	O
in	O
a	O
single	O
image	O
.	O
thus	O
,	O
consider	O
a	O
line	B
camera	O
(	O
that	O
is	O
,	O
one	O
forming	O
a	O
1d	O
image	O
as	O
in	O
section	O
6.4.2-	O
(	O
p175	O
)	O
)	O
observing	O
points	O
on	O
a	O
single	O
line	B
.	O
let	O
the	O
camera	B
be	O
located	O
at	O
the	O
origin	O
(	O
0	O
,	O
0	O
)	O
and	O
point	B
in	O
the	O
positive	O
y	O
direction	O
.	O
further	O
,	O
assume	O
that	O
it	O
has	O
unit	O
focal	B
length	I
.	O
thus	O
,	O
the	O
camera	B
matrix	I
for	O
this	O
camera	B
is	O
simply	O
[	O
i2×2|0	O
]	O
.	O
now	O
,	O
suppose	O
that	O
the	O
camera	B
is	O
observing	O
points	O
on	O
the	O
line	B
y	O
=	O
x+1	O
(	O
the	O
“	O
world	O
line	B
”	O
)	O
.	O
a	O
point	B
(	O
x	O
,	O
x+1	O
)	O
on	O
this	O
line	B
will	O
be	O
mapped	O
to	O
the	O
image	O
point	O
x	O
=	O
x/	O
(	O
x	O
+	O
1	O
)	O
.	O
however	O
,	O
we	O
assume	O
that	O
a	O
point	B
is	O
measured	O
with	O
a	O
certain	O
inaccuracy	O
,	O
which	O
may	O
be	O
modelled	O
with	O
a	O
probability	B
density	I
function	I
(	O
pdf	O
)	O
.	O
the	O
usual	O
practice	O
is	O
to	O
model	O
the	O
noise	B
using	O
a	O
gaussian	O
distribution	B
.	O
let	O
us	O
assume	O
at	O
least	O
that	O
the	O
mode	O
(	O
maximum	O
)	O
of	O
the	O
distribution	O
is	O
at	O
zero	O
.	O
the	O
imaging	O
setup	O
is	O
illustrated	O
in	O
ﬁgure	O
a3.1	O
.	O
the	O
estimation	B
problem	I
we	O
consider	O
is	O
the	O
following	O
:	O
given	O
the	O
image	O
coordinates	O
of	O
a	O
point	O
,	O
estimate	O
the	O
position	O
of	O
the	O
“	O
world	O
point	B
”	O
on	O
the	O
line	B
y	O
=	O
x	O
+	O
1.	O
to	O
consider	O
a	O
speciﬁc	O
scenario	O
,	O
we	O
may	O
think	O
of	O
the	O
line	O
as	O
a	O
scintillator	O
being	O
ﬂooded	O
with	O
gamma-	O
rays	O
.	O
a	O
camera	B
is	O
used	O
to	O
measure	O
the	O
location	O
of	O
each	O
scintillation	O
and	O
determine	O
its	O
position	O
along	O
the	O
line	B
.	O
the	O
problem	O
seems	O
to	O
be	O
ridiculously	O
simple	O
,	O
but	O
it	O
will	O
turn	O
out	O
that	O
there	O
are	O
some	O
surprises	O
.	O
568	O
a3.1	O
bias	B
y	O
θ	O
569	O
x	O
c	O
x	O
fig	O
.	O
a3.1	O
.	O
the	O
imaging	O
setup	O
for	O
a	O
simple	O
estimation	B
problem	I
.	O
a	O
point	B
on	O
the	O
line	B
y	O
=	O
x	O
+	O
1	O
is	O
imaged	O
by	O
a	O
line	B
camera	O
.	O
the	O
projection	B
mapping	O
is	O
given	O
by	O
f	O
:	O
θ	O
(	O
cid:6	O
)	O
→	O
x	O
=	O
θ/	O
(	O
1	O
+	O
θ	O
)	O
,	O
where	O
θ	O
parametrizes	O
the	O
points	O
on	O
the	O
line	B
y	O
=	O
x	O
+	O
1.	O
measurement	O
is	O
subject	O
to	O
noise	O
with	O
a	O
zero-mode	O
distribution	B
.	O
probability	B
density	I
function	I
.	O
we	O
start	O
by	O
parametrizing	O
the	O
world	O
line	B
y	O
=	O
x	O
+	O
1	O
by	O
a	O
parameter	O
θ	O
,	O
where	O
the	O
most	O
convenient	O
parametrization	B
is	O
θ	O
=	O
x	O
so	O
that	O
the	O
2d	O
point	B
parametrized	O
by	O
θ	O
is	O
(	O
θ	O
,	O
θ	O
+	O
1	O
)	O
.	O
this	O
point	B
projects	O
to	O
θ/	O
(	O
θ	O
+	O
1	O
)	O
.	O
we	O
denote	O
this	O
projection	B
function	O
from	O
the	O
world	O
line	B
to	O
the	O
image	O
line	O
by	O
f	O
,	O
so	O
that	O
f	O
(	O
θ	O
)	O
=θ/	O
(	O
θ+1	O
)	O
.	O
the	O
measurement	O
of	O
this	O
point	B
is	O
corrupted	O
by	O
noise	B
,	O
resulting	O
in	O
a	O
random	O
variable	O
x	O
with	O
probability	O
distribution	B
given	O
by	O
p	O
(	O
x|θ	O
)	O
=	O
g	O
(	O
x	O
−	O
f	O
(	O
θ	O
)	O
)	O
.	O
for	O
instance	O
,	O
if	O
g	O
is	O
a	O
zero-mean	O
gaussian	O
distribution	B
with	O
variance	B
σ2	O
,	O
then	O
(	O
cid:15	O
)	O
p	O
(	O
x|θ	O
)	O
=	O
(	O
2πσ2	O
)	O
−1/2	O
exp	O
−	O
(	O
x	O
−	O
f	O
(	O
θ	O
)	O
)	O
2/2σ2	O
.	O
(	O
cid:16	O
)	O
maximum	O
likelihood	O
estimate	O
.	O
an	O
estimate	O
of	O
the	O
parameter	O
vector	O
θ	O
given	O
a	O
mea-	O
sured	O
value	O
x	O
is	O
a	O
function	O
denoted	O
ˆθ	O
(	O
x	O
)	O
,	O
assigning	O
a	O
parameter	O
vector	O
θ	O
to	O
a	O
measure-	O
ment	O
x.	O
the	O
maximum	O
likelihood	O
(	O
ml	O
)	O
estimate	O
is	O
given	O
by	O
ˆθm	O
l	O
=	O
arg	O
max	O
θ	O
p	O
(	O
x|θ	O
)	O
.	O
in	O
the	O
current	O
estimation	B
problem	I
it	O
is	O
easily	O
seen	O
that	O
the	O
ml	O
estimate	O
is	O
obtained	O
simply	O
by	O
back-projecting	O
the	O
measured	O
point	B
x	O
and	O
selecting	O
its	O
intersection	B
with	O
the	O
world	O
line	B
,	O
according	O
to	O
the	O
formula	O
ˆθ	O
(	O
x	O
)	O
=f	O
−1	O
(	O
x	O
)	O
=x/	O
(	O
1	O
−	O
x	O
)	O
.	O
this	O
is	O
the	O
ml	O
estimate	O
,	O
because	O
the	O
resulting	O
point	B
,	O
with	O
parameter	O
ˆθ	O
(	O
x	O
)	O
,	O
projects	O
forward	O
to	O
x	O
,	O
hence	O
p	O
(	O
x|ˆθ	O
)	O
=	O
g	O
(	O
x−x	O
)	O
=g	O
(	O
0	O
)	O
which	O
by	O
assumption	O
gives	O
the	O
maximum	O
(	O
mode	O
)	O
of	O
the	O
probability	O
density	O
function	O
g.	O
any	O
other	O
choice	B
of	O
parameter	O
θ	O
will	O
give	O
a	O
smaller	O
value	O
of	O
p	O
(	O
x|θ	O
)	O
.	O
a3.1	O
bias	B
a	O
desirable	O
property	O
of	O
an	O
estimator	B
is	O
that	O
it	O
can	O
be	O
expected	O
to	O
give	O
the	O
right	O
answer	O
on	O
the	O
average	O
.	O
given	O
a	O
parameter	O
θ	O
,	O
or	O
equivalently	O
in	O
our	O
case	O
a	O
point	B
on	O
the	O
world	O
line	B
,	O
we	O
consider	O
all	O
possible	O
measurements	O
x	O
and	O
from	O
them	O
reestimate	O
the	O
parame-	O
ter	O
θ	O
,	O
namely	O
ˆθ	O
(	O
x	O
)	O
.	O
the	O
estimator	B
is	O
known	O
as	O
unbiased	O
if	O
on	O
the	O
average	O
we	O
obtain	O
570	O
appendix	O
3	O
parameter	O
estimation	O
-2	O
-1	O
4	O
2	O
-2	O
-4	O
1	O
2	O
3	O
−1	O
(	O
x	O
)	O
=	O
x/	O
(	O
1	O
−	O
x	O
)	O
for	O
different	O
fig	O
.	O
a3.2	O
.	O
the	O
ml	O
estimate	O
of	O
the	O
world-point	O
position	O
ˆθ	O
(	O
x	O
)	O
=	O
f	O
measurements	O
of	O
the	O
image	O
point	B
x.	O
note	O
that	O
for	O
values	O
of	O
x	O
greater	O
than	O
1	O
,	O
the	O
ml	O
estimate	O
switches	O
to	O
“	O
behind	O
”	O
the	O
camera	B
.	O
the	O
original	O
parameter	O
θ	O
(	O
the	O
true	O
value	O
)	O
.	O
in	O
forming	O
this	O
average	O
,	O
we	O
weight	O
the	O
mea-	O
surements	O
x	O
according	O
to	O
their	O
probability	O
.	O
more	O
formally	O
,	O
the	O
bias	B
of	O
the	O
estimator	B
is	O
deﬁned	O
as	O
eθ	O
[	O
ˆθ	O
(	O
x	O
)	O
]	O
−	O
θ	O
=	O
p	O
(	O
x|θ	O
)	O
ˆθ	O
(	O
x	O
)	O
dx	O
−	O
θ	O
!	O
x	O
and	O
the	O
estimator	B
is	O
unbiased	O
if	O
eθ	O
[	O
ˆθ	O
(	O
x	O
)	O
]	O
=	O
θ	O
for	O
all	O
θ.	O
here	O
eθ	O
stands	O
for	O
the	O
expected	O
value	O
given	O
θ	O
,	O
deﬁned	O
as	O
shown	O
.	O
another	O
way	O
of	O
thinking	O
of	O
bias	O
is	O
in	O
terms	O
of	O
repeating	O
an	O
experiment	O
many	O
times	O
with	O
identical	O
model	B
parameters	O
and	O
a	O
different	O
instance	O
of	O
the	O
noise	O
at	O
each	O
trial	O
.	O
the	O
bias	B
is	O
the	O
difference	O
between	O
the	O
average	O
value	O
of	O
the	O
estimated	O
parameters	B
and	O
the	O
true	O
parameter	O
value	O
.	O
it	O
is	O
worth	O
noting	O
that	O
for	O
the	O
bias	B
to	O
be	O
deﬁned	O
,	O
it	O
is	O
not	O
necessary	O
that	O
the	O
parameter	B
space	I
have	O
an	O
a	O
priori	O
distribution	B
deﬁned	O
on	O
it	O
,	O
not	O
even	O
that	O
it	O
be	O
a	O
measure	O
space	O
.	O
it	O
is	O
necessary	O
,	O
however	O
that	O
it	O
have	O
some	O
afﬁne	B
structure	O
so	O
that	O
the	O
average	O
(	O
or	O
integral	O
)	O
can	O
be	O
formed	O
.	O
now	O
,	O
we	O
determine	O
whether	O
the	O
ml	O
estimate	O
of	O
θ	O
is	O
unbiased	O
in	O
the	O
case	O
where	O
(	O
cid:21	O
)	O
f	O
(	O
θ	O
)	O
=	O
θ/	O
(	O
θ	O
+	O
1	O
)	O
.	O
the	O
integral	O
becomes	O
!	O
(	O
cid:20	O
)	O
p	O
(	O
x|θ	O
)	O
ˆθ	O
(	O
x	O
)	O
dx	O
=	O
1√	O
2πσ	O
exp	O
x	O
(	O
x	O
−	O
θ/	O
(	O
θ	O
+	O
1	O
)	O
)	O
2	O
2σ2	O
x	O
1	O
−	O
x	O
dx	O
!	O
x	O
it	O
turns	O
out	O
that	O
this	O
integral	O
diverges	O
,	O
and	O
hence	O
the	O
bias	B
is	O
undeﬁned	O
.	O
the	O
difﬁculty	O
is	O
that	O
with	O
an	O
assumed	O
gaussian	O
distribution	B
of	O
noise	B
,	O
for	O
any	O
value	O
of	O
θ	O
,	O
there	O
is	O
always	O
a	O
ﬁnite	B
(	O
though	O
perhaps	O
very	O
small	O
)	O
probability	O
p	O
(	O
x|θ	O
)	O
that	O
x	O
>	O
1.	O
for	O
values	O
of	O
x	O
>	O
1	O
,	O
the	O
corresponding	O
ray	O
does	O
not	O
meet	O
the	O
world	O
line	B
in	O
front	O
of	O
the	O
camera	O
(	O
since	O
the	O
ray	O
is	O
parallel	B
to	O
the	O
world	O
line	O
at	O
x	O
=	O
1	O
)	O
.	O
the	O
estimate	O
ˆθ	O
(	O
x	O
)	O
as	O
a	O
function	O
of	O
x	O
is	O
shown	O
in	O
ﬁgure	O
a3.2	O
,	O
showing	O
how	O
it	O
results	O
in	O
estimated	O
world-points	O
behind	O
the	O
camera	B
.	O
even	O
if	O
values	O
of	O
ˆθ	O
(	O
x	O
)	O
behind	O
the	O
camera	B
are	O
ignored	O
,	O
the	O
ml	O
estimator	B
has	O
inﬁnite	O
bias	O
,	O
as	O
is	O
explained	O
in	O
ﬁgure	O
a3.3	O
.	O
limiting	O
the	O
range	O
of	O
parameters	O
.	O
since	O
the	O
range	O
of	O
the	O
parameter	O
θ	O
is	O
from	O
−1	O
to	O
∞	O
,	O
it	O
makes	O
sense	O
to	O
limit	O
its	O
range	O
.	O
in	O
fact	O
,	O
we	O
may	O
have	O
knowledge	O
that	O
all	O
“	O
events	O
”	O
on	O
the	O
world-line	O
lie	O
in	O
a	O
more	O
restricted	O
range	O
.	O
as	O
an	O
example	O
,	O
suppose	O
that	O
we	O
assume	O
that	O
θ	O
lies	O
in	O
the	O
range	O
−1	O
≤	O
θ	O
≤	O
1	O
,	O
and	O
hence	O
noise-free	O
projected	O
points	O
are	O
in	O
the	O
range	O
−∞	O
<	O
x	O
<	O
1/2	O
.	O
in	O
this	O
case	O
,	O
the	O
ml	O
estimate	O
for	O
any	O
image	O
point	O
x	O
>	O
1/2	O
will	O
2	O
1.75	O
1.5	O
1.25	O
1	O
0.75	O
0.5	O
0.25	O
a	O
-1	O
-0.5	O
a3.1	O
bias	B
571	O
5	O
4	O
3	O
2	O
1	O
0.4	O
0.3	O
0.2	O
0.1	O
-1	O
-0.5	O
0.5	O
1	O
-1	O
-0.5	O
0.5	O
1	O
0.5	O
1	O
-1	O
b	O
-0.1	O
-0.2	O
c	O
fig	O
.	O
a3.3	O
.	O
the	O
reason	O
that	O
the	O
ml	O
estimate	O
with	O
gaussian	O
noise	B
model	O
has	O
inﬁnite	O
bias	O
.	O
(	O
a	O
)	O
the	O
distribution	B
of	O
possible	O
values	O
of	O
the	O
image	O
measurement	O
given	O
a	O
world-point	O
at	O
x	O
=	O
0	O
,	O
y	O
=	O
1	O
assuming	O
gaussian	O
noise	B
distribution	O
with	O
σ	O
=	O
0.4	O
–	O
in	O
symbols	O
p	O
(	O
x|θ	O
=	O
0	O
)	O
.	O
(	O
b	O
)	O
the	O
ml	O
estimate	O
of	O
the	O
world	O
point	B
for	O
different	O
values	O
of	O
the	O
image	O
point	B
,	O
ˆθ	O
(	O
x	O
)	O
=	O
x/	O
(	O
1−	O
x	O
)	O
.	O
note	O
that	O
as	O
the	O
image	O
point	O
approaches	O
1	O
,	O
the	O
estimated	O
point	B
on	O
the	O
world-line	O
recedes	O
to	O
inﬁnity	O
.	O
(	O
c	O
)	O
product	O
ˆθ	O
(	O
x	O
)	O
p	O
(	O
x|θ	O
=	O
0	O
)	O
.	O
the	O
integral	O
of	O
this	O
function	O
from	O
x	O
=	O
−∞	O
to	O
x	O
=	O
1	O
gives	O
the	O
bias	B
of	O
the	O
ml	O
estimator	B
.	O
note	O
that	O
as	O
x	O
approaches	O
1	O
,	O
the	O
graph	O
increases	O
abruptly	O
to	O
inﬁnity	O
.	O
the	O
integral	O
is	O
unbounded	O
,	O
meaning	O
that	O
the	O
estimator	B
has	O
inﬁnite	O
bias	O
.	O
0.0005	O
0.00025	O
-0.4	O
-0.2	O
0.2	O
0.4	O
0.6	O
0.8	O
1	O
-0.00025	O
-0.0005	O
-0.00075	O
b	O
(	O
cid:31	O
)	O
1.5	O
1	O
0.5	O
-1	O
-0.5	O
0.5	O
1	O
-0.5	O
-1	O
a	O
fig	O
.	O
a3.4	O
.	O
(	O
a	O
)	O
if	O
the	O
range	O
of	O
possible	O
values	O
of	O
the	O
world-point	O
parameter	O
θ	O
is	O
limited	O
to	O
the	O
range	O
θ	O
≤	O
1	O
,	O
then	O
the	O
ml	O
estimate	O
of	O
any	O
point	B
x	O
>	O
1/2	O
will	O
be	O
θ	O
=	O
1.	O
this	O
will	O
prevent	O
inﬁnite	O
bias	O
in	O
the	O
estimate	O
,	O
but	O
there	O
will	O
still	O
be	O
bias	B
.	O
(	O
b	O
)	O
the	O
bias	B
eθ	O
[	O
ˆθ	O
(	O
x	O
)	O
]	O
−	O
θ	O
=	O
ˆθ	O
(	O
x	O
)	O
p	O
(	O
x|θ	O
)	O
dx	O
−	O
θ	O
as	O
a	O
function	O
of	O
θ.	O
measurement	O
noise	O
is	O
gaussian	O
with	O
σ	O
=	O
0.01.	O
x	O
be	O
at	O
ˆθ	O
(	O
x	O
)	O
=	O
1.	O
with	O
this	O
restriction	O
on	O
the	O
parameter	O
θ	O
,	O
the	O
ml	O
estimate	O
is	O
still	O
biased	O
,	O
as	O
shown	O
in	O
ﬁgure	O
a3.4	O
.	O
if	O
the	O
noise-distribution	O
has	O
ﬁnite	B
support	O
,	O
then	O
the	O
bias	B
will	O
also	O
be	O
ﬁnite	B
for	O
most	O
values	O
of	O
θ	O
,	O
even	O
if	O
the	O
range	O
of	O
the	O
parameter	O
θ	O
is	O
unrestricted	O
.	O
this	O
is	O
shown	O
in	O
ﬁgure	O
a3.5	O
.	O
one	O
learns	O
from	O
this	O
that	O
the	O
bias	B
of	O
the	O
estimator	B
can	O
be	O
very	O
dependent	O
on	O
the	O
noise-model	O
–	O
a	O
factor	O
that	O
is	O
usually	O
not	O
within	O
our	O
control	O
.	O
dependency	O
of	O
bias	B
on	O
parametrization	B
.	O
the	O
reason	O
for	O
the	O
inﬁnite	O
bias	O
for	O
the	O
ml	O
estimator	B
with	O
gaussian	O
noise	B
model	O
in	O
this	O
example	O
is	O
the	O
projective	B
mapping	O
between	O
the	O
world	O
line	B
and	O
the	O
image	O
line	O
.	O
it	O
is	O
possible	O
to	O
parametrize	O
the	O
world	O
line	B
differently	O
in	O
a	O
way	O
that	O
will	O
change	O
the	O
bias	B
.	O
let	O
the	O
world	O
line	B
y	O
=	O
x	O
+	O
1	O
be	O
parametrized	O
in	O
such	O
a	O
way	O
that	O
parameter	O
θ	O
repre-	O
sents	O
the	O
point	B
(	O
θ/	O
(	O
1	O
−	O
θ	O
)	O
,	O
1/	O
(	O
1	O
−	O
θ	O
)	O
)	O
on	O
the	O
line	B
.	O
the	O
part	O
of	O
the	O
line	O
in	O
front	O
of	O
the	O
camera	O
(	O
having	O
positive	O
y	O
coordinate	O
)	O
is	O
parametrized	O
by	O
θ	O
in	O
the	O
range	O
−∞	O
<	O
θ	O
<	O
1.	O
under	O
the	O
projection	B
(	O
x	O
,	O
y	O
)	O
(	O
cid:6	O
)	O
→	O
x/y	O
,	O
the	O
projection	B
map	O
f	O
is	O
given	O
by	O
f	O
(	O
θ	O
)	O
=	O
x/y	O
=	O
θ	O
,	O
thus	O
the	O
point	B
with	O
parameter	O
θ	O
maps	O
to	O
θ.	O
in	O
other	O
words	O
,	O
points	O
on	O
the	O
world	O
line	B
are	O
572	O
appendix	O
3	O
parameter	O
estimation	O
0.0002	O
0.00015	O
0.0001	O
0.00005	O
25	O
20	O
15	O
10	O
5	O
-0.75	O
-0.5	O
-0.25	O
0.25	O
0.5	O
0.75	O
1	O
20	O
40	O
a	O
80	O
60	O
b	O
fig	O
.	O
a3.5	O
.	O
if	O
the	O
noise-model	O
has	O
ﬁnite	B
support	O
then	O
the	O
bias	B
will	O
be	O
ﬁnite	B
.	O
in	O
this	O
example	O
the	O
noise	B
model	O
is	O
3	O
(	O
1	O
−	O
(	O
x/σ	O
)	O
2	O
)	O
/4σ2	O
,	O
for	O
−σ	O
≤	O
x	O
≤	O
σ	O
,	O
where	O
σ	O
=	O
0.01	O
.	O
(	O
a	O
)	O
bias	B
as	O
a	O
function	O
of	O
θ	O
for	O
small	O
values	O
of	O
θ	O
.	O
(	O
b	O
)	O
percentage	O
bias	B
(	O
eθ	O
[	O
ˆθ	O
(	O
x	O
)	O
]	O
−	O
θ	O
)	O
/θ	O
.	O
the	O
bias	B
is	O
relatively	O
small	O
for	O
small	O
values	O
of	O
θ	O
,	O
but	O
larger	O
(	O
up	O
to	O
20	O
%	O
)	O
for	O
large	O
values	O
.	O
the	O
position	O
of	O
the	O
point	O
along	O
the	O
world-line	O
is	O
always	O
over-estimated	O
.	O
parametrized	O
by	O
the	O
coordinate	O
of	O
the	O
point	B
that	O
they	O
project	O
to	O
under	O
the	O
camera	B
map-	O
ping	O
.	O
−1	O
(	O
x	O
)	O
=x	O
,	O
and	O
the	O
bias	B
is	O
now	O
,	O
in	O
this	O
case	O
,	O
the	O
ml	O
estimate	O
is	O
given	O
by	O
ˆθ	O
(	O
x	O
)	O
=f	O
!	O
!	O
!	O
!	O
ˆθ	O
(	O
x	O
)	O
p	O
(	O
x|θ	O
)	O
dx	O
−	O
θ	O
=	O
x	O
=	O
xg	O
(	O
x	O
−	O
f	O
(	O
θ	O
)	O
)	O
dx	O
−	O
θ	O
!	O
(	O
x	O
+	O
f	O
(	O
θ	O
)	O
)	O
g	O
(	O
x	O
)	O
dx	O
−	O
θ	O
x	O
x	O
=	O
xg	O
(	O
x	O
)	O
dx	O
+	O
f	O
(	O
θ	O
)	O
=	O
0	O
+	O
f	O
(	O
θ	O
)	O
−	O
θ	O
=	O
0	O
x	O
x	O
g	O
(	O
x	O
)	O
dx	O
−	O
θ	O
assuming	O
that	O
the	O
distribution	B
g	O
(	O
x	O
)	O
is	O
zero-mean	O
.	O
note	O
,	O
this	O
shows	O
that	O
the	O
estimate	O
of	O
the	O
original	O
measurement	O
x	O
is	O
unbiased	O
.	O
lessons	B
about	O
bias	B
.	O
by	O
a	O
change	O
of	O
parametrization	O
of	O
the	O
world	O
line	B
,	O
the	O
bias	B
has	O
been	O
changed	O
from	O
inﬁnite	O
to	O
zero	O
.	O
in	O
the	O
present	O
example	O
,	O
there	O
is	O
a	O
natural	O
afﬁne	B
parametrization	O
of	O
the	O
world	O
line	B
,	O
for	O
which	O
we	O
have	O
seen	O
that	O
the	O
bias	B
is	O
inﬁnite	O
.	O
however	O
,	O
if	O
we	O
are	O
working	O
in	O
a	O
projective	B
context	O
,	O
then	O
the	O
parameter	B
space	I
has	O
no	O
natural	O
afﬁne	B
parametrization	O
.	O
in	O
this	O
case	O
,	O
it	O
is	O
somewhat	O
meaningless	O
to	O
speak	O
of	O
any	O
absolute	O
measurement	O
of	O
bias	O
.	O
a	O
second	O
lesson	O
from	O
the	O
above	O
example	O
is	O
that	O
the	O
ml	O
estimate	O
of	O
the	O
corrected	O
measurement	O
(	O
as	O
opposed	O
to	O
the	O
world	O
point	B
)	O
is	O
unbiased	O
.	O
it	O
was	O
also	O
seen	O
that	O
the	O
value	O
of	O
bias	O
is	O
strongly	O
dependent	O
on	O
the	O
noise	B
distribution	O
.	O
even	O
the	O
very	O
small	O
tails	O
of	O
the	O
gaussian	O
distribution	B
have	O
a	O
very	O
large	O
effect	O
on	O
the	O
computed	O
bias	O
.	O
of	O
course	O
,	O
a	O
gaussian	O
distribution	B
of	O
the	O
noise	B
is	O
only	O
a	O
convenient	O
model	B
for	O
modelling	O
image	O
measurement	O
errors	O
.	O
the	O
exact	O
distribution	B
of	O
image	O
mea-	O
surement	O
noise	B
is	O
generally	O
unknown	O
,	O
and	O
the	O
conclusion	O
is	O
inescapable	O
that	O
one	O
can	O
not	O
theoretically	O
compute	O
an	O
exact	O
value	O
for	O
the	O
bias	B
of	O
a	O
given	O
estimator	B
,	O
except	O
for	O
synthetic	O
data	O
with	O
known	O
noise	B
model	O
.	O
a3.2	O
variance	B
of	O
an	O
estimator	B
573	O
a3.2	O
variance	B
of	O
an	O
estimator	B
the	O
other	O
important	O
attribute	O
of	O
an	O
estimator	B
is	O
its	O
variance	B
.	O
consider	O
an	O
experiment	O
being	O
repeated	O
many	O
times	O
with	O
the	O
same	O
model	O
parameters	B
,	O
but	O
a	O
different	O
instantia-	O
tion	O
of	O
the	O
noise	O
at	O
each	O
trial	O
.	O
applying	O
our	O
estimator	B
to	O
the	O
measured	O
data	O
,	O
we	O
obtain	O
an	O
estimate	O
for	O
each	O
of	O
these	O
trials	O
.	O
the	O
variance	B
of	O
the	O
estimator	B
is	O
the	O
variance	B
(	O
or	O
covariance	B
matrix	O
)	O
of	O
the	O
estimated	O
values	O
.	O
more	O
precisely	O
,	O
we	O
can	O
deﬁne	O
the	O
variance	B
for	O
an	O
estimation	B
problem	I
involving	O
a	O
single	O
parameter	O
as	O
varθ	O
(	O
ˆθ	O
)	O
=e	O
θ	O
[	O
(	O
ˆθ	O
(	O
x	O
)	O
−	O
¯θ	O
)	O
2	O
]	O
=	O
(	O
ˆθ	O
(	O
x	O
)	O
−	O
¯θ	O
)	O
2p	O
(	O
x|θ	O
)	O
dx	O
!	O
x	O
!	O
where	O
¯θ	O
=	O
eθ	O
[	O
ˆθ	O
(	O
x	O
)	O
]	O
=	O
x	O
ˆθ	O
(	O
x	O
)	O
p	O
(	O
x|θ	O
)	O
dx	O
=	O
θ	O
+	O
bias	B
(	O
ˆθ	O
)	O
in	O
the	O
case	O
where	O
the	O
parameters	B
θ	O
form	O
a	O
vector	O
,	O
varθ	O
(	O
ˆθ	O
)	O
is	O
the	O
covariance	B
matrix	O
varθ	O
(	O
ˆθ	O
)	O
=e	O
θ	O
[	O
(	O
ˆθ	O
(	O
x	O
)	O
−	O
¯θ	O
)	O
(	O
ˆθ	O
(	O
x	O
)	O
−	O
¯θ	O
)	O
t	O
]	O
(	O
a3.1	O
)	O
in	O
many	O
cases	O
we	O
might	O
be	O
more	O
interested	O
in	O
the	O
variability	O
of	O
the	O
estimate	O
with	O
respect	O
to	O
the	O
original	O
parameter	O
θ	O
,	O
which	O
is	O
the	O
mean-squared	O
error	B
of	O
the	O
estimator	B
.	O
this	O
is	O
easily	O
computed	O
from	O
eθ	O
[	O
(	O
ˆθ	O
(	O
x	O
)	O
−	O
θ	O
)	O
(	O
ˆθ	O
(	O
x	O
)	O
−	O
θ	O
)	O
t	O
]	O
=	O
varθ	O
(	O
ˆθ	O
)	O
+bias	O
(	O
ˆθ	O
)	O
bias	B
(	O
ˆθ	O
)	O
t.	O
it	O
should	O
be	O
noted	O
that	O
,	O
as	O
with	O
the	O
bias	B
,	O
the	O
variance	B
of	O
an	O
estimator	B
makes	O
good	O
sense	O
only	O
when	O
there	O
is	O
a	O
natural	O
afﬁne	B
structure	O
on	O
the	O
parameter	O
set	O
,	O
at	O
least	O
locally	O
.	O
most	O
estimation	B
algorithms	O
will	O
give	O
the	O
right	O
answer	O
if	O
there	O
is	O
no	O
noise	O
.	O
if	O
an	O
algo-	O
rithm	O
performs	O
badly	O
when	O
noise	B
is	O
added	O
,	O
this	O
means	O
that	O
either	O
the	O
bias	B
or	O
variance	B
of	O
the	O
algorithm	B
is	O
high	O
.	O
this	O
is	O
the	O
case	O
,	O
for	O
instance	O
with	O
the	O
dlt	O
algorithm	B
4.1	O
(	O
p91	O
)	O
,	O
or	O
the	O
unnormalized	O
8-point	O
algorithm	B
discussed	O
in	O
section	O
11.1	O
(	O
p279	O
)	O
.	O
the	O
variance	B
of	O
the	O
algorithm	B
grows	O
quickly	O
with	O
added	O
noise	B
.	O
the	O
cram´er-rao	O
lower	O
bound	O
.	O
it	O
is	O
evident	O
that	O
by	O
adding	O
noise	B
to	O
a	O
set	O
of	O
mea-	O
surements	O
information	O
is	O
lost	O
.	O
consequently	O
,	O
it	O
is	O
not	O
to	O
be	O
expected	O
that	O
any	O
estimator	B
can	O
have	O
zero	O
bias	O
and	O
variance	B
in	O
the	O
presence	O
of	O
noise	O
on	O
the	O
measurements	O
.	O
for	O
unbiased	O
estimators	O
,	O
this	O
notion	O
is	O
formalized	O
in	O
the	O
cram´er-rao	O
lower	O
bound	O
,	O
which	O
is	O
a	O
bound	O
on	O
the	O
variance	B
of	O
an	O
unbiased	O
estimator	B
.	O
to	O
explain	O
the	O
cram´er-rao	O
bound	O
,	O
we	O
need	O
a	O
few	O
deﬁnitions	O
.	O
given	O
a	O
probability	O
distribution	O
p	O
(	O
x|θ	O
)	O
,	O
the	O
fisher	O
score	O
is	O
deﬁned	O
as	O
vθ	O
(	O
x	O
)	O
=	O
∂θ	O
log	O
p	O
(	O
x|θ	O
)	O
.	O
the	O
fisher	O
information	O
matrix	B
is	O
deﬁned	O
to	O
be	O
f	O
(	O
θ	O
)	O
=	O
eθ	O
[	O
vθ	O
(	O
x	O
)	O
vθ	O
(	O
x	O
)	O
t	O
]	O
vθ	O
(	O
x	O
)	O
vθ	O
(	O
x	O
)	O
tp	O
(	O
x|θ	O
)	O
dx	O
.	O
!	O
=	O
x	O
the	O
relevance	O
of	O
the	O
fisher	O
information	O
matrix	B
is	O
expressed	O
in	O
the	O
following	O
result	O
.	O
result	O
a3.1	O
.	O
cram´er-rao	O
lower	O
bound	O
.	O
for	O
an	O
unbiased	O
estimator	B
ˆθ	O
(	O
x	O
)	O
,	O
det	O
(	O
e	O
[	O
(	O
ˆθ	O
−	O
θ	O
)	O
(	O
ˆθ	O
−	O
θ	O
)	O
t	O
]	O
)	O
≥	O
1/	O
det	O
f	O
(	O
θ	O
)	O
.	O
a	O
cram´er-rao	O
lower	O
bound	O
may	O
also	O
be	O
given	O
in	O
the	O
case	O
of	O
a	O
biased	O
estimator	B
.	O
574	O
appendix	O
3	O
parameter	O
estimation	O
a3.3	O
the	O
posterior	O
distribution	B
an	O
alternative	O
to	O
the	O
ml	O
estimate	O
is	O
to	O
consider	O
the	O
probability	O
distribution	O
for	O
the	O
parameters	B
,	O
given	O
the	O
measurements	O
,	O
namely	O
p	O
(	O
θ|x	O
)	O
.	O
this	O
is	O
known	O
as	O
the	O
posterior	O
distribution	B
,	O
namely	O
the	O
distribution	B
for	O
the	O
parameters	B
after	O
the	O
measurements	O
have	O
been	O
taken	O
.	O
to	O
compute	O
it	O
,	O
we	O
need	O
a	O
prior	O
distribution	B
p	O
(	O
θ	O
)	O
for	O
the	O
parameters	B
before	O
any	O
measurement	O
has	O
been	O
taken	O
.	O
the	O
posterior	O
distribution	B
can	O
then	O
be	O
computed	O
from	O
bayes	O
law	O
p	O
(	O
θ|x	O
)	O
=	O
p	O
(	O
x|θ	O
)	O
p	O
(	O
θ	O
)	O
.	O
p	O
(	O
x	O
)	O
since	O
the	O
measurement	O
x	O
is	O
ﬁxed	O
,	O
so	O
is	O
its	O
probability	O
p	O
(	O
x	O
)	O
,	O
so	O
we	O
may	O
ignore	O
it	O
,	O
leading	O
to	O
p	O
(	O
θ|x	O
)	O
≈	O
p	O
(	O
x|θ	O
)	O
p	O
(	O
θ	O
)	O
.	O
the	O
maximum	O
of	O
the	O
posterior	O
distribution	B
is	O
known	O
as	O
the	O
maximum	O
a	O
posteriori	O
(	O
map	O
)	O
estimate	O
.	O
note	O
.	O
though	O
the	O
map	O
estimate	O
may	O
seem	O
like	O
a	O
good	O
idea	O
,	O
it	O
is	O
important	O
to	O
realize	O
that	O
it	O
depends	O
on	O
the	O
parametrization	B
of	I
the	O
parameter	B
space	I
.	O
the	O
posterior	O
proba-	O
bility	O
distribution	B
is	O
proportional	O
to	O
p	O
(	O
x|θ	O
)	O
p	O
(	O
θ	O
)	O
.	O
however	O
,	O
p	O
(	O
θ	O
)	O
is	O
dependent	O
on	O
the	O
parametrization	B
of	I
θ.	O
for	O
instance	O
if	O
p	O
(	O
θ	O
)	O
is	O
a	O
uniform	O
distribution	B
in	O
one	O
parametriza-	O
tion	O
,	O
it	O
will	O
not	O
be	O
a	O
uniform	O
distribution	B
in	O
a	O
different	O
parametrization	B
that	O
differs	O
by	O
a	O
non-afﬁne	O
transformation	B
.	O
on	O
the	O
other	O
hand	O
,	O
p	O
(	O
x|θ	O
)	O
does	O
not	O
depend	O
on	O
the	O
parametrization	B
of	I
θ.	O
therefore	O
,	O
the	O
result	O
of	O
a	O
change	O
of	O
parametrization	O
is	O
to	O
alter	O
the	O
posterior	O
distribution	B
in	O
such	O
a	O
way	O
that	O
its	O
maximum	O
will	O
change	O
.	O
if	O
the	O
parameter	B
space	I
does	O
not	O
have	O
a	O
natural	O
afﬁne	B
coordinate	O
system	O
(	O
for	O
instance	O
if	O
the	O
parameter	B
space	I
is	O
projective	B
)	O
then	O
the	O
map	O
estimate	O
does	O
not	O
really	O
make	O
a	O
lot	O
of	O
sense	O
.	O
other	O
estimates	O
based	O
on	O
the	O
posterior	O
distribution	B
are	O
also	O
possible	O
.	O
given	O
a	O
mea-	O
surement	O
x	O
,	O
and	O
the	O
posterior	O
distribution	B
p	O
(	O
θ|x	O
)	O
,	O
we	O
may	O
wish	O
to	O
make	O
a	O
different	O
estimate	O
of	O
the	O
parameter	O
θ.	O
one	O
sensible	O
choice	B
is	O
the	O
estimate	O
that	O
minimizes	O
the	O
expected	O
squared	B
error	I
in	O
the	O
estimate	O
,	O
namely	O
!	O
!	O
ˆθ	O
(	O
x	O
)	O
=	O
argminy	O
e	O
[	O
(	O
cid:10	O
)	O
y	O
−	O
θ	O
(	O
cid:10	O
)	O
2	O
]	O
=	O
argminy	O
which	O
is	O
the	O
mean	O
of	O
the	O
posterior	O
distribution	B
.	O
(	O
cid:10	O
)	O
y	O
−	O
θ	O
(	O
cid:10	O
)	O
2p	O
(	O
θ|x	O
)	O
dθ	O
,	O
a	O
further	O
alternative	O
is	O
to	O
minimize	O
the	O
expected	O
absolute	O
error	O
ˆθ	O
(	O
x	O
)	O
=	O
argminy	O
e	O
[	O
(	O
cid:10	O
)	O
y	O
−	O
θ	O
(	O
cid:10	O
)	O
]	O
=	O
argminy	O
(	O
cid:10	O
)	O
y	O
−	O
θ	O
(	O
cid:10	O
)	O
p	O
(	O
θ|x	O
)	O
dθ	O
,	O
which	O
is	O
the	O
median	O
of	O
the	O
posterior	O
distribution	B
.	O
examples	B
of	O
these	O
estimates	O
are	O
shown	O
in	O
ﬁgure	O
a3.6	O
and	O
ﬁgure	O
a3.7	O
.	O
more	B
properties	I
of	O
these	O
estimates	O
are	O
listed	O
in	O
the	O
notes	O
at	O
the	O
end	O
of	O
this	O
appendix	O
.	O
a3.4	O
estimation	B
of	I
corrected	O
measurements	O
we	O
have	O
seen	O
that	O
in	O
geometric	O
estimation	B
problems	O
,	O
particularly	O
those	O
that	O
involve	O
projective	B
models	O
,	O
concepts	O
such	O
as	O
bias	O
and	O
variance	B
of	O
the	O
estimator	B
are	O
dependent	O
on	O
the	O
particular	O
parametrization	B
of	I
the	O
model	B
,	O
for	O
instance	O
a	O
particular	O
projective	B
coor-	O
dinate	O
frame	O
chosen	O
.	O
even	O
in	O
cases	O
where	O
a	O
natural	O
afﬁne	B
parametrization	O
of	O
the	O
model	O
a3.4	O
estimation	B
of	I
corrected	O
measurements	O
575	O
2	O
1.75	O
1.5	O
1.25	O
1	O
0.75	O
0.5	O
0.25	O
0.4	O
0.2	O
-0.4	O
-0.2	O
0.2	O
0.4	O
0.6	O
0.8	O
1	O
-0.2	O
-0.4	O
-0.4	O
-0.2	O
0.2	O
0.4	O
0.6	O
0.8	O
1	O
a	O
b	O
fig	O
.	O
a3.6	O
.	O
different	O
estimators	O
for	O
θ	O
.	O
(	O
a	O
)	O
for	O
the	O
imaging	O
setup	O
of	O
ﬁgure	O
a3.1	O
:	O
the	O
a	O
posteriori	O
distri-	O
bution	O
p	O
(	O
θ|x	O
=	O
0	O
)	O
assuming	O
a	O
gaussian	O
noise	B
distribution	O
with	O
σ	O
=	O
0.2	O
,	O
and	O
a	O
prior	O
distribution	B
for	O
θ	O
,	O
uniform	O
on	O
the	O
interval	O
[	O
−1/2	O
,	O
1	O
]	O
.	O
the	O
mode	O
(	O
maximum	O
)	O
of	O
this	O
distribution	B
is	O
the	O
maximal	O
apriori	O
(	O
map	O
)	O
estimate	O
of	O
θ	O
,	O
which	O
is	O
identical	O
with	O
the	O
ml	O
estimate	O
,	O
because	O
of	O
the	O
assumed	O
uniform	O
distri-	O
bution	O
for	O
θ.	O
the	O
mean	O
of	O
this	O
distribution	B
(	O
θ	O
=	O
0.1386	O
)	O
is	O
the	O
estimate	O
that	O
minimizes	O
the	O
expected	O
squared	B
error	I
e	O
[	O
(	O
ˆθ	O
(	O
x	O
)	O
−	O
¯θ	O
)	O
2	O
]	O
with	O
respect	O
to	O
the	O
true	O
measurement	O
¯θ	O
.	O
(	O
b	O
)	O
the	O
cumulative	O
a	O
posteriori	O
distribution	B
(	O
offset	O
by	O
−0.5	O
)	O
.	O
the	O
zero	O
point	O
of	O
this	O
graph	O
is	O
the	O
median	O
of	O
the	O
distribution	O
,	O
namely	O
the	O
estimate	O
that	O
minimizes	O
e	O
[	O
|ˆθ	O
(	O
x	O
)	O
−	O
¯θ|	O
]	O
.	O
the	O
median	O
lies	O
at	O
θ	O
=	O
0.09137	O
.	O
2	O
1.75	O
1.5	O
1.25	O
1	O
0.75	O
0.5	O
0.25	O
0.4	O
0.2	O
-0.2	O
0.2	O
0.4	O
0.6	O
-0.2	O
-0.4	O
-0.4	O
-0.2	O
0.2	O
0.4	O
0.6	O
0.8	O
1	O
a	O
b	O
fig	O
.	O
a3.7	O
.	O
different	O
estimators	O
with	O
the	O
parabolic	O
noise	B
model	O
.	O
the	O
two	O
graphs	O
show	O
the	O
a	O
posteriori	O
distribution	B
of	O
θ	O
and	O
its	O
cumulative	O
distribution	B
.	O
in	O
this	O
example	O
,	O
the	O
noise	B
model	O
is	O
3	O
(	O
1−	O
(	O
x/σ	O
)	O
2	O
)	O
/4σ2	O
,	O
for	O
−σ	O
≤	O
x	O
≤	O
σ	O
,	O
where	O
σ	O
=	O
0.4.	O
the	O
mode	O
of	O
the	O
distribution	O
(	O
θ	O
=	O
0	O
)	O
is	O
the	O
map	O
estimate	O
,	O
identical	O
with	O
the	O
ml	O
estimate	O
,	O
the	O
mean	O
(	O
θ	O
=	O
0.1109	O
)	O
minimizes	O
the	O
expected	O
squared	B
error	I
in	O
θ	O
and	O
the	O
median	O
(	O
θ	O
=	O
0.0911	O
)	O
minimizes	O
the	O
expected	O
absolute	O
error	O
.	O
exists	O
,	O
it	O
may	O
be	O
difﬁcult	O
to	O
ﬁnd	O
an	O
unbiased	O
estimator	B
.	O
for	O
instance	O
,	O
the	O
ml	O
estimator	B
for	O
problems	O
such	O
as	O
triangulation	O
is	O
biased	O
.	O
we	O
saw	O
however	O
in	O
the	O
example	O
of	O
1d	O
back-projection	B
discussed	O
in	O
section	O
a3.1	O
,	O
that	O
if	O
instead	O
of	O
attempting	O
to	O
compute	O
the	O
model	B
(	O
namely	O
the	O
back-projected	O
point	B
)	O
we	O
estimate	O
the	O
corrected	O
measurement	O
instead	O
,	O
then	O
the	O
ml	O
estimator	B
is	O
unbiased	O
.	O
we	O
explore	O
this	O
notion	O
further	O
in	O
this	O
section	O
,	O
and	O
show	O
that	O
in	O
a	O
general	O
setting	O
,	O
the	O
ml	O
estimator	B
of	O
the	O
corrected	O
measurements	O
is	O
not	O
only	O
unbiased	O
but	O
attains	O
the	O
cram´er-	O
rao	O
lower	O
bound	O
,	O
when	O
the	O
noise-model	O
is	O
gaussian	O
.	O
consider	O
an	O
estimation	B
problem	I
that	O
involves	O
ﬁtting	O
a	O
parametrized	O
model	B
to	O
a	O
set	O
of	O
image	O
measurements	O
.	O
as	O
seen	O
in	O
section	O
5.1.3	O
(	O
p134	O
)	O
this	O
problem	O
may	O
be	O
viewed	O
as	O
an	O
estimation	B
problem	I
in	O
a	O
high-dimensional	O
euclidean	O
space	O
irn	O
,	O
which	O
is	O
the	O
space	O
of	O
all	O
image	O
measurements	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
5.2	O
(	O
p135	O
)	O
.	O
the	O
estimation	B
problem	I
is	O
,	O
given	O
a	O
measurement	O
vector	O
x	O
,	O
to	O
ﬁnd	O
the	O
closest	O
point	B
lying	O
on	O
a	O
surface	O
representing	O
the	O
set	O
of	O
all	O
allowable	O
exact	O
measurements	O
.	O
the	O
vector	O
(	O
cid:23	O
)	O
x	O
represents	O
the	O
576	O
appendix	O
3	O
parameter	O
estimation	O
set	O
of	O
“	O
corrected	O
”	O
image	O
measurements	O
that	O
conform	O
to	O
the	O
given	O
model	B
.	O
the	O
model	B
it-	O
self	O
may	O
depend	O
on	O
a	O
set	O
of	O
parameters	O
θ	O
,	O
such	O
as	O
the	O
fundamental	B
matrix	I
,	O
hypothesized	O
3d	O
points	O
or	O
other	O
parameters	B
appropriate	O
to	O
the	O
problem	O
.	O
the	O
estimation	B
of	I
the	O
parameters	B
θ	O
is	O
subject	O
to	O
bias	O
in	O
the	O
same	O
way	O
as	O
we	O
have	O
seen	O
with	O
the	O
simple	O
problem	O
discussed	O
in	O
section	O
a3.1	O
,	O
and	O
the	O
exact	O
degree	O
of	O
bias	O
is	O
dependent	O
on	O
the	O
precise	O
parametrization	B
.	O
generally	O
(	O
for	O
instance	O
in	O
projective-	O
reconstruction	B
problems	O
)	O
there	O
is	O
no	O
natural	O
afﬁne	B
coordinate	O
system	O
for	O
the	O
model	B
parameters	O
,	O
though	O
there	O
is	O
a	O
natural	O
afﬁne	B
coordinate	O
system	O
for	O
the	O
image	B
plane	I
.	O
measurement	O
vector	O
(	O
cid:23	O
)	O
x	O
,	O
then	O
we	O
ﬁnd	O
a	O
more	O
favourable	O
situation	O
.	O
the	O
measurements	O
if	O
we	O
think	O
of	O
the	O
problem	O
differently	O
,	O
as	O
the	O
problem	O
of	O
directly	O
ﬁnding	O
the	O
corrected	O
are	O
carried	O
out	O
in	O
the	O
images	O
,	O
which	O
have	O
a	O
natural	O
afﬁne	B
coordinate	O
system	O
,	O
and	O
so	O
questions	O
of	O
bias	O
in	O
estimating	O
the	O
corrected	O
measurements	O
make	O
more	O
sense	O
.	O
we	O
will	O
show	O
that	O
,	O
provided	O
the	O
measurement	O
surface	O
is	O
well	O
approximated	O
by	O
its	O
tangent	O
plane	O
,	O
the	O
ml	O
estimate	O
of	O
the	O
corrected	O
measurement	O
vector	O
is	O
unbiased	O
,	O
provided	O
the	O
noise	B
is	O
zero-mean	O
.	O
in	O
addition	O
,	O
if	O
the	O
noise	B
is	O
gaussian	O
and	O
isotropic	B
,	O
then	O
the	O
ml	O
estimate	O
meets	O
the	O
cram´er-rao	O
lower-bound	O
.	O
the	O
geometric	B
situation	O
is	O
follows	O
.	O
a	O
point	B
x	O
lies	O
on	O
a	O
measurement	O
surface	O
,	O
as	O
shown	O
in	O
ﬁgure	O
5.2	O
(	O
p135	O
)	O
.	O
noise	B
is	O
added	O
to	O
this	O
point	B
to	O
obtain	O
a	O
measured	O
point	B
x.	O
the	O
estimate	O
(	O
cid:23	O
)	O
x	O
of	O
the	O
true	O
point	B
x	O
is	O
obtained	O
by	O
selecting	O
the	O
closest	O
point	B
on	O
the	O
mea-	O
surement	O
surface	O
to	O
the	O
measured	O
point	B
.	O
we	O
make	O
an	O
assumption	O
that	O
the	O
measurement	O
surface	O
is	O
effectively	O
planar	O
near	O
x.	O
is	O
spanned	O
by	O
the	O
ﬁrst	O
d	O
coordinates	B
.	O
we	O
may	O
write	O
x	O
=	O
(	O
xt	O
a	O
d-vector	O
.	O
the	O
measured	O
point	B
may	O
similarly	O
be	O
written	O
as	O
x	O
=	O
(	O
xt	O
we	O
may	O
choose	O
a	O
coordinate	O
system	O
in	O
which	O
the	O
measurement	O
surface	O
close	O
to	O
x	O
n−d	O
)	O
t	O
,	O
where	O
x1	O
is	O
2	O
)	O
t	O
,	O
and	O
its	O
1	O
,	O
0t	O
)	O
t.	O
we	O
suppose	O
that	O
the	O
projection	B
onto	O
the	O
tangent	O
plane	O
is	O
(	O
cid:23	O
)	O
x	O
=	O
(	O
xt	O
noise-distribution	O
is	O
given	O
by	O
p	O
(	O
x|x	O
)	O
=	O
g	O
(	O
x	O
−	O
x	O
)	O
.	O
now	O
,	O
the	O
bias	B
of	O
the	O
estimate	O
(	O
cid:23	O
)	O
x	O
is	O
1	O
,	O
0t	O
)	O
t	O
=	O
(	O
(	O
cid:23	O
)	O
xt	O
1	O
,	O
xt	O
1	O
,	O
0t	O
e	O
[	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
]	O
=	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
g	O
(	O
x	O
−	O
x	O
)	O
dx	O
!	O
x	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
p	O
(	O
x|x	O
)	O
dx	O
=	O
!	O
j	O
(	O
x	O
−	O
x	O
)	O
g	O
(	O
x	O
−	O
x	O
)	O
dx	O
(	O
x	O
−	O
x	O
)	O
g	O
(	O
x	O
−	O
x	O
)	O
dx	O
x	O
x	O
=	O
=	O
j	O
=	O
0	O
x	O
!	O
!	O
!	O
!	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
tp	O
(	O
x|x	O
)	O
dx	O
=	O
!	O
j	O
(	O
x	O
−	O
x	O
)	O
(	O
x	O
−	O
x	O
)	O
tjtg	O
(	O
x	O
−	O
x	O
)	O
dx	O
(	O
x	O
−	O
x	O
)	O
(	O
x	O
−	O
x	O
)	O
tg	O
(	O
x	O
−	O
x	O
)	O
dxjt	O
x	O
x	O
x	O
=	O
=	O
j	O
=	O
jσgjt	O
x	O
where	O
j	O
is	O
the	O
matrix	B
[	O
id×d|0d×	O
(	O
n−d	O
)	O
]	O
.	O
this	O
shows	O
that	O
the	O
estimate	O
of	O
x	O
is	O
unbiased	O
as	O
e	O
[	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
t	O
]	O
=	O
long	O
at	O
g	O
has	O
zero-mean	O
.	O
the	O
variance	B
of	O
the	O
estimate	O
is	O
equal	O
to	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
(	O
(	O
cid:23	O
)	O
x	O
−	O
x	O
)	O
tg	O
(	O
x	O
−	O
x	O
)	O
dx	O
!	O
where	O
σg	O
is	O
the	O
covariance	B
matrix	O
of	O
g.	O
a3.5	O
notes	O
and	O
exercises	O
577	O
we	O
now	O
compute	O
the	O
cram´er-rao	O
lower	O
bound	O
for	O
this	O
estimator	B
,	O
supposing	O
that	O
the	O
distribution	B
g	O
(	O
x	O
)	O
is	O
gaussian	O
deﬁned	O
by	O
g	O
(	O
x	O
)	O
=	O
k	O
exp	O
(	O
−	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
2/2σ2	O
)	O
.	O
in	O
this	O
case	O
,	O
the	O
variance	B
of	O
the	O
estimator	B
is	O
simply	O
σ2id×d	O
.	O
we	O
next	O
compute	O
the	O
fisher	O
information	O
matrix	B
.	O
the	O
probability	O
distribution	O
is	O
p	O
(	O
x|x	O
)	O
=	O
g	O
(	O
x	O
−	O
x	O
)	O
=k	O
exp	O
(	O
−	O
(	O
cid:10	O
)	O
x	O
−	O
x	O
(	O
cid:10	O
)	O
2/2σ2	O
)	O
=	O
k	O
exp	O
(	O
−	O
(	O
cid:10	O
)	O
x1	O
−	O
x1	O
(	O
cid:10	O
)	O
2/2σ2	O
)	O
exp	O
(	O
−	O
(	O
cid:10	O
)	O
x2	O
(	O
cid:10	O
)	O
2/2σ2	O
)	O
.	O
taking	O
logarithms	O
and	O
derivatives	O
with	O
respect	O
to	O
x1	O
gives	O
∂x1	O
log	O
p	O
(	O
x|x	O
)	O
=	O
−	O
(	O
x1	O
−	O
x1	O
)	O
/σ2	O
.	O
the	O
fisher	O
information	O
matrix	B
is	O
then	O
1/σ2	O
(	O
x1	O
−	O
x1	O
)	O
(	O
x1	O
−	O
x1	O
)	O
tg	O
(	O
x1	O
−	O
x1	O
)	O
g	O
(	O
x2	O
)	O
dx1dx2	O
=	O
id×d/σ2	O
.	O
!	O
thus	O
,	O
the	O
fisher	O
information	O
matrix	B
is	O
the	O
inverse	O
of	O
the	O
covariance	O
matrix	B
for	O
the	O
estimator	B
.	O
thus	O
,	O
for	O
the	O
case	O
where	O
the	O
noise	B
distribution	O
is	O
gaussian	O
,	O
the	O
ml	O
estimator	B
meets	O
the	O
cram´er-rao	O
lower	O
bound	O
,	O
to	O
the	O
extent	O
that	O
the	O
measurement	O
surface	O
is	O
ﬂat	O
.	O
it	O
should	O
be	O
noticed	O
that	O
the	O
fisher	O
information	O
matrix	B
does	O
not	O
depend	O
on	O
the	O
spe-	O
ciﬁc	O
shape	O
of	O
the	O
measurement	O
surface	O
,	O
but	O
only	O
on	O
its	O
ﬁrst-order	O
approximation	O
,	O
the	O
tangent	O
plane	O
.	O
the	O
properties	B
of	O
the	O
estimate	O
does	O
however	O
depend	O
on	O
the	O
shape	O
of	O
the	O
measurement	O
surface	O
,	O
both	O
as	O
regards	O
its	O
bias	B
and	O
variance	B
.	O
it	O
may	O
also	O
be	O
shown	O
that	O
if	O
the	O
cram´er-rao	O
bound	O
is	O
met	O
,	O
then	O
the	O
noise	B
distribution	O
must	O
be	O
gaussian	O
.	O
in	O
other	O
words	O
,	O
if	O
the	O
noise	B
distribution	O
is	O
not	O
gaussian	O
,	O
then	O
we	O
can	O
not	O
meet	O
the	O
lower	O
bound	O
.	O
a3.5	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
show	O
by	O
a	O
speciﬁc	O
example	O
that	O
the	O
a	O
posteriori	O
distribution	B
is	O
altered	O
by	O
a	O
change	B
of	I
coordinates	I
in	O
the	O
parameter	B
space	I
.	O
show	O
also	O
that	O
the	O
mean	O
of	O
the	O
distribution	O
may	O
be	O
altered	O
by	O
such	O
a	O
coordinate	O
change	O
.	O
thus	O
the	O
mode	O
(	O
map	O
estimate	O
)	O
and	O
mean	O
of	O
the	O
posterior	O
distribution	B
are	O
dependent	O
on	O
the	O
choice	B
of	O
coordinates	B
for	O
the	O
parameter	B
space	I
.	O
(	O
ii	O
)	O
show	O
for	O
any	O
pdf	O
p	O
(	O
θ	O
)	O
deﬁned	O
on	O
irn	O
,	O
that	O
argminy	O
mean	O
of	O
the	O
distribution	O
.	O
(	O
iii	O
)	O
show	O
for	O
any	O
pdf	O
p	O
(	O
θ	O
)	O
deﬁned	O
on	O
ir	O
,	O
that	O
argminy	O
median	O
of	O
the	O
distribution	O
.	O
in	O
higher	O
dimensions	O
,	O
show	O
that	O
is	O
a	O
convex	O
function	O
of	O
y	O
,	O
and	O
hence	O
has	O
a	O
single	O
minimum	O
.	O
the	O
value	O
of	O
y	O
that	O
minimizes	O
this	O
is	O
a	O
higher-dimensional	O
generalization	O
of	O
the	O
median	O
of	O
a	O
1-dimensional	O
distribution	B
.	O
(	O
iv	O
)	O
show	O
that	O
the	O
median	O
of	O
a	O
pdf	O
deﬁned	O
on	O
ir	O
is	O
invariant	O
to	O
reparametrization	O
of	O
ir	O
.	O
show	O
by	O
an	O
example	O
that	O
this	O
is	O
not	O
true	O
in	O
higher	O
dimensions	O
,	O
however	O
.	O
(	O
cid:31	O
)	O
(	O
cid:10	O
)	O
y	O
−	O
θ	O
(	O
cid:10	O
)	O
2p	O
(	O
θ	O
)	O
dθ	O
is	O
the	O
(	O
cid:31	O
)	O
|y	O
−	O
θ|p	O
(	O
θ	O
)	O
dθ	O
is	O
the	O
(	O
cid:31	O
)	O
(	O
cid:10	O
)	O
y	O
−	O
θ	O
(	O
cid:10	O
)	O
p	O
(	O
θ	O
)	O
dθ	O
appendix	O
4	O
matrix	B
properties	O
and	O
decompositions	O
in	O
this	O
appendix	O
we	O
discuss	O
matrices	O
with	O
particular	O
forms	O
that	O
occur	O
throughout	O
the	O
book	O
,	O
and	O
also	O
various	O
matrix	B
decompositions	O
.	O
a4.1	O
orthogonal	B
matrices	I
a	O
square	O
matrix	B
u	O
is	O
known	O
as	O
orthogonal	B
if	O
its	O
transpose	O
is	O
its	O
inverse	O
–	O
symbolically	O
utu	O
=	O
i	O
,	O
where	O
i	O
is	O
the	O
identity	O
matrix	B
.	O
this	O
means	O
that	O
the	O
column	O
vectors	O
of	O
u	O
are	O
all	O
of	O
unit	O
norm	B
and	O
are	O
orthogonal	B
.	O
this	O
may	O
be	O
written	O
ut	O
uj	O
=	O
δij	O
.	O
from	O
the	O
condition	O
i	O
utu	O
=	O
i	O
one	O
easily	O
deduces	O
that	O
uut	O
=	O
i.	O
hence	O
the	O
row	O
vectors	O
of	O
u	O
are	O
also	O
of	O
unit	O
norm	B
and	O
are	O
orthogonal	B
.	O
consider	O
once	O
more	O
the	O
equation	O
utu	O
=	O
i.	O
taking	O
determinants	O
leads	O
to	O
the	O
equation	O
(	O
det	O
u	O
)	O
2	O
=	O
1	O
,	O
since	O
det	O
u	O
=	O
det	O
ut	O
.	O
thus	O
if	O
u	O
is	O
orthogonal	B
,	O
then	O
det	O
u	O
=	O
±1	O
.	O
one	O
easily	O
veriﬁes	O
that	O
the	O
orthogonal	B
matrices	I
of	O
a	O
given	O
ﬁxed	O
dimension	O
form	O
a	O
group	O
,	O
denoted	O
on	O
,	O
since	O
if	O
u	O
and	O
v	O
are	O
orthogonal	B
,	O
then	O
(	O
uv	O
)	O
tuv	O
=	O
vtutuv	O
=	O
i.	O
furthermore	O
,	O
the	O
orthogonal	B
matrices	I
of	O
dimension	O
n	O
with	O
positive	O
determinant	O
form	O
a	O
group	O
,	O
called	O
son	O
.	O
an	O
element	O
of	O
son	O
is	O
called	O
an	O
n-dimensional	O
rotation	B
.	O
norm-preserving	B
properties	I
of	O
orthogonal	B
matrices	I
.	O
given	O
a	O
vector	O
x	O
,	O
the	O
notation	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
represents	O
its	O
euclidean	O
length	O
.	O
this	O
can	O
be	O
written	O
as	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
(	O
xtx	O
)	O
1/2	O
.	O
an	O
important	O
property	O
of	O
orthogonal	O
matrices	O
is	O
that	O
multiplying	O
a	O
vector	O
by	O
an	O
orthogonal	B
matrix	O
preserves	O
its	O
norm	B
.	O
this	O
is	O
easily	O
seen	O
by	O
computing	B
(	O
ux	O
)	O
t	O
(	O
ux	O
)	O
=	O
xtutux	O
=	O
xtx	O
.	O
by	O
the	O
qr	O
decomposition	B
of	I
a	O
matrix	B
is	O
usually	O
meant	O
the	O
decomposition	B
of	I
the	O
matrix	B
a	O
into	O
a	O
product	O
a	O
=	O
qr	O
,	O
where	O
q	O
is	O
orthogonal	B
,	O
and	O
r	O
is	O
an	O
upper-triangular	O
matrix	B
.	O
the	O
letter	O
r	O
stands	O
for	O
right	O
,	O
meaning	O
upper-triangular	O
.	O
similar	O
to	O
the	O
qr	O
decomposition	B
,	O
there	O
are	O
also	O
ql	O
,	O
lq	O
and	O
rq	O
decompositions	O
,	O
where	O
l	O
denotes	O
a	O
left	O
or	O
lower-triangular	O
matrix	B
.	O
in	O
fact	O
,	O
the	O
rq	O
decomposition	B
of	I
a	O
matrix	B
is	O
the	O
one	O
that	O
will	O
be	O
of	O
most	O
use	O
in	O
this	O
book	O
,	O
and	O
which	O
will	O
therefore	O
be	O
discussed	O
here	O
.	O
the	O
most	O
important	O
case	O
is	O
the	O
decomposition	B
of	I
a	O
3	O
×	O
3	O
matrix	B
and	O
we	O
will	O
concentrate	O
on	O
this	O
in	O
the	O
following	O
section	O
.	O
578	O
a4.1	O
orthogonal	B
matrices	I
579	O
a4.1.1	O
givens	O
rotations	B
and	O
rq	O
decomposition	B
a	O
3-dimensional	O
givens	O
rotation	B
is	O
a	O
rotation	B
about	O
one	O
of	O
the	O
three	O
coordinate	O
axes	O
.	O
the	O
three	O
givens	O
rotations	B
are	O
	O
1	O
qx	O
=	O
	O
	O
c	O
c	O
−s	O
c	O
s	O
qy	O
=	O
1−s	O
	O
s	O
c	O
	O
c	O
−s	O
s	O
qz	O
=	O
c	O
	O
1	O
(	O
a4.1	O
)	O
where	O
c	O
=	O
cos	O
(	O
θ	O
)	O
and	O
s	O
=	O
sin	O
(	O
θ	O
)	O
for	O
some	O
angle	B
θ	O
and	O
blank	O
entries	O
represent	O
zeros	O
.	O
multiplying	O
a	O
3×	O
3	O
matrix	B
a	O
on	O
the	O
right	O
by	O
(	O
for	O
instance	O
)	O
qz	O
has	O
the	O
effect	O
of	O
leaving	O
the	O
last	O
column	O
of	O
a	O
unchanged	O
,	O
and	O
replacing	O
the	O
ﬁrst	O
two	O
columns	O
by	O
linear	B
combi-	O
nations	O
of	O
the	O
original	O
two	O
columns	O
.	O
the	O
angle	B
θ	O
may	O
be	O
chosen	O
so	O
that	O
any	O
given	O
entry	O
in	O
the	O
ﬁrst	O
two	O
columns	O
becomes	O
zero	O
.	O
for	O
instance	O
,	O
to	O
set	O
the	O
entry	O
a21	O
to	O
zero	O
,	O
we	O
need	O
to	O
solve	O
the	O
equation	O
ca21	O
+	O
sa22	O
=	O
0.	O
the	O
solution	B
to	O
this	O
is	O
c	O
=	O
−a22/	O
(	O
a2	O
21	O
)	O
1/2	O
.	O
it	O
is	O
required	O
that	O
c2	O
+	O
s2	O
=	O
1	O
since	O
c	O
=	O
cos	O
(	O
θ	O
)	O
and	O
s	O
=	O
sin	O
(	O
θ	O
)	O
,	O
and	O
the	O
values	O
of	O
c	O
and	O
s	O
given	O
here	O
satisfy	O
that	O
requirement	O
.	O
the	O
strategy	O
of	O
the	O
rq	O
algorithm	B
is	O
to	O
clear	O
out	O
the	O
lower	O
half	O
of	O
the	O
matrix	O
one	O
entry	O
at	O
a	O
time	O
by	O
multiplication	O
by	O
givens	O
rotations	B
.	O
consider	O
the	O
decomposition	B
of	I
a	O
3	O
×	O
3	O
matrix	B
a	O
as	O
a	O
=	O
rq	O
where	O
r	O
is	O
upper-triangular	O
and	O
q	O
is	O
a	O
rotation	B
matrix	O
.	O
this	O
may	O
take	O
place	O
in	O
three	O
steps	O
.	O
each	O
step	O
consists	O
of	O
multiplication	O
on	O
the	O
right	O
by	O
a	O
givens	O
rotation	B
to	O
set	O
a	O
chosen	O
entry	O
of	O
the	O
matrix	O
a	O
to	O
zero	O
.	O
the	O
sequence	O
of	O
multiplications	O
must	O
be	O
chosen	O
in	O
such	O
a	O
way	O
as	O
not	O
to	O
disturb	O
the	O
entries	O
that	O
have	O
already	O
been	O
set	O
to	O
zero	O
.	O
an	O
implementation	B
of	O
the	O
rq	O
decomposition	B
is	O
given	O
in	O
algorithm	O
a4.1	O
.	O
21	O
)	O
1/2	O
and	O
s	O
=	O
a21/	O
(	O
a2	O
22	O
+	O
a2	O
22	O
+	O
a2	O
objective	O
carry	O
out	O
the	O
rq	O
decomposition	B
of	I
a	O
3	O
×	O
3	O
matrix	B
a	O
using	O
givens	O
rotations	B
.	O
algorithm	B
(	O
i	O
)	O
multiply	O
by	O
qx	O
so	O
as	O
to	O
set	O
a32	O
to	O
zero	O
.	O
(	O
ii	O
)	O
multiply	O
by	O
qy	O
so	O
as	O
to	O
set	O
a31	O
to	O
zero	O
.	O
this	O
multiplication	O
does	O
not	O
change	O
the	O
second	O
column	O
of	O
a	O
,	O
hence	O
a32	O
remains	O
zero	O
.	O
(	O
iii	O
)	O
multiply	O
by	O
qz	O
so	O
as	O
to	O
set	O
a21	O
to	O
zero	O
.	O
the	O
ﬁrst	O
two	O
columns	O
are	O
replaced	O
by	O
linear	B
combinations	O
of	O
themselves	O
.	O
thus	O
,	O
a31	O
and	O
a32	O
remain	O
zero	O
.	O
algorithm	B
a4.1	O
.	O
rq	O
decomposition	B
of	I
a	O
3	O
×	O
3	O
matrix	B
.	O
other	O
sequences	O
of	O
givens	O
rotations	B
may	O
be	O
chosen	O
to	O
give	O
the	O
same	O
result	O
.	O
as	O
a	O
result	O
of	O
these	O
operations	O
,	O
we	O
ﬁnd	O
that	O
aqxqyqz	O
=	O
r	O
where	O
r	O
is	O
upper-triangular	O
.	O
qt	O
consequently	O
,	O
a	O
=	O
rqt	O
x	O
is	O
a	O
rotation	B
.	O
in	O
z	O
addition	O
,	O
the	O
angles	O
θx	O
,	O
θy	O
and	O
θz	O
associated	O
with	O
the	O
three	O
givens	O
rotations	B
provide	O
a	O
parametrization	B
of	I
the	O
rotation	B
by	O
three	O
euler	O
angles	O
,	O
otherwise	O
known	O
as	O
roll	O
,	O
pitch	O
and	O
yaw	O
angles	O
.	O
qt	O
x	O
,	O
and	O
so	O
a	O
=	O
rq	O
where	O
q	O
=	O
qt	O
qt	O
y	O
qt	O
y	O
z	O
it	O
should	O
be	O
clear	O
from	O
this	O
description	O
of	O
the	O
decomposition	O
algorithm	B
how	O
similar	O
qr	O
,	O
ql	O
and	O
lq	O
factorizations	O
may	O
be	O
carried	O
out	O
.	O
furthermore	O
,	O
the	O
algorithm	B
is	O
easily	O
generalized	O
to	O
higher	O
dimensions	O
.	O
580	O
appendix	O
4	O
matrix	B
properties	O
and	O
decompositions	O
a4.1.2	O
householder	O
matrices	O
and	O
qr	O
decomposition	B
for	O
matrices	O
of	O
larger	O
dimension	O
,	O
the	O
qr	O
decomposition	B
is	O
more	O
efﬁciently	O
carried	O
out	O
using	O
householder	O
matrices	O
.	O
the	O
symmetric	B
matrix	O
hv	O
=	O
i	O
−	O
2vvt/vtv	O
v	O
hv	O
=	O
i	O
,	O
and	O
so	O
hv	O
is	O
orthogonal	B
.	O
has	O
the	O
property	O
that	O
ht	O
let	O
e1	O
be	O
the	O
vector	O
(	O
1	O
,	O
0	O
,	O
.	O
.	O
.	O
,0	O
)	O
t	O
,	O
and	O
let	O
x	O
be	O
any	O
vector	O
.	O
let	O
v	O
=	O
x	O
±	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
e1	O
.	O
one	O
easily	O
veriﬁes	O
that	O
hvx	O
=	O
∓	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
e1	O
;	O
thus	O
hv	O
is	O
an	O
orthogonal	B
matrix	O
that	O
transforms	O
the	O
vector	O
x	O
to	O
a	O
multiple	O
of	O
e1	O
.	O
geometrically	O
hv	O
is	O
a	O
reﬂection	O
in	O
the	O
plane	B
perpendicular	O
to	O
v	O
,	O
and	O
v	O
=	O
x	O
±	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
e1	O
is	O
a	O
vector	O
that	O
bisects	O
x	O
and	O
±	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
e1	O
.	O
thus	O
reﬂection	O
in	O
the	O
v	O
direction	O
takes	O
x	O
to	O
∓	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
e1	O
.	O
for	O
reasons	O
of	O
stability	O
,	O
the	O
sign	O
ambiguity	B
in	O
deﬁning	O
v	O
should	O
be	O
resolved	O
by	O
setting	O
(	O
a4.2	O
)	O
v	O
=	O
x	O
+	O
sign	O
(	O
x1	O
)	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
e1	O
.	O
(	O
a4.3	O
)	O
if	O
a	O
is	O
a	O
matrix	B
,	O
x	O
is	O
the	O
ﬁrst	O
column	O
of	O
a	O
,	O
and	O
v	O
is	O
deﬁned	O
by	O
(	O
a4.3	O
)	O
,	O
then	O
forming	O
the	O
product	O
hva	O
will	O
clear	O
out	O
the	O
ﬁrst	O
column	O
of	O
the	O
matrix	B
,	O
replacing	O
the	O
ﬁrst	O
column	O
by	O
(	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
,	O
0	O
,	O
0	O
,	O
.	O
.	O
.	O
,0	O
)	O
t.	O
one	O
continues	O
left	O
multiplication	O
by	O
orthogonal	B
householder	O
matrices	O
to	O
clear	O
out	O
the	O
below-diagonal	O
part	O
of	O
the	O
matrix	O
a.	O
in	O
this	O
way	O
,	O
one	O
ﬁnds	O
that	O
eventually	O
qa	O
=	O
r	O
,	O
where	O
q	O
is	O
a	O
product	O
of	O
orthogonal	O
matrices	O
and	O
r	O
is	O
an	O
upper-	O
triangular	O
matrix	B
.	O
therefore	O
,	O
one	O
has	O
a	O
=	O
qtr	O
.	O
this	O
is	O
the	O
qr	O
decomposition	B
of	I
the	O
matrix	B
a.	O
when	O
multiplying	O
by	O
householder	O
matrices	O
it	O
is	O
inefﬁcient	O
to	O
form	O
the	O
householder	O
matrix	B
explicitly	O
.	O
multiplication	O
by	O
a	O
vector	O
a	O
may	O
be	O
carried	O
out	O
most	O
efﬁciently	O
as	O
hva	O
=	O
(	O
i	O
−	O
2vvt/vtv	O
)	O
a	O
=	O
a	O
−	O
2v	O
(	O
vta	O
)	O
/vvt	O
(	O
a4.4	O
)	O
and	O
the	O
same	O
holds	O
for	O
multiplication	O
by	O
a	O
matrix	B
a.	O
for	O
more	O
about	O
householder	O
matrices	O
and	O
the	O
qr	O
decomposition	B
,	O
the	O
reader	O
is	O
referred	O
to	O
[	O
golub-89	O
]	O
.	O
note	O
.	O
in	O
the	O
qr	O
or	O
rq	O
decomposition	B
,	O
r	O
refers	O
to	O
an	O
upper-triangular	O
matrix	B
and	O
q	O
refers	O
to	O
an	O
orthogonal	B
matrix	O
.	O
in	O
the	O
notation	O
used	O
elsewhere	O
in	O
this	O
book	O
,	O
r	O
refers	O
usually	O
to	O
a	O
rotation	B
(	O
hence	O
orthogonal	B
)	O
matrix	B
.	O
a4.2	O
symmetric	B
and	O
skew-symmetric	O
matrices	O
symmetric	B
and	O
skew-symmetric	O
matrices	O
play	O
an	O
important	O
role	O
in	O
this	O
book	O
.	O
a	O
ma-	O
trix	O
is	O
called	O
symmetric	B
if	O
at	O
=	O
a	O
and	O
skew-symmetric	O
if	O
at	O
=	O
−a	O
.	O
the	O
eigenvalue	O
decompositions	O
of	O
these	O
matrices	O
are	O
summarized	O
in	O
the	O
following	O
result	O
.	O
result	O
a4.1	O
.	O
eigenvalue	O
decomposition	O
.	O
(	O
i	O
)	O
if	O
a	O
is	O
a	O
real	O
symmetric	B
matrix	O
,	O
then	O
a	O
can	O
be	O
decomposed	O
as	O
a	O
=	O
udut	O
,	O
where	O
u	O
is	O
an	O
orthogonal	B
matrix	O
and	O
d	O
is	O
a	O
real	O
diagonal	O
matrix	B
.	O
thus	O
,	O
a	O
real	O
symmetric	B
matrix	O
has	O
real	O
eigenvalues	O
,	O
and	O
the	O
eigenvectors	O
are	O
orthogonal	B
.	O
(	O
ii	O
)	O
if	O
s	O
is	O
real	O
and	O
skew-symmetric	O
,	O
then	O
s	O
=	O
ubut	O
where	O
b	O
is	O
a	O
block-diagonal	O
a4.2	O
symmetric	B
and	O
skew-symmetric	O
matrices	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
581	O
matrix	B
of	O
the	O
form	O
diag	O
(	O
a1z	O
,	O
a2z	O
,	O
.	O
.	O
.	O
,	O
amz	O
,	O
0	O
,	O
.	O
.	O
.	O
,0	O
)	O
,	O
where	O
z	O
=	O
the	O
eigenvectors	O
of	O
s	O
are	O
all	O
purely	O
imaginary	O
,	O
and	O
a	O
skew-symmetric	O
matrix	O
of	O
odd	O
order	O
is	O
singular	O
.	O
.	O
0	O
1−1	O
0	O
a	O
proof	O
of	O
this	O
result	O
is	O
given	O
in	O
[	O
golub-89	O
]	O
.	O
jacobi	O
’	O
s	O
method	O
.	O
in	O
general	O
,	O
eigenvalue	B
extraction	I
from	O
arbitrary	O
matrices	O
is	O
a	O
dif-	O
ﬁcult	O
numerical	O
problem	O
.	O
for	O
real	O
symmetric	B
matrices	I
however	O
,	O
a	O
very	O
stable	O
method	O
exists	O
:	O
jacobi	O
’	O
s	O
method	O
.	O
an	O
implementation	B
of	O
this	O
algorithm	B
is	O
given	O
in	O
[	O
press-88	O
]	O
.	O
cross	O
products	O
of	O
particular	O
interest	O
are	O
3	O
×	O
3	O
skew-symmetric	O
matrices	O
.	O
if	O
a	O
=	O
(	O
a1	O
,	O
a2	O
,	O
a3	O
)	O
t	O
is	O
a	O
3-vector	O
,	O
then	O
one	O
deﬁnes	O
a	O
corresponding	O
skew-symmetric	O
matrix	O
as	O
follows	O
:	O
	O
0	O
−a3	O
a3	O
−a2	O
a2	O
0	O
−a1	O
a1	O
0	O
	O
.	O
[	O
a	O
]	O
×	O
=	O
(	O
a4.5	O
)	O
note	O
that	O
any	O
skew-symmetric	O
3	O
×	O
3	O
matrix	B
may	O
be	O
written	O
in	O
the	O
form	O
[	O
a	O
]	O
×	O
for	O
a	O
suitable	O
vector	O
a.	O
matrix	B
[	O
a	O
]	O
×	O
is	O
singular	O
,	O
and	O
a	O
is	O
its	O
null-vector	O
(	O
right	O
or	O
left	O
)	O
.	O
hence	O
,	O
a	O
3	O
×	O
3	O
skew-symmetric	O
matrix	O
is	O
deﬁned	O
up	O
to	O
scale	O
by	O
its	O
null-vector	O
.	O
the	O
cross	B
product	I
(	O
or	O
vector	O
product	O
)	O
of	O
two	O
3-vectors	O
a	O
×	O
b	O
(	O
sometimes	O
written	O
a	O
∧	O
b	O
)	O
is	O
the	O
vector	O
(	O
a2b3	O
−	O
a3b2	O
,	O
a3b1	O
−	O
a1b3	O
,	O
a1b2	O
−	O
a2b1	O
)	O
t.	O
the	O
cross	B
product	I
is	O
related	O
to	O
skew-symmetric	O
matrices	O
according	O
to	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
t	O
a	O
×	O
b	O
=	O
[	O
a	O
]	O
×b	O
=	O
at	O
[	O
b	O
]	O
×	O
.	O
(	O
a4.6	O
)	O
cofactor	O
and	O
adjoint	O
matrices	O
.	O
let	O
m	O
be	O
a	O
square	O
matrix	B
.	O
by	O
m∗	O
is	O
meant	O
the	O
matrix	B
is	O
equal	O
to	O
(	O
−1	O
)	O
i+j	O
det	O
ˆmij	O
,	O
of	O
cofactors	O
of	O
m.	O
that	O
is	O
,	O
the	O
(	O
ij	O
)	O
-th	O
entry	O
of	O
the	O
matrix	O
m∗	O
where	O
ˆmij	O
is	O
the	O
matrix	B
obtained	O
from	O
m	O
by	O
striking	O
out	O
the	O
i-th	O
row	O
and	O
j-th	O
column	O
.	O
the	O
transpose	O
of	O
the	O
cofactor	O
matrix	B
m∗	O
is	O
known	O
as	O
the	O
adjoint	O
of	O
m	O
,	O
and	O
denoted	O
adj	O
(	O
m	O
)	O
.	O
if	O
m	O
is	O
invertible	O
,	O
then	O
it	O
is	O
well	O
known	O
that	O
(	O
a4.7	O
)	O
where	O
m−t	O
is	O
the	O
inverse	O
transpose	O
of	O
m.	O
this	O
formula	O
does	O
not	O
hold	O
for	O
non-invertible	O
matrices	O
,	O
but	O
adj	O
(	O
m	O
)	O
m	O
=	O
m	O
adj	O
(	O
m	O
)	O
=	O
det	O
(	O
m	O
)	O
i	O
is	O
always	O
valid	O
.	O
m∗	O
=	O
det	O
(	O
m	O
)	O
m−t	O
the	O
cofactor	B
matrix	I
is	O
related	O
to	O
the	O
way	O
matrices	O
distribute	O
with	O
respect	O
to	O
the	O
cross	B
product	I
.	O
lemma	O
a4.2	O
.	O
if	O
m	O
is	O
any	O
3	O
×	O
3	O
matrix	B
(	O
invertible	O
or	O
not	O
)	O
,	O
and	O
x	O
and	O
y	O
are	O
column	O
vectors	O
,	O
then	O
(	O
mx	O
)	O
×	O
(	O
my	O
)	O
=m	O
∗	O
(	O
x	O
×	O
y	O
)	O
.	O
(	O
a4.8	O
)	O
582	O
appendix	O
4	O
matrix	B
properties	O
and	O
decompositions	O
this	O
equation	O
may	O
be	O
written	O
as	O
[	O
mx	O
]	O
×m	O
=	O
m∗	O
[	O
x	O
]	O
×	O
,	O
dropping	O
y	O
which	O
is	O
inessential	O
.	O
now	O
,	O
putting	O
t	O
=	O
mx	O
and	O
assuming	O
m	O
is	O
invertible	O
,	O
one	O
obtains	O
a	O
rule	O
for	O
commuting	O
a	O
skew-symmetric	O
matrix	O
[	O
t	O
]	O
×	O
with	O
any	O
non-singular	O
matrix	B
m.	O
one	O
may	O
write	O
(	O
a4.8	O
)	O
as	O
follows	O
.	O
result	O
a4.3	O
.	O
for	O
any	O
vector	O
t	O
and	O
non-singular	O
matrix	B
m	O
one	O
has	O
[	O
m−1t	O
]	O
×	O
=	O
m−t	O
[	O
m−1t	O
]	O
×	O
(	O
up	O
to	O
scale	O
)	O
.	O
[	O
t	O
]	O
×m	O
=	O
m∗	O
note	O
(	O
see	O
result	O
9.9	O
(	O
p254	O
)	O
)	O
that	O
[	O
t	O
]	O
×m	O
is	O
the	O
form	B
of	I
the	O
fundamental	B
matrix	I
for	O
a	O
pair	O
of	O
cameras	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
m|t	O
]	O
.	O
the	O
formula	O
of	O
result	O
a4.3	O
is	O
used	O
in	O
deriving	O
alternative	O
forms	O
(	O
9.2–p244	O
)	O
for	O
the	O
fundamental	B
matrix	I
.	O
a	O
curious	O
property	O
of	O
3	O
×	O
3	O
skew-symmetric	O
matrices	O
is	O
that	O
up	O
to	O
scale	O
,	O
[	O
a	O
]	O
×	O
=	O
[	O
a	O
]	O
×	O
[	O
a	O
]	O
×	O
[	O
a	O
]	O
×	O
(	O
including	O
scale	O
[	O
a	O
]	O
3×	O
=	O
−	O
(	O
cid:10	O
)	O
a	O
(	O
cid:10	O
)	O
2	O
[	O
a	O
]	O
×	O
)	O
.	O
this	O
is	O
easily	O
veriﬁed	O
,	O
since	O
the	O
right	O
hand	O
side	O
is	O
clearly	O
skew-symmetric	O
and	O
its	O
null-space	B
generator	O
is	O
a.	O
the	O
next	O
result	O
follows	O
immediately	O
:	O
result	O
a4.4	O
.	O
if	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×	O
[	O
e	O
(	O
cid:2	O
)	O
[	O
e	O
(	O
cid:2	O
)	O
m	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×f	O
=	O
f	O
(	O
up	O
to	O
scale	O
)	O
.	O
hence	O
one	O
may	O
decompose	O
f	O
as	O
f	O
=	O
[	O
e	O
(	O
cid:2	O
)	O
]	O
×f	O
.	O
]	O
×m	O
is	O
a	O
fundamental	B
matrix	I
(	O
a	O
3	O
×	O
3	O
singular	O
matrix	O
)	O
,	O
then	O
]	O
×m	O
,	O
where	O
a4.2.1	O
positive-deﬁnite	O
symmetric	O
matrices	O
the	O
special	O
class	O
of	O
real	O
symmetric	B
matrices	I
that	O
have	O
positive	O
real	O
eigenvalues	O
are	O
called	O
positive-deﬁnite	O
symmetric	O
matrices	O
.	O
we	O
list	O
some	O
of	O
the	O
important	O
properties	B
of	O
a	O
positive-deﬁnite	O
symmetric	O
real	O
matrix	B
.	O
result	O
a4.5	O
.	O
positive-deﬁnite	O
symmetric	O
real	O
matrix	B
.	O
(	O
i	O
)	O
a	O
symmetric	B
matrix	O
a	O
is	O
positive-deﬁnite	O
if	O
and	O
only	O
if	O
xtax	O
>	O
0	O
for	O
any	O
non-	O
zero	O
vector	O
x	O
.	O
(	O
ii	O
)	O
a	O
positive-deﬁnite	O
symmetric	O
matrix	B
a	O
may	O
be	O
uniquely	O
decomposed	O
as	O
a	O
=	O
kkt	O
where	O
k	O
is	O
an	O
upper-triangular	O
real	O
matrix	B
with	O
positive	O
diagonal	O
entries	O
.	O
proof	O
.	O
the	O
ﬁrst	O
part	O
of	O
this	O
result	O
follows	O
almost	O
immediately	O
from	O
the	O
decomposition	B
a	O
=	O
udut	O
.	O
as	O
for	O
the	O
second	O
part	O
,	O
since	O
a	O
is	O
symmetric	B
and	O
positive-deﬁnite	O
,	O
it	O
may	O
be	O
written	O
as	O
a	O
=	O
udut	O
where	O
d	O
is	O
diagonal	O
,	O
real	O
and	O
positive	O
and	O
u	O
is	O
orthogonal	B
.	O
we	O
may	O
take	O
the	O
square	O
root	O
of	O
d	O
,	O
writing	O
d	O
=	O
eet	O
where	O
e	O
is	O
diagonal	O
.	O
then	O
a	O
=	O
vvt	O
where	O
v	O
=	O
ue	O
.	O
the	O
matrix	B
v	O
is	O
not	O
upper-triangular	O
.	O
however	O
,	O
we	O
may	O
apply	O
the	O
rq-	O
decomposition	B
(	O
section	O
a4.1.1	O
)	O
to	O
write	O
v	O
=	O
kq	O
where	O
k	O
is	O
upper-triangular	O
and	O
q	O
is	O
orthogonal	B
.	O
then	O
a	O
=	O
vvt	O
=	O
kqqtkt	O
=	O
kkt	O
.	O
this	O
is	O
the	O
cholesky	O
factorization	B
of	O
a.	O
one	O
may	O
ensure	O
that	O
the	O
diagonal	O
entries	O
of	O
k	O
are	O
all	O
positive	O
by	O
multiplying	O
k	O
on	O
the	O
right	O
by	O
a	O
diagonal	O
matrix	B
with	O
diagonal	O
entries	O
equal	O
to	O
±1	O
.	O
this	O
will	O
not	O
change	O
the	O
product	O
kkt	O
.	O
a4.3	O
representations	O
of	B
rotation	I
matrices	O
583	O
1	O
=	O
k2kt	O
now	O
,	O
we	O
prove	O
uniqueness	B
of	O
the	O
factorization	B
.	O
speciﬁcally	O
,	O
if	O
k1	O
and	O
k2	O
are	O
two	O
upper-	O
triangular	O
matrices	O
satisfying	O
k1kt	O
.	O
since	O
the	O
left	O
side	O
of	O
this	O
equation	O
is	O
upper-triangular	O
,	O
and	O
the	O
right	O
side	O
is	O
lower-triangular	O
,	O
they	O
must	O
both	O
in	O
fact	O
be	O
diagonal	O
.	O
thus	O
d	O
=	O
k−1	O
k1	O
is	O
the	O
inverse	O
transpose	O
of	O
kt	O
,	O
and	O
so	O
d	O
is	O
equal	O
to	O
its	O
own	O
inverse	O
transpose	O
,	O
and	O
hence	O
is	O
a	O
diagonal	O
matrix	B
with	O
diagonal	O
entries	O
equal	O
to	O
±1	O
.	O
if	O
both	O
k1	O
and	O
k2	O
have	O
positive	O
diagonal	O
entries	O
then	O
2	O
d	O
=	O
i	O
,	O
and	O
k1	O
=	O
k2	O
.	O
k1	O
=	O
kt	O
2	O
.	O
however	O
,	O
k−1	O
2	O
then	O
k−1	O
k−t	O
2	O
k1	O
=	O
kt	O
2	O
k−t	O
1	O
k−t	O
1	O
2	O
1	O
2	O
the	O
above	O
proof	O
gives	O
a	O
constructive	O
method	O
for	O
computing	O
the	O
cholesky	O
factoriza-	O
tion	O
.	O
there	O
is	O
,	O
however	O
,	O
a	O
very	O
simple	O
and	O
more	O
efﬁcient	O
direct	O
method	O
for	O
computing	O
the	O
cholesky	O
factorization	B
.	O
see	O
[	O
press-88	O
]	O
for	O
an	O
implementation	B
.	O
a4.3	O
representations	O
of	B
rotation	I
matrices	O
a4.3.1	O
rotations	B
in	O
n-dimensions	O
given	O
a	O
matrix	B
t	O
,	O
we	O
deﬁne	O
et	O
to	O
be	O
the	O
sum	O
of	O
the	O
series	O
et	O
=	O
i	O
+	O
t	O
+	O
t2/2	O
!	O
+	O
.	O
.	O
.	O
+	O
tk/k	O
!	O
+	O
.	O
.	O
.	O
this	O
series	O
converges	O
absolutely	O
for	O
all	O
values	O
of	O
t.	O
now	O
,	O
we	O
consider	O
powers	O
of	O
a	O
skew-symmetric	O
matrix	B
.	O
according	O
to	O
result	O
a4.1	O
a	O
skew-symmetric	O
ma-	O
trix	O
can	O
be	O
written	O
as	O
s	O
=	O
ubut	O
where	O
b	O
is	O
block	O
diagonal	O
of	O
the	O
form	O
b	O
=	O
diag	O
(	O
a1z	O
,	O
a2z	O
,	O
.	O
.	O
.	O
,	O
amz	O
,	O
0	O
,	O
.	O
.	O
.	O
,0	O
)	O
,	O
matrix	B
u	O
is	O
orthogonal	B
,	O
and	O
z2	O
=	O
−i2×2	O
.	O
we	O
ob-	O
serve	O
that	O
the	O
powers	O
of	O
z	O
are	O
z2	O
=	O
−i	O
;	O
z3	O
=	O
−z	O
;	O
z4	O
=	O
i	O
and	O
so	O
on	O
.	O
thus	O
,	O
ez	O
=	O
i	O
+	O
z	O
−	O
i/2	O
!	O
−	O
z/3	O
!	O
+	O
.	O
.	O
.	O
=	O
cos	O
(	O
1	O
)	O
i	O
+	O
sin	O
(	O
1	O
)	O
z	O
=	O
r2×2	O
(	O
1	O
)	O
where	O
r2×2	O
(	O
1	O
)	O
means	O
the	O
2	O
×	O
2	O
matrix	B
representing	O
a	O
rotation	B
through	O
1	O
radian	O
.	O
more	O
generally	O
,	O
eaz	O
=	O
cos	O
(	O
a	O
)	O
i	O
+	O
sin	O
(	O
a	O
)	O
z	O
=	O
r2×2	O
(	O
a	O
)	O
.	O
with	O
s	O
=	O
ubut	O
as	O
above	O
,	O
it	O
now	O
follows	O
that	O
es	O
=	O
uebut	O
=	O
u	O
diag	O
(	O
r	O
(	O
a1	O
)	O
,	O
r	O
(	O
a2	O
)	O
,	O
.	O
.	O
.	O
,	O
r	O
(	O
am	O
)	O
,	O
1	O
,	O
.	O
.	O
.	O
,1	O
)	O
ut	O
thus	O
es	O
is	O
a	O
rotation	B
matrix	O
.	O
on	O
the	O
other	O
hand	O
,	O
any	O
rotation	B
matrix	O
may	O
be	O
written	O
in	O
the	O
block-diagonal	O
form	O
u	O
diag	O
(	O
r	O
(	O
a1	O
)	O
,	O
r	O
(	O
a2	O
)	O
,	O
.	O
.	O
.	O
,	O
r	O
(	O
am	O
)	O
,	O
1	O
,	O
.	O
.	O
.	O
,1	O
)	O
ut	O
,	O
and	O
it	O
follows	O
that	O
the	O
matrices	O
es	O
where	O
s	O
is	O
an	O
n	O
×	O
n	O
skew-symmetric	O
are	O
exactly	O
the	O
set	O
of	O
n-	O
dimensional	O
rotation	B
matrices	O
.	O
a4.3.2	O
rotations	B
in	O
3-dimensions	O
if	O
t	O
is	O
a	O
3-vector	O
,	O
then	O
[	O
t	O
]	O
×	O
is	O
a	O
skew-symmetric	O
matrix	O
,	O
and	O
any	O
3	O
×	O
3	O
skew-symmetric	O
matrix	O
is	O
of	O
this	O
form	O
.	O
consequently	O
,	O
any	O
3-dimensional	O
rotation	B
can	O
be	O
written	O
as	O
e	O
[	O
t	O
]	O
×	O
.	O
we	O
seek	O
to	O
describe	O
the	O
rotation	B
e	O
[	O
t	O
]	O
×	O
.	O
584	O
appendix	O
4	O
matrix	B
properties	O
and	O
decompositions	O
let	O
[	O
t	O
]	O
×	O
=	O
u	O
diag	O
(	O
az	O
,	O
0	O
)	O
ut	O
.	O
then	O
by	O
matching	B
the	O
frobenius	O
norms	O
of	O
the	O
matrices	O
on	O
both	O
sides	O
,	O
we	O
see	O
that	O
a	O
=	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
.	O
thus	O
,	O
e	O
[	O
t	O
]	O
×	O
=	O
u	O
diag	O
(	O
r	O
(	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
)	O
,	O
1	O
)	O
ut	O
.	O
thus	O
,	O
e	O
[	O
t	O
]	O
×	O
represents	O
a	O
rotation	B
through	O
an	O
angle	B
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
.	O
it	O
is	O
easily	O
veriﬁed	O
that	O
u3	O
,	O
the	O
3-rd	O
column	O
of	O
u	O
is	O
the	O
eigenvector	O
of	O
u	O
diag	O
(	O
r	O
,	O
1	O
)	O
ut	O
with	O
unit	O
eigenvector	O
,	O
hence	O
the	O
axis	O
of	O
rotation	B
.	O
however	O
,	O
[	O
t	O
]	O
×u3	O
=	O
udiag	O
(	O
az	O
,	O
0	O
)	O
utu3	O
=	O
u	O
diag	O
(	O
az	O
,	O
0	O
)	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
=	O
0.	O
since	O
u3	O
is	O
the	O
generator	B
of	O
the	O
null	O
space	O
of	O
[	O
t	O
]	O
×	O
,	O
it	O
must	O
be	O
that	O
u3	O
is	O
a	O
unit	O
vector	O
in	O
the	O
direction	O
of	O
t.	O
we	O
have	O
shown	O
result	O
a4.6	O
.	O
the	O
matrix	B
e	O
[	O
t	O
]	O
×	O
is	O
a	O
rotation	B
matrix	O
representing	O
a	O
rotation	B
through	O
an	O
angle	B
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
about	O
the	O
axis	O
represented	O
by	O
the	O
vector	O
t.	O
this	O
representation	B
of	O
a	O
rotation	B
is	O
called	O
the	O
angle-axis	O
representation	O
.	O
we	O
may	O
write	O
a	O
speciﬁc	O
formula	O
for	O
the	O
rotation	B
matrix	O
corresponding	O
to	O
e	O
[	O
t	O
]	O
×	O
.	O
we	O
observe	O
that	O
[	O
t	O
]	O
3×	O
=	O
−	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
2	O
[	O
t	O
]	O
×	O
=	O
−	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
3	O
[	O
ˆt	O
]	O
×	O
,	O
where	O
ˆt	O
represents	O
a	O
unit	O
vector	O
in	O
the	O
direction	O
t.	O
then	O
,	O
with	O
sinc	O
(	O
θ	O
)	O
representing	O
sin	O
(	O
θ	O
)	O
/θ	O
,	O
we	O
have	O
e	O
[	O
t	O
]	O
×	O
=	O
i	O
+	O
[	O
t	O
]	O
×	O
+	O
[	O
t	O
]	O
2×/2	O
!	O
+	O
[	O
t	O
]	O
3×/3	O
!	O
+	O
[	O
t	O
]	O
4×/4	O
!	O
+	O
.	O
.	O
.	O
=	O
i	O
+	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
[	O
ˆt	O
]	O
×	O
+	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
2	O
[	O
ˆt	O
]	O
2×/2	O
!	O
−	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
3	O
[	O
ˆt	O
]	O
×/3	O
!	O
−	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
4	O
[	O
ˆt	O
]	O
2×/4	O
!	O
+	O
.	O
.	O
.	O
=	O
i	O
+	O
sin	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
[	O
ˆt	O
]	O
×	O
+	O
(	O
1	O
−	O
cos	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
)	O
[	O
ˆt	O
]	O
2×	O
=	O
i	O
+	O
sinc	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
[	O
t	O
]	O
×	O
+	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
2	O
[	O
t	O
]	O
2×	O
=	O
cos	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
i	O
+	O
sinc	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
[	O
t	O
]	O
×	O
+	O
1	O
−	O
cos	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
1	O
−	O
cos	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
2	O
ttt	O
(	O
a4.9	O
)	O
where	O
the	O
last	O
line	B
follows	O
from	O
the	O
identity	O
[	O
t	O
]	O
2×	O
=	O
ttt	O
−	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
2i	O
.	O
some	O
properties	B
of	O
these	O
representations	O
:	O
(	O
i	O
)	O
extraction	O
of	O
the	O
axis	O
and	O
rotation	B
angle	O
from	O
a	O
rotation	B
matrix	O
r	O
is	O
just	O
a	O
little	O
tricky	O
.	O
the	O
unit	O
rotation	B
axis	O
v	O
can	O
be	O
found	O
as	O
the	O
eigenvector	O
corresponding	O
to	O
the	O
unit	O
eigenvalue	O
–	O
that	O
is	O
by	O
solving	B
(	O
r	O
−	O
i	O
)	O
v	O
=	O
0.	O
next	O
,	O
it	O
is	O
easily	O
seen	O
from	O
(	O
a4.9	O
)	O
that	O
the	O
rotation	B
angle	O
φ	O
satisﬁes	O
2	O
cos	O
(	O
φ	O
)	O
=	O
(	O
trace	O
(	O
r	O
)	O
−	O
1	O
)	O
2	O
sin	O
(	O
φ	O
)	O
v	O
=	O
(	O
r32	O
−	O
r23	O
,	O
r13	O
−	O
r31	O
,	O
r21	O
−	O
r12	O
)	O
t.	O
(	O
a4.10	O
)	O
writing	O
this	O
second	O
equation	O
as	O
2	O
sin	O
(	O
φ	O
)	O
v	O
=	O
ˆv	O
,	O
we	O
can	O
then	O
compute	O
2	O
sin	O
(	O
φ	O
)	O
=	O
vt	O
ˆv	O
.	O
now	O
,	O
the	O
angle	B
φ	O
can	O
be	O
computed	O
from	O
sin	O
(	O
φ	O
)	O
and	O
cos	O
(	O
φ	O
)	O
using	O
a	O
two-	O
argument	O
arctan	O
function	O
(	O
such	O
as	O
the	O
c-language	O
function	O
atan2	O
(	O
y	O
,	O
x	O
)	O
)	O
.	O
it	O
has	O
often	O
been	O
written	O
that	O
φ	O
can	O
be	O
computed	O
directly	O
from	O
(	O
a4.10	O
)	O
using	O
arccos	O
or	O
arcsin	O
.	O
however	O
,	O
this	O
method	O
is	O
not	O
numerically	O
accurate	O
,	O
and	O
fails	O
to	O
ﬁnd	O
the	O
axis	O
when	O
φ	O
=	O
π	O
.	O
(	O
ii	O
)	O
to	O
apply	O
a	O
rotation	B
r	O
(	O
t	O
)	O
to	O
some	O
vector	O
x	O
,	O
it	O
is	O
not	O
necessary	O
to	O
construct	O
the	O
matrix	B
representation	O
of	O
t.	O
in	O
fact	O
a4.4	O
singular	O
value	O
decomposition	B
(	O
cid:20	O
)	O
i	O
+	O
sinc	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
[	O
t	O
]	O
×	O
+	O
=	O
x	O
+	O
sinc	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
t	O
×	O
x	O
+	O
r	O
(	O
t	O
)	O
x	O
=	O
(	O
cid:21	O
)	O
1	O
−	O
cos	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
1	O
−	O
cos	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
2	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
2	O
x	O
[	O
t	O
]	O
2×	O
t	O
×	O
(	O
t	O
×	O
x	O
)	O
585	O
(	O
a4.11	O
)	O
(	O
iii	O
)	O
if	O
t	O
is	O
written	O
as	O
t	O
=	O
θˆt	O
,	O
where	O
ˆt	O
is	O
a	O
unit	O
vector	O
in	O
the	O
direction	O
of	O
the	O
axis	O
,	O
and	O
θ	O
=	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
is	O
the	O
angle	B
of	O
rotation	B
,	O
then	O
(	O
a4.9	O
)	O
is	O
equivalent	B
to	O
the	O
rodrigues	O
formula	O
for	O
a	O
rotation	O
matrix	B
:	O
r	O
(	O
θ	O
,	O
ˆt	O
)	O
=	O
i	O
+	O
sin	O
θ	O
[	O
ˆt	O
]	O
×	O
+	O
(	O
1	O
−	O
cos	O
θ	O
)	O
[	O
ˆt	O
]	O
2×	O
(	O
a4.12	O
)	O
a4.3.3	O
quaternions	B
three-dimensional	O
rotations	B
may	O
also	O
be	O
represented	O
by	O
unit	O
quaternions	B
.	O
a	O
unit	O
quaternion	O
is	O
a	O
4-vector	O
and	O
may	O
be	O
written	O
in	O
the	O
form	O
q	O
=	O
(	O
v	O
sin	O
(	O
θ/2	O
)	O
,	O
cos	O
(	O
θ/2	O
)	O
)	O
t	O
,	O
as	O
may	O
indeed	O
any	O
unit	O
4-vector	O
.	O
such	O
a	O
quaternion	O
represents	O
a	O
rotation	B
about	O
the	O
vector	O
v	O
through	O
the	O
angle	B
θ.	O
this	O
is	O
a	O
2-to-1	O
representation	B
in	O
that	O
both	O
q	O
and	O
−q	O
represent	O
the	O
same	O
rotation	O
.	O
to	O
check	O
this	O
,	O
note	O
that	O
−q	O
=	O
(	O
v	O
sin	O
(	O
θ/2	O
+	O
π	O
)	O
,	O
cos	O
(	O
θ/2	O
+	O
π	O
)	O
)	O
t	O
,	O
which	O
represents	O
a	O
rotation	B
through	O
θ	O
+	O
2π	O
=	O
θ.	O
the	O
relationship	O
between	O
the	O
angle-axis	O
representation	O
of	O
a	O
rotation	O
and	O
the	O
quater-	O
nion	O
representation	B
is	O
easily	O
determined	O
.	O
given	O
a	O
vector	O
t	O
,	O
the	O
angle-axis	O
representation	O
of	O
a	O
rotation	O
,	O
the	O
corresponding	O
quaternion	O
is	O
easily	O
seen	O
to	O
be	O
t	O
↔	O
q	O
=	O
(	O
sinc	O
(	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
/2	O
)	O
t	O
,	O
cos	O
(	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
/2	O
)	O
)	O
t	O
a4.4	O
singular	O
value	O
decomposition	B
the	O
singular	O
value	O
decomposition	B
(	O
svd	O
)	O
is	O
one	O
of	O
the	O
most	O
useful	O
matrix	B
decomposi-	O
tions	O
,	O
particularly	O
for	O
numerical	O
computations	O
.	O
its	O
most	O
common	O
application	O
is	O
in	O
the	O
solution	B
of	O
over-determined	B
systems	O
of	O
equations	O
.	O
given	O
a	O
square	O
matrix	B
a	O
,	O
the	O
svd	O
is	O
a	O
factorization	B
of	O
a	O
as	O
a	O
=	O
udvt	O
,	O
where	O
u	O
and	O
v	O
are	O
orthogonal	B
matrices	I
,	O
and	O
d	O
is	O
a	O
diagonal	O
matrix	B
with	O
non-negative	O
entries	O
.	O
note	O
that	O
it	O
is	O
conventional	O
to	O
write	O
vt	O
instead	O
of	O
v	O
in	O
this	O
decomposition	B
.	O
the	O
decomposition	B
may	O
be	O
carried	O
out	O
in	O
such	O
a	O
way	O
that	O
the	O
diagonal	O
entries	O
of	O
d	O
are	O
in	O
descending	O
order	O
,	O
and	O
we	O
will	O
assume	O
that	O
this	O
is	O
always	O
done	O
.	O
thus	O
a	O
circumlocutory	O
phrase	O
such	O
as	O
“	O
the	O
column	O
of	O
v	O
corresponding	O
to	O
the	O
smallest	O
singular	O
value	O
”	O
is	O
replaced	O
by	O
“	O
the	O
last	O
column	O
of	O
v.	O
”	O
the	O
svd	O
also	O
exists	O
for	O
non-square	O
matrices	O
a.	O
of	O
most	O
interest	O
is	O
the	O
case	O
where	O
a	O
has	O
more	O
rows	O
than	O
columns	O
.	O
speciﬁcally	O
,	O
let	O
a	O
be	O
an	O
m	O
×	O
n	O
matrix	B
with	O
m	O
≥	O
n.	O
in	O
this	O
case	O
a	O
may	O
be	O
factored	O
as	O
a	O
=	O
udvt	O
where	O
u	O
is	O
an	O
m	O
×	O
n	O
matrix	B
with	O
orthogonal	B
columns	O
,	O
d	O
is	O
an	O
n	O
×	O
n	O
diagonal	O
matrix	B
and	O
v	O
is	O
an	O
n	O
×	O
n	O
orthogonal	B
matrix	O
.	O
the	O
fact	O
that	O
u	O
has	O
orthogonal	B
columns	O
means	O
that	O
utu	O
=	O
in×n	O
.	O
furthermore	O
u	O
has	O
the	O
norm-	O
preserving	O
property	O
that	O
(	O
cid:10	O
)	O
ux	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
for	O
any	O
vector	O
x	O
,	O
as	O
one	O
readily	O
veriﬁes	O
.	O
on	O
the	O
other	O
hand	O
,	O
uut	O
is	O
in	O
general	O
not	O
the	O
identity	O
unless	O
m	O
=	O
n.	O
not	O
surprisingly	O
,	O
one	O
can	O
also	O
deﬁne	O
a	O
singular	O
value	O
decomposition	B
for	O
matrices	O
586	O
appendix	O
4	O
matrix	B
properties	O
and	O
decompositions	O
with	O
more	O
columns	O
than	O
rows	O
,	O
but	O
generally	O
this	O
will	O
not	O
be	O
of	O
interest	O
to	O
us	O
.	O
instead	O
on	O
the	O
occasional	O
instances	O
in	O
this	O
book	O
where	O
we	O
need	O
to	O
take	O
the	O
singular	O
value	O
de-	O
composition	O
of	O
a	O
matrix	O
a	O
with	O
m	O
<	O
n	O
,	O
it	O
is	O
appropriate	O
to	O
extend	O
a	O
by	O
adding	O
rows	O
of	O
zeros	O
to	O
obtain	O
a	O
square	O
matrix	B
,	O
and	O
then	O
take	O
the	O
svd	O
of	O
this	O
resulting	O
matrix	B
.	O
usually	O
this	O
will	O
be	O
done	O
without	O
special	O
remark	O
.	O
common	O
implementations	O
of	O
the	O
svd	O
,	O
such	O
as	O
the	O
one	O
in	O
[	O
press-88	O
]	O
,	O
assume	O
that	O
m	O
≥	O
n.	O
since	O
in	O
this	O
case	O
the	O
matrix	B
u	O
has	O
the	O
same	O
dimension	O
m	O
×	O
n	O
as	O
the	O
input	O
,	O
matrix	B
a	O
may	O
be	O
overwritten	O
by	O
the	O
output	O
matrix	B
u.	O
implementation	B
of	O
the	O
svd	O
.	O
a	O
description	O
of	O
the	O
singular	O
value	O
decomposition	B
al-	O
gorithm	O
,	O
or	O
a	O
proof	O
of	O
its	O
existence	O
,	O
is	O
not	O
given	O
in	O
this	O
book	O
.	O
for	O
a	O
description	O
of	O
how	O
the	O
algorithm	B
works	O
,	O
the	O
reader	O
is	O
referred	O
to	O
[	O
golub-89	O
]	O
.	O
a	O
practical	O
implementation	B
of	O
the	O
svd	O
is	O
given	O
in	O
[	O
press-88	O
]	O
.	O
however	O
,	O
the	O
implementation	B
of	O
the	O
svd	O
given	O
in	O
the	O
ﬁrst	O
edition	O
of	O
“	O
numerical	O
recipes	O
in	O
c	O
”	O
can	O
sometimes	O
give	O
incorrect	O
results	O
.	O
the	O
version	O
of	O
the	O
algorithm	O
given	O
in	O
the	O
second	O
edition	O
[	O
press-88	O
]	O
of	O
“	O
numerical	O
recipes	O
in	O
c	O
”	O
corrects	O
mistakes	O
in	O
the	O
earlier	O
version	O
.	O
singular	B
values	I
and	O
eigenvalues	O
.	O
the	O
diagonal	O
entries	O
of	O
matrix	O
d	O
in	O
the	O
svd	O
are	O
non-negative	O
.	O
these	O
entries	O
are	O
known	O
as	O
the	O
singular	B
values	I
of	O
the	O
matrix	B
a.	O
they	O
are	O
not	O
the	O
same	O
thing	O
as	O
eigenvalues	O
.	O
to	O
see	O
the	O
connection	O
of	O
the	O
singular	B
values	I
of	O
a	O
with	O
eigenvalues	O
,	O
we	O
start	O
with	O
a	O
=	O
udvt	O
.	O
from	O
this	O
it	O
follows	O
that	O
ata	O
=	O
vdutudvt	O
=	O
vd2vt	O
.	O
since	O
v	O
is	O
orthogonal	B
,	O
vt	O
=	O
v−1	O
,	O
and	O
so	O
ata	O
=	O
vd2v−1	O
.	O
this	O
is	O
the	O
deﬁning	O
equation	O
for	O
eigenvalues	O
,	O
indicating	O
that	O
the	O
entries	O
of	O
d2	O
are	O
the	O
eigenvalues	O
of	O
ata	O
and	O
the	O
columns	O
of	O
v	O
are	O
the	O
eigenvectors	O
of	O
ata	O
.	O
in	O
short	O
,	O
the	O
singular	B
values	I
of	O
a	O
are	O
the	O
square-roots	O
of	O
the	O
eigenvalues	O
of	O
ata	O
.	O
note	O
,	O
ata	O
is	O
symmetric	B
and	O
positive-semi-deﬁnite	O
(	O
see	O
section	O
a4.2.1	O
above	O
)	O
,	O
so	O
its	O
eigenvalues	O
are	O
real	O
and	O
non-negative	O
.	O
consequently	O
,	O
singular	B
values	I
are	O
real	O
and	O
non-negative	O
.	O
computational	B
complexity	I
of	O
the	O
svd	O
the	O
computational	B
complexity	I
of	O
the	O
svd	O
depends	O
on	O
how	O
much	O
information	O
needs	O
to	O
be	O
returned	O
.	O
for	O
instance	O
in	O
algorithm	O
a5.4	O
to	O
be	O
considered	O
later	O
,	O
the	O
solution	B
to	O
the	O
problem	O
is	O
the	O
last	O
column	O
of	O
the	O
matrix	B
v	O
in	O
the	O
svd	O
.	O
the	O
matrix	B
u	O
is	O
not	O
used	O
,	O
and	O
does	O
not	O
need	O
to	O
be	O
computed	O
.	O
on	O
the	O
other	O
hand	O
,	O
algorithm	B
a5.1	O
of	O
section	O
a5.1	O
requires	O
the	O
complete	O
svd	O
to	O
be	O
computed	O
.	O
for	O
systems	O
of	O
equations	O
with	O
many	O
more	O
rows	O
than	O
columns	O
,	O
the	O
extra	O
effort	O
required	O
to	O
compute	O
the	O
matrix	B
u	O
is	O
substantial	O
.	O
approximate	O
numbers	O
of	O
ﬂoating-point	O
operations	O
(	O
ﬂops	O
)	O
required	O
to	O
compute	O
the	O
svd	O
of	O
an	O
m	O
×	O
n	O
matrix	B
are	O
given	O
in	O
[	O
golub-89	O
]	O
.	O
to	O
ﬁnd	O
matrices	O
u	O
,	O
v	O
and	O
d	O
,	O
a	O
total	O
of	O
4m2n	O
+	O
8mn2	O
+	O
9n3	O
ﬂops	O
are	O
needed	O
.	O
however	O
,	O
if	O
only	O
the	O
matrices	O
v	O
and	O
d	O
are	O
required	O
,	O
then	O
only	O
4mn2	O
+	O
8n3	O
ﬂops	O
are	O
required	O
.	O
this	O
is	O
an	O
important	O
distinction	O
,	O
since	O
this	O
latter	O
expression	O
does	O
not	O
contain	O
any	O
term	O
in	O
m2	O
.	O
speciﬁcally	O
,	O
the	O
number	O
of	O
operations	O
required	O
to	O
compute	O
u	O
varies	O
as	O
the	O
square	O
of	O
m	O
,	O
the	O
number	O
of	O
rows	O
.	O
on	O
the	O
other	O
hand	O
,	O
the	O
complexity	O
of	O
computing	O
d	O
and	O
v	O
is	O
linear	B
in	O
m.	O
for	O
cases	O
where	O
there	O
are	O
many	O
more	O
rows	O
than	O
columns	O
,	O
therefore	O
,	O
it	O
is	O
important	O
(	O
supposing	O
a4.4	O
singular	O
value	O
decomposition	B
587	O
computation	B
time	O
is	O
an	O
issue	O
)	O
to	O
avoid	O
computing	B
the	O
matrix	B
u	O
unless	O
it	O
is	O
needed	O
.	O
to	O
illustrate	O
this	O
point	B
we	O
consider	O
the	O
dlt	O
algorithm	B
for	O
camera	B
resection	O
,	O
described	O
in	O
chapter	O
7.	O
in	O
this	O
algorithm	B
a	O
3×4	O
camera	B
matrix	I
is	O
computed	O
from	O
a	O
set	O
of	O
n	O
3d	O
to	O
2d	O
point	B
matches	O
.	O
the	O
solution	B
involves	O
using	O
algorithm	O
a5.4	O
,	O
to	O
solve	O
a	O
set	O
of	O
equations	O
ap	O
=	O
0	O
where	O
a	O
is	O
a	O
2n	O
×	O
12	O
matrix	B
.	O
the	O
solution	B
vector	O
p	O
is	O
the	O
last	O
column	O
of	O
the	O
matrix	B
v	O
in	O
an	O
svd	O
,	O
a	O
=	O
udvt	O
.	O
thus	O
the	O
matrix	B
u	O
is	O
not	O
required	O
.	O
table	O
a4.1	O
gives	O
the	O
total	O
number	O
of	O
ﬂops	O
for	O
carrying	O
out	O
the	O
svd	O
for	O
six	O
(	O
the	O
minimum	O
number	O
)	O
,	O
100	O
or	O
1000	O
point	B
correspondences	O
.	O
#	O
points	O
#	O
equations	O
per	O
point	B
#	O
equations	O
(	O
m	O
)	O
#	O
unknowns	O
(	O
n	O
)	O
#	O
operations	O
not	O
computing	B
u	O
#	O
operations	O
computing	B
u	O
6	O
100	O
1000	O
2	O
2	O
2	O
12	O
200	O
2000	O
12	O
12	O
12	O
20,736	O
129,024	O
1,165,824	O
36,288	O
2,165,952	O
194,319,552	O
table	O
a4.1	O
.	O
comparison	O
of	O
the	O
number	O
of	O
ﬂops	O
required	O
to	O
compute	O
the	O
svd	O
of	O
a	O
matrix	O
of	O
size	O
m	O
×	O
n	O
,	O
for	O
varying	O
values	O
of	O
m	O
and	O
for	O
n	O
=	O
12.	O
note	O
that	O
the	O
computational	B
complexity	I
increases	O
sub-linearly	O
in	O
the	O
number	O
of	O
equations	O
when	O
u	O
is	O
not	O
computed	O
.	O
on	O
the	O
other	O
hand	O
,	O
the	O
extra	O
computational	O
burden	O
of	O
computing	O
u	O
is	O
very	O
large	O
,	O
especially	O
for	O
large	O
numbers	O
of	O
equations	O
.	O
further	O
reading	O
.	O
two	O
invaluable	O
text	O
books	O
for	O
this	O
area	O
are	O
[	O
golub-89	O
]	O
and	O
[	O
lutkepohl-96	O
]	O
.	O
appendix	O
5	O
least-squares	O
minimization	O
in	O
this	O
appendix	O
we	O
discuss	O
numerical	O
algorithms	O
for	O
solving	O
linear	B
systems	O
of	O
equa-	O
tions	O
under	O
various	O
constraints	B
.	O
as	O
will	O
be	O
seen	O
such	O
problems	O
are	O
conveniently	O
solved	O
using	O
the	O
svd	O
.	O
a5.1	O
solution	B
of	O
linear	B
equations	I
consider	O
a	O
system	O
of	O
equations	O
of	O
the	O
form	O
ax	O
=	O
b.	O
let	O
a	O
be	O
an	O
m	O
×	O
n	O
matrix	B
.	O
there	O
are	O
three	O
possibilities	O
:	O
(	O
i	O
)	O
if	O
m	O
<	O
n	O
there	O
are	O
more	O
unknowns	O
than	O
equations	O
.	O
in	O
this	O
case	O
,	O
there	O
will	O
not	O
be	O
a	O
unique	O
solution	B
,	O
but	O
rather	O
a	O
vector	O
space	O
of	O
solutions	O
.	O
(	O
ii	O
)	O
if	O
m	O
=	O
n	O
there	O
will	O
be	O
a	O
unique	O
solution	B
as	O
long	O
as	O
a	O
is	O
invertible	O
.	O
(	O
iii	O
)	O
if	O
m	O
>	O
n	O
then	O
there	O
are	O
more	O
equations	O
than	O
unknowns	O
.	O
in	O
general	O
the	O
system	O
will	O
not	O
have	O
a	O
solution	B
unless	O
by	O
chance	O
b	O
lies	O
in	O
the	O
span	O
of	O
the	O
columns	O
of	O
a.	O
least-squares	B
solutions	I
:	O
full-rank	O
case	O
.	O
we	O
consider	O
the	O
case	O
m	O
≥	O
n	O
and	O
assume	O
for	O
the	O
present	O
that	O
a	O
is	O
known	O
to	O
be	O
of	O
rank	O
n.	O
if	O
a	O
solution	B
does	O
not	O
exist	O
,	O
then	O
in	O
many	O
cases	O
it	O
still	O
makes	O
sense	O
to	O
seek	O
a	O
vector	O
x	O
that	O
is	O
closest	O
to	O
providing	O
a	O
solution	B
to	O
the	O
system	O
ax	O
=	O
b.	O
in	O
other	O
words	O
,	O
we	O
seek	O
x	O
such	O
that	O
(	O
cid:10	O
)	O
ax	O
−	O
b	O
(	O
cid:10	O
)	O
is	O
minimized	O
,	O
where	O
(	O
cid:10	O
)	O
·	O
(	O
cid:10	O
)	O
represents	O
the	O
vector	O
norm	O
.	O
such	O
an	O
x	O
is	O
known	O
as	O
the	O
least-squares	B
solution	I
to	O
the	O
over-determined	B
system	O
.	O
the	O
least-squares	B
solution	I
is	O
conveniently	O
found	O
using	O
the	O
svd	O
as	O
follows	O
.	O
we	O
seek	O
x	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ax−b	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
udvtx−b	O
(	O
cid:10	O
)	O
.	O
because	O
of	O
the	O
norm-preserving	O
property	O
of	O
orthogonal	O
transforms	O
,	O
(	O
cid:10	O
)	O
udvtx	O
−	O
b	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
dvtx	O
−	O
utb	O
(	O
cid:10	O
)	O
,	O
and	O
this	O
is	O
the	O
quantity	O
that	O
we	O
want	O
to	O
minimize	O
.	O
writing	O
y	O
=	O
vtx	O
and	O
b	O
(	O
cid:2	O
)	O
=	O
utb	O
,	O
the	O
problem	O
becomes	O
one	O
of	O
minimizing	O
(	O
cid:10	O
)	O
dy	O
−	O
b	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
where	O
d	O
is	O
an	O
m	O
×	O
n	O
matrix	B
with	O
vanishing	O
588	O
	O
d1	O
d2	O
dn	O
...	O
0	O
	O
	O
	O
=	O
y1	O
y2	O
...	O
yn	O
	O
(	O
cid:2	O
)	O
b	O
(	O
cid:2	O
)	O
1	O
b	O
2	O
...	O
(	O
cid:2	O
)	O
b	O
n	O
(	O
cid:2	O
)	O
n+1	O
...	O
(	O
cid:2	O
)	O
b	O
m	O
(	O
cid:2	O
)	O
1	O
,	O
b	O
b	O
589	O
	O
.	O
off-diagonal	O
entries	O
.	O
this	O
set	O
of	O
equations	O
is	O
of	O
the	O
form	O
a5.1	O
solution	B
of	O
linear	B
equations	I
clearly	O
,	O
the	O
nearest	O
dy	O
can	O
approach	O
to	O
b	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
n	O
,	O
0	O
,	O
.	O
.	O
.	O
,0	O
)	O
t	O
,	O
and	O
(	O
cid:2	O
)	O
this	O
is	O
achieved	O
by	O
setting	O
yi	O
=	O
b	O
i/di	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n.	O
note	O
that	O
the	O
assumption	O
ranka	O
=	O
n	O
ensures	O
that	O
di	O
(	O
cid:5	O
)	O
=	O
0.	O
finally	O
,	O
one	O
retrieves	O
x	O
from	O
x	O
=	O
vy	O
.	O
the	O
complete	O
algorithm	B
is	O
is	O
the	O
vector	O
(	O
b	O
(	O
cid:2	O
)	O
2	O
,	O
.	O
.	O
.	O
,	O
b	O
objective	O
find	O
the	O
least-squares	B
solution	I
to	O
the	O
m	O
×	O
n	O
set	O
of	O
equations	O
ax	O
=	O
b	O
,	O
where	O
m	O
>	O
n	O
and	O
rank	O
a	O
=	O
n.	O
algorithm	B
(	O
i	O
)	O
find	O
the	O
svd	O
a	O
=	O
udvt	O
.	O
(	O
ii	O
)	O
set	O
b	O
(	O
cid:1	O
)	O
=	O
utb	O
.	O
(	O
iii	O
)	O
find	O
the	O
vector	O
y	O
deﬁned	O
by	O
yi	O
=	O
b	O
(	O
iv	O
)	O
the	O
solution	B
is	O
x	O
=	O
vy	O
.	O
(	O
cid:1	O
)	O
i/di	O
,	O
where	O
di	O
is	O
the	O
i-th	O
diagonal	O
entry	O
of	O
d.	O
algorithm	B
a5.1	O
.	O
linear	B
least-squares	O
solution	B
to	O
an	O
over-determined	B
full-rank	O
set	O
of	O
linear	O
equations	O
.	O
deﬁcient-rank	O
systems	O
.	O
sometimes	O
one	O
is	O
called	O
upon	O
to	O
solve	O
a	O
system	O
of	O
equations	O
that	O
is	O
expected	O
not	O
to	O
be	O
of	O
full	O
column	O
rank	O
.	O
thus	O
,	O
let	O
r	O
=	O
ranka	O
<	O
n	O
,	O
where	O
n	O
is	O
the	O
number	O
of	O
columns	O
of	O
a.	O
it	O
is	O
possible	O
that	O
because	O
of	O
noise	O
corruption	O
,	O
the	O
matrix	B
a	O
actually	O
has	O
rank	O
greater	O
than	O
r	O
,	O
but	O
we	O
wish	O
to	O
enforce	O
the	O
rank	O
r	O
constraint	O
because	O
of	O
theoretical	O
considerations	O
,	O
derived	O
from	O
the	O
particular	O
problem	O
being	O
considered	O
.	O
in	O
this	O
case	O
,	O
there	O
will	O
be	O
an	O
(	O
n−	O
r	O
)	O
-parameter	O
family	O
of	O
solutions	O
to	O
the	O
set	O
of	O
equations	O
,	O
where	O
r	O
=	O
ranka	O
<	O
n.	O
this	O
family	O
of	O
solutions	O
is	O
appropriately	O
solved	O
using	O
the	O
svd	O
,	O
as	O
follows	O
:	O
this	O
algorithm	B
gives	O
an	O
(	O
n−r	O
)	O
-parameter	O
family	O
(	O
parametrized	O
by	O
the	O
indeterminate	O
values	O
λi	O
)	O
of	O
least-squares	O
solutions	O
to	O
the	O
deﬁcient-rank	O
system	O
.	O
the	O
justiﬁcation	B
of	O
this	O
algorithm	B
is	O
similar	O
to	O
that	O
of	O
algorithm	O
a5.1	O
for	O
the	O
least-squares	B
solution	I
of	O
full-	O
rank	O
systems	O
.	O
systems	B
of	I
unknown	I
rank	I
.	O
in	O
most	O
cases	O
encountered	O
in	O
this	O
book	O
,	O
the	O
rank	O
of	O
a	O
system	O
of	O
linear	O
equations	O
will	O
be	O
known	O
theoretically	O
in	O
advance	O
of	O
solution	O
.	O
if	O
the	O
rank	O
of	O
the	O
system	O
of	O
equations	O
is	O
not	O
known	O
,	O
then	O
one	O
must	O
guess	O
at	O
its	O
rank	O
.	O
in	O
this	O
case	O
,	O
it	O
is	O
appropriate	O
to	O
set	O
singular	B
values	I
that	O
are	O
small	O
compared	O
with	O
the	O
largest	O
590	O
appendix	O
5	O
least-squares	O
minimization	O
objective	O
find	O
the	O
general	O
solution	O
to	O
a	O
set	O
of	O
equations	O
ax	O
=	O
b	O
where	O
a	O
is	O
an	O
m	O
×	O
n	O
matrix	B
of	O
rank	O
r	O
<	O
n.	O
algorithm	B
order	O
.	O
(	O
i	O
)	O
find	O
the	O
svd	O
a	O
=	O
udvt	O
,	O
where	O
the	O
diagonal	O
entries	O
di	O
of	O
d	O
are	O
in	O
descending	O
numerical	O
(	O
ii	O
)	O
set	O
b	O
(	O
cid:1	O
)	O
=	O
utb	O
.	O
(	O
iii	O
)	O
find	O
the	O
vector	O
y	O
deﬁned	O
by	O
yi	O
=	O
b	O
(	O
iv	O
)	O
the	O
solution	B
x	O
of	O
minimum	O
norm	B
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
is	O
vy	O
.	O
(	O
v	O
)	O
the	O
general	O
solution	O
is	O
x	O
=	O
vy	O
+	O
λr+1vr+1	O
+	O
.	O
.	O
.	O
+	O
λnvn	O
,	O
where	O
vr+1	O
,	O
.	O
.	O
.	O
,	O
vn	O
are	O
(	O
cid:1	O
)	O
i/di	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
r	O
,	O
and	O
yi	O
=	O
0	O
otherwise	O
.	O
the	O
last	O
n	O
−	O
r	O
columns	O
of	O
v.	O
algorithm	B
a5.2	O
.	O
general	O
solution	O
to	O
deﬁcient-rank	O
system	O
singular	O
value	O
to	O
zero	O
.	O
thus	O
,	O
if	O
di/d0	O
<	O
δ	O
where	O
δ	O
is	O
a	O
small	O
constant	O
of	O
the	O
order	O
of	O
the	O
machine	O
precision1	O
then	O
one	O
sets	O
yi	O
=	O
0.	O
a	O
least-squares	B
solution	I
is	O
then	O
given	O
by	O
x	O
=	O
vy	O
as	O
before	O
.	O
a5.2	O
the	O
pseudo-inverse	B
given	O
a	O
square	O
diagonal	O
matrix	B
d	O
,	O
we	O
deﬁne	O
its	O
pseudo-inverse	B
to	O
be	O
the	O
diagonal	O
ma-	O
trix	O
d+	O
such	O
that	O
d+	O
ii	O
=	O
0	O
−1	O
d	O
ii	O
if	O
dii	O
=	O
0	O
otherwise	O
.	O
now	O
,	O
consider	O
an	O
m	O
×	O
n	O
matrix	B
a	O
with	O
m	O
≥	O
n.	O
let	O
the	O
svd	O
of	O
a	O
be	O
a	O
=	O
udvt	O
.	O
we	O
deﬁne	O
the	O
pseudo-inverse	B
of	O
a	O
to	O
be	O
the	O
matrix	B
a+	O
=	O
vd+ut	O
.	O
where	O
b	O
(	O
cid:2	O
)	O
(	O
a5.1	O
)	O
one	O
very	O
simply	O
veriﬁes	O
that	O
the	O
vector	O
y	O
in	O
algorithm	O
a5.1	O
or	O
algorithm	B
a5.2	O
is	O
nothing	O
more	O
than	O
d+b	O
(	O
cid:2	O
)	O
result	O
a5.1	O
.	O
the	O
least-squares	B
solution	I
to	O
an	O
m	O
×	O
n	O
system	O
of	O
equations	O
ax	O
=	O
b	O
of	O
rank	O
n	O
is	O
given	O
by	O
x	O
=	O
a+b	O
.	O
in	O
the	O
case	O
of	O
a	O
deﬁcient-rank	O
system	O
,	O
x	O
=	O
a+b	O
is	O
the	O
solution	B
that	O
minimizes	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
.	O
as	O
remarked	O
when	O
discussing	O
the	O
svd	O
,	O
if	O
a	O
has	O
fewer	O
rows	O
than	O
columns	O
,	O
then	O
this	O
result	O
may	O
be	O
applied	O
after	O
extending	O
a	O
to	O
a	O
square	O
matrix	B
by	O
adding	O
rows	O
of	O
zeros	O
.	O
=	O
utb	O
.	O
thus	O
,	O
symmetric	B
matrices	I
.	O
for	O
symmetric	O
matrices	O
,	O
one	O
may	O
generalize	O
the	O
pseudo-	O
inverse	O
as	O
follows	O
.	O
this	O
generalization	O
was	O
used	O
in	O
chapter	O
5	O
,	O
section	O
5.2.3	O
(	O
p142	O
)	O
for	O
discussing	O
singular	O
covariance	O
matrices	O
.	O
if	O
a	O
is	O
a	O
non-invertible	O
symmetric	B
matrix	O
,	O
and	O
−1xt	O
.	O
one	O
can	O
see	O
that	O
this	O
depends	O
xtax	O
is	O
invertible	O
,	O
then	O
we	O
write	O
a+x	O
def=	O
x	O
(	O
xtax	O
)	O
only	O
on	O
the	O
span	O
of	O
the	O
columns	O
of	O
x.	O
in	O
other	O
words	O
,	O
if	O
x	O
is	O
replaced	O
by	O
xb	O
for	O
any	O
invertible	O
matrix	B
b	O
,	O
then	O
a+x	O
=	O
a+xb	O
.	O
otherwise	O
stated	O
,	O
a+x	O
depends	O
only	O
on	O
the	O
(	O
left	O
)	O
1	O
machine	O
precision	O
is	O
the	O
largest	O
ﬂoating	O
point	B
value	O
	O
such	O
that	O
1.0	O
+	O
	O
=	O
1.0.	O
a5.2	O
the	O
pseudo-inverse	B
591	O
null-space	B
of	O
x	O
,	O
namely	O
the	O
space	O
of	O
vectors	O
perpendicular	O
to	O
the	O
columns	O
of	O
x.	O
deﬁne	O
the	O
null-space	B
nlx	O
=	O
{	O
xt	O
|	O
xtx	O
=	O
0	O
}	O
.	O
one	O
ﬁnds	O
that	O
under	O
a	O
simple	O
condition	O
,	O
a+x	O
is	O
the	O
pseudo-inverse	B
of	O
a	O
:	O
result	O
a5.2	O
.	O
let	O
a	O
be	O
a	O
symmetric	B
matrix	O
,	O
then	O
a+x	O
def=	O
x	O
(	O
xtax	O
)	O
if	O
nl	O
(	O
x	O
)	O
=n	O
l	O
(	O
a	O
)	O
.	O
−1xt	O
=	O
a+	O
if	O
and	O
only	O
only	O
a	O
sketch	O
proof	O
is	O
given	O
.	O
the	O
necessity	O
is	O
obvious	O
,	O
since	O
nl	O
(	O
x	O
)	O
and	O
nl	O
(	O
a	O
)	O
are	O
the	O
null-spaces	O
of	O
the	O
left	O
and	O
right	O
sides	O
of	O
the	O
equation	O
.	O
to	O
prove	O
the	O
converse	O
,	O
one	O
may	O
assume	O
that	O
the	O
columns	O
of	O
x	O
are	O
orthonormal	O
,	O
since	O
as	O
shown	O
above	O
,	O
only	O
the	O
null-space	B
of	O
x	O
is	O
of	O
importance	O
.	O
thus	O
,	O
x	O
may	O
be	O
extended	O
by	O
adding	O
further	O
columns	O
x	O
(	O
cid:2	O
)	O
]	O
.	O
now	O
,	O
the	O
rows	O
of	O
x	O
(	O
cid:2	O
)	O
t	O
span	O
the	O
null-space	B
of	O
x	O
,	O
and	O
hence	O
,	O
by	O
assumption	O
,	O
of	O
a.	O
now	O
,	O
the	O
proof	O
is	O
completed	O
in	O
a	O
few	O
lines	B
by	O
−1xt	O
with	O
the	O
deﬁnition	B
(	O
a5.1	O
)	O
of	O
the	O
pseudo-	O
comparing	O
the	O
deﬁnition	B
a+x	O
def=	O
x	O
(	O
xtax	O
)	O
inverse	O
.	O
to	O
form	O
an	O
orthogonal	B
matrix	O
u	O
=	O
[	O
x|x	O
(	O
cid:2	O
)	O
a5.2.1	O
linear	B
least-squares	O
using	B
normal	I
equations	I
the	O
linear	B
least-squares	O
problem	O
may	O
also	O
be	O
solved	O
by	O
a	O
method	O
involving	O
the	O
so-	O
called	O
normal	B
equations	I
.	O
once	O
more	O
,	O
we	O
consider	O
the	O
set	O
of	O
linear	O
equations	O
ax	O
=	O
b	O
where	O
a	O
is	O
an	O
m	O
×	O
n	O
matrix	B
with	O
m	O
>	O
n.	O
in	O
general	O
,	O
no	O
solution	O
x	O
will	O
exist	O
for	O
this	O
set	O
of	O
equations	O
.	O
consequently	O
,	O
the	O
task	O
is	O
to	O
ﬁnd	O
the	O
vector	O
x	O
that	O
minimizes	O
the	O
norm	B
(	O
cid:10	O
)	O
ax	O
−	O
b	O
(	O
cid:10	O
)	O
.	O
as	O
the	O
vector	O
x	O
varies	O
over	O
all	O
values	O
,	O
the	O
product	O
ax	O
varies	O
over	O
the	O
complete	O
column	O
space	O
of	O
a	O
,	O
that	O
is	O
,	O
the	O
subspace	O
of	O
irm	O
spanned	O
by	O
the	O
columns	O
of	O
a.	O
the	O
task	O
therefore	O
is	O
to	O
ﬁnd	O
the	O
closest	O
vector	O
to	O
b	O
that	O
lies	O
in	O
the	O
column	O
space	O
of	O
a	O
,	O
where	O
closeness	O
is	O
deﬁned	O
in	O
terms	O
of	O
vector	O
norm	B
.	O
let	O
x	O
be	O
the	O
solution	B
to	O
this	O
problem	O
;	O
thus	O
ax	O
is	O
the	O
closest	O
point	B
to	O
b.	O
in	O
this	O
case	O
,	O
the	O
difference	O
ax	O
−	O
b	O
must	O
be	O
a	O
vector	O
orthogonal	O
to	O
the	O
column	O
space	O
of	O
a.	O
this	O
means	O
,	O
explicitly	O
,	O
that	O
ax	O
−	O
b	O
is	O
perpendicular	O
to	O
each	O
of	O
the	O
columns	O
of	O
a	O
,	O
and	O
hence	O
at	O
(	O
ax−	O
b	O
)	O
=	O
0.	O
multiplying	O
out	O
and	O
separating	O
terms	O
gives	O
an	O
equation	O
(	O
ata	O
)	O
x	O
=	O
atb	O
.	O
(	O
a5.2	O
)	O
this	O
is	O
a	O
square	O
n	O
×	O
n	O
set	O
of	O
linear	O
equations	O
,	O
called	O
the	O
normal	B
equations	I
.	O
this	O
set	O
of	O
equations	O
may	O
be	O
solved	O
to	O
ﬁnd	O
the	O
least-squares	B
solution	I
to	O
the	O
problem	O
ax	O
=	O
b.	O
even	O
if	O
a	O
is	O
not	O
of	O
full	O
rank	O
(	O
rank	O
n	O
)	O
,	O
this	O
set	O
of	O
equations	O
should	O
have	O
a	O
solution	B
,	O
since	O
atb	O
lies	O
in	O
the	O
column	O
space	O
of	O
ata	O
.	O
in	O
the	O
case	O
where	O
a	O
has	O
rank	O
n	O
,	O
the	O
matrix	B
ata	O
is	O
objective	O
find	O
x	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ax	O
−	O
b	O
(	O
cid:10	O
)	O
.	O
algorithm	B
(	O
i	O
)	O
solve	O
the	O
normal	B
equations	I
atax	O
=	O
atb	O
.	O
(	O
ii	O
)	O
if	O
ata	O
is	O
invertible	O
,	O
then	O
the	O
solution	B
is	O
x	O
=	O
(	O
ata	O
)	O
−1atb	O
.	O
algorithm	B
a5.3	O
.	O
linear	B
least-squares	O
using	O
the	O
normal	B
equations	I
.	O
appendix	O
5	O
least-squares	O
minimization	O
−1at	O
.	O
−1atb	O
.	O
since	O
x	O
=	O
a+b	O
,	O
this	O
implies	O
592	O
invertible	O
,	O
and	O
so	O
x	O
may	O
be	O
found	O
by	O
x	O
=	O
(	O
ata	O
)	O
the	O
following	O
result	O
,	O
which	O
is	O
also	O
easily	O
veriﬁed	O
directly	O
:	O
result	O
a5.3	O
.	O
if	O
a	O
is	O
an	O
m	O
×	O
n	O
matrix	B
of	O
rank	O
n	O
,	O
then	O
a+	O
=	O
(	O
ata	O
)	O
this	O
result	O
is	O
useful	O
in	O
theoretical	O
analysis	O
,	O
as	O
well	O
as	O
being	O
a	O
computationally	O
simpler	O
method	O
than	O
using	O
the	O
svd	O
to	O
compute	O
a	O
pseudo-inverse	B
if	O
n	O
is	O
small	O
compared	O
with	O
m	O
(	O
so	O
that	O
computing	B
the	O
inverse	O
of	O
(	O
ata	O
)	O
is	O
inexpensive	O
compared	O
to	O
computing	O
the	O
svd	O
of	O
a	O
)	O
.	O
vector	B
space	I
norms	I
.	O
one	O
sometimes	O
wishes	O
to	O
minimize	O
ax	O
−	O
b	O
with	O
respect	O
to	O
a	O
different	O
norm	B
on	O
the	O
vector	O
space	O
irn	O
.	O
the	O
usual	O
norm	B
in	O
a	O
vector	O
space	O
irn	O
is	O
given	O
in	O
terms	O
of	O
the	O
usual	O
inner	O
product	O
.	O
thus	O
,	O
for	O
two	O
vectors	O
a	O
and	O
b	O
in	O
irn	O
one	O
may	O
deﬁne	O
the	O
inner	O
product	O
a	O
·	O
b	O
to	O
be	O
atb	O
.	O
the	O
norm	B
of	O
a	O
vector	O
a	O
is	O
then	O
(	O
cid:10	O
)	O
a	O
(	O
cid:10	O
)	O
=	O
(	O
a	O
·	O
a	O
)	O
1/2	O
=	O
(	O
ata	O
)	O
1/2	O
.	O
one	O
notes	O
the	O
properties	B
:	O
(	O
i	O
)	O
the	O
inner	O
product	O
is	O
a	O
symmetric	B
bilinear	O
form	O
on	O
irn	O
.	O
(	O
ii	O
)	O
(	O
cid:10	O
)	O
a	O
(	O
cid:10	O
)	O
>	O
0	O
for	O
all	O
non-zero	O
vectors	O
a	O
∈	O
irn	O
.	O
we	O
say	O
that	O
the	O
inner	O
product	O
is	O
a	O
positive-deﬁnite	O
symmetric	O
bilinear	B
form	O
.	O
it	O
is	O
pos-	O
sible	O
to	O
deﬁne	O
other	O
inner	O
products	O
on	O
a	O
vector	O
space	O
irn	O
.	O
let	O
c	O
be	O
a	O
real	O
symmetric	B
positive-deﬁnite	O
matrix	B
,	O
and	O
deﬁne	O
a	O
new	O
inner	O
product	O
c	O
(	O
a	O
,	O
b	O
)	O
=a	O
tcb	O
.	O
the	O
symme-	O
try	O
of	O
the	O
inner	O
product	O
follows	O
from	O
the	O
symmetry	O
of	O
c.	O
a	O
norm	B
may	O
be	O
deﬁned	O
by	O
(	O
cid:10	O
)	O
a	O
(	O
cid:10	O
)	O
c	O
=	O
(	O
atca	O
)	O
1/2	O
,	O
and	O
this	O
is	O
deﬁned	O
and	O
positive-deﬁnite	O
,	O
because	O
c	O
is	O
assumed	O
to	O
be	O
a	O
positive-deﬁnite	B
matrix	I
.	O
weighted	B
linear	O
least-squares	B
problems	I
.	O
sometimes	O
one	O
desires	O
to	O
solve	O
a	O
weighted	B
least-squares	O
problem	O
of	O
the	O
form	O
ax−	O
b	O
=	O
0	O
by	O
minimizing	O
the	O
c-norm	O
(	O
cid:10	O
)	O
ax−	O
b	O
(	O
cid:10	O
)	O
c	O
of	O
the	O
error	O
.	O
here	O
c	O
is	O
a	O
positive-deﬁnite	O
symmetric	O
matrix	B
deﬁning	O
an	O
inner	O
product	O
and	O
a	O
norm	B
(	O
cid:10	O
)	O
·	O
(	O
cid:10	O
)	O
c	O
on	O
irn	O
.	O
as	O
before	O
,	O
one	O
can	O
argue	O
that	O
the	O
minimum	O
error	B
vector	O
ax	O
−	O
b	O
must	O
be	O
orthogonal	B
in	O
the	O
inner	O
product	O
deﬁned	O
by	O
c	O
to	O
the	O
column	O
space	O
of	O
a.	O
this	O
leads	O
to	O
a	O
requirement	O
atc	O
(	O
ax	O
−	O
b	O
)	O
=	O
0.	O
rearranging	O
this	O
one	O
obtains	O
the	O
weighted	B
normal	O
equations	O
:	O
(	O
atca	O
)	O
x	O
=	O
atcb	O
.	O
(	O
a5.3	O
)	O
the	O
most	O
common	O
weighting	O
will	O
be	O
where	O
c	O
is	O
a	O
diagonal	O
matrix	B
,	O
corresponding	O
to	O
independent	O
weights	O
in	O
each	O
of	O
the	O
axial	O
directions	O
in	O
irn	O
.	O
however	O
,	O
general	O
weighting	O
matrices	O
c	O
may	O
be	O
used	O
also	O
.	O
a5.3	O
least-squares	B
solution	I
of	O
homogeneous	O
equations	O
similar	O
to	O
the	O
previous	O
problem	O
is	O
that	O
of	O
solving	O
a	O
set	O
of	O
equations	O
of	O
the	O
form	O
ax	O
=	O
0.	O
this	O
problem	O
comes	O
up	O
frequently	O
in	O
reconstruction	O
problems	O
.	O
we	O
consider	O
the	O
case	O
where	O
there	O
are	O
more	O
equations	O
than	O
unknowns	O
–	O
an	O
over-determined	B
set	O
of	O
equations	O
.	O
the	O
obvious	O
solution	B
x	O
=	O
0	O
is	O
not	O
of	O
interest	O
–	O
we	O
seek	O
a	O
non-zero	O
solution	O
to	O
the	O
set	O
of	O
equations	O
.	O
observe	O
that	O
if	O
x	O
is	O
a	O
solution	B
to	O
this	O
set	O
of	O
equations	O
,	O
then	O
so	O
is	O
kx	O
for	O
any	O
scalar	O
k.	O
a	O
reasonable	O
constraint	O
would	O
be	O
to	O
seek	O
a	O
solution	B
for	O
which	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1.	O
a5.4	O
least-squares	B
solution	I
to	O
constrained	O
systems	O
593	O
in	O
general	O
,	O
such	O
a	O
set	O
of	O
equations	O
will	O
not	O
have	O
an	O
exact	O
solution	B
.	O
suppose	O
a	O
has	O
dimension	O
m×	O
n	O
then	O
there	O
is	O
an	O
exact	O
solution	B
if	O
and	O
only	O
if	O
rank	O
(	O
a	O
)	O
<	O
n	O
–	O
the	O
matrix	B
a	O
does	O
not	O
have	O
full	O
column	O
rank	O
.	O
in	O
the	O
absence	O
of	O
an	O
exact	O
solution	B
we	O
will	O
normally	O
seek	O
a	O
least-squares	B
solution	I
.	O
the	O
problem	O
may	O
be	O
stated	O
as	O
•	O
find	O
the	O
x	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ax	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1	O
.	O
this	O
problem	O
is	O
solvable	O
as	O
follows	O
.	O
let	O
a	O
=	O
udvt	O
.	O
the	O
problem	O
then	O
requires	O
us	O
to	O
minimize	O
(	O
cid:10	O
)	O
udvtx	O
(	O
cid:10	O
)	O
.	O
however	O
,	O
(	O
cid:10	O
)	O
udvtx	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
dvtx	O
(	O
cid:10	O
)	O
and	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
vtx	O
(	O
cid:10	O
)	O
.	O
thus	O
,	O
we	O
need	O
to	O
minimize	O
(	O
cid:10	O
)	O
dvtx	O
(	O
cid:10	O
)	O
subject	O
to	O
the	O
condition	O
(	O
cid:10	O
)	O
vtx	O
(	O
cid:10	O
)	O
=	O
1.	O
we	O
write	O
y	O
=	O
vtx	O
,	O
and	O
the	O
problem	O
is	O
:	O
minimize	O
(	O
cid:10	O
)	O
dy	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
y	O
(	O
cid:10	O
)	O
=	O
1.	O
now	O
,	O
d	O
is	O
a	O
diagonal	O
matrix	B
with	O
its	O
diagonal	O
entries	O
in	O
descending	O
order	O
.	O
it	O
follows	O
that	O
the	O
solution	B
to	O
this	O
problem	O
is	O
y	O
=	O
(	O
0	O
,	O
0	O
,	O
.	O
.	O
.	O
,0	O
,	O
1	O
)	O
t	O
having	O
one	O
non-zero	O
entry	O
,	O
1	O
in	O
the	O
last	O
position	O
.	O
finally	O
x	O
=	O
vy	O
is	O
simply	O
the	O
last	O
column	O
of	O
v.	O
the	O
method	O
is	O
summarized	O
in	O
algorithm	O
a5.4	O
.	O
objective	O
given	O
a	O
matrix	B
a	O
with	O
at	O
least	O
as	O
many	O
rows	O
as	O
columns	O
,	O
ﬁnd	O
x	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ax	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1.	O
solution	B
x	O
is	O
the	O
last	O
column	O
of	O
v	O
,	O
where	O
a	O
=	O
udvt	O
is	O
the	O
svd	O
of	O
a.	O
algorithm	B
a5.4	O
.	O
least-squares	B
solution	I
of	O
a	O
homogeneous	O
system	O
of	O
linear	O
equations	O
.	O
as	O
mentioned	O
in	O
section	O
a4.4	O
the	O
last	O
column	O
of	O
v	O
may	O
alternatively	O
be	O
described	O
as	O
the	O
eigenvector	O
of	O
ata	O
corresponding	O
to	O
the	O
smallest	O
eigenvalue	O
.	O
a5.4	O
least-squares	B
solution	I
to	O
constrained	O
systems	O
in	O
the	O
previous	O
section	O
,	O
we	O
considered	O
a	O
method	O
of	O
least-squares	O
solution	B
of	O
equations	O
of	O
the	O
form	O
ax	O
=	O
0.	O
such	O
problems	O
may	O
arise	O
from	O
situations	O
where	O
measurements	O
are	O
made	O
on	O
a	O
set	O
of	O
image	O
features	O
.	O
with	O
exact	O
measurements	O
and	O
an	O
exact	O
imaging	O
model	B
the	O
mathematical	O
model	B
predicts	O
an	O
exact	O
solution	B
to	O
this	O
system	O
.	O
in	O
the	O
case	O
of	O
inexact	O
image	O
measurements	O
,	O
or	O
noise	B
,	O
there	O
will	O
not	O
be	O
an	O
exact	O
solution	B
.	O
in	O
this	O
case	O
,	O
it	O
makes	O
sense	O
to	O
ﬁnd	O
a	O
least-squares	B
solution	I
.	O
on	O
other	O
occasions	O
,	O
however	O
,	O
some	O
of	O
the	O
equations	O
represented	O
by	O
rows	O
of	O
the	O
ma-	O
trix	O
a	O
are	O
derived	O
from	O
precise	O
mathematical	O
constraints	B
,	O
and	O
should	O
be	O
satisﬁed	O
ex-	O
actly	O
.	O
this	O
set	O
of	O
constraints	O
may	O
be	O
described	O
by	O
a	O
matrix	B
equation	O
cx	O
=	O
0	O
,	O
which	O
should	O
be	O
satisﬁed	O
exactly	O
.	O
others	O
of	O
the	O
equations	O
are	O
derived	O
from	O
image	O
measure-	O
ments	O
and	O
are	O
subject	O
to	O
noise	O
.	O
this	O
leads	O
to	O
a	O
problem	O
of	O
the	O
following	O
sort	O
:	O
•	O
find	O
the	O
x	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ax	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1	O
and	O
cx	O
=	O
0	O
.	O
this	O
problem	O
can	O
be	O
solved	O
in	O
the	O
following	O
manner	O
.	O
the	O
condition	O
that	O
x	O
satisﬁes	O
cx	O
=	O
0	O
means	O
that	O
x	O
lies	O
perpendicular	O
to	O
each	O
of	O
the	O
rows	O
of	O
c.	O
the	O
set	O
of	O
all	O
such	O
x	O
is	O
a	O
vector	O
space	O
called	O
the	O
orthogonal	B
complement	O
of	O
the	O
row	O
space	O
of	O
c.	O
we	O
wish	O
to	O
ﬁnd	O
this	O
orthogonal	B
complement	O
.	O
594	O
appendix	O
5	O
least-squares	O
minimization	O
first	O
,	O
if	O
c	O
has	O
fewer	O
rows	O
than	O
columns	O
,	O
then	O
extend	O
it	O
to	O
a	O
square	O
matrix	B
by	O
adding	O
rows	O
of	O
zero	O
elements	O
.	O
this	O
has	O
no	O
effect	O
on	O
the	O
set	O
of	O
constraints	O
cx	O
=	O
0.	O
now	O
,	O
let	O
c	O
=	O
udvt	O
be	O
the	O
singular	O
value	O
decomposition	B
of	I
c	O
,	O
where	O
d	O
is	O
a	O
diagonal	O
matrix	B
with	O
r	O
non-zero	O
diagonal	O
entries	O
.	O
in	O
this	O
case	O
,	O
c	O
has	O
rank	O
r	O
and	O
the	O
row-space	O
of	O
c	O
is	O
generated	O
by	O
the	O
ﬁrst	O
r	O
rows	O
of	O
vt.	O
the	O
orthogonal	B
complement	O
of	O
the	O
row-space	O
of	O
c	O
consists	O
of	O
the	O
remaining	O
rows	O
of	O
vt.	O
deﬁne	O
c⊥	O
to	O
be	O
the	O
matrix	B
v	O
with	O
the	O
ﬁrst	O
r	O
columns	O
deleted	O
.	O
then	O
cc⊥	O
=	O
0	O
,	O
and	O
so	O
the	O
set	O
of	O
vectors	O
x	O
satisfying	O
cx	O
=	O
0	O
is	O
spanned	O
by	O
the	O
columns	O
of	O
c⊥	O
and	O
we	O
may	O
write	O
any	O
such	O
x	O
as	O
x	O
=	O
c⊥x	O
(	O
cid:2	O
)	O
for	O
suitable	O
has	O
orthogonal	B
columns	O
,	O
one	O
observes	O
that	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
c⊥x	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
=	O
(	O
cid:10	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
.	O
the	O
.	O
since	O
c⊥	O
x	O
(	O
cid:2	O
)	O
minimization	B
problem	O
now	O
becomes	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ac⊥x	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
=	O
1	O
.	O
•	O
find	O
the	O
x	O
(	O
cid:2	O
)	O
this	O
is	O
simply	O
an	O
instance	O
of	O
the	O
problem	O
discussed	O
in	O
section	O
a5.3	O
,	O
solved	O
by	O
algorithm	B
a5.4	O
.	O
the	O
complete	O
algorithm	B
for	O
solution	B
of	O
the	O
constrained	O
minimization	B
problem	O
is	O
given	O
as	O
algorithm	O
a5.5	O
.	O
objective	O
given	O
an	O
m	O
×	O
n	O
matrix	B
a	O
with	O
m	O
≥	O
n	O
,	O
ﬁnd	O
the	O
vector	O
x	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ax	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1	O
and	O
cx	O
=	O
0.	O
algorithm	B
(	O
i	O
)	O
if	O
c	O
has	O
fewer	O
rows	O
than	O
columns	O
,	O
then	O
add	O
zero-ﬁlled	O
rows	O
to	O
c	O
to	O
make	O
it	O
square	O
.	O
compute	O
the	O
svd	O
c	O
=	O
udvt	O
where	O
diagonal	O
entries	O
of	O
d	O
are	O
sorted	O
with	O
non-zero	O
ones	O
ﬁrst	O
.	O
let	O
c⊥	O
be	O
the	O
matrix	B
obtained	O
from	O
v	O
by	O
deleting	O
the	O
ﬁrst	O
r	O
columns	O
of	O
v	O
,	O
where	O
r	O
is	O
the	O
number	O
of	O
non-zero	O
entries	O
in	O
d	O
(	O
the	O
rank	O
of	O
c	O
)	O
.	O
(	O
ii	O
)	O
find	O
the	O
solution	B
to	O
the	O
minimization	B
problem	O
ac⊥x	O
(	O
cid:1	O
)	O
=	O
0	O
using	O
algorithm	O
a5.4	O
.	O
the	O
solution	B
is	O
given	O
by	O
x	O
=	O
c⊥x	O
(	O
cid:1	O
)	O
.	O
algorithm	B
a5.5	O
.	O
algorithm	B
for	O
constrained	O
minimization	B
.	O
a5.4.1	O
more	O
constrained	O
minimization	B
a	O
further	O
constrained	O
minimization	B
problem	O
arises	O
in	O
the	O
algebraic	B
estimation	O
method	O
used	O
frequently	O
throughout	O
this	O
book	O
–	O
for	O
instance	O
,	O
for	O
computation	O
of	O
the	O
fundamental	O
matrix	B
(	O
section	O
11.3	O
(	O
p282	O
)	O
)	O
or	O
the	O
trifocal	B
tensor	I
(	O
section	O
16.3	O
(	O
p395	O
)	O
)	O
.	O
the	O
problem	O
is	O
:	O
•	O
minimize	O
(	O
cid:10	O
)	O
ax	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1	O
and	O
x	O
=	O
gˆx	O
for	O
a	O
given	O
matrix	B
g	O
and	O
some	O
unknown	O
vector	O
ˆx	O
.	O
note	O
that	O
this	O
is	O
very	O
similar	O
to	O
the	O
previous	O
minimization	B
problem	O
of	O
section	O
a5.4	O
,	O
which	O
was	O
reduced	B
to	O
the	O
form	B
of	I
the	O
present	O
problem	O
in	O
which	O
the	O
matrix	B
g	O
had	O
or-	O
thonormal	O
columns	O
.	O
the	O
condition	O
that	O
x	O
=	O
gˆx	O
for	O
some	O
ˆx	O
means	O
nothing	O
more	O
than	O
that	O
x	O
lies	O
in	O
the	O
span	O
of	O
the	O
columns	O
of	O
g.	O
thus	O
,	O
to	O
solve	O
the	O
present	O
problem	O
using	O
algorithm	B
a5.5	O
,	O
we	O
need	O
only	O
to	O
replace	O
g	O
by	O
a	O
matrix	B
with	O
the	O
same	O
column	O
space	O
(	O
i.e	O
.	O
the	O
space	O
spanned	O
by	O
the	O
columns	O
)	O
,	O
but	O
with	O
orthonormal	O
columns	O
.	O
if	O
g	O
=	O
udvt	O
where	O
d	O
has	O
r	O
non-zero	O
entries	O
(	O
that	O
is	O
g	O
has	O
rank	O
r	O
)	O
,	O
then	O
let	O
u	O
(	O
cid:2	O
)	O
be	O
the	O
matrix	B
consisting	O
of	O
the	O
a5.4	O
least-squares	B
solution	I
to	O
constrained	O
systems	O
595	O
.	O
if	O
ˆx	O
is	O
also	O
required	O
,	O
then	O
it	O
may	O
be	O
obtained	O
by	O
solving	B
gˆx	O
=	O
x	O
=	O
u	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
have	O
the	O
same	O
column	O
space	O
.	O
as	O
in	O
section	O
a5.4	O
the	O
to	O
be	O
the	O
unit	O
vector	O
that	O
minimizes	O
(	O
cid:10	O
)	O
au	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
,	O
then	O
setting	O
ﬁrst	O
r	O
columns	O
of	O
u.	O
then	O
g	O
and	O
u	O
(	O
cid:2	O
)	O
solution	B
is	O
found	O
by	O
setting	O
x	O
(	O
cid:2	O
)	O
x	O
=	O
u	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
.	O
the	O
solution	B
is	O
expressed	O
in	O
terms	O
of	O
the	O
pseudo-inverse	O
(	O
section	O
a5.2	O
)	O
as	O
ˆx	O
=	O
g+x	O
=	O
g+u	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
;	O
it	O
may	O
not	O
be	O
unique	O
if	O
g	O
does	O
not	O
have	O
full	O
column	O
rank	O
.	O
since	O
g+	O
=	O
vd+ut	O
,	O
we	O
may	O
write	O
ˆx	O
=	O
vd+utu	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
consists	O
of	O
the	O
ﬁrst	O
r	O
and	O
d	O
(	O
cid:2	O
)	O
columns	O
of	O
v	O
(	O
cid:2	O
)	O
,	O
which	O
simpliﬁes	O
to	O
ˆx	O
=	O
v	O
(	O
cid:2	O
)	O
d	O
(	O
cid:2	O
)	O
−1x	O
(	O
cid:2	O
)	O
is	O
the	O
upper	O
r	O
×	O
r	O
block	O
of	O
d.	O
where	O
v	O
(	O
cid:2	O
)	O
the	O
complete	O
method	O
is	O
summarized	O
in	O
algorithm	O
a5.6	O
.	O
objective	O
find	O
the	O
vector	O
x	O
that	O
minimizes	O
(	O
cid:10	O
)	O
ax	O
(	O
cid:10	O
)	O
subject	O
to	O
the	O
conditions	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1	O
and	O
x	O
=	O
gˆx	O
,	O
where	O
g	O
has	O
rank	O
r.	O
algorithm	B
diagonal	O
.	O
(	O
i	O
)	O
compute	O
the	O
svd	O
g	O
=	O
udvt	O
,	O
where	O
the	O
non-zero	O
values	O
of	O
d	O
appear	O
ﬁrst	O
down	O
the	O
(	O
ii	O
)	O
let	O
u	O
(	O
cid:1	O
)	O
(	O
iii	O
)	O
find	O
the	O
unit	O
vector	O
x	O
(	O
cid:1	O
)	O
(	O
iv	O
)	O
the	O
required	O
solution	B
is	O
x	O
=	O
u	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
(	O
v	O
)	O
if	O
desired	O
,	O
one	O
may	O
compute	O
ˆx	O
as	O
v	O
(	O
cid:1	O
)	O
d	O
(	O
cid:1	O
)	O
−1x	O
(	O
cid:1	O
)	O
that	O
minimizes	O
(	O
cid:10	O
)	O
au	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
(	O
cid:10	O
)	O
,	O
using	O
algorithm	O
a5.4	O
.	O
be	O
the	O
matrix	B
comprising	O
the	O
ﬁrst	O
r	O
columns	O
of	O
u.	O
consists	O
of	O
the	O
ﬁrst	O
r	O
columns	O
of	O
,	O
where	O
v	O
(	O
cid:1	O
)	O
v	O
and	O
d	O
(	O
cid:1	O
)	O
is	O
the	O
upper	O
r	O
×	O
r	O
block	O
of	O
d.	O
.	O
algorithm	B
a5.6	O
.	O
algorithm	B
for	O
constrained	O
minimization	B
,	O
subject	O
to	O
a	O
span-space	O
constraint	O
.	O
a5.4.2	O
yet	O
another	O
minimization	B
problem	O
a	O
very	O
similar	O
problem	O
is	O
•	O
minimize	O
(	O
cid:10	O
)	O
ax	O
(	O
cid:10	O
)	O
subject	O
to	O
a	O
condition	O
(	O
cid:10	O
)	O
cx	O
(	O
cid:10	O
)	O
=	O
1.	O
this	O
problem	O
comes	O
up	O
for	O
instance	O
in	O
the	O
solution	B
to	O
the	O
dlt	O
camera	B
calibration	I
problem	O
(	O
section	O
7.3	O
(	O
p184	O
)	O
)	O
.	O
in	O
general	O
it	O
will	O
be	O
the	O
case	O
that	O
rankc	O
<	O
n	O
where	O
n	O
is	O
the	O
dimension	O
of	O
the	O
vector	O
x.	O
geometrically	O
the	O
problem	O
may	O
be	O
thought	O
of	O
as	O
ﬁnding	O
the	O
“	O
lowest	O
”	O
point	B
on	O
a	O
quadratic	O
surface	O
(	O
speciﬁed	O
by	O
xtatax	O
)	O
,	O
with	O
the	O
constraint	O
that	O
the	O
point	B
must	O
lie	O
on	O
the	O
(	O
inhomogeneous	O
)	O
“	O
conic	B
”	O
xtctcx	O
=	O
1.	O
we	O
start	O
by	O
taking	O
the	O
svd	O
of	O
the	O
matrix	O
c	O
,	O
obtaining	O
c	O
=	O
udvt	O
.	O
the	O
condition	O
(	O
cid:10	O
)	O
udvtx	O
(	O
cid:10	O
)	O
=	O
1	O
is	O
equivalent	B
to	O
(	O
cid:10	O
)	O
dvtx	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
and	O
it	O
is	O
not	O
necessary	O
to	O
compute	O
u	O
=	O
vtx	O
,	O
the	O
problem	O
becomes	O
:	O
minimize	O
(	O
cid:10	O
)	O
avx	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
subject	O
to	O
explicitly	O
.	O
then	O
writing	O
x	O
(	O
cid:2	O
)	O
the	O
condition	O
(	O
cid:10	O
)	O
dx	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
=	O
1	O
writing	O
a	O
(	O
cid:2	O
)	O
=	O
av	O
,	O
this	O
becomes	O
:	O
minimize	O
(	O
cid:10	O
)	O
a	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
dx	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
=	O
1.	O
thus	O
we	O
have	O
reduced	B
to	O
the	O
case	O
where	O
the	O
constraint	O
matrix	B
is	O
a	O
diagonal	O
matrix	B
,	O
d.	O
we	O
suppose	O
that	O
d	O
has	O
r	O
non-zero	O
diagonal	O
entries	O
,	O
and	O
s	O
zero	O
entries	O
,	O
where	O
r	O
+	O
s	O
=	O
(	O
cid:2	O
)	O
i	O
of	O
x	O
(	O
cid:2	O
)	O
n	O
,	O
the	O
non-zero	O
entries	O
appearing	O
ﬁrst	O
on	O
the	O
diagonal	O
of	O
d.	O
then	O
the	O
entries	O
x	O
(	O
cid:10	O
)	O
,	O
since	O
the	O
corresponding	O
diagonal	O
entries	O
of	O
for	O
i	O
>	O
r	O
do	O
not	O
affect	O
the	O
value	O
of	O
(	O
cid:10	O
)	O
dx	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
d	O
are	O
zero	O
.	O
then	O
,	O
for	O
a	O
speciﬁc	O
choice	B
of	O
the	O
x	O
i	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
r	O
,	O
the	O
other	O
entries	O
x	O
i	O
,	O
i	O
596	O
appendix	O
5	O
least-squares	O
minimization	O
1	O
i	O
|	O
a	O
(	O
cid:2	O
)	O
and	O
a	O
(	O
cid:2	O
)	O
=	O
[	O
a	O
(	O
cid:2	O
)	O
,	O
and	O
let	O
x	O
(	O
cid:2	O
)	O
1	O
consists	O
of	O
the	O
ﬁrst	O
r	O
columns	O
of	O
a	O
(	O
cid:2	O
)	O
2	O
]	O
where	O
a	O
(	O
cid:2	O
)	O
2	O
consist	O
of	O
the	O
remaining	O
s	O
elements	O
of	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
r	O
+	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
should	O
be	O
chosen	O
so	O
as	O
to	O
minimize	O
the	O
value	O
of	O
(	O
cid:10	O
)	O
a	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
a	O
(	O
cid:2	O
)	O
remaining	O
s	O
columns	O
.	O
similarly	O
,	O
let	O
x	O
(	O
cid:2	O
)	O
of	O
x	O
(	O
cid:2	O
)	O
diagonal	O
matrix	B
consisting	O
of	O
the	O
ﬁrst	O
r	O
diagonal	O
entries	O
of	O
d.	O
then	O
a	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
and	O
the	O
minimization	B
problem	O
is	O
to	O
minimize	O
x	O
(	O
cid:2	O
)	O
1	O
+	O
a	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
.	O
we	O
write	O
2	O
consists	O
of	O
the	O
1	O
be	O
an	O
r-vector	O
consisting	O
of	O
the	O
ﬁrst	O
r	O
elements	O
.	O
further	O
,	O
let	O
d1	O
be	O
the	O
r	O
×	O
r	O
x	O
(	O
cid:2	O
)	O
2	O
,	O
(	O
cid:10	O
)	O
=	O
1.	O
now	O
,	O
temporarily	O
ﬁxing	O
x	O
(	O
cid:2	O
)	O
subject	O
to	O
the	O
condition	O
(	O
cid:10	O
)	O
d1x	O
(	O
cid:2	O
)	O
1	O
,	O
(	O
a5.4	O
)	O
takes	O
the	O
form	B
of	I
a	O
least-squares	O
minimization	O
problem	O
of	O
the	O
type	O
discussed	O
in	O
section	O
a5.1	O
.	O
according	O
to	O
result	O
a5.1	O
,	O
the	O
value	O
of	O
x	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
1.	O
substituting	O
this	O
in	O
(	O
a5.4	O
)	O
gives	O
(	O
cid:10	O
)	O
(	O
a	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
,	O
which	O
we	O
are	O
required	O
to	O
minimize	O
,	O
subject	O
to	O
the	O
condition	O
(	O
cid:10	O
)	O
d1x	O
(	O
cid:2	O
)	O
1	O
,	O
the	O
problem	O
reduces	O
at	O
last	O
to	O
a	O
problem	O
of	O
the	O
form	B
of	I
the	O
familiar	O
minimization	B
problem	O
of	O
algorithm	O
a5.4	O
.	O
•	O
minimize	O
(	O
cid:10	O
)	O
(	O
a	O
(	O
cid:2	O
)	O
+	O
−	O
i	O
)	O
a	O
(	O
cid:2	O
)	O
1	O
we	O
now	O
summarize	O
the	O
algorithm	B
.	O
2	O
that	O
minimizes	O
(	O
a5.4	O
)	O
is	O
x	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
=	O
1.	O
finally	O
,	O
writing	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
,	O
subject	O
to	O
(	O
cid:10	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
=	O
1	O
.	O
2	O
=	O
−a	O
(	O
cid:2	O
)	O
+−i	O
)	O
a	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
1	O
+a	O
(	O
cid:2	O
)	O
=	O
d1x	O
(	O
cid:2	O
)	O
=	O
a	O
(	O
cid:2	O
)	O
(	O
a5.4	O
)	O
d−1	O
(	O
cid:10	O
)	O
a	O
(	O
cid:2	O
)	O
+a	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
x	O
(	O
cid:2	O
)	O
a	O
(	O
cid:2	O
)	O
a	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
1	O
2	O
2	O
2	O
2	O
2	O
1	O
1	O
2	O
2	O
1	O
1	O
2	O
1	O
1	O
1	O
1	O
objective	O
minimize	O
(	O
cid:10	O
)	O
ax	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
cx	O
(	O
cid:10	O
)	O
=	O
1.	O
algorithm	B
a	O
(	O
cid:1	O
)	O
1	O
|	O
a	O
(	O
cid:1	O
)	O
,	O
and	O
a	O
(	O
cid:1	O
)	O
2	O
]	O
where	O
a	O
(	O
cid:1	O
)	O
2	O
is	O
formed	O
from	O
the	O
remaining	O
columns	O
.	O
(	O
i	O
)	O
compute	O
the	O
svd	O
c	O
=	O
udvt	O
,	O
and	O
write	O
a	O
(	O
cid:1	O
)	O
=	O
av	O
.	O
(	O
ii	O
)	O
suppose	O
rankd	O
=	O
r	O
and	O
let	O
a	O
(	O
cid:1	O
)	O
=	O
[	O
a	O
(	O
cid:1	O
)	O
(	O
iii	O
)	O
let	O
d1	O
be	O
the	O
upper	O
r	O
×	O
r	O
minor	O
of	O
d.	O
(	O
cid:29	O
)	O
1	O
.	O
this	O
is	O
an	O
n	O
×	O
r	O
matrix	B
.	O
+	O
−	O
i	O
)	O
a	O
(	O
cid:1	O
)	O
1d−1	O
(	O
iv	O
)	O
compute	O
a	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
=	O
(	O
a	O
(	O
cid:1	O
)	O
(	O
v	O
)	O
minimize	O
(	O
cid:10	O
)	O
a	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
(	O
cid:10	O
)	O
subject	O
to	O
(	O
cid:10	O
)	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:10	O
)	O
=	O
1	O
using	O
algorithm	O
a5.4	O
.	O
2	O
=	O
−a	O
(	O
cid:1	O
)	O
(	O
vi	O
)	O
set	O
x	O
(	O
cid:1	O
)	O
.	O
(	O
vii	O
)	O
the	O
solution	B
is	O
given	O
by	O
x	O
=	O
vx	O
(	O
cid:1	O
)	O
1.	O
let	O
x	O
(	O
cid:1	O
)	O
=	O
1	O
=	O
d−1	O
,	O
and	O
x	O
(	O
cid:1	O
)	O
1	O
x	O
(	O
cid:1	O
)	O
(	O
cid:1	O
)	O
(	O
cid:28	O
)	O
1x	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
x	O
(	O
cid:1	O
)	O
+a	O
(	O
cid:1	O
)	O
2a	O
(	O
cid:1	O
)	O
2	O
2	O
1	O
2	O
.	O
1	O
consists	O
of	O
the	O
ﬁrst	O
r	O
columns	O
of	O
algorithm	O
a5.7	O
.	O
least-squares	B
solution	I
of	O
homogeneous	O
equations	O
subject	O
to	O
the	O
constraint	O
(	O
cid:10	O
)	O
cx	O
(	O
cid:10	O
)	O
=	O
1.	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
in	O
this	O
appendix	O
we	O
describe	O
the	O
various	O
components	O
involved	O
in	O
building	O
an	O
efﬁcient	O
and	O
robust	B
iterative	O
estimation	B
algorithm	O
.	O
we	O
start	O
with	O
two	O
of	O
the	O
most	O
common	O
iterative	B
parameter	O
minimization	B
meth-	O
ods	O
,	O
namely	O
newton	O
iteration	B
(	O
and	O
the	O
closely	O
related	O
gauss-newton	O
method	O
)	O
and	O
levenberg–marquardt	O
iteration	B
.	O
the	O
general	O
idea	O
of	O
newton	O
iteration	B
is	O
familiar	O
to	O
most	O
students	O
of	O
numerical	O
methods	O
as	O
a	O
way	O
of	O
ﬁnding	O
the	O
zeros	O
of	O
a	O
function	O
of	O
a	O
single	O
variable	O
.	O
its	O
generalization	O
to	O
several	O
variables	O
and	O
application	O
to	O
ﬁnding	O
least-squares	O
solutions	O
rather	O
than	O
exact	O
solutions	O
to	O
sets	O
of	O
equations	O
is	O
relatively	O
straightforward	O
.	O
the	O
levenberg–marquardt	O
method	O
is	O
a	O
simple	O
variation	O
on	O
newton	O
iteration	B
designed	O
to	O
provide	O
faster	O
convergence	O
and	O
regularization	O
in	O
the	O
case	O
of	O
over-	O
parametrized	O
problems	O
.	O
it	O
may	O
be	O
seen	O
as	O
a	O
hybrid	O
between	O
newton	O
iteration	B
and	O
a	O
gradient	B
descent	I
method	O
.	O
for	O
the	O
type	O
of	O
problem	O
considered	O
in	O
this	O
book	O
,	O
important	O
reductions	O
of	O
computa-	O
tional	O
complexity	O
are	O
obtained	O
by	O
dividing	O
the	O
set	O
of	O
parameters	O
into	O
two	O
parts	O
.	O
the	O
two	O
parts	O
generally	O
consist	O
of	O
a	O
set	O
of	O
parameters	O
representing	O
camera	B
matrices	I
or	O
homo-	O
graphies	O
,	O
and	O
a	O
set	O
of	O
parameters	O
representing	O
points	O
.	O
this	O
leads	O
to	O
a	O
sparse	B
structure	O
to	O
the	O
problem	O
that	O
is	O
described	O
starting	O
at	O
section	O
a6.3	O
.	O
we	O
discuss	O
two	O
further	O
implementation	B
issues	O
–	O
the	O
choice	B
of	O
cost	B
function	I
,	O
with	O
re-	O
spect	O
to	O
their	O
robustness	O
to	O
outliers	O
and	O
convexity	O
(	O
section	O
a6.8	O
)	O
;	O
and	O
the	O
parametriza-	O
tion	O
of	O
rotations	O
,	O
and	O
homogeneous	O
and	O
constrained	O
vectors	O
(	O
section	O
a6.9	O
)	O
.	O
finally	O
,	O
those	O
readers	O
who	O
want	O
to	O
learn	O
more	O
about	O
iterative	B
techniques	O
and	O
bundle-adjustment	O
are	O
referred	O
to	O
[	O
triggs-00a	O
]	O
for	O
more	O
details	O
.	O
a6.1	O
newton	O
iteration	B
suppose	O
we	O
are	O
given	O
a	O
hypothesized	O
functional	O
relation	B
x	O
=	O
f	O
(	O
p	O
)	O
where	O
x	O
is	O
a	O
mea-	O
surement	O
vector	O
and	O
p	O
is	O
a	O
parameter	O
vector	O
in	O
euclidean	O
spaces	O
irn	O
and	O
irm	O
respec-	O
tively	O
.	O
a	O
measured	O
value	O
of	O
x	O
approximating	O
the	O
true	O
value	O
x	O
is	O
provided	O
,	O
and	O
we	O
wish	O
to	O
ﬁnd	O
the	O
vector	O
(	O
cid:23	O
)	O
p	O
that	O
most	O
nearly	O
satisﬁes	O
this	O
functional	O
relation	B
.	O
more	O
precisely	O
,	O
we	O
seek	O
the	O
vector	O
(	O
cid:23	O
)	O
p	O
satisfying	O
x	O
=	O
f	O
(	O
(	O
cid:23	O
)	O
p	O
)	O
−	O
	O
for	O
which	O
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
is	O
minimized	O
.	O
note	O
that	O
the	O
linear	B
least-squares	O
problem	O
considered	O
in	O
section	O
a5.1	O
is	O
exactly	O
of	O
this	O
type	O
,	O
the	O
function	O
f	O
being	O
deﬁned	O
as	O
a	O
linear	B
function	O
f	O
(	O
p	O
)	O
=	O
ap	O
.	O
597	O
598	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
to	O
solve	O
the	O
case	O
where	O
f	O
is	O
not	O
a	O
linear	B
function	O
,	O
we	O
may	O
start	O
with	O
an	O
initial	O
es-	O
timated	O
value	O
p0	O
,	O
and	O
proceed	O
to	O
reﬁne	O
the	O
estimate	O
under	O
the	O
assumption	O
that	O
the	O
function	O
f	O
is	O
locally	O
linear	B
.	O
let	O
0	O
be	O
deﬁned	O
by	O
0	O
=	O
f	O
(	O
p0	O
)	O
−	O
x.	O
we	O
assume	O
that	O
the	O
function	O
f	O
is	O
approximated	O
at	O
p0	O
by	O
f	O
(	O
p0	O
+	O
∆	O
)	O
=	O
f	O
(	O
p0	O
)	O
+	O
j∆	O
,	O
where	O
j	O
is	O
the	O
linear	B
mapping	O
represented	O
by	O
the	O
jacobian	O
matrix	B
j	O
=	O
∂f	O
/∂p	O
.	O
we	O
seek	O
a	O
point	B
f	O
(	O
p1	O
)	O
,	O
with	O
p1	O
=	O
p0	O
+	O
∆	O
,	O
which	O
minimizes	O
f	O
(	O
p1	O
)	O
−	O
x	O
=	O
f	O
(	O
p0	O
)	O
+j	O
∆	O
−	O
x	O
=	O
0	O
+	O
j∆	O
.	O
thus	O
,	O
it	O
is	O
required	O
to	O
minimize	O
(	O
cid:10	O
)	O
0	O
+	O
j∆	O
(	O
cid:10	O
)	O
over	O
∆	O
,	O
which	O
is	O
a	O
linear	B
minimization	O
problem	O
.	O
the	O
vector	O
∆	O
is	O
obtained	O
by	O
solving	B
the	O
normal	B
equations	I
(	O
see	O
(	O
a5.2	O
)	O
)	O
or	O
by	O
using	O
the	O
pseudo-inverse	B
∆	O
=	O
−j+0	O
.	O
thus	O
,	O
the	O
solution	B
vector	O
(	O
cid:23	O
)	O
p	O
is	O
obtained	O
jtj∆	O
=	O
−jt0	O
(	O
a6.1	O
)	O
by	O
starting	O
with	O
an	O
estimate	O
p0	O
and	O
computing	B
successive	O
approximations	O
according	O
to	O
the	O
formula	O
where	O
∆i	O
is	O
the	O
solution	B
to	O
the	O
linear	B
least-squares	O
problem	O
pi+1	O
=	O
pi	O
+	O
∆i	O
this	O
algorithm	B
will	O
converge	O
to	O
the	O
required	O
least-squares	B
solution	I
(	O
cid:23	O
)	O
p.	O
unfortunately	O
,	O
it	O
matrix	B
j	O
is	O
the	O
jacobian	O
∂f	O
/∂p	O
evaluated	O
at	O
pi	O
and	O
i	O
=	O
f	O
(	O
pi	O
)	O
−	O
x.	O
one	O
hopes	O
that	O
j∆i	O
=	O
−i	O
.	O
is	O
possible	O
that	O
this	O
iteration	B
procedure	O
converges	O
to	O
a	O
local	O
minimum	O
value	O
,	O
or	O
does	O
not	O
converge	O
at	O
all	O
.	O
the	O
behaviour	O
of	O
the	O
iteration	O
algorithm	B
depends	O
very	O
strongly	O
on	O
the	O
initial	O
estimate	O
p0	O
.	O
weighted	B
iteration	O
.	O
as	O
an	O
alternative	O
to	O
all	O
the	O
dependent	O
variables	O
being	O
equally	O
weighted	B
it	O
is	O
possible	O
to	O
provide	O
a	O
weight	O
matrix	B
specifying	O
the	O
weights	O
of	O
the	O
depen-	O
dent	O
variables	O
x.	O
to	O
be	O
more	O
precise	O
,	O
one	O
may	O
assume	O
that	O
the	O
measurement	O
x	O
satisﬁes	O
a	O
gaussian	O
distribution	B
with	O
covariance	B
matrix	O
σx	O
,	O
and	O
one	O
wishes	O
to	O
minimize	O
the	O
ma-	O
halanobis	O
distance	B
(	O
cid:10	O
)	O
f	O
(	O
(	O
cid:23	O
)	O
p	O
)	O
−	O
x	O
(	O
cid:10	O
)	O
σ.	O
this	O
covariance	B
matrix	O
may	O
be	O
diagonal	O
,	O
specifying	O
that	O
the	O
individual	O
coordinates	B
of	O
x	O
are	O
independent	O
,	O
or	O
more	O
generally	O
it	O
may	O
be	O
an	O
arbitrary	O
symmetric	B
and	O
positive	B
deﬁnite	I
matrix	I
.	O
in	O
this	O
case	O
,	O
the	O
normal	B
equations	I
become	O
jtς−1j∆i	O
=	O
−jtς−1i	O
.	O
the	O
rest	O
of	O
the	O
algorithm	O
remains	O
unchanged	O
.	O
newton	O
’	O
s	O
method	O
and	O
the	O
hessian	O
.	O
we	O
pass	O
now	O
to	O
consideration	O
of	O
ﬁnding	O
minima	O
of	O
functions	O
of	O
many	O
variables	O
.	O
for	O
the	O
present	O
,	O
we	O
consider	O
an	O
arbitrary	O
scalar-valued	O
function	O
g	O
(	O
p	O
)	O
where	O
p	O
is	O
a	O
vector	O
.	O
the	O
optimization	O
problem	O
is	O
simply	O
to	O
minimize	O
g	O
(	O
p	O
)	O
over	O
all	O
values	O
of	O
p.	O
we	O
make	O
two	O
assumptions	O
:	O
that	O
g	O
(	O
p	O
)	O
has	O
a	O
well-deﬁned	O
minimum	O
value	O
,	O
and	O
that	O
we	O
know	O
a	O
point	B
p0	O
reasonably	O
close	O
to	O
this	O
minimum	O
.	O
we	O
may	O
expand	O
g	O
(	O
p	O
)	O
about	O
p0	O
in	O
a	O
taylor	O
series	O
to	O
get	O
g	O
(	O
p0	O
+	O
∆	O
)	O
=	O
g	O
+	O
gp∆	O
+	O
∆tgpp∆/2	O
+	O
.	O
.	O
.	O
where	O
subscript	O
p	O
denotes	O
differentiation	O
,	O
and	O
the	O
right	O
hand	O
side	O
is	O
evaluated	O
at	O
p0	O
.	O
599	O
we	O
wish	O
to	O
minimize	O
this	O
quantity	O
with	O
respect	O
to	O
∆	O
.	O
to	O
this	O
end	O
,	O
we	O
differentiate	O
with	O
respect	O
to	O
∆	O
and	O
set	O
the	O
derivative	O
to	O
zero	O
,	O
arriving	O
at	O
the	O
equation	O
gp	O
+	O
gpp∆	O
=	O
0	O
or	O
a6.1	O
newton	O
iteration	B
gpp∆	O
=	O
−gp	O
.	O
(	O
a6.2	O
)	O
in	O
this	O
equation	O
,	O
gpp	O
is	O
the	O
matrix	B
of	O
second	O
derivatives	O
,	O
the	O
hessian	O
of	O
g	O
,	O
the	O
(	O
i	O
,	O
j	O
)	O
-th	O
entry	O
of	O
which	O
is	O
∂2g/∂pi∂pj	O
,	O
and	O
pi	O
and	O
pj	O
are	O
the	O
i-th	O
and	O
j-th	O
parameters	B
.	O
vector	O
gp	O
is	O
the	O
gradient	O
of	O
g.	O
the	O
method	O
of	O
newton	O
iteration	B
consists	O
in	O
starting	O
at	O
an	O
initial	O
value	O
of	O
the	O
parameters	O
,	O
p0	O
,	O
and	O
iteratively	O
computing	B
parameter	O
increments	O
∆	O
using	O
(	O
a6.2	O
)	O
until	O
convergence	O
occurs	O
.	O
now	O
we	O
turn	O
to	O
the	O
sort	O
of	O
cost	O
function	O
that	O
arises	O
in	O
the	O
least-squares	O
minimization	O
problem	O
considered	O
above	O
.	O
speciﬁcally	O
,	O
g	O
(	O
p	O
)	O
is	O
the	O
squared	O
norm	O
of	O
an	O
error	B
function	O
g	O
(	O
p	O
)	O
=	O
1	O
2	O
(	O
cid:10	O
)	O
	O
(	O
p	O
)	O
(	O
cid:10	O
)	O
2	O
=	O
	O
(	O
p	O
)	O
t	O
(	O
p	O
)	O
/2	O
where	O
	O
(	O
p	O
)	O
is	O
a	O
vector-valued	O
function	O
of	O
the	O
parameter	O
vector	O
p.	O
in	O
particular	O
,	O
	O
(	O
p	O
)	O
=	O
f	O
(	O
p	O
)	O
−	O
x.	O
the	O
factor	O
1/2	O
is	O
present	O
for	O
simplifying	O
the	O
succeeding	O
computations	O
.	O
the	O
gradient	O
vector	O
gp	O
is	O
easily	O
computed	O
to	O
be	O
t	O
p	O
.	O
however	O
,	O
we	O
may	O
write	O
p	O
=	O
f	O
p	O
=	O
j	O
using	O
the	O
notation	O
introduced	O
previously	O
.	O
in	O
short	O
gp	O
=	O
jt	O
.	O
differentiating	O
gp	O
=	O
t	O
p	O
a	O
second	O
time	O
,	O
we	O
compute	O
the	O
following	O
formula	O
for	O
the	O
hessian.1	O
gpp	O
=	O
t	O
pp	O
+	O
t	O
pp	O
.	O
(	O
a6.3	O
)	O
now	O
,	O
under	O
the	O
assumption	O
that	O
f	O
(	O
p	O
)	O
is	O
linear	B
,	O
the	O
second	O
term	O
on	O
the	O
right	O
vanishes	O
,	O
pp	O
=	O
jtj	O
.	O
now	O
,	O
substituting	O
for	O
the	O
gradient	O
and	O
hessian	O
in	O
(	O
a6.2	O
)	O
leaving	O
gpp	O
=	O
t	O
yields	O
jtj∆	O
=	O
−jt	O
which	O
is	O
nothing	O
more	O
than	O
the	O
normal	B
equations	I
(	O
a6.1	O
)	O
.	O
thus	O
we	O
have	O
arrived	O
at	O
the	O
same	O
iterative	O
procedure	O
as	O
previously	O
solving	B
the	O
parameter	O
estimation	O
problem	O
,	O
under	O
the	O
assumption	O
that	O
jtj	O
=	O
t	O
pp	O
is	O
a	O
reasonable	O
approxima-	O
tion	O
for	O
the	O
hessian	O
of	O
the	O
function	O
g	O
(	O
p	O
)	O
.	O
this	O
procedure	O
in	O
which	O
jtj	O
is	O
used	O
as	O
an	O
approximation	O
for	O
the	O
hessian	O
is	O
known	O
as	O
the	O
gauss-newton	O
method	O
.	O
gradient	B
descent	I
.	O
the	O
negative	O
(	O
or	O
down-hill	O
)	O
gradient	O
vector	O
−gp	O
=	O
−t	O
p	O
deﬁnes	O
the	O
direction	O
of	O
most	O
rapid	O
decrease	O
of	O
the	O
cost	O
function	O
.	O
a	O
strategy	O
for	O
minimization	O
of	O
g	O
is	O
to	O
move	O
iteratively	O
in	O
the	O
gradient	O
direction	O
.	O
this	O
is	O
known	O
as	O
gradient	B
descent	I
.	O
the	O
length	O
of	O
the	O
step	O
may	O
be	O
computed	O
by	O
carrying	O
out	O
a	O
line	B
search	O
for	O
the	O
function	O
minimum	O
in	O
the	O
negative	O
gradient	O
direction	O
.	O
in	O
this	O
case	O
,	O
the	O
parameter	O
increment	O
∆	O
is	O
computed	O
from	O
the	O
equation	O
λ∆	O
=	O
−gp	O
,	O
where	O
λ	O
controls	O
the	O
length	O
of	O
the	O
step	O
.	O
we	O
may	O
consider	O
this	O
as	O
related	O
to	O
newton	O
iteration	B
as	O
expressed	O
by	O
the	O
update	O
equa-	O
tion	O
(	O
a6.2	O
)	O
in	O
which	O
the	O
hessian	O
is	O
approximated	O
(	O
somewhat	O
arbitrarily	O
)	O
by	O
the	O
scalar	O
matrix	B
λi	O
.	O
gradient	B
descent	I
by	O
itself	O
is	O
not	O
a	O
very	O
good	O
minimization	B
strategy	O
,	O
typ-	O
ically	O
characterized	O
by	O
slow	O
convergence	O
due	O
to	O
zig-zagging	O
.	O
(	O
see	O
[	O
press-88	O
]	O
for	O
a	O
closer	O
analysis	O
.	O
)	O
it	O
will	O
be	O
seen	O
in	O
the	O
next	O
section	O
,	O
however	O
,	O
that	O
it	O
can	O
be	O
useful	O
in	O
conjunction	O
with	O
gauss-newton	O
iteration	B
as	O
a	O
way	O
of	O
getting	O
out	O
of	O
tight	O
corners	O
.	O
the	O
1	O
the	O
last	O
term	O
in	O
this	O
formula	O
needs	O
some	O
clariﬁcation	O
.	O
since	O
(	O
cid:1	O
)	O
is	O
a	O
vector	O
,	O
(	O
cid:1	O
)	O
pp	O
is	O
a	O
3-dimensional	O
array	O
(	O
a	O
tensor	B
)	O
.	O
the	O
sum	O
i	O
(	O
i	O
)	O
ppi	O
where	O
i	O
is	O
the	O
t	O
pp	O
(	O
cid:1	O
)	O
is	O
over	O
the	O
components	O
of	O
(	O
cid:1	O
)	O
.	O
it	O
may	O
be	O
written	O
more	O
precisely	O
as	O
implied	O
by	O
the	O
product	O
(	O
cid:1	O
)	O
i-th	O
components	O
of	O
the	O
vector	O
(	O
cid:1	O
)	O
,	O
and	O
(	O
i	O
)	O
pp	O
is	O
its	O
hessian	O
.	O
(	O
cid:27	O
)	O
600	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
levenberg–marquardt	O
method	O
is	O
essentially	O
a	O
gauss-newton	O
method	O
that	O
transitions	O
smoothly	O
to	O
gradient	O
descent	O
when	O
the	O
gauss-newton	O
updates	O
fail	O
.	O
to	O
summarize	O
,	O
we	O
have	O
so	O
far	O
considered	O
three	O
methods	O
of	O
minimization	O
of	O
a	O
cost	O
function	O
g	O
(	O
p	O
)	O
=	O
(	O
cid:10	O
)	O
	O
(	O
p	O
)	O
(	O
cid:10	O
)	O
2/2	O
:	O
(	O
i	O
)	O
newton	O
.	O
update	O
equation	O
:	O
gpp∆	O
=	O
−gp	O
pp	O
+	O
t	O
pp	O
and	O
gp	O
=	O
t	O
where	O
gpp	O
=	O
t	O
p	O
.	O
newton	O
iteration	B
is	O
based	O
on	O
the	O
assumption	O
of	O
an	O
approximately	O
quadratic	O
cost	B
function	I
near	O
the	O
minimum	O
,	O
and	O
will	O
show	O
rapid	O
convergence	O
if	O
this	O
condition	O
is	O
met	O
.	O
the	O
disadvantage	O
of	O
this	O
approach	O
is	O
that	O
the	O
computation	B
of	I
the	O
hessian	O
may	O
be	O
difﬁcult	O
.	O
in	O
addition	O
,	O
far	O
from	O
the	O
minimum	O
the	O
assumption	O
of	O
quadratic	O
behaviour	O
is	O
probably	O
invalid	O
,	O
so	O
a	O
lot	O
of	O
extra	O
work	O
is	O
done	O
with	O
little	O
beneﬁt	O
.	O
(	O
ii	O
)	O
gauss-newton	O
.	O
update	O
equation	O
:	O
pp∆	O
=	O
−t	O
t	O
p	O
this	O
is	O
equivalent	B
to	O
newton	O
iteration	B
in	O
which	O
the	O
hessian	O
is	O
approximated	O
by	O
t	O
pp	O
.	O
generally	O
this	O
is	O
a	O
good	O
approximation	O
,	O
particularly	O
close	O
to	O
a	O
minimum	O
,	O
or	O
when	O
	O
is	O
nearly	O
linear	B
in	O
p.	O
(	O
iii	O
)	O
gradient	B
descent	I
.	O
update	O
equation	O
:	O
λ∆	O
=	O
−t	O
p	O
=	O
−gp	O
.	O
the	O
hessian	O
in	O
newton	O
iteration	B
is	O
replaced	O
by	O
a	O
multiple	O
of	O
the	O
identity	O
ma-	O
trix	O
.	O
each	O
update	O
is	O
in	O
the	O
direction	O
of	O
most	O
rapid	O
local	O
decrease	O
of	O
the	O
function	O
value	O
.	O
the	O
value	O
of	O
λ	O
may	O
be	O
chosen	O
adaptively	O
,	O
or	O
by	O
a	O
line	B
search	O
in	O
the	O
downward	O
gradient	O
direction	O
.	O
generally	O
,	O
gradient	B
descent	I
by	O
itself	O
is	O
not	O
rec-	O
ommended	O
,	O
but	O
in	O
conjunction	O
with	O
gauss-newton	O
it	O
yields	O
the	O
commonly	O
used	O
levenberg–marquardt	O
method	O
.	O
a6.2	O
levenberg–marquardt	O
iteration	B
the	O
levenberg–marquardt	O
(	O
abbreviated	O
lm	O
)	O
iteration	B
method	O
is	O
a	O
slight	O
variation	O
on	O
the	O
gauss-newton	O
iteration	B
method	O
.	O
the	O
normal	B
equations	I
jtj∆	O
=	O
−jt	O
are	O
replaced	O
by	O
the	O
augmented	O
normal	B
equations	I
(	O
jtj	O
+	O
λi	O
)	O
∆	O
=	O
−jt	O
,	O
for	O
some	O
value	O
of	O
λ	O
that	O
varies	O
from	O
iteration	O
to	O
iteration	O
.	O
here	O
i	O
is	O
the	O
identity	O
matrix	B
.	O
a	O
typical	O
initial	O
value	O
of	O
λ	O
is	O
10	O
−3	O
times	O
the	O
average	O
of	O
the	O
diagonal	O
elements	O
of	O
n	O
=	O
jtj	O
.	O
if	O
the	O
value	O
of	O
∆	O
obtained	O
by	O
solving	B
the	O
augmented	O
normal	B
equations	I
leads	O
to	O
a	O
reduction	O
in	O
the	O
error	B
,	O
then	O
the	O
increment	O
is	O
accepted	O
and	O
λ	O
is	O
divided	O
by	O
a	O
factor	O
(	O
typi-	O
cally	O
10	O
)	O
before	O
the	O
next	O
iteration	B
.	O
on	O
the	O
other	O
hand	O
if	O
the	O
value	O
∆	O
leads	O
to	O
an	O
increased	O
error	B
,	O
then	O
λ	O
is	O
multiplied	O
by	O
the	O
same	O
factor	O
and	O
the	O
augmented	O
normal	B
equations	I
are	O
solved	O
again	O
,	O
this	O
process	O
continuing	O
until	O
a	O
value	O
of	O
∆	O
is	O
found	O
that	O
gives	O
rise	O
to	O
a	O
decreased	O
error	B
.	O
this	O
process	O
of	O
repeatedly	O
solving	B
the	O
augmented	O
normal	B
equations	I
for	O
different	O
values	O
of	O
λ	O
until	O
an	O
acceptable	O
∆	O
is	O
found	O
constitutes	O
one	O
iteration	B
of	O
the	O
lm	O
algorithm	B
.	O
an	O
implementation	B
of	O
the	O
lm	O
algorithm	B
is	O
given	O
in	O
[	O
press-88	O
]	O
.	O
a6.2	O
levenberg–marquardt	O
iteration	B
601	O
justiﬁcation	B
of	O
lm	O
.	O
to	O
understand	O
the	O
reasoning	O
behind	O
this	O
method	O
,	O
consider	O
what	O
happens	O
for	O
different	O
values	O
of	O
λ.	O
when	O
λ	O
is	O
very	O
small	O
,	O
the	O
method	O
is	O
essentially	O
the	O
same	O
as	O
gauss-newton	O
iteration	B
.	O
if	O
the	O
error	B
function	O
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
2	O
=	O
(	O
cid:10	O
)	O
f	O
(	O
p	O
)	O
−	O
x	O
(	O
cid:10	O
)	O
2	O
is	O
close	O
to	O
being	O
quadratic	O
in	O
p	O
,	O
then	O
this	O
method	O
will	O
converge	O
fast	O
to	O
the	O
minimum	O
value	O
.	O
on	O
the	O
other	O
hand	O
when	O
λ	O
is	O
large	O
then	O
the	O
normal	O
equation	O
matrix	B
is	O
approximated	O
by	O
λi	O
,	O
and	O
the	O
normal	B
equations	I
become	O
λ∆	O
=	O
−jt	O
.	O
recalling	O
that	O
jt	O
is	O
simply	O
the	O
gradient	O
vector	O
of	O
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
2	O
,	O
we	O
see	O
that	O
the	O
direction	O
of	O
the	O
parameter	O
increment	O
∆	O
approaches	O
that	O
given	O
by	O
gradient	B
descent	I
.	O
thus	O
,	O
the	O
lm	O
algorithm	B
moves	O
seamlessly	O
between	O
gauss-newton	O
iteration	B
,	O
which	O
will	O
cause	O
rapid	O
convergence	O
in	O
the	O
neighbourhood	O
of	O
the	O
solution	O
,	O
and	O
a	O
gradient	B
descent	I
approach	O
,	O
which	O
will	O
guarantee	O
a	O
decrease	O
in	O
the	O
cost	B
function	I
when	O
the	O
going	O
is	O
difﬁcult	O
.	O
indeed	O
,	O
as	O
λ	O
becomes	O
larger	O
and	O
larger	O
,	O
the	O
length	O
of	O
the	O
increment	O
step	O
∆	O
decreases	O
and	O
eventually	O
it	O
will	O
lead	O
to	O
a	O
decrease	O
of	O
the	O
cost	O
function	O
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
2.	O
to	O
demonstrate	O
that	O
the	O
parameter	O
increment	O
∆	O
obtained	O
by	O
solving	B
the	O
augmented	O
normal	B
equations	I
for	O
all	O
values	O
of	O
λ	O
is	O
in	O
the	O
direction	O
of	O
decreasing	O
cost	O
,	O
we	O
will	O
show	O
that	O
the	O
inner	O
product	O
of	O
∆	O
and	O
the	O
negative	O
gradient	O
direction	O
for	O
the	O
function	O
g	O
(	O
p	O
)	O
=	O
(	O
cid:10	O
)	O
	O
(	O
p	O
)	O
(	O
cid:10	O
)	O
2	O
is	O
positive	O
.	O
this	O
results	O
from	O
the	O
following	O
computation	B
.	O
−gp	O
·	O
∆	O
=	O
−gt	O
p∆	O
=	O
(	O
jt	O
)	O
t	O
(	O
jtj	O
+	O
λi	O
)	O
−1jt	O
however	O
,	O
jtj+λi	O
is	O
positive-deﬁnite	O
for	O
any	O
value	O
of	O
λ	O
,	O
and	O
so	O
therefore	O
is	O
its	O
inverse	O
.	O
−1jt	O
is	O
positive	O
,	O
unless	O
jt	O
is	O
zero	O
.	O
by	O
deﬁnition	B
,	O
this	O
means	O
that	O
(	O
jt	O
)	O
t	O
(	O
jtj	O
+	O
λi	O
)	O
thus	O
,	O
the	O
increment	O
∆	O
is	O
in	O
a	O
direction	O
of	O
locally	O
decreasing	O
cost	O
,	O
unless	O
of	O
course	O
the	O
gradient	O
jt	O
is	O
zero	O
.	O
a	O
different	O
augmentation	B
.	O
in	O
some	O
implementations	O
of	O
levenberg-marquardt	O
,	O
no-	O
tably	O
that	O
given	O
in	O
[	O
press-88	O
]	O
,	O
a	O
different	O
method	O
of	O
augmenting	O
the	O
normal	B
equations	I
is	O
used	O
.	O
the	O
augmented	O
normal	O
equation	O
matrix	B
n	O
(	O
cid:2	O
)	O
is	O
deﬁned	O
in	O
terms	O
of	O
the	O
matrix	O
ij	O
=	O
nij	O
for	O
i	O
(	O
cid:5	O
)	O
=	O
j.	O
thus	O
the	O
diagonal	O
of	O
n	O
is	O
n	O
=	O
jtj	O
by	O
n	O
(	O
cid:2	O
)	O
augmented	O
by	O
a	O
multiplicative	O
factor	O
(	O
1	O
+	O
λ	O
)	O
instead	O
of	O
an	O
additive	O
factor	O
.	O
as	O
before	O
,	O
a	O
small	O
value	O
of	O
λ	O
,	O
results	O
essentially	O
in	O
a	O
gauss-newton	O
update	O
.	O
for	O
large	O
λ	O
,	O
the	O
off-	O
diagonal	O
entries	O
of	O
the	O
normal	O
equation	O
matrix	B
become	O
insigniﬁcant	O
with	O
respect	O
to	O
the	O
diagonal	O
ones	O
.	O
ii	O
=	O
(	O
1	O
+	O
λ	O
)	O
nii	O
and	O
n	O
(	O
cid:2	O
)	O
the	O
i-th	O
diagonal	O
entry	O
of	O
n	O
(	O
cid:2	O
)	O
is	O
simply	O
(	O
1	O
+	O
λ	O
)	O
jt	O
i	O
ji	O
where	O
ji	O
=	O
∂f	O
/∂pi	O
,	O
and	O
pi	O
is	O
the	O
i-th	O
parameter	O
.	O
the	O
update	O
equation	O
is	O
then	O
(	O
1	O
+	O
λ	O
)	O
jt	O
	O
where	O
δi	O
is	O
i	O
the	O
increment	O
in	O
the	O
i-th	O
parameter	O
.	O
apart	O
from	O
the	O
factor	O
(	O
1	O
+	O
λ	O
)	O
,	O
this	O
is	O
the	O
normal	O
equation	O
that	O
would	O
result	O
from	O
minimizing	O
the	O
cost	O
by	O
varying	O
only	O
the	O
i-th	O
parameter	O
δi	O
.	O
thus	O
,	O
in	O
the	O
limit	O
as	O
λ	O
becomes	O
large	O
,	O
the	O
increment	O
to	O
the	O
parameters	B
is	O
the	O
direction	O
that	O
would	O
result	O
from	O
minimizing	O
each	O
one	O
separately	O
.	O
jiδi	O
=	O
jt	O
i	O
with	O
this	O
sort	O
of	O
augmentation	O
,	O
the	O
parameter	O
increments	O
for	O
large	O
λ	O
are	O
not	O
the	O
same	O
as	O
for	O
gradient	O
descent	O
.	O
nevertheless	O
,	O
the	O
same	O
analysis	O
as	O
before	O
shows	O
that	O
the	O
resulting	O
increment	O
is	O
still	O
in	O
the	O
down-hill	O
direction	O
for	O
any	O
value	O
of	O
λ.	O
one	O
small	O
problem	O
may	O
arise	O
:	O
if	O
some	O
parameter	O
pi	O
has	O
no	O
effect	O
on	O
the	O
value	O
of	O
the	O
function	O
f	O
,	O
then	O
ji	O
=	O
∂f	O
/∂pi	O
is	O
zero	O
,	O
and	O
the	O
i-th	O
diagonal	O
entry	O
of	O
n	O
and	O
hence	O
n	O
(	O
cid:2	O
)	O
602	O
is	O
zero	O
.	O
the	O
augmented	O
normal	O
equation	O
matrix	B
n	O
(	O
cid:2	O
)	O
trouble	O
.	O
in	O
practice	O
,	O
this	O
is	O
a	O
rare	O
occurrence	O
,	O
but	O
it	O
can	O
occur	O
.	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
is	O
then	O
singular	O
,	O
which	O
can	O
cause	O
implementation	B
of	O
lm	O
.	O
to	O
carry	O
out	O
levenberg–marquardt	O
minimization	B
in	O
its	O
sim-	O
plest	O
form	O
it	O
is	O
necessary	O
only	O
to	O
provide	O
a	O
routine	O
to	O
compute	O
the	O
function	O
being	O
min-	O
imized	O
,	O
a	O
goal	O
vector	O
(	O
cid:23	O
)	O
x	O
of	O
observed	O
or	O
desired	O
values	O
of	O
the	O
function	O
,	O
and	O
an	O
initial	O
estimate	O
p0	O
.	O
computation	B
of	I
the	O
jacobian	O
matrix	B
j	O
may	O
be	O
carried	O
out	O
either	O
numeri-	O
cally	O
,	O
or	O
by	O
providing	O
a	O
custom	O
routine	O
.	O
numerical	O
differentiation	O
may	O
be	O
carried	O
out	O
as	O
follows	O
.	O
each	O
independent	O
variable	O
xi	O
is	O
incremented	O
in	O
turn	O
to	O
xi	O
+	O
δ	O
,	O
the	O
resulting	O
function	O
value	O
is	O
computed	O
using	O
the	O
routine	O
provided	O
for	O
computing	O
f	O
and	O
the	O
derivative	O
is	O
computed	O
as	O
a	O
ratio	O
.	O
good	O
re-	O
sults	O
have	O
been	O
found	O
by	O
setting	O
the	O
value	O
δ	O
to	O
the	O
maximum	O
of	O
|10	O
−6	O
.	O
this	O
choice	B
seemingly	O
gives	O
a	O
good	O
approximation	O
to	O
the	O
derivative	O
.	O
in	O
practice	O
,	O
there	O
seems	O
to	O
be	O
little	O
disadvantage	O
in	O
using	O
numerical	O
differentiation	O
,	O
though	O
for	O
simple	O
functions	O
f	O
one	O
may	O
prefer	O
to	O
provide	O
a	O
routine	O
to	O
compute	O
j	O
,	O
partly	O
for	O
aesthetic	O
rea-	O
sons	O
,	O
partly	O
because	O
of	O
a	O
possible	O
slightly	O
improved	O
convergence	O
and	O
partly	O
for	O
speed	O
.	O
−4	O
×	O
xi|	O
and	O
10	O
a6.3	O
a	O
sparse	B
levenberg–marquardt	O
algorithm	B
the	O
lm	O
algorithm	B
as	O
described	O
above	O
in	O
section	O
a6.2	O
is	O
quite	O
suitable	O
for	O
minimization	O
with	O
respect	O
to	O
a	O
small	O
number	O
of	O
parameters	O
.	O
thus	O
,	O
in	O
the	O
case	O
of	O
2d	O
homography	B
estimation	I
(	O
see	O
chapter	O
4	O
)	O
,	O
for	O
the	O
simple	O
cost	O
functions	O
(	O
4.6–p94	O
)	O
and	O
(	O
4.7–p95	O
)	O
which	O
are	O
minimized	O
with	O
respect	O
only	O
to	O
the	O
entries	O
of	O
the	O
homography	O
matrix	B
h	O
the	O
lm	O
algorithm	B
works	O
well	O
.	O
however	O
,	O
for	O
minimizing	O
cost	B
functions	I
with	O
respect	O
to	O
large	O
numbers	O
of	O
parameters	O
,	O
the	O
bare	O
lm	O
algorithm	B
is	O
not	O
very	O
suitable	O
.	O
this	O
is	O
because	O
the	O
central	O
step	O
of	O
the	O
lm	O
algorithm	B
,	O
the	O
solution	B
of	O
the	O
normal	B
equations	I
(	O
a5.2	O
)	O
,	O
has	O
complexity	O
n	O
3	O
in	O
the	O
number	O
of	O
parameters	O
,	O
and	O
this	O
step	O
is	O
repeated	O
many	O
times	O
.	O
however	O
,	O
in	O
solving	O
many	O
estimation	B
problems	O
of	O
the	O
type	O
considered	O
in	O
this	O
book	O
,	O
the	O
normal	O
equation	O
matrix	B
has	O
a	O
certain	O
sparse	B
block	O
structure	B
that	O
one	O
may	O
take	O
advantage	O
of	O
to	O
realize	O
very	O
great	O
time	O
savings	O
.	O
an	O
example	O
of	O
the	O
situation	O
in	O
which	O
this	O
method	O
is	O
useful	O
is	O
the	O
problem	O
of	O
es-	O
timating	O
a	O
2d	O
homography	B
between	O
two	B
views	I
assuming	O
errors	O
in	O
both	O
images	O
,	O
by	O
minimizing	B
the	I
cost	I
function	I
(	O
4.8–p95	O
)	O
.	O
this	O
problem	O
may	O
be	O
parametrized	O
in	O
terms	O
of	O
a	O
set	O
of	O
parameters	O
characterizing	O
the	O
2d	O
homography	B
(	O
perhaps	O
the	O
9	O
entries	O
of	O
the	O
homography	O
matrix	B
)	O
,	O
plus	O
parameters	B
for	O
each	O
of	O
the	O
n	O
points	O
in	O
the	O
ﬁrst	O
view	O
,	O
a	O
total	O
of	O
2n	O
+	O
9	O
parameters	B
.	O
another	O
instance	O
where	O
these	O
methods	O
are	O
useful	O
is	O
the	O
reconstruction	B
problem	O
in	O
which	O
one	O
has	O
image	O
correspondences	O
across	O
two	O
or	O
more	O
(	O
let	O
us	O
say	O
m	O
)	O
views	O
and	O
one	O
wishes	O
to	O
estimate	O
the	O
camera	B
parameters	I
of	O
all	O
the	O
cameras	B
and	O
also	O
the	O
3d	O
positions	O
of	O
all	O
the	O
points	O
.	O
one	O
can	O
assume	O
arbitrary	O
projective	B
cameras	O
or	O
fully	O
or	O
partially	O
calibrated	B
cameras	O
.	O
furthermore	O
,	O
to	O
remove	O
some	O
of	O
the	O
incidental	O
degrees	B
of	I
freedom	I
one	O
can	O
ﬁx	O
one	O
of	O
the	O
cameras	O
.	O
for	O
instance	O
in	O
the	O
projective	B
reconstruction	I
problem	O
,	O
the	O
problem	O
may	O
be	O
parametrized	O
by	O
the	O
entries	O
of	O
all	O
the	O
camera	B
matrices	I
(	O
a	O
total	O
of	O
12m	O
or	O
11m	O
parameters	B
depending	O
on	O
how	O
the	O
cameras	B
are	O
parametrized	O
)	O
,	O
plus	O
a	O
set	O
of	O
3n	O
parameters	B
for	O
the	O
coordinates	B
of	O
the	O
3d	O
points	O
.	O
a6.3	O
a	O
sparse	B
levenberg–marquardt	O
algorithm	B
603	O
the	O
sparse	B
lm	O
algorithm	B
is	O
often	O
perceived	O
as	O
complex	O
and	O
difﬁcult	O
to	O
implement	O
.	O
to	O
help	O
overcome	O
this	O
,	O
the	O
algorithms	O
are	O
given	O
cook-book	O
style	O
.	O
given	O
a	O
suitable	O
library	O
of	O
standard	O
matrix	B
manipulation	O
routines	O
,	O
a	O
reader	O
should	O
be	O
able	O
to	O
implement	O
the	O
algorithm	B
without	O
difﬁculty	O
.	O
•	O
notation	O
:	O
one	O
after	O
the	O
other	O
in	O
a	O
single	O
column	O
vector	O
is	O
denoted	O
by	O
(	O
at	O
similar	O
notation	O
is	O
used	O
for	O
matrices	O
.	O
if	O
a1	O
,	O
a2	O
,	O
.	O
.	O
.	O
,	O
a	O
n	O
are	O
vectors	O
,	O
then	O
the	O
vector	O
obtained	O
by	O
placing	O
them	O
n	O
)	O
t.	O
a	O
2	O
,	O
.	O
.	O
.	O
,	O
a	O
t	O
1	O
,	O
at	O
a6.3.1	O
partitioning	O
the	O
parameters	B
in	O
the	O
lm	O
method	O
the	O
sparse	B
lm	O
method	O
will	O
be	O
described	O
primarily	O
in	O
terms	O
of	O
the	O
reconstruction	O
prob-	O
lem	O
,	O
since	O
this	O
is	O
the	O
archetypal	O
problem	O
to	O
which	O
this	O
method	O
relates	O
.	O
the	O
estimation	B
problem	I
will	O
be	O
treated	O
in	O
general	O
terms	O
ﬁrst	O
of	O
all	O
,	O
since	O
this	O
will	O
illuminate	O
the	O
gen-	O
eral	O
approach	O
without	O
excessive	O
detail	O
.	O
at	O
this	O
level	O
of	O
abstraction	O
,	O
the	O
beneﬁts	O
of	O
this	O
approach	O
may	O
not	O
be	O
apparent	B
,	O
but	O
they	O
will	O
become	O
clearer	O
in	O
section	O
a6.3.3	O
.	O
we	O
start	O
with	O
the	O
simple	O
observation	O
that	O
the	O
set	O
of	O
parameters	O
in	O
this	O
problem	O
may	O
be	O
divided	O
up	O
into	O
two	O
sets	O
:	O
a	O
set	O
of	O
parameters	O
describing	O
the	O
cameras	B
,	O
and	O
a	O
set	O
of	O
parameters	O
de-	O
scribing	O
the	O
points	O
.	O
more	O
formally	O
,	O
the	O
“	O
parameter	O
vector	O
”	O
p	O
∈	O
irm	O
may	O
be	O
partitioned	O
into	O
parameter	O
vectors	O
a	O
and	O
b	O
so	O
that	O
p	O
=	O
(	O
at	O
,	O
bt	O
)	O
t.	O
we	O
are	O
given	O
a	O
“	O
measurement	O
vector	O
”	O
,	O
denoted	O
by	O
x	O
in	O
a	O
space	O
irn	O
.	O
in	O
the	O
reconstruction	B
problem	O
,	O
this	O
consists	O
of	O
the	O
vector	O
of	O
all	O
image	O
point	O
coordinates	B
.	O
in	O
addition	O
let	O
σx	O
be	O
the	O
covariance	B
matrix	O
the	O
parameter	O
vector	O
p	O
to	O
the	O
estimated	O
measurement	O
vector	O
(	O
cid:23	O
)	O
x	O
=	O
f	O
(	O
p	O
)	O
.	O
denoting	O
by	O
	O
for	O
the	O
measurement	O
vector.1	O
we	O
consider	O
a	O
general	O
function	O
f	O
:	O
irm	O
→	O
irn	O
taking	O
the	O
difference	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
between	O
the	O
measured	O
and	O
estimated	O
quantities	O
,	O
one	O
seeks	O
the	O
set	O
of	O
parameters	O
that	O
minimize	O
the	O
squared	O
mahalanobis	O
distance	B
(	O
cid:10	O
)	O
	O
(	O
cid:10	O
)	O
2	O
j	O
=	O
[	O
∂	O
(	O
cid:23	O
)	O
x/∂p	O
]	O
has	O
a	O
block	O
structure	B
of	O
the	O
form	O
j	O
=	O
[	O
a|b	O
]	O
,	O
where	O
jacobian	O
submatrices	O
corresponding	O
to	O
the	O
division	O
of	O
parameters	O
p	O
=	O
(	O
at	O
,	O
bt	O
)	O
t	O
,	O
the	O
jacobian	O
matrix	B
σx	O
=	O
tς−1	O
x	O
	O
.	O
are	O
deﬁned	O
by	O
and	O
a	O
=	O
b	O
=	O
the	O
set	O
of	O
equations	O
jδ	O
=	O
	O
solved	O
as	O
the	O
central	O
step	O
in	O
the	O
lm	O
algorithm	B
(	O
see	O
section	O
a6.2	O
)	O
now	O
has	O
the	O
form	O
.	O
''	O
#	O
∂	O
(	O
cid:23	O
)	O
x/∂a	O
#	O
''	O
∂	O
(	O
cid:23	O
)	O
x/∂b	O
	O
=	O
	O
.	O
	O
δa	O
	O
atς−1	O
	O
=	O
	O
δa	O
	O
δb	O
	O
.	O
x	O
	O
btς−1	O
x	O
	O
jδ	O
=	O
[	O
a|b	O
]	O
δb	O
x	O
jδ	O
=	O
jtς−1	O
then	O
,	O
the	O
normal	B
equations	I
jtς−1	O
algorithm	B
are	O
of	O
the	O
form	O
atς−1	O
x	O
a	O
atς−1	O
x	O
b	O
x	O
a	O
btς−1	O
x	O
b	O
btς−1	O
1	O
in	O
the	O
absence	O
of	O
other	O
knowledge	O
,	O
one	O
usually	O
assumes	O
that	O
σx	O
is	O
the	O
identity	O
matrix	B
.	O
x	O
	O
to	O
be	O
solved	O
at	O
each	O
step	O
of	O
the	O
lm	O
(	O
a6.4	O
)	O
(	O
a6.5	O
)	O
604	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
at	O
this	O
point	B
in	O
the	O
lm	O
algorithm	B
the	O
diagonal	O
blocks	O
of	O
this	O
matrix	B
are	O
augmented	O
by	O
multiplying	O
their	O
diagonal	O
entries	O
by	O
a	O
factor	O
1	O
+	O
λ	O
,	O
for	O
the	O
varying	O
parameter	O
λ.	O
this	O
augmentation	B
alters	O
the	O
matrices	O
atς−1	O
x	O
a	O
and	O
btς−1	O
x	O
b.	O
the	O
resulting	O
matrices	O
∗	O
will	O
be	O
denoted	O
by	O
(	O
atς−1	O
x	O
b	O
)	O
.	O
the	O
reader	O
may	O
wish	O
to	O
look	O
ahead	O
to	O
ﬁgure	O
a6.1	O
and	O
ﬁgure	O
a6.2	O
which	O
shows	O
graphically	O
the	O
form	B
of	I
the	O
jacobian	O
and	O
normal	B
equations	I
in	O
an	O
estimation	B
problem	I
involving	O
several	O
cameras	B
and	O
points	O
.	O
x	O
a	O
)	O
∗	O
the	O
set	O
of	O
equations	O
(	O
a6.5	O
)	O
may	O
now	O
be	O
written	O
in	O
block	O
form	O
as	O
and	O
(	O
btς−1	O
(	O
cid:18	O
)	O
(	O
cid:20	O
)	O
u∗	O
w	O
wt	O
v∗	O
δa	O
δb	O
(	O
cid:17	O
)	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
a	O
b	O
=	O
.	O
(	O
a6.6	O
)	O
as	O
a	O
ﬁrst	O
step	O
to	O
solving	O
these	O
equations	O
,	O
both	O
sides	O
are	O
now	O
multiplied	O
on	O
the	O
left	O
by	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
i	O
−wv∗−1	O
0	O
i	O
(	O
cid:17	O
)	O
resulting	O
in	O
u∗	O
−	O
wv∗−1wt	O
wt	O
(	O
cid:18	O
)	O
(	O
cid:20	O
)	O
(	O
cid:21	O
)	O
(	O
cid:20	O
)	O
=	O
δa	O
δb	O
0	O
v∗	O
a	O
−	O
wv∗−1b	O
b	O
(	O
cid:21	O
)	O
.	O
(	O
a6.7	O
)	O
this	O
results	O
in	O
the	O
elimination	O
of	O
the	O
top	O
right	O
hand	O
block	O
.	O
the	O
top	O
half	O
of	O
this	O
set	O
of	O
equations	O
is	O
(	O
u∗	O
−	O
wv∗−1wt	O
)	O
δa	O
=	O
a	O
−	O
wv∗−1b	O
.	O
these	O
equations	O
may	O
be	O
solved	O
to	O
ﬁnd	O
δa	O
.	O
subsequently	O
,	O
the	O
value	O
of	O
δb	O
may	O
be	O
found	O
by	O
back-substitution	O
,	O
giving	O
(	O
a6.8	O
)	O
(	O
a6.9	O
)	O
v∗	O
δb	O
=	O
b	O
−	O
wtδa	O
.	O
as	O
in	O
section	O
a6.2	O
,	O
if	O
the	O
newly	O
computed	O
value	O
of	O
the	O
parameter	O
vector	O
p	O
=	O
(	O
(	O
a	O
+	O
δa	O
)	O
t	O
,	O
(	O
b	O
+	O
δb	O
)	O
t	O
)	O
t	O
results	O
in	O
a	O
diminished	O
value	O
of	O
the	O
error	O
function	O
,	O
then	O
one	O
accepts	O
the	O
new	O
parameter	O
vector	O
p	O
,	O
diminishes	O
the	O
value	O
of	O
λ	O
by	O
a	O
factor	O
of	O
10	O
,	O
and	O
proceeds	O
to	O
the	O
next	O
iteration	B
.	O
on	O
the	O
other	O
hand	O
if	O
the	O
error	B
value	O
is	O
increased	O
,	O
then	O
one	O
rejects	O
the	O
new	O
p	O
and	O
tries	O
again	O
with	O
a	O
new	O
value	O
of	O
λ	O
,	O
increased	O
by	O
a	O
factor	O
of	O
10.	O
the	O
complete	O
partitioned	O
levenberg–marquardt	O
algorithm	B
is	O
given	O
in	O
algorithm	O
a6.1	O
.	O
although	O
in	O
this	O
method	O
we	O
solve	O
ﬁrst	O
for	O
δa	O
and	O
subsequently	O
for	O
δb	O
based	O
on	O
the	O
new	O
value	O
of	O
a	O
,	O
it	O
should	O
not	O
be	O
thought	O
that	O
the	O
method	O
amounts	O
to	O
no	O
more	O
than	O
independent	O
iterations	O
over	O
a	O
and	O
b.	O
if	O
one	O
were	O
to	O
solve	O
for	O
a	O
holding	O
b	O
constant	O
,	O
then	O
the	O
normal	B
equations	I
used	O
to	O
solve	O
for	O
δa	O
would	O
take	O
the	O
simpler	O
form	O
uδa	O
=	O
a	O
,	O
compared	O
with	O
(	O
a6.8	O
)	O
.	O
the	O
method	O
of	O
alternating	O
between	O
solving	O
for	O
δa	O
and	O
δb	O
is	O
not	O
recommended	O
,	O
however	O
,	O
because	O
of	O
potential	O
slow	O
convergence	O
.	O
a6.3.2	O
covariance	B
it	O
was	O
seen	O
in	O
result	O
5.12	O
(	O
p144	O
)	O
that	O
the	O
covariance	B
matrix	O
of	O
the	O
estimated	O
parameters	B
is	O
given	O
by	O
σp	O
=	O
(	O
jtς−1	O
x	O
j	O
)	O
+	O
.	O
(	O
a6.10	O
)	O
a6.3	O
a	O
sparse	B
levenberg–marquardt	O
algorithm	B
605	O
of	O
parameters	O
p	O
=	O
(	O
at	O
,	O
bt	O
)	O
t	O
and	O
a	O
function	O
f	O
:	O
p	O
(	O
cid:6	O
)	O
→	O
(	O
cid:23	O
)	O
x	O
taking	O
the	O
parameter	O
vector	O
to	O
an	O
given	O
a	O
vector	O
of	O
measurements	O
x	O
with	O
covariance	O
matrix	B
σx	O
,	O
an	O
initial	O
estimate	O
of	O
a	O
set	O
estimate	O
of	O
the	O
measurement	O
vector	O
.	O
objective	O
find	O
the	O
set	O
of	O
parameters	O
p	O
that	O
minimizes	O
tς−1	O
algorithm	B
(	O
ii	O
)	O
compute	O
the	O
derivative	O
matrices	O
a	O
=	O
[	O
∂	O
(	O
cid:23	O
)	O
x/∂a	O
]	O
and	O
b	O
=	O
[	O
∂	O
(	O
cid:23	O
)	O
x/∂b	O
]	O
and	O
the	O
error	B
vector	O
(	O
i	O
)	O
initialize	O
a	O
constant	O
λ	O
=	O
0.001	O
(	O
typical	O
value	O
)	O
.	O
x	O
	O
where	O
	O
=	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
.	O
	O
.	O
(	O
iii	O
)	O
compute	O
intermediate	O
expressions	O
u	O
=	O
atς−1	O
x	O
a	O
a	O
=	O
atς−1	O
x	O
	O
v	O
=	O
btς−1	O
x	O
b	O
b	O
=	O
btς−1	O
x	O
	O
w	O
=	O
atς−1	O
x	O
b	O
of	O
v∗	O
(	O
iv	O
)	O
augment	O
u	O
and	O
v	O
by	O
multiplying	O
their	O
diagonal	O
elements	O
by	O
1	O
+	O
λ	O
.	O
(	O
v	O
)	O
compute	O
the	O
inverse	O
v∗−1	O
,	O
and	O
deﬁne	O
y	O
=	O
wv∗−1	O
.	O
the	O
inverse	O
may	O
overwrite	O
the	O
value	O
(	O
vi	O
)	O
find	O
δa	O
by	O
solving	B
(	O
u∗	O
−	O
ywt	O
)	O
δa	O
=	O
a	O
−	O
yb	O
.	O
(	O
vii	O
)	O
find	O
δb	O
by	O
back-substitution	O
:	O
δb	O
=	O
v∗−1	O
(	O
b	O
−	O
wtδa	O
)	O
.	O
(	O
viii	O
)	O
update	O
the	O
parameter	O
vector	O
by	O
adding	O
the	O
incremental	B
vector	O
(	O
δt	O
which	O
will	O
not	O
be	O
needed	O
again	O
.	O
b	O
)	O
t	O
and	O
compute	O
a	O
,	O
δt	O
the	O
new	O
error	B
vector	O
.	O
(	O
ix	O
)	O
if	O
the	O
new	O
error	B
is	O
less	O
than	O
the	O
old	O
error	B
,	O
then	O
accept	O
the	O
new	O
values	O
of	O
the	O
parameters	O
,	O
diminish	O
the	O
value	O
of	O
λ	O
by	O
a	O
factor	O
of	O
10	O
,	O
and	O
start	O
again	O
at	O
step	O
(	O
ii	O
)	O
,	O
or	O
else	O
terminate	O
.	O
(	O
x	O
)	O
if	O
the	O
new	O
error	B
is	O
greater	O
than	O
the	O
old	O
error	B
,	O
then	O
revert	O
to	O
the	O
old	O
parameter	O
values	O
,	O
increase	O
the	O
value	O
of	O
λ	O
by	O
a	O
factor	O
of	O
10	O
,	O
and	O
try	O
again	O
from	O
step	O
(	O
iv	O
)	O
.	O
algorithm	B
a6.1	O
.	O
a	O
partitioned	O
levenberg–marquardt	O
algorithm	B
.	O
in	O
the	O
over-parametrized	B
case	I
,	O
the	O
covariance	B
matrix	O
σp	O
given	O
by	O
(	O
a6.10	O
)	O
is	O
singular	O
,	O
and	O
in	O
particular	O
,	O
no	O
variation	O
in	O
the	O
parameters	B
is	O
allowed	O
in	O
directions	O
perpendicular	O
to	O
the	O
constraint	O
surface	O
–	O
the	O
variance	B
is	O
zero	O
in	O
these	O
directions	O
.	O
in	O
the	O
case	O
where	O
the	O
parameter	O
set	O
is	O
partitioned	O
as	O
p	O
=	O
(	O
at	O
,	O
bt	O
)	O
t	O
,	O
matrix	B
(	O
jtς−1	O
x	O
j	O
)	O
has	O
the	O
block	O
form	O
given	O
in	O
(	O
a6.5	O
)	O
and	O
(	O
a6.6	O
)	O
(	O
but	O
without	O
augmentation	B
,	O
represented	O
by	O
stars	O
)	O
.	O
thus	O
we	O
may	O
write	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
jtς−1	O
x	O
j	O
=	O
atς−1	O
btς−1	O
x	O
a	O
atς−1	O
x	O
b	O
x	O
a	O
btς−1	O
x	O
b	O
=	O
u	O
w	O
wt	O
v	O
.	O
(	O
a6.11	O
)	O
the	O
covariance	B
matrix	O
σp	O
is	O
the	O
pseudo-inverse	B
of	O
this	O
matrix	B
.	O
under	O
the	O
assumption	O
that	O
v	O
is	O
invertible	O
,	O
redeﬁne	O
y	O
=	O
wv−1	O
.	O
then	O
the	O
matrix	B
may	O
be	O
diagonalized	O
according	O
to	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
jtς−1	O
x	O
j	O
=	O
w	O
u	O
wt	O
v	O
=	O
i	O
y	O
0	O
i	O
u	O
−	O
wv−1wt	O
0	O
v	O
0	O
i	O
0	O
yt	O
i	O
(	O
a6.12	O
)	O
for	O
matrices	O
g	O
and	O
h	O
with	O
g	O
invertible	O
,	O
we	O
assume	O
an	O
identity	O
(	O
ghgt	O
)	O
+	O
=	O
g−th+g−1	O
this	O
identity	O
is	O
valid	O
under	O
conditions	O
explored	O
in	O
the	O
exercise	O
at	O
the	O
end	O
of	O
this	O
ap-	O
606	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
objective	O
compute	O
the	O
covariance	B
of	O
the	O
parameters	B
a	O
and	O
b	O
estimated	O
using	O
algorithm	O
a6.1	O
.	O
algorithm	B
(	O
i	O
)	O
compute	O
matrices	O
u	O
,	O
v	O
and	O
w	O
as	O
in	O
algorithm	B
a6.1	O
,	O
and	O
also	O
y	O
=	O
wv−1	O
.	O
(	O
ii	O
)	O
σa	O
=	O
(	O
u	O
−	O
wv−1wt	O
)	O
+	O
.	O
(	O
iii	O
)	O
σb	O
=	O
ytσay	O
+	O
v−1	O
(	O
iv	O
)	O
the	O
cross-covariance	O
σab	O
=	O
−σay	O
.	O
algorithm	B
a6.2	O
.	O
computation	B
of	I
the	O
covariance	B
matrix	O
of	O
the	O
lm	O
parameters	B
.	O
pendix	O
.	O
applying	O
this	O
to	O
(	O
a6.12	O
)	O
and	O
multiplying	O
out	O
provides	O
a	O
formula	O
for	O
the	O
pseudo	O
inverse	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
−	O
xy	O
ytxy	O
+	O
v−1	O
σp	O
=	O
(	O
jtς−1	O
x	O
j	O
)	O
+	O
=	O
x	O
−ytx	O
(	O
a6.13	O
)	O
where	O
x	O
=	O
(	O
u	O
−	O
wv−1wt	O
)	O
+	O
.	O
the	O
condition	O
for	O
this	O
to	O
be	O
true	O
is	O
that	O
span	O
(	O
a	O
)	O
∩	O
span	O
(	O
b	O
)	O
=	O
∅	O
,	O
where	O
span	O
(	O
·	O
)	O
rep-	O
resents	O
the	O
span	O
of	O
the	O
columns	O
of	O
the	O
matrix	O
.	O
here	O
a	O
and	O
b	O
are	O
as	O
in	O
(	O
a6.11	O
)	O
.	O
proof	O
of	O
this	O
fact	O
and	O
interpretation	O
of	O
the	O
condition	O
span	O
(	O
a	O
)	O
∩	O
span	O
(	O
b	O
)	O
=	O
∅	O
is	O
outlined	O
in	O
exercise	O
(	O
i	O
)	O
on	O
page	O
626.	O
the	O
division	O
of	O
matrix	O
jtς−1	O
x	O
j	O
into	O
blocks	O
as	O
in	O
(	O
a6.11	O
)	O
corresponds	O
in	O
(	O
a6.5	O
)	O
to	O
the	O
division	O
of	O
p	O
into	O
parameters	B
a	O
and	O
b.	O
truncation	O
of	O
the	O
covariance	O
matrix	B
for	O
parameters	B
p	O
gives	O
covariance	B
matrices	O
for	O
parameters	O
a	O
and	O
b	O
separately	O
.	O
the	O
result	O
is	O
summarized	O
in	O
algorithm	O
a6.2	O
.	O
1	O
,	O
xt	O
2	O
,	O
.	O
.	O
.	O
,	O
xt	O
a6.3.3	O
general	O
sparse	O
lm	O
method	O
in	O
the	O
previous	O
pages	O
,	O
a	O
method	O
has	O
been	O
described	O
for	O
carrying	O
out	O
lm	O
iteration	B
and	O
computing	B
covariances	O
of	O
the	O
solution	O
in	O
the	O
case	O
where	O
the	O
parameter	O
vector	O
may	O
be	O
partitioned	O
into	O
two	O
sub-vectors	O
a	O
and	O
b.	O
it	O
is	O
not	O
clear	O
from	O
the	O
foregoing	O
discussion	O
that	O
the	O
methods	O
described	O
there	O
actually	O
give	O
any	O
computational	O
advantage	O
in	O
the	O
gen-	O
eral	O
case	O
.	O
however	O
,	O
such	O
methods	O
become	O
important	O
when	O
the	O
jacobian	O
matrix	B
obeys	O
a	O
certain	O
sparseness	O
condition	O
,	O
as	O
will	O
be	O
described	O
now	O
.	O
we	O
suppose	O
that	O
the	O
“	O
measurement	O
vector	O
”	O
x	O
∈	O
irn	O
may	O
broken	O
up	O
into	O
pieces	O
as	O
n	O
)	O
t.	O
similarly	O
,	O
suppose	O
that	O
the	O
“	O
parameter	O
vector	O
”	O
p	O
∈	O
irm	O
may	O
x	O
=	O
(	O
xt	O
to	O
a	O
given	O
assignment	O
of	O
parameters	O
will	O
be	O
denoted	O
by	O
(	O
cid:23	O
)	O
xi	O
.	O
we	O
make	O
the	O
sparseness	O
be	O
divided	O
up	O
as	O
p	O
=	O
(	O
at	O
,	O
bt	O
n	O
)	O
t.	O
the	O
estimated	O
values	O
of	O
xi	O
corresponding	O
assumption	O
that	O
each	O
(	O
cid:23	O
)	O
xi	O
is	O
dependent	O
on	O
a	O
and	O
bi	O
only	O
,	O
but	O
not	O
on	O
the	O
other	O
parameters	B
bj	O
.	O
in	O
this	O
case	O
,	O
∂	O
(	O
cid:23	O
)	O
xi/∂bj	O
=	O
0	O
for	O
i	O
(	O
cid:5	O
)	O
=	O
j.	O
no	O
assumption	O
is	O
made	O
about	O
∂	O
(	O
cid:23	O
)	O
xi/∂a	O
.	O
this	O
in	O
which	O
bi	O
is	O
the	O
vector	O
of	O
parameters	B
of	O
the	O
i-th	O
point	B
,	O
and	O
(	O
cid:23	O
)	O
xi	O
is	O
the	O
vector	O
of	O
mea-	O
a	O
point	B
does	O
not	O
depend	O
on	O
any	O
other	O
point	B
,	O
one	O
sees	O
that	O
∂	O
(	O
cid:23	O
)	O
xi/∂bj	O
=	O
0	O
,	O
as	O
required	O
,	O
corresponding	O
to	O
this	O
division	O
,	O
the	O
jacobian	O
matrix	B
j	O
=	O
[	O
∂	O
(	O
cid:23	O
)	O
x/∂p	O
]	O
has	O
a	O
sparse	B
block	O
surements	O
of	O
the	O
image	O
of	O
this	O
point	B
in	O
all	O
the	O
views	O
.	O
in	O
this	O
case	O
,	O
since	O
the	O
image	O
of	O
situation	O
arises	O
in	O
the	O
reconstruction	B
problem	O
described	O
at	O
the	O
start	O
of	O
this	O
discussion	O
,	O
1	O
,	O
bt	O
2	O
,	O
.	O
.	O
.	O
,	O
b	O
t	O
unless	O
i	O
=	O
j.	O
structure	B
.	O
we	O
deﬁne	O
jacobian	O
matrices	O
by	O
a6.4	O
application	O
of	O
sparse	B
lm	O
to	O
2d	O
homography	B
estimation	I
607	O
''	O
#	O
∂	O
(	O
cid:23	O
)	O
xi/∂a	O
ai	O
=	O
''	O
bi	O
=	O
#	O
∂	O
(	O
cid:23	O
)	O
xi/∂bi	O
n	O
)	O
t	O
=	O
x	O
−	O
(	O
cid:23	O
)	O
x	O
the	O
set	O
of	O
equations	O
.	O
given	O
an	O
error	B
vector	O
of	O
the	O
form	O
	O
=	O
(	O
t	O
1	O
,	O
.	O
.	O
.	O
,	O
	O
t	O
jδ	O
=	O
	O
now	O
has	O
the	O
form	O
	O
jδ	O
=	O
a1	O
b1	O
a2	O
...	O
an	O
b2	O
...	O
bn	O
	O
	O
δa	O
δb1	O
...	O
δbn	O
	O
=	O
	O
.	O
	O
1	O
...	O
n	O
(	O
a6.14	O
)	O
we	O
suppose	O
further	O
that	O
all	O
of	O
the	O
measurements	O
xi	O
are	O
independent	O
with	O
covariance	O
matrices	O
σxi	O
.	O
thus	O
the	O
covariance	B
matrix	O
for	O
the	O
complete	O
measurement	O
vector	O
σx	O
has	O
the	O
block-diagonal	O
form	O
σx	O
=	O
diag	O
(	O
σx1	O
,	O
.	O
.	O
.	O
,	O
σ	O
xn	O
)	O
.	O
in	O
the	O
notation	O
of	O
algorithm	O
a6.1	O
,	O
we	O
have	O
1	O
,	O
at	O
n	O
]	O
t	O
2	O
,	O
.	O
.	O
.	O
,	O
a	O
t	O
a	O
=	O
[	O
at	O
b	O
=	O
diag	O
(	O
b1	O
,	O
b2	O
,	O
.	O
.	O
.	O
,	O
b	O
n	O
)	O
σx	O
=	O
diag	O
(	O
σx1	O
,	O
.	O
.	O
.	O
,	O
σ	O
xn	O
)	O
δb	O
=	O
(	O
δt	O
bn	O
)	O
t	O
	O
=	O
(	O
t	O
b2	O
,	O
.	O
.	O
.	O
,	O
δ	O
t	O
n	O
)	O
t	O
2	O
,	O
.	O
.	O
.	O
,	O
	O
t	O
b1	O
,	O
δt	O
1	O
,	O
t	O
now	O
,	O
it	O
is	O
a	O
straightforward	O
task	O
to	O
substitute	O
these	O
formulae	O
into	O
algorithm	B
a6.1	O
.	O
the	O
result	O
of	O
this	O
substitution	O
is	O
given	O
in	O
algorithm	O
a6.3	O
,	O
representing	O
the	O
computation	B
of	I
one	O
step	O
of	O
the	O
lm	O
algorithm	B
.	O
the	O
important	O
observation	O
is	O
that	O
in	O
this	O
form	O
each	O
step	O
of	O
the	O
algorithm	O
requires	O
computation	B
time	O
linear	B
in	O
n.	O
without	O
the	O
advantage	O
resulting	O
from	O
the	O
sparse	B
structure	O
,	O
the	O
algorithm	B
(	O
for	O
instance	O
a	O
blind	O
adherence	O
to	O
algorithm	O
a6.1	O
)	O
would	O
have	O
complexity	O
of	O
order	O
n3	O
.	O
a6.4	O
application	O
of	O
sparse	B
lm	O
to	O
2d	O
homography	B
estimation	I
i	O
,	O
x	O
(	O
cid:2	O
)	O
i	O
we	O
apply	O
the	O
foregoing	O
discussion	O
to	O
the	O
estimation	B
of	I
a	O
2d	O
homography	B
h	O
given	O
a	O
set	O
of	O
corresponding	O
image	O
points	O
xi	O
↔	O
x	O
(	O
cid:2	O
)	O
i	O
in	O
two	O
images	O
.	O
the	O
points	O
in	O
each	O
image	O
are	O
subject	O
to	O
noise	O
,	O
and	O
one	O
seeks	O
to	O
minimize	O
the	O
cost	B
function	I
(	O
4.8–p95	O
)	O
.	O
we	O
deﬁne	O
a	O
measurement	O
vector	O
xi	O
=	O
(	O
xt	O
t	O
)	O
t.	O
in	O
this	O
case	O
,	O
the	O
parameter	O
vector	O
p	O
may	O
be	O
divided	O
up	O
as	O
p	O
=	O
(	O
ht	O
,	O
ˆxt	O
n	O
)	O
t	O
,	O
where	O
the	O
values	O
ˆxi	O
are	O
the	O
estimated	O
values	O
of	O
the	O
image	O
points	O
in	O
the	O
ﬁrst	O
image	O
,	O
and	O
h	O
is	O
a	O
vector	O
of	O
entries	O
of	O
the	O
homography	O
h.	O
thus	O
,	O
one	O
must	O
simultaneously	O
estimate	O
the	O
homography	B
h	O
and	O
the	O
parameters	B
of	O
n	O
)	O
t	O
,	O
where	O
each	O
each	O
point	B
in	O
the	O
ﬁrst	O
image	O
.	O
the	O
function	O
f	O
maps	O
p	O
to	O
(	O
(	O
cid:23	O
)	O
xt	O
1	O
,	O
(	O
cid:23	O
)	O
xt	O
2	O
,	O
.	O
.	O
.	O
,	O
(	O
cid:23	O
)	O
xt	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
ˆxt	O
(	O
cid:18	O
)	O
the	O
jacobian	O
matrices	O
have	O
a	O
special	O
form	O
in	O
this	O
case	O
,	O
since	O
one	O
observes	O
that	O
t	O
)	O
t.	O
then	O
algorithm	B
a6.3	O
applies	O
directly	O
.	O
i	O
)	O
t	O
=	O
(	O
ˆxt	O
2	O
,	O
.	O
.	O
.	O
,	O
ˆxt	O
i	O
,	O
hˆxt	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
1	O
,	O
ˆxt	O
(	O
cid:17	O
)	O
i	O
ai	O
=	O
∂	O
(	O
cid:23	O
)	O
xi/∂h	O
=	O
0	O
∂	O
ˆx	O
(	O
cid:2	O
)	O
i/∂h	O
608	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
1	O
,	O
.	O
.	O
.	O
,	O
bt	O
n	O
)	O
t	O
,	O
and	O
the	O
measurement	O
vector	O
as	O
x	O
=	O
(	O
xt	O
objective	O
formulate	O
lm	O
algorithm	B
in	O
the	O
case	O
where	O
the	O
parameter	O
vector	O
is	O
partitioned	O
as	O
p	O
=	O
(	O
at	O
,	O
bt	O
n	O
)	O
t	O
,	O
such	O
that	O
∂	O
(	O
cid:23	O
)	O
xi/∂bj	O
=	O
0	O
for	O
i	O
(	O
cid:5	O
)	O
=	O
j	O
.	O
(	O
i	O
)	O
compute	O
the	O
derivative	O
matrices	O
ai	O
=	O
[	O
∂	O
(	O
cid:23	O
)	O
xi/∂a	O
]	O
and	O
bi	O
=	O
[	O
∂	O
(	O
cid:23	O
)	O
xi/∂bi	O
]	O
and	O
the	O
error	B
vectors	O
i	O
=	O
xi	O
−	O
(	O
cid:23	O
)	O
xi	O
.	O
algorithm	B
steps	O
(	O
ii	O
)	O
to	O
(	O
vii	O
)	O
of	O
algorithm	O
a6.1	O
become	O
:	O
1	O
,	O
.	O
.	O
.	O
,	O
xt	O
(	O
ii	O
)	O
compute	O
the	O
intermediate	O
values	O
(	O
cid:7	O
)	O
i	O
u	O
=	O
i	O
σ−1	O
at	O
xi	O
ai	O
v	O
=	O
diag	O
(	O
v1	O
,	O
.	O
.	O
.	O
,	O
vn	O
)	O
where	O
vi	O
=	O
bt	O
w	O
=	O
[	O
w1	O
,	O
w2	O
,	O
.	O
.	O
.	O
,	O
wn	O
]	O
where	O
wi	O
=	O
at	O
a	O
=	O
(	O
cid:7	O
)	O
i	O
σ−1	O
at	O
i	O
xi	O
i	O
σ−1	O
bi	O
xi	O
i	O
σ−1	O
bi	O
xi	O
i	O
b	O
=	O
(	O
t	O
b2	O
,	O
.	O
.	O
.	O
,	O
t	O
b1	O
,	O
t	O
yi	O
=	O
wiv∗−1	O
.	O
bn	O
)	O
t	O
where	O
bi	O
=	O
bt	O
i	O
σ−1	O
xi	O
i	O
i	O
(	O
iii	O
)	O
compute	O
δa	O
from	O
the	O
equation	O
(	O
u∗	O
−	O
(	O
cid:7	O
)	O
i	O
i	O
)	O
δa	O
=	O
a	O
−	O
yiwt	O
(	O
cid:7	O
)	O
i	O
yibi	O
.	O
(	O
iv	O
)	O
compute	O
each	O
δbi	O
in	O
turn	O
from	O
the	O
equation	O
δbi	O
=	O
v∗−1	O
i	O
(	O
bi	O
−	O
wt	O
i	O
δa	O
)	O
.	O
covariance	B
(	O
ii	O
)	O
σa	O
=	O
(	O
u	O
−	O
(	O
cid:27	O
)	O
(	O
i	O
)	O
redeﬁne	O
yi	O
=	O
wiv−1	O
i	O
i	O
yiwt	O
i	O
)	O
+	O
(	O
iii	O
)	O
σbibj	O
=	O
yt	O
(	O
iv	O
)	O
σabi	O
=	O
−σayi	O
i	O
σayj	O
+	O
δijv−1	O
i	O
algorithm	B
a6.3	O
.	O
a	O
sparse	B
levenberg–marquardt	O
algorithm	B
.	O
since	O
ˆxi	O
is	O
independent	O
of	O
h.	O
also	O
,	O
bi	O
=	O
∂	O
(	O
cid:23	O
)	O
xi/∂	O
ˆxi	O
=	O
because	O
of	O
the	O
form	O
of	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
ˆxt	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
t	O
)	O
t.	O
i	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
∂	O
ˆx	O
(	O
cid:2	O
)	O
i	O
i/∂	O
ˆxi	O
a6.4.1	O
computation	B
of	I
the	O
covariance	B
as	O
an	O
example	O
of	O
covariance	O
computation	B
,	O
we	O
consider	O
the	O
same	O
problem	O
as	O
in	O
section	O
5.2.4	O
(	O
p145	O
)	O
,	O
in	O
which	O
a	O
homography	B
is	O
estimated	O
from	O
point	O
correspondences	O
.	O
as	O
in	O
that	O
example	O
,	O
we	O
consider	O
a	O
case	O
in	O
which	O
the	O
estimated	O
homography	B
is	O
actually	O
the	O
identity	O
mapping	O
,	O
h	O
=	O
i.	O
for	O
the	O
purposes	O
of	O
this	O
example	O
,	O
the	O
number	O
of	O
points	O
or	O
their	O
distribution	B
is	O
not	O
important	O
.	O
it	O
will	O
be	O
assumed	O
,	O
however	O
,	O
that	O
the	O
errors	O
of	O
all	O
a6.5	O
application	O
of	O
sparse	B
lm	O
to	O
fundamental	O
matrix	B
estimation	O
609	O
(	O
cid:15	O
)	O
(	O
cid:27	O
)	O
(	O
cid:16	O
)	O
point	B
measurements	O
are	O
independent	O
.	O
we	O
recall	O
from	O
(	O
5.12–p146	O
)	O
that	O
in	O
the	O
case	O
of	O
errors	O
in	O
the	O
second	O
image	O
only	O
,	O
σh	O
=	O
,	O
where	O
ji	O
=	O
[	O
∂	O
ˆx	O
(	O
cid:2	O
)	O
xi	O
=	O
σ−1	O
x	O
(	O
cid:1	O
)	O
we	O
now	O
proceed	O
to	O
compute	O
the	O
covariance	B
of	O
the	O
camera	B
parameter	O
vector	O
h	O
in	O
the	O
case	O
where	O
the	O
points	O
in	O
the	O
ﬁrst	O
image	O
are	O
subject	O
to	O
noise	O
as	O
well	O
.	O
we	O
assume	O
further	O
that	O
σ−1	O
,	O
and	O
denote	O
them	O
by	O
si	O
.	O
in	O
this	O
case	O
,	O
the	O
inverse	O
covariance	B
matrix	O
σ−1	O
x	O
xi	O
,	O
σ−1	O
is	O
block-diagonal	O
,	O
σ−1	O
)	O
.	O
then	O
,	O
applying	O
the	O
steps	O
of	O
algorithm	O
a6.3	O
x	O
(	O
cid:1	O
)	O
to	O
compute	O
the	O
covariance	B
matrix	O
for	O
h	O
,	O
x	O
=	O
diag	O
(	O
σ−1	O
i/∂h	O
]	O
.	O
σ−1	O
jt	O
i	O
ji	O
+	O
i	O
i	O
i	O
i	O
i	O
]	O
t	O
(	O
cid:7	O
)	O
ai	O
=	O
[	O
0t	O
,	O
jt	O
bi	O
=	O
[	O
it	O
,	O
it	O
]	O
t	O
since	O
h	O
=	O
i	O
at	O
i	O
diag	O
(	O
si	O
,	O
si	O
)	O
ai	O
=	O
u	O
=	O
(	O
cid:7	O
)	O
jt	O
i	O
siji	O
u	O
−	O
(	O
cid:7	O
)	O
i	O
wiv−1	O
i	O
vi	O
=	O
bt	O
wi	O
=	O
at	O
wt	O
i	O
=	O
i	O
(	O
cid:7	O
)	O
i	O
(	O
cid:7	O
)	O
i	O
diag	O
(	O
si	O
,	O
si	O
)	O
bi	O
=	O
2si	O
i	O
diag	O
(	O
si	O
,	O
si	O
)	O
bi	O
=	O
jt	O
si	O
i	O
(	O
si	O
−	O
si/2	O
)	O
ji	O
=	O
(	O
cid:20	O
)	O
(	O
cid:7	O
)	O
jt	O
(	O
cid:21	O
)	O
+	O
i	O
i	O
i	O
σh	O
=	O
2	O
jt	O
i	O
siji	O
.	O
jt	O
i	O
siji/2	O
i	O
hence	O
,	O
the	O
covariance	B
matrix	O
for	O
h	O
is	O
just	O
twice	O
the	O
value	O
of	O
the	O
covariance	O
matrix	B
for	O
the	O
case	O
of	O
error	O
in	B
one	I
image	I
.	O
this	O
is	O
not	O
generally	O
true	O
,	O
and	O
results	O
from	O
the	O
fact	O
that	O
h	O
is	O
the	O
identity	O
mapping	O
.	O
as	O
exercises	O
,	O
one	O
may	O
verify	O
the	O
following	O
.	O
•	O
if	O
h	O
represents	O
a	O
scaling	B
by	O
a	O
factor	O
s	O
,	O
then	O
σh	O
=	O
(	O
s2	O
+	O
1	O
)	O
•	O
if	O
h	O
is	O
an	O
afﬁne	B
transformation	I
and	O
d	O
is	O
the	O
upper	O
2	O
×	O
2	O
part	O
of	O
h	O
(	O
the	O
non-	O
translational	O
part	O
)	O
,	O
and	O
if	O
si	O
=	O
i	O
for	O
all	O
i	O
(	O
isotropic	B
and	O
independent	O
noise	B
)	O
,	O
then	O
σh	O
=	O
i	O
−	O
d	O
(	O
i	O
+	O
dtd	O
)	O
(	O
cid:15	O
)	O
(	O
cid:27	O
)	O
(	O
cid:15	O
)	O
(	O
cid:27	O
)	O
−1dt	O
siji	O
(	O
cid:16	O
)	O
(	O
cid:15	O
)	O
(	O
cid:16	O
)	O
(	O
cid:16	O
)	O
jt	O
i	O
+	O
+	O
.	O
i	O
.	O
ji	O
jt	O
i	O
i	O
a6.5	O
application	O
of	O
sparse	B
lm	O
to	O
fundamental	O
matrix	B
estimation	O
in	O
estimating	O
the	O
fundamental	B
matrix	I
and	O
a	O
set	O
of	O
3d	O
points	O
,	O
the	O
algorithm	B
is	O
effec-	O
tively	O
that	O
described	O
in	O
section	O
a6.3.3	O
,	O
a	O
sparse	B
lm	O
algorithm	B
for	O
the	O
estimation	B
of	I
2d	O
homographies	B
,	O
but	O
slightly	O
modiﬁed	O
to	O
the	O
present	O
case	O
.	O
the	O
analogy	O
with	O
the	O
2d	O
ho-	O
mography	O
estimation	B
problem	I
is	O
as	O
follows	O
:	O
in	O
estimating	O
2d	O
homographies	B
,	O
one	O
has	O
a	O
mapping	O
h	O
that	O
takes	O
points	O
xi	O
to	O
corresponding	O
points	O
x	O
(	O
cid:2	O
)	O
i	O
;	O
in	O
the	O
present	O
problem	O
,	O
one	O
has	O
a	O
mapping	O
represented	O
by	O
a	O
pair	O
of	B
camera	I
matrices	O
p	O
and	O
p	O
(	O
cid:2	O
)	O
that	O
map	O
a	O
3d	O
point	B
to	O
a	O
pair	O
of	O
corresponding	O
points	O
(	O
xi	O
,	O
x	O
(	O
cid:2	O
)	O
i	O
)	O
.	O
for	O
convenience	O
,	O
the	O
notation	O
of	O
section	O
a6.3.3	O
will	O
be	O
used	O
here	O
.	O
in	O
particular	O
,	O
note	O
that	O
in	O
section	O
a6.3.3	O
,	O
and	O
here	O
the	O
notation	O
x	O
is	O
used	O
to	O
denote	O
the	O
total	O
measure-	O
ment	O
vector	O
(	O
in	O
this	O
case	O
(	O
x1	O
,	O
x	O
(	O
cid:2	O
)	O
n	O
)	O
)	O
and	O
not	O
a	O
3d	O
point	B
.	O
also	O
,	O
be	O
careful	O
to	O
distinguish	O
between	O
p	O
the	O
parameter	O
vector	O
and	O
p	O
the	O
camera	B
matrix	I
.	O
1	O
,	O
.	O
.	O
.	O
,	O
x	O
n	O
,	O
x	O
(	O
cid:2	O
)	O
the	O
parameter	O
vector	O
p	O
is	O
partitioned	O
as	O
p	O
=	O
(	O
at	O
,	O
bt	O
(	O
i	O
)	O
a	O
=	O
p	O
(	O
cid:2	O
)	O
is	O
made	O
up	O
of	O
the	O
entries	O
of	B
camera	I
matrix	O
p	O
(	O
cid:2	O
)	O
1	O
,	O
.	O
.	O
.	O
,	O
b	O
t	O
,	O
and	O
n	O
)	O
t	O
,	O
where	O
610	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
(	O
ii	O
)	O
bi	O
=	O
(	O
xi	O
,	O
yi	O
,	O
ti	O
)	O
t	O
is	O
a	O
3-vector	O
,	O
parametrizing	O
the	O
i-th	O
3d	O
point	B
(	O
xi	O
,	O
yi	O
,	O
1	O
,	O
ti	O
)	O
.	O
thus	O
,	O
there	O
are	O
a	O
total	O
of	O
3n+12	O
parameters	B
,	O
where	O
n	O
is	O
the	O
number	O
of	O
points	O
.	O
parameter	O
vector	O
a	O
provides	O
a	O
parametrization	B
for	O
the	O
camera	B
p	O
(	O
cid:2	O
)	O
and	O
the	O
other	O
camera	B
p	O
is	O
taken	O
as	O
[	O
i	O
|	O
0	O
]	O
.	O
note	O
also	O
that	O
it	O
is	O
convenient	O
and	O
permissible	O
to	O
set	O
the	O
third	O
coordinate	O
of	O
the	O
3d	O
space	O
point	O
to	O
1	O
as	O
here	O
,	O
since	O
a	O
point	B
(	O
xi	O
,	O
yi	O
,	O
0	O
,	O
ti	O
)	O
t	O
maps	O
to	O
(	O
xi	O
,	O
yi	O
,	O
0	O
)	O
t	O
which	O
is	O
an	O
inﬁnite	O
point	O
,	O
not	O
anywhere	O
close	O
to	O
the	O
measured	O
point	B
(	O
xi	O
,	O
yi	O
,	O
1	O
)	O
t.	O
t	O
)	O
t	O
,	O
the	O
measured	O
images	O
of	O
the	O
i-th	O
point	B
.	O
the	O
measurement	O
vector	O
x	O
is	O
partitioned	O
as	O
x	O
=	O
(	O
xt	O
now	O
,	O
the	O
jacobian	O
matrices	O
ai	O
=	O
∂	O
(	O
cid:23	O
)	O
xi/∂a	O
and	O
bi	O
=	O
∂	O
(	O
cid:23	O
)	O
xi/∂bi	O
may	O
be	O
computed	O
and	O
xi	O
=	O
(	O
xt	O
algorithm	B
a6.3	O
applied	O
to	O
estimate	O
the	O
parameters	B
,	O
and	O
hence	O
p	O
(	O
cid:2	O
)	O
computed	O
.	O
,	O
from	O
which	O
f	O
may	O
be	O
n	O
)	O
t	O
,	O
where	O
each	O
2	O
,	O
.	O
.	O
.	O
,	O
xt	O
i	O
,	O
x	O
(	O
cid:2	O
)	O
1	O
,	O
xt	O
i	O
partial	O
derivative	O
matrices	O
since	O
(	O
cid:23	O
)	O
xi	O
=	O
(	O
ˆxt	O
i	O
,	O
ˆx	O
(	O
cid:2	O
)	O
i	O
jacobian	O
matrices	O
in	O
section	O
a6.4	O
:	O
0	O
∂	O
ˆx	O
(	O
cid:2	O
)	O
i/∂a	O
ai	O
=	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
(	O
cid:17	O
)	O
bi	O
=	O
i2×2|0	O
∂	O
ˆx	O
(	O
cid:2	O
)	O
i/∂bi	O
(	O
cid:18	O
)	O
.	O
t	O
)	O
t	O
one	O
may	O
compute	O
that	O
ai	O
and	O
bi	O
have	O
a	O
form	O
similar	O
to	O
the	O
the	O
covariance	B
matrix	O
σxi	O
breaks	O
up	O
into	O
diagonal	O
blocks	O
diag	O
(	O
si	O
,	O
s	O
(	O
cid:2	O
)	O
i	O
)	O
,	O
where	O
.	O
now	O
,	O
calculating	O
the	O
intermediate	O
expressions	O
in	O
step	O
2	O
of	O
xi	O
and	O
s	O
(	O
cid:2	O
)	O
i	O
=	O
σ−1	O
si	O
=	O
σ−1	O
x	O
(	O
cid:1	O
)	O
algorithm	B
a6.3	O
,	O
we	O
ﬁnd	O
i	O
vi	O
=	O
bt	O
i	O
diag	O
(	O
si	O
,	O
s	O
(	O
cid:2	O
)	O
i	O
)	O
bi	O
=	O
[	O
i2×2	O
|	O
0	O
]	O
tsi	O
[	O
i2×2	O
|	O
0	O
]	O
+	O
(	O
∂	O
ˆx	O
(	O
cid:2	O
)	O
i/∂b	O
)	O
ts	O
(	O
cid:2	O
)	O
i	O
(	O
∂	O
ˆx	O
(	O
cid:2	O
)	O
i/∂b	O
)	O
(	O
a6.15	O
)	O
the	O
abstract	O
form	B
of	I
at	O
σ−1	O
i	O
expressions	O
wi	O
=	O
at	O
i	O
the	O
estimation	B
procedure	O
otherwise	O
proceeds	O
precisely	O
as	O
in	O
algorithm	B
a6.3	O
.	O
ai	O
is	O
the	O
same	O
as	O
in	O
the	O
2d	O
homography	B
case	O
,	O
and	O
the	O
other	O
i	O
may	O
easily	O
be	O
computed	O
.	O
i	O
,	O
and	O
ai	O
=	O
at	O
i	O
σ−1	O
σ−1	O
xi	O
xi	O
xi	O
σ−1	O
xi	O
bi	O
,	O
bi	O
=	O
bt	O
i	O
covariance	B
of	O
f	O
according	O
to	O
the	O
discussion	O
of	O
section	O
a6.3.3	O
and	O
in	O
particular	O
algorithm	B
a6.3	O
,	O
the	O
covariance	B
matrix	O
of	O
the	O
camera	O
parameters	B
,	O
namely	O
the	O
entries	O
of	O
p	O
(	O
cid:2	O
)	O
,	O
is	O
given	O
by	O
wiv−1	O
i	O
wt	O
i	O
)	O
+	O
(	O
a6.16	O
)	O
σp	O
(	O
cid:1	O
)	O
=	O
(	O
u	O
−	O
(	O
cid:7	O
)	O
with	O
notation	O
as	O
in	O
algorithm	B
a6.3	O
.	O
i	O
in	O
computing	O
this	O
pseudo-inverse	B
,	O
it	O
is	O
useful	O
to	O
know	O
the	O
expected	O
rank	O
of	O
σp	O
(	O
cid:1	O
)	O
.	O
in	O
this	O
case	O
,	O
this	O
rank	O
is	O
7	O
,	O
since	O
the	O
total	O
number	O
of	O
degrees	O
of	O
freedom	O
in	O
the	O
solution	B
involving	O
two	O
cameras	O
and	O
n	O
point	B
matches	O
is	O
3n	O
+	O
7.	O
looked	O
at	O
another	O
way	O
,	O
p	O
(	O
cid:2	O
)	O
is	O
=	O
[	O
m	O
|	O
m	O
]	O
,	O
then	O
any	O
other	O
matrix	B
[	O
m	O
+	O
tmt	O
|	O
αm	O
]	O
not	O
determined	O
uniquely	O
,	O
since	O
if	O
p	O
(	O
cid:2	O
)	O
also	O
determines	O
the	O
same	O
fundamental	O
matrix	B
.	O
thus	O
,	O
in	O
computing	O
the	O
pseudo-inverse	B
appearing	O
in	O
the	O
right	O
hand	O
side	O
of	O
(	O
a6.16	O
)	O
,	O
one	O
should	O
set	O
ﬁve	O
of	O
the	O
singular	O
values	O
to	O
zero	O
.	O
of	O
p	O
(	O
cid:2	O
)	O
is	O
a	O
simple	O
formula	O
for	O
the	O
entries	O
of	O
f	O
in	O
terms	O
of	O
the	O
entries	O
of	O
p	O
(	O
cid:2	O
)	O
the	O
foregoing	O
discussion	O
shows	O
how	O
to	O
compute	O
the	O
covariance	B
matrix	O
of	O
the	O
entries	O
.	O
we	O
desire	O
to	O
compute	O
the	O
covariance	B
matrix	O
of	O
the	O
entries	O
of	O
f.	O
however	O
,	O
there	O
=	O
[	O
m	O
|	O
m	O
]	O
,	O
namely	O
a6.6	O
application	O
of	O
sparse	B
lm	O
to	O
multiple	O
image	O
bundle	O
adjustment	O
611	O
f	O
=	O
[	O
m	O
]	O
×m	O
.	O
if	O
one	O
desires	O
to	O
compute	O
the	O
covariance	B
matrix	O
of	O
f	O
normalized	O
so	O
that	O
(	O
cid:10	O
)	O
f	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
then	O
one	O
writes	O
f	O
=	O
[	O
m	O
]	O
×m/	O
(	O
(	O
cid:10	O
)	O
[	O
m	O
]	O
×m	O
(	O
cid:10	O
)	O
)	O
.	O
therefore	O
,	O
one	O
may	O
express	O
the	O
entries	O
of	O
f	O
as	O
a	O
simple	O
function	O
in	O
terms	O
of	O
the	O
entries	O
of	O
p	O
(	O
cid:2	O
)	O
.	O
let	O
j	O
be	O
the	O
jacobian	O
matrix	B
of	O
this	O
function	O
.	O
the	O
covariance	B
of	O
f	O
is	O
then	O
computed	O
by	O
propagating	O
the	O
covariance	B
of	O
p	O
(	O
cid:2	O
)	O
using	O
result	O
5.6	O
(	O
p139	O
)	O
to	O
get	O
σf	O
=	O
jσp	O
(	O
cid:1	O
)	O
jt	O
=	O
j	O
(	O
u	O
−	O
(	O
cid:7	O
)	O
wiv−1	O
i	O
wt	O
i	O
)	O
+jt	O
(	O
a6.17	O
)	O
where	O
σp	O
(	O
cid:1	O
)	O
is	O
given	O
by	O
(	O
a6.16	O
)	O
.	O
this	O
is	O
the	O
covariance	B
of	O
the	O
fundamental	B
matrix	I
esti-	O
mated	O
according	O
to	O
an	O
ml	O
algorithm	B
from	O
the	O
given	O
point	B
correspondences	O
.	O
i	O
a6.6	O
application	O
of	O
sparse	B
lm	O
to	O
multiple	O
image	O
bundle	O
adjustment	O
in	O
the	O
previous	O
section	O
,	O
the	O
application	O
of	O
the	O
sparse	B
levenberg–marquardt	O
algorithm	B
to	O
the	O
computation	B
of	I
the	O
fundamental	B
matrix	I
was	O
considered	O
.	O
this	O
is	O
essentially	O
a	O
recon-	O
struction	O
problem	O
from	O
two	B
views	I
.	O
it	O
should	O
be	O
clear	O
how	O
this	O
may	O
easily	O
be	O
extended	O
to	O
the	O
computation	B
of	I
the	O
trifocal	B
tensor	I
and	O
the	O
quadrifocal	B
tensor	I
.	O
more	O
generally	O
,	O
one	O
may	O
apply	O
it	O
to	O
the	O
simultaneous	O
estimation	B
of	I
multiple	O
camera	B
and	O
points	O
to	O
compute	O
projective	B
structure	O
,	O
or	O
perhaps	O
afﬁne	B
or	O
metric	B
structure	I
given	O
appropriate	O
constraints	B
.	O
this	O
technique	O
is	O
called	O
bundle	B
adjustment	I
.	O
in	O
the	O
case	O
of	O
multiple	O
cameras	B
,	O
one	O
may	O
also	O
take	O
advantage	O
of	O
the	O
lack	O
of	O
inter-	O
action	O
between	O
parameters	B
of	O
the	O
different	O
cameras	B
,	O
as	O
will	O
be	O
shown	O
now	O
.	O
in	O
the	O
following	O
discussion	O
,	O
for	O
simplicity	O
of	O
notation	O
it	O
will	O
be	O
assumed	O
that	O
each	O
point	B
is	O
visible	O
in	O
all	O
the	O
views	O
.	O
this	O
is	O
not	O
at	O
all	O
necessary	O
–	O
points	O
may	O
in	O
general	O
be	O
visible	O
in	O
some	O
arbitrary	O
subset	O
of	O
the	O
available	O
views	O
.	O
i1	O
,	O
xt	O
i2	O
,	O
.	O
.	O
.	O
,	O
x	O
t	O
we	O
use	O
the	O
same	O
notation	O
as	O
in	O
section	O
a6.3.3	O
.	O
the	O
measurement	O
data	O
may	O
be	O
ex-	O
pressed	O
as	O
a	O
vector	O
x	O
,	O
which	O
may	O
be	O
divided	O
up	O
into	O
parts	O
xi	O
,	O
representing	O
the	O
measured	O
image	O
coordinates	O
of	O
some	O
3d	O
point	B
in	O
all	O
views	O
.	O
one	O
may	O
further	O
subdivide	O
xi	O
writing	O
xi	O
=	O
(	O
xt	O
im	O
)	O
t	O
where	O
xij	O
is	O
the	O
image	O
of	O
the	O
i-th	O
point	B
in	O
the	O
j-th	O
image	O
.	O
the	O
parameter	O
vector	O
a	O
(	O
camera	B
parameters	I
)	O
may	O
correspondingly	O
be	O
partitioned	O
as	O
a	O
=	O
(	O
at	O
m	O
)	O
t	O
,	O
where	O
aj	O
are	O
the	O
parameters	B
of	O
the	O
j-th	O
camera	B
.	O
since	O
the	O
image	O
point	O
xij	O
does	O
not	O
depend	O
on	O
the	O
parameters	B
of	O
any	O
but	O
the	O
j-th	O
camera	B
,	O
one	O
observes	O
that	O
∂	O
ˆxij/∂ak	O
=	O
0	O
unless	O
j	O
=	O
k.	O
in	O
a	O
similar	O
way	O
for	O
derivatives	O
with	O
respect	O
to	O
the	O
parameters	B
bk	O
of	O
the	O
k-th	O
3d	O
point	B
,	O
one	O
has	O
∂	O
ˆxij/∂bk	O
=	O
0	O
unless	O
i	O
=	O
k.	O
1	O
,	O
at	O
2	O
,	O
.	O
.	O
.	O
,	O
a	O
t	O
the	O
form	B
of	I
the	O
jacobian	O
matrix	B
j	O
for	O
this	O
problem	O
and	O
the	O
resulting	O
normal	O
equa-	O
tions	O
jtjδ	O
=	O
jt	O
are	O
shown	O
schematically	O
in	O
ﬁgure	O
a6.1	O
and	O
ﬁgure	O
a6.2	O
.	O
referring	O
to	O
the	O
jacobian	O
matrices	O
deﬁned	O
in	O
algorithm	B
a6.3	O
,	O
one	O
sees	O
that	O
ai	O
=	O
[	O
∂	O
(	O
cid:23	O
)	O
xi/∂a	O
]	O
is	O
a	O
trix	O
bi	O
=	O
[	O
∂	O
(	O
cid:23	O
)	O
xi/∂bi	O
]	O
decomposes	O
as	O
bi	O
=	O
[	O
bt	O
block	O
diagonal	O
matrix	B
ai	O
=	O
diag	O
(	O
ai1	O
,	O
.	O
.	O
.	O
,	O
a	O
im	O
)	O
,	O
where	O
aij	O
=	O
∂	O
ˆxij/∂aj	O
.	O
similarly	O
,	O
ma-	O
im	O
]	O
t	O
,	O
where	O
bij	O
=	O
∂	O
ˆxij/∂bi	O
.	O
it	O
may	O
normally	O
be	O
assumed	O
also	O
that	O
σxi	O
has	O
a	O
diagonal	O
structure	B
σxi	O
=	O
diag	O
(	O
σxi1	O
,	O
.	O
.	O
.	O
,	O
σ	O
xim	O
)	O
,	O
meaning	O
that	O
the	O
measurements	O
of	O
the	O
projected	O
points	O
in	O
separate	O
images	O
are	O
indepen-	O
dent	O
(	O
or	O
more	O
precisely	O
,	O
uncorrelated	O
)	O
.	O
with	O
these	O
assumptions	O
,	O
one	O
is	O
easily	O
able	O
to	O
adapt	O
algorithm	B
a6.3	O
,	O
as	O
shown	O
in	O
algorithm	O
a6.4	O
,	O
as	O
the	O
reader	O
is	O
left	O
to	O
verify	O
.	O
i1	O
,	O
.	O
.	O
.	O
,	O
b	O
t	O
612	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
p1	O
p2	O
p3	O
x1	O
x2	O
x3	O
x4	O
1	O
jx	O
2	O
jx	O
3	O
jx	O
camera	B
parameters	I
feature	O
parameters	B
fig	O
.	O
a6.1	O
.	O
form	B
of	I
the	O
jacobian	O
matrix	B
for	O
a	O
bundle-adjustment	O
problem	O
consisting	O
of	O
3	O
cameras	B
and	O
4	O
points	O
.	O
u1	O
u2	O
w	O
u3	O
v1	O
wt	O
v2	O
v3	O
v4	O
∆	O
(	O
p1	O
)	O
∆	O
(	O
p2	O
)	O
∆	O
(	O
p3	O
)	O
∆	O
(	O
x1	O
)	O
∆	O
(	O
x2	O
)	O
∆	O
(	O
x3	O
)	O
∆	O
(	O
x4	O
)	O
ε	O
(	O
p1	O
)	O
ε	O
(	O
p2	O
)	O
ε	O
(	O
p3	O
)	O
ε	O
(	O
x1	O
)	O
ε	O
(	O
x2	O
)	O
ε	O
(	O
x3	O
)	O
ε	O
(	O
x4	O
)	O
fig	O
.	O
a6.2	O
.	O
form	B
of	I
the	O
normal	B
equations	I
for	O
the	O
bundle-adjustment	O
problem	O
consisting	O
of	O
3	O
cameras	B
and	O
4	O
points	O
.	O
missing	O
data	O
.	O
typically	O
,	O
in	O
a	O
bundle-adjustment	O
problem	O
some	O
points	O
are	O
not	O
visible	O
in	O
every	O
image	O
.	O
thus	O
,	O
some	O
measurement	O
xij	O
may	O
not	O
exist	O
,	O
meaning	O
that	O
i-th	O
point	B
is	O
not	O
visible	O
in	O
the	O
j-th	O
image	O
.	O
algorithm	B
a6.4	O
is	O
easily	O
adapted	O
to	O
this	O
situation	O
,	O
by	O
ignoring	O
terms	O
subscripted	O
by	O
ij	O
where	O
the	O
measurement	O
xij	O
does	O
not	O
exist	O
.	O
such	O
missing	O
terms	O
are	O
simply	O
omitted	O
from	O
the	O
relevant	O
summations	O
.	O
this	O
includes	O
all	O
of	O
aij	O
,	O
bij	O
,	O
σ−1	O
xij	O
,	O
wij	O
and	O
yij	O
.	O
it	O
may	O
be	O
seen	O
that	O
this	O
is	O
equivalent	B
to	O
setting	O
aij	O
and	O
bij	O
to	O
zero	O
,	O
thus	O
effectively	O
giving	O
zero	O
weight	O
to	O
the	O
missing	O
measurements	O
.	O
this	O
is	O
convenient	O
when	O
programming	O
this	O
algorithm	B
,	O
since	O
the	O
above	O
quantities	O
sub-	O
scripted	O
by	O
ij	O
may	O
be	O
associated	O
only	O
with	O
existing	O
measurements	O
in	O
a	O
common	O
data	O
structure	B
.	O
a6.7	O
sparse	B
methods	I
for	O
equation	O
solving	B
613	O
(	O
i	O
)	O
compute	O
the	O
derivative	O
matrices	O
aij	O
=	O
[	O
∂ˆxij/∂aj	O
]	O
and	O
bij	O
=	O
[	O
∂ˆxij/∂bi	O
]	O
and	O
the	O
error	B
(	O
ii	O
)	O
compute	O
the	O
intermediate	O
values	O
vectors	O
ij	O
=	O
xij	O
−	O
ˆxij	O
.	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
uj	O
=	O
i	O
aj	O
=	O
ijς−1	O
at	O
xij	O
aij	O
vi	O
=	O
bij	O
wij	O
=	O
at	O
ijς−1	O
xij	O
bij	O
ijς−1	O
at	O
xij	O
ij	O
bi	O
=	O
ijς−1	O
bt	O
xij	O
ij	O
yij	O
=	O
wijv∗−1	O
i	O
i	O
j	O
(	O
cid:7	O
)	O
ijς−1	O
bt	O
(	O
cid:7	O
)	O
xij	O
j	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
i	O
yijwt	O
yijwt	O
(	O
cid:7	O
)	O
(	O
cid:7	O
)	O
i	O
(	O
iii	O
)	O
compute	O
δa	O
=	O
(	O
δt	O
where	O
in	O
each	O
case	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
and	O
j	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
m.	O
am	O
)	O
t	O
from	O
the	O
equation	O
1	O
,	O
.	O
.	O
.	O
,	O
et	O
sδa	O
=	O
(	O
et	O
a1	O
,	O
.	O
.	O
.	O
,	O
δt	O
m	O
)	O
t	O
where	O
s	O
is	O
an	O
m	O
×	O
m	O
block	O
matrix	B
with	O
blocks	O
sjk	O
deﬁned	O
by	O
sjj	O
=	O
−	O
sjk	O
=	O
−	O
j	O
ij	O
+	O
u∗	O
ik	O
if	O
j	O
(	O
cid:5	O
)	O
=	O
k	O
and	O
i	O
ej	O
=	O
aj	O
−	O
yijbi	O
(	O
iv	O
)	O
compute	O
each	O
δbi	O
in	O
turn	O
from	O
the	O
equation	O
(	O
bi	O
−	O
δbi	O
=	O
v∗−1	O
i	O
wt	O
ijδaj	O
)	O
j	O
covariance	B
(	O
i	O
)	O
redeﬁne	O
yij	O
=	O
wijv−1	O
(	O
ii	O
)	O
σa	O
=	O
s+	O
,	O
where	O
s	O
is	O
deﬁned	O
as	O
above	O
,	O
without	O
the	O
augmentation	B
represented	O
by	O
the	O
∗	O
.	O
(	O
iii	O
)	O
σbibj	O
=	O
yt	O
(	O
iv	O
)	O
σabi	O
=	O
−σayi	O
.	O
i	O
σayj	O
+	O
δijv−1	O
.	O
.	O
i	O
i	O
algorithm	B
a6.4	O
.	O
general	O
sparse	O
levenberg–marquardt	O
algorithm	B
.	O
a6.7	O
sparse	B
methods	I
for	O
equation	O
solving	B
in	O
a	O
long	O
sequence	O
of	O
images	O
,	O
it	O
is	O
rare	O
for	O
a	O
point	O
to	O
be	O
tracked	O
through	O
the	O
whole	O
sequence	O
,	O
and	O
usually	O
point	B
tracks	O
disappear	O
and	O
new	O
ones	O
start	O
,	O
causing	O
the	O
set	O
of	O
point	O
tracks	O
to	O
have	O
a	O
banded	B
structure	I
,	O
as	O
seen	O
in	O
ﬁgure	O
19.7	O
(	O
p492	O
)	O
(	O
c	O
)	O
.	O
this	O
banded	B
structure	I
of	O
the	O
point	B
track	O
set	O
leads	O
to	O
a	O
banded	B
structure	I
for	O
the	O
set	O
of	O
equations	O
that	O
are	O
solved	O
to	O
compute	O
structure	B
and	O
motion	O
–	O
we	O
refer	O
here	O
to	O
the	O
matrix	B
s	O
in	O
algorithm	O
a6.4	O
.	O
thus	O
,	O
for	O
bundle-adjustment	O
problems	O
with	O
banded	O
track	O
structure	B
,	O
sparseness	O
can	O
appear	O
at	O
two	O
levels	O
,	O
ﬁrst	O
at	O
the	O
level	O
of	O
independence	O
of	O
the	O
individual	O
point	B
measurements	O
,	O
as	O
exploited	O
in	O
algorithm	O
a6.4	O
,	O
and	O
secondly	O
arising	O
from	O
the	O
banded	O
track	O
structure	B
as	O
will	O
be	O
explained	O
in	O
this	O
section	O
.	O
another	O
similar	O
context	O
in	O
which	O
this	O
will	O
occur	O
is	O
solution	B
for	O
structure	B
and	O
motion	O
614	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
in	O
section	O
18.5.1	O
(	O
p448	O
)	O
or	O
simply	O
motion	O
,	O
as	O
in	O
section	O
18.5.2	O
(	O
p450	O
)	O
.	O
in	O
both	O
these	O
methods	O
,	O
large	O
sparse	B
sets	O
of	O
equations	O
may	O
arise	O
.	O
in	O
order	O
for	O
large	O
problems	O
of	O
this	O
kind	O
to	O
be	O
tractable	O
,	O
it	O
is	O
necessary	O
to	O
take	O
advantage	O
of	O
this	O
sparse	B
structure	O
in	O
order	O
to	O
minimize	O
the	O
amount	O
of	O
storage	O
and	O
computation	B
involved	O
.	O
in	O
this	O
section	O
,	O
we	O
will	O
consider	O
sparse	B
matrix	O
techniques	O
that	O
are	O
valuable	O
in	O
this	O
context	O
.	O
trix	O
with	O
off-diagonal	O
blocks	O
of	O
the	O
form	O
sjk	O
=	O
−	O
(	O
cid:27	O
)	O
a6.7.1	O
banded	B
structure	I
in	O
bundle-adjustment	O
the	O
time-consuming	O
step	O
in	O
ﬁnding	O
the	O
parameter	O
increments	O
in	O
the	O
iterative	B
step	O
of	O
bundle-adjustment	O
,	O
as	O
given	O
in	O
algorithm	O
a6.4	O
is	O
the	O
solution	B
of	O
the	O
equations	O
sδa	O
=	O
e	O
in	O
step	O
(	O
iii	O
)	O
of	O
the	O
algorithm	O
.	O
as	O
shown	O
there	O
,	O
the	O
matrix	B
s	O
is	O
a	O
symmetric	B
ma-	O
wt	O
ik	O
.	O
we	O
see	O
that	O
the	O
block	O
sjk	O
is	O
non-zero	O
only	O
when	O
for	O
some	O
i	O
,	O
both	O
wij	O
and	O
wik	O
are	O
non-zero	O
.	O
since	O
−1	O
wij	O
=	O
[	O
∂	O
ˆxij/∂aj	O
]	O
tς	O
xij	O
[	O
∂	O
ˆxij/∂bi	O
]	O
it	O
follows	O
that	O
wij	O
is	O
non-zero	O
only	O
when	O
the	O
corre-	O
sponding	O
measurement	O
ˆxij	O
depends	O
on	O
parameters	O
aj	O
and	O
bi	O
.	O
to	O
be	O
more	O
concrete	O
,	O
if	O
aj	O
represents	O
the	O
parameters	B
of	O
the	O
j-th	O
camera	B
,	O
and	O
bi	O
represents	O
the	O
parameters	B
of	O
the	O
i-th	O
point	B
,	O
then	O
wij	O
is	O
non-zero	O
only	O
when	O
the	O
i-th	O
point	B
is	O
visible	O
in	O
the	O
j-th	O
image	O
,	O
and	O
xij	O
is	O
its	O
measured	O
image	O
position	O
.	O
i	O
wijv∗−1	O
i	O
the	O
condition	O
that	O
for	O
some	O
i	O
both	O
wij	O
and	O
wik	O
are	O
non-zero	O
means	O
that	O
there	O
exists	O
some	O
point	B
with	O
index	O
i	O
that	O
is	O
visible	O
in	O
both	O
the	O
j-th	O
and	O
k-th	O
images	O
.	O
to	O
summarize	O
,	O
•	O
the	O
block	O
sjk	O
is	O
non-zero	O
only	O
if	O
there	O
exists	O
a	O
point	B
that	O
is	O
visible	O
in	O
both	O
the	O
j-th	O
and	O
k-th	O
images	O
.	O
thus	O
,	O
if	O
point	B
tracks	O
extend	O
only	O
over	O
consecutive	O
views	O
,	O
then	O
the	O
matrix	B
s	O
will	O
be	O
banded	O
.	O
in	O
particular	O
,	O
if	O
no	O
point	O
track	O
extends	O
over	O
more	O
than	O
b	O
views	O
(	O
b	O
representing	O
bandwidth	O
)	O
,	O
then	O
the	O
block	O
sjk	O
is	O
zero	O
unless	O
|j	O
−	O
k|	O
<	O
b.	O
consider	O
tracking	O
points	O
over	O
a	O
long	O
sequence	O
,	O
for	O
instance	O
along	O
a	O
path	O
that	O
may	O
loop	O
back	O
and	O
cross	O
itself	O
.	O
in	O
this	O
case	O
,	O
it	O
may	O
be	O
possible	O
to	O
recognize	O
a	O
point	B
that	O
had	O
been	O
seen	O
previously	O
in	O
the	O
sequence	O
,	O
and	O
pick	O
up	O
its	O
track	O
again	O
.	O
the	O
set	O
of	O
views	O
in	O
which	O
a	O
3d	O
point	B
is	O
seen	O
will	O
not	O
be	O
a	O
consecutive	O
set	O
of	O
views	O
.	O
this	O
will	O
destroy	O
the	O
banded	O
nature	O
of	O
the	O
matrix	O
s	O
,	O
by	O
introducing	O
non-zero	O
blocks	O
possibly	O
far	O
away	O
from	O
the	O
central	O
band	O
.	O
nevertheless	O
,	O
if	O
there	O
is	O
not	O
too	O
much	O
ﬁlling-in	O
of	O
off-diagonal	O
blocks	O
,	O
sparse	B
solution	O
techniques	O
may	O
still	O
be	O
utilized	O
as	O
we	O
shall	O
see	O
later	O
.	O
a6.7.2	O
solution	B
of	O
symmetric	B
linear	I
equations	I
in	O
solving	B
a	O
set	O
of	O
linear	O
equations	O
ax	O
=	O
b	O
in	O
which	O
the	O
matrix	B
a	O
is	O
symmetric	B
,	O
it	O
is	O
best	O
not	O
to	O
use	O
a	O
general	O
purpose	O
equation	O
solver	O
,	O
such	O
as	O
gaussian-elimination	O
,	O
but	O
rather	O
to	O
take	O
advantage	O
of	O
the	O
symmetry	O
of	O
the	O
matrix	O
a.	O
one	O
way	O
of	O
doing	O
this	O
is	O
the	O
use	O
the	O
ldlt	O
decomposition	B
of	I
the	O
matrix	B
a.	O
this	O
relies	O
on	O
the	O
following	O
observation	O
:	O
result	O
a6.1	O
.	O
any	O
positive-deﬁnite	O
symmetric	O
matrix	B
a	O
can	O
be	O
factored	O
as	O
a	O
=	O
ldlt	O
,	O
in	O
which	O
l	O
is	O
a	O
lower-triangular	O
matrix	B
with	O
unit	O
diagonal	O
entries	O
,	O
and	O
d	O
is	O
diagonal	O
.	O
the	O
reader	O
is	O
advised	O
to	O
consult	O
[	O
golub-89	O
]	O
for	O
details	O
of	O
efﬁcient	O
implementation	B
and	O
numeric	O
properties	B
of	O
ldlt	O
decomposition	B
.	O
the	O
normal	B
equations	I
derived	O
from	O
struc-	O
ture	O
and	O
motion	O
problems	O
are	O
always	O
at	O
least	O
positive	O
semi-deﬁnite	O
,	O
and	O
with	O
stabiliza-	O
a6.7	O
sparse	B
methods	I
for	O
equation	O
solving	B
615	O
a	O
b	O
fig	O
.	O
a6.3	O
.	O
(	O
a	O
)	O
a	O
sparse	B
matrix	O
and	O
(	O
b	O
)	O
its	O
corresponding	O
“	O
skyline	O
”	O
structure	B
.	O
non-zero	O
entries	O
in	O
the	O
original	O
matrix	B
are	O
shown	O
in	O
black	O
.	O
in	O
the	O
skyline	O
format	O
,	O
all	O
non-zero	O
entries	O
lie	O
in	O
the	O
shaded	O
area	O
.	O
for	O
each	O
row	O
i	O
,	O
there	O
is	O
an	O
integer	O
mi	O
representing	O
the	O
ﬁrst	O
non-zero	O
entry	O
in	O
that	O
row	O
.	O
note	O
that	O
non-zero	O
off-diagonal	O
elements	O
cause	O
“	O
ﬁll-in	O
”	O
of	O
the	O
skyline	O
format	O
for	O
that	O
row	O
(	O
or	O
symmetric	B
above-diagonal	O
column	O
)	O
.	O
if	O
such	O
entries	O
are	O
relatively	O
rare	O
,	O
the	O
skyline	O
format	O
will	O
remain	O
sparse	B
,	O
and	O
techniques	O
for	O
skyline	O
matrices	O
may	O
be	O
usefully	O
applied	O
.	O
the	O
ldlt	O
decomposition	B
of	I
a	O
matrix	B
in	O
skyline	O
format	O
has	O
the	O
same	O
skyline	O
structure	B
.	O
thus	O
,	O
the	O
ldlt	O
decomposition	B
of	I
the	O
original	O
sparse	B
matrix	O
shown	O
in	O
(	O
a	O
)	O
,	O
will	O
have	O
non-zero	O
entries	O
only	O
within	O
the	O
shaded	O
area	O
of	O
(	O
b	O
)	O
.	O
tion	O
through	O
enhancement	O
,	O
they	O
are	O
positive-deﬁnite	O
,	O
and	O
symmetric	B
factorization	O
is	O
the	O
recommended	B
method	I
of	O
solution	B
.	O
solved	O
for	O
x	O
in	O
three	O
steps	O
as	O
(	O
i	O
)	O
lx	O
(	O
cid:2	O
)	O
given	O
the	O
ldlt	O
factorization	B
,	O
the	O
set	O
of	O
linear	O
equations	O
ax	O
=	O
ldltx	O
=	O
b	O
may	O
be	O
solving	B
the	O
equations	O
lx	O
(	O
cid:2	O
)	O
=	O
b	O
is	O
carried	O
out	O
by	O
the	O
process	O
of	O
“	O
forward-substitution.	O
”	O
in	O
particular	O
(	O
bearing	O
in	O
mind	O
that	O
l	O
has	O
unit	O
diagonal	O
entries	O
)	O
,	O
the	O
components	O
of	O
x	O
may	O
be	O
computed	O
in	O
order	O
as	O
=	O
b	O
,	O
(	O
ii	O
)	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
=	O
d−1x	O
(	O
cid:2	O
)	O
,	O
(	O
iii	O
)	O
ltx	O
=	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
.	O
forward-substitution	O
:	O
x	O
(	O
cid:2	O
)	O
i	O
=	O
bi	O
−	O
i−1	O
(	O
cid:7	O
)	O
j=1	O
lijx	O
(	O
cid:2	O
)	O
j.	O
since	O
lt	O
is	O
upper-triangular	O
,	O
the	O
second	O
set	O
of	O
equations	O
is	O
solved	O
in	O
a	O
similar	O
fashion	O
,	O
except	O
that	O
the	O
values	O
xi	O
are	O
computed	O
in	O
inverse	O
order	O
in	O
a	O
process	O
known	O
as	O
“	O
back-	O
substitution.	O
”	O
back-substitution	O
:	O
xi	O
=	O
x	O
(	O
cid:2	O
)	O
(	O
cid:2	O
)	O
i	O
ljixj	O
.	O
−	O
n	O
(	O
cid:7	O
)	O
j=i+1	O
the	O
number	O
of	O
operations	O
involved	O
in	O
this	O
computation	B
is	O
given	O
in	O
[	O
golub-89	O
]	O
,	O
and	O
is	O
equal	O
to	O
n3/3	O
,	O
where	O
n	O
is	O
the	O
dimension	O
of	O
the	O
matrix	O
.	O
a6.7.3	O
solution	B
of	O
sparse	B
symmetric	O
linear	B
systems	O
we	O
consider	O
a	O
special	O
type	O
of	O
sparse	O
structure	B
for	O
a	O
symmetric	B
matrix	O
,	O
known	O
as	O
“	O
sky-	O
line	B
”	O
format	O
.	O
this	O
is	O
illustrated	O
in	O
ﬁgure	O
a6.3	O
.	O
an	O
n×	O
n	O
symmetric	B
matrix	O
a	O
in	O
skyline	O
format	O
is	O
characterized	O
by	O
the	O
existence	O
of	O
an	O
array	O
of	O
integers	O
mi	O
for	O
i	O
=	O
1	O
,	O
.	O
.	O
.	O
,	O
n	O
such	O
that	O
aij	O
=	O
0	O
for	O
j	O
<	O
mi	O
.	O
a	O
diagonally	O
banded	O
matrix	O
is	O
a	O
special	O
case	O
of	O
a	O
matrix	O
with	O
skyline	O
structure	B
.	O
616	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
although	O
a	O
diagonally	O
banded	O
or	O
skyline	O
matrix	O
may	O
be	O
sparse	B
,	O
its	O
inverse	O
is	O
not	O
,	O
and	O
in	O
fact	O
will	O
be	O
completely	O
ﬁlled	O
out	O
with	O
non-zero	O
elements	O
.	O
thus	O
,	O
it	O
is	O
a	O
very	O
bad	O
idea	O
actually	O
to	O
compute	O
the	O
inverse	O
of	O
a	O
to	O
ﬁnd	O
the	O
solution	B
x	O
=	O
a−1b	O
to	O
the	O
set	O
of	O
equations	O
.	O
however	O
,	O
the	O
importance	O
of	O
matrices	O
in	O
skyline	O
(	O
or	O
banded	O
)	O
form	O
is	O
that	O
skyline	B
structure	I
of	O
the	O
matrix	B
is	O
preserved	O
by	O
the	O
ldlt	O
decomposition	B
,	O
as	O
expressed	O
in	O
the	O
following	O
result	O
.	O
result	O
a6.2	O
.	O
let	O
a	O
be	O
a	O
symmetric	B
matrix	O
such	O
that	O
aij	O
=	O
0	O
for	O
j	O
<	O
mi	O
.	O
let	O
a	O
=	O
ldlt	O
.	O
then	O
lij	O
=	O
0	O
for	O
j	O
<	O
mi	O
.	O
in	O
other	O
words	O
,	O
the	O
skyline	B
structure	I
of	O
l	O
is	O
the	O
same	O
as	O
that	O
of	O
a.	O
proof	O
.	O
suppose	O
that	O
j	O
is	O
the	O
smallest	O
index	O
such	O
that	O
lij	O
=	O
0.	O
then	O
in	O
multiplying	O
out	O
a	O
=	O
ldlt	O
,	O
it	O
may	O
be	O
veriﬁed	O
that	O
only	O
one	O
product	O
contributes	O
to	O
the	O
(	O
i	O
,	O
j	O
)	O
-th	O
element	O
of	O
aij	O
.	O
speciﬁcally	O
,	O
aij	O
=	O
lijdjjljj	O
(	O
cid:5	O
)	O
=	O
0.	O
thus	O
,	O
in	O
computing	O
the	O
ldlt	O
decomposition	B
of	I
a	O
having	O
a	O
sparse	B
skyline	O
structure	B
,	O
we	O
know	O
in	O
advance	O
that	O
many	O
of	O
the	O
entries	O
of	O
l	O
will	O
be	O
zero	O
.	O
the	O
algorithm	B
for	O
computing	B
the	O
ldlt	O
decomposition	B
for	O
such	O
a	O
matrix	B
is	O
much	O
the	O
same	O
as	O
the	O
that	O
for	O
a	O
full	O
symmetric	B
matrix	O
,	O
except	O
that	O
we	O
do	O
not	O
need	O
to	O
consider	O
the	O
zero	O
elements	O
.	O
forward	O
and	O
back	O
substitution	O
involving	O
a	O
matrix	B
l	O
with	O
skyline	O
structure	B
easily	O
take	O
advantage	O
of	O
the	O
sparse	B
structure	O
.	O
in	O
fact	O
the	O
forward	O
substitution	O
formula	O
becomes	O
i	O
=	O
bi	O
−	O
i−1	O
(	O
cid:7	O
)	O
x	O
(	O
cid:2	O
)	O
lijx	O
(	O
cid:2	O
)	O
j.	O
back-substitution	O
is	O
left	O
for	O
the	O
reader	O
to	O
work	O
out	O
.	O
more	O
details	O
of	O
implementation	O
are	O
given	O
in	O
[	O
bathe-76	O
]	O
.	O
j=mi	O
a6.8	O
robust	B
cost	O
functions	O
in	O
estimation	O
problems	O
of	O
the	O
newton	O
or	O
levenberg-marquardt	O
type	O
,	O
an	O
important	O
de-	O
cision	O
to	O
make	O
is	O
the	O
precise	O
form	B
of	I
the	O
cost	B
function	I
.	O
as	O
we	O
have	O
seen	O
,	O
an	O
assumption	O
of	O
gaussian	O
noise	B
without	O
outliers	O
implies	O
that	O
the	O
the	O
maximum	O
likelihood	O
estimate	O
is	O
given	O
by	O
a	O
least-squares	O
cost	O
function	O
involving	O
the	O
predicted	O
errors	O
in	O
the	O
measure-	O
ments	O
,	O
where	O
the	O
noise	B
is	O
introduced	O
.	O
negative	O
logarithm	O
gives	O
−	O
log	O
(	O
p	O
(	O
δ1	O
,	O
.	O
.	O
.	O
,	O
δn	O
)	O
)	O
=	O
−	O
(	O
cid:27	O
)	O
the	O
same	O
analysis	O
may	O
be	O
carried	O
out	O
for	O
other	O
assumed	O
probability	O
models	O
for	O
the	O
measurements	O
.	O
thus	O
,	O
if	O
all	O
measurements	O
are	O
assumed	O
to	O
be	O
independent	O
,	O
and	O
f	O
(	O
δ	O
)	O
is	O
the	O
probability	O
distribution	O
of	O
an	O
error	B
δ	O
in	O
the	O
measurement	O
,	O
then	O
the	O
probability	O
of	O
a	O
n	O
set	O
of	O
measurement	O
with	O
errors	O
δi	O
is	O
given	O
by	O
p	O
(	O
δ1	O
,	O
.	O
.	O
.	O
,	O
δn	O
)	O
=	O
i=1	O
f	O
(	O
δi	O
)	O
.	O
taking	O
the	O
n	O
i=1	O
log	O
(	O
f	O
(	O
δi	O
)	O
)	O
and	O
the	O
right-hand	O
side	O
of	O
this	O
expression	O
is	O
a	O
suitable	O
cost	B
function	I
for	O
a	O
set	O
of	O
measurements	O
.	O
it	O
is	O
usually	O
appropriate	O
to	O
set	O
the	O
cost	O
of	O
an	O
exact	O
measurement	O
to	O
be	O
zero	O
,	O
by	O
subtracting	O
log	O
(	O
f	O
(	O
0	O
)	O
)	O
,	O
though	O
this	O
is	O
not	O
strictly	O
necessary	O
if	O
our	O
purpose	O
is	O
cost	O
minimization	O
.	O
graphs	O
of	O
various	O
speciﬁc	O
cost	B
functions	I
to	O
be	O
discussed	O
next	O
are	O
shown	O
in	O
ﬁgure	O
a6.4	O
.	O
*	O
a6.8	O
robust	B
cost	O
functions	O
617	O
cost	B
function	I
pdf	O
attenuation	O
factor	O
12	O
10	O
8	O
6	O
4	O
2	O
-7.5	O
-5	O
-2.5	O
2.5	O
5	O
7.5	O
-4	O
-2	O
12	O
10	O
8	O
6	O
4	O
2	O
-7.5	O
-5	O
-2.5	O
2.5	O
5	O
7.5	O
-4	O
-2	O
12	O
10	O
8	O
6	O
4	O
2	O
-7.5	O
-5	O
-2.5	O
2.5	O
5	O
7.5	O
-4	O
-2	O
12	O
10	O
8	O
6	O
4	O
2	O
-7.5	O
-5	O
-2.5	O
2.5	O
5	O
7.5	O
-4	O
-2	O
12	O
10	O
8	O
6	O
4	O
2	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
2	O
4	O
-20	O
-15	O
-10	O
-5	O
5	O
10	O
15	O
20	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
2	O
4	O
-20	O
-15	O
-10	O
-5	O
5	O
10	O
15	O
20	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
2	O
4	O
-20	O
-15	O
-10	O
-5	O
5	O
10	O
15	O
20	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
2	O
4	O
-20	O
-15	O
-10	O
-5	O
5	O
10	O
15	O
20	O
2	O
1.75	O
1.5	O
1.25	O
1	O
0.75	O
0.5	O
0.25	O
-7.5	O
-5	O
-2.5	O
2.5	O
5	O
7.5	O
-4	O
-2	O
2	O
4	O
-20	O
-15	O
-10	O
-5	O
5	O
10	O
15	O
20	O
12	O
10	O
8	O
6	O
4	O
2	O
-7.5	O
-5	O
-2.5	O
2.5	O
5	O
7.5	O
-4	O
-2	O
12	O
10	O
8	O
6	O
4	O
2	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
0.5	O
0.4	O
0.3	O
0.2	O
0.1	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
2	O
4	O
-20	O
-15	O
-10	O
-5	O
5	O
10	O
15	O
20	O
1	O
0.8	O
0.6	O
0.4	O
0.2	O
squared-	O
error	B
blake-	O
zisserman	O
corrupted	O
gaussian	O
cauchy	O
l1	O
huber	O
pseudo-	O
huber	O
-7.5	O
-5	O
-2.5	O
2.5	O
5	O
7.5	O
-4	O
-2	O
2	O
4	O
-20	O
-15	O
-10	O
-5	O
5	O
10	O
15	O
20	O
fig	O
.	O
a6.4	O
.	O
a	O
comparison	O
of	O
different	O
cost	B
functions	I
,	O
c	O
(	O
δ	O
)	O
,	O
for	O
robust	O
estimation	B
.	O
their	O
corresponding	O
pdfs	O
,	O
exp	O
(	O
−c	O
(	O
δ	O
)	O
)	O
,	O
and	O
attenuation	O
factors	O
(	O
w	O
=	O
c	O
(	O
δ	O
)	O
1/2/δ	O
see	O
text	O
)	O
are	O
also	O
shown	O
.	O
618	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
statistically	B
based	I
cost	O
functions	O
.	O
determination	O
of	O
a	O
suitable	O
cost	B
function	I
may	O
be	O
approached	O
by	O
estimating	B
or	O
guessing	O
the	O
distribution	B
of	O
errors	O
for	O
the	O
particular	O
measurement	O
process	O
involved	O
,	O
such	O
as	O
point	O
extraction	O
in	O
an	O
image	O
.	O
in	O
the	O
following	O
list	O
,	O
for	O
simplicity	O
,	O
we	O
ignore	O
the	O
normalization	B
constant	O
for	O
gaussian	O
distributions	O
(	O
2πσ2	O
)	O
−1/2	O
,	O
and	O
assume	O
that	O
2σ2	O
=	O
1	O
.	O
(	O
i	O
)	O
squared	B
error	I
.	O
assuming	O
the	O
data	O
is	O
gaussian	O
distributed	O
,	O
the	O
probability	O
distribution	O
function	O
(	O
pdf	O
)	O
is	O
p	O
(	O
δ	O
)	O
=	O
exp	O
(	O
−δ2	O
)	O
which	O
leads	O
to	O
a	O
cost	B
function	I
c	O
(	O
δ	O
)	O
=	O
δ2	O
.	O
(	O
ii	O
)	O
blake-zisserman	O
.	O
the	O
data	O
is	O
assumed	O
to	O
have	O
a	O
gaussian	O
distribution	B
for	O
inliers	O
with	O
a	O
uniform	O
distribution	B
of	O
outliers	O
.	O
the	O
pdf	O
is	O
taken	O
to	O
be	O
of	O
the	O
form	O
p	O
(	O
δ	O
)	O
=	O
exp	O
(	O
−δ2	O
)	O
+	O
.	O
this	O
is	O
not	O
actually	O
a	O
pdf	O
,	O
since	O
it	O
integrates	O
to	O
inﬁnity	O
.	O
nevertheless	O
,	O
it	O
leads	O
to	O
a	O
cost	B
function	I
of	O
the	O
form	O
c	O
(	O
δ	O
)	O
=−	O
log	O
(	O
exp	O
(	O
−δ2	O
)	O
+	O
	O
)	O
.	O
for	O
inliers	O
(	O
small	O
δ	O
)	O
,	O
this	O
approximates	O
δ2	O
,	O
whereas	O
for	O
outliers	O
(	O
large	O
δ	O
)	O
the	O
asymptotic	O
cost	O
is	O
−	O
log	O
	O
.	O
thus	O
,	O
the	O
crossover	O
point	B
from	O
inliers	O
to	O
outliers	O
is	O
given	O
approximately	O
by	O
δ2	O
=	O
−	O
log	O
	O
.	O
the	O
actual	O
cost	B
function	I
used	O
by	O
blake	O
and	O
zisserman	O
in	O
[	O
blake-87	O
]	O
was	O
min	O
(	O
δ2	O
,	O
α2	O
)	O
and	O
	O
=	O
exp	O
(	O
−α2	O
)	O
.	O
(	O
iii	O
)	O
corrupted	O
gaussian	O
.	O
the	O
previous	O
example	O
has	O
the	O
theoretical	O
disadvan-	O
tage	O
that	O
it	O
is	O
not	O
actually	O
a	O
pdf	O
.	O
an	O
alternative	O
is	O
to	O
model	O
the	O
outliers	O
by	O
a	O
gaussian	O
with	O
larger	O
standard	O
deviation	O
,	O
leading	O
to	O
a	O
mixture	O
model	B
probability	O
distribution	B
of	O
the	O
form	O
p	O
(	O
δ	O
)	O
=	O
α	O
exp	O
(	O
−δ2	O
)	O
+	O
(	O
1	O
−	O
α	O
)	O
exp	O
(	O
δ2/w2	O
)	O
/w	O
where	O
w	O
is	O
the	O
ratio	O
of	O
standard	O
deviations	O
of	O
the	O
outliers	O
to	O
the	O
inliers	O
,	O
and	O
α	O
is	O
the	O
expected	O
fraction	O
of	O
inliers	O
.	O
then	O
c	O
(	O
δ	O
)	O
=−	O
log	O
(	O
α	O
exp	O
(	O
−δ2	O
)	O
+	O
(	O
1−	O
α	O
)	O
exp	O
(	O
−δ2/w2	O
)	O
/w	O
)	O
.	O
heuristic	B
cost	O
functions	O
.	O
next	O
we	O
consider	O
cost	B
functions	I
justiﬁed	O
more	O
by	O
heuris-	O
tics	O
and	O
required	O
noise-immuneness	O
properties	B
than	O
by	O
adherence	O
to	O
a	O
speciﬁc	O
noise-	O
distribution	B
model	O
.	O
for	O
this	O
reason	O
they	O
will	O
be	O
introduced	O
directly	O
as	O
a	O
cost	B
function	I
,	O
rather	O
than	O
a	O
pdf	O
.	O
(	O
i	O
)	O
cauchy	O
cost	B
function	I
.	O
the	O
cost	B
function	I
is	O
given	O
by	O
c	O
(	O
δ	O
)	O
=b	O
2	O
log	O
(	O
1	O
+	O
δ2/b2	O
)	O
for	O
some	O
constant	O
b.	O
for	O
small	O
values	O
of	O
δ	O
,	O
this	O
curve	O
approximates	O
δ2	O
,	O
and	O
the	O
value	O
of	O
b	O
determines	O
for	O
what	O
range	O
of	O
δ	O
this	O
approximation	O
is	O
close	O
.	O
the	O
cost	B
function	I
is	O
derived	O
from	O
the	O
cauchy	O
distribution	B
p	O
(	O
δ	O
)	O
=	O
1/	O
(	O
π	O
(	O
1	O
+	O
δ2	O
)	O
)	O
,	O
which	O
is	O
a	O
bell-curve	O
similar	O
to	O
the	O
gaussian	O
,	O
but	O
with	O
heavier	O
tails	O
.	O
(	O
ii	O
)	O
the	O
l1	O
cost	B
function	I
.	O
instead	O
of	O
using	O
the	O
sum	O
of	O
squares	O
,	O
we	O
use	O
the	O
sum	O
of	O
absolute	O
errors	O
.	O
thus	O
,	O
c	O
(	O
δ	O
)	O
=	O
2b|δ|	O
a6.8	O
robust	B
cost	O
functions	O
619	O
where	O
2b	O
is	O
some	O
positive	O
constant	O
(	O
which	O
normally	O
could	O
just	O
be	O
1	O
)	O
.	O
this	O
cost	B
function	I
is	O
known	O
as	O
the	O
total	O
variation	O
.	O
(	O
iii	O
)	O
huber	O
cost	B
function	I
.	O
this	O
cost	B
function	I
is	O
a	O
hybrid	O
between	O
the	O
l1	O
and	O
least-squares	O
cost	O
function	O
.	O
thus	O
,	O
we	O
deﬁne	O
c	O
(	O
δ	O
)	O
=δ	O
2	O
for	O
|δ|	O
<	O
b	O
=	O
2b|δ|	O
−	O
b2	O
otherwise	O
this	O
cost	B
function	I
is	O
continuous	O
with	O
continuous	O
ﬁrst	O
derivative	O
.	O
the	O
value	O
of	O
the	O
threshold	O
b	O
is	O
chosen	O
approximately	O
to	O
equal	O
the	O
outlier	O
threshold	O
.	O
(	O
iv	O
)	O
pseudo-huber	O
cost	B
function	I
.	O
the	O
cost	B
function	I
(	O
cid:19	O
)	O
1	O
+	O
(	O
δ/b	O
)	O
2	O
−	O
1	O
)	O
c	O
(	O
δ	O
)	O
=	O
2b2	O
(	O
is	O
very	O
similar	O
to	O
the	O
huber	O
cost	B
function	I
,	O
but	O
has	O
continuous	O
derivatives	O
of	O
all	O
orders	O
.	O
note	O
that	O
it	O
approximates	O
δ2	O
for	O
small	O
δ	O
and	O
is	O
linear	B
with	O
slope	O
2b	O
for	O
large	O
δ.	O
a6.8.1	O
properties	B
of	O
the	O
different	O
cost	B
functions	I
squared	O
error	B
.	O
the	O
most	O
basic	O
cost	O
function	O
is	O
the	O
squared	B
error	I
c	O
(	O
δ	O
)	O
=δ	O
2.	O
its	O
main	O
drawback	O
is	O
that	O
it	O
is	O
not	O
robust	B
to	O
outliers	O
in	O
the	O
measurements	O
,	O
as	O
we	O
shall	O
see	O
.	O
because	O
of	O
the	O
rapid	O
growth	O
of	O
the	O
quadratic	O
curve	O
,	O
distant	O
outliers	O
exert	O
an	O
excessive	O
inﬂuence	O
,	O
and	O
can	O
draw	O
the	O
cost	O
minimum	O
well	O
away	O
from	O
the	O
desired	O
value	O
.	O
non-convex	B
cost	O
functions	O
.	O
the	O
blake-zisserman	O
,	O
corrupted	O
gaussian	O
and	O
cauchy	O
cost	B
functions	I
seek	O
to	O
mitigate	O
the	O
deleterious	O
effect	O
of	O
outliers	O
by	O
giving	O
them	O
dimin-	O
ished	O
weight	O
.	O
as	O
is	O
seen	O
in	O
the	O
plot	O
of	O
the	O
ﬁrst	O
two	O
of	O
these	O
,	O
once	O
the	O
error	B
exceeds	O
a	O
certain	O
threshold	O
,	O
it	O
is	O
classiﬁed	O
as	O
an	O
outlier	O
,	O
and	O
the	O
cost	O
remains	O
substantially	O
con-	O
stant	O
.	O
the	O
cauchy	O
cost	B
function	I
also	O
seeks	O
to	O
deemphasize	O
the	O
cost	O
of	O
outliers	O
,	O
but	O
this	O
is	O
done	O
more	O
gradually	O
.	O
these	O
three	O
cost	B
functions	I
are	O
non-convex	B
,	O
which	O
has	O
important	O
effects	O
as	O
we	O
will	O
see	O
.	O
(	O
cid:27	O
)	O
i	O
asymptotically	B
linear	I
cost	O
functions	O
.	O
the	O
l1	O
cost	B
function	I
measures	O
the	O
absolute	O
value	O
of	O
the	O
error	O
.	O
the	O
main	O
effect	O
of	O
this	O
is	O
to	O
give	O
outliers	O
less	O
weight	O
compared	O
with	O
the	O
squared	B
error	I
.	O
the	O
key	O
to	O
understanding	O
the	O
performance	B
of	O
this	O
cost	B
function	I
is	O
to	O
observe	O
that	O
it	O
acts	O
to	O
ﬁnd	O
the	O
median	O
of	O
a	O
set	O
of	O
data	O
.	O
consider	O
a	O
set	O
of	O
real	O
valued	O
data	O
{	O
ai	O
}	O
and	O
a	O
cost	B
function	I
deﬁned	O
by	O
c	O
(	O
x	O
)	O
=	O
|x−	O
ai|	O
.	O
the	O
minimum	O
of	O
this	O
function	O
is	O
at	O
the	O
median	O
of	O
the	O
set	O
{	O
ai	O
}	O
.	O
to	O
see	O
this	O
,	O
note	O
that	O
the	O
derivative	O
of	O
|x	O
−	O
ai|	O
with	O
respect	O
to	O
x	O
is	O
+1	O
when	O
x	O
>	O
ai	O
and	O
−1	O
when	O
x	O
<	O
ai	O
.	O
thus	O
,	O
the	O
derivative	O
is	O
zero	O
when	O
there	O
are	O
as	O
many	O
values	O
of	O
ai	O
less	O
than	O
x	O
as	O
there	O
are	O
greater	O
than	O
x.	O
thus	O
,	O
the	O
cost	O
is	O
minimized	O
at	O
the	O
median	O
of	O
the	O
values	O
ai	O
.	O
note	O
that	O
the	O
median	O
is	O
immune	O
to	O
changes	O
in	O
the	O
values	O
of	O
data	O
ai	O
that	O
lie	O
far	O
from	O
the	O
median	O
.	O
the	O
value	O
of	O
the	O
cost	O
function	O
changes	O
,	O
but	O
not	O
the	O
position	O
of	O
its	O
minimum	O
.	O
for	O
higher	O
dimensional	O
data	O
ai	O
∈	O
irn	O
,	O
the	O
minimum	O
of	O
the	O
cost	O
function	O
c	O
(	O
x	O
)	O
=	O
(	O
cid:10	O
)	O
x	O
−	O
ai	O
(	O
cid:10	O
)	O
has	O
similar	O
stability	B
properties	O
.	O
note	O
that	O
(	O
cid:10	O
)	O
x	O
−	O
ai	O
(	O
cid:10	O
)	O
is	O
a	O
convex	O
function	O
(	O
cid:27	O
)	O
i	O
620	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
(	O
cid:27	O
)	O
of	O
x	O
,	O
and	O
therefore	O
so	O
is	O
a	O
sum	O
of	O
such	O
terms	O
,	O
function	O
has	O
a	O
single	O
minimum	O
(	O
as	O
do	O
all	O
convex	O
functions	O
)	O
.	O
i	O
(	O
cid:10	O
)	O
x	O
−	O
ai	O
(	O
cid:10	O
)	O
.	O
consequently	O
,	O
this	O
cost	O
the	O
huber	O
cost	B
function	I
takes	O
the	O
form	B
of	I
a	O
quadratic	O
for	O
small	O
values	O
of	O
the	O
error	O
,	O
δ	O
,	O
and	O
becomes	O
linear	B
for	O
values	O
of	O
δ	O
beyond	O
a	O
given	O
threshold	O
.	O
as	O
such	O
,	O
it	O
retains	O
the	O
outlier	O
stability	B
of	O
the	O
l1	O
cost	B
function	I
,	O
while	O
for	O
inliers	O
it	O
reﬂects	O
the	O
property	O
that	O
the	O
squared-error	O
cost	B
function	I
gives	O
the	O
maximum	O
likelihood	O
estimate	O
.	O
the	O
pseudo-huber	O
cost	B
function	I
is	O
also	O
near-quadratic	O
for	O
small	O
δ	O
,	O
and	O
linear	B
for	O
large	O
δ.	O
thus	O
,	O
it	O
may	O
be	O
used	O
as	O
a	O
smooth	O
approximation	O
to	O
the	O
huber	O
cost	B
function	I
,	O
and	O
gives	O
similar	O
results	O
.	O
it	O
is	O
important	O
to	O
note	O
that	O
each	O
of	O
these	O
three	O
cost	B
functions	I
has	O
the	O
very	O
desirable	O
property	O
of	O
being	O
convex	O
.	O
(	O
cid:27	O
)	O
a6.8.2	O
performance	B
of	O
the	O
different	O
cost	B
functions	I
to	O
illustrate	O
the	O
properties	B
of	O
the	O
different	O
cost	B
functions	I
we	O
will	O
evaluate	O
the	O
cost	O
i	O
c	O
(	O
x	O
−	O
ai	O
)	O
for	O
two	O
synthetic	O
example	O
data	O
sets	O
{	O
ai	O
}	O
.	O
of	O
the	O
group	O
of	O
asymptotically	O
linear	O
cost	O
functions	O
,	O
only	O
the	O
huber	O
cost	B
function	I
will	O
be	O
shown	O
,	O
since	O
the	O
other	O
two	O
(	O
l1	O
and	O
pseudo-huber	O
)	O
give	O
very	O
similar	O
results	O
.	O
the	O
data	O
{	O
ai	O
}	O
may	O
be	O
thought	O
of	O
as	O
the	O
outcome	O
of	O
an	O
experiment	O
to	O
measure	O
some	O
quantity	O
,	O
with	O
repeated	O
measurements	O
.	O
the	O
measurements	O
are	O
subject	O
to	O
random	O
gaus-	O
sian	O
noise	B
,	O
with	O
outliers	O
.	O
the	O
purpose	O
of	O
the	O
estimation	O
process	O
is	O
to	O
estimate	O
the	O
value	O
of	O
the	O
quantity	O
by	O
minimizing	B
a	O
cost	B
function	I
.	O
the	O
experiments	O
and	O
the	O
results	O
for	O
the	O
two	O
data	O
sets	O
are	O
described	O
in	O
the	O
captions	O
of	O
ﬁgure	O
a6.5	O
and	O
ﬁgure	O
a6.6	O
.	O
summary	B
of	O
ﬁndings	O
.	O
the	O
squared-error	O
cost	B
function	I
is	O
generally	O
very	O
susceptible	O
to	O
outliers	O
,	O
and	O
may	O
be	O
regarded	O
as	O
unusable	O
as	O
long	O
as	O
outliers	O
are	O
present	O
.	O
if	O
outliers	O
have	O
been	O
thoroughly	O
eradicated	O
,	O
using	O
for	O
instance	O
ransac	O
,	O
then	O
it	O
may	O
be	O
used	O
.	O
the	O
non-convex	B
cost	O
functions	O
,	O
though	O
generally	O
having	O
a	O
stable	O
minimum	O
,	O
not	O
much	O
effected	O
by	O
outliers	O
have	O
the	O
signiﬁcant	O
disadvantage	O
of	O
having	O
local	B
minima	I
,	O
which	O
can	O
make	O
convergence	O
to	O
a	O
global	O
minimum	O
chancy	O
.	O
the	O
estimate	O
is	O
not	O
strongly	O
at-	O
tracted	O
to	O
the	O
minimum	O
from	O
outside	O
of	O
its	O
immediate	O
neighbourhood	O
.	O
thus	O
,	O
they	O
are	O
not	O
useful	O
,	O
unless	O
(	O
or	O
until	O
)	O
the	O
estimate	O
is	O
close	O
to	O
the	O
ﬁnal	O
correct	O
value	O
.	O
the	O
huber	O
cost	B
function	I
has	O
the	O
pleasant	O
property	O
of	O
being	O
convex	O
,	O
which	O
makes	O
convergence	O
to	O
a	O
global	O
minimum	O
more	O
reliable	O
.	O
the	O
minimum	O
is	O
quite	O
immune	O
to	O
the	O
baleful	O
inﬂuence	O
of	O
outliers	O
since	O
it	O
represents	O
a	O
compromise	O
between	O
the	O
maximum	O
likelihood	O
estimate	O
of	O
the	O
inliers	O
and	O
the	O
median	O
of	O
the	O
outliers	O
.	O
the	O
pseudo-huber	O
cost	B
function	I
is	O
a	O
good	O
alternative	O
to	O
huber	O
,	O
but	O
use	O
of	O
l1	O
should	O
be	O
approached	O
with	O
care	O
,	O
because	O
of	O
its	O
non-differentiablity	O
at	O
the	O
origin	O
.	O
these	O
ﬁndings	O
were	O
illustrated	O
on	O
one-dimensional	O
data	O
,	O
but	O
they	O
carry	O
over	O
to	O
higher	O
dimensional	O
data	O
also	O
.	O
parameter	B
minimization	I
.	O
we	O
have	O
seen	O
that	O
the	O
huber	O
and	O
related	O
cost	B
functions	I
are	O
convex	O
,	O
and	O
hence	O
have	O
a	O
single	O
minimum	O
.	O
we	O
refer	O
here	O
to	O
the	O
cost	O
c	O
(	O
δ	O
)	O
as	O
a	O
function	O
of	O
the	O
error	B
δ.	O
in	O
general	O
in	O
problems	O
such	O
as	O
structure	O
from	O
motion	O
,	O
the	O
error	B
δ	O
itself	O
is	O
a	O
non-linear	B
function	O
of	O
the	O
parameters	O
(	O
such	O
as	O
camera	O
and	O
point	B
positions	O
)	O
.	O
for	O
this	O
reason	O
,	O
the	O
total	O
cost	O
expressed	O
as	O
a	O
function	O
of	O
the	O
motion	O
and	O
structure	B
parameters	O
a6.8	O
robust	B
cost	O
functions	O
621	O
0.3	O
0.25	O
0.2	O
0.15	O
0.1	O
0.05	O
70	O
60	O
50	O
40	O
30	O
20	O
10	O
14	O
12	O
10	O
8	O
6	O
4	O
2	O
-30	O
-20	O
-10	O
10	O
20	O
30	O
-10	O
-5	O
5	O
10	O
-10	O
-5	O
5	O
10	O
7	O
6	O
5	O
4	O
3	O
2	O
1	O
6	O
5	O
4	O
3	O
2	O
1	O
-10	O
-5	O
5	O
10	O
-10	O
-5	O
5	O
10	O
4.4	O
4.2	O
-30	O
-20	O
-10	O
10	O
20	O
30	O
3.8	O
3.6	O
20	O
17.5	O
15	O
12.5	O
10	O
7.5	O
5	O
2.5	O
-10	O
-5	O
5	O
10	O
(	O
cid:27	O
)	O
fig	O
.	O
a6.5	O
.	O
the	O
data	O
{	O
ai	O
}	O
(	O
illustrated	O
in	O
the	O
top	O
left	O
graph	O
)	O
consists	O
of	O
a	O
set	O
of	O
measurements	O
centred	O
around	O
0	O
with	O
unit	O
gaussian	O
noise	B
,	O
plus	O
10	O
%	O
of	O
outliers	O
biased	O
towards	O
the	O
right	O
of	O
the	O
true	O
value	O
.	O
the	O
i	O
c	O
(	O
|x	O
−	O
ai|	O
)	O
correspond	O
(	O
left-to-right	O
and	O
top-to-bottom	O
)	O
to	O
the	O
cost	B
functions	I
squared	O
graphs	O
of	O
error	O
,	O
cauchy	O
,	O
corrupted-gaussian	O
,	O
blake-zisserman	O
,	O
a	O
zoom	O
of	O
the	O
blake-zisserman	O
,	O
and	O
huber	O
cost	B
functions	I
.	O
note	O
that	O
the	O
minimum	O
of	O
the	O
squared-error	O
cost	B
function	I
is	O
pulled	O
signiﬁcantly	O
to	O
the	O
right	O
by	O
the	O
outliers	O
,	O
whereas	O
the	O
other	O
cost-functions	O
are	O
relatively	O
outlier-independent	O
.	O
the	O
blake-zisserman	O
cost	B
function	I
,	O
which	O
is	O
based	O
most	O
nearly	O
on	O
the	O
distribution	B
of	O
the	O
data	O
,	O
has	O
a	O
very	O
clear	O
minimum	O
.	O
however	O
,	O
close	O
examination	O
(	O
the	O
zoomed	O
plot	O
)	O
shows	O
an	O
undesirable	O
characteristic	O
,	O
which	O
is	O
the	O
presence	O
of	O
local	O
minima	O
near	O
each	O
of	O
the	O
outliers	O
.	O
an	O
iterative	B
method	O
to	O
ﬁnd	O
the	O
cost	O
minimum	O
will	O
fail	O
if	O
it	O
is	O
initiated	O
outside	O
the	O
narrow	O
basin	O
of	O
attraction	O
surrounding	O
the	O
minimum	O
.	O
by	O
contrast	O
,	O
the	O
huber	O
cost	B
function	I
is	O
convex	O
,	O
which	O
means	O
the	O
estimate	O
will	O
be	O
drawn	O
towards	O
the	O
single	O
minimum	O
from	O
any	O
initialization	B
point	O
.	O
can	O
not	O
be	O
expected	O
to	O
be	O
convex	O
,	O
and	O
local	B
minima	I
are	O
inevitable	O
.	O
nevertheless	O
,	O
an	O
important	O
principle	O
is	O
:	O
•	O
choose	O
a	O
parameterization	O
in	O
which	O
the	O
error	B
is	O
as	O
close	O
as	O
possible	O
to	O
being	O
a	O
linear	B
function	O
of	O
the	O
parameters	O
,	O
at	O
least	O
locally	O
.	O
observing	O
this	O
principle	O
will	O
lead	O
to	O
simpler	O
cost	O
surfaces	O
with	O
fewer	O
local	B
minima	I
,	O
and	O
generally	O
quicker	O
convergence	O
.	O
cost	B
functions	I
and	O
least-squares	O
.	O
usually	O
cost	B
functions	I
of	O
the	O
type	O
we	O
have	O
discussed	O
are	O
used	O
in	O
the	O
context	O
of	O
a	O
parameter	O
minimization	B
procedure	O
,	O
such	O
as	O
levenberg-marquardt	O
or	O
newton	O
iteration	B
.	O
commonly	O
,	O
these	O
procedures	O
seek	O
to	O
min-	O
imize	O
the	O
norm	B
of	O
some	O
vector	O
∆	O
depending	O
on	O
a	O
set	O
of	O
parameters	O
p.	O
thus	O
,	O
they	O
minimize	O
(	O
cid:10	O
)	O
∆	O
(	O
p	O
)	O
(	O
cid:10	O
)	O
2	O
over	O
all	O
choices	O
of	O
the	O
parameter	O
vector	O
p.	O
for	O
instance	O
in	O
a	O
struc-	O
(	O
cid:10	O
)	O
δi	O
(	O
cid:10	O
)	O
2	O
=	O
(	O
cid:10	O
)	O
∆	O
(	O
cid:10	O
)	O
2	O
ture	O
and	O
motion	O
problem	O
we	O
may	O
seek	O
to	O
minimize	O
where	O
the	O
values	O
xi	O
are	O
measured	O
image	O
coordinates	O
,	O
the	O
ˆxi	O
are	O
the	O
predicted	O
values	O
de-	O
(	O
cid:10	O
)	O
xi	O
−	O
ˆxi	O
(	O
cid:10	O
)	O
2	O
=	O
(	O
cid:27	O
)	O
(	O
cid:27	O
)	O
i	O
i	O
622	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
0.4	O
0.3	O
0.2	O
0.1	O
250	O
200	O
150	O
100	O
50	O
20	O
17.5	O
15	O
12.5	O
10	O
7.5	O
5	O
2.5	O
-30	O
-20	O
-10	O
10	O
20	O
30	O
-30	O
-20	O
-10	O
10	O
20	O
30	O
-30	O
-20	O
-10	O
10	O
20	O
30	O
20	O
17.5	O
15	O
12.5	O
10	O
7.5	O
5	O
2.5	O
6	O
5	O
4	O
3	O
2	O
1	O
70	O
60	O
50	O
40	O
30	O
20	O
10	O
-10	O
-5	O
5	O
10	O
15	O
20	O
-30	O
-20	O
-10	O
10	O
20	O
30	O
-30	O
-20	O
-10	O
10	O
20	O
30	O
fig	O
.	O
a6.6	O
.	O
in	O
this	O
experiment	O
,	O
as	O
in	O
ﬁgure	O
a6.5	O
,	O
the	O
main	O
part	O
of	O
the	O
data	O
(	O
70	O
%	O
)	O
is	O
centred	O
at	O
the	O
origin	O
,	O
with	O
30	O
%	O
of	O
“	O
outliers	O
”	O
concentrated	O
in	O
a	O
block	O
away	O
from	O
the	O
origin	O
(	O
see	O
top	O
left	O
graph	O
)	O
.	O
this	O
type	O
of	O
measurement	O
distribution	B
is	O
quite	O
realistic	O
in	O
many	O
imaging	O
scenarios	O
,	O
for	O
instance	O
where	O
point	B
or	O
edge	O
measurement	O
is	O
confused	O
by	O
ghost	O
edges	O
.	O
the	O
cost	B
functions	I
in	O
order	O
from	O
the	O
top	O
are	O
:	O
square	O
error	B
,	O
cauchy	O
,	O
corrupted	O
gaussian	O
,	O
blake-zisserman	O
and	O
huber	O
.	O
the	O
squared	B
error	I
cost	O
function	O
ﬁnds	O
the	O
mean	O
of	O
the	O
measurement	O
distribution	B
,	O
which	O
is	O
signiﬁcantly	O
pulled	O
to	O
the	O
right	O
by	O
the	O
block	O
of	O
outliers	O
.	O
the	O
effect	O
of	O
the	O
outlier	O
block	O
on	O
the	O
non-convex	B
cost	O
functions	O
is	O
also	O
shown	O
clearly	O
here	O
.	O
because	O
of	O
the	O
non-convexity	O
,	O
the	O
total	O
cost	O
function	O
does	O
not	O
have	O
a	O
single	O
minimum	O
,	O
but	O
rather	O
two	O
minima	O
around	O
the	O
separate	O
blocks	O
of	O
measurements	O
.	O
because	O
of	O
its	O
convexity	O
,	O
the	O
huber	O
cost	B
function	I
has	O
a	O
single	O
minimum	O
,	O
which	O
is	O
located	O
close	O
to	O
the	O
median	O
of	O
the	O
data	O
,	O
and	O
is	O
hardly	O
inﬂuenced	O
by	O
the	O
presence	O
of	O
the	O
30	O
%	O
of	O
outliers	O
.	O
rived	O
from	O
the	O
current	O
parameter	O
values	O
,	O
and	O
∆	O
is	O
the	O
vector	O
formed	O
by	O
concatenating	O
the	O
individual	O
error	B
vectors	O
δi	O
.	O
since	O
minimization	B
of	O
a	O
squared	O
vector	O
norm	B
(	O
cid:10	O
)	O
∆	O
(	O
cid:10	O
)	O
2	O
is	O
built	O
into	O
most	O
implementa-	O
tions	O
of	O
levenberg-marquardt	O
,	O
we	O
need	O
to	O
see	O
how	O
to	O
apply	O
the	O
robust	B
cost	O
function	O
in	O
this	O
case	O
.	O
the	O
answer	O
is	O
to	O
replace	O
each	O
vector	O
δi	O
by	O
a	O
weighted	B
vector	O
δ	O
(	O
cid:2	O
)	O
i	O
=	O
wiδi	O
such	O
that	O
(	O
cid:27	O
)	O
i	O
c	O
(	O
(	O
cid:10	O
)	O
δi	O
(	O
cid:10	O
)	O
)	O
=	O
(	O
cid:27	O
)	O
i	O
for	O
then	O
(	O
cid:10	O
)	O
2	O
=	O
w2	O
i	O
i	O
(	O
cid:10	O
)	O
δi	O
(	O
cid:10	O
)	O
2	O
=	O
c	O
(	O
(	O
cid:10	O
)	O
δi	O
(	O
cid:10	O
)	O
)	O
(	O
cid:10	O
)	O
δ	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
δi	O
(	O
cid:10	O
)	O
2	O
as	O
desired	O
.	O
from	O
this	O
equality	O
,	O
we	O
ﬁnd	O
wi	O
=	O
c	O
(	O
(	O
cid:10	O
)	O
δi	O
(	O
cid:10	O
)	O
)	O
1/2/	O
(	O
cid:10	O
)	O
δi	O
(	O
cid:10	O
)	O
.	O
(	O
a6.18	O
)	O
thus	O
,	O
the	O
minimization	B
problem	O
is	O
to	O
minimize	O
(	O
cid:10	O
)	O
∆	O
(	O
cid:2	O
)	O
(	O
cid:10	O
)	O
2	O
where	O
∆	O
(	O
cid:2	O
)	O
is	O
the	O
vector	O
obtained	O
by	O
concatenating	O
the	O
vectors	O
δ	O
(	O
cid:2	O
)	O
i	O
=	O
wiδi	O
,	O
and	O
each	O
wi	O
is	O
computed	O
from	O
(	O
a6.18	O
)	O
.	O
note	O
that	O
wi	O
is	O
a	O
function	O
of	O
(	O
cid:10	O
)	O
δi	O
(	O
cid:10	O
)	O
,	O
which	O
normally	O
seeks	O
to	O
attenuate	O
the	O
cost	O
of	O
the	O
outliers	O
.	O
this	O
attenuation	O
function	O
is	O
shown	O
in	O
the	O
ﬁnal	O
column	O
of	O
ﬁgure	O
a6.4	O
for	O
the	O
different	O
cost	B
functions	I
.	O
for	O
the	O
squared	B
error	I
cost	O
function	O
,	O
the	O
attenuation	O
factor	O
is	O
1	O
,	O
meaning	O
no	O
attenuation	O
occurs	O
.	O
for	O
the	O
other	O
cost	B
functions	I
,	O
there	O
is	O
little	O
attenuation	O
within	O
an	O
inlier	O
region	O
,	O
and	O
points	O
outside	O
this	O
region	O
are	O
attenuated	O
to	O
different	O
degrees	O
.	O
a6.9	O
parametrization	B
a6.9	O
parametrization	B
623	O
in	O
the	O
sort	O
of	O
iterative	O
estimate	O
problems	O
we	O
are	O
considering	O
here	O
,	O
an	O
important	O
consid-	O
eration	O
is	O
how	O
the	O
solution	B
space	O
is	O
to	O
be	O
parametrized	O
.	O
most	O
of	O
the	O
geometric	O
entities	O
that	O
we	O
consider	O
do	O
not	O
have	O
a	O
simple	O
euclidean	O
parametrization	B
.	O
for	O
example	O
,	O
in	O
solving	O
a	O
geometric	B
optimization	O
problem	O
,	O
we	O
often	O
wish	O
to	O
iterate	O
over	O
all	O
camera	B
orientations	O
,	O
represented	O
by	O
rotations	B
.	O
rotations	B
are	O
most	O
conveniently	O
represented	O
for	O
computational	O
purposes	O
by	O
rotation	B
matrices	O
,	O
but	O
this	O
is	O
a	O
major	O
overparametrization	O
.	O
the	O
set	O
of	O
3d	O
rotations	B
is	O
naturally	O
3-dimensional	O
(	O
in	O
fact	O
,	O
it	O
forms	O
a	O
3-dimensional	O
lie	O
group	O
,	O
so	O
(	O
3	O
)	O
)	O
,	O
and	O
we	O
may	O
wish	O
to	O
parametrize	O
it	O
with	O
only	O
3	O
parameters	B
.	O
homogeneous	O
vectors	O
or	O
matrices	O
are	O
another	O
common	O
type	O
of	O
representation	O
.	O
it	O
is	O
tempting	O
to	O
use	O
a	O
parametrization	B
of	I
a	O
homogeneous	O
n-vector	O
just	O
by	O
using	O
the	O
compo-	O
nents	O
of	O
the	O
vector	O
itself	O
.	O
however	O
,	O
there	O
are	O
really	O
only	O
n	O
−	O
1	O
degrees	B
of	I
freedom	I
in	O
a	O
homogeneous	O
n-vector	O
,	O
and	O
it	O
is	O
sometimes	O
advantageous	O
to	O
parametrize	O
it	O
with	O
only	O
n	O
−	O
1	O
parameters	B
.	O
gauge	B
freedom	I
.	O
there	O
has	O
been	O
much	O
attention	O
paid	O
to	O
gauge	O
freedom	O
and	O
gauge	O
in-	O
dependence	O
in	O
recent	O
papers	O
(	O
for	O
instance	O
[	O
mclauchlan-00	O
]	O
)	O
.	O
in	O
this	O
context	O
,	O
the	O
word	O
gauge	O
means	O
a	O
coordinate	O
system	O
for	O
a	O
parameter	O
set	O
,	O
and	O
gauge-freedom	O
essentially	O
refers	O
to	O
a	O
change	O
in	O
the	O
representation	B
of	O
the	O
parameter	O
set	O
that	O
does	O
not	O
essentially	O
change	O
the	O
underlying	O
geometry	O
,	O
and	O
hence	O
has	O
no	O
effect	O
on	O
the	O
cost	B
function	I
.	O
the	O
most	O
important	O
gauge	O
freedoms	O
commonly	O
encountered	O
are	O
projective	B
or	O
other	O
ambi-	O
guities	O
,	O
such	O
as	O
those	O
arising	O
in	O
reconstruction	O
problems	O
.	O
however	O
,	O
the	O
scale	O
ambiguity	B
of	O
homogeneous	O
vectors	O
can	O
be	O
counted	O
as	O
gauge	O
freedom	O
also	O
.	O
gauge	O
freedoms	O
in	O
the	O
parametrization	B
of	I
an	O
optimization	O
problem	O
cause	O
the	O
normal	B
equations	I
to	O
be	O
singu-	O
lar	O
,	O
and	O
hence	O
allow	O
multiple	O
solutions	O
.	O
this	O
problem	O
is	O
avoided	O
by	O
the	O
regularization	O
(	O
or	O
enhancement	O
)	O
step	O
in	O
levenberg-marquardt	O
,	O
but	O
there	O
is	O
evidence	O
that	O
excessive	O
gauge	O
freedoms	O
,	O
causing	O
slop	O
in	O
the	O
parametrization	B
,	O
can	O
lead	O
to	O
slower	O
convergence	O
.	O
in	O
addition	O
,	O
when	O
gauge	O
freedoms	O
are	O
present	O
the	O
covariance	B
matrix	O
of	O
the	O
estimated	O
parameters	B
is	O
troublesome	O
,	O
in	O
that	O
there	O
will	O
be	O
inﬁnite	O
variance	O
in	O
unconstrained	O
pa-	O
rameter	O
directions	O
.	O
for	O
instance	O
,	O
it	O
makes	O
no	O
sense	O
to	O
talk	O
of	O
the	O
covariance	O
matrix	B
of	O
an	O
estimated	O
homogeneous	O
vector	O
,	O
unless	O
the	O
scale	O
of	O
the	O
vector	O
is	O
constrained	O
.	O
therefore	O
,	O
in	O
the	O
following	O
pages	O
,	O
we	O
will	O
give	O
some	O
methods	O
for	O
obtaining	O
minimal	O
parametriza-	O
tions	O
for	O
certain	O
common	O
geometric	B
parameter	O
sets	O
.	O
what	O
makes	O
a	O
good	O
parametrization	O
?	O
the	O
foremost	O
requirement	O
of	O
a	O
good	O
parametrization	B
is	O
that	O
it	O
be	O
singularity-free	O
,	O
at	O
least	O
in	O
the	O
areas	O
that	O
are	O
visited	O
during	O
the	O
course	O
of	O
an	O
iterative	B
optimization	O
.	O
this	O
means	O
that	O
the	O
parametrization	B
should	O
be	O
locally	O
continuous	O
,	O
differentiable	O
and	O
one-to-one	O
–	O
in	O
short	O
a	O
diffeomorphism	O
.	O
a	O
sim-	O
ple	O
example	O
of	O
what	O
is	O
meant	O
by	O
this	O
is	O
given	O
by	O
the	O
latitude-longitude	O
parametrization	B
of	I
a	O
sphere	O
,	O
that	O
is	O
,	O
spherical-polar	O
coordinates	B
.	O
this	O
has	O
a	O
singularity	O
at	O
the	O
poles	O
,	O
where	O
the	O
mapping	O
from	O
the	O
lat-long	O
coordinates	B
to	O
a	O
neighbourhood	O
of	O
the	O
pole	O
is	O
not	O
one-to-one	O
.	O
the	O
difﬁculty	O
is	O
that	O
the	O
point	B
with	O
coordinates	B
(	O
latitude	O
=	O
89	O
,	O
longitude	O
=	O
0	O
)	O
–	O
they	O
are	O
both	O
points	O
very	O
close	O
to	O
the	O
pole	O
.	O
however	O
,	O
they	O
are	O
a	O
long	O
way	O
apart	O
in	O
parameter	O
space	O
.	O
to	O
see	O
)	O
is	O
very	O
close	O
to	O
the	O
point	B
(	O
latitude	O
=	O
89	O
◦	O
◦	O
◦	O
,	O
longitude	O
=	O
90	O
◦	O
624	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
the	O
effect	O
of	O
this	O
,	O
suppose	O
that	O
an	O
optimization	O
is	O
taking	O
place	O
on	O
the	O
sphere	O
,	O
tracking	O
down	O
a	O
minimum	O
of	O
a	O
cost	O
function	O
,	O
which	O
exists	O
at	O
the	O
point	B
(	O
89	O
)	O
.	O
if	O
the	O
current	O
estimate	O
is	O
proceeding	O
in	O
the	O
general	O
direction	O
of	O
this	O
minimum	O
,	O
up	O
the	O
line	B
of	O
zero	O
longitude	O
,	O
when	O
it	O
gets	O
near	O
the	O
pole	O
it	O
will	O
ﬁnd	O
that	O
although	O
close	O
to	O
the	O
minimum	O
,	O
it	O
can	O
not	O
get	O
there	O
without	O
a	O
long	O
detour	O
in	O
lat-long	O
parameter	B
space	I
.	O
the	O
difﬁculty	O
is	O
that	O
arbitrarily	O
close	O
points	O
on	O
the	O
sphere	O
,	O
in	O
the	O
neighbourhood	O
of	O
the	O
singularity	O
(	O
the	O
pole	O
)	O
can	O
have	O
large	O
differences	O
in	O
parameter	O
values	O
.	O
the	O
same	O
sort	O
of	O
thing	O
happens	O
with	O
representations	O
of	O
rotations	O
using	O
euler	O
angles	O
.	O
◦	O
,	O
90	O
◦	O
now	O
,	O
we	O
move	O
on	O
to	O
consider	O
some	O
speciﬁc	O
parametrizations	O
.	O
a6.9.1	O
parametrization	B
of	I
3d	O
rotations	B
using	O
the	O
angle-axis	O
formula	O
of	O
(	O
a4.9–p584	O
)	O
we	O
may	O
parametrize	O
a	O
3	O
×	O
3	O
rotation	B
by	O
a	O
3-vector	O
t.	O
this	O
represents	O
a	O
rotation	B
through	O
an	O
angle	B
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
about	O
the	O
axis	O
determined	O
by	O
the	O
vector	O
t.	O
we	O
denote	O
the	O
corresponding	O
rotation	B
matrix	O
by	O
r	O
(	O
t	O
)	O
.	O
regarding	O
this	O
representation	B
,	O
we	O
may	O
make	O
certain	O
simple	O
observations	O
:	O
(	O
i	O
)	O
the	O
identity	O
map	O
(	O
no	O
rotation	O
)	O
is	O
represented	O
by	O
the	O
zero	O
vector	O
t	O
=	O
0	O
.	O
(	O
ii	O
)	O
if	O
some	O
rotation	B
r	O
is	O
represented	O
by	O
a	O
vector	O
t	O
,	O
then	O
the	O
inverse	O
rotation	B
is	O
rep-	O
resented	O
by	O
−t	O
.	O
in	O
symbols	O
:	O
r	O
(	O
t	O
)	O
−1	O
=	O
r	O
(	O
−t	O
)	O
.	O
(	O
iii	O
)	O
if	O
t	O
is	O
small	O
,	O
then	O
the	O
rotation	B
matrix	O
is	O
approximated	O
by	O
i	O
+	O
[	O
t	O
]	O
×	O
.	O
(	O
iv	O
)	O
for	O
small	O
rotations	B
represented	O
by	O
t1	O
and	O
t2	O
,	O
the	O
composite	O
rotation	B
is	O
repre-	O
sented	O
to	O
ﬁrst-order	O
by	O
t1	O
+	O
t2	O
.	O
in	O
other	O
words	O
r	O
(	O
t1	O
)	O
r	O
(	O
t2	O
)	O
≈	O
r	O
(	O
t1	O
+	O
t2	O
)	O
.	O
thus	O
the	O
mapping	O
t	O
(	O
cid:6	O
)	O
→	O
r	O
(	O
t	O
)	O
is	O
to	O
ﬁrst	O
order	O
a	O
group	O
isomorphism	O
for	O
small	O
t.	O
in	O
fact	O
,	O
for	O
small	O
t	O
,	O
the	O
map	O
is	O
an	O
isometry	O
(	O
distance	B
preserving	O
map	O
)	O
in	O
terms	O
of	O
the	O
distance	O
between	O
two	O
rotations	O
r1	O
and	O
r2	O
deﬁned	O
to	O
equal	O
to	O
the	O
angle	B
of	O
the	O
rotation	B
r1r−1	O
2	O
.	O
(	O
v	O
)	O
any	O
rotation	B
may	O
be	O
represented	O
as	O
r	O
(	O
t	O
)	O
for	O
some	O
t	O
such	O
that	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
≤	O
π.	O
that	O
is	O
,	O
any	O
rotation	B
is	O
a	O
rotation	B
through	O
an	O
angle	B
of	O
at	O
most	O
π	O
radians	O
about	O
some	O
axis	O
.	O
the	O
mapping	O
t	O
(	O
cid:6	O
)	O
→	O
r	O
(	O
t	O
)	O
is	O
one-to-one	O
for	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
<	O
π	O
and	O
two-to-one	O
for	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
<	O
2π	O
.	O
if	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
2π	O
,	O
then	O
r	O
(	O
t	O
)	O
is	O
the	O
identity	O
map	O
,	O
regardless	O
of	O
t.	O
thus	O
,	O
the	O
parametrization	B
has	O
a	O
singularity	O
at	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
2π	O
.	O
in	O
parametrizing	O
rotations	B
by	O
a	O
vector	O
t	O
it	O
is	O
best	O
to	O
maintain	O
the	O
condition	O
that	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
≤π	O
,	O
in	O
order	O
to	O
keep	O
away	O
from	O
the	O
singularity	O
when	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
2π	O
.	O
if	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
>	O
π	O
,	O
then	O
it	O
may	O
be	O
replaced	O
by	O
the	O
vector	O
(	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
−2π	O
)	O
t/	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
t	O
(	O
1	O
−	O
2π/	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
)	O
,	O
which	O
represents	O
the	O
same	O
rotation	O
.	O
(	O
vi	O
)	O
normalization	B
:	O
a6.9.2	O
parametrization	B
of	I
homogeneous	O
vectors	O
the	O
quaternion	O
representation	B
of	O
a	O
rotation	B
(	O
section	O
a4.3.3	O
(	O
p585	O
)	O
)	O
is	O
a	O
redundant	O
rep-	O
resentation	O
in	O
that	O
it	O
contains	O
4	O
parameters	B
where	O
3	O
will	O
sufﬁce	O
.	O
the	O
angle-axis	O
repre-	O
sentation	O
on	O
the	O
other	O
hand	O
is	O
a	O
minimum	O
parametrization	B
.	O
many	O
entities	O
in	O
projective	O
geometry	O
are	O
represented	O
by	O
homogeneous	O
quantities	O
,	O
either	O
vectors	O
or	O
matrices	O
,	O
for	O
instance	O
points	O
in	O
projective	B
space	O
or	O
the	O
fundamental	B
matrix	I
to	O
name	O
a	O
few	O
.	O
for	O
com-	O
putational	O
purposes	O
,	O
it	O
is	O
possible	O
to	O
represent	O
such	O
quantities	O
as	O
vectors	O
with	O
a	O
min-	O
a6.9	O
parametrization	B
625	O
imum	O
number	O
of	O
parameters	O
in	O
a	O
similar	O
way	O
to	O
which	O
the	O
angle-axis	O
representation	O
gives	O
an	O
alternative	O
to	O
the	O
quaternion	O
representation	B
of	O
a	O
rotation	B
.	O
let	O
v	O
be	O
a	O
vector	O
of	O
any	O
dimension	O
,	O
and	O
represent	O
by	O
¯v	O
the	O
unit	O
vector	O
(	O
sinc	O
(	O
(	O
cid:10	O
)	O
v	O
(	O
cid:10	O
)	O
/2	O
)	O
vt	O
,	O
cos	O
(	O
(	O
cid:10	O
)	O
v	O
(	O
cid:10	O
)	O
/2	O
)	O
)	O
t.	O
this	O
mapping	O
v	O
(	O
cid:6	O
)	O
→	O
¯v	O
maps	O
the	O
disk	O
of	O
radius	O
π	O
(	O
that	O
is	O
,	O
the	O
set	O
of	O
vectors	O
of	O
length	O
at	O
most	O
π	O
)	O
smoothly	O
and	O
one-to-one	O
onto	O
the	O
set	O
of	O
unit	O
vectors	O
¯v	O
with	O
non-negative	O
ﬁnal	O
coordinate	O
.	O
thus	O
,	O
it	O
provides	O
a	O
mapping	O
onto	O
the	O
set	O
of	B
homogeneous	I
vectors	I
.	O
the	O
only	O
difﬁcult	O
point	B
with	O
this	O
mapping	O
is	O
that	O
it	O
takes	O
any	O
vector	O
of	O
length	O
2π	O
to	O
the	O
same	O
vector	O
(	O
0	O
,	O
−1	O
)	O
t.	O
however	O
,	O
this	O
singular	O
point	O
may	O
be	O
avoided	O
by	O
renormalizing	O
any	O
vector	O
v	O
of	O
length	O
(	O
cid:10	O
)	O
v	O
(	O
cid:10	O
)	O
>	O
π	O
,	O
replacing	O
it	O
with	O
(	O
(	O
cid:10	O
)	O
v	O
(	O
cid:10	O
)	O
−2	O
π	O
)	O
v/	O
(	O
cid:10	O
)	O
v	O
(	O
cid:10	O
)	O
which	O
represents	O
the	O
same	O
homogeneous	O
vector	O
¯v	O
.	O
a6.9.3	O
parametrization	B
of	I
the	O
n-sphere	O
commonly	O
it	O
occurs	O
in	O
geometric	O
optimization	O
problems	O
that	O
some	O
vector	O
of	O
parame-	O
ters	O
is	O
required	O
to	O
lie	O
on	O
a	O
unit	O
sphere	O
.	O
as	O
an	O
example	O
,	O
consider	O
a	O
complete	O
euclidean	O
bundle-adjustment	O
with	O
two	O
views	O
.	O
the	O
two	O
cameras	O
may	O
be	O
taken	O
as	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
=	O
[	O
r|t	O
]	O
,	O
where	O
r	O
is	O
a	O
rotation	O
and	O
t	O
is	O
a	O
translation	O
.	O
in	O
addition	O
,	O
3d	O
points	O
xi	O
are	O
p	O
(	O
cid:2	O
)	O
deﬁned	O
,	O
which	O
are	O
to	O
map	O
via	O
the	O
two	O
camera	B
matrices	I
to	O
image	O
points	O
.	O
this	O
deﬁnes	O
an	O
optimization	O
problem	O
in	O
which	O
the	O
parameters	B
are	O
r	O
,	O
t	O
and	O
the	O
points	O
xi	O
,	O
and	O
the	O
cost	O
to	O
be	O
minimized	O
is	O
a	O
geometric	B
residual	O
of	O
the	O
projections	O
with	O
respect	O
to	O
the	O
image	O
mea-	O
surements	O
.	O
in	O
this	O
problem	O
,	O
there	O
is	O
an	O
overall	O
scale	O
ambiguity	B
,	O
and	O
this	O
is	O
conveniently	O
resolved	O
by	O
requiring	O
that	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
1.	O
a	O
minimum	O
parametrization	B
for	O
the	O
rotation	B
matrix	O
r	O
is	O
given	O
by	O
the	O
rota-	O
tion	O
parametrization	B
of	I
section	O
a6.9.1	O
.	O
similarly	O
,	O
the	O
points	O
xi	O
are	O
conveniently	O
parametrized	O
as	O
homogeneous	O
4-vectors	O
,	O
using	O
the	O
parametrization	B
of	I
section	O
a6.9.2	O
.	O
we	O
consider	O
in	O
this	O
section	O
how	O
one	O
may	O
parametrize	O
the	O
unit	O
vector	O
t.	O
note	O
that	O
we	O
can	O
not	O
simply	O
parametrize	O
t	O
as	O
a	O
homogeneous	O
vector	O
,	O
since	O
change	O
of	O
sign	O
of	O
t	O
changes	O
the	O
projection	B
p	O
(	O
cid:2	O
)	O
x	O
=	O
[	O
r|t	O
]	O
x.	O
the	O
same	O
problem	O
arises	O
in	O
multiple-view	O
euclidean	O
bundle-adjustment	O
.	O
in	O
this	O
case	O
we	O
have	O
many	O
camera	B
matrices	I
pi	O
=	O
[	O
ri|ti	O
]	O
and	O
we	O
may	O
ﬁx	O
p0	O
=	O
[	O
i	O
|	O
0	O
]	O
.	O
the	O
set	O
of	O
translations	O
ti	O
for	O
all	O
i	O
>	O
0	O
are	O
subject	O
to	O
scale	O
ambiguity	B
.	O
we	O
can	O
minimally	O
parametrize	O
the	O
translations	O
by	O
requiring	O
that	O
(	O
cid:10	O
)	O
t	O
(	O
cid:10	O
)	O
=	O
1	O
,	O
where	O
t	O
is	O
the	O
vector	O
formed	O
by	O
concatenating	O
all	O
the	O
ti	O
for	O
i	O
>	O
0.	O
there	O
may	O
be	O
several	O
ways	O
of	O
parametrizing	O
a	O
unit	O
vector	O
.	O
we	O
consider	O
one	O
particular	O
parametrization	B
here	O
based	O
on	O
a	O
local	O
parametrization	B
of	I
the	O
tangent	O
plane	O
to	O
the	O
unit	O
sphere	O
.	O
we	O
consider	O
a	O
sphere	O
of	O
dimension	O
n	O
,	O
which	O
consists	O
of	O
the	O
set	O
of	O
(	O
n	O
+	O
1	O
)	O
-	O
vectors	O
of	O
unit	O
length	O
.	O
let	O
x	O
be	O
a	O
such	O
a	O
vector	O
.	O
let	O
hv	O
(	O
x	O
)	O
be	O
a	O
householder	O
matrix	B
(	O
see	O
section	O
a4.1.2	O
(	O
p580	O
)	O
)	O
such	O
that	O
hv	O
(	O
x	O
)	O
x	O
=	O
(	O
0	O
,	O
.	O
.	O
.	O
,0	O
,	O
1	O
)	O
t.	O
thus	O
,	O
we	O
have	O
transformed	O
the	O
vector	O
x	O
to	O
lie	O
along	O
the	O
coordinate	O
axis	O
.	O
now	O
,	O
we	O
consider	O
a	O
parametrization	B
of	I
the	O
unit	O
sphere	O
in	O
the	O
vicinity	O
of	O
(	O
0	O
,	O
.	O
.	O
.	O
,0	O
,	O
1	O
)	O
t.	O
such	O
a	O
parametrization	B
is	O
a	O
map	O
irn	O
→	O
sn	O
that	O
is	O
well	O
behaved	O
in	O
the	O
vicinity	O
of	O
the	O
origin	O
.	O
there	O
are	O
many	O
choices	O
,	O
of	O
which	O
two	O
possibilities	O
are	O
(	O
i	O
)	O
f	O
(	O
y	O
)	O
=	O
ˆy/	O
(	O
cid:10	O
)	O
ˆy	O
(	O
cid:10	O
)	O
where	O
ˆy	O
=	O
(	O
yt	O
,	O
1	O
)	O
t	O
(	O
ii	O
)	O
f	O
(	O
y	O
)	O
=	O
(	O
sinc	O
(	O
(	O
cid:10	O
)	O
y	O
(	O
cid:10	O
)	O
/2	O
)	O
yt	O
,	O
cos	O
(	O
(	O
cid:10	O
)	O
y	O
(	O
cid:10	O
)	O
)	O
/2	O
)	O
t	O
.	O
appendix	O
6	O
iterative	B
estimation	I
methods	O
626	O
both	O
these	O
functions	O
map	O
the	O
origin	O
(	O
0	O
,	O
.	O
.	O
.	O
,0	O
)	O
t	O
to	O
(	O
0	O
,	O
.	O
.	O
.	O
,0	O
,	O
1	O
)	O
t	O
,	O
and	O
their	O
jacobian	O
is	O
∂f	O
/∂y	O
=	O
[	O
i|0	O
]	O
t.	O
note	O
that	O
although	O
we	O
are	O
interested	O
in	O
these	O
functions	O
just	O
as	O
local	O
parametrizations	O
,	O
the	O
ﬁrst	O
provides	O
a	O
parametrization	B
for	O
half	O
the	O
sphere	O
,	O
whereas	O
for	O
(	O
cid:10	O
)	O
y	O
(	O
cid:10	O
)	O
≤π	O
the	O
second	O
map	O
parametrizes	O
the	O
whole	O
of	O
the	O
sphere	O
with	O
no	O
singularity	O
except	O
at	O
(	O
cid:10	O
)	O
y	O
(	O
cid:10	O
)	O
=	O
2π	O
.	O
the	O
composite	O
map	O
y	O
(	O
cid:6	O
)	O
→	O
hv	O
(	O
x	O
)	O
f	O
(	O
y	O
)	O
provides	O
a	O
local	O
parametrization	O
for	O
a	O
neigh-	O
bourhood	O
of	O
the	O
point	O
x	O
on	O
the	O
sphere	O
(	O
note	O
here	O
that	O
we	O
should	O
write	O
h−1	O
v	O
(	O
x	O
)	O
,	O
but	O
v	O
(	O
x	O
)	O
)	O
.	O
the	O
jacobian	O
of	O
this	O
map	O
is	O
simply	O
hv	O
(	O
x	O
)	O
[	O
i|0	O
]	O
t	O
,	O
which	O
consists	O
of	O
hv	O
(	O
x	O
)	O
=	O
h−1	O
the	O
ﬁrst	O
n	O
columns	O
of	O
the	O
householder	O
matrix	B
,	O
and	O
hence	O
is	O
easy	O
to	O
compute	O
.	O
in	O
minimization	O
problems	O
,	O
we	O
usually	O
need	O
to	O
compute	O
a	O
jacobian	O
matrix	B
∂c/∂y	O
,	O
of	O
a	O
vector	O
valued	O
cost	B
function	I
c	O
with	O
respect	O
to	O
a	O
set	O
of	O
parameters	O
y.	O
in	O
the	O
case	O
where	O
the	O
parameters	B
are	O
constrainted	O
to	O
lie	O
on	O
a	O
sphere	O
s	O
n	O
in	O
irn+1	O
the	O
cost	B
function	I
is	O
nonetheless	O
usually	O
deﬁned	O
for	O
all	O
values	O
of	O
the	O
parameter	O
x	O
in	O
irn+1	O
.	O
as	O
an	O
example	O
,	O
in	O
the	O
euclidean	O
bundle-adjustment	O
problem	O
considered	O
at	O
the	O
start	O
of	O
this	O
section	O
,	O
the	O
cost	B
function	I
(	O
for	O
instance	O
residual	B
reprojection	O
error	B
)	O
can	O
be	O
deﬁned	O
for	O
all	O
pairs	O
of	O
cameras	O
p	O
=	O
[	O
i	O
|	O
0	O
]	O
and	O
p	O
(	O
cid:2	O
)	O
=	O
[	O
r|t	O
]	O
with	O
t	O
taking	O
any	O
value	O
.	O
nevertheless	O
,	O
we	O
may	O
wish	O
to	O
minimize	O
the	O
cost	B
function	I
constraining	O
t	O
to	O
lie	O
on	O
a	O
sphere	O
.	O
thus	O
,	O
consider	O
the	O
case	O
where	O
a	O
cost	B
function	I
c	O
(	O
x	O
)	O
is	O
deﬁned	O
for	O
x	O
∈	O
irn+1	O
,	O
but	O
we	O
parametrize	O
x	O
to	O
lie	O
on	O
a	O
sphere	O
by	O
setting	O
x	O
=	O
hv	O
(	O
x	O
)	O
f	O
(	O
y	O
)	O
with	O
y	O
∈	O
irn	O
.	O
in	O
this	O
case	O
,	O
we	O
see	O
that	O
hv	O
(	O
x	O
)	O
[	O
i|0	O
]	O
t.	O
j	O
=	O
∂c	O
∂y	O
=	O
∂c	O
∂x	O
∂x	O
∂y	O
=	O
∂c	O
∂x	O
in	O
summary	O
,	O
by	O
using	O
local	O
parametrizations	O
,	O
a	O
parameter	O
vector	O
may	O
be	O
constrained	O
to	O
lie	O
on	O
an	O
n-sphere	O
with	O
a	O
modest	O
added	O
computational	O
cost	O
compared	O
with	O
the	O
over-	O
parametrization	B
of	I
allowing	O
the	O
vector	O
to	O
vary	O
over	O
the	O
whole	O
of	O
irn+1	O
.	O
the	O
key	O
points	O
of	O
the	O
method	O
are	O
as	O
follows	O
.	O
(	O
i	O
)	O
store	O
the	O
parameter	O
vector	O
x	O
∈	O
irn+1	O
,	O
satisfying	O
(	O
cid:10	O
)	O
x	O
(	O
cid:10	O
)	O
=	O
1	O
.	O
(	O
ii	O
)	O
in	O
forming	O
the	O
linear	B
update	O
equations	O
,	O
compute	O
the	O
jacobian	O
matrix	B
∂c/∂x	O
,	O
and	O
multiply	O
it	O
by	O
hv	O
(	O
x	O
)	O
[	O
i|0	O
]	O
t	O
to	O
obtain	O
the	O
jacobian	O
with	O
respect	O
to	O
a	O
minimal	O
parameter	O
set	O
y.	O
multiplication	O
of	O
∂c/∂x	O
by	O
hv	O
(	O
x	O
)	O
[	O
i|0	O
]	O
t	O
is	O
efﬁciently	O
carried	O
out	O
by	O
the	O
method	O
of	O
(	O
a4.4–p580	O
)	O
.	O
(	O
iii	O
)	O
the	O
iteration	B
step	O
provides	O
an	O
increment	O
parameter	O
vector	O
δy	O
.	O
compute	O
the	O
new	O
value	O
of	O
x	O
=	O
hv	O
(	O
x	O
)	O
f	O
(	O
δy	O
)	O
.	O
essentially	O
the	O
same	O
method	O
of	O
using	O
local-parametrizations	O
may	O
be	O
used	O
more	O
gen-	O
erally	O
in	O
other	O
situations	O
where	O
a	O
minimal	O
parametrization	O
is	O
required	O
.	O
for	O
instance	O
,	O
in	O
section	O
11.4.2	O
(	O
p285	O
)	O
it	O
was	O
seen	O
how	O
the	O
fundamental	B
matrix	I
may	O
be	O
parametrized	O
locally	O
with	O
a	O
minimum	O
number	O
of	O
parameters	O
,	O
but	O
no	O
minimal	O
parametrization	B
can	O
cover	O
the	O
whole	O
set	O
of	O
fundamental	O
matrices	O
.	O
a6.10	O
notes	O
and	O
exercises	O
(	O
i	O
)	O
we	O
prove	O
in	O
various	O
steps	O
the	O
form	B
of	I
the	O
pseudo-inverse	B
of	O
a	O
block	O
matrix	B
given	O
in	O
(	O
a6.13–p606	O
)	O
.	O
a6.10	O
notes	O
and	O
exercises	O
627	O
−1gt	O
if	O
and	O
only	O
if	O
nl	O
(	O
g	O
)	O
=	O
nl	O
(	O
h	O
)	O
(	O
see	O
(	O
a	O
)	O
recall	O
that	O
h+	O
=	O
g	O
(	O
gthg	O
)	O
(	O
b	O
)	O
let	O
g	O
be	O
invertible	O
.	O
then	O
(	O
ghgt	O
)	O
+	O
=	O
g−th+g−1	O
if	O
and	O
only	O
if	O
section	O
a5.2	O
(	O
p590	O
)	O
)	O
.	O
nl	O
(	O
h	O
)	O
gt	O
=	O
nl	O
(	O
h	O
)	O
g−1	O
.	O
(	O
c	O
)	O
applying	O
this	O
condition	O
to	O
(	O
a6.12–p605	O
)	O
the	O
necessary	O
and	O
sufﬁcient	O
condition	O
for	O
(	O
a6.13–p606	O
)	O
to	O
be	O
valid	O
is	O
that	O
nl	O
(	O
u	O
−	O
wv−1wt	O
)	O
⊆	O
nl	O
(	O
y	O
)	O
=	O
nl	O
(	O
w	O
)	O
.	O
equivalent	B
to	O
the	O
condition	O
span	O
(	O
a	O
)	O
∩	O
span	O
(	O
b	O
)	O
=∅	O
.	O
(	O
d	O
)	O
with	O
u	O
,	O
v	O
and	O
w	O
deﬁned	O
in	O
terms	O
of	O
a	O
and	O
b	O
as	O
in	O
(	O
a6.11–p605	O
)	O
this	O
is	O
(	O
ii	O
)	O
investigate	O
conditions	O
under	O
which	O
the	O
condition	O
span	O
(	O
a	O
)	O
∩	O
span	O
(	O
b	O
)	O
=	O
∅	O
is	O
true	O
.	O
it	O
may	O
be	O
interpreted	O
as	O
meaning	O
that	O
the	O
effects	O
of	O
varying	O
the	O
parameters	B
a	O
(	O
for	O
instance	O
camera	B
parameters	I
)	O
and	O
the	O
effects	O
of	O
varying	O
b	O
(	O
point	B
parameters	O
)	O
can	O
not	O
be	O
complementary	O
.	O
clearly	O
this	O
is	O
not	O
the	O
case	O
with	O
(	O
for	O
instance	O
)	O
un-	O
constrained	O
projective	B
reconstruction	I
where	O
both	O
cameras	O
and	O
points	O
may	O
vary	O
without	O
affecting	O
the	O
measurements	O
.	O
in	O
such	O
a	O
case	O
,	O
the	O
variance	B
of	O
parameters	B
a	O
and	O
b	O
is	O
inﬁnite	O
in	O
directions	O
δa	O
and	O
δb	O
such	O
that	O
aδa	O
=	O
bδb	O
.	O
appendix	O
7	O
some	O
special	O
plane	O
projective	B
transformations	O
projective	B
transformations	O
(	O
homographies	B
)	O
can	O
be	O
classiﬁed	O
according	O
to	O
the	O
algebraic	B
and	O
geometric	B
multiplicity	O
of	O
their	O
eigenvalues	O
.	O
the	O
algebraic	B
multiplicity	O
of	O
an	O
eigen-	O
value	O
is	O
the	O
number	O
of	O
times	O
the	O
root	O
is	O
repeated	O
in	O
the	O
characteristic	O
equation	O
.	O
the	O
geometric	B
multiplicity	O
may	O
be	O
determined	O
from	O
the	O
rank	O
of	O
the	O
matrix	O
(	O
h	O
−	O
λi	O
)	O
,	O
where	O
h	O
is	O
the	O
homography	B
and	O
λ	O
the	O
eigenvalue	O
.	O
a	O
complete	O
classiﬁcation	B
is	O
given	O
in	O
projec-	O
tive	O
geometry	O
textbooks	O
such	O
as	O
[	O
springer-64	O
]	O
.	O
here	O
we	O
mention	O
several	O
special	O
cases	O
which	O
are	O
important	O
in	O
practical	O
situations	O
,	O
and	O
occur	O
at	O
several	O
points	O
throughout	O
this	O
book	O
.	O
the	O
description	O
will	O
be	O
for	O
plane	O
transformations	O
where	O
h	O
is	O
a	O
3	O
×	O
3	O
matrix	B
,	O
but	O
the	O
generalization	O
to	O
3-space	O
transformations	O
is	O
straightforward	O
.	O
the	O
special	O
forms	O
are	O
signiﬁcant	O
because	O
h	O
satisﬁes	O
a	O
number	O
of	O
relationships	O
(	O
re-	O
member	O
the	O
only	O
restriction	O
a	O
general	B
projective	I
transformation	O
is	O
that	O
it	O
has	O
full	O
rank	O
)	O
.	O
since	O
h	O
satisﬁes	O
constraints	B
it	O
has	O
fewer	O
degrees	B
of	I
freedom	I
,	O
and	O
consequently	O
can	O
be	O
computed	O
from	O
fewer	O
correspondences	B
than	O
a	O
general	B
projective	I
transformation	O
.	O
the	O
special	O
transformations	O
also	O
have	O
richer	O
geometry	O
and	O
invariants	B
than	O
in	O
the	O
general	O
case	O
.	O
note	O
that	O
unlike	O
the	O
special	O
forms	O
(	O
afﬁne	B
etc	O
.	O
)	O
discussed	O
in	O
chapter	O
2	O
,	O
which	O
form	O
subgroups	O
,	O
the	O
following	O
special	O
projectivities	O
do	O
not	O
form	O
subgroups	O
in	O
general	O
since	O
they	O
are	O
not	O
closed	O
under	O
multiplication	O
.	O
they	O
do	O
form	O
a	O
subgroup	O
if	O
all	O
the	O
elements	O
have	O
coincident	O
ﬁxed	B
points	I
and	O
lines	B
(	O
i.e	O
.	O
differing	O
only	O
in	O
their	O
eigenvalues	O
)	O
.	O
a7.1	O
conjugate	O
rotations	O
a	O
rotation	B
matrix	O
r	O
has	O
eigenvalues	O
{	O
1	O
,	O
eiθ	O
,	O
e	O
−iθ	O
}	O
,	O
with	O
corresponding	O
eigenvectors	O
{	O
a	O
,	O
i	O
,	O
j	O
}	O
,	O
where	O
a	O
is	O
the	O
rotation	B
axis	O
,	O
i.e	O
.	O
ra	O
=	O
a	O
,	O
θ	O
is	O
the	O
angle	B
of	O
rotation	B
about	O
the	O
axis	O
,	O
and	O
i	O
and	O
j	O
(	O
which	O
are	O
complex	O
conjugate	O
)	O
are	O
the	O
circular	B
points	I
for	O
the	O
plane	B
orthogonal	O
to	O
a.	O
suppose	O
a	O
projective	B
transformation	I
between	O
two	O
planes	O
has	O
the	O
form	O
h	O
=	O
t	O
r	O
t−1	O
with	O
t	O
a	O
general	B
projective	I
transformation	O
;	O
then	O
h	O
is	O
a	O
conjugate	O
rotation	O
.	O
eigenval-	O
ues	O
are	O
preserved	O
under	O
a	O
conjugate	O
relationship1	O
so	O
the	O
eigenvalues	O
of	O
the	O
projective	O
transformation	B
h	O
are	O
also	O
{	O
1	O
,	O
eiθ	O
,	O
e	O
−iθ	O
}	O
up	O
to	O
a	O
common	O
scale	O
.	O
1	O
conjugacy	B
is	O
also	O
referred	O
to	O
as	O
a	O
“	O
similarity	B
transformation	I
”	O
.	O
this	O
meaning	O
of	O
“	O
similarity	B
”	O
is	O
unrelated	O
to	O
its	O
use	O
in	O
this	O
book	O
as	O
an	O
isometry	O
plus	O
scaling	B
transformation	O
.	O
628	O
a7.2	O
planar	O
homologies	O
629	O
e	O
1	O
v	O
=	O
vertex	O
(	O
fixed	O
point	B
)	O
fixed	O
lines	B
a	O
=	O
axis	O
(	O
line	B
of	O
fixed	O
points	O
)	O
e	O
3	O
e	O
2	O
fig	O
.	O
a7.1	O
.	O
a	O
planar	B
homology	I
.	O
a	O
planar	B
homology	I
is	O
a	O
plane	B
projective	O
transformation	B
which	O
has	O
a	O
line	B
a	O
of	O
ﬁxed	O
points	O
,	O
called	O
the	O
axis	O
,	O
and	O
a	O
distinct	O
ﬁxed	O
point	O
v	O
,	O
not	O
on	O
the	O
line	B
,	O
called	O
the	O
centre	B
or	O
vertex	O
of	O
the	O
homology	O
.	O
there	O
is	O
a	O
pencil	O
of	O
ﬁxed	O
lines	B
through	O
the	O
vertex	O
.	O
algebraically	O
,	O
two	O
of	O
the	O
eigenvalues	O
of	O
the	O
transformation	O
matrix	B
are	O
equal	O
,	O
and	O
the	O
ﬁxed	O
line	O
corresponds	O
to	O
the	O
2d	O
invariant	O
space	O
of	O
the	O
matrix	B
(	O
here	O
the	O
repeated	O
eigenvalues	O
are	O
λ2	O
and	O
λ3	O
)	O
.	O
consider	O
two	O
images	O
obtained	O
by	O
a	O
camera	B
rotating	O
about	O
its	O
centre	B
(	O
as	O
in	O
ﬁgure	O
2.5-	O
(	O
p36	O
)	O
b	O
)	O
;	O
then	O
as	O
shown	O
in	O
section	O
8.4.2	O
(	O
p204	O
)	O
,	O
the	O
images	O
are	O
related	O
by	O
a	O
conjugate	O
rotation	O
.	O
in	O
this	O
case	O
the	O
complex	O
eigenvalues	O
determine	O
the	O
angle	B
(	O
θ	O
)	O
through	O
which	O
the	O
camera	B
rotates	O
,	O
and	O
the	O
eigenvector	O
corresponding	O
to	O
the	O
real	O
eigenvalue	O
is	O
the	O
vanishing	O
point	O
of	O
the	O
rotation	O
axis	O
.	O
note	O
that	O
θ	O
–	O
a	O
metric	B
invariant	O
–	O
can	O
be	O
measured	O
directly	O
from	O
the	O
projective	B
transformation	I
.	O
a7.2	O
planar	O
homologies	O
a	O
plane	B
projective	O
transformation	B
h	O
is	O
a	O
planar	B
homology	I
if	O
it	O
has	O
a	O
line	B
of	O
ﬁxed	B
points	I
(	O
called	O
the	O
axis	O
)	O
,	O
together	O
with	O
a	O
ﬁxed	O
point	O
(	O
called	O
the	O
vertex	O
)	O
not	O
on	O
the	O
line	B
,	O
see	O
ﬁgure	O
a7.1	O
.	O
algebraically	O
,	O
the	O
matrix	B
has	O
two	O
equal	O
and	O
one	O
distinct	O
eigenvalues	O
and	O
the	O
eigenspace	O
corresponding	O
to	O
the	O
equal	O
eigenvalues	O
is	O
two-dimensional	B
.	O
the	O
axis	O
is	O
the	O
line	B
through	O
the	O
two	O
eigenvectors	O
(	O
i.e	O
.	O
points	O
)	O
spanning	O
this	O
eigenspace	O
.	O
the	O
vertex	O
corresponds	O
to	O
the	O
other	O
eigenvector	O
.	O
the	O
ratio	O
of	O
the	O
distinct	O
eigenvalue	O
to	O
the	O
repeated	O
one	O
is	O
a	O
characteristic	O
invariant	O
µ	O
of	O
the	O
homology	O
(	O
i.e	O
.	O
the	O
eigenvalues	O
are	O
,	O
up	O
to	O
a	O
common	O
scale	O
factor	O
,	O
{	O
µ	O
,	O
1	O
,	O
1	O
}	O
)	O
.	O
properties	B
of	O
a	O
planar	B
homology	I
include	O
:	O
•	O
lines	B
joining	O
corresponding	O
points	O
intersect	O
at	O
the	O
vertex	O
,	O
and	O
corresponding	O
lines	B
(	O
i.e	O
.	O
lines	B
through	O
two	O
pairs	O
of	O
corresponding	O
points	O
)	O
intersect	O
on	O
the	O
axis	O
.	O
this	O
is	O
an	O
example	O
of	O
desargues	O
’	O
theorem	O
.	O
see	O
ﬁgure	O
a7.2a	O
.	O
•	O
the	O
cross	O
ratios	O
deﬁned	O
by	O
the	O
vertex	O
,	O
a	O
pair	O
of	O
corresponding	O
points	O
,	O
and	O
the	O
inter-	O
section	O
of	O
the	O
line	O
joining	O
these	O
points	O
with	O
the	O
line	B
of	O
ﬁxed	B
points	I
,	O
are	O
the	O
same	O
for	O
all	O
points	O
related	O
by	O
the	O
homology	B
.	O
see	O
ﬁgure	O
a7.2b	O
.	O
•	O
for	O
curves	O
related	O
by	O
a	O
planar	B
homology	I
,	O
corresponding	O
tangents	O
(	O
the	O
limit	O
of	O
neigh-	O
bouring	O
points	O
deﬁning	O
corresponding	O
lines	B
)	O
intersect	O
on	O
the	O
axis	O
.	O
•	O
the	O
vertex	O
(	O
2	O
dof	O
)	O
,	O
axis	O
(	O
2	O
dof	O
)	O
and	O
invariant	O
(	O
1	O
dof	O
)	O
are	O
sufﬁcient	O
to	O
deﬁne	O
the	O
homology	B
completely	O
.	O
a	O
planar	B
homology	I
thus	O
has	O
5	O
degrees	B
of	I
freedom	I
.	O
630	O
appendix	O
7	O
some	O
special	O
plane	O
projective	B
transformations	O
vertex	O
v	O
/	O
x1	O
/x	O
2	O
x	O
2	O
a	O
h	O
x	O
1	O
v	O
x	O
/	O
1	O
x	O
/	O
2	O
axis	O
a	O
x	O
1	O
p	O
12	O
x	O
2	O
i	O
2	O
a	O
b	O
i	O
1	O
fig	O
.	O
a7.2	O
.	O
homology	B
transformation	O
.	O
(	O
a	O
)	O
under	O
the	O
transformation	B
points	O
on	O
the	O
axis	O
are	O
mapped	O
to	O
themselves	O
;	O
each	O
point	B
off	O
the	O
axis	O
lies	O
on	O
a	O
ﬁxed	O
line	B
through	O
v	O
intersecting	O
a	O
and	O
is	O
mapped	O
to	O
another	O
point	B
on	O
the	O
line	B
.	O
consequently	O
,	O
corresponding	O
point	B
pairs	O
x	O
↔	O
x	O
(	O
cid:1	O
)	O
and	O
the	O
vertex	O
of	O
the	O
homology	O
are	O
collinear	O
.	O
corresponding	O
lines	B
–	O
i.e	O
.	O
lines	B
through	O
pairs	O
of	O
corresponding	O
points	O
–	O
intersect	O
on	O
the	O
axis	O
:	O
for	O
example	O
,	O
the	O
lines	B
(	O
cid:8	O
)	O
x1	O
,	O
x2	O
(	O
cid:9	O
)	O
and	O
(	O
cid:8	O
)	O
x	O
(	O
cid:1	O
)	O
(	O
b	O
)	O
the	O
cross	B
ratio	I
deﬁned	O
by	O
the	O
vertex	O
v	O
,	O
the	O
corresponding	O
points	O
x	O
,	O
x	O
(	O
cid:1	O
)	O
and	O
the	O
intersection	B
of	O
their	O
join	O
with	O
the	O
axis	O
i	O
,	O
is	O
thecharacteristic	O
invariant	O
of	O
the	O
homology	O
,	O
and	O
is	O
the	O
same	O
for	O
all	O
corresponding	O
points	O
.	O
for	O
example	O
,	O
the	O
cross	O
ratios	O
of	O
the	O
four	O
points	O
{	O
v	O
,	O
x	O
(	O
cid:1	O
)	O
2	O
,	O
x2	O
,	O
i2	O
}	O
are	O
equal	O
since	O
they	O
are	O
perspectively	O
related	O
by	O
lines	B
concurrent	O
at	O
p12	O
.	O
it	O
follows	O
that	O
the	O
cross	B
ratio	I
is	O
the	O
same	O
for	O
all	O
points	O
related	O
by	O
the	O
homology	B
.	O
•	O
3	O
matched	O
points	O
are	O
sufﬁcient	O
to	O
compute	O
a	O
planar	B
homology	I
.	O
the	O
6	O
degrees	O
of	O
free-	O
dom	O
of	O
the	O
point	O
matches	O
over-constrain	O
the	O
5	O
degrees	B
of	I
freedom	I
of	O
the	O
homology	B
.	O
1	O
,	O
x1	O
,	O
i1	O
}	O
and	O
{	O
v	O
,	O
x	O
(	O
cid:1	O
)	O
2	O
(	O
cid:9	O
)	O
.	O
1	O
,	O
x	O
(	O
cid:1	O
)	O
a	O
planar	B
homology	I
arises	O
naturally	O
in	O
an	O
image	O
of	O
two	O
planes	O
related	O
by	O
a	O
perspectiv-	O
ity	O
of	O
3-space	O
(	O
i.e	O
.	O
lines	B
joining	O
corresponding	O
points	O
on	O
the	O
two	O
planes	O
are	O
concurrent	B
)	O
.	O
an	O
example	O
is	O
the	O
transformation	B
between	O
the	O
image	O
of	O
a	O
planar	O
object	O
and	O
the	O
image	O
of	O
its	O
shadow	O
on	O
a	O
plane	O
.	O
in	O
this	O
case	O
the	O
axis	O
is	O
the	O
imaged	O
intersection	B
of	O
the	O
two	O
planes	O
,	O
and	O
the	O
vertex	O
is	O
the	O
image	O
of	O
the	O
light	O
source	O
,	O
see	O
ﬁgure	O
2.5	O
(	O
p36	O
)	O
c.	O
parametrization	B
.	O
the	O
projective	B
transformation	I
representing	O
the	O
homology	B
can	O
be	O
parametrized	O
directly	O
in	O
terms	O
of	O
the	O
3-vectors	O
representing	O
the	O
axis	O
a	O
and	O
vertex	O
v	O
,	O
and	O
the	O
characteristic	O
ratio	O
µ	O
,	O
as	O
where	O
i	O
is	O
the	O
identity	O
.	O
it	O
is	O
straightforward	O
to	O
verify	O
that	O
the	O
inverse	O
transformation	B
is	O
given	O
by	O
vat	O
vta	O
h	O
=	O
i	O
+	O
(	O
µ	O
−	O
1	O
)	O
(	O
cid:21	O
)	O
−	O
1	O
(	O
cid:20	O
)	O
h−1	O
=	O
i	O
+	O
1	O
µ	O
vat	O
vta	O
.	O
the	O
eigenvectors	O
are	O
{	O
e1	O
=	O
v	O
,	O
e2	O
=	O
a⊥	O
1	O
,	O
e3	O
=	O
a⊥	O
2	O
}	O
a7.3	O
elations	O
631	O
with	O
corresponding	O
eigenvalues	O
{	O
λ1	O
=	O
µ	O
,	O
λ2	O
=	O
1	O
,	O
λ3	O
=	O
1	O
}	O
i	O
are	O
two	O
vectors	O
that	O
span	O
the	O
space	O
orthogonal	O
to	O
the	O
3-vector	O
a	O
,	O
i.e	O
.	O
ata⊥	O
i	O
=	O
0	O
where	O
a⊥	O
and	O
a	O
=	O
a⊥	O
1	O
×	O
a⊥	O
2	O
.	O
if	O
the	O
axis	O
or	O
the	O
vertex	O
is	O
at	B
inﬁnity	I
then	O
the	O
homology	B
is	O
an	O
afﬁne	B
transformation	I
.	O
algebraically	O
,	O
if	O
a	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
,	O
then	O
the	O
axis	O
is	O
at	B
inﬁnity	I
;	O
or	O
if	O
v	O
=	O
(	O
v1	O
,	O
v2	O
,	O
0	O
)	O
t	O
,	O
then	O
the	O
vertex	O
is	O
at	B
inﬁnity	I
;	O
and	O
in	O
both	O
cases	O
the	O
transformation	B
matrix	O
h	O
has	O
last	O
row	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
.	O
planar	B
harmonic	I
homology	I
.	O
a	O
specialization	O
of	O
a	O
planar	O
homology	B
is	O
the	O
case	O
that	O
the	O
cross	B
ratio	I
is	O
harmonic	O
(	O
µ	O
=	O
−1	O
)	O
.	O
this	O
planar	B
homology	I
is	O
called	O
a	O
planar	B
harmonic	I
homology	I
and	O
has	O
4	O
degrees	B
of	I
freedom	I
since	O
the	O
invariant	O
is	O
known	O
.	O
the	O
transforma-	O
tion	O
matrix	B
h	O
obeys	O
h2	O
=	O
i	O
,	O
i.e	O
.	O
the	O
transformation	B
is	O
a	O
square	O
root	O
of	O
the	O
identity	O
,	O
which	O
is	O
called	O
an	O
involution	O
(	O
also	O
a	O
collineation	B
of	O
period	O
2	O
)	O
.	O
the	O
eigenvalues	O
are	O
,	O
up	O
to	O
a	O
common	O
scale	O
factor	O
,	O
{	O
−1	O
,	O
1	O
,	O
1	O
}	O
.	O
two	O
pairs	O
of	O
point	O
correspondences	B
determine	O
h.	O
in	O
a	O
perspective	O
image	O
of	O
a	O
plane	B
object	O
with	O
a	O
bilateral	O
symmetry	O
,	O
corresponding	O
points	O
in	O
the	O
image	O
are	O
related	O
by	O
a	O
planar	B
harmonic	I
homology	I
.	O
the	O
axis	O
of	O
the	O
ho-	O
mology	O
is	O
the	O
image	O
of	O
the	O
symmetry	O
axis	O
.	O
algebraically	O
,	O
h	O
is	O
a	O
conjugate	O
reﬂection	O
where	O
the	O
conjugating	O
element	O
is	O
a	O
plane	B
projective	O
transformation	B
.	O
in	O
an	O
afﬁne	B
image	O
(	O
generated	O
by	O
an	O
afﬁne	B
camera	I
)	O
the	O
resulting	O
transformation	B
is	O
a	O
skewed	O
symmetry	O
,	O
and	O
the	O
conjugating	O
element	O
is	O
a	O
plane	B
afﬁne	O
transformation	B
.	O
for	O
a	O
skewed	O
symmetry	O
the	O
vertex	O
is	O
at	B
inﬁnity	I
,	O
and	O
the	O
lines	B
joining	O
corresponding	O
points	O
are	O
parallel	B
.	O
the	O
harmonic	O
homology	B
can	O
be	O
parametrized	O
as	O
h	O
=	O
h−1	O
=	O
i	O
−	O
2	O
vat	O
vta	O
.	O
again	O
,	O
if	O
the	O
axis	O
or	O
vertex	O
is	O
at	B
inﬁnity	I
then	O
the	O
transformation	B
is	O
afﬁne	B
.	O
a7.3	O
elations	O
an	O
elation	B
has	O
a	O
line	B
of	O
ﬁxed	B
points	I
(	O
the	O
axis	O
)	O
,	O
and	O
a	O
pencil	O
of	O
ﬁxed	O
lines	B
intersecting	O
in	O
a	O
point	B
(	O
the	O
vertex	O
)	O
on	O
the	O
axis	O
.	O
it	O
may	O
be	O
thought	O
of	O
as	O
the	O
limit	O
of	O
a	O
homology	B
where	O
the	O
vertex	O
is	O
on	O
the	O
line	B
of	O
ﬁxed	B
points	I
.	O
algebraically	O
,	O
the	O
matrix	B
has	O
three	O
equal	O
eigenvalues	O
,	O
but	O
the	O
eigenspace	O
is	O
2-dimensional	O
.	O
it	O
may	O
be	O
parametrized	O
as	O
h	O
=	O
i	O
+	O
µvat	O
with	O
atv	O
=	O
0	O
(	O
a7.1	O
)	O
where	O
a	O
is	O
the	O
axis	O
,	O
and	O
v	O
the	O
vertex	O
.	O
the	O
eigenvalues	O
are	O
all	O
unity	O
.	O
the	O
invariant	O
space	O
of	O
h	O
is	O
spanned	O
by	O
a⊥	O
2	O
.	O
this	O
is	O
a	O
line	B
(	O
pencil	O
)	O
of	O
ﬁxed	O
points	O
(	O
which	O
includes	O
v	O
since	O
atv	O
=	O
0	O
)	O
.	O
the	O
invariant	O
space	O
of	O
ht	O
is	O
spanned	O
by	O
vectors	O
v⊥	O
2	O
orthogonal	B
to	O
v.	O
this	O
is	O
a	O
pencil	O
of	O
ﬁxed	O
lines	B
,	O
l	O
=	O
αv⊥	O
2	O
,	O
for	O
which	O
ltv	O
=	O
0	O
,	O
i.e	O
.	O
all	O
lines	B
of	O
the	O
pencil	O
are	O
concurrent	B
at	O
the	O
point	B
v.	O
1	O
+	O
βv⊥	O
1	O
,	O
v⊥	O
1	O
,	O
a⊥	O
an	O
elation	B
has	O
4	O
degrees	B
of	I
freedom	I
:	O
one	O
less	O
than	O
a	O
homology	B
due	O
to	O
the	O
constraint	O
atv	O
=	O
0.	O
it	O
is	O
deﬁned	O
by	O
the	O
axis	O
a	O
(	O
2	O
dof	O
)	O
,	O
the	O
vertex	O
v	O
on	O
a	O
(	O
1	O
dof	O
)	O
and	O
the	O
parameter	O
µ	O
(	O
1	O
dof	O
)	O
.	O
it	O
can	O
be	O
determined	O
from	O
2	O
point	B
correspondences	O
.	O
632	O
appendix	O
7	O
some	O
special	O
plane	O
projective	B
transformations	O
/	O
x	O
c	O
b	O
a	O
a	O
b	O
c	O
x	O
fig	O
.	O
a7.3	O
.	O
a	O
line	B
perspectivity	O
.	O
the	O
lines	B
joining	O
corresponding	O
points	O
(	O
a	O
,	O
a	O
etc	O
.	O
)	O
are	O
concurrent	B
.	O
compare	O
with	O
ﬁgure	O
a7.4	O
.	O
elations	O
often	O
arise	O
in	O
practice	O
as	O
conjugate	O
translations	O
.	O
consider	O
a	O
pattern	O
on	O
a	O
plane	O
that	O
repeats	O
by	O
a	O
translation	O
t	O
=	O
(	O
tx	O
,	O
ty	O
)	O
t	O
,	O
for	O
example	O
identical	O
windows	O
on	O
the	O
wall	O
of	O
a	O
building	O
.	O
this	O
action	O
is	O
represented	O
on	O
the	O
plane	B
of	O
the	O
wall	O
as	O
(	O
cid:17	O
)	O
(	O
cid:18	O
)	O
he	O
=	O
t	O
i	O
0t	O
1	O
which	O
is	O
an	O
elation	B
where	O
v	O
=	O
(	O
tx	O
,	O
ty	O
,	O
0	O
)	O
t	O
is	O
the	O
translation	O
direction	O
of	O
the	O
repetition	O
,	O
and	O
a	O
=	O
(	O
0	O
,	O
0	O
,	O
1	O
)	O
t	O
is	O
the	O
line	B
at	I
inﬁnity	I
.	O
in	O
an	O
image	O
of	O
the	O
wall	O
the	O
windows	O
are	O
related	O
by	O
a	O
conjugate	O
translation	O
h	O
=	O
t	O
he	O
t−1	O
,	O
where	O
t	O
is	O
the	O
projectivity	B
which	O
maps	O
the	O
plane	B
of	O
the	O
wall	O
to	O
the	O
image	O
.	O
the	O
image	O
transformation	O
h	O
is	O
also	O
an	O
elation	B
.	O
the	O
vertex	O
of	O
this	O
elation	B
is	O
the	O
vanishing	O
point	O
of	O
the	O
translation	O
direction	O
,	O
and	O
the	O
axis	O
is	O
the	O
vanishing	O
line	O
of	O
the	O
wall	O
plane	B
.	O
a7.4	O
perspectivities	O
one	O
other	O
special	O
case	O
of	O
a	O
projectivity	O
is	O
a	O
perspectivity	O
,	O
which	O
is	O
shown	O
in	O
ﬁgure	O
a7.3	O
for	O
a	O
1d	O
projectivity	B
on	O
the	O
plane	B
.	O
the	O
distinctive	O
property	O
of	O
a	O
perspectivity	O
is	O
that	O
lines	B
joining	O
corresponding	O
points	O
are	O
concurrent	B
.	O
the	O
difference	O
between	O
a	O
perspec-	O
tivity	O
and	O
projectivity	B
is	O
made	O
clear	O
by	O
considering	O
the	O
composition	O
of	O
two	O
perspectiv-	O
ities	O
.	O
as	O
shown	O
in	O
ﬁgure	O
a7.4	O
the	O
composition	O
of	O
two	O
perspectivities	O
is	O
not	O
in	O
general	O
a	O
perspectivity	O
.	O
however	O
,	O
the	O
composition	O
is	O
a	O
projectivity	B
because	O
a	O
perspectivity	O
is	O
a	O
projectivity	B
,	O
and	O
projectivities	O
form	O
a	O
group	O
(	O
closed	O
)	O
,	O
so	O
that	O
the	O
composition	O
of	O
two	O
projectivities	O
is	O
a	O
projectivity	B
.	O
to	O
summarize	O
:	O
•	O
the	O
composition	O
of	O
two	O
(	O
or	O
more	O
)	O
perspectivities	O
is	O
a	O
projectivity	B
,	O
but	O
not	O
,	O
in	O
general	O
,	O
a	O
perspectivity	O
.	O
a	O
central	B
projection	I
image	O
of	O
a	O
world	O
plane	B
,	O
as	O
in	O
ﬁgure	O
2.3	O
(	O
p34	O
)	O
,	O
is	O
an	O
example	O
of	O
a	O
2d	O
perspectivity	O
between	O
different	O
planes	O
.	O
notice	O
that	O
identifying	O
the	O
projectivity	B
as	O
a	O
perspectivity	O
requires	O
the	O
embedding	O
of	O
the	O
planes	O
in	O
3-space	O
.	O
finally	O
,	O
imagine	O
that	O
the	O
planes	O
and	O
camera	B
centre	I
of	O
ﬁgure	O
2.3	O
(	O
p34	O
)	O
are	O
mapped	O
(	O
by	O
another	O
perspectivity	O
)	O
onto	O
one	O
of	O
the	O
planes	O
.	O
then	O
this	O
imaged	O
perspectivity	O
is	O
now	O
a	O
map	O
between	O
points	O
on	O
the	O
same	O
plane	O
,	O
and	O
is	O
seen	O
to	O
be	O
a	O
planar	B
homology	I
(	O
section	O
a7.2	O
)	O
.	O
a7.4	O
perspectivities	O
633	O
x	O
c	O
b	O
a	O
image	O
1	O
p	O
r	O
q	O
x	O
/	O
/	O
a	O
/	O
b	O
/	O
c	O
image	O
2	O
a	O
b	O
c	O
fig	O
.	O
a7.4	O
.	O
a	O
line	B
projectivity	O
.	O
points	O
{	O
a	O
,	O
b	O
,	O
c	O
}	O
are	O
related	O
to	O
points	O
{	O
a	O
,	O
b	O
,	O
c	O
}	O
by	O
a	O
line–to–line	O
per-	O
spectivity	O
.	O
points	O
{	O
a	O
(	O
cid:1	O
)	O
,	O
c	O
(	O
cid:1	O
)	O
}	O
are	O
also	O
related	O
to	O
points	O
{	O
a	O
,	O
b	O
,	O
c	O
}	O
by	O
a	O
perspectivity	O
.	O
however	O
,	O
points	O
{	O
a	O
,	O
b	O
,	O
c	O
}	O
are	O
related	O
to	O
points	O
{	O
a	O
(	O
cid:1	O
)	O
,	O
c	O
(	O
cid:1	O
)	O
}	O
by	O
a	O
projectivity	B
;	O
they	O
are	O
not	O
related	O
by	O
a	O
perspectivity	O
be-	O
cause	O
lines	B
joining	O
corresponding	O
points	O
are	O
not	O
concurrent	B
.	O
in	O
fact	O
the	O
pairwise	O
intersections	O
result	O
in	O
three	O
distinct	O
points	O
{	O
p	O
,	O
q	O
,	O
r	O
}	O
.	O
,	O
b	O
(	O
cid:1	O
)	O
,	O
b	O
(	O
cid:1	O
)	O
further	O
reading	O
.	O
[	O
springer-64	O
]	O
classiﬁes	O
projectivities	O
and	O
covers	O
special	O
cases	O
,	O
e.g	O
.	O
planar	O
homologies	O
.	O
planar	O
homologies	O
appear	O
in	O
many	O
guises	O
:	O
modelling	O
im-	O
aged	O
shadow	O
relations	O
in	O
[	O
vangool-98	O
]	O
;	O
modelling	O
imaged	O
extruded	O
surfaces	O
in	O
[	O
zisserman-95a	O
]	O
;	O
and	O
modelling	O
relations	O
for	O
planar	O
pose	O
recovery	O
in	O
[	O
basri-99	O
]	O
.	O
the	O
parametrization	B
of	I
planar	O
homologies	O
is	O
given	O
in	O
vi´eville	O
and	O
lingrand	O
[	O
vieville-95	O
]	O
.	O
elations	O
appear	O
in	O
the	O
grouping	O
of	O
imaged	O
repeated	O
patterns	O
on	O
a	O
plane	O
[	O
schaffalitzky-99	O
,	O
schaffalitzky-00b	O
]	O
and	O
in	O
3-space	O
they	O
appear	O
in	O
the	O
generalized	O
bas-relief	B
ambiguity	I
[	O
kriegman-98	O
]	O
.	O
bibliography	O
[	O
agrawal-03	O
]	O
m.	O
agrawal	O
and	O
l.	O
davis	O
.	O
camera	B
calibration	I
using	O
spheres	O
:	O
a	O
dual-space	O
approach	O
.	O
research	O
report	O
car-tr-984	O
,	O
center	O
for	O
automation	O
research	O
,	O
university	O
of	O
maryland	O
,	O
2003	O
.	O
[	O
aloimonos-90	O
]	O
j.	O
y.	O
aloimonos	O
.	O
perspective	O
approximations	O
.	O
image	O
and	O
vision	O
computing	B
,	O
8	O
(	O
3	O
)	O
:177–	O
192	O
,	O
august	O
1990	O
.	O
[	O
anandan-02	O
]	O
p.	O
anandan	O
and	O
m.	O
irani	O
.	O
factorization	B
with	O
uncertainty	O
.	O
international	O
journal	O
of	O
com-	O
puter	O
vision	O
,	O
49	O
(	O
2/3	O
)	O
:101–116	O
,	O
2002	O
.	O
[	O
armstrong-94	O
]	O
m.	O
armstrong	O
,	O
a.	O
zisserman	O
,	O
and	O
p.	O
beardsley	O
.	O
euclidean	O
reconstruction	O
from	O
uncali-	O
brated	O
images	O
.	O
in	O
proc	O
.	O
british	O
machine	O
vision	O
conference	O
,	O
pages	O
509–518	O
,	O
1994	O
.	O
[	O
armstrong-96a	O
]	O
m.	O
armstrong	O
.	O
self-calibration	O
from	O
image	O
sequences	O
.	O
phd	O
thesis	O
,	O
university	O
of	O
oxford	O
,	O
england	O
,	O
1996	O
.	O
[	O
armstrong-96b	O
]	O
m.	O
armstrong	O
,	O
a.	O
zisserman	O
,	O
and	O
r.	O
hartley	O
.	O
self-calibration	O
from	O
image	O
triplets	O
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
1064/5	O
,	O
pages	O
3–16	O
.	O
springer-verlag	O
,	O
1996	O
.	O
[	O
astrom-98	O
]	O
k.	O
˚astr¨om	O
and	O
a.	O
heyden	O
.	O
continuous	O
time	O
matching	B
constraints	O
for	O
image	O
streams	O
.	O
inter-	O
national	O
journal	O
of	O
computer	O
vision	O
,	O
28	O
(	O
1	O
)	O
:85–96	O
,	O
1998	O
.	O
[	O
avidan-98	O
]	O
s.	O
avidan	O
and	O
a.	O
shashua	O
.	O
threading	O
fundamental	O
matrices	O
.	O
in	O
proc	O
.	O
5th	O
european	O
con-	O
ference	O
on	O
computer	O
vision	O
,	O
freiburg	O
,	O
germany	O
,	O
pages	O
124–140	O
,	O
1998	O
.	O
[	O
baillard-99	O
]	O
c.	O
baillard	O
and	O
a.	O
zisserman	O
.	O
automatic	O
reconstruction	B
of	O
piecewise	O
planar	O
models	O
from	O
multiple	O
views	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
559–	O
565	O
,	O
june	O
1999	O
.	O
[	O
barrett-92	O
]	O
e.	O
b.	O
barrett	O
,	O
m.	O
h.	O
brill	O
,	O
n.	O
n.	O
haag	O
,	O
and	O
p.	O
m.	O
payton	O
.	O
invariant	O
linear	B
methods	O
in	O
pho-	O
togrammetry	O
and	O
model-matching	O
.	O
in	O
j.	O
l.	O
mundy	O
and	O
a.	O
zisserman	O
,	O
editors	O
,	O
geometric	B
invariance	O
in	O
computer	O
vision	O
.	O
mit	O
press	O
,	O
cambridge	O
,	O
1992	O
.	O
[	O
bascle-98	O
]	O
b.	O
bascle	O
and	O
a.	O
blake	O
.	O
separability	O
of	O
pose	O
and	O
expression	O
in	O
facial	O
tracing	O
and	O
animation	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
323–328	O
,	O
1998	O
.	O
[	O
basri-99	O
]	O
r.	O
basri	O
and	O
d.	O
jacobs	O
.	O
projective	B
alignment	O
with	O
regions	O
.	O
in	O
proc	O
.	O
7th	O
international	O
confer-	O
ence	O
on	O
computer	O
vision	O
,	O
kerkyra	O
,	O
greece	O
,	O
pages	O
1158–1164	O
,	O
1999	O
.	O
[	O
bathe-76	O
]	O
k-j	O
.	O
bathe	O
and	O
e.	O
wilson	O
.	O
numerical	O
methods	O
in	O
ﬁnite	B
element	O
analysis	O
.	O
prentice	O
hall	O
,	O
1976.	O
insight	O
[	O
beardsley-92	O
]	O
p.	O
a.	O
beardsley	O
,	O
d.	O
sinclair	O
,	O
and	O
a.	O
zisserman	O
.	O
ego-motion	O
from	B
six	I
points	I
.	O
meeting	O
,	O
catholic	O
university	O
leuven	O
,	O
february	O
1992	O
.	O
[	O
beardsley-94	O
]	O
p.	O
a.	O
beardsley	O
,	O
a.	O
zisserman	O
,	O
and	O
d.	O
w.	O
murray	O
.	O
navigation	O
using	O
afﬁne	O
structure	B
and	O
motion	O
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
800/801	O
,	O
pages	O
85–96	O
.	O
springer-	O
verlag	O
,	O
1994	O
.	O
[	O
beardsley-95a	O
]	O
p.	O
a.	O
beardsley	O
and	O
a.	O
zisserman	O
.	O
afﬁne	B
calibration	O
of	O
mobile	O
vehicles	O
.	O
in	O
europe–	O
china	O
workshop	O
on	O
geometrical	O
modelling	O
and	O
invariants	B
for	O
computer	O
vision	O
,	O
pages	O
214–221	O
.	O
xidan	O
university	O
press	O
,	O
xi	O
’	O
an	O
,	O
china	O
,	O
1995	O
.	O
[	O
beardsley-95b	O
]	O
p.	O
a.	O
beardsley	O
,	O
i.	O
d.	O
reid	O
,	O
a.	O
zisserman	O
,	O
and	O
d.	O
w.	O
murray	O
.	O
active	O
visual	O
navigation	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
58–64	O
,	O
using	O
non-metric	O
structure	B
.	O
1995	O
.	O
634	O
bibliography	O
635	O
[	O
beardsley-96	O
]	O
p.	O
a.	O
beardsley	O
,	O
p.	O
h.	O
s.	O
torr	O
,	O
and	O
a.	O
zisserman	O
.	O
3d	O
model	B
aquisition	O
from	O
extended	O
image	O
sequences	O
.	O
in	O
proc	O
.	O
4th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
1065	O
,	O
cambridge	O
,	O
pages	O
683–695	O
,	O
1996	O
.	O
[	O
blake-87	O
]	O
a.	O
blake	O
and	O
a.	O
zisserman	O
.	O
visual	O
reconstruction	B
.	O
mit	O
press	O
,	O
cambridge	O
,	O
usa	O
,	O
august	O
1987	O
.	O
[	O
boehm-94	O
]	O
w.	O
boehm	O
and	O
h.	O
prautzsch	O
.	O
geometric	B
concepts	O
for	O
geometric	O
design	O
.	O
a.	O
k.	O
peters	O
,	O
1994	O
.	O
[	O
bookstein-79	O
]	O
f.	O
bookstein	O
.	O
fitting	O
conic	B
sections	O
to	O
scattered	O
data	O
.	O
computer	O
graphics	O
and	O
image	O
processing	O
,	O
9:56–71	O
,	O
1979	O
.	O
[	O
bougnoux-98	O
]	O
s.	O
bougnoux	O
.	O
from	O
projective	O
to	O
euclidean	O
space	O
under	O
any	O
practical	O
situation	O
,	O
a	O
criti-	O
cism	O
of	O
self-calibration	O
.	O
in	O
proc	O
.	O
6th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
790–796	O
,	O
january	O
1998	O
.	O
[	O
boult-91	O
]	O
i.	O
e.	O
boult	O
and	O
l.	O
gottesfeld	O
brown	O
.	O
factorisation-based	O
segmentation	O
of	O
motions	O
.	O
in	O
proc	O
.	O
ieee	O
workshop	O
on	O
visual	O
motion	O
,	O
1991	O
.	O
[	O
brand-01	O
]	O
m.	O
brand	O
.	O
morphable	O
3d	O
models	O
from	O
video	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
ii	O
:	O
456–463	O
,	O
2001	O
.	O
[	O
brown-71	O
]	O
d.	O
c.	O
brown	O
.	O
close-range	O
camera	B
calibration	I
.	O
photogrammetric	O
engineering	O
,	O
37	O
(	O
8	O
)	O
:855–	O
866	O
,	O
1971	O
.	O
[	O
buchanan-88	O
]	O
t.	O
buchanan	O
.	O
the	O
twisted	B
cubic	I
and	O
camera	B
calibration	I
.	O
computer	O
vision	O
,	O
graphics	O
and	O
image	O
processing	O
,	O
42:130–132	O
,	O
1988	O
.	O
[	O
buchanan-92	O
]	O
t.	O
buchanan	O
.	O
critical	O
sets	O
for	O
3d	O
reconstruction	B
using	O
lines	B
.	O
in	O
proc	O
.	O
european	O
confer-	O
ence	O
on	O
computer	O
vision	O
,	O
lncs	O
588	O
,	O
pages	O
730–738	O
.	O
springer-verlag	O
,	O
1992	O
.	O
[	O
canny-86	O
]	O
j.	O
f.	O
canny	O
.	O
a	O
computational	O
approach	O
to	O
edge	O
detection	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
8	O
(	O
6	O
)	O
:679–698	O
,	O
1986	O
.	O
[	O
capel-98	O
]	O
d.	O
capel	O
and	O
a.	O
zisserman	O
.	O
automated	O
mosaicing	O
with	O
super-resolution	O
zoom	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
santa	O
barbara	O
,	O
pages	O
885–891	O
,	O
june	O
1998	O
.	O
[	O
caprile-90	O
]	O
b.	O
caprile	O
and	O
v.	O
torre	O
.	O
using	O
vanishing	O
points	O
for	O
camera	B
calibration	I
.	O
international	O
jour-	O
nal	O
of	O
computer	O
vision	O
,	O
4:127–140	O
,	O
1990	O
.	O
[	O
carlsson-93	O
]	O
s.	O
carlsson	O
.	O
multiple	O
image	O
invariance	O
using	O
the	O
double	O
algebra	O
.	O
in	O
applications	O
of	O
in-	O
variance	B
in	O
computer	O
vision	O
,	O
volume	O
sln	O
comp	O
.	O
science	O
vol	O
825	O
,	O
pages	O
335–350	O
,	O
1993	O
.	O
[	O
carlsson-94	O
]	O
s.	O
carlsson	O
.	O
multiple	O
image	O
invariance	O
using	O
the	O
double	O
algebra	O
.	O
in	O
j.	O
mundy	O
,	O
a.	O
zisser-	O
man	O
,	O
and	O
d.	O
forsyth	O
,	O
editors	O
,	O
applications	O
of	O
invariance	O
in	O
computer	O
vision	O
lncs	O
825.	O
springer-	O
verlag	O
,	O
1994	O
.	O
[	O
carlsson-95	O
]	O
s.	O
carlsson	O
.	O
duality	B
of	O
reconstruction	B
and	O
positioning	O
from	O
projective	O
views	O
.	O
in	O
ieee	O
workshop	O
on	O
representation	O
of	O
visual	O
scenes	O
,	O
boston	O
,	O
1995	O
.	O
[	O
carlsson-98	O
]	O
s.	O
carlsson	O
and	O
d.	O
weinshall	O
.	O
dual	B
computation	O
of	O
projective	O
shape	O
and	O
camera	B
positions	O
from	O
multiple	O
images	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
27	O
(	O
3	O
)	O
:227–241	O
,	O
1998	O
.	O
[	O
christy-96	O
]	O
s.	O
christy	O
and	O
r.	O
horaud	O
.	O
euclidean	O
shape	O
and	O
motion	O
from	O
multiple	O
perspective	O
views	O
by	O
afﬁne	B
iteration	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
18	O
(	O
11	O
)	O
:1098–1104	O
,	O
november	O
1996	O
.	O
[	O
chum-03	O
]	O
o.	O
chum	O
,	O
t.	O
werner	O
,	O
and	O
t.	O
pajdla	O
.	O
on	O
joint	O
orientation	B
of	O
epipoles	B
.	O
research	O
report	O
ctu–	O
cmp–2003–10	O
,	O
center	O
for	O
machine	O
perception	O
,	O
k333	O
fee	O
czech	O
technical	O
university	O
,	O
prague	O
,	O
czech	O
republic	O
,	O
april	O
2003	O
.	O
[	O
cipolla-99	O
]	O
r.	O
cipolla	O
,	O
t.	O
drummond	O
,	O
and	O
d.	O
robertson	O
.	O
camera	B
calibration	I
from	O
vanishing	B
points	I
in	O
images	O
of	O
architectural	O
scenes	O
.	O
in	O
proc	O
.	O
british	O
machine	O
vision	O
conference	O
,	O
september	O
1999	O
.	O
[	O
collins-93	O
]	O
r.	O
t.	O
collins	O
and	O
j.	O
r.	O
beveridge	O
.	O
matching	B
perspective	O
views	O
of	O
coplanar	O
structures	O
using	O
projective	O
unwarping	O
and	O
similarity	B
matching	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
1993	O
.	O
[	O
costeira-98	O
]	O
j.p.	O
costeira	O
and	O
t.	O
kanade	O
.	O
a	O
multibody	O
factorization	B
method	O
for	O
independently	O
moving	B
objects	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
29	O
(	O
3	O
)	O
:159–179	O
,	O
1998	O
.	O
[	O
criminisi-98	O
]	O
a.	O
criminisi	O
,	O
i.	O
reid	O
,	O
and	O
a.	O
zisserman	O
.	O
duality	B
,	O
rigidity	O
and	O
planar	O
parallax	O
.	O
in	O
proc	O
.	O
636	O
bibliography	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
846–861	O
.	O
springer-verlag	O
,	O
june	O
1998	O
.	O
[	O
criminisi-99a	O
]	O
a.	O
criminisi	O
,	O
i.	O
reid	O
,	O
and	O
a.	O
zisserman	O
.	O
single	B
view	I
metrology	O
.	O
in	O
proc	O
.	O
7th	O
interna-	O
tional	O
conference	O
on	O
computer	O
vision	O
,	O
kerkyra	O
,	O
greece	O
,	O
pages	O
434–442	O
,	O
september	O
1999	O
.	O
[	O
criminisi-99b	O
]	O
a.	O
criminisi	O
,	O
i.	O
reid	O
,	O
and	O
a.	O
zisserman	O
.	O
a	O
plane	B
measuring	O
device	O
.	O
image	O
and	O
vision	O
computing	B
,	O
17	O
(	O
8	O
)	O
:625–634	O
,	O
1999	O
.	O
[	O
criminisi-00	O
]	O
a.	O
criminisi	O
,	O
i.	O
reid	O
,	O
and	O
a.	O
zisserman	O
.	O
single	B
view	I
metrology	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
40	O
(	O
2	O
)	O
:123–148	O
,	O
november	O
2000	O
.	O
[	O
criminisi-01	O
]	O
a.	O
criminisi	O
.	O
accurate	O
visual	O
metrology	O
from	O
single	O
and	O
multiple	O
uncalibrated	O
images	O
.	O
distinguished	O
dissertation	O
series	O
.	O
springer-verlag	O
london	O
ltd.	O
,	O
july	O
2001.	O
isbn	O
:	O
1852334681	O
.	O
[	O
cross-98	O
]	O
g.	O
cross	O
and	O
a.	O
zisserman	O
.	O
quadric	O
surface	O
reconstruction	B
from	O
dual-space	O
geometry	O
.	O
in	O
proc	O
.	O
6th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
25–31	O
,	O
january	O
1998	O
.	O
[	O
cross-99	O
]	O
g.	O
cross	O
,	O
a.	O
w.	O
fitzgibbon	O
,	O
and	O
a.	O
zisserman	O
.	O
parallax	B
geometry	O
of	O
smooth	O
surfaces	O
in	O
multiple	O
views	O
.	O
in	O
proc	O
.	O
7th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
kerkyra	O
,	O
greece	O
,	O
pages	O
323–329	O
,	O
september	O
1999	O
.	O
[	O
csurka-97	O
]	O
g.	O
csurka	O
,	O
c.	O
zeller	O
,	O
z.	O
zhang	O
,	O
and	O
o.	O
d.	O
faugeras	O
.	O
characterizing	O
the	O
uncertainty	O
of	O
the	O
fundamental	O
matrix	B
.	O
computer	O
vision	O
and	O
image	O
understanding	O
,	O
68	O
(	O
1	O
)	O
:18–36	O
,	O
october	O
1997	O
.	O
[	O
csurka-98	O
]	O
g.	O
csurka	O
,	O
d.	O
demirdjian	O
,	O
a.	O
ruf	O
,	O
and	O
r.	O
horaud	O
.	O
closed-form	O
solutions	O
for	O
the	O
euclidean	O
calibration	O
of	B
a	I
stereo	I
rig	I
.	O
in	O
proc	O
.	O
5th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
freiburg	O
,	O
germany	O
,	O
pages	O
426–442	O
,	O
june	O
1998	O
.	O
[	O
deagapito-98	O
]	O
l.	O
de	O
agapito	O
,	O
e.	O
hayman	O
,	O
and	O
i.	O
reid	O
.	O
self-calibration	O
of	O
a	O
rotating	O
camera	B
with	O
varying	O
intrinsic	O
parameters	B
.	O
in	O
proc	O
.	O
9th	O
british	O
machine	O
vision	O
conference	O
,	O
southampton	O
,	O
1998	O
.	O
[	O
deagapito-99	O
]	O
l.	O
de	O
agapito	O
,	O
r.	O
i.	O
hartley	O
,	O
and	O
e.	O
hayman	O
.	O
linear	B
self-calibration	O
of	O
a	O
rotating	O
and	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
zooming	O
camera	B
.	O
15–21	O
,	O
1999	O
.	O
[	O
dementhon-95	O
]	O
d.	O
dementhon	O
and	O
l.	O
davis	O
.	O
model	B
based	O
pose	O
in	O
25	O
lines	B
of	O
code	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
15	O
(	O
1/2	O
)	O
:123–141	O
,	O
1995	O
.	O
[	O
devernay-95	O
]	O
f.	O
devernay	O
and	O
o.	O
d.	O
faugeras	O
.	O
automatic	O
calibration	B
and	O
removal	O
of	O
distortion	O
from	O
scenes	O
of	O
structured	O
environments	O
.	O
in	O
spie	O
,	O
volume	O
2567	O
,	O
san	O
diego	O
,	O
ca	O
,	O
july	O
1995	O
.	O
[	O
devernay-96	O
]	O
f.	O
devernay	O
and	O
o.	O
d.	O
faugeras	O
.	O
from	O
projective	O
to	O
euclidean	O
reconstruction	B
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
264–269	O
,	O
1996	O
.	O
[	O
faugeras-90	O
]	O
o.	O
d.	O
faugeras	O
and	O
s.	O
j.	O
maybank	O
.	O
motion	O
from	O
point	O
matches	O
:	O
multiplicity	O
of	O
solutions	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
4:225–246	O
,	O
1990	O
.	O
[	O
faugeras-92a	O
]	O
o.	O
d.	O
faugeras	O
,	O
q.	O
luong	O
,	O
and	O
s.	O
maybank	O
.	O
camera	B
self-calibration	O
:	O
theory	O
and	O
exper-	O
iments	O
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
588	O
,	O
pages	O
321–334	O
.	O
springer-	O
verlag	O
,	O
1992	O
.	O
[	O
faugeras-92b	O
]	O
o.	O
d.	O
faugeras	O
.	O
what	O
can	O
be	O
seen	O
in	O
three	O
dimensions	O
with	O
an	O
uncalibrated	O
stereo	O
rig	O
?	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
588	O
,	O
pages	O
563–578	O
.	O
springer-verlag	O
,	O
1992	O
.	O
[	O
faugeras-93	O
]	O
o.	O
d.	O
faugeras	O
.	O
three-dimensional	O
computer	O
vision	O
:	O
a	O
geometric	B
viewpoint	O
.	O
mit	O
press	O
,	O
1993	O
.	O
[	O
faugeras-94	O
]	O
o.	O
d.	O
faugeras	O
and	O
l.	O
robert	O
.	O
what	O
can	O
two	O
images	O
tell	O
us	O
about	O
a	O
third	O
one	O
.	O
in	O
j.	O
o.	O
eckland	O
,	O
editor	O
,	O
proc	O
.	O
3rd	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
stockholm	O
,	O
pages	O
485–492	O
.	O
springer-verlag	O
,	O
1994	O
.	O
[	O
faugeras-95a	O
]	O
o.	O
d.	O
faugeras	O
and	O
b.	O
mourrain	O
.	O
on	O
the	O
geometry	O
and	O
algebra	O
of	O
point	O
and	O
line	B
cor-	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
respondences	O
between	O
n	O
images	O
.	O
951–962	O
,	O
1995	O
.	O
[	O
faugeras-95b	O
]	O
o.	O
d.	O
faugeras	O
.	O
stratiﬁcation	B
of	O
three-dimensional	O
vision	O
:	O
projective	B
,	O
afﬁne	B
,	O
and	O
metric	B
representation	O
.	O
journal	O
of	O
the	O
optical	O
society	O
of	O
america	O
,	O
a12:465–484	O
,	O
1995	O
.	O
[	O
faugeras-95c	O
]	O
o.	O
d.	O
faugeras	O
,	O
s.	O
laveau	O
,	O
l.	O
robert	O
,	O
g.	O
csurka	O
,	O
and	O
c.	O
zeller	O
.	O
3-d	O
reconstruction	B
of	O
urban	O
scenes	O
from	O
sequences	O
of	O
images	O
.	O
technical	O
report	O
,	O
inria	O
,	O
1995	O
.	O
[	O
faugeras-97	O
]	O
o.	O
d.	O
faugeras	O
and	O
t.	O
papadopoulo	O
.	O
grassmann-cayley	O
algebra	O
for	O
modeling	O
systems	O
of	O
cameras	O
and	O
the	O
algebraic	B
equations	O
of	O
the	O
manifold	O
of	O
trifocal	O
tensors	O
.	O
technical	O
report	O
3225	O
,	O
inria	O
,	O
sophia-antipolis	O
,	O
france	O
,	O
1997.	O
bibliography	O
637	O
[	O
faugeras-98	O
]	O
o.	O
d.	O
faugeras	O
,	O
l.	O
quan	O
,	O
and	O
p.	O
sturm	O
.	O
self-calibration	O
of	O
a	O
1d	O
projective	B
camera	I
and	O
its	O
application	O
to	O
the	O
self-calibration	O
of	O
a	O
2d	O
projective	B
camera	I
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
36–52	O
,	O
1998	O
.	O
[	O
fischler-81	O
]	O
m.	O
a.	O
fischler	O
and	O
r.	O
c.	O
bolles	O
.	O
random	O
sample	O
consensus	O
:	O
a	O
paradigm	O
for	O
model	O
ﬁt-	O
ting	O
with	O
applications	O
to	O
image	O
analysis	O
and	O
automated	O
cartography	O
.	O
comm	O
.	O
assoc	O
.	O
comp	O
.	O
mach.	O
,	O
24	O
(	O
6	O
)	O
:381–395	O
,	O
1981	O
.	O
[	O
fitzgibbon-98a	O
]	O
a.	O
w.	O
fitzgibbon	O
and	O
a.	O
zisserman	O
.	O
automatic	O
camera	B
recovery	O
for	O
closed	O
or	O
open	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
311–326	O
.	O
springer-	O
image	O
sequences	O
.	O
verlag	O
,	O
june	O
1998	O
.	O
[	O
fitzgibbon-98b	O
]	O
a.	O
w.	O
fitzgibbon	O
,	O
g.	O
cross	O
,	O
and	O
a.	O
zisserman	O
.	O
automatic	O
3d	O
model	B
construction	O
for	O
turn-table	O
sequences	O
.	O
in	O
r.	O
koch	O
and	O
l.	O
van	O
gool	O
,	O
editors	O
,	O
3d	O
structure	B
from	O
multiple	O
images	O
of	O
large-scale	O
environments	O
,	O
lncs	O
1506	O
,	O
pages	O
155–170	O
.	O
springer-verlag	O
,	O
june	O
1998	O
.	O
[	O
fitzgibbon-99	O
]	O
a.	O
w.	O
fitzgibbon	O
,	O
m.	O
pilu	O
,	O
and	O
r.	O
b.	O
fisher	O
.	O
direct	O
least-squares	O
ﬁtting	O
of	O
ellipses	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
21	O
(	O
5	O
)	O
:476–480	O
,	O
may	O
1999	O
.	O
[	O
gear-98	O
]	O
c.	O
w.	O
gear	O
.	O
multibody	O
grouping	O
from	O
motion	O
images	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
29	O
(	O
2	O
)	O
:133–150	O
,	O
1998	O
.	O
[	O
giblin-87	O
]	O
p.	O
giblin	O
and	O
r.	O
weiss	O
.	O
reconstruction	B
of	O
surfaces	O
from	O
proﬁles	O
.	O
in	O
proc	O
.	O
1st	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
london	O
,	O
pages	O
136–144	O
,	O
london	O
,	O
1987	O
.	O
[	O
gill-78	O
]	O
p.	O
e.	O
gill	O
and	O
w.	O
murray	O
.	O
algorithms	O
for	O
the	O
solution	B
of	O
the	O
nonlinear	O
least-squares	O
problem	O
.	O
siam	O
j	O
num	O
anal	O
,	O
15	O
(	O
5	O
)	O
:977–992	O
,	O
1978	O
.	O
[	O
golub-89	O
]	O
g.	O
h.	O
golub	O
and	O
c.	O
f.	O
van	O
loan	O
.	O
matrix	B
computations	O
.	O
the	O
johns	O
hopkins	O
university	O
press	O
,	O
baltimore	O
,	O
md	O
,	O
second	O
edition	O
,	O
1989	O
.	O
[	O
gracie-68	O
]	O
g.	O
gracie	O
.	O
analytical	O
photogrammetry	O
applied	O
to	O
single	O
terrestrial	O
photograph	O
mensuration	O
.	O
in	O
xith	O
international	O
conference	O
of	O
photogrammetry	O
,	O
lausanne	O
,	O
switzerland	O
,	O
july	O
1968	O
.	O
[	O
gupta-97	O
]	O
r.	O
gupta	O
and	O
r.	O
i.	O
hartley	O
.	O
linear	B
pushbroom	O
cameras	B
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
september	O
1997	O
.	O
[	O
haralick-91	O
]	O
r.	O
m.	O
haralick	O
,	O
c.	O
lee	O
,	O
k.	O
ottenberg	O
,	O
and	O
m.	O
n¨olle	O
.	O
analysis	O
and	O
solutions	O
of	O
the	O
three	O
point	B
perspective	O
pose	O
estimation	B
problem	I
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pat-	O
tern	O
recognition	O
,	O
pages	O
592–598	O
,	O
1991	O
.	O
[	O
harris-88	O
]	O
c.	O
j.	O
harris	O
and	O
m.	O
stephens	O
.	O
a	O
combined	O
corner	O
and	O
edge	O
detector	O
.	O
in	O
proc	O
.	O
4th	O
alvey	O
vision	O
conference	O
,	O
manchester	O
,	O
pages	O
147–151	O
,	O
1988	O
.	O
[	O
hartley-92a	O
]	O
r.	O
i.	O
hartley	O
.	O
estimation	B
of	I
relative	O
camera	B
positions	O
for	O
uncalibrated	O
cameras	B
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
588	O
,	O
pages	O
579–587	O
.	O
springer-verlag	O
,	O
1992	O
.	O
[	O
hartley-92b	O
]	O
r.	O
i.	O
hartley	O
.	O
invariants	B
of	O
points	O
seen	O
in	O
multiple	O
images	O
.	O
ge	O
internal	B
report	O
,	O
ge	O
crd	O
,	O
schenectady	O
,	O
ny	O
12301	O
,	O
usa	O
,	O
may	O
1992	O
.	O
[	O
hartley-92c	O
]	O
r.	O
i.	O
hartley	O
,	O
r.	O
gupta	O
,	O
and	O
t.	O
chang	O
.	O
stereo	O
from	O
uncalibrated	O
cameras	B
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
1992	O
.	O
[	O
hartley-94a	O
]	O
r.	O
i.	O
hartley	O
.	O
self-calibration	O
from	O
multiple	O
views	O
with	O
a	O
rotating	O
camera	B
.	O
in	O
proc	O
.	O
euro-	O
pean	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
800/801	O
,	O
pages	O
471–478	O
.	O
springer-verlag	O
,	O
1994	O
.	O
[	O
hartley-94b	O
]	O
r.	O
i.	O
hartley	O
.	O
euclidean	O
reconstruction	O
from	O
uncalibrated	O
views	O
.	O
in	O
j.	O
mundy	O
,	O
a.	O
zis-	O
serman	O
,	O
and	O
d.	O
forsyth	O
,	O
editors	O
,	O
applications	O
of	O
invariance	O
in	O
computer	O
vision	O
,	O
lncs	O
825	O
,	O
pages	O
237–256	O
.	O
springer-verlag	O
,	O
1994	O
.	O
[	O
hartley-94c	O
]	O
r.	O
i.	O
hartley	O
.	O
projective	B
reconstruction	I
and	O
invariants	B
from	O
multiple	O
images	O
.	O
ieee	O
trans-	O
actions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
16:1036–1041	O
,	O
october	O
1994	O
.	O
[	O
hartley-94d	O
]	O
r.	O
i.	O
hartley	O
.	O
projective	B
reconstruction	I
from	O
line	B
correspondence	O
.	O
in	O
proc	O
.	O
ieee	O
confer-	O
ence	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
1994	O
.	O
[	O
hartley-95a	O
]	O
r.	O
i.	O
hartley	O
.	O
multilinear	O
relationships	O
between	O
coordinates	O
of	O
corresponding	O
image	O
points	O
and	O
lines	B
.	O
in	O
proceedings	O
of	O
the	O
sophus	O
lie	O
symposium	O
,	O
nordfjordeid	O
,	O
norway	O
(	O
not	O
published	O
yet	O
)	O
,	O
1995	O
.	O
[	O
hartley-95b	O
]	O
r.	O
i.	O
hartley	O
.	O
a	O
linear	B
method	O
for	O
reconstruction	O
from	O
lines	O
and	O
points	O
.	O
in	O
proc	O
.	O
interna-	O
tional	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
882–887	O
,	O
1995	O
.	O
[	O
hartley-97a	O
]	O
r.	O
i.	O
hartley	O
.	O
lines	B
and	O
points	O
in	O
three	O
views	O
and	O
the	O
trifocal	B
tensor	I
.	O
international	O
journal	O
638	O
bibliography	O
of	O
computer	O
vision	O
,	O
22	O
(	O
2	O
)	O
:125–140	O
,	O
1997	O
.	O
[	O
hartley-97b	O
]	O
r.	O
i.	O
hartley	O
and	O
p.	O
sturm	O
.	O
triangulation	B
.	O
computer	O
vision	O
and	O
image	O
understanding	O
,	O
68	O
(	O
2	O
)	O
:146–157	O
,	O
november	O
1997	O
.	O
[	O
hartley-97c	O
]	O
r.	O
i.	O
hartley	O
.	O
in	O
defense	O
of	O
the	O
eight-point	O
algorithm	B
.	O
analysis	O
and	O
machine	O
intelligence	O
,	O
19	O
(	O
6	O
)	O
:580	O
–	O
593	O
,	O
october	O
1997.	O
ieee	O
transactions	O
on	O
pattern	O
[	O
hartley-97d	O
]	O
r.	O
i.	O
hartley	O
.	O
kruppa	O
’	O
s	O
equations	O
derived	O
from	O
the	O
fundamental	B
matrix	I
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
19	O
(	O
2	O
)	O
:133–135	O
,	O
1997	O
.	O
[	O
hartley-97e	O
]	O
r.	O
i.	O
hartley	O
and	O
t.	O
saxena	O
.	O
the	O
cubic	O
rational	O
polynomial	O
camera	B
model	O
.	O
in	O
proc	O
.	O
darpa	O
image	O
understanding	O
workshop	O
,	O
pages	O
649	O
–	O
653	O
,	O
1997	O
.	O
[	O
hartley-98a	O
]	O
r.	O
i.	O
hartley	O
.	O
chirality	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
26	O
(	O
1	O
)	O
:41–61	O
,	O
1998	O
.	O
[	O
hartley-98b	O
]	O
r.	O
i.	O
hartley	O
.	O
dualizing	O
scene	O
reconstruction	O
algorithms	O
.	O
in	O
r.	O
koch	O
and	O
l.	O
van	O
gool	O
,	O
editors	O
,	O
3d	O
structure	B
from	O
multiple	O
images	O
of	O
large-scale	O
environments	O
,	O
lncs	O
1506	O
,	O
pages	O
14–31	O
.	O
springer-verlag	O
,	O
june	O
1998	O
.	O
[	O
hartley-98c	O
]	O
r.	O
i.	O
hartley	O
.	O
computation	B
of	I
the	O
quadrifocal	B
tensor	I
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
1406	O
,	O
pages	O
20–35	O
.	O
springer-verlag	O
,	O
1998	O
.	O
[	O
hartley-98d	O
]	O
r.	O
i.	O
hartley	O
.	O
minimizing	B
algebraic	I
error	O
in	O
geometric	O
estimation	B
problems	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
469–476	O
,	O
1998	O
.	O
[	O
hartley-99	O
]	O
r.	O
hartley	O
,	O
l.	O
de	O
agapito	O
,	O
e.	O
hayman	O
,	O
and	O
i.	O
reid	O
.	O
camera	B
calibration	I
and	O
the	O
search	O
for	O
inﬁnity	O
.	O
in	O
proc	O
.	O
7th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
kerkyra	O
,	O
greece	O
,	O
pages	O
510–517	O
,	O
september	O
1999	O
.	O
[	O
hartley-00a	O
]	O
r.	O
i.	O
hartley	O
and	O
n.	O
y.	O
dano	O
.	O
reconstruction	B
from	O
six-point	O
sequences	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
ii–480	O
–	O
ii–486	O
,	O
2000	O
.	O
[	O
hartley-00b	O
]	O
r.	O
i.	O
hartley	O
.	O
ambiguous	O
conﬁgurations	O
for	O
3-view	O
projective	B
reconstruction	I
.	O
in	O
proc	O
.	O
6th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
part	O
i	O
,	O
lncs	O
1842	O
,	O
dublin	O
,	O
ireland	O
,	O
pages	O
922–935	O
,	O
2000	O
.	O
[	O
hartley-02a	O
]	O
r.	O
hartley	O
and	O
f.	O
kahl	O
.	O
critical	O
curves	O
and	O
surfaces	O
for	O
euclidean	O
reconstruction	B
.	O
in	O
proc	O
.	O
7th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
part	O
ii	O
,	O
lncs	O
2351	O
,	O
copenhagen	O
,	O
denmark	O
,	O
pages	O
447–462	O
,	O
2002	O
.	O
[	O
hartley-02b	O
]	O
r.	O
hartley	O
and	O
r.	O
kaucic	O
.	O
sensitivity	O
of	O
calibration	O
to	O
principal	O
point	B
position	O
.	O
in	O
proc	O
.	O
7th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
copenhagen	O
,	O
denmark	O
,	O
volume	O
2	O
,	O
pages	O
433–446	O
.	O
springer-verlag	O
,	O
2002	O
.	O
[	O
hartley-03	O
]	O
r.	O
hartley	O
and	O
f.	O
kahl	O
.	O
a	O
critical	O
conﬁguration	O
for	O
reconstruction	O
from	O
rectilinear	O
motion	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
2003	O
.	O
[	O
hayman-03	O
]	O
e.	O
hayman	O
,	O
t.	O
th´orhallsson	O
,	O
and	O
d.w.	O
murray	O
.	O
tracking	O
while	O
zooming	O
using	O
afﬁne	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
51	O
(	O
1	O
)	O
:37–62	O
,	O
january	O
transfer	B
and	O
multifocal	O
tensors	O
.	O
2003	O
.	O
[	O
heyden-95a	O
]	O
a.	O
heyden	O
.	O
reconstruction	B
from	O
image	O
sequences	O
by	O
means	O
of	O
relative	O
depths	O
.	O
in	O
e.	O
grim-	O
son	O
,	O
editor	O
,	O
proc	O
.	O
5th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
boston	O
,	O
cambridge	O
,	O
ma	O
,	O
june	O
1995	O
.	O
[	O
heyden-95b	O
]	O
a.	O
heyden	O
.	O
geometry	O
and	O
algebra	O
of	O
multiple	O
projective	B
transformations	O
.	O
phd	O
thesis	O
,	O
department	O
of	O
mathematics	O
,	O
lund	O
university	O
,	O
sweden	O
,	O
december	O
1995	O
.	O
[	O
heyden-97a	O
]	O
a.	O
heyden	O
.	O
projective	B
structure	O
and	O
motion	O
from	O
image	O
sequences	O
using	O
subspace	O
meth-	O
ods	O
.	O
in	O
scandinavian	O
conference	O
on	O
image	O
analysis	O
,	O
lappenraanta	O
,	O
pages	O
963–968	O
,	O
1997	O
.	O
[	O
heyden-97b	O
]	O
a.	O
heyden	O
and	O
k.	O
˚astr¨om	O
.	O
euclidean	O
reconstruction	O
from	O
image	O
sequences	O
with	O
varying	O
and	O
unknown	O
focal	B
length	I
and	O
principal	B
point	I
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
1997	O
.	O
[	O
heyden-97c	O
]	O
a.	O
heyden	O
.	O
reconstruction	B
from	O
multiple	O
images	O
by	O
means	O
of	O
using	O
relative	O
depths	O
.	O
in-	O
ternational	O
journal	O
of	O
computer	O
vision	O
,	O
24	O
(	O
2	O
)	O
:155–161	O
,	O
1997	O
.	O
[	O
heyden-98	O
]	O
a.	O
heyden	O
.	O
algebraic	B
varieties	O
in	O
multiple	O
view	O
geometry	O
.	O
in	O
proc	O
.	O
5th	O
european	O
confer-	O
ence	O
on	O
computer	O
vision	O
,	O
freiburg	O
,	O
germany	O
,	O
pages	O
3–19	O
,	O
1998	O
.	O
[	O
hilbert-56	O
]	O
d.	O
hilbert	O
and	O
s.	O
cohn-vossen	O
.	O
geometry	O
and	O
the	O
imagination	O
.	O
chelsea	O
,	O
ny	O
,	O
1956	O
.	O
[	O
horaud-98	O
]	O
r.	O
horaud	O
and	O
g.	O
csurka	O
.	O
self-calibration	O
and	O
euclidean	O
reconstruction	O
using	O
motions	O
of	O
a	O
bibliography	O
639	O
stereo	O
rig	O
.	O
in	O
proc	O
.	O
6th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
96–103	O
,	O
january	O
1998	O
.	O
[	O
horn-90	O
]	O
b.	O
k.	O
p.	O
horn	O
.	O
relative	O
orientation	B
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
4:59–78	O
,	O
1990	O
.	O
[	O
horn-91	O
]	O
b.	O
k.	O
p.	O
horn	O
.	O
relative	O
orientation	B
revisited	O
.	O
journal	O
of	O
the	O
optical	O
society	O
of	O
america	O
,	O
8	O
(	O
10	O
)	O
:1630–1638	O
,	O
1991	O
.	O
[	O
horry-97	O
]	O
y.	O
horry	O
,	O
k.	O
anjyo	O
,	O
and	O
k.	O
arai	O
.	O
tour	O
into	O
the	O
picture	B
:	O
using	O
a	O
spidery	O
mesh	O
interface	O
in	O
proceedings	O
of	O
the	O
acm	O
siggraph	O
conference	O
on	O
to	O
make	O
animation	O
from	O
a	O
single	O
image	O
.	O
computer	O
graphics	O
,	O
pages	O
225–232	O
,	O
1997	O
.	O
[	O
huang-89	O
]	O
t.	O
s.	O
huang	O
and	O
o.	O
d.	O
faugeras	O
.	O
some	O
properties	B
of	O
the	O
e-matrix	O
in	O
two-view	O
motion	O
estimation	B
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
11:1310	O
–	O
1312	O
,	O
1989	O
.	O
[	O
huber-81	O
]	O
p.	O
j.	O
huber	O
.	O
robust	B
statistics	O
.	O
john	O
wiley	O
and	O
sons	O
,	O
1981	O
.	O
[	O
huynh-03	O
]	O
d.q	O
.	O
huynh	O
,	O
r.	O
hartley	O
,	O
and	O
a	O
heyden	O
.	O
outlier	O
correction	B
of	O
image	O
sequences	O
for	O
the	O
afﬁne	B
camera	I
.	O
in	O
proc	O
.	O
9th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
vancouver	O
,	O
france	O
,	O
2003	O
.	O
[	O
irani-98	O
]	O
m.	O
irani	O
,	O
p.	O
anandan	O
,	O
and	O
d.	O
weinshall	O
.	O
from	O
reference	O
frames	O
to	O
reference	O
planes	O
:	O
multi-	O
view	O
parallax	B
geometry	O
and	O
applications	O
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
1998	O
.	O
[	O
irani-99	O
]	O
m.	O
irani	O
.	O
multi-frame	O
optical	O
ﬂow	O
estimation	B
using	O
subspace	O
contraints	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
1999	O
.	O
[	O
irani-00	O
]	O
michal	O
irani	O
and	O
p.	O
anandan	O
.	O
factorization	B
with	O
uncertainty	O
.	O
in	O
proc	O
.	O
6th	O
european	O
confer-	O
ence	O
on	O
computer	O
vision	O
,	O
part	O
i	O
,	O
lncs	O
1842	O
,	O
dublin	O
,	O
ireland	O
,	O
pages	O
539	O
–	O
553	O
,	O
2000	O
.	O
[	O
jiang-02	O
]	O
g.	O
jiang	O
,	O
h.	O
tsui	O
,	O
l.	O
quan	O
,	O
and	O
a.	O
zisserman	O
.	O
single	O
axis	O
geometry	O
by	O
ﬁtting	O
conics	O
.	O
in	O
proc	O
.	O
7th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
copenhagen	O
,	O
denmark	O
,	O
volume	O
1	O
,	O
pages	O
537–550	O
.	O
springer-verlag	O
,	O
2002	O
.	O
[	O
kahl-98a	O
]	O
f.	O
kahl	O
and	O
a.	O
heyden	O
.	O
structure	B
and	O
motion	O
from	O
points	O
,	O
lines	B
and	O
conics	O
with	O
afﬁne	O
cameras	B
.	O
in	O
proc	O
.	O
5th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
freiburg	O
,	O
germany	O
,	O
pages	O
327–	O
341	O
,	O
1998	O
.	O
[	O
kahl-98b	O
]	O
f.	O
kahl	O
and	O
a.	O
heyden	O
.	O
using	O
conic	O
correspondences	B
in	O
two	O
images	O
to	O
estimate	O
epipolar	B
geometry	O
.	O
in	O
proc	O
.	O
6th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
761–	O
766	O
,	O
1998	O
.	O
[	O
kahl-99	O
]	O
f.	O
kahl	O
.	O
critical	O
motions	O
and	O
ambiguous	O
euclidean	O
reconstructions	O
in	O
auto-calibration	O
.	O
proc	O
.	O
7th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
kerkyra	O
,	O
greece	O
,	O
pages	O
469–475	O
,	O
1999	O
.	O
[	O
kahl-01a	O
]	O
f.	O
kahl	O
,	O
r.	O
hartley	O
,	O
and	O
k.	O
˚astr¨om	O
.	O
critical	B
conﬁgurations	I
for	O
n-view	O
projective	B
reconstruc-	O
tion	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
ii–158	O
–	O
ii–163	O
,	O
2001.	O
in	O
[	O
kahl-01b	O
]	O
f.	O
kahl	O
.	O
geometry	O
and	O
critical	B
conﬁgurations	I
of	O
multiple	O
views	O
.	O
phd	O
thesis	O
,	O
lund	O
institute	O
of	O
technology	O
,	O
2001	O
.	O
[	O
kanatani-92	O
]	O
k.	O
kanatani	O
.	O
geometric	B
computation	O
for	O
machine	O
vision	O
.	O
oxford	O
university	O
press	O
,	O
ox-	O
ford	O
,	O
1992	O
.	O
[	O
kanatani-94	O
]	O
k.	O
kanatani	O
.	O
statistical	O
bias	B
of	O
conic	B
ﬁtting	I
and	O
renormalization	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
16	O
(	O
3	O
)	O
:320–326	O
,	O
1994	O
.	O
[	O
kanatani-96	O
]	O
k.	O
kanatani	O
.	O
statistical	O
optimization	O
for	O
geometric	O
computation	B
:	O
theory	O
and	O
practice	O
.	O
elsevier	O
science	O
,	O
amsterdam	O
,	O
1996	O
.	O
[	O
kaucic-01	O
]	O
r.	O
kaucic	O
,	O
r.	O
i.	O
hartley	O
,	O
and	O
n.	O
y.	O
dano	O
.	O
plane-based	O
projective	B
reconstruction	I
.	O
in	O
proc	O
.	O
8th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
vancouver	O
,	O
canada	O
,	O
pages	O
i–420–427	O
,	O
2001	O
.	O
[	O
klein-39	O
]	O
f.	O
klein	O
.	O
elementary	O
mathematics	O
from	O
an	O
advanced	O
standpoint	O
.	O
macmillan	O
,	O
new	O
york	O
,	O
1939	O
.	O
[	O
knight-03	O
]	O
j.	O
knight	O
,	O
a.	O
zisserman	O
,	O
and	O
i.	O
reid	O
.	O
linear	B
auto-calibration	O
for	O
ground	O
plane	B
motion	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
june	O
2003	O
.	O
[	O
koenderink-84	O
]	O
j.	O
j.	O
koenderink	O
.	O
what	O
does	O
the	O
occluding	B
contour	O
tell	O
us	O
about	O
solid	O
shape	O
?	O
perception	O
,	O
13:321–330	O
,	O
1984	O
.	O
[	O
koenderink-90	O
]	O
j.	O
koenderink	O
.	O
solid	O
shape	O
.	O
mit	O
press	O
,	O
1990	O
.	O
[	O
koenderink-91	O
]	O
j.	O
j.	O
koenderink	O
and	O
a.	O
j.	O
van	O
doorn	O
.	O
afﬁne	B
structure	O
from	O
motion	O
.	O
journal	O
of	O
the	O
optical	O
society	O
of	O
america	O
,	O
8	O
(	O
2	O
)	O
:377–385	O
,	O
1991	O
.	O
640	O
bibliography	O
[	O
krames-42	O
]	O
j.	O
krames	O
.	O
¨uber	O
die	O
bei	O
der	O
hauptaufgabe	O
der	O
luftphotogrammetrie	O
auftretenden	O
“	O
gef¨ahrlichen	O
”	O
fl¨achen	O
.	O
bildmessung	O
und	O
luftbildwesen	O
(	O
beilage	O
zur	O
allg	O
.	O
vermessungs-nachr	O
.	O
)	O
,	O
17	O
,	O
heft	O
1/2:1–18	O
,	O
1942	O
.	O
[	O
kriegman-98	O
]	O
d.	O
j.	O
kriegman	O
and	O
p.	O
belhumeur	O
.	O
what	O
shadows	O
reveal	O
about	O
object	O
structure	B
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
399–414	O
,	O
1998	O
.	O
[	O
laveau-96a	O
]	O
s.	O
laveau	O
.	O
g´eom´etrie	O
d	O
’	O
un	O
syst`eme	O
de	O
n	O
cam´eras	O
.	O
th´eorie	O
,	O
estimation	B
et	O
applications	O
.	O
phd	O
thesis	O
,	O
inria	O
,	O
1996	O
.	O
[	O
laveau-96b	O
]	O
s.	O
laveau	O
and	O
o.	O
d.	O
faugeras	O
.	O
oriented	O
projective	B
geometry	O
in	O
computer	O
vision	O
.	O
in	O
proc	O
.	O
4th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
1065	O
,	O
cambridge	O
,	O
pages	O
147–156	O
,	O
springer–	O
verlag	O
,	O
1996.	O
buxton	O
b.	O
and	O
cipolla	O
r.	O
[	O
liebowitz-98	O
]	O
d.	O
liebowitz	O
and	O
a.	O
zisserman	O
.	O
metric	B
rectiﬁcation	I
for	O
perspective	O
images	O
of	O
planes	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
482–488	O
,	O
june	O
1998	O
.	O
[	O
liebowitz-99a	O
]	O
d.	O
liebowitz	O
,	O
a.	O
criminisi	O
,	O
and	O
a.	O
zisserman	O
.	O
creating	O
architectural	O
models	O
from	O
im-	O
ages	O
.	O
in	O
proc	O
.	O
eurographics	O
,	O
volume	O
18	O
,	O
pages	O
39–50	O
,	O
september	O
1999	O
.	O
[	O
liebowitz-99b	O
]	O
d.	O
liebowitz	O
and	O
a.	O
zisserman	O
.	O
combining	O
scene	O
and	O
auto-calibration	B
constraints	O
.	O
in	O
proc	O
.	O
7th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
kerkyra	O
,	O
greece	O
,	O
september	O
1999	O
.	O
[	O
liebowitz-01	O
]	O
d.	O
liebowitz	O
.	O
camera	B
calibration	I
and	O
reconstruction	B
of	O
geometry	O
from	O
images	O
.	O
phd	O
thesis	O
,	O
university	O
of	O
oxford	O
,	O
dept	O
.	O
engineering	O
science	O
,	O
june	O
2001.	O
d.phil	O
.	O
thesis	O
.	O
[	O
longuethiggins-81	O
]	O
h.	O
c.	O
longuet-higgins	O
.	O
a	O
computer	O
algorithm	B
for	O
reconstructing	O
a	O
scene	O
from	O
two	O
projections	O
.	O
nature	O
,	O
293:133–135	O
,	O
september	O
1981	O
.	O
[	O
luong-92	O
]	O
q.	O
luong	O
.	O
matrice	O
fondamentale	O
et	O
autocalibration	O
en	O
vision	O
par	O
ordinateur	O
.	O
phd	O
thesis	O
,	O
universit´e	O
de	O
paris-sud	O
,	O
france	O
,	O
1992	O
.	O
[	O
luong-94	O
]	O
q.	O
t.	O
luong	O
and	O
t.	O
vi´eville	O
.	O
canonic	O
representations	O
for	O
the	O
geometries	O
of	O
multiple	O
projec-	O
tive	O
views	O
.	O
in	O
proc	O
.	O
3rd	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
stockholm	O
,	O
pages	O
589–599	O
,	O
may	O
1994	O
.	O
[	O
luong-96	O
]	O
q.	O
t.	O
luong	O
and	O
t.	O
vi´eville	O
.	O
canonical	O
representations	O
for	O
the	O
geometries	O
of	O
multiple	O
pro-	O
jective	O
views	O
.	O
computer	O
vision	O
and	O
image	O
understanding	O
,	O
64	O
(	O
2	O
)	O
:193–229	O
,	O
september	O
1996	O
.	O
[	O
lutkepohl-96	O
]	O
h.	O
lutkepohl	O
.	O
handbook	O
of	O
matrices	O
.	O
wiley	O
,	O
isbn	O
0471970158	O
,	O
1996	O
.	O
[	O
ma-99	O
]	O
y.	O
ma	O
,	O
s.	O
soatto	O
,	O
j.	O
kosecka	O
,	O
and	O
s.	O
sastry	O
.	O
euclidean	O
reconstruction	O
and	O
reprojection	B
up	O
to	O
subgroups	O
.	O
in	O
proc	O
.	O
7th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
kerkyra	O
,	O
greece	O
,	O
pages	O
773–	O
780	O
,	O
1999	O
.	O
[	O
mathematica-92	O
]	O
s.	O
wolfram	O
.	O
mathematica	O
a	O
system	O
for	O
doing	O
mathematics	O
by	O
computer	O
second	O
edition	O
.	O
addison-wesley	O
,	O
1992	O
.	O
[	O
maybank-90	O
]	O
s.	O
j.	O
maybank	O
.	O
the	O
projective	B
geometry	O
of	O
ambiguous	O
surfaces	O
.	O
philosophical	O
transac-	O
tions	O
of	O
the	O
royal	O
society	O
of	O
london	O
,	O
series	O
a	O
,	O
a	O
332:1–47	O
,	O
1990	O
.	O
[	O
maybank-93	O
]	O
s.	O
j.	O
maybank	O
.	O
theory	O
of	O
reconstruction	O
from	O
image	O
motion	O
.	O
springer-verlag	O
,	O
berlin	O
,	O
1993	O
.	O
[	O
maybank-98	O
]	O
s.	O
j.	O
maybank	O
and	O
a.	O
shashua	O
.	O
ambiguity	B
in	O
reconstruction	B
from	O
images	O
of	O
six	O
points	O
.	O
in	O
proc	O
.	O
6th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
703–708	O
,	O
1998	O
.	O
[	O
mclauchlan-00	O
]	O
p.	O
f.	O
mclauchlan	O
.	O
gauge	O
independence	O
in	O
optimization	O
algorithms	O
for	O
3d	O
vision	O
.	O
in	O
w.	O
triggs	O
,	O
a.	O
zisserman	O
,	O
and	O
r.	O
szeliski	O
,	O
editors	O
,	O
vision	O
algorithms	O
:	O
theory	O
and	O
practice	O
,	O
volume	O
1883	O
of	O
lncs	O
,	O
pages	O
183–199	O
.	O
springer	O
,	O
2000	O
.	O
[	O
mohr-92	O
]	O
r.	O
mohr	O
.	O
projective	B
geometry	O
and	O
computer	O
vision	O
.	O
in	O
c.	O
h.	O
chen	O
,	O
l.	O
f.	O
pau	O
,	O
and	O
p.	O
s.	O
p.	O
wang	O
,	O
editors	O
,	O
handbook	O
of	O
pattern	O
recognition	O
and	O
computer	O
vision	O
.	O
world	O
scientiﬁc	O
,	O
1992	O
.	O
[	O
mohr-93	O
]	O
r.	O
mohr	O
,	O
f.	O
veillon	O
,	O
and	O
l.	O
quan	O
.	O
relative	O
3d	O
reconstruction	B
using	O
multiple	O
uncalibrated	O
images	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
543–548	O
,	O
1993	O
.	O
[	O
moons-94	O
]	O
t.	O
moons	O
,	O
l.	O
van	O
gool	O
,	O
m.	O
van	O
diest	O
,	O
and	O
e.	O
pauwels	O
.	O
afﬁne	B
reconstruction	I
from	O
perspec-	O
tive	O
image	O
pairs	O
.	O
in	O
j.	O
mundy	O
,	O
a.	O
zisserman	O
,	O
and	O
d.	O
forsyth	O
,	O
editors	O
,	O
applications	O
of	O
invariance	O
in	O
computer	O
vision	O
,	O
lncs	O
825.	O
springer-verlag	O
,	O
1994	O
.	O
[	O
muehlich-98	O
]	O
m.	O
m¨uhlich	O
and	O
r.	O
mester	O
.	O
the	O
role	O
of	O
total	O
least	B
squares	I
in	O
motion	O
analysis	O
.	O
in	O
proc	O
.	O
5th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
freiburg	O
,	O
germany	O
,	O
pages	O
305–321	O
.	O
springer-verlag	O
,	O
bibliography	O
641	O
1998	O
.	O
[	O
mundy-92	O
]	O
j.	O
mundy	O
and	O
a.	O
zisserman	O
.	O
geometric	B
invariance	O
in	O
computer	O
vision	O
.	O
mit	O
press	O
,	O
1992	O
.	O
[	O
newsam-96	O
]	O
g.	O
newsam	O
,	O
d.	O
q.	O
huynh	O
,	O
m.	O
brooks	O
,	O
and	O
h.	O
p.	O
pan	O
.	O
recovering	O
unknown	O
focal	O
lengths	O
in	O
self-calibration	O
:	O
an	O
essentially	O
linear	B
algorithm	I
and	O
degenerate	B
conﬁgurations	I
.	O
in	O
int	O
.	O
arch	O
.	O
pho-	O
togrammetry	O
&	O
remote	O
sensing	O
,	O
volume	O
xxxi-b3	O
,	O
pages	O
575–80	O
,	O
vienna	O
,	O
1996	O
.	O
[	O
niem-94	O
]	O
w.	O
niem	O
and	O
r.	O
buschmann	O
.	O
automatic	O
modelling	O
of	O
3d	O
natural	O
objects	O
from	O
multiple	O
views	O
.	O
in	O
european	O
workshop	O
on	O
combined	O
real	O
and	O
synthetic	O
image	O
processing	O
for	O
broadcast	O
and	O
video	O
production	O
,	O
hamburg	O
,	O
germany	O
,	O
1994	O
.	O
[	O
nister-00	O
]	O
d.	O
nister	O
.	O
reconstruction	B
from	O
uncalibrated	O
sequences	O
with	O
a	O
hierarchy	B
of	I
trifocal	O
tensors	O
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
2000	O
.	O
[	O
oskarsson-02	O
]	O
m.	O
oskarsson	O
,	O
a.	O
zisserman	O
,	O
and	O
k.	O
˚astr¨om	O
.	O
minimal	O
projective	O
reconstruction	B
for	O
combinations	O
of	B
points	I
and	O
lines	B
in	O
three	O
views	O
.	O
in	O
proc	O
.	O
british	O
machine	O
vision	O
conference	O
,	O
pages	O
62–72	O
,	O
2002	O
.	O
[	O
poelman-94	O
]	O
c.	O
poelman	O
and	O
t.	O
kanade	O
.	O
a	O
paraperspective	O
factorization	B
method	O
for	O
shape	O
and	O
motion	O
recovery	O
.	O
in	O
proc	O
.	O
3rd	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
stockholm	O
,	O
volume	O
2	O
,	O
pages	O
97–	O
108	O
,	O
1994	O
.	O
[	O
pollefeys-96	O
]	O
m.	O
pollefeys	O
,	O
l.	O
van	O
gool	O
,	O
and	O
a.	O
oosterlinck	O
.	O
the	O
modulus	B
constraint	I
:	O
a	O
new	O
constraint	O
for	O
self-calibration	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
pattern	O
recognition	O
,	O
pages	O
31–42	O
,	O
1996	O
.	O
[	O
pollefeys-98	O
]	O
m.	O
pollefeys	O
,	O
r.	O
koch	O
,	O
and	O
l.	O
van	O
gool	O
.	O
self	O
calibration	B
and	O
metric	B
reconstruction	I
in	O
spite	O
of	O
varying	O
and	O
unknown	O
internal	B
camera	O
parameters	B
.	O
in	O
proc	O
.	O
6th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
90–96	O
,	O
1998	O
.	O
[	O
pollefeys-99a	O
]	O
m.	O
pollefeys	O
,	O
r.	O
koch	O
,	O
and	O
l.	O
van	O
gool	O
.	O
a	O
simple	O
and	O
efﬁcient	O
rectiﬁcation	O
method	O
for	O
general	O
motion	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
496–501	O
,	O
1999	O
.	O
[	O
pollefeys-99b	O
]	O
m.	O
pollefeys	O
.	O
self-calibration	O
and	O
metric	B
3d	O
reconstruction	B
from	O
uncalibrated	O
image	O
sequences	O
.	O
phd	O
thesis	O
,	O
esat-psi	O
,	O
k.u.leuven	O
,	O
1999	O
.	O
[	O
pollefeys-02	O
]	O
m.	O
pollefeys	O
,	O
f.	O
verbiest	O
,	O
and	O
l.	O
j.	O
van	O
gool	O
.	O
surviving	O
dominant	O
planes	O
in	O
uncalibrated	O
structure	B
and	O
motion	O
recovery	O
.	O
in	O
eccv	O
(	O
2	O
)	O
,	O
pages	O
837–851	O
,	O
2002	O
.	O
[	O
ponce-94	O
]	O
j.	O
ponce	O
,	O
d.	O
h.	O
marimont	O
,	O
and	O
t.	O
a.	O
cass	O
.	O
analytical	O
methods	O
for	O
uncalibrated	O
stereo	O
and	O
motion	O
measurement	O
.	O
in	O
proc	O
.	O
3rd	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
stockholm	O
,	O
volume	O
1	O
,	O
pages	O
463–470	O
,	O
1994	O
.	O
[	O
porrill-91	O
]	O
j.	O
porrill	O
and	O
s.	O
b.	O
pollard	O
.	O
curve	O
matching	B
and	O
stereo	O
calibration	O
.	O
image	O
and	O
vision	O
com-	O
puting	O
,	O
9	O
(	O
1	O
)	O
:45–50	O
,	O
1991	O
.	O
[	O
pratt-87	O
]	O
v.	O
pratt	O
.	O
direct	O
least-squares	O
ﬁtting	O
of	O
algebraic	O
surfaces	O
.	O
computer	O
graphics	O
,	O
21	O
(	O
4	O
)	O
:145–151	O
,	O
1987	O
.	O
[	O
press-88	O
]	O
w.	O
press	O
,	O
b.	O
flannery	O
,	O
s.	O
teukolsky	O
,	O
and	O
w.	O
vetterling	O
.	O
numerical	O
recipes	O
in	O
c.	O
cambridge	O
university	O
press	O
,	O
1988	O
.	O
[	O
pritchett-98	O
]	O
p.	O
pritchett	O
and	O
a.	O
zisserman	O
.	O
wide	O
baseline	O
stereo	O
matching	O
.	O
in	O
proc	O
.	O
6th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
754–760	O
,	O
january	O
1998	O
.	O
[	O
proesmans-98	O
]	O
m.	O
proesmans	O
,	O
t.	O
tuytelaars	O
,	O
and	O
l.	O
j.	O
van	O
gool	O
.	O
monocular	O
image	O
measurements	O
.	O
technical	O
report	O
improofs-m12t21/1/p	O
,	O
k.u.leuven	O
,	O
1998	O
.	O
[	O
quan-94	O
]	O
l.	O
quan	O
.	O
invariants	B
of	O
6	O
points	O
from	O
3	O
uncalibrated	O
images	O
.	O
in	O
j.	O
o.	O
eckland	O
,	O
editor	O
,	O
proc	O
.	O
3rd	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
stockholm	O
,	O
pages	O
459–469	O
.	O
springer-verlag	O
,	O
1994	O
.	O
[	O
quan-97a	O
]	O
l.	O
quan	O
and	O
t.	O
kanade	O
.	O
afﬁne	B
structure	O
from	O
line	O
correspondences	B
with	O
uncalibrated	O
afﬁne	B
cameras	I
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
19	O
(	O
8	O
)	O
:834–845	O
,	O
august	O
1997.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
60–65	O
,	O
1997	O
.	O
[	O
quan-97b	O
]	O
l.	O
quan	O
.	O
uncalibrated	O
1d	O
projective	B
camera	I
and	O
3d	O
afﬁne	B
reconstruction	I
of	O
lines	B
.	O
in	O
proc	O
.	O
[	O
quan-98	O
]	O
l.	O
quan	O
and	O
z.	O
lan	O
.	O
linear	B
n	O
≥	O
4-point	O
pose	O
determination	O
.	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
778–783	O
,	O
1998.	O
in	O
proc	O
.	O
6th	O
international	O
[	O
reid-96	O
]	O
i.	O
d.	O
reid	O
and	O
d.	O
w.	O
murray	O
.	O
active	O
tracking	O
of	O
foveated	O
feature	O
clusters	O
using	O
afﬁne	O
structure	B
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
18	O
(	O
1	O
)	O
:41–60	O
,	O
1996	O
.	O
[	O
rinner-72	O
]	O
k.	O
rinner	O
and	O
r.	O
burkhardt	O
.	O
photogrammetrie	O
.	O
in	O
handbuch	O
der	O
vermessungskunde	O
,	O
volume	O
642	O
bibliography	O
band	O
iii	O
a/3	O
.	O
jordan	O
,	O
eggert	O
,	O
kneissel	O
,	O
stuttgart	O
:	O
j.b.	O
metzlersche	O
verlagsbuchhandlung	O
,	O
1972	O
.	O
[	O
robert-93	O
]	O
l.	O
robert	O
and	O
o.	O
d.	O
faugeras	O
.	O
relative	O
3d	O
positioning	O
and	O
3d	O
convex	B
hull	I
computation	O
in	O
proc	O
.	O
4th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
from	O
a	O
weakly	O
calibrated	B
stereo	O
pair	O
.	O
berlin	O
,	O
pages	O
540–544	O
,	O
1993	O
.	O
[	O
rother-01	O
]	O
c.	O
rother	O
and	O
s.	O
carlsson	O
.	O
linear	B
multi	O
view	O
reconstruction	B
and	O
camera	B
recovery	O
.	O
in	O
proc	O
.	O
8th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
vancouver	O
,	O
canada	O
,	O
pages	O
i–42–49	O
,	O
2001	O
.	O
[	O
rother-03	O
]	O
c.	O
rother	O
.	O
multi-view	O
reconstruction	B
and	O
camera	B
recovery	O
using	O
a	O
real	O
or	O
virtual	O
refer-	O
ence	O
plane	B
.	O
phd	O
thesis	O
,	O
computational	O
vision	O
and	O
active	O
perception	O
laboratory	O
,	O
kungl	O
tekniska	O
h¨ogskolan	O
,	O
2003	O
.	O
[	O
rousseeuw-87	O
]	O
p.	O
j.	O
rousseeuw	O
.	O
robust	B
regression	O
and	O
outlier	O
detection	O
.	O
wiley	O
,	O
new	O
york	O
,	O
1987	O
.	O
[	O
sampson-82	O
]	O
p.	O
d.	O
sampson	O
.	O
fitting	O
conic	B
sections	O
to	O
‘	O
very	O
scattered	O
’	O
data	O
:	O
an	O
iterative	B
reﬁnement	O
of	O
the	O
bookstein	O
algorithm	B
.	O
computer	O
vision	O
,	O
graphics	O
,	O
and	O
image	O
processing	O
,	O
18:97–108	O
,	O
1982	O
.	O
[	O
sawhney-98	O
]	O
h.	O
s.	O
sawhney	O
,	O
s.	O
hsu	O
,	O
and	O
r.	O
kumar	O
.	O
robust	B
video	O
mosaicing	O
through	O
topology	B
inference	O
and	O
local	O
to	O
global	O
alignment	O
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
103–119	O
.	O
springer-verlag	O
,	O
1998	O
.	O
[	O
schaffalitzky-99	O
]	O
f.	O
schaffalitzky	O
and	O
a.	O
zisserman	O
.	O
geometric	B
grouping	O
of	O
repeated	O
elements	O
within	O
in	O
d.a	O
.	O
forsyth	O
,	O
j.l	O
.	O
mundy	O
,	O
v.	O
di	O
gesu	O
,	O
and	O
r.	O
cipolla	O
,	O
editors	O
,	O
shape	O
,	O
contour	B
and	O
images	O
.	O
grouping	O
in	O
computer	O
vision	O
,	O
lncs	O
1681	O
,	O
pages	O
165–181	O
.	O
springer-verlag	O
,	O
1999	O
.	O
[	O
schaffalitzky-00a	O
]	O
f.	O
schaffalitzky	O
.	O
direct	O
solution	O
of	O
modulus	O
constraints	O
.	O
in	O
proceedings	O
of	O
the	O
indian	O
conference	O
on	O
computer	O
vision	O
,	O
graphics	O
and	O
image	O
processing	O
,	O
bangalore	O
,	O
pages	O
314–321	O
,	O
2000	O
.	O
[	O
schaffalitzky-00b	O
]	O
f.	O
schaffalitzky	O
and	O
a.	O
zisserman	O
.	O
planar	O
grouping	O
for	O
automatic	O
detection	O
of	O
van-	O
ishing	O
lines	B
and	O
points	O
.	O
image	O
and	O
vision	O
computing	B
,	O
18:647–658	O
,	O
2000	O
.	O
[	O
schaffalitzky-00c	O
]	O
f.	O
schaffalitzky	O
,	O
a.	O
zisserman	O
,	O
r.	O
i.	O
hartley	O
,	O
and	O
p.	O
h.	O
s.	O
torr	O
.	O
a	O
six	O
point	B
solution	O
for	O
structure	O
and	O
motion	O
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
632–648	O
.	O
springer-	O
verlag	O
,	O
june	O
2000	O
.	O
[	O
schmid-97	O
]	O
c.	O
schmid	O
and	O
a.	O
zisserman	O
.	O
automatic	O
line	B
matching	O
across	O
views	O
.	O
in	O
proc	O
.	O
ieee	O
con-	O
ference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
666–671	O
,	O
1997	O
.	O
[	O
schmid-98	O
]	O
c.	O
schmid	O
and	O
a.	O
zisserman	O
.	O
the	O
geometry	O
and	O
matching	B
of	O
curves	O
in	O
multiple	O
views	O
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
394–409	O
.	O
springer-verlag	O
,	O
june	O
1998	O
.	O
[	O
se-00	O
]	O
s.	O
se	O
.	O
zebra-crossing	O
detection	O
for	O
the	O
partially	O
sighted	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
211–217	O
,	O
2000	O
.	O
[	O
semple-79	O
]	O
j.	O
g.	O
semple	O
and	O
g.	O
t.	O
kneebone	O
.	O
algebraic	B
projective	O
geometry	O
.	O
oxford	O
university	O
press	O
,	O
1979	O
.	O
[	O
shapiro-95	O
]	O
l.	O
s.	O
shapiro	O
,	O
a.	O
zisserman	O
,	O
and	O
m.	O
brady	O
.	O
3d	O
motion	O
recovery	O
via	O
afﬁne	B
epipolar	O
geom-	O
etry	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
16	O
(	O
2	O
)	O
:147–182	O
,	O
1995	O
.	O
[	O
shashua-94	O
]	O
a.	O
shashua	O
.	O
trilinearity	O
in	O
visual	O
recognition	O
by	O
alignment	O
.	O
in	O
proc	O
.	O
3rd	O
european	O
con-	O
ference	O
on	O
computer	O
vision	O
,	O
stockholm	O
,	O
volume	O
1	O
,	O
pages	O
479–484	O
,	O
may	O
1994	O
.	O
[	O
shashua-95a	O
]	O
a.	O
shashua	O
.	O
algebraic	B
functions	O
for	O
recognition	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
17	O
(	O
8	O
)	O
:779–789	O
,	O
august	O
1995	O
.	O
[	O
shashua-95b	O
]	O
a.	O
shashua	O
and	O
m.	O
werman	O
.	O
on	O
the	O
trilinear	B
tensor	O
of	O
three	O
perspective	O
views	O
and	O
its	O
underlying	O
geometry	O
.	O
in	O
proc	O
.	O
5th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
boston	O
,	O
1995	O
.	O
[	O
shashua-96	O
]	O
a.	O
shashua	O
and	O
s.	O
j.	O
maybank	O
.	O
degenerate	B
n-point	O
conﬁgurations	O
of	O
three	O
views	O
:	O
do	O
critical	O
surfaces	O
exist	O
?	O
technical	O
report	O
tr	O
96-19	O
,	O
hebrew	O
university	O
,	O
computer	O
science	O
,	O
november	O
1996	O
.	O
[	O
shashua-97	O
]	O
a.	O
shashua	O
and	O
s.	O
toelg	O
.	O
the	O
quadric	O
reference	O
surface	O
:	O
theory	O
and	O
applications	O
.	O
inter-	O
national	O
journal	O
of	O
computer	O
vision	O
,	O
23	O
(	O
2	O
)	O
:185–198	O
,	O
1997	O
.	O
[	O
shimshoni-99	O
]	O
i.	O
shimshoni	O
,	O
r.	O
basri	O
,	O
and	O
e.	O
rivlin	O
.	O
a	O
geometric	B
interpretation	I
of	O
weak-perspective	O
motion	O
.	O
technical	O
report	O
,	O
technion	O
,	O
1999	O
.	O
[	O
sinclair-92	O
]	O
d.	O
a.	O
sinclair	O
.	O
experiments	O
in	O
motion	O
and	O
correspondence	B
.	O
phd	O
thesis	O
,	O
university	O
of	O
oxford	O
,	O
1992	O
.	O
[	O
slama-80	O
]	O
c.	O
slama	O
.	O
manual	O
of	O
photogrammetry	O
.	O
american	O
society	O
of	O
photogrammetry	O
,	O
falls	O
church	O
,	O
va	O
,	O
usa	O
,	O
4th	O
edition	O
,	O
1980.	O
bibliography	O
643	O
[	O
spetsakis-91	O
]	O
m.	O
e.	O
spetsakis	O
and	O
j.	O
aloimonos	O
.	O
a	O
multi-frame	O
approach	O
to	O
visual	O
motion	O
perception	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
16	O
(	O
3	O
)	O
:245–255	O
,	O
1991	O
.	O
[	O
springer-64	O
]	O
c.	O
e.	O
springer	O
.	O
geometry	O
and	O
analysis	O
of	O
projective	O
spaces	O
.	O
freeman	O
,	O
1964	O
.	O
[	O
stein-99	O
]	O
g.	O
stein	O
and	O
a.	O
shashua	O
.	O
on	O
degeneracy	O
of	O
linear	O
reconstruction	B
from	O
three	O
views	O
:	O
linear	B
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
line	B
complex	O
and	O
applications	O
.	O
21	O
(	O
3	O
)	O
:244–251	O
,	O
1999	O
.	O
[	O
stolﬁ-91	O
]	O
j.	O
stolﬁ	O
.	O
oriented	O
projective	B
geometry	O
.	O
academic	O
press	O
,	O
1991	O
.	O
[	O
strecha-02	O
]	O
c.strecha	O
and	O
l.	O
van	O
gool	O
.	O
pde-based	O
multi-view	O
depth	O
estimation	O
.	O
1st	O
int	O
.	O
symp	O
.	O
of	O
3d	O
data	O
processing	O
visualization	O
and	O
transmission	O
,	O
pages	O
416–425	O
,	O
2002	O
.	O
[	O
sturm-96	O
]	O
p.	O
sturm	O
and	O
w.	O
triggs	O
.	O
a	O
factorization	B
based	O
algorithm	B
for	O
multi-image	O
projective	B
structure	O
and	O
motion	O
.	O
in	O
proc	O
.	O
4th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
cambridge	O
,	O
pages	O
709–720	O
,	O
1996	O
.	O
[	O
sturm-97a	O
]	O
p.	O
sturm	O
.	O
critical	B
motion	I
sequences	I
for	O
monocular	O
self-calibration	O
and	O
uncalibrated	O
eu-	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
clidean	O
reconstruction	B
.	O
puerto	O
rico	O
,	O
pages	O
1100–1105	O
,	O
june	O
1997	O
.	O
[	O
sturm-97b	O
]	O
p.	O
sturm	O
.	O
vision	O
3d	O
non	O
calibr´ee	O
:	O
contributions	O
`a	O
la	O
reconstruction	B
projective	O
et	O
´etude	O
des	O
mouvements	O
critiques	O
pour	O
l	O
’	O
auto	O
calibrage	O
.	O
phd	O
thesis	O
,	O
inria	O
rhˆone-alpes	O
,	O
1997	O
.	O
[	O
sturm-99a	O
]	O
p.	O
sturm	O
and	O
s.	O
j.	O
maybank	O
.	O
a	O
method	O
for	O
interactive	O
3d	O
reconstruction	B
of	O
piecewise	O
planar	O
objects	O
from	O
single	O
images	O
.	O
in	O
proc	O
.	O
10th	O
british	O
machine	O
vision	O
conference	O
,	O
nottingham	O
,	O
1999	O
.	O
[	O
sturm-99b	O
]	O
p.	O
sturm	O
.	O
critical	B
motion	I
sequences	I
for	O
the	O
self-calibration	O
of	O
cameras	O
and	O
stereo	O
systems	O
in	O
proc	O
.	O
10th	O
british	O
machine	O
vision	O
conference	O
,	O
nottingham	O
,	O
pages	O
with	O
variable	O
focal	B
length	I
.	O
63–72	O
,	O
1999	O
.	O
[	O
sturm-99c	O
]	O
p.	O
sturm	O
and	O
s.	O
maybank	O
.	O
on	O
plane	O
based	O
camera	B
calibration	I
:	O
a	O
general	O
algorithm	O
,	O
singu-	O
larities	O
,	O
applications	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
432–437	O
,	O
june	O
1999	O
.	O
[	O
sturm-01	O
]	O
p.	O
sturm	O
.	O
on	O
focal	O
length	O
calibration	O
from	O
two	O
views	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
145–150	O
,	O
2001	O
.	O
[	O
sutherland-63	O
]	O
i.	O
e.	O
sutherland	O
.	O
sketchpad	O
:	O
a	O
man-machine	O
graphical	O
communications	O
system	O
.	O
techni-	O
cal	O
report	O
296	O
,	O
mit	O
lincoln	O
laboratories	O
,	O
1963.	O
also	O
published	O
by	O
garland	O
publishing	O
,	O
new	O
york	O
,	O
1980	O
.	O
[	O
szeliski-96	O
]	O
r.	O
szeliski	O
and	O
s.	O
b.	O
kang	O
.	O
shape	O
ambiguities	B
in	O
structure	B
from	O
motion	O
.	O
in	O
b.	O
buxton	O
and	O
cipolla	O
r.	O
,	O
editors	O
,	O
proc	O
.	O
4th	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
lncs	O
1064	O
,	O
cambridge	O
,	O
pages	O
709–721	O
.	O
springer–verlag	O
,	O
1996	O
.	O
[	O
szeliski-97	O
]	O
r.	O
szeliski	O
and	O
s.	O
heung-yeung	O
.	O
creating	O
full	O
view	O
panoramic	O
image	O
mosaics	O
and	O
envi-	O
ronment	O
maps	O
.	O
in	O
proceedings	O
of	O
the	O
acm	O
siggraph	O
conference	O
on	O
computer	O
graphics	O
,	O
1997	O
.	O
[	O
taubin-91	O
]	O
g.	O
taubin	O
.	O
estimation	B
of	I
planar	O
curves	O
,	O
surfaces	O
,	O
and	O
nonplanar	O
space	O
curves	O
deﬁned	O
by	O
implicit	O
equations	O
with	O
applications	O
to	O
edge	O
and	O
range	O
image	O
segmentation	O
.	O
pami	O
,	O
13	O
(	O
11	O
)	O
:1115–	O
1138	O
,	O
1991	O
.	O
[	O
thorhallsson-99	O
]	O
t.	O
thorhallsson	O
and	O
d.w.	O
murray	O
.	O
the	O
tensors	O
of	O
three	O
afﬁne	B
views	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
1999	O
.	O
[	O
tomasi-92	O
]	O
c.	O
tomasi	O
and	O
t.	O
kanade	O
.	O
shape	O
and	O
motion	O
from	O
image	O
streams	O
under	O
orthography	O
:	O
a	O
factorization	B
approach	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
9	O
(	O
2	O
)	O
:137–154	O
,	O
november	O
1992	O
.	O
[	O
tordoff-01	O
]	O
b.	O
tordoff	O
and	O
d.w.	O
murray	O
.	O
reactive	O
zoom	O
control	O
while	O
tracking	O
using	O
an	O
afﬁne	B
camera	I
.	O
in	O
proc	O
.	O
british	O
machine	O
vision	O
conference	O
,	O
volume	O
1	O
,	O
pages	O
53–62	O
,	O
2001	O
.	O
[	O
torr-93	O
]	O
p.	O
h.	O
s.	O
torr	O
and	O
d.	O
w.	O
murray	O
.	O
outlier	O
detection	O
and	O
motion	O
segmentation	O
.	O
in	O
proc	O
spie	O
sensor	O
fusion	O
vi	O
,	O
pages	O
432–443	O
,	O
boston	O
,	O
september	O
1993	O
.	O
[	O
torr-95a	O
]	O
p.	O
h.	O
s.	O
torr	O
,	O
a.	O
zisserman	O
,	O
and	O
d.	O
w.	O
murray	O
.	O
motion	O
clustering	O
using	O
the	O
trilinear	B
constraint	O
over	O
three	O
views	O
.	O
in	O
r.	O
mohr	O
and	O
c.	O
wu	O
,	O
editors	O
,	O
europe–china	O
workshop	O
on	O
geometrical	O
modelling	O
and	O
invariants	B
for	O
computer	O
vision	O
,	O
pages	O
118–125	O
.	O
xidan	O
university	O
press	O
,	O
1995	O
.	O
[	O
torr-95b	O
]	O
p.	O
h.	O
s.	O
torr	O
.	O
motion	O
segmentation	O
and	O
outlier	O
detection	O
.	O
phd	O
thesis	O
,	O
dept	O
.	O
of	O
engineering	O
science	O
,	O
university	O
of	O
oxford	O
,	O
1995	O
.	O
[	O
torr-97	O
]	O
p.	O
h.	O
s.	O
torr	O
and	O
a.	O
zisserman	O
.	O
robust	B
parameterization	O
and	O
computation	B
of	I
the	O
trifocal	B
tensor	I
.	O
644	O
bibliography	O
image	O
and	O
vision	O
computing	B
,	O
15:591–605	O
,	O
1997	O
.	O
[	O
torr-98	O
]	O
p.	O
h.	O
s.	O
torr	O
and	O
a.	O
zisserman	O
.	O
robust	B
computation	O
and	O
parameterization	O
of	O
multiple	O
view	O
relations	O
.	O
in	O
proc	O
.	O
6th	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
bombay	O
,	O
india	O
,	O
pages	O
727–732	O
,	O
january	O
1998	O
.	O
[	O
torr-99	O
]	O
p.	O
h.	O
s.	O
torr	O
,	O
a.	O
w.	O
fitzgibbon	O
,	O
and	O
a.	O
zisserman	O
.	O
the	O
problem	O
of	O
degeneracy	B
in	O
structure	B
and	O
motion	O
recovery	O
from	O
uncalibrated	O
image	O
sequences	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
32	O
(	O
1	O
)	O
:27–44	O
,	O
august	O
1999	O
.	O
[	O
torresani-01	O
]	O
l.	O
torresani	O
,	O
d.	O
yang	O
,	O
g.	O
alexander	O
,	O
and	O
c.	O
bregler	O
.	O
tracking	O
and	O
modelling	O
non-rigid	B
objects	O
with	O
rank	O
constraints	B
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
i	O
:	O
493–500	O
,	O
2001	O
.	O
[	O
triggs-95	O
]	O
w.	O
triggs	O
.	O
the	O
geometry	O
of	O
projective	O
reconstruction	B
i	O
:	O
matching	B
constraints	O
and	O
the	O
joint	O
image	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
338–343	O
,	O
1995	O
.	O
[	O
triggs-96	O
]	O
w.	O
triggs	O
.	O
factorization	B
methods	O
for	O
projective	O
structure	B
and	O
motion	O
.	O
in	O
proc	O
.	O
ieee	O
con-	O
ference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
845–851	O
,	O
1996	O
.	O
[	O
triggs-97	O
]	O
w.	O
triggs	O
.	O
auto-calibration	B
and	O
the	O
absolute	O
quadric	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
com-	O
puter	O
vision	O
and	O
pattern	O
recognition	O
,	O
pages	O
609–614	O
,	O
1997	O
.	O
[	O
triggs-98	O
]	O
w.	O
triggs	O
.	O
autocalibration	O
from	O
planar	O
scenes	O
.	O
in	O
proc	O
.	O
5th	O
european	O
conference	O
on	O
com-	O
puter	O
vision	O
,	O
freiburg	O
,	O
germany	O
,	O
1998	O
.	O
[	O
triggs-99a	O
]	O
w.	O
triggs	O
.	O
camera	B
pose	O
and	O
calibration	B
from	O
4	O
or	O
5	O
known	O
3d	O
points	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
278–284	O
,	O
1999	O
.	O
[	O
triggs-99b	O
]	O
w.	O
triggs	O
.	O
differential	O
matching	B
constraints	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
com-	O
puter	O
vision	O
,	O
pages	O
370–376	O
,	O
1999	O
.	O
[	O
triggs-00a	O
]	O
w.	O
triggs	O
,	O
p.	O
f.	O
mclauchlan	O
,	O
r.	O
i.	O
hartley	O
,	O
and	O
a.	O
fitzgibbon	O
.	O
bundle	B
adjustment	I
for	O
structure	B
from	O
motion	O
.	O
in	O
vision	O
algorithms	O
:	O
theory	O
and	O
practice	O
.	O
springer-verlag	O
,	O
2000	O
.	O
[	O
triggs-00b	O
]	O
w	O
triggs	O
.	O
plane	B
+	O
parallax	B
,	O
tensors	O
and	O
factorization	B
.	O
in	O
proc	O
.	O
european	O
conference	O
on	O
computer	O
vision	O
,	O
pages	O
522–538	O
,	O
2000	O
.	O
[	O
tsai-84	O
]	O
r.	O
y.	O
tsai	O
and	O
t.	O
s.	O
huang	O
.	O
the	O
perspective	O
view	O
of	O
three	O
points	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
6:13–27	O
,	O
1984	O
.	O
[	O
vangool-98	O
]	O
l.	O
van	O
gool	O
,	O
m.	O
proesmans	O
,	O
and	O
a.	O
zisserman	O
.	O
planar	O
homologies	O
as	O
a	O
basis	O
for	O
grouping	O
and	O
recognition	O
.	O
image	O
and	O
vision	O
computing	B
,	O
16:21–26	O
,	O
january	O
1998	O
.	O
[	O
vieville-93	O
]	O
t.	O
vi´eville	O
and	O
q.	O
luong	O
.	O
motion	O
of	B
points	I
and	O
lines	B
in	O
the	O
uncalibrated	O
case	O
.	O
technical	O
report	O
2054	O
,	O
i.n.r.i.a.	O
,	O
1993	O
.	O
[	O
vieville-95	O
]	O
t.	O
vi´eville	O
and	O
d.	O
lingrand	O
.	O
using	O
singular	O
displacements	O
for	O
uncalibrated	O
monocular	O
vision	O
systems	O
.	O
technical	O
report	O
2678	O
,	O
i.n.r.i.a.	O
,	O
1995	O
.	O
[	O
vonsanden-08	O
]	O
h.	O
von	O
sanden	O
.	O
die	O
bestimmung	O
der	O
kernpunkte	O
in	O
der	O
photogrammetrie	O
.	O
phd	O
thesis	O
,	O
univ	O
.	O
g¨ottingen	O
,	O
december	O
1908	O
.	O
[	O
weinshall-95	O
]	O
d.	O
weinshall	O
,	O
m.	O
werman	O
,	O
and	O
a.	O
shashua	O
.	O
shape	O
descriptors	O
:	O
bilinear	B
,	O
trilinear	B
and	O
quadrilinear	B
relations	O
for	O
multi-point	O
geometry	O
and	O
linear	B
projective	O
reconstruction	B
algorithms	O
.	O
in	O
ieee	O
workshop	O
on	O
representation	O
of	O
visual	O
scenes	O
,	O
boston	O
,	O
pages	O
58–65	O
,	O
1995	O
.	O
[	O
weng-88	O
]	O
j.	O
weng	O
,	O
n.	O
ahuja	O
,	O
and	O
t.	O
s.	O
huang	O
.	O
closed-form	O
solution	B
and	O
maximum	O
likelihood	O
:	O
a	O
robust	B
approach	O
to	O
motion	O
and	O
structure	B
estimation	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
1988	O
.	O
[	O
weng-89	O
]	O
j.	O
weng	O
,	O
t.	O
s.	O
huang	O
,	O
and	O
n.	O
ahuja	O
.	O
motion	O
and	O
structure	B
from	O
two	O
perspective	O
views	O
:	O
algorithms	O
,	O
error	B
analysis	O
and	O
error	B
estimation	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
11	O
(	O
5	O
)	O
:451–476	O
,	O
1989	O
.	O
[	O
werner-01	O
]	O
t.	O
werner	O
and	O
t.	O
pajdla	O
.	O
oriented	O
matching	B
constraints	O
.	O
in	O
t	O
cootes	O
and	O
c	O
taylor	O
,	O
editors	O
,	O
proc	O
.	O
british	O
machine	O
vision	O
conference	O
,	O
pages	O
441–450	O
,	O
london	O
,	O
uk	O
,	O
september	O
2001.	O
british	O
machine	O
vision	O
association	O
.	O
[	O
werner-03	O
]	O
t.	O
werner	O
.	O
a	O
constraint	O
on	O
ﬁve	O
points	O
in	O
two	O
images	O
.	O
in	O
proc	O
.	O
ieee	O
conference	O
on	O
computer	O
vision	O
and	O
pattern	O
recognition	O
,	O
june	O
2003	O
.	O
[	O
wolfe-91	O
]	O
w.	O
j.	O
wolfe	O
,	O
d.	O
mathis	O
,	O
c.	O
weber	O
sklair	O
,	O
and	O
m.	O
magee	O
.	O
the	O
perspective	O
view	O
of	O
three	O
points	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
13	O
(	O
1	O
)	O
:66–73	O
,	O
january	O
1991.	O
bibliography	O
645	O
[	O
xu-96	O
]	O
g.	O
xu	O
and	O
z.	O
zhang	O
.	O
epipolar	B
geometry	O
in	O
stereo	O
,	O
motion	O
and	O
object	O
recognition	O
.	O
kluwer	O
academic	O
publishers	O
,	O
1996	O
.	O
[	O
zeller-96	O
]	O
c.	O
zeller	O
.	O
projective	B
,	O
afﬁne	B
and	O
euclidean	O
calibration	O
in	O
computer	O
vision	O
and	O
the	O
applica-	O
tion	O
of	O
three	O
dimensional	O
perception	O
.	O
phd	O
thesis	O
,	O
robotvis	O
group	O
,	O
inria	O
sophia-antipolis	O
,	O
1996	O
.	O
[	O
zhang-95	O
]	O
z.	O
zhang	O
,	O
r.	O
deriche	O
,	O
o.	O
d.	O
faugeras	O
,	O
and	O
q.	O
luong	O
.	O
a	O
robust	B
technique	O
for	O
matching	O
two	O
uncalibrated	O
images	O
through	O
the	O
recovery	O
of	O
the	O
unknown	O
epipolar	B
geometry	O
.	O
artiﬁcial	O
intelligence	O
,	O
78:87–119	O
,	O
1995	O
.	O
[	O
zhang-98	O
]	O
z.	O
zhang	O
.	O
determining	O
the	O
epipolar	O
geometry	O
and	O
its	O
uncertainty	O
–	O
a	O
review	O
.	O
international	O
journal	O
of	O
computer	O
vision	O
,	O
27	O
(	O
2	O
)	O
:161–195	O
,	O
march	O
1998	O
.	O
[	O
zhang-00	O
]	O
z.	O
zhang	O
.	O
a	O
ﬂexible	O
new	O
technique	O
for	O
camera	O
calibration	O
.	O
ieee	O
transactions	O
on	O
pattern	O
analysis	O
and	O
machine	O
intelligence	O
,	O
22	O
(	O
11	O
)	O
:1330–1334	O
,	O
november	O
2000	O
.	O
[	O
zisserman-92	O
]	O
a.	O
zisserman	O
.	O
notes	O
on	O
geometric	O
invariance	O
in	O
vision	O
.	O
tutorial	O
,	O
british	O
machine	O
vision	O
conference	O
,	O
1992	O
.	O
[	O
zisserman-94	O
]	O
a.	O
zisserman	O
and	O
s.	O
maybank	O
.	O
a	O
case	O
against	O
epipolar	B
geometry	O
.	O
in	O
j.	O
mundy	O
,	O
a.	O
zis-	O
serman	O
,	O
and	O
d.	O
forsyth	O
,	O
editors	O
,	O
applications	O
of	O
invariance	O
in	O
computer	O
vision	O
lncs	O
825.	O
springer-	O
verlag	O
,	O
1994	O
.	O
[	O
zisserman-95a	O
]	O
a.	O
zisserman	O
,	O
j.	O
mundy	O
,	O
d.	O
forsyth	O
,	O
j.	O
liu	O
,	O
n.	O
pillow	O
,	O
c.	O
rothwell	O
,	O
and	O
s.	O
utcke	O
.	O
class-based	O
grouping	O
in	O
perspective	O
images	O
.	O
in	O
proc	O
.	O
international	O
conference	O
on	O
computer	O
vision	O
,	O
1995	O
.	O
[	O
zisserman-95b	O
]	O
a.	O
zisserman	O
,	O
p.	O
beardsley	O
,	O
and	O
i.	O
reid	O
.	O
metric	B
calibration	I
of	O
a	O
stereo	O
rig	O
.	O
in	O
ieee	O
workshop	O
on	O
representation	O
of	O
visual	O
scenes	O
,	O
boston	O
,	O
pages	O
93–100	O
,	O
1995	O
.	O
[	O
zisserman-96	O
]	O
a.	O
zisserman	O
.	O
a	O
users	O
guide	O
to	O
the	O
trifocal	B
tensor	I
.	O
dept	O
.	O
of	O
engineering	O
science	O
,	O
uni-	O
versity	O
of	O
oxford	O
,	O
1996	O
.	O
[	O
zisserman-98	O
]	O
a.	O
zisserman	O
,	O
d.	O
liebowitz	O
,	O
and	O
m.	O
armstrong	O
.	O
resolving	O
ambiguities	B
in	O
auto-	O
calibration	B
.	O
philosophical	O
transactions	O
of	O
the	O
royal	O
society	O
of	O
london	O
,	O
series	O
a	O
,	O
356	O
(	O
1740	O
)	O
:1193–	O
1211	O
,	O
1998	O
.	O